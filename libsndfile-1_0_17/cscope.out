cscope 16 G:\libsndfile-1_0_17"               0001473046
	@libsndfile-1.0.17/Win32/testprog.c

5 
	~<°dio.h
>

7 
	~"¢dfûe.h
"

10 
	$maö
 ()

11 { 
°rbuf„r
 [256] ;

12 
	`sf_comm™d
 (
NULL
, 
SFC_GET_LIB_VERSION
, 
°rbuf„r
,  (strbuffer)) ;

13 
	`puts
 (
°rbuf„r
) ;

15 
	}
}

	@libsndfile-1.0.17/examples/cooledit-fixer.c

19 
	~<°dio.h
>

20 
	~<°dlib.h
>

21 
	~<°rög.h
>

22 
	~<m©h.h
>

23 
	~<sys/°©.h
>

25 
	~<¢dfûe.h
>

27 
	#BUFFER_LEN
 1024

	)

29 
ußge_exô
 (*
¥og«me
) ;

30 
is_d©a_ªÆly_Êﬂt
 (
SNDFILE
 *
¢dfûe
) ;

31 
fix_fûe
 (*
fûíame
) ;

32 
off_t
 
fûe_size
 (*
fûíame
) ;

35 { 
	mi
 [
BUFFER_LEN
] ;

36 
	mf
 [
BUFFER_LEN
] ;

37 } 
	gbuf„r
 ;

40 
	$maö
 (
¨gc
, *
¨gv
 [])

41 { 
SNDFILE
 *
¢dfûe
 ;

42 
SF_INFO
 
sföfo
 ;

43 
k
, 
d©a_is_Êﬂt
, 
c⁄vîãd
 = 0 ;

45 
	`puts
 ("\nCooledit Fixer.\n---------------") ;

47 i‡(
¨gc
 < 2)

48 
	`ußge_exô
 (
¨gv
 [0]) ;

50 
k
 = 1 ; k < 
¨gc
 ; k++)

51 { i‡((
¢dfûe
 = 
	`sf_›í
 (
¨gv
 [
k
], 
SFM_READ
, &
sföfo
)Ë=
NULL
)

56 i‡(
sföfo
.
f‹m©
 !(
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_32
))

58 
	`sf_˛o£
 (
¢dfûe
) ;

62 
d©a_is_Êﬂt
 = 
	`is_d©a_ªÆly_Êﬂt
 (
¢dfûe
) ;

64 
	`sf_˛o£
 (
¢dfûe
) ;

66 i‡(
d©a_is_Êﬂt
 =
SF_FALSE
)

71 
	`fix_fûe
 (
¨gv
 [
k
]) ;

72 
c⁄vîãd
 ++ ;

75 i‡(
c⁄vîãd
 == 0)

76 
	`puts
 ("\nNo files converted.") ;

78 
	`puts
 ("") ;

81 
	}
}

85 
	$ußge_exô
 (*
¥og«me
)

86 { *
˝å
 ;

88 i‡((
˝å
 = 
	`°ºchr
 (
¥og«me
, '/')))

89 
¥og«me
 = 
˝å
 + 1 ;

90 i‡((
˝å
 = 
	`°ºchr
 (
¥og«me
, '\\')))

91 
¥og«me
 = 
˝å
 + 1 ;

93 
	`¥ötf
 ("\¿ Ußgê: %†<fûíame>\n", 
¥og«me
) ;

94 
	`puts
 ("\n"

103 
	`exô
 (1) ;

104 
	}
}

107 
	$is_d©a_ªÆly_Êﬂt
 (
SNDFILE
 *
¢dfûe
)

108 { 
k
, 
ªadcou¡
 ;

110 (
ªadcou¡
 = 
	`sf_ªad_öt
 (
¢dfûe
, 
buf„r
.
i
, 
BUFFER_LEN
)) > 0)

111 { 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

112 { i‡(
buf„r
.
i
 [
k
] == 0)

115 i‡(
	`Ábs
 (
buf„r
.
f
 [
k
]) > 32768.0)

116  
SF_FALSE
 ;

120  
SF_TRUE
 ;

121 
	}
}

124 
	$fix_fûe
 (*
fûíame
)

125 { 
√wfûíame
 [512] ;

127 
SNDFILE
 *
öfûe
, *
outfûe
 ;

128 
SF_INFO
 
sföfo
 ;

129 
ªadcou¡
, 
k
 ;

130 
n‹mÁ˘‹
 ;

131 *
˝å
 ;

133 
	`¥ötf
 ("\nFixög : %s\n", 
fûíame
) ;

135 i‡((
öfûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_READ
, &
sföfo
)Ë=
NULL
)

136 { 
	`¥ötf
 ("NŸábÀÅÿ›í i≈uàfûê%s\n", 
fûíame
) ;

137 
	`exô
 (1) ;

140 i‡(
	`°æí
 (
fûíame
Ë> (
√wfûíame
) - 1)

141 { 
	`puts
 ("Error : PathÇameÅooÜong.\n") ;

142 
	`exô
 (1) ;

145 
	`°∫˝y
 (
√wfûíame
, 
fûíame
,  (newfilename)) ;

146 
√wfûíame
 [ (newfilename) - 1] = 0 ;

148 i‡((
˝å
 = 
	`°ºchr
 (
√wfûíame
, '/')Ë=
NULL
)

149 
˝å
 = 
	`°ºchr
 (
√wfûíame
, '\\') ;

151 i‡(
˝å
)

152 { 
˝å
 [1] = 0 ;

153 
	`°∫ˇt
 (
√wfûíame
, "fixed.wav",  (√wfûíameË- 
	`°æí
 (newfilename) - 1) ;

156 
	`°∫˝y
 (
√wfûíame
, "fixed.wav",  (newfilename) - 1) ;

158 
√wfûíame
 [ (newfilename) - 1] = 0 ;

160 
	`¥ötf
 (" Ouçuà : %s\n", 
√wfûíame
) ;

162 
sföfo
.
f‹m©
 = 
SF_FORMAT_WAV
 | 
SF_FORMAT_FLOAT
 ;

164 i‡((
outfûe
 = 
	`sf_›í
 (
√wfûíame
, 
SFM_WRITE
, &
sföfo
)Ë=
NULL
)

165 { 
	`¥ötf
 ("NŸábÀÅÿouçuà›í fûê%s\n", 
fûíame
) ;

166 
	`exô
 (1) ;

171 
n‹mÁ˘‹
 = 0.0 ;

173 (
ªadcou¡
 = 
	`sf_ªad_öt
 (
öfûe
, 
buf„r
.
i
, 
BUFFER_LEN
)) > 0)

174 { 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

175 i‡(
	`Ábs
 (
buf„r
.
f
 [
k
]Ë> 
n‹mÁ˘‹
)

176 
n‹mÁ˘‹
 = 
	`Ábs
 (
buf„r
.
f
 [
k
]) ;

179 
	`¥ötf
 (" Pók : %g\n", 
n‹mÁ˘‹
) ;

181 
n‹mÁ˘‹
 = 1.0 /Çormfactor ;

183 
	`sf_£ek
 (
öfûe
, 0, 
SEEK_SET
) ;

185 (
ªadcou¡
 = 
	`sf_ªad_öt
 (
öfûe
, 
buf„r
.
i
, 
BUFFER_LEN
)) > 0)

186 { 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

187 
buf„r
.
f
 [
k
] *
n‹mÁ˘‹
 ;

188 
	`sf_wrôe_Êﬂt
 (
outfûe
, 
buf„r
.
f
, 
ªadcou¡
) ;

191 
	`sf_˛o£
 (
öfûe
) ;

192 
	`sf_˛o£
 (
outfûe
) ;

194 i‡(
	`abs
 (
	`fûe_size
 (
fûíame
Ë- fûe_sizê(
√wfûíame
)) > 50)

195 { 
	`puts
 ("Error : file size mismatch.\n") ;

196 
	`exô
 (1) ;

199 
	`¥ötf
 (" Ríamög : %s\n", 
fûíame
) ;

201 i‡(
	`ªmove
 (
fûíame
) != 0)

202 { 
	`≥º‹
 ("rename") ;

203 
	`exô
 (1) ;

206 i‡(
	`ª«me
 (
√wfûíame
, 
fûíame
) != 0)

207 { 
	`≥º‹
 ("rename") ;

208 
	`exô
 (1) ;

212 
	}
}

214 
off_t


215 
	$fûe_size
 (*
fûíame
)

216 { 
°©
 
buf
 ;

218 i‡(
	`°©
 (
fûíame
, &
buf
) != 0)

219 { 
	`≥º‹
 ("stat") ;

220 
	`exô
 (1) ;

223  
buf
.
°_size
 ;

224 
	}
}

	@libsndfile-1.0.17/examples/generate.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

24 
	~<m©h.h
>

26 
	~<¢dfûe.h
>

28 
	#BUFFER_LEN
 4096

	)

30 
ícode_fûe
 (c⁄° *
öfûíame
, c⁄° *
outfûíame
, 
fûëy≥
) ;

33 
	$maö
 (
¨gc
, **
¨gv
)

35 i‡(
¨gc
 != 2)

36 { 
	`puts
 ("\nEncodeá single input file intoáÇumber of different output ") ;

37 
	`puts
 ("encodings. These outputÉncodings canÅhen be movedÅoánother ") ;

38 
	`puts
 ("OS forÅesting.\n") ;

39 
	`puts
 (" Usage : generate <filename>\n") ;

40 
	`exô
 (1) ;

44 
	`ícode_fûe
 (
¨gv
 [1], "pcmu8.wav" , 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_U8
) ;

45 
	`ícode_fûe
 (
¨gv
 [1], "pcm16.wav" , 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_16
) ;

46 
	`ícode_fûe
 (
¨gv
 [1], "imØdpcm.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_MS_ADPCM
) ;

47 
	`ícode_fûe
 (
¨gv
 [1], "mßdpcm.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_IMA_ADPCM
) ;

48 
	`ícode_fûe
 (
¨gv
 [1], "gsm610.wav" , 
SF_FORMAT_WAV
 | 
SF_FORMAT_GSM610
) ;

51 
	`ícode_fûe
 (
¨gv
 [1], "pcmu8.w64" , 
SF_FORMAT_W64
 | 
SF_FORMAT_PCM_U8
) ;

52 
	`ícode_fûe
 (
¨gv
 [1], "pcm16.w64" , 
SF_FORMAT_W64
 | 
SF_FORMAT_PCM_16
) ;

53 
	`ícode_fûe
 (
¨gv
 [1], "imØdpcm.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_MS_ADPCM
) ;

54 
	`ícode_fûe
 (
¨gv
 [1], "mßdpcm.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_IMA_ADPCM
) ;

55 
	`ícode_fûe
 (
¨gv
 [1], "gsm610.w64" , 
SF_FORMAT_W64
 | 
SF_FORMAT_GSM610
) ;

58 
	}
}

64 
	#PUT_DOTS
(
k
) \

65 { 
k
--) \

66 
	`putch¨
 ('.') ; \

67 
	`putch¨
 (' ') ; \

68 }

	)

74 
	$ícode_fûe
 (c⁄° *
öfûíame
, c⁄° *
outfûíame
, 
fûëy≥
)

75 { 
buf„r
 [
BUFFER_LEN
] ;

77 
SNDFILE
 *
öfûe
, *
outfûe
 ;

78 
SF_INFO
 
sföfo
 ;

79 
k
, 
ªadcou¡
 ;

81 
	`¥ötf
 (" %†-> %†", 
öfûíame
, 
outfûíame
) ;

82 
	`fÊush
 (
°dout
) ;

84 
k
 = 16 - 
	`°æí
 (
outfûíame
) ;

85 
	`PUT_DOTS
 (
k
) ;

87 i‡(! (
öfûe
 = 
	`sf_›í
 (
öfûíame
, 
SFM_READ
, &
sföfo
)))

88 { 
	`¥ötf
 ("Eº‹ : couldÇŸ o≥¿fûê: %s\n", 
öfûíame
) ;

89 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

90 
	`exô
 (1) ;

93 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

95 i‡(! 
	`sf_f‹m©_check
 (&
sföfo
))

96 { 
	`sf_˛o£
 (
öfûe
) ;

97 
	`¥ötf
 ("InvalidÉncoding\n") ;

101 i‡(! (
outfûe
 = 
	`sf_›í
 (
outfûíame
, 
SFM_WRITE
, &
sföfo
)))

102 { 
	`¥ötf
 ("Eº‹ : couldÇŸ o≥¿fûê: %s\n", 
outfûíame
) ;

103 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

104 
	`exô
 (1) ;

107 (
ªadcou¡
 = 
	`sf_ªad_Êﬂt
 (
öfûe
, 
buf„r
, 
BUFFER_LEN
)) > 0)

108 
	`sf_wrôe_Êﬂt
 (
outfûe
, 
buf„r
, 
BUFFER_LEN
) ;

110 
	`sf_˛o£
 (
öfûe
) ;

111 
	`sf_˛o£
 (
outfûe
) ;

113 
	`¥ötf
 ("ok\n") ;

116 
	}
}

	@libsndfile-1.0.17/examples/list_formats.c

19 
	~<°dio.h
>

20 
	~<°dlib.h
>

21 
	~<°rög.h
>

22 
	~<m©h.h
>

24 
	~<¢dfûe.h
>

27 
	$maö
 ()

28 { 
SF_FORMAT_INFO
 
öfo
 ;

29 
SF_INFO
 
sföfo
 ;

30 
buf„r
 [128] ;

31 
f‹m©
, 
maj‹_cou¡
, 
subty≥_cou¡
, 
m
, 
s
 ;

33 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

34 
buf„r
 [0] = 0 ;

35 
	`sf_comm™d
 (
NULL
, 
SFC_GET_LIB_VERSION
, 
buf„r
,  (buffer)) ;

36 i‡(
	`°æí
 (
buf„r
) < 1)

37 { 
	`¥ötf
 ("Löê%d: couldÇŸÑërõvêlib vîsi⁄.\n", 
__LINE__
) ;

38 
	`exô
 (1) ;

40 
	`¥ötf
 ("Vîsi⁄ : %s\n\n", 
buf„r
) ;

42 
	`sf_comm™d
 (
NULL
, 
SFC_GET_FORMAT_MAJOR_COUNT
, &
maj‹_cou¡
,  ()) ;

43 
	`sf_comm™d
 (
NULL
, 
SFC_GET_FORMAT_SUBTYPE_COUNT
, &
subty≥_cou¡
,  ()) ;

45 
sföfo
.
ch™√ls
 = 1 ;

46 
m
 = 0 ; m < 
maj‹_cou¡
 ; m++)

47 { 
öfo
.
f‹m©
 = 
m
 ;

48 
	`sf_comm™d
 (
NULL
, 
SFC_GET_FORMAT_MAJOR
, &
öfo
,  (info)) ;

49 
	`¥ötf
 ("%† (exãnsi⁄ \"%s\")\n", 
öfo
.
«me
, info.
exãnsi⁄
) ;

51 
f‹m©
 = 
öfo
.format ;

53 
s
 = 0 ; s < 
subty≥_cou¡
 ; s++)

54 { 
öfo
.
f‹m©
 = 
s
 ;

55 
	`sf_comm™d
 (
NULL
, 
SFC_GET_FORMAT_SUBTYPE
, &
öfo
,  (info)) ;

57 
f‹m©
 = (f‹m© & 
SF_FORMAT_TYPEMASK
Ë| 
öfo
.format ;

59 
sföfo
.
f‹m©
 = format ;

60 i‡(
	`sf_f‹m©_check
 (&
sföfo
))

61 
	`¥ötf
 (" %s\n", 
öfo
.
«me
) ;

63 
	`puts
 ("") ;

65 
	`puts
 ("") ;

68 
	}
}

	@libsndfile-1.0.17/examples/make_sine.c

19 
	~<°dio.h
>

20 
	~<°dlib.h
>

21 
	~<°rög.h
>

22 
	~<m©h.h
>

24 
	~<¢dfûe.h
>

26 #i‚def 
M_PI


27 
	#M_PI
 3.14159265358979323846264338

	)

30 
	#SAMPLE_RATE
 44100

	)

31 
	#SAMPLE_COUNT
 (
SAMPLE_RATE
 * 4Ë

	)

32 
	#AMPLITUDE
 (1.0 * 0x7F000000)

	)

33 
	#LEFT_FREQ
 (344.0 / 
SAMPLE_RATE
)

	)

34 
	#RIGHT_FREQ
 (466.0 / 
SAMPLE_RATE
)

	)

37 
	$maö
 ()

38 { 
SNDFILE
 *
fûe
 ;

39 
SF_INFO
 
sföfo
 ;

40 
k
 ;

41 *
buf„r
 ;

43 i‡(! (
buf„r
 = 
	`mÆloc
 (2 * 
SAMPLE_COUNT
 *  ())))

44 { 
	`¥ötf
 ("Malloc failed.\n") ;

45 
	`exô
 (0) ;

48 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

50 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

51 
sföfo
.
‰ames
 = 
SAMPLE_COUNT
 ;

52 
sföfo
.
ch™√ls
 = 2 ;

53 
sföfo
.
f‹m©
 = (
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_24
) ;

55 i‡(! (
fûe
 = 
	`sf_›í
 ("söe.wav", 
SFM_WRITE
, &
sföfo
)))

56 { 
	`¥ötf
 ("Error : NotábleÅo open output file.\n") ;

60 i‡(
sföfo
.
ch™√ls
 == 1)

61 { 
k
 = 0 ; k < 
SAMPLE_COUNT
 ; k++)

62 
buf„r
 [
k
] = 
AMPLITUDE
 * 
	`sö
 (
LEFT_FREQ
 * 2 * k * 
M_PI
) ;

64 i‡(
sföfo
.
ch™√ls
 == 2)

65 { 
k
 = 0 ; k < 
SAMPLE_COUNT
 ; k++)

66 { 
buf„r
 [2 * 
k
] = 
AMPLITUDE
 * 
	`sö
 (
LEFT_FREQ
 * 2 * k * 
M_PI
) ;

67 
buf„r
 [2 * 
k
 + 1] = 
AMPLITUDE
 * 
	`sö
 (
RIGHT_FREQ
 * 2 * k * 
M_PI
) ;

71 { 
	`¥ötf
 ("makesine can only generate mono or stereo files.\n") ;

72 
	`exô
 (1) ;

75 i‡(
	`sf_wrôe_öt
 (
fûe
, 
buf„r
, 
sföfo
.
ch™√ls
 * 
SAMPLE_COUNT
) !=

76 
sföfo
.
ch™√ls
 * 
SAMPLE_COUNT
)

77 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

79 
	`sf_˛o£
 (
fûe
) ;

81 
	}
}

	@libsndfile-1.0.17/examples/sfprocess.c

19 
	~<°dio.h
>

22 
	~<¢dfûe.h
>

27 
	#BUFFER_LEN
 1024

	)

30 
	#MAX_CHANNELS
 6

	)

33 
¥o˚ss_d©a
 (*
d©a
, 
cou¡
, 
ch™√ls
) ;

37 
	$maö
 ()

41 
d©a
 [
BUFFER_LEN
] ;

47 
SNDFILE
 *
öfûe
, *
outfûe
 ;

53 
SF_INFO
 
sföfo
 ;

54 
ªadcou¡
 ;

55 c⁄° *
öfûíame
 = "input.wav" ;

56 c⁄° *
outfûíame
 = "output.wav" ;

72 i‡(! (
öfûe
 = 
	`sf_›í
 (
öfûíame
, 
SFM_READ
, &
sföfo
)))

74 
	`¥ötf
 ("NŸábÀÅÿ›í i≈uàfûê%s.\n", 
öfûíame
) ;

76 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

80 i‡(
sföfo
.
ch™√ls
 > 
MAX_CHANNELS
)

81 { 
	`¥ötf
 ("NŸábÀÅÿ¥o˚s†m‹êth™ %d ch™√ls\n", 
MAX_CHANNELS
) ;

85 i‡(! (
outfûe
 = 
	`sf_›í
 (
outfûíame
, 
SFM_WRITE
, &
sföfo
)))

86 { 
	`¥ötf
 ("NŸábÀÅÿ›í ouçuàfûê%s.\n", 
outfûíame
) ;

87 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

94 (
ªadcou¡
 = 
	`sf_ªad_doubÀ
 (
öfûe
, 
d©a
, 
BUFFER_LEN
)))

95 { 
	`¥o˚ss_d©a
 (
d©a
, 
ªadcou¡
, 
sföfo
.
ch™√ls
) ;

96 
	`sf_wrôe_doubÀ
 (
outfûe
, 
d©a
, 
ªadcou¡
) ;

100 
	`sf_˛o£
 (
öfûe
) ;

101 
	`sf_˛o£
 (
outfûe
) ;

104 
	}
}

107 
	$¥o˚ss_d©a
 (*
d©a
, 
cou¡
, 
ch™√ls
)

108 { 
ch™√l_gaö
 [
MAX_CHANNELS
] = { 0.5, 0.8, 0.1, 0.4, 0.4, 0.9 } ;

109 
k
, 
ch™
 ;

117 
ch™
 = 0 ; ch™ < 
ch™√ls
 ; chan ++)

118 
k
 = 
ch™
 ; k < 
cou¡
 ; k+
ch™√ls
)

119 
d©a
 [
k
] *
ch™√l_gaö
 [
ch™
] ;

122 
	}
}

	@libsndfile-1.0.17/examples/sndfile-convert.c

20 
	~<°dio.h
>

21 
	~<°dlib.h
>

22 
	~<°rög.h
>

23 
	~<˘y≥.h
>

25 
	~<¢dfûe.h
>

27 
	#BUFFER_LEN
 1024

	)

31 { *
	möfûíame
, *
	moutfûíame
 ;

32 
SF_INFO
 
	möfûeöfo
, 
	moutfûeöfo
 ;

33 } 
	tO±i⁄D©a
 ;

36 { c⁄° *
	mext
 ;

37 
	mÀn
 ;

38 
	mf‹m©
 ;

39 } 
	tOUTPUT_FORMAT_MAP
 ;

41 
c›y_mëad©a
 (
SNDFILE
 *
outfûe
, SNDFILE *
öfûe
) ;

42 
c›y_d©a_Â
 (
SNDFILE
 *
outfûe
, SNDFILE *
öfûe
, 
ch™√ls
) ;

43 
c›y_d©a_öt
 (
SNDFILE
 *
outfûe
, SNDFILE *
öfûe
, 
ch™√ls
) ;

45 
OUTPUT_FORMAT_MAP
 
	gf‹m©_m≠
 [] =

47 { "aif", 3, 
SF_FORMAT_AIFF
 },

48 { "wav", 0, 
SF_FORMAT_WAV
 },

49 { "au", 0, 
SF_FORMAT_AU
 },

50 { "ˇf", 0, 
SF_FORMAT_CAF
 },

51 { "Êac", 0, 
SF_FORMAT_FLAC
 },

52 { "¢d", 0, 
SF_FORMAT_AU
 },

53 { "svx", 0, 
SF_FORMAT_SVX
 },

54 { "∑f", 0, 
SF_ENDIAN_BIG
 | 
SF_FORMAT_PAF
 },

55 { "Áp", 0, 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_PAF
 },

56 { "gsm", 0, 
SF_FORMAT_RAW
 },

57 { "ni°", 0, 
SF_FORMAT_NIST
 },

58 { "úˇm", 0, 
SF_FORMAT_IRCAM
 },

59 { "sf", 0, 
SF_FORMAT_IRCAM
 },

60 { "voc", 0, 
SF_FORMAT_VOC
 },

61 { "w64", 0, 
SF_FORMAT_W64
 },

62 { "øw", 0, 
SF_FORMAT_RAW
 },

63 { "m©4", 0, 
SF_FORMAT_MAT4
 },

64 { "m©5", 0, 
SF_FORMAT_MAT5
 },

65 { "m©", 0, 
SF_FORMAT_MAT4
 },

66 { "pvf", 0, 
SF_FORMAT_PVF
 },

67 { "sds", 0, 
SF_FORMAT_SDS
 },

68 { "sd2", 0, 
SF_FORMAT_SD2
 },

69 { "vox", 0, 
SF_FORMAT_RAW
 },

70 { "xi", 0, 
SF_FORMAT_XI
 }

74 
	$guess_ouçut_fûe_ty≥
 (*
°r
, 
f‹m©
)

75 { 
buf„r
 [16], *
˝å
 ;

76 
k
 ;

78 
f‹m©
 &
SF_FORMAT_SUBMASK
 ;

80 i‡((
˝å
 = 
	`°ºchr
 (
°r
, '.')Ë=
NULL
)

83 
	`°∫˝y
 (
buf„r
, 
˝å
 + 1, 15) ;

84 
buf„r
 [15] = 0 ;

86 
k
 = 0 ; 
buf„r
 [k] ; k++)

87 
buf„r
 [
k
] = 
	`tﬁowî
 ((buffer [k])) ;

89 i‡(
	`°rcmp
 (
buf„r
, "gsm") == 0)

90  
SF_FORMAT_RAW
 | 
SF_FORMAT_GSM610
 ;

92 i‡(
	`°rcmp
 (
buf„r
, "vox") == 0)

93  
SF_FORMAT_RAW
 | 
SF_FORMAT_VOX_ADPCM
 ;

95 
k
 = 0 ; k < (Ë( (
f‹m©_m≠
) /  (format_map [0])) ; k++)

96 { i‡(
f‹m©_m≠
 [
k
].
Àn
 > 0 && 
	`°∫cmp
 (
buf„r
, f‹m©_m≠ [k].
ext
, format_map [k].len) == 0)

97  
f‹m©_m≠
 [
k
].
f‹m©
 | format ;

98 i‡(
	`°rcmp
 (
buf„r
, 
f‹m©_m≠
 [
k
].
ext
) == 0)

99  
f‹m©_m≠
 [
k
].
f‹m©
 | format ;

103 
	}
}

107 
	$¥öt_ußge
 (*
¥og«me
)

108 { 
SF_FORMAT_INFO
 
öfo
 ;

110 
k
 ;

112 
	`¥ötf
 ("\nUßgê: %†[ícodög] <öpuàfûe> <ouçuàfûe>\n", 
¥og«me
) ;

113 
	`puts
 ("\n"

122 
	`puts
 (

133 
	`puts
 (

138 
k
 = 0 ; k < (Ë( (
f‹m©_m≠
) /  (format_map [0])) ; k++)

139 { 
öfo
.
f‹m©
 = 
f‹m©_m≠
 [
k
].format ;

140 
	`sf_comm™d
 (
NULL
, 
SFC_GET_FORMAT_INFO
, &
öfo
,  (info)) ;

141 
	`¥ötf
 (" %-10†: %s\n", 
f‹m©_m≠
 [
k
].
ext
, 
öfo
.
«me
) ;

144 
	`puts
 ("") ;

145 
	}
}

148 
	$maö
 (
¨gc
, * 
¨gv
 [])

149 { *
¥og«me
, *
öfûíame
, *
outfûíame
 ;

150 
SNDFILE
 *
öfûe
 = 
NULL
, *
outfûe
 = NULL ;

151 
SF_INFO
 
sföfo
 ;

152 
k
, 
outfûemaj‹
, 
outfûemö‹
 = 0, 
öfûemö‹
 ;

154 
¥og«me
 = 
	`°ºchr
 (
¨gv
 [0], '/') ;

155 
¥og«me
 =Örog«mê?Örog«mê+ 1 : 
¨gv
 [0] ;

157 i‡(
¨gc
 < 3 ||árgc > 5)

158 { 
	`¥öt_ußge
 (
¥og«me
) ;

162 
öfûíame
 = 
¨gv
 [
¨gc
-2] ;

163 
outfûíame
 = 
¨gv
 [
¨gc
-1] ;

165 i‡(
	`°rcmp
 (
öfûíame
, 
outfûíame
) == 0)

166 { 
	`¥ötf
 ("Error : Inputánd output filenamesáreÅhe same.\n\n") ;

167 
	`¥öt_ußge
 (
¥og«me
) ;

171 i‡(
öfûíame
 [0] == '-')

172 { 
	`¥ötf
 ("Eº‹ : I≈uàfûíamê(%sËlook†likê™ o±i⁄.\n\n", 
öfûíame
) ;

173 
	`¥öt_ußge
 (
¥og«me
) ;

177 i‡(
outfûíame
 [0] == '-')

178 { 
	`¥ötf
 ("Eº‹ : Ouçuàfûíamê(%sËlook†likê™ o±i⁄.\n\n", 
outfûíame
) ;

179 
	`¥öt_ußge
 (
¥og«me
) ;

183 
k
 = 1 ; k < 
¨gc
 - 2 ; k++)

184 { i‡(! 
	`°rcmp
 (
¨gv
 [
k
], "-pcms8"))

185 { 
outfûemö‹
 = 
SF_FORMAT_PCM_S8
 ;

188 i‡(! 
	`°rcmp
 (
¨gv
 [
k
], "-pcmu8"))

189 { 
outfûemö‹
 = 
SF_FORMAT_PCM_U8
 ;

192 i‡(! 
	`°rcmp
 (
¨gv
 [
k
], "-pcm16"))

193 { 
outfûemö‹
 = 
SF_FORMAT_PCM_16
 ;

196 i‡(! 
	`°rcmp
 (
¨gv
 [
k
], "-pcm24"))

197 { 
outfûemö‹
 = 
SF_FORMAT_PCM_24
 ;

200 i‡(! 
	`°rcmp
 (
¨gv
 [
k
], "-pcm32"))

201 { 
outfûemö‹
 = 
SF_FORMAT_PCM_32
 ;

204 i‡(! 
	`°rcmp
 (
¨gv
 [
k
], "-float32"))

205 { 
outfûemö‹
 = 
SF_FORMAT_FLOAT
 ;

208 i‡(! 
	`°rcmp
 (
¨gv
 [
k
], "-ulaw"))

209 { 
outfûemö‹
 = 
SF_FORMAT_ULAW
 ;

212 i‡(! 
	`°rcmp
 (
¨gv
 [
k
], "-alaw"))

213 { 
outfûemö‹
 = 
SF_FORMAT_ALAW
 ;

216 i‡(! 
	`°rcmp
 (
¨gv
 [
k
], "-ima-adpcm"))

217 { 
outfûemö‹
 = 
SF_FORMAT_IMA_ADPCM
 ;

220 i‡(! 
	`°rcmp
 (
¨gv
 [
k
], "-ms-adpcm"))

221 { 
outfûemö‹
 = 
SF_FORMAT_MS_ADPCM
 ;

224 i‡(! 
	`°rcmp
 (
¨gv
 [
k
], "-gsm610"))

225 { 
outfûemö‹
 = 
SF_FORMAT_GSM610
 ;

228 i‡(! 
	`°rcmp
 (
¨gv
 [
k
], "-dwvw12"))

229 { 
outfûemö‹
 = 
SF_FORMAT_DWVW_12
 ;

232 i‡(! 
	`°rcmp
 (
¨gv
 [
k
], "-dwvw16"))

233 { 
outfûemö‹
 = 
SF_FORMAT_DWVW_16
 ;

236 i‡(! 
	`°rcmp
 (
¨gv
 [
k
], "-dwvw24"))

237 { 
outfûemö‹
 = 
SF_FORMAT_DWVW_24
 ;

241 
	`¥ötf
 ("Eº‹ : NŸábÀÅÿdecodê¨gunmíà'%s'.\n", 
¨gv
 [
k
]) ;

242 
	`exô
 (1) ;

245 i‡((
öfûe
 = 
	`sf_›í
 (
öfûíame
, 
SFM_READ
, &
sföfo
)Ë=
NULL
)

246 { 
	`¥ötf
 ("NŸábÀÅÿ›í i≈uàfûê%s.\n", 
öfûíame
) ;

247 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

251 
öfûemö‹
 = 
sföfo
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

253 i‡((
sföfo
.
f‹m©
 = 
	`guess_ouçut_fûe_ty≥
 (
outfûíame
, sfinfo.format)) == 0)

254 { 
	`¥ötf
 ("Eº‹ : NŸábÀÅÿdëîmöêouçuàfûêty≥ f‹ %s.\n", 
outfûíame
) ;

258 
outfûemaj‹
 = 
sföfo
.
f‹m©
 & (
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_ENDMASK
) ;

260 i‡(
outfûemö‹
 == 0)

261 
outfûemö‹
 = 
sföfo
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

263 i‡(
outfûemö‹
 != 0)

264 
sföfo
.
f‹m©
 = 
outfûemaj‹
 | 
outfûemö‹
 ;

266 
sföfo
.
f‹m©
 = 
outfûemaj‹
 | (sföfo.f‹m© & 
SF_FORMAT_SUBMASK
) ;

268 i‡((
sföfo
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_XI
)

269 
sföfo
.
f‹m©
 & 
SF_FORMAT_SUBMASK
)

270 { 
SF_FORMAT_PCM_16
 :

271 
sföfo
.
f‹m©
 = 
outfûemaj‹
 | 
SF_FORMAT_DPCM_16
 ;

274 
SF_FORMAT_PCM_S8
 :

275 
SF_FORMAT_PCM_U8
 :

276 
sföfo
.
f‹m©
 = 
outfûemaj‹
 | 
SF_FORMAT_DPCM_8
 ;

280 i‡(
	`sf_f‹m©_check
 (&
sföfo
) == 0)

281 { 
	`¥ötf
 ("Eº‹ : ouçuàfûêf‹m© i†övÆid (0x%08X).\n", 
sföfo
.
f‹m©
) ;

286 i‡((
outfûe
 = 
	`sf_›í
 (
outfûíame
, 
SFM_WRITE
, &
sföfo
)Ë=
NULL
)

287 { 
	`¥ötf
 ("NŸábÀÅÿ›í ouçuàfûê%†: %s\n", 
outfûíame
, 
	`sf_°ªº‹
 (
NULL
)) ;

292 
	`c›y_mëad©a
 (
outfûe
, 
öfûe
) ;

294 i‡((
outfûemö‹
 =
SF_FORMAT_DOUBLE
Ë|| (outfûemö‹ =
SF_FORMAT_FLOAT
) ||

295 (
öfûemö‹
 =
SF_FORMAT_DOUBLE
Ë|| (öfûemö‹ =
SF_FORMAT_FLOAT
))

296 
	`c›y_d©a_Â
 (
outfûe
, 
öfûe
, 
sföfo
.
ch™√ls
) ;

298 
	`c›y_d©a_öt
 (
outfûe
, 
öfûe
, 
sföfo
.
ch™√ls
) ;

300 
	`sf_˛o£
 (
öfûe
) ;

301 
	`sf_˛o£
 (
outfûe
) ;

304 
	}
}

307 
	$c›y_mëad©a
 (
SNDFILE
 *
outfûe
, SNDFILE *
öfûe
)

308 { 
SF_INSTRUMENT
 
ö°
 ;

309 c⁄° *
°r
 ;

310 
k
, 
îr
 = 0 ;

312 
k
 = 
SF_STR_FIRST
 ; k <
SF_STR_LAST
 ; k++)

313 { 
°r
 = 
	`sf_gë_°rög
 (
öfûe
, 
k
) ;

314 i‡(
°r
 !
NULL
)

315 
îr
 = 
	`sf_£t_°rög
 (
outfûe
, 
k
, 
°r
) ;

318 
	`mem£t
 (&
ö°
, 0,  (inst)) ;

319 i‡(
	`sf_comm™d
 (
öfûe
, 
SFC_GET_INSTRUMENT
, &
ö°
,  (ö°)Ë=
SF_TRUE
)

320 
	`sf_comm™d
 (
outfûe
, 
SFC_SET_INSTRUMENT
, &
ö°
,  (inst)) ;

322 
	}
}

325 
	$c›y_d©a_Â
 (
SNDFILE
 *
outfûe
, SNDFILE *
öfûe
, 
ch™√ls
)

326 { 
d©a
 [
BUFFER_LEN
], 
max
 ;

327 
‰ames
, 
ªadcou¡
, 
k
 ;

329 
‰ames
 = 
BUFFER_LEN
 / 
ch™√ls
 ;

330 
ªadcou¡
 = 
‰ames
 ;

332 
	`sf_comm™d
 (
öfûe
, 
SFC_CALC_SIGNAL_MAX
, &
max
,  (max)) ;

334 i‡(
max
 < 1.0)

335 { 
ªadcou¡
 > 0)

336 { 
ªadcou¡
 = 
	`sf_ªadf_doubÀ
 (
öfûe
, 
d©a
, 
‰ames
) ;

337 
	`sf_wrôef_doubÀ
 (
outfûe
, 
d©a
, 
ªadcou¡
) ;

341 { 
	`sf_comm™d
 (
öfûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

343 
ªadcou¡
 > 0)

344 { 
ªadcou¡
 = 
	`sf_ªadf_doubÀ
 (
öfûe
, 
d©a
, 
‰ames
) ;

345 
k
 = 0 ; k < 
ªadcou¡
 * 
ch™√ls
 ; k++)

346 
d©a
 [
k
] /
max
 ;

347 
	`sf_wrôef_doubÀ
 (
outfûe
, 
d©a
, 
ªadcou¡
) ;

352 
	}
}

355 
	$c›y_d©a_öt
 (
SNDFILE
 *
outfûe
, SNDFILE *
öfûe
, 
ch™√ls
)

356 { 
d©a
 [
BUFFER_LEN
] ;

357 
‰ames
, 
ªadcou¡
 ;

359 
‰ames
 = 
BUFFER_LEN
 / 
ch™√ls
 ;

360 
ªadcou¡
 = 
‰ames
 ;

362 
ªadcou¡
 > 0)

363 { 
ªadcou¡
 = 
	`sf_ªadf_öt
 (
öfûe
, 
d©a
, 
‰ames
) ;

364 
	`sf_wrôef_öt
 (
outfûe
, 
d©a
, 
ªadcou¡
) ;

368 
	}
}

	@libsndfile-1.0.17/examples/sndfile-info.c

19 
	~<°dio.h
>

20 
	~<°dlib.h
>

21 
	~<°rög.h
>

22 
	~<˘y≥.h
>

23 
	~<m©h.h
>

25 
	~<¢dfûe.h
>

27 
	#BUFFER_LEN
 (1 << 16)

	)

29 #i‡(
deföed
 (
WIN32
Ë|| deföed (
_WIN32
))

30 
	#¢¥ötf
 
_¢¥ötf


	)

33 
¥öt_vîsi⁄
 () ;

34 
¥öt_ußge
 (c⁄° *
¥og«me
) ;

36 
öfo_dump
 (c⁄° *
fûíame
) ;

37 
ö°rumít_dump
 (c⁄° *
fûíame
) ;

38 
brﬂdˇ°_dump
 (c⁄° *
fûíame
) ;

41 
	$maö
 (
¨gc
, *
¨gv
 [])

42 { 
k
 ;

44 
	`¥öt_vîsi⁄
 () ;

46 i‡(
¨gc
 < 2 || 
	`°rcmp
 (
¨gv
 [1], "--help") == 0 || strcmp (argv [1], "-h") == 0)

47 { *
¥og«me
 ;

49 
¥og«me
 = 
	`°ºchr
 (
¨gv
 [0], '/') ;

50 
¥og«me
 =Örog«mê?Örog«mê+ 1 : 
¨gv
 [0] ;

52 
	`¥öt_ußge
 (
¥og«me
) ;

56 i‡(
	`°rcmp
 (
¨gv
 [1], "-i") == 0)

57 { 
	`ö°rumít_dump
 (
¨gv
 [2]) ;

61 i‡(
	`°rcmp
 (
¨gv
 [1], "-b") == 0)

62 { 
	`brﬂdˇ°_dump
 (
¨gv
 [2]) ;

66 
k
 = 1 ; k < 
¨gc
 ; k++)

67 
	`öfo_dump
 (
¨gv
 [
k
]) ;

70 
	}
}

76 
	gd©a
 [
BUFFER_LEN
] ;

79 
	$¥öt_vîsi⁄
 ()

80 { 
buf„r
 [256] ;

82 
	`sf_comm™d
 (
NULL
, 
SFC_GET_LIB_VERSION
, 
buf„r
,  (buffer)) ;

83 
	`¥ötf
 ("\nVîsi⁄ : %s\n\n", 
buf„r
) ;

84 
	}
}

88 
	$¥öt_ußge
 (c⁄° *
¥og«me
)

89 { 
	`¥ötf
 ("Ußgê:\¿ %†<fûe> ...\n", 
¥og«me
) ;

90 
	`¥ötf
 (" Prints out informationábout one or more sound files.\n\n") ;

91 
	`¥ötf
 (" %†-ò<fûe>\n", 
¥og«me
) ;

92 
	`¥ötf
 (" Prints outÅhe instrument data forÅhe given file.\n\n") ;

93 
	`¥ötf
 (" %†-b <fûe>\n", 
¥og«me
) ;

94 
	`¥ötf
 (" Prints outÅhe broadcast WAV info forÅhe given file.\n\n") ;

95 #i‡(
	`deföed
 (
_WIN32
Ë|| deföed (
WIN32
))

96 
	`¥ötf
 ("This isá Unix style commandÜineápplication which\n"

98 
	`¥ötf
 ("Sleeping for 5 seconds beforeÉxiting.\n\n") ;

99 
	`fÊush
 (
°dout
) ;

106 
	`_¶ìp
 (5 * 1000) ;

108 
	}
}

114 
	gd©a
 [
BUFFER_LEN
] ;

117 
	$gë_sig«l_max
 (
SNDFILE
 *
fûe
)

118 { 
max
, 
ãmp
 ;

119 
ªadcou¡
, 
k
, 
ßve_°©e
 ;

121 
ßve_°©e
 = 
	`sf_comm™d
 (
fûe
, 
SFC_GET_NORM_DOUBLE
, 
NULL
, 0) ;

122 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

124 
max
 = 0.0 ;

125 (
ªadcou¡
 = 
	`sf_ªad_doubÀ
 (
fûe
, 
d©a
, 
BUFFER_LEN
)))

126 { 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

127 { 
ãmp
 = 
	`Ábs
 (
d©a
 [
k
]) ;

128 i‡(
ãmp
 > 
max
)

129 
max
 = 
ãmp
 ;

133 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
ßve_°©e
) ;

135  
max
 ;

136 
	}
}

139 
	$ˇlc_decibñs
 (
SF_INFO
 * 
sföfo
, 
max
)

140 { 
decibñs
 ;

142 
sföfo
->
f‹m©
 & 
SF_FORMAT_SUBMASK
)

143 { 
SF_FORMAT_PCM_U8
 :

144 
SF_FORMAT_PCM_S8
 :

145 
decibñs
 = 
max
 / 0x80 ;

148 
SF_FORMAT_PCM_16
 :

149 
decibñs
 = 
max
 / 0x8000 ;

152 
SF_FORMAT_PCM_24
 :

153 
decibñs
 = 
max
 / 0x800000 ;

156 
SF_FORMAT_PCM_32
 :

157 
decibñs
 = 
max
 / 0x80000000 ;

160 
SF_FORMAT_FLOAT
 :

161 
SF_FORMAT_DOUBLE
 :

162 
decibñs
 = 
max
 / 1.0 ;

166 
decibñs
 = 
max
 / 0x8000 ;

170  20.0 * 
	`log10
 (
decibñs
) ;

171 
	}
}

174 
	$gíî©e_duøti⁄_°r
 (
SF_INFO
 *
sföfo
)

175 { 
°r
 [128] ;

177 
£c⁄ds
 ;

179 
	`mem£t
 (
°r
, 0,  (str)) ;

181 i‡(
sföfo
->
ßm∂î©e
 < 1)

182  
NULL
 ;

184 i‡(
sföfo
->
‰ames
 / sföfo->
ßm∂î©e
 > 0x7FFFFFFF)

187 
£c⁄ds
 = 
sföfo
->
‰ames
 / sföfo->
ßm∂î©e
 ;

189 
	`¢¥ötf
 (
°r
,  (°rË- 1, "%02d:", 
£c⁄ds
 / 60 / 60) ;

191 
£c⁄ds
 = seconds % (60 * 60) ;

192 
	`¢¥ötf
 (
°r
 + 
	`°æí
 (°r),  (°rË- såÀ¿(°rË- 1, "%02d:", 
£c⁄ds
 / 60) ;

194 
£c⁄ds
 = seconds % 60 ;

195 
	`¢¥ötf
 (
°r
 + 
	`°æí
 (°r),  (°rË- såÀ¿(°rË- 1, "%02d.", 
£c⁄ds
) ;

197 
£c⁄ds
 = ((1000 * 
sföfo
->
‰ames
Ë/ sföfo->
ßm∂î©e
) % 1000 ;

198 
	`¢¥ötf
 (
°r
 + 
	`°æí
 (°r),  (°rË- såÀ¿(°rË- 1, "%03d", 
£c⁄ds
) ;

200  
°r
 ;

201 
	}
}

204 
	$öfo_dump
 (c⁄° *
fûíame
)

205 { 
°rbuf„r
 [
BUFFER_LEN
] ;

206 
SNDFILE
 *
fûe
 ;

207 
SF_INFO
 
sföfo
 ;

208 
sig«l_max
, 
decibñs
 ;

210 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

212 i‡((
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_READ
, &
sföfo
)Ë=
NULL
)

213 { 
	`¥ötf
 ("Eº‹ : NŸábÀÅÿ›í i≈uàfûê%s.\n", 
fûíame
) ;

214 
	`fÊush
 (
°dout
) ;

215 
	`mem£t
 (
d©a
, 0,  (data)) ;

216 
	`sf_comm™d
 (
fûe
, 
SFC_GET_LOG_INFO
, 
°rbuf„r
, 
BUFFER_LEN
) ;

217 
	`puts
 (
°rbuf„r
) ;

218 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

222 
	`¥ötf
 ("========================================\n") ;

223 
	`sf_comm™d
 (
fûe
, 
SFC_GET_LOG_INFO
, 
°rbuf„r
, 
BUFFER_LEN
) ;

224 
	`puts
 (
°rbuf„r
) ;

225 
	`¥ötf
 ("----------------------------------------\n") ;

227 i‡(
fûe
 =
NULL
)

228 { 
	`¥ötf
 ("Eº‹ : NŸábÀÅÿ›í i≈uàfûê%s.\n", 
fûíame
) ;

229 
	`fÊush
 (
°dout
) ;

230 
	`mem£t
 (
d©a
, 0,  (data)) ;

231 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

234 { 
	`¥ötf
 ("Sam∂êR©ê: %d\n", 
sföfo
.
ßm∂î©e
) ;

235 i‡(
sföfo
.
‰ames
 > 0x7FFFFFFF)

236 
	`¥ötf
 ("Frames : unknown\n") ;

238 
	`¥ötf
 ("Føme† : %ld\n", (Ë
sföfo
.
‰ames
) ;

239 
	`¥ötf
 ("Ch™√l† : %d\n", 
sföfo
.
ch™√ls
) ;

240 
	`¥ötf
 ("F‹m© : 0x%08X\n", 
sföfo
.
f‹m©
) ;

241 
	`¥ötf
 ("Se˘i⁄† : %d\n", 
sföfo
.
£˘i⁄s
) ;

242 
	`¥ötf
 ("SìkabÀ : %s\n", (
sföfo
.
£ekabÀ
 ? "TRUE" : "FALSE")) ;

243 
	`¥ötf
 ("Duøti⁄ : %s\n", 
	`gíî©e_duøti⁄_°r
 (&
sföfo
)) ;

246 
sig«l_max
 = 
	`gë_sig«l_max
 (
fûe
) ;

247 
decibñs
 = 
	`ˇlc_decibñs
 (&
sföfo
, 
sig«l_max
) ;

248 
	`¥ötf
 ("Sig«»Max : %g (%4.2‡dB)\n\n", 
sig«l_max
, 
decibñs
) ;

251 
	`sf_˛o£
 (
fûe
) ;

253 
	}
}

260 
	$°r_of_ty≥
 (
mode
)

261 { 
mode
)

262 { 
SF_LOOP_NONE
 :  "none" ;

263 
SF_LOOP_FORWARD
 :  "fwd " ;

264 
SF_LOOP_BACKWARD
 :  "back" ;

265 
SF_LOOP_ALTERNATING
 :  "alt " ;

270 
	}
}

273 
	$ö°rumít_dump
 (c⁄° *
fûíame
)

274 { 
SNDFILE
 *
fûe
 ;

275 
SF_INFO
 
sföfo
 ;

276 
SF_INSTRUMENT
 
ö°
 ;

277 
gŸ_ö°
, 
k
 ;

279 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

281 i‡((
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_READ
, &
sföfo
)Ë=
NULL
)

282 { 
	`¥ötf
 ("Eº‹ : NŸábÀÅÿ›í i≈uàfûê%s.\n", 
fûíame
) ;

283 
	`fÊush
 (
°dout
) ;

284 
	`mem£t
 (
d©a
, 0,  (data)) ;

285 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

289 
gŸ_ö°
 = 
	`sf_comm™d
 (
fûe
, 
SFC_GET_INSTRUMENT
, &
ö°
,  (inst)) ;

290 
	`sf_˛o£
 (
fûe
) ;

292 i‡(
gŸ_ö°
 =
SF_FALSE
)

293 { 
	`¥ötf
 ("Eº‹ : Fûê'%s' d€†nŸ c⁄èö in°rumíàd©a.\n\n", 
fûíame
) ;

297 
	`¥ötf
 ("In°rumíà: %s\n\n", 
fûíame
) ;

298 
	`¥ötf
 (" Gaö : %d\n", 
ö°
.
gaö
) ;

299 
	`¥ötf
 (" Ba£ÇŸê : %d\n", 
ö°
.
ba£nŸe
) ;

300 
	`¥ötf
 (" Vñocôy : %d - %d\n", (Ë
ö°
.
vñocôy_lo
, (Ëö°.
vñocôy_hi
) ;

301 
	`¥ötf
 (" Key : %d - %d\n", (Ë
ö°
.
key_lo
, (Ëö°.
key_hi
) ;

302 
	`¥ötf
 (" Lo›Öoöt†: %d\n", 
ö°
.
lo›_cou¡
) ;

304 
k
 = 0 ; k < 
ö°
.
lo›_cou¡
 ; k++)

305 
	`¥ötf
 (" %-2d Modê: %† Sèπ : %6d End : %6d Cou¡ : %6d\n", 
k
, 
	`°r_of_ty≥
 (
ö°
.
lo›s
 [k].
mode
), in°.lo›†[k].
°¨t
, in°.lo›†[k].
íd
, in°.lo›†[k].
cou¡
) ;

307 
	`putch¨
 ('\n') ;

308 
	}
}

311 
	$brﬂdˇ°_dump
 (c⁄° *
fûíame
)

312 { 
SNDFILE
 *
fûe
 ;

313 
SF_INFO
 
sföfo
 ;

314 
SF_BROADCAST_INFO
 
bext
 ;

315 
gŸ_bext
 ;

317 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

319 i‡((
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_READ
, &
sföfo
)Ë=
NULL
)

320 { 
	`¥ötf
 ("Eº‹ : NŸábÀÅÿ›í i≈uàfûê%s.\n", 
fûíame
) ;

321 
	`fÊush
 (
°dout
) ;

322 
	`mem£t
 (
d©a
, 0,  (data)) ;

323 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

327 
	`mem£t
 (&
bext
, 0,  (
SF_BROADCAST_INFO
)) ;

329 
gŸ_bext
 = 
	`sf_comm™d
 (
fûe
, 
SFC_GET_BROADCAST_INFO
, &
bext
,  (bext)) ;

330 
	`sf_˛o£
 (
fûe
) ;

332 i‡(
gŸ_bext
 =
SF_FALSE
)

333 { 
	`¥ötf
 ("Eº‹ : Fûê'%s' d€†nŸ c⁄èö brﬂdˇ° inf‹m©i⁄.\n\n", 
fûíame
) ;

337 
	`¥ötf
 ("Des¸ùti⁄ : %.*s\n", (Ë (
bext
.
des¸ùti⁄
), bext.description) ;

338 
	`¥ötf
 ("Origö©‹ : %.*s\n", (Ë (
bext
.
‹igö©‹
), bext.originator) ;

339 
	`¥ötf
 ("Origö©i⁄Ñe‡ : %.*s\n", (Ë (
bext
.
‹igö©‹_ª„ªn˚
), bext.originator_reference) ;

340 
	`¥ötf
 ("Origö©i⁄ d©ê: %.*s\n", (Ë (
bext
.
‹igö©i⁄_d©e
), bext.origination_date) ;

341 
	`¥ötf
 ("Origö©i⁄Åimê: %.*s\n", (Ë (
bext
.
‹igö©i⁄_time
), bext.origination_time) ;

342 
	`¥ötf
 ("BWF vîsi⁄ : %d\n", 
bext
.
vîsi⁄
) ;

343 
	`¥ötf
 ("UMID : %.*s\n", (Ë (
bext
.
umid
), bext.umid) ;

344 
	`¥ötf
 ("Codög hi°‹y : %.*s\n", 
bext
.
codög_hi°‹y_size
, bext.
codög_hi°‹y
) ;

346 
	}
}

	@libsndfile-1.0.17/examples/sndfile-play-beos.cpp

19 
	~<°dio.h
>

21 
	~<Aµliˇti⁄.h
>

22 
	~<SoundPœyî.h
>

23 
	~<°rög.h
>

25 
	~<¢dfûe.h
>

27 
	#BUFFER_LEN
 1024

	)

33 #i‡
deföed
 (
__BEOS__
)

35 
	ssh¨ed_d©a


37 
BSoundPœyî
 *
	m∂ayî
;

38 
SNDFILE
 *
	m¢dfûe
;

39 
SF_INFO
 
	msföfo
;

40 
£m_id
 
	mföished
;

44 
	$buf„r_ˇŒback
(*
theCookõ
, *
buf
, 
size_t
 
size
, c⁄° 
medü_øw_audio_f‹m©
 &
f‹m©
)

46 
sh¨ed_d©a
 *
d©a
 = (sh¨ed_d©®*)
theCookõ
;

47 *
buf„r
 = (*)
buf
;

48 
cou¡
 = 
size
 / ();

49 
m
, 
ªadcou¡
;

51 i‡(!
d©a
->
∂ayî
->
	`HasD©a
())

54 
ªadcou¡
 = 
	`sf_ªad_sh‹t
(
d©a
->
¢dfûe
, 
buf„r
, 
cou¡
);

55 i‡(
ªadcou¡
 == 0)

56 { 
d©a
->
∂ayî
->
	`SëHasD©a
(
Ál£
);

57 
	`ªÀa£_£m
(
d©a
->
föished
);

59 i‡(
ªadcou¡
 < 
cou¡
)

60 { 
m
 = 
ªadcou¡
 ; m < 
cou¡
 ; m++)

61 
buf„r
 [
m
] = 0 ;

63 i‡(
d©a
->
sföfo
.
pcmbôwidth
 < 16)

64 { 
m
 = 0 ; m < 
cou¡
 ; m++)

65 
buf„r
 [
m
] *= 256 ;

67 
	}
}

70 
	$beos_∂ay
 (
¨gc
, *
¨gv
 [])

72 
sh¨ed_d©a
 
d©a
;

73 
°©us_t
 
°©us
;

74 
k
;

77 
BAµliˇti⁄
 
	`≠p
("application/x-vnd.MarcusOverhagen-sfplay");

79 
k
 = 1 ; k < 
¨gc
 ; k++)

80 { 
	`¥ötf
 ("Pœyög %s\n", 
¨gv
 [
k
]) ;

81 i‡(! (
d©a
.
¢dfûe
 = 
	`sf_›í_ªad
 (
¨gv
 [
k
], &d©a.
sföfo
)))

82 { 
	`sf_≥º‹
 (
NULL
) ;

86 i‡(
d©a
.
sföfo
.
ch™√ls
 < 1 || data.sfinfo.channels > 2)

87 { 
	`¥ötf
 ("Eº‹ : ch™√l†%d.\n", 
d©a
.
sföfo
.
ch™√ls
) ;

88 
	`sf_˛o£
 (
d©a
.
¢dfûe
) ;

92 
d©a
.
föished
 = 
	`¸óã_£m
(0,"finished");

94 
medü_øw_audio_f‹m©
 
f‹m©
 =

95 { 
d©a
.
sföfo
.
ßm∂î©e
,

96 
d©a
.
sföfo
.
ch™√ls
,

97 
medü_øw_audio_f‹m©
::
B_AUDIO_SHORT
,

98 
B_HOST_IS_LENDIAN
 ? 
B_MEDIA_LITTLE_ENDIAN
 : 
B_MEDIA_BIG_ENDIAN
,

99 
BUFFER_LEN
 * ()

102 
BSoundPœyî
 
	`∂ayî
(&
f‹m©
,"∂ayî",
buf„r_ˇŒback
,
NULL
,&
d©a
);

103 
d©a
.
∂ayî
 = &player;

105 i‡((
°©us
 = 
∂ayî
.
	`InôCheck
()Ë!
B_OK
)

107 
	`¥ötf
 ("Eº‹ : BSoundPœyî inô faûed, %s.\n", 
	`°ªº‹
(
°©us
)) ;

108 
	`dñëe_£m
(
d©a
.
föished
);

109 
	`sf_˛o£
 (
d©a
.
¢dfûe
) ;

113 
∂ayî
.
	`SëVﬁume
(1.0);

114 
∂ayî
.
	`Sèπ
();

115 
∂ayî
.
	`SëHasD©a
(
åue
);

116 
	`acquúe_£m
(
d©a
.
föished
);

117 
∂ayî
.
	`St›
();

118 
	`dñëe_£m
(
d©a
.
föished
);

120 
	`sf_˛o£
 (
d©a
.
¢dfûe
) ;

124 
	}
}

133 
	$maö
 (
¨gc
, *
¨gv
 [])

135 i‡(
¨gc
 < 2)

136 { 
	`¥ötf
 ("Ußgê: %†<öpuàsound fûe>\n\n", 
¨gv
 [0]) ;

140 
	`beos_∂ay
 (
¨gc
, 
¨gv
) ;

143 
	}
}

	@libsndfile-1.0.17/examples/sndfile-play.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

24 
	~<î∫o.h
>

26 #i‡
HAVE_UNISTD_H


27 
	~<uni°d.h
>

30 #i‡
HAVE_ALSA_ASOUNDLIB_H


31 
	#ALSA_PCM_NEW_HW_PARAMS_API


	)

32 
	#ALSA_PCM_NEW_SW_PARAMS_API


	)

33 
	~<Æß/asoundlib.h
>

34 
	~<sys/time.h
>

37 #i‡
deföed
 (
__löux__
)

38 
	~<f˙é.h
>

39 
	~<sys/io˘l.h
>

40 
	~<sys/soundˇrd.h
>

42 #ñi‡(
deföed
 (
__MACH__
Ë&& deföed (
__APPLE__
))

43 
	~<C¨b⁄.h
>

44 
	~<C‹eAudio/AudioH¨dw¨e.h
>

46 #ñi‡(
deföed
 (
sun
Ë&& deföed (
unix
))

47 
	~<f˙é.h
>

48 
	~<sys/io˘l.h
>

49 
	~<sys/audioio.h
>

51 #ñi‡(
OS_IS_WIN32
 == 1)

52 
	~<wödows.h
>

53 
	~<mmsy°em.h
>

57 
	~<¢dfûe.h
>

59 
	#SIGNED_SIZEOF
(
x
Ë((Ë (x))

	)

60 
	#BUFFER_LEN
 (2048)

	)

66 #i‡
HAVE_ALSA_ASOUNDLIB_H


68 
¢d_pcm_t
 * 
Æß_›í
 (
ch™√ls
, 
§©e
, 
ªÆtime
) ;

69 
Æß_wrôe_Êﬂt
 (
¢d_pcm_t
 *
Æß_dev
, *
d©a
, 
‰ames
, 
ch™√ls
) ;

72 
	$Æß_∂ay
 (
¨gc
, *
¨gv
 [])

73 { 
buf„r
 [
BUFFER_LEN
] ;

74 
SNDFILE
 *
¢dfûe
 ;

75 
SF_INFO
 
sföfo
 ;

76 
¢d_pcm_t
 * 
Æß_dev
 ;

77 
k
, 
ªadcou¡
, 
subf‹m©
 ;

79 
k
 = 1 ; k < 
¨gc
 ; k++)

80 { 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

82 
	`¥ötf
 ("Pœyög %s\n", 
¨gv
 [
k
]) ;

83 i‡(! (
¢dfûe
 = 
	`sf_›í
 (
¨gv
 [
k
], 
SFM_READ
, &
sföfo
)))

84 { 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

88 i‡(
sföfo
.
ch™√ls
 < 1 || sfinfo.channels > 2)

89 { 
	`¥ötf
 ("Eº‹ : ch™√l†%d.\n", 
sföfo
.
ch™√ls
) ;

93 i‡((
Æß_dev
 = 
	`Æß_›í
 (
sföfo
.
ch™√ls
, (Ësföfo.
ßm∂î©e
, 
SF_FALSE
)Ë=
NULL
)

96 
subf‹m©
 = 
sföfo
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

98 i‡(
subf‹m©
 =
SF_FORMAT_FLOAT
 || subf‹m© =
SF_FORMAT_DOUBLE
)

99 { 
sˇÀ
 ;

100 
m
 ;

102 
	`sf_comm™d
 (
¢dfûe
, 
SFC_CALC_SIGNAL_MAX
, &
sˇÀ
,  (scale)) ;

103 i‡(
sˇÀ
 < 1e-10)

104 
sˇÀ
 = 1.0 ;

106 
sˇÀ
 = 32700.0 / scale ;

108 (
ªadcou¡
 = 
	`sf_ªad_Êﬂt
 (
¢dfûe
, 
buf„r
, 
BUFFER_LEN
)))

109 { 
m
 = 0 ; m < 
ªadcou¡
 ; m++)

110 
buf„r
 [
m
] *
sˇÀ
 ;

111 
	`Æß_wrôe_Êﬂt
 (
Æß_dev
, 
buf„r
, 
BUFFER_LEN
 / 
sföfo
.
ch™√ls
, sfinfo.channels) ;

115 { (
ªadcou¡
 = 
	`sf_ªad_Êﬂt
 (
¢dfûe
, 
buf„r
, 
BUFFER_LEN
)))

116 
	`Æß_wrôe_Êﬂt
 (
Æß_dev
, 
buf„r
, 
BUFFER_LEN
 / 
sföfo
.
ch™√ls
, sfinfo.channels) ;

119 
	`¢d_pcm_døö
 (
Æß_dev
) ;

120 
	`¢d_pcm_˛o£
 (
Æß_dev
) ;

122 
	`sf_˛o£
 (
¢dfûe
) ;

126 
	}
}

128 
¢d_pcm_t
 *

129 
	$Æß_›í
 (
ch™√ls
, 
ßm∂î©e
, 
ªÆtime
)

130 { c⁄° * 
devi˚
 = "plughw:0" ;

131 
¢d_pcm_t
 *
Æß_dev
 = 
NULL
 ;

132 
¢d_pcm_hw_∑øms_t
 *
hw_∑øms
 ;

133 
¢d_pcm_u‰ames_t
 
buf„r_size
, 
x„r_Æign
, 
°¨t_thªshﬁd
 ;

134 
¢d_pcm_u‰ames_t
 
Æß_≥riod_size
, 
Æß_buf„r_‰ames
 ;

135 
¢d_pcm_sw_∑øms_t
 *
sw_∑øms
 ;

137 
îr
 ;

139 i‡(
ªÆtime
)

140 { 
Æß_≥riod_size
 = 256 ;

141 
Æß_buf„r_‰ames
 = 3 * 
Æß_≥riod_size
 ;

144 { 
Æß_≥riod_size
 = 1024 ;

145 
Æß_buf„r_‰ames
 = 4 * 
Æß_≥riod_size
 ;

148 i‡((
îr
 = 
	`¢d_pcm_›í
 (&
Æß_dev
, 
devi˚
, 
SND_PCM_STREAM_PLAYBACK
, 0)) < 0)

149 { 
	`Ârötf
 (
°dîr
, "ˇ¬Ÿ o≥¿audiÿdevi˚ \"%s\" (%s)\n", 
devi˚
, 
	`¢d_°ªº‹
 (
îr
)) ;

150 
ˇtch_îr‹
 ;

153 
	`¢d_pcm_n⁄block
 (
Æß_dev
, 0) ;

155 i‡((
îr
 = 
	`¢d_pcm_hw_∑øms_mÆloc
 (&
hw_∑øms
)) < 0)

156 { 
	`Ârötf
 (
°dîr
, "ˇ¬ŸáŒoˇã h¨dw¨ê∑ømëî såu˘uª (%s)\n", 
	`¢d_°ªº‹
 (
îr
)) ;

157 
ˇtch_îr‹
 ;

160 i‡((
îr
 = 
	`¢d_pcm_hw_∑øms_™y
 (
Æß_dev
, 
hw_∑øms
)) < 0)

161 { 
	`Ârötf
 (
°dîr
, "ˇ¬Ÿ inôülizêh¨dw¨ê∑ømëî såu˘uª (%s)\n", 
	`¢d_°ªº‹
 (
îr
)) ;

162 
ˇtch_îr‹
 ;

165 i‡((
îr
 = 
	`¢d_pcm_hw_∑øms_£t_ac˚ss
 (
Æß_dev
, 
hw_∑øms
, 
SND_PCM_ACCESS_RW_INTERLEAVED
)) < 0)

166 { 
	`Ârötf
 (
°dîr
, "ˇ¬Ÿ sëác˚s†ty≥ (%s)\n", 
	`¢d_°ªº‹
 (
îr
)) ;

167 
ˇtch_îr‹
 ;

170 i‡((
îr
 = 
	`¢d_pcm_hw_∑øms_£t_f‹m©
 (
Æß_dev
, 
hw_∑øms
, 
SND_PCM_FORMAT_FLOAT
)) < 0)

171 { 
	`Ârötf
 (
°dîr
, "ˇ¬Ÿ së sam∂êf‹m© (%s)\n", 
	`¢d_°ªº‹
 (
îr
)) ;

172 
ˇtch_îr‹
 ;

175 i‡((
îr
 = 
	`¢d_pcm_hw_∑øms_£t_øã_√¨
 (
Æß_dev
, 
hw_∑øms
, &
ßm∂î©e
, 0)) < 0)

176 { 
	`Ârötf
 (
°dîr
, "ˇ¬Ÿ së sam∂êøã (%s)\n", 
	`¢d_°ªº‹
 (
îr
)) ;

177 
ˇtch_îr‹
 ;

180 i‡((
îr
 = 
	`¢d_pcm_hw_∑øms_£t_ch™√ls
 (
Æß_dev
, 
hw_∑øms
, 
ch™√ls
)) < 0)

181 { 
	`Ârötf
 (
°dîr
, "ˇ¬Ÿ së ch™√»cou¡ (%s)\n", 
	`¢d_°ªº‹
 (
îr
)) ;

182 
ˇtch_îr‹
 ;

185 i‡((
îr
 = 
	`¢d_pcm_hw_∑øms_£t_buf„r_size_√¨
 (
Æß_dev
, 
hw_∑øms
, &
Æß_buf„r_‰ames
)) < 0)

186 { 
	`Ârötf
 (
°dîr
, "ˇ¬Ÿ së buf„∏sizê(%s)\n", 
	`¢d_°ªº‹
 (
îr
)) ;

187 
ˇtch_îr‹
 ;

190 i‡((
îr
 = 
	`¢d_pcm_hw_∑øms_£t_≥riod_size_√¨
 (
Æß_dev
, 
hw_∑øms
, &
Æß_≥riod_size
, 0)) < 0)

191 { 
	`Ârötf
 (
°dîr
, "ˇ¬Ÿ sëÖîiod sizê(%s)\n", 
	`¢d_°ªº‹
 (
îr
)) ;

192 
ˇtch_îr‹
 ;

195 i‡((
îr
 = 
	`¢d_pcm_hw_∑øms
 (
Æß_dev
, 
hw_∑øms
)) < 0)

196 { 
	`Ârötf
 (
°dîr
, "ˇ¬Ÿ sëÖ¨amëî†(%s)\n", 
	`¢d_°ªº‹
 (
îr
)) ;

197 
ˇtch_îr‹
 ;

201 
	`¢d_pcm_hw_∑øms_gë_≥riod_size
 (
hw_∑øms
, &
Æß_≥riod_size
, 0) ;

202 
	`¢d_pcm_hw_∑øms_gë_buf„r_size
 (
hw_∑øms
, &
buf„r_size
) ;

203 i‡(
Æß_≥riod_size
 =
buf„r_size
)

204 { 
	`Ârötf
 (
°dîr
, "C™'àu£ÖîiodÉquÆÅÿbuf„∏sizê(%lu =%lu)", 
Æß_≥riod_size
, 
buf„r_size
) ;

205 
ˇtch_îr‹
 ;

208 
	`¢d_pcm_hw_∑øms_‰ì
 (
hw_∑øms
) ;

210 i‡((
îr
 = 
	`¢d_pcm_sw_∑øms_mÆloc
 (&
sw_∑øms
)) != 0)

211 { 
	`Ârötf
 (
°dîr
, "%s: snd_pcm_sw_∑øms_mÆloc: %s", 
__func__
, 
	`¢d_°ªº‹
 (
îr
)) ;

212 
ˇtch_îr‹
 ;

215 i‡((
îr
 = 
	`¢d_pcm_sw_∑øms_cuºít
 (
Æß_dev
, 
sw_∑øms
)) != 0)

216 { 
	`Ârötf
 (
°dîr
, "%s: snd_pcm_sw_∑øms_cuºít: %s", 
__func__
, 
	`¢d_°ªº‹
 (
îr
)) ;

217 
ˇtch_îr‹
 ;

221 
	`¢d_pcm_sw_∑øms_cuºít
 (
Æß_dev
, 
sw_∑øms
) ;

222 i‡((
îr
 = 
	`¢d_pcm_sw_∑øms_gë_x„r_Æign
 (
sw_∑øms
, &
x„r_Æign
)) < 0)

223 { 
	`Ârötf
 (
°dîr
, "ˇ¬Ÿ gë x„∏Æig¿(%s)\n", 
	`¢d_°ªº‹
 (
îr
)) ;

224 
ˇtch_îr‹
 ;

228 
°¨t_thªshﬁd
 = (
buf„r_size
 / 
x„r_Æign
) * xfer_align ;

229 i‡(
°¨t_thªshﬁd
 < 1)

230 
°¨t_thªshﬁd
 = 1 ;

231 i‡((
îr
 = 
	`¢d_pcm_sw_∑øms_£t_°¨t_thªshﬁd
 (
Æß_dev
, 
sw_∑øms
, 
°¨t_thªshﬁd
)) < 0)

232 { 
	`Ârötf
 (
°dîr
, "ˇ¬Ÿ së sèπÅhªshﬁd (%s)\n", 
	`¢d_°ªº‹
 (
îr
)) ;

233 
ˇtch_îr‹
 ;

236 i‡((
îr
 = 
	`¢d_pcm_sw_∑øms
 (
Æß_dev
, 
sw_∑øms
)) != 0)

237 { 
	`Ârötf
 (
°dîr
, "%s: snd_pcm_sw_∑øms: %s", 
__func__
, 
	`¢d_°ªº‹
 (
îr
)) ;

238 
ˇtch_îr‹
 ;

241 
	`¢d_pcm_sw_∑øms_‰ì
 (
sw_∑øms
) ;

243 
	`¢d_pcm_ª£t
 (
Æß_dev
) ;

245 
ˇtch_îr‹
 :

247 i‡(
îr
 < 0 && 
Æß_dev
 !
NULL
)

248 { 
	`¢d_pcm_˛o£
 (
Æß_dev
) ;

249  
NULL
 ;

252  
Æß_dev
 ;

253 
	}
}

256 
	$Æß_wrôe_Êﬂt
 (
¢d_pcm_t
 *
Æß_dev
, *
d©a
, 
‰ames
, 
ch™√ls
)

257 { 
ïùe_cou¡
 = 0 ;

259 
¢d_pcm_°©us_t
 *
°©us
 ;

260 
tŸÆ
 = 0 ;

261 
ªtvÆ
 ;

263 i‡(
ïùe_cou¡
 > 0)

264 
ïùe_cou¡
 -- ;

266 
tŸÆ
 < 
‰ames
)

267 { 
ªtvÆ
 = 
	`¢d_pcm_wrôei
 (
Æß_dev
, 
d©a
 + 
tŸÆ
 * 
ch™√ls
, 
‰ames
 -Åotal) ;

269 i‡(
ªtvÆ
 >= 0)

270 { 
tŸÆ
 +
ªtvÆ
 ;

271 i‡(
tŸÆ
 =
‰ames
)

272  
tŸÆ
 ;

277 
ªtvÆ
)

278 { -
EAGAIN
 :

279 
	`puts
 ("alsa_write_float: EAGAIN") ;

283 -
EPIPE
 :

284 i‡(
ïùe_cou¡
 > 0)

285 { 
	`¥ötf
 ("Æß_wrôe_Êﬂt: EPIPE %d\n", 
ïùe_cou¡
) ;

286 i‡(
ïùe_cou¡
 > 140)

287  
ªtvÆ
 ;

289 
ïùe_cou¡
 += 100 ;

292 { 
	`¢d_pcm_°©us_Æloˇ
 (&
°©us
) ;

293 i‡((
ªtvÆ
 = 
	`¢d_pcm_°©us
 (
Æß_dev
, 
°©us
)) < 0)

294 
	`Ârötf
 (
°dîr
, "alsa_out: xrun. can't determineÜength\n") ;

295 i‡(
	`¢d_pcm_°©us_gë_°©e
 (
°©us
Ë=
SND_PCM_STATE_XRUN
)

296 { 
timevÆ
 
now
, 
diff
, 
t°amp
 ;

298 
	`gëtimeofday
 (&
now
, 0) ;

299 
	`¢d_pcm_°©us_gë_åiggî_t°amp
 (
°©us
, &
t°amp
) ;

300 
	`timîsub
 (&
now
, &
t°amp
, &
diff
) ;

302 
	`Ârötf
 (
°dîr
, "alsa_write_float xrun: ofátÜeast %.3f msecs.Ñesetting stream\n",

303 
diff
.
tv_£c
 * 1000 + diff.
tv_u£c
 / 1000.0) ;

306 
	`Ârötf
 (
°dîr
, "alsa_write_float: xrun. can't determineÜength\n") ;

309 
	`¢d_pcm_¥ï¨e
 (
Æß_dev
) ;

312 -
EBADFD
 :

313 
	`Ârötf
 (
°dîr
, "alsa_write_float: Bad PCM state.n") ;

317 -
ESTRPIPE
 :

318 
	`Ârötf
 (
°dîr
, "alsa_write_float: SuspendÉvent.n") ;

322 -
EIO
 :

323 
	`puts
 ("alsa_write_float: EIO") ;

327 
	`Ârötf
 (
°dîr
, "Æß_wrôe_Êﬂt:ÑëvÆ = %d\n", 
ªtvÆ
) ;

333  
tŸÆ
 ;

334 
	}
}

342 #i‡
deföed
 (
__löux__
)

344 
löux_›í_d•_devi˚
 (
ch™√ls
, 
§©e
) ;

347 
	$löux_∂ay
 (
¨gc
, *
¨gv
 [])

348 { 
buf„r
 [
BUFFER_LEN
] ;

349 
SNDFILE
 *
¢dfûe
 ;

350 
SF_INFO
 
sföfo
 ;

351 
k
, 
audio_devi˚
, 
ªadcou¡
, 
subf‹m©
 ;

353 
k
 = 1 ; k < 
¨gc
 ; k++)

354 { 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

356 
	`¥ötf
 ("Pœyög %s\n", 
¨gv
 [
k
]) ;

357 i‡(! (
¢dfûe
 = 
	`sf_›í
 (
¨gv
 [
k
], 
SFM_READ
, &
sföfo
)))

358 { 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

362 i‡(
sföfo
.
ch™√ls
 < 1 || sfinfo.channels > 2)

363 { 
	`¥ötf
 ("Eº‹ : ch™√l†%d.\n", 
sföfo
.
ch™√ls
) ;

367 
audio_devi˚
 = 
	`löux_›í_d•_devi˚
 (
sföfo
.
ch™√ls
, sföfo.
ßm∂î©e
) ;

369 
subf‹m©
 = 
sföfo
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

371 i‡(
subf‹m©
 =
SF_FORMAT_FLOAT
 || subf‹m© =
SF_FORMAT_DOUBLE
)

372 { 
Êﬂt_buf„r
 [
BUFFER_LEN
] ;

373 
sˇÀ
 ;

374 
m
 ;

376 
	`sf_comm™d
 (
¢dfûe
, 
SFC_CALC_SIGNAL_MAX
, &
sˇÀ
,  (scale)) ;

377 i‡(
sˇÀ
 < 1e-10)

378 
sˇÀ
 = 1.0 ;

380 
sˇÀ
 = 32700.0 / scale ;

382 (
ªadcou¡
 = 
	`sf_ªad_Êﬂt
 (
¢dfûe
, 
Êﬂt_buf„r
, 
BUFFER_LEN
)))

383 { 
m
 = 0 ; m < 
ªadcou¡
 ; m++)

384 
buf„r
 [
m
] = 
sˇÀ
 * 
Êﬂt_buf„r
 [m] ;

385 
	`wrôe
 (
audio_devi˚
, 
buf„r
, 
ªadcou¡
 *  ()) ;

389 { (
ªadcou¡
 = 
	`sf_ªad_sh‹t
 (
¢dfûe
, 
buf„r
, 
BUFFER_LEN
)))

390 
	`wrôe
 (
audio_devi˚
, 
buf„r
, 
ªadcou¡
 *  ()) ;

393 i‡(
	`io˘l
 (
audio_devi˚
, 
SNDCTL_DSP_POST
, 0) == -1)

394 
	`≥º‹
 ("ioctl (SNDCTL_DSP_POST) ") ;

396 i‡(
	`io˘l
 (
audio_devi˚
, 
SNDCTL_DSP_SYNC
, 0) == -1)

397 
	`≥º‹
 ("ioctl (SNDCTL_DSP_SYNC) ") ;

399 
	`˛o£
 (
audio_devi˚
) ;

401 
	`sf_˛o£
 (
¢dfûe
) ;

405 
	}
}

408 
	$löux_›í_d•_devi˚
 (
ch™√ls
, 
§©e
)

409 { 
fd
, 
°îeo
, 
fmt
 ;

411 i‡((
fd
 = 
	`›í
 ("/dev/d•", 
O_WRONLY
, 0)) == -1 &&

412 (
fd
 = 
	`›í
 ("/dev/sound/d•", 
O_WRONLY
, 0)) == -1)

413 { 
	`≥º‹
 ("linux_open_dsp_device : open ") ;

414 
	`exô
 (1) ;

417 
°îeo
 = 0 ;

418 i‡(
	`io˘l
 (
fd
, 
SNDCTL_DSP_STEREO
, &
°îeo
) == -1)

420 
	`≥º‹
 ("linux_open_dsp_device : stereo ") ;

421 
	`exô
 (1) ;

424 i‡(
	`io˘l
 (
fd
, 
SNDCTL_DSP_RESET
, 0))

425 { 
	`≥º‹
 ("linux_open_dsp_device :Ñeset ") ;

426 
	`exô
 (1) ;

429 
fmt
 = 
CPU_IS_BIG_ENDIAN
 ? 
AFMT_S16_BE
 : 
AFMT_S16_LE
 ;

430 i‡(
	`io˘l
 (
fd
, 
SOUND_PCM_SETFMT
, &
fmt
) != 0)

431 { 
	`≥º‹
 ("linux_open_dsp_device : set format ") ;

432 
	`exô
 (1) ;

435 i‡(
	`io˘l
 (
fd
, 
SOUND_PCM_WRITE_CHANNELS
, &
ch™√ls
) != 0)

436 { 
	`≥º‹
 ("linux_open_dsp_device : channels ") ;

437 
	`exô
 (1) ;

440 i‡(
	`io˘l
 (
fd
, 
SOUND_PCM_WRITE_RATE
, &
§©e
) != 0)

441 { 
	`≥º‹
 ("linux_open_dsp_device : sampleÑate ") ;

442 
	`exô
 (1) ;

445 i‡(
	`io˘l
 (
fd
, 
SNDCTL_DSP_SYNC
, 0) != 0)

446 { 
	`≥º‹
 ("linux_open_dsp_device : sync ") ;

447 
	`exô
 (1) ;

450  
fd
 ;

451 
	}
}

459 #i‡(
deföed
 (
__MACH__
Ë&& deföed (
__APPLE__
))

462 { 
AudioSåómBasicDes¸ùti⁄
 
	mf‹m©
 ;

464 
UI¡32
 
	mbuf_size
 ;

465 
AudioDevi˚ID
 
	mdevi˚
 ;

467 
SNDFILE
 *
	m¢dfûe
 ;

468 
SF_INFO
 
	msföfo
 ;

470 
	mÁke_°îeo
 ;

471 
	md⁄e_∂ayög
 ;

472 } 
	tMacOSXAudioD©a
 ;

474 
	~<m©h.h
>

476 
OSSètus


477 
	$macosx_audio_out_ˇŒback
 (
AudioDevi˚ID
 
devi˚
, c⁄° 
AudioTimeSèmp
* 
cuºít_time
,

478 c⁄° 
AudioBuf„rLi°
* 
d©a_ö
, c⁄° 
AudioTimeSèmp
* 
time_ö
,

479 
AudioBuf„rLi°
* 
d©a_out
, c⁄° 
AudioTimeSèmp
* 
time_out
,

480 * 
˛õ¡_d©a
)

481 { 
MacOSXAudioD©a
 *
audio_d©a
 ;

482 
size
, 
ßm∂e_cou¡
, 
ªad_cou¡
, 
k
 ;

483 *
buf„r
 ;

486 
devi˚
 = device ;

487 
cuºít_time
 = current_time ;

488 
d©a_ö
 = data_in ;

489 
time_ö
 =Åime_in ;

490 
time_out
 =Åime_out ;

492 
audio_d©a
 = (
MacOSXAudioD©a
*Ë
˛õ¡_d©a
 ;

494 
size
 = 
d©a_out
->
mBuf„rs
 [0].
mD©aByãSize
 ;

495 
ßm∂e_cou¡
 = 
size
 /  () ;

497 
buf„r
 = (*Ë
d©a_out
->
mBuf„rs
 [0].
mD©a
 ;

499 i‡(
audio_d©a
->
Áke_°îeo
 != 0)

500 { 
ªad_cou¡
 = 
	`sf_ªad_Êﬂt
 (
audio_d©a
->
¢dfûe
, 
buf„r
, 
ßm∂e_cou¡
 / 2) ;

502 
k
 = 
ªad_cou¡
 - 1 ; k >= 0 ; k--)

503 { 
buf„r
 [2 * 
k
 ] = buffer [k] ;

504 
buf„r
 [2 * 
k
 + 1] = buffer [k] ;

506 
ªad_cou¡
 *= 2 ;

509 
ªad_cou¡
 = 
	`sf_ªad_Êﬂt
 (
audio_d©a
->
¢dfûe
, 
buf„r
, 
ßm∂e_cou¡
) ;

512 i‡(
ªad_cou¡
 < 
ßm∂e_cou¡
)

513 { i‡(
audio_d©a
->
Áke_°îeo
 == 0)

514 
	`mem£t
 (&(
buf„r
 [
ªad_cou¡
]), 0, (
ßm∂e_cou¡
 -Ñead_count) *  ()) ;

516 
audio_d©a
->
d⁄e_∂ayög
 = 
SF_TRUE
 ;

519  
noEº
 ;

520 
	}
}

523 
	$macosx_∂ay
 (
¨gc
, *
¨gv
 [])

524 { 
MacOSXAudioD©a
 
audio_d©a
 ;

525 
OSSètus
 
îr
 ;

526 
UI¡32
 
cou¡
, 
buf„r_size
 ;

527 
k
 ;

529 
audio_d©a
.
Áke_°îeo
 = 0 ;

530 
audio_d©a
.
devi˚
 = 
kAudioDevi˚Unknown
 ;

533 
cou¡
 =  (
AudioDevi˚ID
) ;

534 i‡((
îr
 = 
	`AudioH¨dw¨eGëPr›îty
 (
kAudioH¨dw¨ePr›îtyDeÁu…OuçutDevi˚
,

535 &
cou¡
, (*Ë&(
audio_d©a
.
devi˚
))Ë!
noEº
)

536 { 
	`¥ötf
 ("AudioHardwareGetProperty (kAudioDevicePropertyDefaultOutputDevice) failed.\n") ;

541 
cou¡
 =  (
UI¡32
) ;

542 i‡((
îr
 = 
	`AudioDevi˚GëPr›îty
 (
audio_d©a
.
devi˚
, 0, 
Ál£
, 
kAudioDevi˚Pr›îtyBuf„rSize
,

543 &
cou¡
, &
buf„r_size
)Ë!
noEº
)

544 { 
	`¥ötf
 ("AudioDeviceGetProperty (kAudioDevicePropertyBufferSize) failed.\n") ;

549 
cou¡
 =  (
AudioSåómBasicDes¸ùti⁄
) ;

550 i‡((
îr
 = 
	`AudioDevi˚GëPr›îty
 (
audio_d©a
.
devi˚
, 0, 
Ál£
, 
kAudioDevi˚Pr›îtySåómF‹m©
,

551 &
cou¡
, &(
audio_d©a
.
f‹m©
))Ë!
noEº
)

552 { 
	`¥ötf
 ("AudioDeviceGetProperty (kAudioDevicePropertyStreamFormat) failed.\n") ;

557 
k
 = 1 ; k < 
¨gc
 ; k++)

558 { 
	`¥ötf
 ("Pœyög %s\n", 
¨gv
 [
k
]) ;

559 i‡(! (
audio_d©a
.
¢dfûe
 = 
	`sf_›í
 (
¨gv
 [
k
], 
SFM_READ
, &◊udio_d©a.
sföfo
))))

560 { 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

564 i‡(
audio_d©a
.
sföfo
.
ch™√ls
 < 1 ||áudio_data.sfinfo.channels > 2)

565 { 
	`¥ötf
 ("Eº‹ : ch™√l†%d.\n", 
audio_d©a
.
sföfo
.
ch™√ls
) ;

569 
audio_d©a
.
f‹m©
.
mSam∂eR©e
 =áudio_d©a.
sföfo
.
ßm∂î©e
 ;

571 i‡(
audio_d©a
.
sföfo
.
ch™√ls
 == 1)

572 { 
audio_d©a
.
f‹m©
.
mCh™√lsPîFøme
 = 2 ;

573 
audio_d©a
.
Áke_°îeo
 = 1 ;

576 
audio_d©a
.
f‹m©
.
mCh™√lsPîFøme
 =áudio_d©a.
sföfo
.
ch™√ls
 ;

578 i‡((
îr
 = 
	`AudioDevi˚SëPr›îty
 (
audio_d©a
.
devi˚
, 
NULL
, 0, 
Ál£
, 
kAudioDevi˚Pr›îtySåómF‹m©
,

579  (
AudioSåómBasicDes¸ùti⁄
), &(
audio_d©a
.
f‹m©
))Ë!
noEº
)

580 { 
	`¥ötf
 ("AudioDeviceSetProperty (kAudioDevicePropertyStreamFormat) failed.\n") ;

585 i‡(
audio_d©a
.
f‹m©
.
mF‹m©ID
 !
kAudioF‹m©LöórPCM
)

589 i‡((
îr
 = 
	`AudioDevi˚AddIOProc
 (
audio_d©a
.
devi˚
, 
macosx_audio_out_ˇŒback
,

590 (*Ë&
audio_d©a
)Ë!
noEº
)

591 { 
	`¥ötf
 ("AudioDeviceAddIOProc failed.\n") ;

595 
îr
 = 
	`AudioDevi˚Sèπ
 (
audio_d©a
.
devi˚
, 
macosx_audio_out_ˇŒback
) ;

596 i‡(
îr
 !
noEº
)

599 
audio_d©a
.
d⁄e_∂ayög
 = 
SF_FALSE
 ;

601 
audio_d©a
.
d⁄e_∂ayög
 =
SF_FALSE
)

602 
	`u¶ìp
 (10 * 1000) ;

604 i‡((
îr
 = 
	`AudioDevi˚St›
 (
audio_d©a
.
devi˚
, 
macosx_audio_out_ˇŒback
)Ë!
noEº
)

605 { 
	`¥ötf
 ("AudioDeviceStop failed.\n") ;

609 
îr
 = 
	`AudioDevi˚RemoveIOProc
 (
audio_d©a
.
devi˚
, 
macosx_audio_out_ˇŒback
) ;

610 i‡(
îr
 !
noEº
)

611 { 
	`¥ötf
 ("AudioDeviceRemoveIOProc failed.\n") ;

615 
	`sf_˛o£
 (
audio_d©a
.
¢dfûe
) ;

619 
	}
}

632 #i‡(
OS_IS_WIN32
 == 1)

634 
	#WIN32_BUFFER_LEN
 (1<<15)

	)

637 { 
HWAVEOUT
 
	mhwave
 ;

638 
WAVEHDR
 
	mwhdr
 [2] ;

640 
CRITICAL_SECTION
 
	mmuãx
 ;

641 
HANDLE
 
	mEvít
 ;

643 
	mbuf„r
 [
WIN32_BUFFER_LEN
 /  ()] ;

644 
	mcuºít
, 
	mbuf„æí
 ;

645 
	mBuf„rsInU£
 ;

647 
SNDFILE
 *
	m¢dfûe
 ;

648 
SF_INFO
 
	msföfo
 ;

650 
sf_cou¡_t
 
	mªmaöög
 ;

651 } 
	tWö32_Audio_D©a
 ;

655 
	$wö32_∂ay_d©a
 (
Wö32_Audio_D©a
 *
audio_d©a
)

656 { 
thi§ód
, 
ªadcou¡
 ;

659 
ªadcou¡
 = (
audio_d©a
->
ªmaöög
 >áudio_d©a->
buf„æí
) ?áudio_data->bufferlen : ()áudio_data->remaining ;

661 
thi§ód
 = (Ë
	`sf_ªad_sh‹t
 (
audio_d©a
->
¢dfûe
, (*Ë◊udio_d©a->
whdr
 [audio_d©a->
cuºít
].
ÕD©a
), 
ªadcou¡
) ;

663 
audio_d©a
->
ªmaöög
 -
thi§ód
 ;

665 i‡(
thi§ód
 > 0)

667 i‡(
thi§ód
 < 
audio_d©a
->
buf„æí
)

668 
audio_d©a
->
whdr
 [audio_d©a->
cuºít
].
dwBuf„rLígth
 = 
thi§ód
 *  () ;

671 
	`waveOutWrôe
 (
audio_d©a
->
hwave
, (
LPWAVEHDR
Ë&◊udio_d©a->
whdr
 [audio_d©a->
cuºít
]),  (
WAVEHDR
)) ;

674 
	`E¡îCrôiˇlSe˘i⁄
 (&
audio_d©a
->
muãx
) ;

675 
audio_d©a
->
Buf„rsInU£
 ++ ;

676 
	`LóveCrôiˇlSe˘i⁄
 (&
audio_d©a
->
muãx
) ;

679 
audio_d©a
->
cuºít
 = (audio_data->current + 1) % 2 ;

683 
	}
}

685 
CALLBACK


686 
	$wö32_audio_out_ˇŒback
 (
HWAVEOUT
 
hwave
, 
UINT
 
msg
, 
DWORD
 
d©a
, DWORD 
∑øm1
, DWORD 
∑øm2
)

687 { 
Wö32_Audio_D©a
 *
audio_d©a
 ;

690 
hwave
 = hwave ;

691 
∑øm1
 = 
∑øm2
 ;

693 i‡(
d©a
 == 0)

701 
audio_d©a
 = (
Wö32_Audio_D©a
*Ë
d©a
 ;

704 i‡(
msg
 =
MM_WOM_DONE
)

705 { 
	`E¡îCrôiˇlSe˘i⁄
 (&
audio_d©a
->
muãx
) ;

706 
audio_d©a
->
Buf„rsInU£
 -- ;

707 
	`LóveCrôiˇlSe˘i⁄
 (&
audio_d©a
->
muãx
) ;

708 
	`SëEvít
 (
audio_d©a
->
Evít
) ;

712 
	}
}

715 #i‚de‡
DWORD_PTR


716 
	#DWORD_PTR
 
DWORD


	)

720 
	$wö32_∂ay
 (
¨gc
, *
¨gv
 [])

721 { 
Wö32_Audio_D©a
 
audio_d©a
 ;

723 
WAVEFORMATEX
 
wf
 ;

724 
k
, 
îr‹
 ;

726 
audio_d©a
.
¢dfûe
 = 
NULL
 ;

727 
audio_d©a
.
hwave
 = 0 ;

729 
k
 = 1 ; k < 
¨gc
 ; k++)

730 { 
	`¥ötf
 ("Pœyög %s\n", 
¨gv
 [
k
]) ;

732 i‡(! (
audio_d©a
.
¢dfûe
 = 
	`sf_›í
 (
¨gv
 [
k
], 
SFM_READ
, &◊udio_d©a.
sföfo
))))

733 { 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

737 
audio_d©a
.
ªmaöög
 =áudio_d©a.
sföfo
.
‰ames
 *áudio_d©a.sföfo.
ch™√ls
 ;

738 
audio_d©a
.
cuºít
 = 0 ;

740 
	`InôülizeCrôiˇlSe˘i⁄
 (&
audio_d©a
.
muãx
) ;

741 
audio_d©a
.
Evít
 = 
	`Cª©eEvít
 (0, 
FALSE
, FALSE, 0) ;

743 
wf
.
nCh™√ls
 = 
audio_d©a
.
sföfo
.
ch™√ls
 ;

744 
wf
.
wF‹m©Tag
 = 
WAVE_FORMAT_PCM
 ;

745 
wf
.
cbSize
 = 0 ;

746 
wf
.
wBôsPîSam∂e
 = 16 ;

748 
wf
.
nSam∂esPîSec
 = 
audio_d©a
.
sföfo
.
ßm∂î©e
 ;

750 
wf
.
nBlockAlign
 = 
audio_d©a
.
sföfo
.
ch™√ls
 *  () ;

752 
wf
.
nAvgByãsPîSec
 = wf.
nBlockAlign
 * wf.
nSam∂esPîSec
 ;

754 
îr‹
 = 
	`waveOutO≥n
 (&(
audio_d©a
.
hwave
), 
WAVE_MAPPER
, &
wf
, (
DWORD_PTR
Ë
wö32_audio_out_ˇŒback
,

755 (
DWORD_PTR
Ë&
audio_d©a
, 
CALLBACK_FUNCTION
) ;

756 i‡(
îr‹
)

757 { 
	`puts
 ("waveOutOpen failed.") ;

758 
audio_d©a
.
hwave
 = 0 ;

762 
audio_d©a
.
whdr
 [0].
ÕD©a
 = (*Ëaudio_d©a.
buf„r
 ;

763 
audio_d©a
.
whdr
 [1].
ÕD©a
 = ((*Ëaudio_d©a.
buf„r
) +  (audio_data.buffer) / 2 ;

765 
audio_d©a
.
whdr
 [0].
dwBuf„rLígth
 =  (audio_d©a.
buf„r
) / 2 ;

766 
audio_d©a
.
whdr
 [1].
dwBuf„rLígth
 =  (audio_d©a.
buf„r
) / 2 ;

768 
audio_d©a
.
whdr
 [0].
dwFœgs
 = 0 ;

769 
audio_d©a
.
whdr
 [1].
dwFœgs
 = 0 ;

772 
audio_d©a
.
buf„æí
 =  (audio_d©a.
buf„r
) / 2 /  () ;

775 i‡((
îr‹
 = 
	`waveOutPª∑ªHódî
 (
audio_d©a
.
hwave
, &◊udio_d©a.
whdr
 [0]),  (
WAVEHDR
))))

776 { 
	`¥ötf
 ("waveOutPª∑ªHódî [0] faûed : %08X\n", 
îr‹
) ;

777 
	`waveOutClo£
 (
audio_d©a
.
hwave
) ;

781 i‡((
îr‹
 = 
	`waveOutPª∑ªHódî
 (
audio_d©a
.
hwave
, &◊udio_d©a.
whdr
 [1]),  (
WAVEHDR
))))

782 { 
	`¥ötf
 ("waveOutPª∑ªHódî [1] faûed : %08X\n", 
îr‹
) ;

783 
	`waveOutU≈ª∑ªHódî
 (
audio_d©a
.
hwave
, &◊udio_d©a.
whdr
 [0]),  (
WAVEHDR
)) ;

784 
	`waveOutClo£
 (
audio_d©a
.
hwave
) ;

789 
audio_d©a
.
Buf„rsInU£
 = 0 ;

790 
	`wö32_∂ay_d©a
 (&
audio_d©a
) ;

791 
	`wö32_∂ay_d©a
 (&
audio_d©a
) ;

794 
audio_d©a
.
Buf„rsInU£
 > 0)

797 
	`WaôF‹SögÀObje˘
 (
audio_d©a
.
Evít
, 
INFINITE
) ;

800 
	`wö32_∂ay_d©a
 (&
audio_d©a
) ;

803 
	`waveOutU≈ª∑ªHódî
 (
audio_d©a
.
hwave
, &◊udio_d©a.
whdr
 [0]),  (
WAVEHDR
)) ;

804 
	`waveOutU≈ª∑ªHódî
 (
audio_d©a
.
hwave
, &◊udio_d©a.
whdr
 [1]),  (
WAVEHDR
)) ;

806 
	`waveOutClo£
 (
audio_d©a
.
hwave
) ;

807 
audio_d©a
.
hwave
 = 0 ;

809 
	`DñëeCrôiˇlSe˘i⁄
 (&
audio_d©a
.
muãx
) ;

811 
	`sf_˛o£
 (
audio_d©a
.
¢dfûe
) ;

814 
	}
}

822 #i‡(
deföed
 (
sun
Ë&& deföed (
unix
))

825 
	$sﬁ¨is_∂ay
 (
¨gc
, *
¨gv
 [])

826 { 
buf„r
 [
BUFFER_LEN
] ;

827 
audio_öfo_t
 
audio_öfo
 ;

828 
SNDFILE
 *
¢dfûe
 ;

829 
SF_INFO
 
sföfo
 ;

830 
dñay_time
 ;

831 
k
, 
°¨t_cou¡
, 
ouçut_cou¡
, 
wrôe_cou¡
, 
ªad_cou¡
 ;

832 
audio_fd
, 
îr‹
, 
d⁄e
 ;

834 
k
 = 1 ; k < 
¨gc
 ; k++)

835 { 
	`¥ötf
 ("Pœyög %s\n", 
¨gv
 [
k
]) ;

836 i‡(! (
¢dfûe
 = 
	`sf_›í
 (
¨gv
 [
k
], 
SFM_READ
, &
sföfo
)))

837 { 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

841 i‡(
sföfo
.
ch™√ls
 < 1 || sfinfo.channels > 2)

842 { 
	`¥ötf
 ("Eº‹ : ch™√l†%d.\n", 
sföfo
.
ch™√ls
) ;

847 i‡((
audio_fd
 = 
	`›í
 ("/dev/audio", 
O_WRONLY
 | 
O_NONBLOCK
)) < 0)

848 { 
	`≥º‹
 ("open (/dev/audio) failed") ;

853 
	`AUDIO_INITINFO
 (&
audio_öfo
) ;

855 
audio_öfo
.
∂ay
.
ßm∂e_øã
 = 
sföfo
.
ßm∂î©e
 ;

856 
audio_öfo
.
∂ay
.
ch™√ls
 = 
sföfo
.channels ;

857 
audio_öfo
.
∂ay
.
¥ecisi⁄
 = 16 ;

858 
audio_öfo
.
∂ay
.
ícodög
 = 
AUDIO_ENCODING_LINEAR
 ;

859 
audio_öfo
.
∂ay
.
gaö
 = 
AUDIO_MAX_GAIN
 ;

860 
audio_öfo
.
∂ay
.
bÆ™˚
 = 
AUDIO_MID_BALANCE
 ;

862 i‡((
îr‹
 = 
	`io˘l
 (
audio_fd
, 
AUDIO_SETINFO
, &
audio_öfo
)))

863 { 
	`≥º‹
 ("ioctl (AUDIO_SETINFO) failed") ;

868 
dñay_time
 = (
BUFFER_LEN
 * 1000000Ë/ (
audio_öfo
.
∂ay
.
ßm∂e_øã
 * 4) ;

870 
d⁄e
 = 0 ;

871 ! 
d⁄e
)

872 { 
ªad_cou¡
 = 
	`sf_ªad_sh‹t
 (
¢dfûe
, 
buf„r
, 
BUFFER_LEN
) ;

873 i‡(
ªad_cou¡
 < 
BUFFER_LEN
)

874 { 
	`mem£t
 (&(
buf„r
 [
ªad_cou¡
]), 0, (
BUFFER_LEN
 -Ñead_count) *  ()) ;

876 
d⁄e
 = 
SF_TRUE
 ;

879 
°¨t_cou¡
 = 0 ;

880 
ouçut_cou¡
 = 
BUFFER_LEN
 *  () ;

882 
ouçut_cou¡
 > 0)

884 
wrôe_cou¡
 = 
	`wrôe
 (
audio_fd
, &(
buf„r
 [
°¨t_cou¡
]), 
ouçut_cou¡
) ;

885 i‡(
wrôe_cou¡
 > 0)

886 { 
ouçut_cou¡
 -
wrôe_cou¡
 ;

887 
°¨t_cou¡
 +
wrôe_cou¡
 ;

891 
	`u¶ìp
 (
dñay_time
) ;

896 
	`˛o£
 (
audio_fd
) ;

900 
	}
}

909 
	$maö
 (
¨gc
, *
¨gv
 [])

911 i‡(
¨gc
 < 2)

913 
	`¥ötf
 ("\nUßgê: %†<öpuàsound fûe>\n\n", 
¨gv
 [0]) ;

914 #i‡(
OS_IS_WIN32
 == 1)

915 
	`¥ötf
 ("This isá Unix style commandÜineápplication which\n"

917 
	`¥ötf
 ("Sleeping for 5 seconds beforeÉxiting.\n\n") ;

924 
	`_¶ìp
 (5 * 1000) ;

929 #i‡
	`deföed
 (
__löux__
)

930 #i‡
HAVE_ALSA_ASOUNDLIB_H


931 i‡(
	`ac˚ss
 ("/¥oc/asound/ˇrds", 
R_OK
) == 0)

932 
	`Æß_∂ay
 (
¨gc
, 
¨gv
) ;

935 
	`löux_∂ay
 (
¨gc
, 
¨gv
) ;

936 #ñi‡(
	`deföed
 (
__MACH__
Ë&& deföed (
__APPLE__
))

937 
	`macosx_∂ay
 (
¨gc
, 
¨gv
) ;

938 #ñi‡(
	`deföed
 (
sun
Ë&& deföed (
unix
))

939 
	`sﬁ¨is_∂ay
 (
¨gc
, 
¨gv
) ;

940 #ñi‡(
OS_IS_WIN32
 == 1)

941 
	`wö32_∂ay
 (
¨gc
, 
¨gv
) ;

942 #ñi‡
	`deföed
 (
__BEOS__
)

943 
	`¥ötf
 ("ThisÖrogram cannot be compiled on BeOS.\n") ;

944 
	`¥ötf
 ("Instead, compileÅhe file sfplay_beos.cpp.\n") ;

947 
	`puts
 ("*** Playing soundÇot yet supported onÅhisÖlatform.") ;

948 
	`puts
 ("*** Please feel freeÅo submitáÖatch.") ;

953 
	}
}

	@libsndfile-1.0.17/regtest/checksum.c

23 
	~"c⁄fig.h
"

25 
	~<°dio.h
>

26 
	~<°dlib.h
>

27 
	~<°rög.h
>

29 
	~<¢dfûe.h
>

31 
	~"Êﬂt_ˇ°.h
"

33 
	~"ªgã°.h
"

35 
	#BIG_PRIME
 999983

	)

37 
	#ARRAY_LEN
(
x
Ë((Ë( (x)Ë/ ( ((xË[0])))

	)

39 
sh‹t_checksum
 (
SNDFILE
 * 
fûe
, 
°¨t
) ;

40 
öt_checksum
 (
SNDFILE
 * 
fûe
, 
°¨t
) ;

41 
Êﬂt_checksum
 (
SNDFILE
 * 
fûe
, 
°¨t
) ;

44 
	$ˇlc_checksum
 (
SNDFILE
 * 
fûe
, c⁄° 
SF_INFO
 * 
öfo
)

45 { 
°¨t
 ;

48 
°¨t
 = 
öfo
->
ßm∂î©e
 ;

49 
°¨t
 = sèπ * 
BIG_PRIME
 + 
öfo
->
ch™√ls
 ;

50 
°¨t
 = sèπ * 
BIG_PRIME
 + 
öfo
->
f‹m©
 ;

52 
öfo
->
f‹m©
 & 
SF_FORMAT_SUBMASK
)

53 { 
SF_FORMAT_FLOAT
 :

54 
SF_FORMAT_DOUBLE
 :

55  
	`Êﬂt_checksum
 (
fûe
, 
°¨t
) ;

57 
SF_FORMAT_PCM_24
 :

58 
SF_FORMAT_PCM_32
 :

59  
	`öt_checksum
 (
fûe
, 
°¨t
) ;

62  
	`sh‹t_checksum
 (
fûe
, 
°¨t
) ;

66 
	}
}

72 { 
	ms
 [1 << 16] ;

73 
	mi
 [1 << 15] ;

74 
	mf
 [1 << 15] ;

75 } 
	gd©a
 ;

78 
	$sh‹t_checksum
 (
SNDFILE
 * 
fûe
, 
°¨t
)

79 { 
k
, 
cou¡
 ;

82 { 
cou¡
 = (Ë
	`sf_ªad_sh‹t
 (
fûe
, 
d©a
.
s
, 
	`ARRAY_LEN
 (data.s)) ;

83 
k
 = 0 ; k < 
cou¡
 ; k++)

84 
°¨t
 = sèπ * 
BIG_PRIME
 + 
d©a
.
s
 [
k
] ;

86 
cou¡
 > 0) ;

88  
°¨t
 ;

89 
	}
}

92 
	$öt_checksum
 (
SNDFILE
 * 
fûe
, 
°¨t
)

93 { 
k
, 
cou¡
 ;

96 { 
cou¡
 = (Ë
	`sf_ªad_öt
 (
fûe
, 
d©a
.
i
, 
	`ARRAY_LEN
 (data.i)) ;

97 
k
 = 0 ; k < 
cou¡
 ; k++)

98 
°¨t
 = sèπ * 
BIG_PRIME
 + 
d©a
.
i
 [
k
] ;

100 
cou¡
 > 0) ;

102  
°¨t
 ;

103 
	}
}

106 
	$Êﬂt_checksum
 (
SNDFILE
 * 
fûe
, 
°¨t
)

107 { 
k
, 
cou¡
 ;

110 { 
cou¡
 = (Ë
	`sf_ªad_Êﬂt
 (
fûe
, 
d©a
.
f
, 
	`ARRAY_LEN
 (data.f)) ;

111 
k
 = 0 ; k < 
cou¡
 ; k++)

112 
°¨t
 = sèπ * 
BIG_PRIME
 + 
	`Ãötf
 (0x7FFFFFFF * 
d©a
.
f
 [
k
]) ;

114 
cou¡
 > 0) ;

116  
°¨t
 ;

117 
	}
}

	@libsndfile-1.0.17/regtest/database.c

19 
	~"c⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<uni°d.h
>

24 
	~<°rög.h
>

25 
	~<f˙é.h
>

26 
	~<sys/°©.h
>

28 
	~<¢dfûe.h
>

30 
	~"ªgã°.h
"

32 #i‡
HAVE_SQLITE3


34 
	~<sqlôe3.h
>

37 { 
sqlôe3
 *
	msql
 ;

39 
	mcou¡
 ;

40 
	mekey_max
 ;

43 
	mfûíame
 [256] ;

44 
	m∑th«me
 [512] ;

47 
	mcmdbuf
 [1 << 15] ;

50 
	mlogbuf
 [1 << 14] ;

52 } 
	tREGTEST_DB
 ;

55 
ˇlc_checksum
 (
SNDFILE
 * 
fûe
, c⁄° 
SF_INFO
 * 
öfo
) ;

57 
gë_fûíame_∑th«me
 (
REGTEST_DB
 * 
db
, c⁄° *
fûï©h
) ;

58 
sögÀ_quŸe_ª∂a˚
 (* 
buf
) ;

60 
gë_ekey_‰om_fûíame
 (
REGTEST_DB
 * 
db
, c⁄° *
fûï©h
) ;

61 
gë_fûíame_∑th«me_by_ekey
 (
REGTEST_DB
 * 
db
, 
ekey
) ;

62 
check_fûe_by_ekey
 (
REGTEST_DB
 * 
db
, 
ekey
) ;

64 
cou¡_ˇŒback
 (
REGTEST_DB
 * 
db
, 
¨gc
, **
¨gv
, **
cﬁ«me
) ;

65 
ekey_max_ˇŒback
 (
REGTEST_DB
 * 
db
, 
¨gc
, **
¨gv
, **
cﬁ«me
) ;

66 
ˇŒback
 (*
unu£d
, 
¨gc
, **
¨gv
, **
cﬁ«me
) ;

68 
REG_DB
 *

69 
	$db_›í
 (c⁄° * 
db_«me
)

70 { 
REGTEST_DB
 * 
db
 ;

71 
îr
 ;

73 i‡((
db
 = 
	`mÆloc
 ( (
REGTEST_DB
))Ë=
NULL
)

74 { 
	`≥º‹
 ("malloc") ;

75 
	`exô
 (1) ;

78 i‡((
îr
 = 
	`sqlôe3_›í
 (
db_«me
, &(
db
->
sql
))) != 0)

79 { 
	`¥ötf
 ("C™'à›í d©aba£: %s\n", 
	`sqlôe3_îrmsg
 (
db
->
sql
)) ;

80 
	`sqlôe3_˛o£
 (
db
->
sql
) ;

81 
	`‰ì
 (
db
) ;

82 
	`exô
 (1) ;

85  (
REG_DB
 *Ë
db
 ;

86 
	}
}

89 
	$db_¸óã
 (c⁄° * 
db_«me
)

90 { 
REGTEST_DB
 * 
db
 ;

91 c⁄° *
cmd
 ;

92 * 
îrmsg
 = 
NULL
 ;

93 
îr
 ;

95 
db
 = (
REGTEST_DB
 *Ë
	`db_›í
 (
db_«me
) ;

97 
cmd
 = "createÅable sndfile (ekey INTEGER PRIMARY KEY,"

108 
îr
 = 
	`sqlôe3_exec
 (
db
->
sql
, 
cmd
, 
ˇŒback
, 0, &
îrmsg
) ;

109 i‡(
îr
 !
SQLITE_OK
)

110 
	`¥ötf
 ("Löê%d : SQLÉº‹: %s\n", 
__LINE__
, 
îrmsg
) ;

112 
	`sqlôe3_˛o£
 (
db
->
sql
) ;

113 
	`‰ì
 (
db
) ;

116 
	}
}

119 
	$db_˛o£
 (
REG_DB
 * 
db_h™dÀ
)

120 { 
REGTEST_DB
 * 
db
 ;

122 
db
 = (
REGTEST_DB
 *Ë
db_h™dÀ
 ;

124 
	`sqlôe3_˛o£
 (
db
->
sql
) ;

125 
	`‰ì
 (
db
) ;

128 
	}
}

134 
	$db_fûe_exi°s
 (
REG_DB
 * 
db_h™dÀ
, c⁄° * 
fûíame
)

135 { 
REGTEST_DB
 * 
db
 ;

136 c⁄° * 
˝å
 ;

137 * 
îrmsg
 ;

138 
îr
 ;

140 
db
 = (
REGTEST_DB
 *Ë
db_h™dÀ
 ;

142 i‡((
˝å
 = 
	`°ºchr
 (
fûíame
, '/')Ë!
NULL
)

143 
fûíame
 = 
˝å
 + 1 ;

145 
	`¢¥ötf
 (
db
->
cmdbuf
,  (db->cmdbuf), "£À˘ f«mê‰om sndfûêwhîê‚ame='%s'", 
fûíame
) ;

147 
db
->
cou¡
 = 0 ;

148 
îr
 = 
	`sqlôe3_exec
 (
db
->
sql
, db->
cmdbuf
, (
sqlôe3_ˇŒback
Ë
cou¡_ˇŒback
, db, &
îrmsg
) ;

149 i‡(
db
->
cou¡
 == 1)

153 
	}
}

156 
	$db_add_fûe
 (
REG_DB
 * 
db_h™dÀ
, c⁄° * 
fûï©h
)

157 { 
REGTEST_DB
 * 
db
 ;

158 
SNDFILE
 * 
¢dfûe
 ;

159 
SF_INFO
 
öfo
 ;

160 * 
îrmsg
 ;

161 
îr
, 
checksum
 ;

163 
db
 = (
REGTEST_DB
 *Ë
db_h™dÀ
 ;

165 
	`gë_fûíame_∑th«me
 (
db
, 
fûï©h
) ;

167 i‡(
	`db_fûe_exi°s
 (
db_h™dÀ
, 
fûï©h
))

168 { 
	`¥ötf
 (" %†:áÃódy i¿d©aba£\n", 
db
->
fûíame
) ;

172 
	`mem£t
 (&
öfo
, 0,  (info)) ;

173 
¢dfûe
 = 
	`sf_›í
 (
db
->
∑th«me
, 
SFM_READ
, &
öfo
) ;

174 
	`sf_comm™d
 (
¢dfûe
, 
SFC_GET_LOG_INFO
, 
db
->
logbuf
,  (db->logbuf)) ;

175 
checksum
 = (
¢dfûe
 =
NULL
Ë? 0 : 
	`ˇlc_checksum
 (¢dfûe, &
öfo
) ;

176 
	`sf_˛o£
 (
¢dfûe
) ;

178 i‡(
¢dfûe
 =
NULL
)

179 { 
	`¥ötf
 (" %†: couldÇŸ o≥¿: %s\n", 
db
->
fûíame
, 
	`sf_°ªº‹
 (
NULL
)) ;

180 
	`puts
 (
db
->
logbuf
) ;

184 
	`sögÀ_quŸe_ª∂a˚
 (
db
->
logbuf
) ;

186 
	`¢¥ötf
 (
db
->
cmdbuf
,  (db->cmdbuf), "insert into sndfile "

189 
db
->
fûíame
, db->
∑th«me
, 
öfo
.
ßm∂î©e
, info.
‰ames
, info.
ch™√ls
, info.
f‹m©
, 
checksum
, db->
logbuf
) ;

191 i‡(
	`°æí
 (
db
->
cmdbuf
) >=  (db->cmdbuf) - 1)

192 { 
	`¥ötf
 ("strlen (db->cmdbuf)ÅooÜong.\n") ;

193 
	`exô
 (1) ;

196 
îr
 = 
	`sqlôe3_exec
 (
db
->
sql
, db->
cmdbuf
, 
ˇŒback
, 0, &
îrmsg
) ;

197 i‡(
îr
 !
SQLITE_OK
)

198 { 
	`¥ötf
 ("Löê%d : SQLÉº‹: %s\n", 
__LINE__
, 
îrmsg
) ;

199 
	`puts
 (
db
->
cmdbuf
) ;

203 
	}
}

206 
	$db_check_fûe
 (
REG_DB
 * 
db_h™dÀ
, c⁄° * 
fûï©h
)

207 { 
REGTEST_DB
 * 
db
 ;

208 
ekey
 ;

210 i‡(
	`db_fûe_exi°s
 (
db_h™dÀ
, 
fûï©h
) == 0)

211 { 
	`¥ötf
 ("\nFileÇot in database.\n\n") ;

212 
	`exô
 (0) ;

215 
db
 = (
REGTEST_DB
 *Ë
db_h™dÀ
 ;

217 
ekey
 = 
	`gë_ekey_‰om_fûíame
 (
db
, 
fûï©h
) ;

219  
	`check_fûe_by_ekey
 (
db
, 
ekey
) ;

220 
	}
}

226 
	$db_check_Æl
 (
REG_DB
 * 
db_h™dÀ
)

227 { 
REGTEST_DB
 * 
db
 ;

228 * 
îrmsg
 ;

229 
îr
, 
ekey
 ;

231 
db
 = (
REGTEST_DB
 *Ë
db_h™dÀ
 ;

233 
db
->
ekey_max
 = 0 ;

235 
	`¢¥ötf
 (
db
->
cmdbuf
,  (db->cmdbuf), "selectÉkey from sndfile") ;

237 
îr
 = 
	`sqlôe3_exec
 (
db
->
sql
, db->
cmdbuf
, (
sqlôe3_ˇŒback
Ë
ekey_max_ˇŒback
, db, &
îrmsg
) ;

238 i‡(
îr
 !
SQLITE_OK
)

239 { 
	`¥ötf
 ("Löê%d : SQLÉº‹: %s\n", 
__LINE__
, 
îrmsg
) ;

240 
	`puts
 (
db
->
cmdbuf
) ;

243 
ekey
 = 1 ;Ékey <
db
->
ekey_max
 ;Ékey++)

244 i‡(
	`gë_fûíame_∑th«me_by_ekey
 (
db
, 
ekey
) != 0)

245 
	`check_fûe_by_ekey
 (
db
, 
ekey
) ;

248 
	}
}

252 
	$db_li°_Æl
 (
REG_DB
 * 
db_h™dÀ
)

254 
	`¥ötf
 ("%†: %p\n", 
__func__
, 
db_h™dÀ
) ;

256 
	}
}

259 
	$db_dñ_íåy
 (
REG_DB
 * 
db_h™dÀ
, c⁄° * 
íåy
)

261 
	`¥ötf
 ("%†: %∞%s\n", 
__func__
, 
db_h™dÀ
, 
íåy
) ;

263 
	}
}

269 
	$gë_ekey_‰om_fûíame
 (
REGTEST_DB
 * 
db
, c⁄° *
fûï©h
)

270 { * 
îrmsg
, **
ªsu…
 ;

271 
îr
, 
ekey
 = 0, 
rows
, 
cﬁs
 ;

273 
	`gë_fûíame_∑th«me
 (
db
, 
fûï©h
) ;

275 
	`¢¥ötf
 (
db
->
cmdbuf
,  (db->cmdbuf), "£À˘Ékey from sndfûêwhîê‚ame='%s'", db->
fûíame
) ;

277 
îr
 = 
	`sqlôe3_gë_èbÀ
 (
db
->
sql
, db->
cmdbuf
, &
ªsu…
, &
rows
, &
cﬁs
, &
îrmsg
) ;

278 i‡(
îr
 !
SQLITE_OK
)

279 { 
	`¥ötf
 ("Löê%d : SQLÉº‹: %s\n", 
__LINE__
, 
îrmsg
) ;

280 
	`puts
 (
db
->
cmdbuf
) ;

283 i‡(
cﬁs
 !1 || 
rows
 != 1)

284 { 
	`¥ötf
 ("Bad juju!!Ñow†%d cﬁ†%d\n", 
rows
, 
cﬁs
) ;

285 
	`exô
 (1) ;

288 
ekey
 = 
	`°πﬁ
 (
ªsu…
 [1], 
NULL
, 10) ;

290 
	`sqlôe3_‰ì_èbÀ
 (
ªsu…
) ;

292  
ekey
 ;

293 
	}
}

296 
	$gë_fûíame_∑th«me_by_ekey
 (
REGTEST_DB
 * 
db
, 
ekey
)

297 { *
îrmsg
, **
ªsu…
 ;

298 
îr
, 
rows
, 
cﬁs
 ;

300 
	`¢¥ötf
 (
db
->
cmdbuf
,  (db->cmdbuf), "£À˘ f«me,Â©h from sndfûêwhîêekey='%d'", 
ekey
) ;

302 
îr
 = 
	`sqlôe3_gë_èbÀ
 (
db
->
sql
, db->
cmdbuf
, &
ªsu…
, &
rows
, &
cﬁs
, &
îrmsg
) ;

303 i‡(
îr
 !
SQLITE_OK
)

304 { 
	`¥ötf
 ("Löê%d : SQLÉº‹: %s\n", 
__LINE__
, 
îrmsg
) ;

305 
	`puts
 (
db
->
cmdbuf
) ;

309 i‡(
cﬁs
 !2 || 
rows
 != 1)

310 { 
	`¥ötf
 ("\nEº‹ (%†%dË:Ñow†%d cﬁ†%d\n", 
__func__
, 
__LINE__
, 
rows
, 
cﬁs
) ;

311 
	`exô
 (1) ;

314 
	`°∫˝y
 (
db
->
fûíame
, 
ªsu…
 [2],  (db->filename)) ;

315 
	`°∫˝y
 (
db
->
∑th«me
, 
ªsu…
 [3],  (db->pathname)) ;

317 
	`sqlôe3_‰ì_èbÀ
 (
ªsu…
) ;

320 
	}
}

323 
	$check_fûe_by_ekey
 (
REGTEST_DB
 * 
db
, 
ekey
)

324 { 
SNDFILE
 * 
¢dfûe
 ;

325 
SF_INFO
 
öfo
 ;

326 * 
îrmsg
, **
ªsu…
 ;

327 
îr
, 
k
, 
rows
, 
cﬁs
, 
checksum
 ;

329 
	`¥ötf
 (" %†: ", 
db
->
fûíame
) ;

330 
	`fÊush
 (
°dout
) ;

332 
	`mem£t
 (&
öfo
, 0,  (info)) ;

333 
¢dfûe
 = 
	`sf_›í
 (
db
->
∑th«me
, 
SFM_READ
, &
öfo
) ;

334 
	`sf_comm™d
 (
¢dfûe
, 
SFC_GET_LOG_INFO
, 
db
->
logbuf
,  (db->logbuf)) ;

335 
checksum
 = (
¢dfûe
 =
NULL
Ë? 0 : 
	`ˇlc_checksum
 (¢dfûe, &
öfo
) ;

336 
	`sf_˛o£
 (
¢dfûe
) ;

338 i‡(
¢dfûe
 =
NULL
)

339 { 
	`¥ötf
 ("\n\nEº‹ : CouldÇŸ o≥¿'%s' : %s\n", 
db
->
∑th«me
, 
	`sf_°ªº‹
 (
NULL
)) ;

340 
	`puts
 (
db
->
logbuf
) ;

341 
	`exô
 (1) ;

344 
	`sögÀ_quŸe_ª∂a˚
 (
db
->
logbuf
) ;

346 
	`¢¥ötf
 (
db
->
cmdbuf
,  (db->cmdbuf), "select fname,srate,frames,channels,format,"

347 "checksum,logbu‡‰om sndfûêwhîêekey='%d'", 
ekey
) ;

349 
îr
 = 
	`sqlôe3_gë_èbÀ
 (
db
->
sql
, db->
cmdbuf
, &
ªsu…
, &
rows
, &
cﬁs
, &
îrmsg
) ;

350 i‡(
îr
 !
SQLITE_OK
)

351 { 
	`¥ötf
 ("Löê%d : SQLÉº‹: %s\n", 
__LINE__
, 
îrmsg
) ;

352 
	`puts
 (
db
->
cmdbuf
) ;

355 
k
 = 0 ; k < 
cﬁs
 ; k++)

356 { i‡(
	`°rcmp
 (
ªsu…
 [
k
], "fname") == 0)

357 { i‡(
	`°rcmp
 (
ªsu…
 [
k
 + 
cﬁs
], 
db
->
fûíame
) == 0)

359 
	`¥ötf
 ("\n\nEº‹ : f«mêd€¢'àm©ch : %†!%s\n", 
ªsu…
 [
k
 + 
cﬁs
], 
db
->
fûíame
) ;

362 i‡(
	`°rcmp
 (
ªsu…
 [
k
], "srate") == 0)

363 { i‡(
	`°πﬁ
 (
ªsu…
 [
k
 + 
cﬁs
], 
NULL
, 10Ë=
öfo
.
ßm∂î©e
)

365 
	`¥ötf
 ("\n\nEº‹ : søã d€¢'àm©ch : %†=%d\n", 
ªsu…
 [
k
 + 
cﬁs
], 
öfo
.
ßm∂î©e
) ;

368 i‡(
	`°rcmp
 (
ªsu…
 [
k
], "frames") == 0)

369 { i‡(
	`°πﬁl
 (
ªsu…
 [
k
 + 
cﬁs
], 
NULL
, 10Ë=
öfo
.
‰ames
)

371 
	`¥ötf
 ("\n\nEº‹ : føme†d€¢'àm©ch : %†=%Œd\n", 
ªsu…
 [
k
 + 
cﬁs
], 
öfo
.
‰ames
) ;

374 i‡(
	`°rcmp
 (
ªsu…
 [
k
], "channels") == 0)

375 { i‡(
	`°πﬁ
 (
ªsu…
 [
k
 + 
cﬁs
], 
NULL
, 10Ë=
öfo
.
ch™√ls
)

377 
	`¥ötf
 ("\n\nEº‹ : ch™√l†d€¢'àm©ch : %†=%d\n", 
ªsu…
 [
k
 + 
cﬁs
], 
öfo
.
ch™√ls
) ;

380 i‡(
	`°rcmp
 (
ªsu…
 [
k
], "format") == 0)

381 { i‡(
	`°πﬁ
 (
ªsu…
 [
k
 + 
cﬁs
], 
NULL
, 16Ë=
öfo
.
f‹m©
)

383 
	`¥ötf
 ("\n\nEº‹ : f‹m© d€¢'àm©ch : %†=0x%08x\n", 
ªsu…
 [
k
 + 
cﬁs
], 
öfo
.
f‹m©
) ;

386 i‡(
	`°rcmp
 (
ªsu…
 [
k
], "checksum") == 0)

387 { 
db_vÆ
 = (Ë
	`°πﬁl
 (
ªsu…
 [
k
 + 
cﬁs
], 
NULL
, 16) ;

389 i‡(
db_vÆ
 =
checksum
)

391 
	`¥ötf
 ("\n\nEº‹ : checksum d€¢'àm©ch : 0x%08x =0x%08x\n", 
db_vÆ
, 
checksum
) ;

394 i‡(
	`°rcmp
 (
ªsu…
 [
k
], "logbuf") == 0)

397 
	`¥ötf
 ("\nHîêi†thêﬁdÜogubuf„∏:\n\n%s\n\«ndÅhê√w :\n\n%s\n\n", 
ªsu…
 [2 * 
cﬁs
 - 1], 
db
->
logbuf
) ;

398 
	`exô
 (1) ;

401 
	`sqlôe3_‰ì_èbÀ
 (
ªsu…
) ;

403 
	`puts
 ("ok") ;

406 
	}
}

412 
	$gë_fûíame_∑th«me
 (
REGTEST_DB
 * 
db
, c⁄° *
fûï©h
)

413 { c⁄° * 
˝å
 ;

415 i‡(
fûï©h
 [0] != '/')

416 { 
	`mem£t
 (
db
->
∑th«me
, 0,  (db->pathname)) ;

417 i‡(
	`gëcwd
 (
db
->
∑th«me
,  (db->∑th«me)Ë=
NULL
)

418 { 
	`≥º‹
 ("\ngetcwd failed") ;

419 
	`exô
 (1) ;

422 
db
->
∑th«me
 [
	`°æí
 (db->pathname)] = '/' ;

423 
	`°∫ˇt
 (
db
->
∑th«me
, 
fûï©h
,  (db->pathname)) ;

426 
	`°∫˝y
 (
db
->
∑th«me
, 
fûï©h
,  (db->pathname)) ;

428 i‡((
˝å
 = 
	`°ºchr
 (
db
->
∑th«me
, '/')Ë=
NULL
)

429 { 
	`¥ötf
 ("\nEº‹ : badÖ©h«mê%s\n", 
fûï©h
) ;

430 
	`exô
 (1) ;

433 
	`°∫˝y
 (
db
->
fûíame
, 
˝å
 + 1,  (db->filename)) ;

434 
	}
}

437 
	$sögÀ_quŸe_ª∂a˚
 (* 
buf
)

438 { (
buf
 = 
	`°rchr
 (buf, '\'')) != 0)

439 
buf
 [0] = '"' ;

440 
	}
}

443 
	$cou¡_ˇŒback
 (
REGTEST_DB
 * 
db
, 
¨gc
, **
¨gv
, **
cﬁ«me
)

444 { 
db
->
cou¡
 ++ ;

446 
¨gc
 = 0 ;

447 
¨gv
 = 
NULL
 ;

448 
cﬁ«me
 = 
NULL
 ;

450 
	}
}

453 
	$ekey_max_ˇŒback
 (
REGTEST_DB
 * 
db
, 
¨gc
, **
¨gv
, **
unu£d
)

454 { 
ekey
 ;

456 
¨gc
 = 0 ;

457 
unu£d
 = 
NULL
 ;

459 
ekey
 = 
	`°πﬁ
 (
¨gv
 [0], 
NULL
, 10) ;

460 i‡(
ekey
 > 
db
->
ekey_max
)

461 
db
->
ekey_max
 = 
ekey
 ;

464 
	}
}

467 
	$ˇŒback
 (*
unu£d
, 
¨gc
, **
¨gv
, **
cﬁ«me
)

468 { 
k
 ;

470 
unu£d
 = 
NULL
 ;

472 
k
 = 0 ; k < 
¨gc
 ; k++)

473 
	`¥ötf
 ("%†%s\n", 
cﬁ«me
 [
k
], 
¨gv
 [k] ?árgv [k] : "NULL") ;

475 
	`¥ötf
 ("\n") ;

478 
	}
}

482 
dummy
 () ;

485 
	$dummy
 ()

491 
	}
}

	@libsndfile-1.0.17/regtest/regtest.h

19 
REG_DB_èg
 
	tREG_DB
 ;

22 
REG_DB
 * 
db_›í
 (c⁄° * 
db_«me
) ;

24 
db_¸óã
 (c⁄° * 
db«me
) ;

26 
db_˛o£
 (
REG_DB
 * 
db_h™dÀ
) ;

28 
db_fûe_exi°s
 (
REG_DB
 * 
db_h™dÀ
, c⁄° * 
fûíame
) ;

29 
db_add_fûe
 (
REG_DB
 * 
db_h™dÀ
, c⁄° * 
fûíame
) ;

30 
db_check_fûe
 (
REG_DB
 * 
db_h™dÀ
, c⁄° * 
fûíame
) ;

32 
db_li°_Æl
 (
REG_DB
 * 
db_h™dÀ
) ;

33 
db_check_Æl
 (
REG_DB
 * 
db_h™dÀ
) ;

34 
db_dñ_íåy
 (
REG_DB
 * 
db_h™dÀ
, c⁄° * 
íåy
) ;

37 
ˇlc_checksum
 (
SNDFILE
 * 
fûe
, c⁄° 
SF_INFO
 * 
öfo
) ;

	@libsndfile-1.0.17/regtest/sndfile-regtest.c

19 
	~"c⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

25 
	~<¢dfûe.h
>

27 #i‡
HAVE_SQLITE3


29 
	~"ªgã°.h
"

32 { 
	mOPT_ADD_FILE
 = 0x0100,

33 
	mOPT_CREATE_DB
 = 0x0200,

34 
	mOPT_DEL_ENTRY
 = 0x0400,

35 
	mOPT_LIST_ALL
 = 0x0800,

36 
	mOPT_TEST_ALL
 = 0x1000,

37 
	mOPT_VERBOSE
 = 0x2000

40 
¥öt_lib¢dfûe_vîsi⁄
 () ;

43 
	$maö
 (
¨gc
, * 
¨gv
 [])

44 { c⁄° *
db_«me
 = "./.sndfile-regtest.db" ;

45 
REG_DB
 *
ªg_db
 ;

46 
k
, 
ªtvÆ
 ;

48 i‡(
¨gc
 < 2)

49 { 
	`¥ötf
 ("\nUsage message goes here.\n\n") ;

50 
	`exô
 (0) ;

53 i‡(
¨gc
 =2 && 
	`°rcmp
 (
¨gv
 [1], "--create-db") == 0)

54  
	`db_¸óã
 (
db_«me
) ;

56 
ªg_db
 = 
	`db_›í
 (
db_«me
) ;

58 i‡(
¨gc
 == 2)

59 { i‡(
	`°rcmp
 (
¨gv
 [1], "--list-all") == 0)

60  
	`db_li°_Æl
 (
ªg_db
) ;

62 i‡(
	`°rcmp
 (
¨gv
 [1], "--check-all") == 0)

63 { 
	`¥öt_lib¢dfûe_vîsi⁄
 () ;

64 
ªtvÆ
 = 
	`db_check_Æl
 (
ªg_db
) ;

65 
	`puts
 ("\nDone.\n") ;

66  
ªtvÆ
 ;

70 i‡(
¨gc
 =3 && 
	`°rcmp
 (
¨gv
 [1], "--del-entry") == 0)

71 { 
	`db_dñ_íåy
 (
ªg_db
, 
¨gv
 [2]) ;

72 
	`db_˛o£
 (
ªg_db
) ;

76 i‡(
	`°rcmp
 (
¨gv
 [1], "--check-file") == 0)

77 { 
	`¥öt_lib¢dfûe_vîsi⁄
 () ;

79 
k
 = 2 ; k < 
¨gc
 ; k++)

80 
	`db_check_fûe
 (
ªg_db
, 
¨gv
 [
k
]) ;

81 
	`db_˛o£
 (
ªg_db
) ;

85 i‡(
	`°rcmp
 (
¨gv
 [1], "--add-file") == 0)

86 { 
	`¥öt_lib¢dfûe_vîsi⁄
 () ;

88 
k
 = 2 ; k < 
¨gc
 ; k++)

89 
	`db_add_fûe
 (
ªg_db
, 
¨gv
 [
k
]) ;

90 
	`db_˛o£
 (
ªg_db
) ;

94 
	`¥ötf
 ("\nError : unhandled commandÜineárgs :") ;

95 
k
 = 1 ; k < 
¨gc
 ; k++)

96 
	`¥ötf
 (" %s", 
¨gv
 [
k
]) ;

97 
	`puts
 ("\n") ;

100 
	}
}

103 
	$¥öt_lib¢dfûe_vîsi⁄
 ()

104 { 
vîsi⁄
 [64] ;

106 
	`sf_comm™d
 (
NULL
, 
SFC_GET_LIB_VERSION
, 
vîsi⁄
,  (version)) ;

107 
	`¥ötf
 ("\n¢dfûe-ªgã° : usög %s\n\n", 
vîsi⁄
) ;

108 
	}
}

113 
	$maö
 ()

115 
	`puts
 ("\nThisÖrogram wasÇot compiled withÜibsqlite3ánd hence doesn't work.\n") ;

118 
	}
}

	@libsndfile-1.0.17/src/G72x/g721.c

52 
	~"g72x.h
"

53 
	~"g72x_¥iv.h
"

55 
	gqèb_721
[7] = {-124, 80, 178, 246, 300, 349, 400};

60 
	g_dq èb
[16] = {-2048, 4, 135, 213, 273, 323, 373, 425,

64 
	g_wôab
[16] = {-12, 18, 41, 64, 112, 198, 355, 1122,

71 
	g_fôab
[16] = {0, 0, 0, 0x200, 0x200, 0x200, 0x600, 0xE00,

81 
	$g721_ícodî
(

82 
¶
,

83 
G72x_STATE
 *
°©e_±r
)

85 
£zi
, 
£
, 
£z
;

86 
d
;

87 
§
;

88 
y
;

89 
dq£z
;

90 
dq
, 
i
;

93 
¶
 >>= 2;

95 
£zi
 = 
	`¥edi˘‹_zîo
(
°©e_±r
);

96 
£z
 = 
£zi
 >> 1;

97 
£
 = (
£zi
 + 
	`¥edi˘‹_pﬁe
(
°©e_±r
)) >> 1;

99 
d
 = 
¶
 - 
£
;

102 
y
 = 
	`°ï_size
(
°©e_±r
);

103 
i
 = 
	`qu™tize
(
d
, 
y
, 
qèb_721
, 7);

105 
dq
 = 
	`ªc⁄°ru˘
(
i
 & 8, 
_dq èb
[i], 
y
);

107 
§
 = (
dq
 < 0Ë? 
£
 - (dq & 0x3FFF) : se + dq;

109 
dq£z
 = 
§
 + 
£z
 - 
£
;

111 
	`upd©e
(4, 
y
, 
_wôab
[
i
] << 5, 
_fôab
[i], 
dq
, 
§
, 
dq£z
, 
°©e_±r
);

113  (
i
);

114 
	}
}

126 
	$g721_decodî
(

127 
i
,

128 
G72x_STATE
 *
°©e_±r
)

130 
£zi
, 
£i
, 
£z
, 
£
;

131 
y
;

132 
§
;

133 
dq
;

134 
dq£z
;

136 
i
 &= 0x0f;

137 
£zi
 = 
	`¥edi˘‹_zîo
(
°©e_±r
);

138 
£z
 = 
£zi
 >> 1;

139 
£i
 = 
£zi
 + 
	`¥edi˘‹_pﬁe
(
°©e_±r
);

140 
£
 = 
£i
 >> 1;

142 
y
 = 
	`°ï_size
(
°©e_±r
);

144 
dq
 = 
	`ªc⁄°ru˘
(
i
 & 0x08, 
_dq èb
[i], 
y
);

146 
§
 = (
dq
 < 0Ë? (
£
 - (dq & 0x3FFF)) : se + dq;

148 
dq£z
 = 
§
 - 
£
 + 
£z
;

150 
	`upd©e
(4, 
y
, 
_wôab
[
i
] << 5, 
_fôab
[i], 
dq
, 
§
, 
dq£z
, 
°©e_±r
);

153  (
§
 << 2);

154 
	}
}

	@libsndfile-1.0.17/src/G72x/g723_16.c

46 
	~"g72x.h
"

47 
	~"g72x_¥iv.h
"

53 
	g_dq èb
[4] = { 116, 365, 365, 116};

60 
	g_wôab
[4] = {-704, 14048, 14048, -704};

69 
	g_fôab
[4] = {0, 0xE00, 0xE00, 0};

73 
	gqèb_723_16
[1] = {261};

83 
	$g723_16_ícodî
(

84 
¶
,

85 
G72x_STATE
 *
°©e_±r
)

87 
£i
, 
£zi
, 
£
, 
£z
;

88 
d
;

89 
y
;

90 
§
;

91 
dq£z
;

92 
dq
, 
i
;

95 
¶
 >>= 2;

97 
£zi
 = 
	`¥edi˘‹_zîo
(
°©e_±r
);

98 
£z
 = 
£zi
 >> 1;

99 
£i
 = 
£zi
 + 
	`¥edi˘‹_pﬁe
(
°©e_±r
);

100 
£
 = 
£i
 >> 1;

102 
d
 = 
¶
 - 
£
;

105 
y
 = 
	`°ï_size
(
°©e_±r
);

106 
i
 = 
	`qu™tize
(
d
, 
y
, 
qèb_723_16
, 1);

111 i‡(
i
 == 3)

112 i‡((
d
 & 0x8000) == 0)

113 
i
 = 0;

115 
dq
 = 
	`ªc⁄°ru˘
(
i
 & 2, 
_dq èb
[i], 
y
);

117 
§
 = (
dq
 < 0Ë? 
£
 - (dq & 0x3FFF) : se + dq;

119 
dq£z
 = 
§
 + 
£z
 - 
£
;

121 
	`upd©e
(2, 
y
, 
_wôab
[
i
], 
_fôab
[i], 
dq
, 
§
, 
dq£z
, 
°©e_±r
);

123  (
i
);

124 
	}
}

134 
	$g723_16_decodî
(

135 
i
,

136 
G72x_STATE
 *
°©e_±r
)

138 
£zi
, 
£i
, 
£z
, 
£
;

139 
y
;

140 
§
;

141 
dq
;

142 
dq£z
;

144 
i
 &= 0x03;

145 
£zi
 = 
	`¥edi˘‹_zîo
(
°©e_±r
);

146 
£z
 = 
£zi
 >> 1;

147 
£i
 = 
£zi
 + 
	`¥edi˘‹_pﬁe
(
°©e_±r
);

148 
£
 = 
£i
 >> 1;

150 
y
 = 
	`°ï_size
(
°©e_±r
);

151 
dq
 = 
	`ªc⁄°ru˘
(
i
 & 0x02, 
_dq èb
[i], 
y
);

153 
§
 = (
dq
 < 0Ë? (
£
 - (dq & 0x3FFF)) : (se + dq);

155 
dq£z
 = 
§
 - 
£
 + 
£z
;

157 
	`upd©e
(2, 
y
, 
_wôab
[
i
], 
_fôab
[i], 
dq
, 
§
, 
dq£z
, 
°©e_±r
);

160  (
§
 << 2);

161 
	}
}

	@libsndfile-1.0.17/src/G72x/g723_24.c

41 
	~"g72x.h
"

42 
	~"g72x_¥iv.h
"

48 
	g_dq èb
[8] = {-2048, 135, 273, 373, 373, 273, 135, -2048};

51 
	g_wôab
[8] = {-128, 960, 4384, 18624, 18624, 4384, 960, -128};

58 
	g_fôab
[8] = {0, 0x200, 0x400, 0xE00, 0xE00, 0x400, 0x200, 0};

60 
	gqèb_723_24
[3] = {8, 218, 331};

69 
	$g723_24_ícodî
(

70 
¶
,

71 
G72x_STATE
 *
°©e_±r
)

73 
£i
, 
£zi
, 
£
, 
£z
;

74 
d
;

75 
y
;

76 
§
;

77 
dq£z
;

78 
dq
, 
i
;

81 
¶
 >>= 2;

83 
£zi
 = 
	`¥edi˘‹_zîo
(
°©e_±r
);

84 
£z
 = 
£zi
 >> 1;

85 
£i
 = 
£zi
 + 
	`¥edi˘‹_pﬁe
(
°©e_±r
);

86 
£
 = 
£i
 >> 1;

88 
d
 = 
¶
 - 
£
;

91 
y
 = 
	`°ï_size
(
°©e_±r
);

92 
i
 = 
	`qu™tize
(
d
, 
y
, 
qèb_723_24
, 3);

93 
dq
 = 
	`ªc⁄°ru˘
(
i
 & 4, 
_dq èb
[i], 
y
);

95 
§
 = (
dq
 < 0Ë? 
£
 - (dq & 0x3FFF) : se + dq;

97 
dq£z
 = 
§
 + 
£z
 - 
£
;

99 
	`upd©e
(3, 
y
, 
_wôab
[
i
], 
_fôab
[i], 
dq
, 
§
, 
dq£z
, 
°©e_±r
);

101  (
i
);

102 
	}
}

112 
	$g723_24_decodî
(

113 
i
,

114 
G72x_STATE
 *
°©e_±r
)

116 
£zi
, 
£i
, 
£z
, 
£
;

117 
y
;

118 
§
;

119 
dq
;

120 
dq£z
;

122 
i
 &= 0x07;

123 
£zi
 = 
	`¥edi˘‹_zîo
(
°©e_±r
);

124 
£z
 = 
£zi
 >> 1;

125 
£i
 = 
£zi
 + 
	`¥edi˘‹_pﬁe
(
°©e_±r
);

126 
£
 = 
£i
 >> 1;

128 
y
 = 
	`°ï_size
(
°©e_±r
);

129 
dq
 = 
	`ªc⁄°ru˘
(
i
 & 0x04, 
_dq èb
[i], 
y
);

131 
§
 = (
dq
 < 0Ë? (
£
 - (dq & 0x3FFF)) : (se + dq);

133 
dq£z
 = 
§
 - 
£
 + 
£z
;

135 
	`upd©e
(3, 
y
, 
_wôab
[
i
], 
_fôab
[i], 
dq
, 
§
, 
dq£z
, 
°©e_±r
);

137  (
§
 << 2);

138 
	}
}

	@libsndfile-1.0.17/src/G72x/g723_40.c

49 
	~"g72x.h
"

50 
	~"g72x_¥iv.h
"

56 
	g_dq èb
[32] = {-2048, -66, 28, 104, 169, 224, 274, 318,

62 
	g_wôab
[32] = {448, 448, 768, 1248, 1280, 1312, 1856, 3200,

72 
	g_fôab
[32] = {0, 0, 0, 0, 0, 0x200, 0x200, 0x200,

77 
	gqèb_723_40
[15] = {-122, -16, 68, 139, 198, 250, 298, 339,

87 
	$g723_40_ícodî
 (
¶
, 
G72x_STATE
 *
°©e_±r
)

89 
£i
, 
£zi
, 
£
, 
£z
;

90 
d
;

91 
y
;

92 
§
;

93 
dq£z
;

94 
dq
, 
i
;

97 
¶
 >>= 2;

99 
£zi
 = 
	`¥edi˘‹_zîo
(
°©e_±r
);

100 
£z
 = 
£zi
 >> 1;

101 
£i
 = 
£zi
 + 
	`¥edi˘‹_pﬁe
(
°©e_±r
);

102 
£
 = 
£i
 >> 1;

104 
d
 = 
¶
 - 
£
;

107 
y
 = 
	`°ï_size
(
°©e_±r
);

108 
i
 = 
	`qu™tize
(
d
, 
y
, 
qèb_723_40
, 15);

110 
dq
 = 
	`ªc⁄°ru˘
(
i
 & 0x10, 
_dq èb
[i], 
y
);

112 
§
 = (
dq
 < 0Ë? 
£
 - (dq & 0x7FFF) : se + dq;

114 
dq£z
 = 
§
 + 
£z
 - 
£
;

116 
	`upd©e
(5, 
y
, 
_wôab
[
i
], 
_fôab
[i], 
dq
, 
§
, 
dq£z
, 
°©e_±r
);

118  (
i
);

119 
	}
}

128 
	$g723_40_decodî
 (
i
, 
G72x_STATE
 *
°©e_±r
)

130 
£zi
, 
£i
, 
£z
, 
£
;

131 
y
 ;

132 
§
;

133 
dq
;

134 
dq£z
;

136 
i
 &= 0x1f;

137 
£zi
 = 
	`¥edi˘‹_zîo
(
°©e_±r
);

138 
£z
 = 
£zi
 >> 1;

139 
£i
 = 
£zi
 + 
	`¥edi˘‹_pﬁe
(
°©e_±r
);

140 
£
 = 
£i
 >> 1;

142 
y
 = 
	`°ï_size
(
°©e_±r
);

143 
dq
 = 
	`ªc⁄°ru˘
(
i
 & 0x10, 
_dq èb
[i], 
y
);

145 
§
 = (
dq
 < 0Ë? (
£
 - (dq & 0x7FFF)) : (se + dq);

147 
dq£z
 = 
§
 - 
£
 + 
£z
;

149 
	`upd©e
(5, 
y
, 
_wôab
[
i
], 
_fôab
[i], 
dq
, 
§
, 
dq£z
, 
°©e_±r
);

151  (
§
 << 2);

152 
	}
}

	@libsndfile-1.0.17/src/G72x/g72x.c

33 
	~<°dio.h
>

34 
	~<°dlib.h
>

35 
	~<°rög.h
>

37 
	~"g72x.h
"

38 
	~"g72x_¥iv.h
"

40 
G72x_STATE
 * 
g72x_°©e_√w
 () ;

41 
u≈ack_byãs
 (
bôs
, 
blocksize
, c⁄° * 
block
, * 
ßm∂es
) ;

42 
∑ck_byãs
 (
bôs
, c⁄° * 
ßm∂es
, * 
block
) ;

45 
	gpowî2
 [15] =

59 
	$qu™
 (
vÆ
, *
èbÀ
, 
size
)

61 
i
;

63 
i
 = 0; i < 
size
; i++)

64 i‡(
vÆ
 < *
èbÀ
++)

66  (
i
);

67 
	}
}

76 
	$fmu…
 (
™
, 
§n
)

78 
™mag
, 
™exp
, 
™m™t
;

79 
w™exp
, 
w™m™t
;

80 
ªtvÆ
;

82 
™mag
 = (
™
 > 0) ?án : ((-an) & 0x1FFF);

83 
™exp
 = 
	`qu™
(
™mag
, 
powî2
, 15) - 6;

84 
™m™t
 = (
™mag
 == 0) ? 32 :

85 (
™exp
 >0Ë? 
™mag
 >>ánexp :ánmag << -anexp;

86 
w™exp
 = 
™exp
 + ((
§n
 >> 6) & 0xF) - 13;

95 
w™m™t
 = (
™m™t
 * (
§n
 & 0x37)) >> 4 ;

97 
ªtvÆ
 = (
w™exp
 >0Ë? ((
w™m™t
 << wanexp) & 0x7FFF) :

98 (
w™m™t
 >> -
w™exp
);

100  (((
™
 ^ 
§n
Ë< 0Ë? -
ªtvÆ
 :Ñetval);

101 
	}
}

103 
G72x_STATE
 * 
	$g72x_°©e_√w
 ()

104 {  
	`ˇŒoc
 (1,  (
G72x_STATE
)) ;

105 
	}
}

114 
	$¥iv©e_öô_°©e
 (
G72x_STATE
 *
°©e_±r
)

116 
˙è
;

118 
°©e_±r
->
yl
 = 34816;

119 
°©e_±r
->
yu
 = 544;

120 
°©e_±r
->
dms
 = 0;

121 
°©e_±r
->
dml
 = 0;

122 
°©e_±r
->
≠
 = 0;

123 
˙è
 = 0; cnta < 2; cnta++) {

124 
°©e_±r
->
a
[
˙è
] = 0;

125 
°©e_±r
->
pk
[
˙è
] = 0;

126 
°©e_±r
->
§
[
˙è
] = 32;

128 
˙è
 = 0; cnta < 6; cnta++) {

129 
°©e_±r
->
b
[
˙è
] = 0;

130 
°©e_±r
->
dq
[
˙è
] = 32;

132 
°©e_±r
->
td
 = 0;

133 
	}
}

135 
g72x_°©e
 * 
	$g72x_ªadî_öô
 (
codec
, *
blocksize
, *
ßm∂e•îblock
)

136 { 
G72x_STATE
 *
p°©e
 ;

138 i‡((
p°©e
 = 
	`g72x_°©e_√w
 ()Ë=
NULL
)

139  
NULL
 ;

141 
	`¥iv©e_öô_°©e
 (
p°©e
) ;

143 
p°©e
->
ícodî
 = 
NULL
 ;

145 
codec
)

146 { 
G723_16_BITS_PER_SAMPLE
 :

147 
p°©e
->
decodî
 = 
g723_16_decodî
 ;

148 *
blocksize
 = 
G723_16_BYTES_PER_BLOCK
 ;

149 *
ßm∂e•îblock
 = 
G723_16_SAMPLES_PER_BLOCK
 ;

150 
p°©e
->
codec_bôs
 = 2 ;

151 
p°©e
->
blocksize
 = 
G723_16_BYTES_PER_BLOCK
 ;

152 
p°©e
->
ßm∂e•îblock
 = 
G723_16_SAMPLES_PER_BLOCK
 ;

155 
G723_24_BITS_PER_SAMPLE
 :

156 
p°©e
->
decodî
 = 
g723_24_decodî
 ;

157 *
blocksize
 = 
G723_24_BYTES_PER_BLOCK
 ;

158 *
ßm∂e•îblock
 = 
G723_24_SAMPLES_PER_BLOCK
 ;

159 
p°©e
->
codec_bôs
 = 3 ;

160 
p°©e
->
blocksize
 = 
G723_24_BYTES_PER_BLOCK
 ;

161 
p°©e
->
ßm∂e•îblock
 = 
G723_24_SAMPLES_PER_BLOCK
 ;

164 
G721_32_BITS_PER_SAMPLE
 :

165 
p°©e
->
decodî
 = 
g721_decodî
 ;

166 *
blocksize
 = 
G721_32_BYTES_PER_BLOCK
 ;

167 *
ßm∂e•îblock
 = 
G721_32_SAMPLES_PER_BLOCK
 ;

168 
p°©e
->
codec_bôs
 = 4 ;

169 
p°©e
->
blocksize
 = 
G721_32_BYTES_PER_BLOCK
 ;

170 
p°©e
->
ßm∂e•îblock
 = 
G721_32_SAMPLES_PER_BLOCK
 ;

173 
G721_40_BITS_PER_SAMPLE
 :

174 
p°©e
->
decodî
 = 
g723_40_decodî
 ;

175 *
blocksize
 = 
G721_40_BYTES_PER_BLOCK
 ;

176 *
ßm∂e•îblock
 = 
G721_40_SAMPLES_PER_BLOCK
 ;

177 
p°©e
->
codec_bôs
 = 5 ;

178 
p°©e
->
blocksize
 = 
G721_40_BYTES_PER_BLOCK
 ;

179 
p°©e
->
ßm∂e•îblock
 = 
G721_40_SAMPLES_PER_BLOCK
 ;

183 
	`‰ì
 (
p°©e
) ;

184  
NULL
 ;

187  
p°©e
 ;

188 
	}
}

190 
g72x_°©e
 * 
	$g72x_wrôî_öô
 (
codec
, *
blocksize
, *
ßm∂e•îblock
)

191 { 
G72x_STATE
 *
p°©e
 ;

193 i‡((
p°©e
 = 
	`g72x_°©e_√w
 ()Ë=
NULL
)

194  
NULL
 ;

196 
	`¥iv©e_öô_°©e
 (
p°©e
) ;

197 
p°©e
->
decodî
 = 
NULL
 ;

199 
codec
)

200 { 
G723_16_BITS_PER_SAMPLE
 :

201 
p°©e
->
ícodî
 = 
g723_16_ícodî
 ;

202 *
blocksize
 = 
G723_16_BYTES_PER_BLOCK
 ;

203 *
ßm∂e•îblock
 = 
G723_16_SAMPLES_PER_BLOCK
 ;

204 
p°©e
->
codec_bôs
 = 2 ;

205 
p°©e
->
blocksize
 = 
G723_16_BYTES_PER_BLOCK
 ;

206 
p°©e
->
ßm∂e•îblock
 = 
G723_16_SAMPLES_PER_BLOCK
 ;

209 
G723_24_BITS_PER_SAMPLE
 :

210 
p°©e
->
ícodî
 = 
g723_24_ícodî
 ;

211 *
blocksize
 = 
G723_24_BYTES_PER_BLOCK
 ;

212 *
ßm∂e•îblock
 = 
G723_24_SAMPLES_PER_BLOCK
 ;

213 
p°©e
->
codec_bôs
 = 3 ;

214 
p°©e
->
blocksize
 = 
G723_24_BYTES_PER_BLOCK
 ;

215 
p°©e
->
ßm∂e•îblock
 = 
G723_24_SAMPLES_PER_BLOCK
 ;

218 
G721_32_BITS_PER_SAMPLE
 :

219 
p°©e
->
ícodî
 = 
g721_ícodî
 ;

220 *
blocksize
 = 
G721_32_BYTES_PER_BLOCK
 ;

221 *
ßm∂e•îblock
 = 
G721_32_SAMPLES_PER_BLOCK
 ;

222 
p°©e
->
codec_bôs
 = 4 ;

223 
p°©e
->
blocksize
 = 
G721_32_BYTES_PER_BLOCK
 ;

224 
p°©e
->
ßm∂e•îblock
 = 
G721_32_SAMPLES_PER_BLOCK
 ;

227 
G721_40_BITS_PER_SAMPLE
 :

228 
p°©e
->
ícodî
 = 
g723_40_ícodî
 ;

229 *
blocksize
 = 
G721_40_BYTES_PER_BLOCK
 ;

230 *
ßm∂e•îblock
 = 
G721_40_SAMPLES_PER_BLOCK
 ;

231 
p°©e
->
codec_bôs
 = 5 ;

232 
p°©e
->
blocksize
 = 
G721_40_BYTES_PER_BLOCK
 ;

233 
p°©e
->
ßm∂e•îblock
 = 
G721_40_SAMPLES_PER_BLOCK
 ;

237 
	`‰ì
 (
p°©e
) ;

238  
NULL
 ;

241  
p°©e
 ;

242 
	}
}

244 
	$g72x_decode_block
 (
G72x_STATE
 *
p°©e
, c⁄° *
block
, *
ßm∂es
)

245 { 
k
, 
cou¡
 ;

247 
cou¡
 = 
	`u≈ack_byãs
 (
p°©e
->
codec_bôs
,Ö°©e->
blocksize
, 
block
, 
ßm∂es
) ;

249 
k
 = 0 ; k < 
cou¡
 ; k++)

250 
ßm∂es
 [
k
] = 
p°©e
->
	`decodî
 (samples [k],Östate) ;

253 
	}
}

255 
	$g72x_ícode_block
 (
G72x_STATE
 *
p°©e
, *
ßm∂es
, *
block
)

256 { 
k
, 
cou¡
 ;

258 
k
 = 0 ; k < 
p°©e
->
ßm∂e•îblock
 ; k++)

259 
ßm∂es
 [
k
] = 
p°©e
->
	`ícodî
 (samples [k],Östate) ;

261 
cou¡
 = 
	`∑ck_byãs
 (
p°©e
->
codec_bôs
, 
ßm∂es
, 
block
) ;

263  
cou¡
 ;

264 
	}
}

272 
	$¥edi˘‹_zîo
 (
G72x_STATE
 *
°©e_±r
)

274 
i
;

275 
£zi
;

277 
£zi
 = 
	`fmu…
(
°©e_±r
->
b
[0] >> 2, sèã_±r->
dq
[0]);

278 
i
 = 1; i < 6; i++)

279 
£zi
 +
	`fmu…
(
°©e_±r
->
b
[
i
] >> 2, sèã_±r->
dq
[i]);

280  (
£zi
);

281 
	}
}

288 
	$¥edi˘‹_pﬁe
(
G72x_STATE
 *
°©e_±r
)

290  (
	`fmu…
(
°©e_±r
->
a
[1] >> 2, sèã_±r->
§
[1]) +

291 
	`fmu…
(
°©e_±r
->
a
[0] >> 2, sèã_±r->
§
[0]));

292 
	}
}

299 
	$°ï_size
 (
G72x_STATE
 *
°©e_±r
)

301 
y
;

302 
dif
;

303 
Æ
;

305 i‡(
°©e_±r
->
≠
 >= 256)

306  (
°©e_±r
->
yu
);

308 
y
 = 
°©e_±r
->
yl
 >> 6;

309 
dif
 = 
°©e_±r
->
yu
 - 
y
;

310 
Æ
 = 
°©e_±r
->
≠
 >> 2;

311 i‡(
dif
 > 0)

312 
y
 +(
dif
 * 
Æ
) >> 6;

313 i‡(
dif
 < 0)

314 
y
 +(
dif
 * 
Æ
 + 0x3F) >> 6;

315  (
y
);

317 
	}
}

328 
	$qu™tize
(

329 
d
,

330 
y
,

331 *
èbÀ
,

332 
size
)

334 
dqm
;

335 
exp⁄
;

336 
m™t
;

337 
dl
;

338 
d 
;

339 
i
;

346 
dqm
 = 
	`abs
(
d
);

347 
exp⁄
 = 
	`qu™
(
dqm
 >> 1, 
powî2
, 15);

348 
m™t
 = ((
dqm
 << 7Ë>> 
exp⁄
) & 0x7F;

349 
dl
 = (
exp⁄
 << 7Ë+ 
m™t
;

356 
d 
 = 
dl
 - (
y
 >> 2);

363 
i
 = 
	`qu™
(
d 
, 
èbÀ
, 
size
);

364 i‡(
d
 < 0)

365  ((
size
 << 1Ë+ 1 - 
i
);

366 i‡(
i
 == 0)

367  ((
size
 << 1) + 1);

369  (
i
);

370 
	}
}

379 
	$ªc⁄°ru˘
(

380 
sign
,

381 
dq 
,

382 
y
)

384 
dql
;

385 
dex
;

386 
dqt
;

387 
dq
;

389 
dql
 = 
dq 
 + (
y
 >> 2);

391 i‡(
dql
 < 0) {

392  ((
sign
) ? -0x8000 : 0);

394 
dex
 = (
dql
 >> 7) & 15;

395 
dqt
 = 128 + (
dql
 & 127);

396 
dq
 = (
dqt
 << 7Ë>> (14 - 
dex
);

397  ((
sign
Ë? (
dq
 - 0x8000) : dq);

399 
	}
}

408 
	$upd©e
(

409 
code_size
,

410 
y
,

411 
wi
,

412 
fi
,

413 
dq
,

414 
§
,

415 
dq£z
,

416 
G72x_STATE
 *
°©e_±r
)

418 
˙t
;

419 
mag
, 
exp⁄
;

420 
a2p
 = 0;

421 
a1ul
;

422 
pks1
;

423 
Á1
;

424 
å
;

425 
ylöt
, 
thr2
, 
dqthr
;

426 
yl‰ac
, 
thr1
;

427 
pk0
;

429 
pk0
 = (
dq£z
 < 0) ? 1 : 0;

431 
mag
 = 
dq
 & 0x7FFF;

433 
ylöt
 = 
°©e_±r
->
yl
 >> 15;

434 
yl‰ac
 = (
°©e_±r
->
yl
 >> 10) & 0x1F;

435 
thr1
 = (32 + 
yl‰ac
Ë<< 
ylöt
;

436 
thr2
 = (
ylöt
 > 9Ë? 31 << 10 : 
thr1
;

437 
dqthr
 = (
thr2
 + (thr2 >> 1)) >> 1;

438 i‡(
°©e_±r
->
td
 == 0)

439 
å
 = 0;

440 i‡(
mag
 <
dqthr
)

441 
å
 = 0;

443 
å
 = 1;

451 
°©e_±r
->
yu
 = 
y
 + ((
wi
 - y) >> 5);

454 i‡(
°©e_±r
->
yu
 < 544)

455 
°©e_±r
->
yu
 = 544;

456 i‡(
°©e_±r
->
yu
 > 5120)

457 
°©e_±r
->
yu
 = 5120;

461 
°©e_±r
->
yl
 +°©e_±r->
yu
 + ((-state_ptr->yl) >> 6);

466 i‡(
å
 == 1) {

467 
°©e_±r
->
a
[0] = 0;

468 
°©e_±r
->
a
[1] = 0;

469 
°©e_±r
->
b
[0] = 0;

470 
°©e_±r
->
b
[1] = 0;

471 
°©e_±r
->
b
[2] = 0;

472 
°©e_±r
->
b
[3] = 0;

473 
°©e_±r
->
b
[4] = 0;

474 
°©e_±r
->
b
[5] = 0;

476 
pks1
 = 
pk0
 ^ 
°©e_±r
->
pk
[0];

479 
a2p
 = 
°©e_±r
->
a
[1] - (state_ptr->a[1] >> 7);

480 i‡(
dq£z
 != 0) {

481 
Á1
 = (
pks1
Ë? 
°©e_±r
->
a
[0] : -state_ptr->a[0];

482 i‡(
Á1
 < -8191)

483 
a2p
 -= 0x100;

484 i‡(
Á1
 > 8191)

485 
a2p
 += 0xFF;

487 
a2p
 +
Á1
 >> 5;

489 i‡(
pk0
 ^ 
°©e_±r
->
pk
[1])

491 i‡(
a2p
 <= -12160)

492 
a2p
 = -12288;

493 i‡(
a2p
 >= 12416)

494 
a2p
 = 12288;

496 
a2p
 -= 0x80;

498 i‡(
a2p
 <= -12416)

499 
a2p
 = -12288;

500 i‡(
a2p
 >= 12160)

501 
a2p
 = 12288;

503 
a2p
 += 0x80;

507 
°©e_±r
->
a
[1] = 
a2p
;

511 
°©e_±r
->
a
[0] -= state_ptr->a[0] >> 8;

512 i‡(
dq£z
 != 0)

513 { i‡(
pks1
 == 0)

514 
°©e_±r
->
a
[0] += 192;

516 
°©e_±r
->
a
[0] -= 192;

520 
a1ul
 = 15360 - 
a2p
;

521 i‡(
°©e_±r
->
a
[0] < -
a1ul
)

522 
°©e_±r
->
a
[0] = -
a1ul
;

523 i‡(
°©e_±r
->
a
[0] > 
a1ul
)

524 
°©e_±r
->
a
[0] = 
a1ul
;

527 
˙t
 = 0; cnt < 6; cnt++) {

528 i‡(
code_size
 == 5)

529 
°©e_±r
->
b
[
˙t
] -= state_ptr->b[cnt] >> 9;

531 
°©e_±r
->
b
[
˙t
] -= state_ptr->b[cnt] >> 8;

532 i‡(
dq
 & 0x7FFF) {

533 i‡((
dq
 ^ 
°©e_±r
->dq[
˙t
]) >= 0)

534 
°©e_±r
->
b
[
˙t
] += 128;

536 
°©e_±r
->
b
[
˙t
] -= 128;

541 
˙t
 = 5; cnt > 0; cnt--)

542 
°©e_±r
->
dq
[
˙t
] = state_ptr->dq[cnt-1];

544 i‡(
mag
 == 0) {

545 
°©e_±r
->
dq
[0] = (dq >= 0) ? 0x20 : 0xFC20;

547 
exp⁄
 = 
	`qu™
(
mag
, 
powî2
, 15);

548 
°©e_±r
->
dq
[0] = (dq >= 0) ?

549 (
exp⁄
 << 6Ë+ ((
mag
 << 6) >>Éxpon) :

550 (
exp⁄
 << 6Ë+ ((
mag
 << 6) >>Éxpon) - 0x400;

553 
°©e_±r
->
§
[1] = state_ptr->sr[0];

555 i‡(
§
 == 0) {

556 
°©e_±r
->
§
[0] = 0x20;

557 } i‡(
§
 > 0) {

558 
exp⁄
 = 
	`qu™
(
§
, 
powî2
, 15);

559 
°©e_±r
->
§
[0] = (
exp⁄
 << 6) + ((sr << 6) >>Éxpon);

560 } i‡(
§
 > -32768) {

561 
mag
 = -
§
;

562 
exp⁄
 = 
	`qu™
(
mag
, 
powî2
, 15);

563 
°©e_±r
->
§
[0] = (
exp⁄
 << 6Ë+ ((
mag
 << 6) >>Éxpon) - 0x400;

565 
°©e_±r
->
§
[0] = () 0xFC20;

568 
°©e_±r
->
pk
[1] = state_ptr->pk[0];

569 
°©e_±r
->
pk
[0] = 
pk0
;

572 i‡(
å
 == 1)

573 
°©e_±r
->
td
 = 0;

574 i‡(
a2p
 < -11776)

575 
°©e_±r
->
td
 = 1;

577 
°©e_±r
->
td
 = 0;

582 
°©e_±r
->
dms
 +(
fi
 - state_ptr->dms) >> 5;

583 
°©e_±r
->
dml
 +(((
fi
 << 2) - state_ptr->dml) >> 7);

585 i‡(
å
 == 1)

586 
°©e_±r
->
≠
 = 256;

587 i‡(
y
 < 1536)

588 
°©e_±r
->
≠
 += (0x200 - state_ptr->ap) >> 4;

589 i‡(
°©e_±r
->
td
 == 1)

590 
°©e_±r
->
≠
 += (0x200 - state_ptr->ap) >> 4;

591 i‡(
	`abs
((
°©e_±r
->
dms
 << 2Ë- sèã_±r->
dml
) >=

592 (
°©e_±r
->
dml
 >> 3))

593 
°©e_±r
->
≠
 += (0x200 - state_ptr->ap) >> 4;

595 
°©e_±r
->
≠
 += (-state_ptr->ap) >> 4;

598 
	}
}

604 
	$u≈ack_byãs
 (
bôs
, 
blocksize
, c⁄° * 
block
, * 
ßm∂es
)

605 { 
ö_buf„r
 = 0 ;

606 
ö_byã
 ;

607 
k
, 
ö_bôs
 = 0, 
bödex
 = 0 ;

609 
k
 = 0 ; 
bödex
 <
blocksize
 && k < 
G72x_BLOCK_SIZE
 ; k++)

610 { i‡(
ö_bôs
 < 
bôs
)

611 { 
ö_byã
 = 
block
 [
bödex
++] ;

613 
ö_buf„r
 |(
ö_byã
 << 
ö_bôs
);

614 
ö_bôs
 += 8;

616 
ßm∂es
 [
k
] = 
ö_buf„r
 & ((1 << 
bôs
) - 1);

617 
ö_buf„r
 >>
bôs
;

618 
ö_bôs
 -
bôs
;

621  
k
 ;

622 
	}
}

625 
	$∑ck_byãs
 (
bôs
, c⁄° * 
ßm∂es
, * 
block
)

627 
out_buf„r
 = 0 ;

628 
k
, 
bödex
 = 0, 
out_bôs
 = 0 ;

629 
out_byã
 ;

631 
k
 = 0 ; k < 
G72x_BLOCK_SIZE
 ; k++)

632 { 
out_buf„r
 |(
ßm∂es
 [
k
] << 
out_bôs
) ;

633 
out_bôs
 +
bôs
 ;

634 i‡(
out_bôs
 >= 8)

635 { 
out_byã
 = 
out_buf„r
 & 0xFF ;

636 
out_bôs
 -= 8 ;

637 
out_buf„r
 >>= 8 ;

638 
block
 [
bödex
++] = 
out_byã
 ;

642  
bödex
 ;

643 
	}
}

	@libsndfile-1.0.17/src/G72x/g72x.h

25 #i‚de‡
G72X_HEADER_FILE


26 
	#G72X_HEADER_FILE


	)

32 
	#G72x_BLOCK_SIZE
 (3 * 5 * 8)

	)

40 { 
	mG723_16_BITS_PER_SAMPLE
 = 2,

41 
	mG723_24_BITS_PER_SAMPLE
 = 3,

42 
	mG723_40_BITS_PER_SAMPLE
 = 5,

44 
	mG721_32_BITS_PER_SAMPLE
 = 4,

45 
	mG721_40_BITS_PER_SAMPLE
 = 5,

47 
	mG723_16_SAMPLES_PER_BLOCK
 = 
G72x_BLOCK_SIZE
,

48 
	mG723_24_SAMPLES_PER_BLOCK
 = 
G723_24_BITS_PER_SAMPLE
 * (
G72x_BLOCK_SIZE
 / G723_24_BITS_PER_SAMPLE),

49 
	mG723_40_SAMPLES_PER_BLOCK
 = 
G723_40_BITS_PER_SAMPLE
 * (
G72x_BLOCK_SIZE
 / G723_40_BITS_PER_SAMPLE),

51 
	mG721_32_SAMPLES_PER_BLOCK
 = 
G72x_BLOCK_SIZE
,

52 
	mG721_40_SAMPLES_PER_BLOCK
 = 
G721_40_BITS_PER_SAMPLE
 * (
G72x_BLOCK_SIZE
 / G721_40_BITS_PER_SAMPLE),

54 
	mG723_16_BYTES_PER_BLOCK
 = (
G723_16_BITS_PER_SAMPLE
 * 
G72x_BLOCK_SIZE
) / 8,

55 
	mG723_24_BYTES_PER_BLOCK
 = (
G723_24_BITS_PER_SAMPLE
 * 
G72x_BLOCK_SIZE
) / 8,

56 
	mG723_40_BYTES_PER_BLOCK
 = (
G723_40_BITS_PER_SAMPLE
 * 
G72x_BLOCK_SIZE
) / 8,

58 
	mG721_32_BYTES_PER_BLOCK
 = (
G721_32_BITS_PER_SAMPLE
 * 
G72x_BLOCK_SIZE
) / 8,

59 
	mG721_40_BYTES_PER_BLOCK
 = (
G721_40_BITS_PER_SAMPLE
 * 
G72x_BLOCK_SIZE
) / 8

64 
	gg72x_°©e
 ;

68 
g72x_°©e
 * 
g72x_ªadî_öô
 (
codec
, *
blocksize
, *
ßm∂e•îblock
) ;

69 
g72x_°©e
 * 
g72x_wrôî_öô
 (
codec
, *
blocksize
, *
ßm∂e•îblock
) ;

75 
g72x_decode_block
 (
g72x_°©e
 *
p°©e
, c⁄° *
block
, *
ßm∂es
) ;

83 
g72x_ícode_block
 (
g72x_°©e
 *
p°©e
, *
ßm∂es
, *
block
) ;

	@libsndfile-1.0.17/src/G72x/g72x_priv.h

27 #i‚de‡
G72X_PRIVATE_H


28 
	#G72X_PRIVATE_H


	)

30 #ifde‡
__˝lu•lus


44 
	sg72x_°©e


45 { 
	myl
;

46 
	myu
;

47 
	mdms
;

48 
	mdml
;

49 
	m≠
;

51 
	ma
[2];

52 
	mb
[6];

53 
	mpk
[2];

57 
	mdq
[6];

62 
	m§
[2];

67 
	mtd
;

75 (*
	mícodî
Ë(, 
g72x_°©e
* 
	m°©e
) ;

76 (*
	mdecodî
Ë(, 
g72x_°©e
* 
	m°©e
) ;

78 
	mcodec_bôs
, 
	mblocksize
, 
	mßm∂e•îblock
 ;

81 
g72x_°©e
 
	tG72x_STATE
 ;

83 
¥edi˘‹_zîo
 (
G72x_STATE
 *
°©e_±r
);

85 
¥edi˘‹_pﬁe
 (
G72x_STATE
 *
°©e_±r
);

87 
°ï_size
 (
G72x_STATE
 *
°©e_±r
);

89 
qu™tize
 (
d
, 
y
, *
èbÀ
, 
size
);

91 
ªc⁄°ru˘
 (
sign
, 
dq 
, 
y
);

93 
upd©e
 (
code_size
, 
y
, 
wi
, 
fi
, 
dq
, 
§
, 
dq£z
, 
G72x_STATE
 *
°©e_±r
);

95 
g721_ícodî
 (
ßm∂e
, 
G72x_STATE
 *
°©e_±r
);

96 
g721_decodî
 (
code
, 
G72x_STATE
 *
°©e_±r
);

98 
g723_16_ícodî
 (
ßm∂e
, 
G72x_STATE
 *
°©e_±r
);

99 
g723_16_decodî
 (
code
, 
G72x_STATE
 *
°©e_±r
);

101 
g723_24_ícodî
 (
ßm∂e
, 
G72x_STATE
 *
°©e_±r
);

102 
g723_24_decodî
 (
code
, 
G72x_STATE
 *
°©e_±r
);

104 
g723_40_ícodî
 (
ßm∂e
, 
G72x_STATE
 *
°©e_±r
);

105 
g723_40_decodî
 (
code
, 
G72x_STATE
 *
°©e_±r
);

107 
¥iv©e_öô_°©e
 (
G72x_STATE
 *
°©e_±r
) ;

	@libsndfile-1.0.17/src/G72x/g72x_test.c

19 
	~<°dio.h
>

20 
	~<uni°d.h
>

21 
	~<°dlib.h
>

22 
	~<°rög.h
>

23 
	~<m©h.h
>

25 
	~"g72x.h
"

26 
	~"g72x_¥iv.h
"

28 #i‚def 
M_PI


29 
	#M_PI
 3.14159265358979323846264338

	)

32 
	#BUFFER_SIZE
 (1<<14Ë

	)

33 
	#SAMPLE_RATE
 11025

	)

36 
g721_ã°
 () ;

37 
g723_ã°
 (
m¨gö
) ;

39 
gí_sig«l_doubÀ
 (*
d©a
, 
sˇÀ
, 
d©Æí
) ;

40 
îr‹_fun˘i⁄
 (
d©a
, 
‹ig
, 
m¨gö
) ;

42 
o˘_ßve_sh‹t
 (*
a
, *
b
, 
Àn
) ;

45 
	$maö
 (
¨gc
, *
¨gv
 [])

46 { 
bDoAŒ
 = 0 ;

47 
nTe°s
 = 0 ;

49 i‡(
¨gc
 != 2)

50 { 
	`¥ötf
 ("Ußgê: %†<ã°>\n", 
¨gv
 [0]) ;

51 
	`¥ötf
 (" Where <test> is one ofÅhe following:\n") ;

52 
	`¥ötf
 (" g721 -Åest G721Éncoderánd decoder\n") ;

53 
	`¥ötf
 (" g723 -Åest G721Éncoderánd decoder\n") ;

54 
	`¥ötf
 ("áll -ÖerformállÅests\n") ;

55 
	`exô
 (1) ;

58 
bDoAŒ
=!
	`°rcmp
 (
¨gv
 [1], "all");

60 i‡(
bDoAŒ
 || ! 
	`°rcmp
 (
¨gv
 [1], "g721"))

61 { 
	`g721_ã°
 () ;

62 
nTe°s
++ ;

65 i‡(
bDoAŒ
 || ! 
	`°rcmp
 (
¨gv
 [1], "g723"))

66 { 
	`g723_ã°
 (0.53) ;

67 
nTe°s
++ ;

70 i‡(
nTe°s
 == 0)

71 { 
	`¥ötf
 ("Mono : ************************************\n") ;

72 
	`¥ötf
 ("M⁄ÿ: * Nÿ'%s'Åe° deföed.\n", 
¨gv
 [1]) ;

73 
	`¥ötf
 ("Mono : ************************************\n") ;

78 
	}
}

81 
	$g721_ã°
 ()

84 
	}
}

87 
	$g723_ã°
 (
m¨gö
)

88 { 
‹ig_buf„r
 [
BUFFER_SIZE
] ;

89 
‹ig
 [
BUFFER_SIZE
] ;

90 
d©a
 [
BUFFER_SIZE
] ;

92 
G72x_STATE
 
ícodî_°©e
, 
decodî_°©e
 ;

94 
k
 ;

95 
code
, 
posôi⁄
, 
max_îr
 ;

97 
	`¥iv©e_öô_°©e
 (&
ícodî_°©e
) ;

98 
ícodî_°©e
.
ícodî
 = 
g723_24_ícodî
 ;

99 
ícodî_°©e
.
codec_bôs
 = 3 ;

101 
	`¥iv©e_öô_°©e
 (&
decodî_°©e
) ;

102 
decodî_°©e
.
decodî
 = 
g723_24_decodî
 ;

103 
decodî_°©e
.
codec_bôs
 = 3 ;

105 
	`mem£t
 (
d©a
, 0, 
BUFFER_SIZE
 *  ()) ;

106 
	`mem£t
 (
‹ig
, 0, 
BUFFER_SIZE
 *  ()) ;

108 
	`¥ötf
 (" g723_test : ") ;

109 
	`fÊush
 (
°dout
) ;

111 
	`gí_sig«l_doubÀ
 (
‹ig_buf„r
, 32000.0, 
BUFFER_SIZE
) ;

112 
k
 = 0 ; k < 
BUFFER_SIZE
 ; k++)

113 
‹ig
 [
k
] = (Ë
‹ig_buf„r
 [k] ;

116 
posôi⁄
 = 0 ;

117 
max_îr
 = 0 ;

118 
k
 = 0 ; k < 
BUFFER_SIZE
 ; k++)

119 { 
code
 = 
ícodî_°©e
.
	`ícodî
 (
‹ig
 [
k
], &encoder_state) ;

120 
d©a
 [
k
] = 
decodî_°©e
.
	`decodî
 (
code
, &decoder_state) ;

121 i‡(
	`abs
 (
‹ig
 [
k
] - 
d©a
 [k]Ë> 
max_îr
)

122 { 
posôi⁄
 = 
k
 ;

123 
max_îr
 = 
	`abs
 (
‹ig
 [
k
] - 
d©a
 [k]) ;

127 
	`¥ötf
 ("\n\nMaxÉº‹ o‡%dáàpo°i⁄ %d.\n", 
max_îr
, 
posôi⁄
) ;

129 
k
 = 0 ; k < 
BUFFER_SIZE
 ; k++)

130 { i‡(
	`îr‹_fun˘i⁄
 (
d©a
 [
k
], 
‹ig
 [k], 
m¨gö
))

131 { 
	`¥ötf
 ("Löê%d: Inc‹ª˘ sam∂êA (#%ld : %d should bê%d).\n", 
__LINE__
, 
k
, 
d©a
 [k], 
‹ig
 [k]) ;

132 
	`o˘_ßve_sh‹t
 (
‹ig
, 
d©a
, 
BUFFER_SIZE
) ;

133 
	`exô
 (1) ;

138 
	`¥ötf
 ("ok\n") ;

141 
	}
}

144 
	#SIGNAL_MAXVAL
 30000.0

	)

145 
	#DECAY_COUNT
 1000

	)

148 
	$gí_sig«l_doubÀ
 (*
gíd©a
, 
sˇÀ
, 
gíd©Æí
)

149 { 
k
, 
øm∂í
 ;

150 
amp
 = 0.0 ;

152 
øm∂í
 = 
DECAY_COUNT
 ;

154 
k
 = 0 ; k < 
gíd©Æí
 ; k++)

155 { i‡(
k
 <
øm∂í
)

156 
amp
 = 
sˇÀ
 * 
k
 / ((Ë
øm∂í
) ;

157 i‡(
k
 > 
gíd©Æí
 - 
øm∂í
)

158 
amp
 = 
sˇÀ
 * (
gíd©Æí
 - 
k
Ë/ ((Ë
øm∂í
) ;

160 
gíd©a
 [
k
] = 
amp
 * (0.4 * 
	`sö
 (33.3 * 2.0 * 
M_PI
 * ((Ë(k+1)Ë/ ((Ë
SAMPLE_RATE
))

161 + 0.3 * 
	`cos
 (201.1 * 2.0 * 
M_PI
 * ((Ë(
k
+1)Ë/ ((Ë
SAMPLE_RATE
))) ;

165 
	}
}

168 
	$îr‹_fun˘i⁄
 (
d©a
, 
‹ig
, 
m¨gö
)

169 { 
îr‹
 ;

171 i‡(
	`Ábs
 (
‹ig
) <= 500.0)

172 
îr‹
 = 
	`Ábs
 (Áb†(
d©a
Ë- fabs(
‹ig
)) / 2000.0 ;

173 i‡(
	`Ábs
 (
‹ig
) <= 1000.0)

174 
îr‹
 = 
	`Ábs
 (
d©a
 - 
‹ig
) / 3000.0 ;

176 
îr‹
 = 
	`Ábs
 (
d©a
 - 
‹ig
) / fabs (orig) ;

178 i‡(
îr‹
 > 
m¨gö
)

179 { 
	`¥ötf
 ("\n\n*******************\nEº‹ : %f\n", 
îr‹
) ;

183 
	}
}

186 
	$o˘_ßve_sh‹t
 (*
a
, *
b
, 
Àn
)

187 { 
FILE
 *
fûe
 ;

188 
k
 ;

190 i‡(! (
fûe
 = 
	`f›í
 ("error.dat", "w")))

193 
	`Ârötf
 (
fûe
, "# Not created by Octave\n") ;

195 
	`Ârötf
 (
fûe
, "#Çame:á\n") ;

196 
	`Ârötf
 (
fûe
, "#Åype: matrix\n") ;

197 
	`Ârötf
 (
fûe
, "#Ñows: %d\n", 
Àn
) ;

198 
	`Ârötf
 (
fûe
, "# columns: 1\n") ;

200 
k
 = 0 ; k < 
Àn
 ; k++)

201 
	`Ârötf
 (
fûe
, "% d\n", 
a
 [
k
]) ;

203 
	`Ârötf
 (
fûe
, "#Çame: b\n") ;

204 
	`Ârötf
 (
fûe
, "#Åype: matrix\n") ;

205 
	`Ârötf
 (
fûe
, "#Ñows: %d\n", 
Àn
) ;

206 
	`Ârötf
 (
fûe
, "# columns: 1\n") ;

208 
k
 = 0 ; k < 
Àn
 ; k++)

209 
	`Ârötf
 (
fûe
, "% d\n", 
b
 [
k
]) ;

211 
	`f˛o£
 (
fûe
) ;

213 
	}
}

	@libsndfile-1.0.17/src/GSM610/add.c

11 
	~<°dio.h
>

12 
	~<as£π.h
>

14 
	~"gsm610_¥iv.h
"

15 
	~"gsm.h
"

17 
	#ßtuøã
(
x
) \

18 ((
x
Ë< 
MIN_WORD
 ? MIN_WORD : (xË> 
MAX_WORD
 ? MAX_WORD: (x))

	)

20 
w‹d
 
	$gsm_add
 ( 
w‹d
 
a
, w‹d 
b
)

22 
l⁄gw‹d
 
sum
 = (l⁄gw‹d)
a
 + (l⁄gw‹d)
b
;

23  
	`ßtuøã
(
sum
);

24 
	}
}

26 
w‹d
 
	$gsm_sub
 ( 
w‹d
 
a
, w‹d 
b
)

28 
l⁄gw‹d
 
diff
 = (l⁄gw‹d)
a
 - (l⁄gw‹d)
b
;

29  
	`ßtuøã
(
diff
);

30 
	}
}

32 
w‹d
 
	$gsm_mu…
 ( 
w‹d
 
a
, w‹d 
b
)

34 i‡(
a
 =
MIN_WORD
 && 
b
 == MIN_WORD)

35  
MAX_WORD
;

37  
	`SASR_L
–(
l⁄gw‹d
)
a
 * (l⁄gw‹d)
b
, 15 );

38 
	}
}

40 
w‹d
 
	$gsm_mu…_r
 ( 
w‹d
 
a
, w‹d 
b
)

42 i‡(
b
 =
MIN_WORD
 && 
a
 =MIN_WORDË 
MAX_WORD
;

44 
l⁄gw‹d
 
¥od
 = (l⁄gw‹d)
a
 * (l⁄gw‹d)
b
 + 16384;

45 
¥od
 >>= 15;

46  
¥od
 & 0xFFFF;

48 
	}
}

50 
w‹d
 
	$gsm_abs
 (
w‹d
 
a
)

52  
a
 < 0 ? (®=
MIN_WORD
 ? 
MAX_WORD
 : -a) :á;

53 
	}
}

55 
l⁄gw‹d
 
	$gsm_L_mu…
 (
w‹d
 
a
, w‹d 
b
)

57 
	`as£π
–
a
 !
MIN_WORD
 || 
b
 != MIN_WORD );

58  ((
l⁄gw‹d
)
a
 * (l⁄gw‹d)
b
) << 1;

59 
	}
}

61 
l⁄gw‹d
 
	$gsm_L_add
 ( 
l⁄gw‹d
 
a
,Ü⁄gw‹d 
b
)

63 i‡(
a
 < 0) {

64 i‡(
b
 >0Ë 
a
 + b;

66 
ul⁄gw‹d
 
A
 = (ul⁄gw‹d)-(
a
 + 1Ë+ (ul⁄gw‹d)-(
b
 + 1);

67  
A
 >
MAX_LONGWORD
 ? 
MIN_LONGWORD
 :-(
l⁄gw‹d
)A-2;

70 i‡(
b
 <0Ë 
a
 + b;

72 
ul⁄gw‹d
 
A
 = (ul⁄gw‹d)
a
 + (ul⁄gw‹d)
b
;

73  
A
 > 
MAX_LONGWORD
 ? MAX_LONGWORD : A;

75 
	}
}

77 
l⁄gw‹d
 
	$gsm_L_sub
 ( 
l⁄gw‹d
 
a
,Ü⁄gw‹d 
b
)

79 i‡(
a
 >= 0) {

80 i‡(
b
 >0Ë 
a
 - b;

84 
ul⁄gw‹d
 
A
 = (ul⁄gw‹d)
a
 + -(
b
 + 1);

85  
A
 >
MAX_LONGWORD
 ? MAX_LONGWORD : (A + 1);

88 i‡(
b
 <0Ë 
a
 - b;

92 
ul⁄gw‹d
 
A
 = (ul⁄gw‹d)-(
a
 + 1Ë+ 
b
;

93  
A
 >
MAX_LONGWORD
 ? 
MIN_LONGWORD
 : -(
l⁄gw‹d
)A - 1;

95 
	}
}

97 c⁄° 
	gbôoff
[ 256 ] = {

116 
w‹d
 
	$gsm_n‹m
 (
l⁄gw‹d
 
a
 )

136 
	`as£π
(
a
 != 0);

138 i‡(
a
 < 0) {

139 i‡(
a
 <= -1073741824)  0;

140 
a
 = ~a;

143  
a
 & 0xffff0000

144 ? ( 
a
 & 0xff000000

145 ? -1 + 
bôoff
[ 0xFF & (
a
 >> 24) ]

146 : 7 + 
bôoff
[ 0xFF & (
a
 >> 16) ] )

147 : ( 
a
 & 0xff00

148 ? 15 + 
bôoff
[ 0xFF & (
a
 >> 8) ]

149 : 23 + 
bôoff
[ 0xFF & 
a
 ] );

150 
	}
}

152 
l⁄gw‹d
 
	$gsm_L_a¶
 (
l⁄gw‹d
 
a
, 
n
)

154 i‡(
n
 >= 32)  0;

155 i‡(
n
 <-32Ë -(
a
 < 0);

156 i‡(
n
 < 0Ë 
	`gsm_L_a§
(
a
, -n);

157  
a
 << 
n
;

158 
	}
}

160 
w‹d
 
	$gsm_a§
 (
w‹d
 
a
, 
n
)

162 i‡(
n
 >16Ë -(
a
 < 0);

163 i‡(
n
 <= -16)  0;

164 i‡(
n
 < 0Ë 
a
 << -n;

166  
	`SASR_W
 (
a
, (
w‹d
Ë
n
);

167 
	}
}

169 
w‹d
 
	$gsm_a¶
 (
w‹d
 
a
, 
n
)

171 i‡(
n
 >= 16)  0;

172 i‡(
n
 <-16Ë -(
a
 < 0);

173 i‡(
n
 < 0Ë 
	`gsm_a§
(
a
, -n);

174  
a
 << 
n
;

175 
	}
}

177 
l⁄gw‹d
 
	$gsm_L_a§
 (
l⁄gw‹d
 
a
, 
n
)

179 i‡(
n
 >32Ë -(
a
 < 0);

180 i‡(
n
 <= -32)  0;

181 i‡(
n
 < 0Ë 
a
 << -n;

183  
	`SASR_L
 (
a
, (
w‹d
Ë
n
);

184 
	}
}

211 
w‹d
 
	$gsm_div
 (
w‹d
 
num
, w‹d 
díum
)

213 
l⁄gw‹d
 
L_num
 = 
num
;

214 
l⁄gw‹d
 
L_díum
 = 
díum
;

215 
w‹d
 
div
 = 0;

216 
k
 = 15;

225 
	`as£π
(
num
 >0 && 
díum
 >=Çum);

226 i‡(
num
 == 0)

229 
k
--) {

230 
div
 <<= 1;

231 
L_num
 <<= 1;

233 i‡(
L_num
 >
L_díum
) {

234 
L_num
 -
L_díum
;

235 
div
++;

239  
div
;

240 
	}
}

	@libsndfile-1.0.17/src/GSM610/code.c

8 
	~<°dlib.h
>

9 
	~<°rög.h
>

11 
	~"c⁄fig.h
"

13 
	~"gsm610_¥iv.h
"

14 
	~"gsm.h
"

20 
	$Gsm_Codî
 (

22 
gsm_°©e
 * 
Sèã
,

24 
w‹d
 * 
s
,

36 
w‹d
 * 
LARc
,

44 
w‹d
 * 
Nc
,

45 
w‹d
 * 
bc
,

46 
w‹d
 * 
Mc
,

47 
w‹d
 * 
xmaxc
,

48 
w‹d
 * 
xMc


51 
k
;

52 
w‹d
 * 
dp
 = 
Sèã
->
dp0
 + 120;

53 
w‹d
 * 
dµ
 = 
dp
;

55 
w‹d
 
so
[160];

57 
	`Gsm_Pª¥o˚ss
 (
Sèã
, 
s
, 
so
);

58 
	`Gsm_LPC_A«lysis
 (
Sèã
, 
so
, 
LARc
);

59 
	`Gsm_Sh‹t_Tîm_A«lysis_Fûãr
 (
Sèã
, 
LARc
, 
so
);

61 
k
 = 0; k <3; k++, 
xMc
 += 13) {

63 
	`Gsm_L⁄g_Tîm_Pªdi˘‹
 ( 
Sèã
,

64 
so
+
k
*40,

65 
dp
,

66 
Sèã
->
e
 + 5,

67 
dµ
,

68 
Nc
++,

69 
bc
++);

71 
	`Gsm_RPE_Encodög
 (

72 
Sèã
->
e
 + 5,

73 
xmaxc
++, 
Mc
++, 
xMc
 );

79 { 
i
;

80 
i
 = 0; i <= 39; i++)

81 
dp
[ 
i
 ] = 
	`GSM_ADD
–
Sèã
->
e
[5 + i], 
dµ
[i] );

83 
dp
 += 40;

84 
dµ
 += 40;

87 ()
	`mem˝y
–(*)
Sèã
->
dp0
, (*)(State->dp0 + 160),

88 120 * (*
Sèã
->
dp0
) );

89 
	}
}

	@libsndfile-1.0.17/src/GSM610/config.h

7 #i‚def 
CONFIG_H


8 
	#CONFIG_H


	)

10 
	#HAS_STDLIB_H
 1

	)

11 
	#HAS_FCNTL_H
 1

	)

13 
	#HAS_FSTAT
 1

	)

14 
	#HAS_FCHMOD
 1

	)

15 
	#HAS_CHMOD
 1

	)

16 
	#HAS_FCHOWN
 1

	)

17 
	#HAS_CHOWN
 1

	)

19 
	#HAS_STRING_H
 1

	)

21 
	#HAS_UNISTD_H
 1

	)

22 
	#HAS_UTIME
 1

	)

23 
	#HAS_UTIME_H
 1

	)

	@libsndfile-1.0.17/src/GSM610/decode.c

7 
	~<°dio.h
>

9 
	~"gsm610_¥iv.h
"

10 
	~"gsm.h
"

16 
	$Po°¥o˚ssög
 (

17 
gsm_°©e
 * 
S
,

18 
w‹d
 * 
s
)

20 
k
;

21 
w‹d
 
m§
 = 
S
->msr;

22 
w‹d
 
tmp
;

24 
k
 = 160; k--; 
s
++) {

25 
tmp
 = 
	`GSM_MULT_R
–
m§
, 28180 );

26 
m§
 = 
	`GSM_ADD
(*
s
, 
tmp
);

27 *
s
 = 
	`GSM_ADD
(
m§
, msr) & 0xFFF8;

29 
S
->
m§
 = msr;

30 
	}
}

32 
	$Gsm_Decodî
 (

33 
gsm_°©e
 * 
S
,

35 
w‹d
 * 
LAR¸
,

37 
w‹d
 * 
N¸
,

38 
w‹d
 * 
b¸
,

39 
w‹d
 * 
M¸
,

40 
w‹d
 * 
xmax¸
,

41 
w‹d
 * 
xM¸
,

43 
w‹d
 * 
s
)

45 
j
, 
k
;

46 
w‹d
 
îp
[40], 
wt
[160];

47 
w‹d
 * 
dΩ
 = 
S
->
dp0
 + 120;

49 
j
=0; j <3; j++, 
xmax¸
++, 
b¸
++, 
N¸
++, 
M¸
++, 
xM¸
 += 13) {

51 
	`Gsm_RPE_Decodög
– *
xmax¸
, *
M¸
, 
xM¸
, 
îp
 );

52 
	`Gsm_L⁄g_Tîm_Sy¡hesis_Fûãrög
–
S
, *
N¸
, *
b¸
, 
îp
, 
dΩ
 );

54 
k
 = 0; k <39; k++Ë
wt
[ 
j
 * 40 + k ] = 
dΩ
[ k ];

57 
	`Gsm_Sh‹t_Tîm_Sy¡hesis_Fûãr
–
S
, 
LAR¸
, 
wt
, 
s
 );

58 
	`Po°¥o˚ssög
(
S
, 
s
);

59 
	}
}

	@libsndfile-1.0.17/src/GSM610/gsm.h

7 #i‚def 
GSM_H


8 
	#GSM_H


	)

10 
	~<°dio.h
>

16 
gsm_°©e
 * 
	tgsm
;

17 
	tgsm_sig«l
;

18 
	tgsm_byã
;

19 
gsm_byã
 
	tgsm_‰ame
[33];

21 
	#GSM_MAGIC
 0xD

	)

23 
	#GSM_PATCHLEVEL
 10

	)

24 
	#GSM_MINOR
 0

	)

25 
	#GSM_MAJOR
 1

	)

27 
	#GSM_OPT_VERBOSE
 1

	)

28 
	#GSM_OPT_FAST
 2

	)

29 
	#GSM_OPT_LTP_CUT
 3

	)

30 
	#GSM_OPT_WAV49
 4

	)

31 
	#GSM_OPT_FRAME_INDEX
 5

	)

32 
	#GSM_OPT_FRAME_CHAIN
 6

	)

34 
gsm
 
gsm_¸óã
 ();

37 
gsm_öô
 (
gsm
);

39 
gsm_de°roy
 (
gsm
);

41 
gsm_¥öt
 (
FILE
 *, 
gsm
, 
gsm_byã
 *);

42 
gsm_›ti⁄
 (
gsm
, , *);

44 
gsm_ícode
 (
gsm
, 
gsm_sig«l
 *, 
gsm_byã
 *);

45 
gsm_decode
 (
gsm
, 
gsm_byã
 *, 
gsm_sig«l
 *);

47 
gsm_ex∂ode
 (
gsm
, 
gsm_byã
 *, 
gsm_sig«l
 *);

48 
gsm_im∂ode
 (
gsm
, 
gsm_sig«l
 *, 
gsm_byã
 *);

	@libsndfile-1.0.17/src/GSM610/gsm610_priv.h

7 #i‚def 
PRIVATE_H


8 
	#PRIVATE_H


	)

11 
	#USE_FLOAT_MUL


	)

12 
	#FAST


	)

13 
	#WAV49


	)

15 #ifde‡
__˝lu•lus


22 
	tw‹d
;

23 
	tl⁄gw‹d
;

25 
	tuw‹d
;

26 
	tul⁄gw‹d
;

28 
	sgsm_°©e


29 { 
w‹d
 
	mdp0
[ 280 ] ;

31 
w‹d
 
	mz1
;

32 
l⁄gw‹d
 
	mL_z2
;

33 
	mmp
;

35 
w‹d
 
	mu
[8] ;

36 
w‹d
 
	mLARµ
[2][8] ;

37 
w‹d
 
	mj
;

39 
w‹d
 
	m…p_cut
;

40 
w‹d
 
	mƒp
;

41 
w‹d
 
	mv
[9] ;

42 
w‹d
 
	mm§
;

44 
	mvîbo£
;

45 
	mÁ°
;

47 
	mwav_fmt
;

48 
	m‰ame_ödex
;

49 
	m‰ame_chaö
;

52 
w‹d
 
	me
[50] ;

55 
gsm_°©e
 
	tGSM_STATE
 ;

57 
	#MIN_WORD
 (-32767 - 1)

	)

58 
	#MAX_WORD
 32767

	)

60 
	#MIN_LONGWORD
 (-2147483647 - 1)

	)

61 
	#MAX_LONGWORD
 2147483647

	)

64 
ölöe
 
w‹d


65 
	$SASR_W
 (
w‹d
 
x
, w‹d 
by
)

66 {  (
x
 >> 
by
) ;

67 
	}
}

69 
ölöe
 
l⁄gw‹d


70 
	$SASR_L
 (
l⁄gw‹d
 
x
, 
w‹d
 
by
)

71 {  (
x
 >> 
by
) ;

72 
	}
}

77 
w‹d
 
gsm_mu…
 (w‹d 
a
, w‹d 
b
) ;

78 
l⁄gw‹d
 
gsm_L_mu…
 (
w‹d
 
a
, w‹d 
b
) ;

79 
w‹d
 
gsm_mu…_r
 (w‹d 
a
, w‹d 
b
) ;

81 
w‹d
 
gsm_div
 (w‹d 
num
, w‹d 
díum
) ;

83 
w‹d
 
gsm_add
 (w‹d 
a
, w‹d 
b
 ) ;

84 
l⁄gw‹d
 
gsm_L_add
 (l⁄gw‹d 
a
,Ü⁄gw‹d 
b
 ) ;

86 
w‹d
 
gsm_sub
 (w‹d 
a
, w‹d 
b
) ;

87 
l⁄gw‹d
 
gsm_L_sub
 (l⁄gw‹d 
a
,Ü⁄gw‹d 
b
) ;

89 
w‹d
 
gsm_abs
 (w‹d 
a
) ;

91 
w‹d
 
gsm_n‹m
 (
l⁄gw‹d
 
a
 ) ;

93 
l⁄gw‹d
 
gsm_L_a¶
 (l⁄gw‹d 
a
, 
n
) ;

94 
w‹d
 
gsm_a¶
 (w‹d 
a
, 
n
) ;

96 
l⁄gw‹d
 
gsm_L_a§
 (l⁄gw‹d 
a
, 
n
) ;

97 
w‹d
 
gsm_a§
 (w‹d 
a
, 
n
) ;

103 
ölöe
 
l⁄gw‹d


104 
	$GSM_MULT_R
 (
w‹d
 
a
, w‹d 
b
)

105 {  (((
l⁄gw‹d
Ë(
a
)Ë* (÷⁄gw‹dË(
b
)) + 16384) >> 15 ;

106 
	}
}

108 
ölöe
 
l⁄gw‹d


109 
	$GSM_MULT
 (
w‹d
 
a
, w‹d 
b
)

110 {  (((
l⁄gw‹d
Ë(
a
)Ë* (÷⁄gw‹dË(
b
))) >> 15 ;

111 
	}
}

113 
ölöe
 
l⁄gw‹d


114 
	$GSM_L_MULT
 (
w‹d
 
a
, w‹d 
b
)

115 {  ((
l⁄gw‹d
Ë(
a
)Ë* (÷⁄gw‹dË(
b
)) << 1 ;

116 
	}
}

118 
ölöe
 
l⁄gw‹d


119 
	$GSM_L_ADD
 (
l⁄gw‹d
 
a
,Ü⁄gw‹d 
b
)

120 { 
ul⁄gw‹d
 
utmp
 ;

122 i‡(
a
 < 0 && 
b
 < 0)

123 { 
utmp
 = (
ul⁄gw‹d
)-((
a
Ë+ 1Ë+ (ul⁄gw‹d)-((
b
) + 1) ;

124  (
utmp
 >(
ul⁄gw‹d
Ë
MAX_LONGWORD
Ë? 
MIN_LONGWORD
 : -(
l⁄gw‹d
)utmp-2 ;

127 i‡(
a
 > 0 && 
b
 > 0)

128 { 
utmp
 = (
ul⁄gw‹d
Ë
a
 + (ul⁄gw‹dË
b
 ;

129  (
utmp
 >(
ul⁄gw‹d
Ë
MAX_LONGWORD
) ? MAX_LONGWORD : utmp ;

132  
a
 + 
b
 ;

133 
	}
}

135 
ölöe
 
l⁄gw‹d


136 
	$GSM_ADD
 (
w‹d
 
a
, w‹d 
b
)

137 { 
l⁄gw‹d
 
…mp
 ;

139 
…mp
 = ((
l⁄gw‹d
Ë
a
Ë+ (÷⁄gw‹dË
b
) ;

141 i‡(
…mp
 >
MAX_WORD
)

142  
MAX_WORD
 ;

143 i‡(
…mp
 <
MIN_WORD
)

144  
MIN_WORD
 ;

146  
…mp
 ;

147 
	}
}

149 
ölöe
 
l⁄gw‹d


150 
	$GSM_SUB
 (
w‹d
 
a
, w‹d 
b
)

151 { 
l⁄gw‹d
 
…mp
 ;

153 
…mp
 = ((
l⁄gw‹d
Ë
a
Ë- (÷⁄gw‹dË
b
) ;

155 i‡(
…mp
 >
MAX_WORD
)

156 
…mp
 = 
MAX_WORD
 ;

157 i‡(
…mp
 <
MIN_WORD
)

158 
…mp
 = 
MIN_WORD
 ;

160  
…mp
 ;

161 
	}
}

163 
ölöe
 
w‹d


164 
	$GSM_ABS
 (
w‹d
 
a
)

166 i‡(
a
 > 0)

167  
a
 ;

168 i‡(
a
 =
MIN_WORD
)

169  
MAX_WORD
 ;

170  -
a
 ;

171 
	}
}

177 
Gsm_Codî
 (

178 
gsm_°©e
 * 
S
,

179 
w‹d
 * 
s
,

180 
w‹d
 * 
LARc
,

181 
w‹d
 * 
Nc
,

182 
w‹d
 * 
bc
,

183 
w‹d
 * 
Mc
,

184 
w‹d
 * 
xmaxc
,

185 
w‹d
 * 
xMc
) ;

187 
Gsm_L⁄g_Tîm_Pªdi˘‹
 (

188 
gsm_°©e
 * 
S
,

189 
w‹d
 * 
d
,

190 
w‹d
 * 
dp
,

191 
w‹d
 * 
e
,

192 
w‹d
 * 
dµ
,

193 
w‹d
 * 
Nc
,

194 
w‹d
 * 
bc
) ;

196 
Gsm_LPC_A«lysis
 (

197 
gsm_°©e
 * 
S
,

198 
w‹d
 * 
s
,

199 
w‹d
 * 
LARc
) ;

201 
Gsm_Pª¥o˚ss
 (

202 
gsm_°©e
 * 
S
,

203 
w‹d
 * 
s
, w‹d * 
so
) ;

205 
Gsm_Encodög
 (

206 
gsm_°©e
 * 
S
,

207 
w‹d
 * 
e
,

208 
w‹d
 * 
ï
,

209 
w‹d
 * 
xmaxc
,

210 
w‹d
 * 
Mc
,

211 
w‹d
 * 
xMc
) ;

213 
Gsm_Sh‹t_Tîm_A«lysis_Fûãr
 (

214 
gsm_°©e
 * 
S
,

215 
w‹d
 * 
LARc
,

216 
w‹d
 * 
d
) ;

218 
Gsm_Decodî
 (

219 
gsm_°©e
 * 
S
,

220 
w‹d
 * 
LAR¸
,

221 
w‹d
 * 
N¸
,

222 
w‹d
 * 
b¸
,

223 
w‹d
 * 
M¸
,

224 
w‹d
 * 
xmax¸
,

225 
w‹d
 * 
xM¸
,

226 
w‹d
 * 
s
) ;

228 
Gsm_Decodög
 (

229 
gsm_°©e
 * 
S
,

230 
w‹d
 
xmax¸
,

231 
w‹d
 
M¸
,

232 
w‹d
 * 
xM¸
,

233 
w‹d
 * 
îp
) ;

235 
Gsm_L⁄g_Tîm_Sy¡hesis_Fûãrög
 (

236 
gsm_°©e
* 
S
,

237 
w‹d
 
N¸
,

238 
w‹d
 
b¸
,

239 
w‹d
 * 
îp
,

240 
w‹d
 * 
dΩ
) ;

242 
Gsm_RPE_Decodög
 (

244 
w‹d
 
xmax¸
,

245 
w‹d
 
M¸
,

246 
w‹d
 * 
xM¸
,

247 
w‹d
 * 
îp
) ;

249 
Gsm_RPE_Encodög
 (

251 
w‹d
 * 
e
,

252 
w‹d
 * 
xmaxc
,

253 
w‹d
 * 
Mc
,

254 
w‹d
 * 
xMc
) ;

256 
Gsm_Sh‹t_Tîm_Sy¡hesis_Fûãr
 (

257 
gsm_°©e
 * 
S
,

258 
w‹d
 * 
LAR¸
,

259 
w‹d
 * 
dΩ
,

260 
w‹d
 * 
s
) ;

262 
Gsm_Upd©e_of_ªc⁄°ru˘ed_sh‹t_time_ªsiduÆ_sig«l
 (

263 
w‹d
 * 
dµ
,

264 
w‹d
 * 
ï
,

265 
w‹d
 * 
dp
) ;

270 #i‚def 
GSM_TABLE_C


272 
w‹d
 
gsm_A
 [8], 
gsm_B
 [8], 
gsm_MIC
 [8], 
gsm_MAC
 [8] ;

273 
w‹d
 
gsm_INVA
 [8] ;

274 
w‹d
 
gsm_DLB
 [4], 
gsm_QLB
 [4] ;

275 
w‹d
 
gsm_H
 [11] ;

276 
w‹d
 
gsm_NRFAC
 [8] ;

277 
w‹d
 
gsm_FAC
 [8] ;

284 #ifde‡
NDEBUG


286 
	#gsm_debug_w‹ds
(
a
, 
b
, 
c
, 
d
Ë

	)

287 
	#gsm_debug_l⁄gw‹ds
(
a
, 
b
, 
c
, 
d
Ë

	)

288 
	#gsm_debug_w‹d
(
a
, 
b
Ë

	)

289 
	#gsm_debug_l⁄gw‹d
(
a
, 
b
Ë

	)

293 
gsm_debug_w‹ds
 (* 
«me
, , , 
w‹d
 *) ;

294 
gsm_debug_l⁄gw‹ds
 (* 
«me
, , , 
l⁄gw‹d
 *) ;

295 
gsm_debug_l⁄gw‹d
 (* 
«me
, 
l⁄gw‹d
) ;

296 
gsm_debug_w‹d
 (* 
«me
, 
w‹d
) ;

	@libsndfile-1.0.17/src/GSM610/gsm_create.c

7 
	~"c⁄fig.h
"

9 
	~<°dio.h
>

10 
	~<°dlib.h
>

11 
	~<°rög.h
>

15 
	~"gsm.h
"

16 
	~"gsm610_¥iv.h
"

18 
gsm
 
	$gsm_¸óã
 ()

20 
gsm
 
r
;

22 
r
 = 
	`mÆloc
 ((
gsm_°©e
));

23 i‡(!
r
) Ñ;

25 
	`mem£t
((*)
r
, 0,  (
gsm_°©e
));

26 
r
->
ƒp
 = 40;

28  
r
;

29 
	}
}

32 
	$gsm_öô
 (
gsm
 
°©e
)

34 
	`mem£t
 (
°©e
, 0,  (
gsm_°©e
)) ;

35 
°©e
->
ƒp
 = 40 ;

36 
	}
}

	@libsndfile-1.0.17/src/GSM610/gsm_decode.c

7 
	~"gsm610_¥iv.h
"

9 
	~"gsm.h
"

11 
	$gsm_decode
 (
gsm
 
s
, 
gsm_byã
 * 
c
, 
gsm_sig«l
 * 
èrgë
)

13 
w‹d
 
LARc
[8], 
Nc
[4], 
Mc
[4], 
bc
[4], 
xmaxc
[4], 
xmc
[13*4];

15 #ifde‡
WAV49


16 i‡(
s
->
wav_fmt
) {

18 
uw‹d
 
§
 = 0;

20 
s
->
‰ame_ödex
 = !s->frame_index;

21 i‡(
s
->
‰ame_ödex
) {

23 
§
 = *
c
++;

24 
LARc
[0] = 
§
 & 0x3f; sr >>= 6;

25 
§
 |(
uw‹d
)*
c
++ << 2;

26 
LARc
[1] = 
§
 & 0x3f; sr >>= 6;

27 
§
 |(
uw‹d
)*
c
++ << 4;

28 
LARc
[2] = 
§
 & 0x1f; sr >>= 5;

29 
LARc
[3] = 
§
 & 0x1f; sr >>= 5;

30 
§
 |(
uw‹d
)*
c
++ << 2;

31 
LARc
[4] = 
§
 & 0xf; sr >>= 4;

32 
LARc
[5] = 
§
 & 0xf; sr >>= 4;

33 
§
 |(
uw‹d
)*
c
++ << 2;

34 
LARc
[6] = 
§
 & 0x7; sr >>= 3;

35 
LARc
[7] = 
§
 & 0x7; sr >>= 3;

36 
§
 |(
uw‹d
)*
c
++ << 4;

37 
Nc
[0] = 
§
 & 0x7f; sr >>= 7;

38 
bc
[0] = 
§
 & 0x3; sr >>= 2;

39 
Mc
[0] = 
§
 & 0x3; sr >>= 2;

40 
§
 |(
uw‹d
)*
c
++ << 1;

41 
xmaxc
[0] = 
§
 & 0x3f; sr >>= 6;

42 
xmc
[0] = 
§
 & 0x7; sr >>= 3;

43 
§
 = *
c
++;

44 
xmc
[1] = 
§
 & 0x7; sr >>= 3;

45 
xmc
[2] = 
§
 & 0x7; sr >>= 3;

46 
§
 |(
uw‹d
)*
c
++ << 2;

47 
xmc
[3] = 
§
 & 0x7; sr >>= 3;

48 
xmc
[4] = 
§
 & 0x7; sr >>= 3;

49 
xmc
[5] = 
§
 & 0x7; sr >>= 3;

50 
§
 |(
uw‹d
)*
c
++ << 1;

51 
xmc
[6] = 
§
 & 0x7; sr >>= 3;

52 
xmc
[7] = 
§
 & 0x7; sr >>= 3;

53 
xmc
[8] = 
§
 & 0x7; sr >>= 3;

54 
§
 = *
c
++;

55 
xmc
[9] = 
§
 & 0x7; sr >>= 3;

56 
xmc
[10] = 
§
 & 0x7; sr >>= 3;

57 
§
 |(
uw‹d
)*
c
++ << 2;

58 
xmc
[11] = 
§
 & 0x7; sr >>= 3;

59 
xmc
[12] = 
§
 & 0x7; sr >>= 3;

60 
§
 |(
uw‹d
)*
c
++ << 4;

61 
Nc
[1] = 
§
 & 0x7f; sr >>= 7;

62 
bc
[1] = 
§
 & 0x3; sr >>= 2;

63 
Mc
[1] = 
§
 & 0x3; sr >>= 2;

64 
§
 |(
uw‹d
)*
c
++ << 1;

65 
xmaxc
[1] = 
§
 & 0x3f; sr >>= 6;

66 
xmc
[13] = 
§
 & 0x7; sr >>= 3;

67 
§
 = *
c
++;

68 
xmc
[14] = 
§
 & 0x7; sr >>= 3;

69 
xmc
[15] = 
§
 & 0x7; sr >>= 3;

70 
§
 |(
uw‹d
)*
c
++ << 2;

71 
xmc
[16] = 
§
 & 0x7; sr >>= 3;

72 
xmc
[17] = 
§
 & 0x7; sr >>= 3;

73 
xmc
[18] = 
§
 & 0x7; sr >>= 3;

74 
§
 |(
uw‹d
)*
c
++ << 1;

75 
xmc
[19] = 
§
 & 0x7; sr >>= 3;

76 
xmc
[20] = 
§
 & 0x7; sr >>= 3;

77 
xmc
[21] = 
§
 & 0x7; sr >>= 3;

78 
§
 = *
c
++;

79 
xmc
[22] = 
§
 & 0x7; sr >>= 3;

80 
xmc
[23] = 
§
 & 0x7; sr >>= 3;

81 
§
 |(
uw‹d
)*
c
++ << 2;

82 
xmc
[24] = 
§
 & 0x7; sr >>= 3;

83 
xmc
[25] = 
§
 & 0x7; sr >>= 3;

84 
§
 |(
uw‹d
)*
c
++ << 4;

85 
Nc
[2] = 
§
 & 0x7f; sr >>= 7;

86 
bc
[2] = 
§
 & 0x3; sr >>= 2;

87 
Mc
[2] = 
§
 & 0x3; sr >>= 2;

88 
§
 |(
uw‹d
)*
c
++ << 1;

89 
xmaxc
[2] = 
§
 & 0x3f; sr >>= 6;

90 
xmc
[26] = 
§
 & 0x7; sr >>= 3;

91 
§
 = *
c
++;

92 
xmc
[27] = 
§
 & 0x7; sr >>= 3;

93 
xmc
[28] = 
§
 & 0x7; sr >>= 3;

94 
§
 |(
uw‹d
)*
c
++ << 2;

95 
xmc
[29] = 
§
 & 0x7; sr >>= 3;

96 
xmc
[30] = 
§
 & 0x7; sr >>= 3;

97 
xmc
[31] = 
§
 & 0x7; sr >>= 3;

98 
§
 |(
uw‹d
)*
c
++ << 1;

99 
xmc
[32] = 
§
 & 0x7; sr >>= 3;

100 
xmc
[33] = 
§
 & 0x7; sr >>= 3;

101 
xmc
[34] = 
§
 & 0x7; sr >>= 3;

102 
§
 = *
c
++;

103 
xmc
[35] = 
§
 & 0x7; sr >>= 3;

104 
xmc
[36] = 
§
 & 0x7; sr >>= 3;

105 
§
 |(
uw‹d
)*
c
++ << 2;

106 
xmc
[37] = 
§
 & 0x7; sr >>= 3;

107 
xmc
[38] = 
§
 & 0x7; sr >>= 3;

108 
§
 |(
uw‹d
)*
c
++ << 4;

109 
Nc
[3] = 
§
 & 0x7f; sr >>= 7;

110 
bc
[3] = 
§
 & 0x3; sr >>= 2;

111 
Mc
[3] = 
§
 & 0x3; sr >>= 2;

112 
§
 |(
uw‹d
)*
c
++ << 1;

113 
xmaxc
[3] = 
§
 & 0x3f; sr >>= 6;

114 
xmc
[39] = 
§
 & 0x7; sr >>= 3;

115 
§
 = *
c
++;

116 
xmc
[40] = 
§
 & 0x7; sr >>= 3;

117 
xmc
[41] = 
§
 & 0x7; sr >>= 3;

118 
§
 |(
uw‹d
)*
c
++ << 2;

119 
xmc
[42] = 
§
 & 0x7; sr >>= 3;

120 
xmc
[43] = 
§
 & 0x7; sr >>= 3;

121 
xmc
[44] = 
§
 & 0x7; sr >>= 3;

122 
§
 |(
uw‹d
)*
c
++ << 1;

123 
xmc
[45] = 
§
 & 0x7; sr >>= 3;

124 
xmc
[46] = 
§
 & 0x7; sr >>= 3;

125 
xmc
[47] = 
§
 & 0x7; sr >>= 3;

126 
§
 = *
c
++;

127 
xmc
[48] = 
§
 & 0x7; sr >>= 3;

128 
xmc
[49] = 
§
 & 0x7; sr >>= 3;

129 
§
 |(
uw‹d
)*
c
++ << 2;

130 
xmc
[50] = 
§
 & 0x7; sr >>= 3;

131 
xmc
[51] = 
§
 & 0x7; sr >>= 3;

133 
s
->
‰ame_chaö
 = 
§
 & 0xf;

136 
§
 = 
s
->
‰ame_chaö
;

137 
§
 |(
uw‹d
)*
c
++ << 4;

138 
LARc
[0] = 
§
 & 0x3f; sr >>= 6;

139 
LARc
[1] = 
§
 & 0x3f; sr >>= 6;

140 
§
 = *
c
++;

141 
LARc
[2] = 
§
 & 0x1f; sr >>= 5;

142 
§
 |(
uw‹d
)*
c
++ << 3;

143 
LARc
[3] = 
§
 & 0x1f; sr >>= 5;

144 
LARc
[4] = 
§
 & 0xf; sr >>= 4;

145 
§
 |(
uw‹d
)*
c
++ << 2;

146 
LARc
[5] = 
§
 & 0xf; sr >>= 4;

147 
LARc
[6] = 
§
 & 0x7; sr >>= 3;

148 
LARc
[7] = 
§
 & 0x7; sr >>= 3;

149 
§
 = *
c
++;

150 
Nc
[0] = 
§
 & 0x7f; sr >>= 7;

151 
§
 |(
uw‹d
)*
c
++ << 1;

152 
bc
[0] = 
§
 & 0x3; sr >>= 2;

153 
Mc
[0] = 
§
 & 0x3; sr >>= 2;

154 
§
 |(
uw‹d
)*
c
++ << 5;

155 
xmaxc
[0] = 
§
 & 0x3f; sr >>= 6;

156 
xmc
[0] = 
§
 & 0x7; sr >>= 3;

157 
xmc
[1] = 
§
 & 0x7; sr >>= 3;

158 
§
 |(
uw‹d
)*
c
++ << 1;

159 
xmc
[2] = 
§
 & 0x7; sr >>= 3;

160 
xmc
[3] = 
§
 & 0x7; sr >>= 3;

161 
xmc
[4] = 
§
 & 0x7; sr >>= 3;

162 
§
 = *
c
++;

163 
xmc
[5] = 
§
 & 0x7; sr >>= 3;

164 
xmc
[6] = 
§
 & 0x7; sr >>= 3;

165 
§
 |(
uw‹d
)*
c
++ << 2;

166 
xmc
[7] = 
§
 & 0x7; sr >>= 3;

167 
xmc
[8] = 
§
 & 0x7; sr >>= 3;

168 
xmc
[9] = 
§
 & 0x7; sr >>= 3;

169 
§
 |(
uw‹d
)*
c
++ << 1;

170 
xmc
[10] = 
§
 & 0x7; sr >>= 3;

171 
xmc
[11] = 
§
 & 0x7; sr >>= 3;

172 
xmc
[12] = 
§
 & 0x7; sr >>= 3;

173 
§
 = *
c
++;

174 
Nc
[1] = 
§
 & 0x7f; sr >>= 7;

175 
§
 |(
uw‹d
)*
c
++ << 1;

176 
bc
[1] = 
§
 & 0x3; sr >>= 2;

177 
Mc
[1] = 
§
 & 0x3; sr >>= 2;

178 
§
 |(
uw‹d
)*
c
++ << 5;

179 
xmaxc
[1] = 
§
 & 0x3f; sr >>= 6;

180 
xmc
[13] = 
§
 & 0x7; sr >>= 3;

181 
xmc
[14] = 
§
 & 0x7; sr >>= 3;

182 
§
 |(
uw‹d
)*
c
++ << 1;

183 
xmc
[15] = 
§
 & 0x7; sr >>= 3;

184 
xmc
[16] = 
§
 & 0x7; sr >>= 3;

185 
xmc
[17] = 
§
 & 0x7; sr >>= 3;

186 
§
 = *
c
++;

187 
xmc
[18] = 
§
 & 0x7; sr >>= 3;

188 
xmc
[19] = 
§
 & 0x7; sr >>= 3;

189 
§
 |(
uw‹d
)*
c
++ << 2;

190 
xmc
[20] = 
§
 & 0x7; sr >>= 3;

191 
xmc
[21] = 
§
 & 0x7; sr >>= 3;

192 
xmc
[22] = 
§
 & 0x7; sr >>= 3;

193 
§
 |(
uw‹d
)*
c
++ << 1;

194 
xmc
[23] = 
§
 & 0x7; sr >>= 3;

195 
xmc
[24] = 
§
 & 0x7; sr >>= 3;

196 
xmc
[25] = 
§
 & 0x7; sr >>= 3;

197 
§
 = *
c
++;

198 
Nc
[2] = 
§
 & 0x7f; sr >>= 7;

199 
§
 |(
uw‹d
)*
c
++ << 1;

200 
bc
[2] = 
§
 & 0x3; sr >>= 2;

201 
Mc
[2] = 
§
 & 0x3; sr >>= 2;

202 
§
 |(
uw‹d
)*
c
++ << 5;

203 
xmaxc
[2] = 
§
 & 0x3f; sr >>= 6;

204 
xmc
[26] = 
§
 & 0x7; sr >>= 3;

205 
xmc
[27] = 
§
 & 0x7; sr >>= 3;

206 
§
 |(
uw‹d
)*
c
++ << 1;

207 
xmc
[28] = 
§
 & 0x7; sr >>= 3;

208 
xmc
[29] = 
§
 & 0x7; sr >>= 3;

209 
xmc
[30] = 
§
 & 0x7; sr >>= 3;

210 
§
 = *
c
++;

211 
xmc
[31] = 
§
 & 0x7; sr >>= 3;

212 
xmc
[32] = 
§
 & 0x7; sr >>= 3;

213 
§
 |(
uw‹d
)*
c
++ << 2;

214 
xmc
[33] = 
§
 & 0x7; sr >>= 3;

215 
xmc
[34] = 
§
 & 0x7; sr >>= 3;

216 
xmc
[35] = 
§
 & 0x7; sr >>= 3;

217 
§
 |(
uw‹d
)*
c
++ << 1;

218 
xmc
[36] = 
§
 & 0x7; sr >>= 3;

219 
xmc
[37] = 
§
 & 0x7; sr >>= 3;

220 
xmc
[38] = 
§
 & 0x7; sr >>= 3;

221 
§
 = *
c
++;

222 
Nc
[3] = 
§
 & 0x7f; sr >>= 7;

223 
§
 |(
uw‹d
)*
c
++ << 1;

224 
bc
[3] = 
§
 & 0x3; sr >>= 2;

225 
Mc
[3] = 
§
 & 0x3; sr >>= 2;

226 
§
 |(
uw‹d
)*
c
++ << 5;

227 
xmaxc
[3] = 
§
 & 0x3f; sr >>= 6;

228 
xmc
[39] = 
§
 & 0x7; sr >>= 3;

229 
xmc
[40] = 
§
 & 0x7; sr >>= 3;

230 
§
 |(
uw‹d
)*
c
++ << 1;

231 
xmc
[41] = 
§
 & 0x7; sr >>= 3;

232 
xmc
[42] = 
§
 & 0x7; sr >>= 3;

233 
xmc
[43] = 
§
 & 0x7; sr >>= 3;

234 
§
 = *
c
++;

235 
xmc
[44] = 
§
 & 0x7; sr >>= 3;

236 
xmc
[45] = 
§
 & 0x7; sr >>= 3;

237 
§
 |(
uw‹d
)*
c
++ << 2;

238 
xmc
[46] = 
§
 & 0x7; sr >>= 3;

239 
xmc
[47] = 
§
 & 0x7; sr >>= 3;

240 
xmc
[48] = 
§
 & 0x7; sr >>= 3;

241 
§
 |(
uw‹d
)*
c
++ << 1;

242 
xmc
[49] = 
§
 & 0x7; sr >>= 3;

243 
xmc
[50] = 
§
 & 0x7; sr >>= 3;

244 
xmc
[51] = 
§
 & 0x7; sr >>= 3;

252 i‡(((*
c
 >> 4Ë& 0x0FË!
GSM_MAGIC
)  -1;

254 
LARc
[0] = (*
c
++ & 0xF) << 2;

255 
LARc
[0] |(*
c
 >> 6) & 0x3;

256 
LARc
[1] = *
c
++ & 0x3F;

257 
LARc
[2] = (*
c
 >> 3) & 0x1F;

258 
LARc
[3] = (*
c
++ & 0x7) << 2;

259 
LARc
[3] |(*
c
 >> 6) & 0x3;

260 
LARc
[4] = (*
c
 >> 2) & 0xF;

261 
LARc
[5] = (*
c
++ & 0x3) << 2;

262 
LARc
[5] |(*
c
 >> 6) & 0x3;

263 
LARc
[6] = (*
c
 >> 3) & 0x7;

264 
LARc
[7] = *
c
++ & 0x7;

265 
Nc
[0] = (*
c
 >> 1) & 0x7F;

266 
bc
[0] = (*
c
++ & 0x1) << 1;

267 
bc
[0] |(*
c
 >> 7) & 0x1;

268 
Mc
[0] = (*
c
 >> 5) & 0x3;

269 
xmaxc
[0] = (*
c
++ & 0x1F) << 1;

270 
xmaxc
[0] |(*
c
 >> 7) & 0x1;

271 
xmc
[0] = (*
c
 >> 4) & 0x7;

272 
xmc
[1] = (*
c
 >> 1) & 0x7;

273 
xmc
[2] = (*
c
++ & 0x1) << 2;

274 
xmc
[2] |(*
c
 >> 6) & 0x3;

275 
xmc
[3] = (*
c
 >> 3) & 0x7;

276 
xmc
[4] = *
c
++ & 0x7;

277 
xmc
[5] = (*
c
 >> 5) & 0x7;

278 
xmc
[6] = (*
c
 >> 2) & 0x7;

279 
xmc
[7] = (*
c
++ & 0x3) << 1;

280 
xmc
[7] |(*
c
 >> 7) & 0x1;

281 
xmc
[8] = (*
c
 >> 4) & 0x7;

282 
xmc
[9] = (*
c
 >> 1) & 0x7;

283 
xmc
[10] = (*
c
++ & 0x1) << 2;

284 
xmc
[10] |(*
c
 >> 6) & 0x3;

285 
xmc
[11] = (*
c
 >> 3) & 0x7;

286 
xmc
[12] = *
c
++ & 0x7;

287 
Nc
[1] = (*
c
 >> 1) & 0x7F;

288 
bc
[1] = (*
c
++ & 0x1) << 1;

289 
bc
[1] |(*
c
 >> 7) & 0x1;

290 
Mc
[1] = (*
c
 >> 5) & 0x3;

291 
xmaxc
[1] = (*
c
++ & 0x1F) << 1;

292 
xmaxc
[1] |(*
c
 >> 7) & 0x1;

293 
xmc
[13] = (*
c
 >> 4) & 0x7;

294 
xmc
[14] = (*
c
 >> 1) & 0x7;

295 
xmc
[15] = (*
c
++ & 0x1) << 2;

296 
xmc
[15] |(*
c
 >> 6) & 0x3;

297 
xmc
[16] = (*
c
 >> 3) & 0x7;

298 
xmc
[17] = *
c
++ & 0x7;

299 
xmc
[18] = (*
c
 >> 5) & 0x7;

300 
xmc
[19] = (*
c
 >> 2) & 0x7;

301 
xmc
[20] = (*
c
++ & 0x3) << 1;

302 
xmc
[20] |(*
c
 >> 7) & 0x1;

303 
xmc
[21] = (*
c
 >> 4) & 0x7;

304 
xmc
[22] = (*
c
 >> 1) & 0x7;

305 
xmc
[23] = (*
c
++ & 0x1) << 2;

306 
xmc
[23] |(*
c
 >> 6) & 0x3;

307 
xmc
[24] = (*
c
 >> 3) & 0x7;

308 
xmc
[25] = *
c
++ & 0x7;

309 
Nc
[2] = (*
c
 >> 1) & 0x7F;

310 
bc
[2] = (*
c
++ & 0x1) << 1;

311 
bc
[2] |(*
c
 >> 7) & 0x1;

312 
Mc
[2] = (*
c
 >> 5) & 0x3;

313 
xmaxc
[2] = (*
c
++ & 0x1F) << 1;

314 
xmaxc
[2] |(*
c
 >> 7) & 0x1;

315 
xmc
[26] = (*
c
 >> 4) & 0x7;

316 
xmc
[27] = (*
c
 >> 1) & 0x7;

317 
xmc
[28] = (*
c
++ & 0x1) << 2;

318 
xmc
[28] |(*
c
 >> 6) & 0x3;

319 
xmc
[29] = (*
c
 >> 3) & 0x7;

320 
xmc
[30] = *
c
++ & 0x7;

321 
xmc
[31] = (*
c
 >> 5) & 0x7;

322 
xmc
[32] = (*
c
 >> 2) & 0x7;

323 
xmc
[33] = (*
c
++ & 0x3) << 1;

324 
xmc
[33] |(*
c
 >> 7) & 0x1;

325 
xmc
[34] = (*
c
 >> 4) & 0x7;

326 
xmc
[35] = (*
c
 >> 1) & 0x7;

327 
xmc
[36] = (*
c
++ & 0x1) << 2;

328 
xmc
[36] |(*
c
 >> 6) & 0x3;

329 
xmc
[37] = (*
c
 >> 3) & 0x7;

330 
xmc
[38] = *
c
++ & 0x7;

331 
Nc
[3] = (*
c
 >> 1) & 0x7F;

332 
bc
[3] = (*
c
++ & 0x1) << 1;

333 
bc
[3] |(*
c
 >> 7) & 0x1;

334 
Mc
[3] = (*
c
 >> 5) & 0x3;

335 
xmaxc
[3] = (*
c
++ & 0x1F) << 1;

336 
xmaxc
[3] |(*
c
 >> 7) & 0x1;

337 
xmc
[39] = (*
c
 >> 4) & 0x7;

338 
xmc
[40] = (*
c
 >> 1) & 0x7;

339 
xmc
[41] = (*
c
++ & 0x1) << 2;

340 
xmc
[41] |(*
c
 >> 6) & 0x3;

341 
xmc
[42] = (*
c
 >> 3) & 0x7;

342 
xmc
[43] = *
c
++ & 0x7;

343 
xmc
[44] = (*
c
 >> 5) & 0x7;

344 
xmc
[45] = (*
c
 >> 2) & 0x7;

345 
xmc
[46] = (*
c
++ & 0x3) << 1;

346 
xmc
[46] |(*
c
 >> 7) & 0x1;

347 
xmc
[47] = (*
c
 >> 4) & 0x7;

348 
xmc
[48] = (*
c
 >> 1) & 0x7;

349 
xmc
[49] = (*
c
++ & 0x1) << 2;

350 
xmc
[49] |(*
c
 >> 6) & 0x3;

351 
xmc
[50] = (*
c
 >> 3) & 0x7;

352 
xmc
[51] = *
c
 & 0x7;

355 
	`Gsm_Decodî
(
s
, 
LARc
, 
Nc
, 
bc
, 
Mc
, 
xmaxc
, 
xmc
, 
èrgë
);

358 
	}
}

	@libsndfile-1.0.17/src/GSM610/gsm_destroy.c

7 
	~"gsm.h
"

8 
	~"c⁄fig.h
"

10 #ifdef 
HAS_STDLIB_H


11 
	~<°dlib.h
>

13 #ifdef 
HAS_MALLOC_H


14 
	~<mÆloc.h
>

16 
‰ì
();

20 
	$gsm_de°roy
 (
gsm
 
S
)

22 i‡(
S
Ë
	`‰ì
((*)S);

23 
	}
}

	@libsndfile-1.0.17/src/GSM610/gsm_encode.c

7 
	~"gsm610_¥iv.h
"

8 
	~"gsm.h
"

10 
	$gsm_ícode
 (
gsm
 
s
, 
gsm_sig«l
 * 
sour˚
, 
gsm_byã
 * 
c
)

12 
w‹d
 
LARc
[8], 
Nc
[4], 
Mc
[4], 
bc
[4], 
xmaxc
[4], 
xmc
[13*4];

14 
	`Gsm_Codî
(
s
, 
sour˚
, 
LARc
, 
Nc
, 
bc
, 
Mc
, 
xmaxc
, 
xmc
);

103 #ifde‡
WAV49


105 i‡(
s
->
wav_fmt
) {

106 
s
->
‰ame_ödex
 = !s->frame_index;

107 i‡(
s
->
‰ame_ödex
) {

109 
uw‹d
 
§
;

111 
§
 = 0;

112 
§
 = s∏>> 6 | 
LARc
[0] << 10;

113 
§
 = s∏>> 6 | 
LARc
[1] << 10;

114 *
c
++ = 
§
 >> 4;

115 
§
 = s∏>> 5 | 
LARc
[2] << 11;

116 *
c
++ = 
§
 >> 7;

117 
§
 = s∏>> 5 | 
LARc
[3] << 11;

118 
§
 = s∏>> 4 | 
LARc
[4] << 12;

119 *
c
++ = 
§
 >> 6;

120 
§
 = s∏>> 4 | 
LARc
[5] << 12;

121 
§
 = s∏>> 3 | 
LARc
[6] << 13;

122 *
c
++ = 
§
 >> 7;

123 
§
 = s∏>> 3 | 
LARc
[7] << 13;

124 
§
 = s∏>> 7 | 
Nc
[0] << 9;

125 *
c
++ = 
§
 >> 5;

126 
§
 = s∏>> 2 | 
bc
[0] << 14;

127 
§
 = s∏>> 2 | 
Mc
[0] << 14;

128 
§
 = s∏>> 6 | 
xmaxc
[0] << 10;

129 *
c
++ = 
§
 >> 3;

130 
§
 = s∏>> 3 | 
xmc
[0] << 13;

131 *
c
++ = 
§
 >> 8;

132 
§
 = s∏>> 3 | 
xmc
[1] << 13;

133 
§
 = s∏>> 3 | 
xmc
[2] << 13;

134 
§
 = s∏>> 3 | 
xmc
[3] << 13;

135 *
c
++ = 
§
 >> 7;

136 
§
 = s∏>> 3 | 
xmc
[4] << 13;

137 
§
 = s∏>> 3 | 
xmc
[5] << 13;

138 
§
 = s∏>> 3 | 
xmc
[6] << 13;

139 *
c
++ = 
§
 >> 6;

140 
§
 = s∏>> 3 | 
xmc
[7] << 13;

141 
§
 = s∏>> 3 | 
xmc
[8] << 13;

142 *
c
++ = 
§
 >> 8;

143 
§
 = s∏>> 3 | 
xmc
[9] << 13;

144 
§
 = s∏>> 3 | 
xmc
[10] << 13;

145 
§
 = s∏>> 3 | 
xmc
[11] << 13;

146 *
c
++ = 
§
 >> 7;

147 
§
 = s∏>> 3 | 
xmc
[12] << 13;

148 
§
 = s∏>> 7 | 
Nc
[1] << 9;

149 *
c
++ = 
§
 >> 5;

150 
§
 = s∏>> 2 | 
bc
[1] << 14;

151 
§
 = s∏>> 2 | 
Mc
[1] << 14;

152 
§
 = s∏>> 6 | 
xmaxc
[1] << 10;

153 *
c
++ = 
§
 >> 3;

154 
§
 = s∏>> 3 | 
xmc
[13] << 13;

155 *
c
++ = 
§
 >> 8;

156 
§
 = s∏>> 3 | 
xmc
[14] << 13;

157 
§
 = s∏>> 3 | 
xmc
[15] << 13;

158 
§
 = s∏>> 3 | 
xmc
[16] << 13;

159 *
c
++ = 
§
 >> 7;

160 
§
 = s∏>> 3 | 
xmc
[17] << 13;

161 
§
 = s∏>> 3 | 
xmc
[18] << 13;

162 
§
 = s∏>> 3 | 
xmc
[19] << 13;

163 *
c
++ = 
§
 >> 6;

164 
§
 = s∏>> 3 | 
xmc
[20] << 13;

165 
§
 = s∏>> 3 | 
xmc
[21] << 13;

166 *
c
++ = 
§
 >> 8;

167 
§
 = s∏>> 3 | 
xmc
[22] << 13;

168 
§
 = s∏>> 3 | 
xmc
[23] << 13;

169 
§
 = s∏>> 3 | 
xmc
[24] << 13;

170 *
c
++ = 
§
 >> 7;

171 
§
 = s∏>> 3 | 
xmc
[25] << 13;

172 
§
 = s∏>> 7 | 
Nc
[2] << 9;

173 *
c
++ = 
§
 >> 5;

174 
§
 = s∏>> 2 | 
bc
[2] << 14;

175 
§
 = s∏>> 2 | 
Mc
[2] << 14;

176 
§
 = s∏>> 6 | 
xmaxc
[2] << 10;

177 *
c
++ = 
§
 >> 3;

178 
§
 = s∏>> 3 | 
xmc
[26] << 13;

179 *
c
++ = 
§
 >> 8;

180 
§
 = s∏>> 3 | 
xmc
[27] << 13;

181 
§
 = s∏>> 3 | 
xmc
[28] << 13;

182 
§
 = s∏>> 3 | 
xmc
[29] << 13;

183 *
c
++ = 
§
 >> 7;

184 
§
 = s∏>> 3 | 
xmc
[30] << 13;

185 
§
 = s∏>> 3 | 
xmc
[31] << 13;

186 
§
 = s∏>> 3 | 
xmc
[32] << 13;

187 *
c
++ = 
§
 >> 6;

188 
§
 = s∏>> 3 | 
xmc
[33] << 13;

189 
§
 = s∏>> 3 | 
xmc
[34] << 13;

190 *
c
++ = 
§
 >> 8;

191 
§
 = s∏>> 3 | 
xmc
[35] << 13;

192 
§
 = s∏>> 3 | 
xmc
[36] << 13;

193 
§
 = s∏>> 3 | 
xmc
[37] << 13;

194 *
c
++ = 
§
 >> 7;

195 
§
 = s∏>> 3 | 
xmc
[38] << 13;

196 
§
 = s∏>> 7 | 
Nc
[3] << 9;

197 *
c
++ = 
§
 >> 5;

198 
§
 = s∏>> 2 | 
bc
[3] << 14;

199 
§
 = s∏>> 2 | 
Mc
[3] << 14;

200 
§
 = s∏>> 6 | 
xmaxc
[3] << 10;

201 *
c
++ = 
§
 >> 3;

202 
§
 = s∏>> 3 | 
xmc
[39] << 13;

203 *
c
++ = 
§
 >> 8;

204 
§
 = s∏>> 3 | 
xmc
[40] << 13;

205 
§
 = s∏>> 3 | 
xmc
[41] << 13;

206 
§
 = s∏>> 3 | 
xmc
[42] << 13;

207 *
c
++ = 
§
 >> 7;

208 
§
 = s∏>> 3 | 
xmc
[43] << 13;

209 
§
 = s∏>> 3 | 
xmc
[44] << 13;

210 
§
 = s∏>> 3 | 
xmc
[45] << 13;

211 *
c
++ = 
§
 >> 6;

212 
§
 = s∏>> 3 | 
xmc
[46] << 13;

213 
§
 = s∏>> 3 | 
xmc
[47] << 13;

214 *
c
++ = 
§
 >> 8;

215 
§
 = s∏>> 3 | 
xmc
[48] << 13;

216 
§
 = s∏>> 3 | 
xmc
[49] << 13;

217 
§
 = s∏>> 3 | 
xmc
[50] << 13;

218 *
c
++ = 
§
 >> 7;

219 
§
 = s∏>> 3 | 
xmc
[51] << 13;

220 
§
 = sr >> 4;

221 *
c
 = 
§
 >> 8;

222 
s
->
‰ame_chaö
 = *
c
;

225 
uw‹d
 
§
;

227 
§
 = 0;

228 
§
 = s∏>> 4 | 
s
->
‰ame_chaö
 << 12;

229 
§
 = s∏>> 6 | 
LARc
[0] << 10;

230 *
c
++ = 
§
 >> 6;

231 
§
 = s∏>> 6 | 
LARc
[1] << 10;

232 *
c
++ = 
§
 >> 8;

233 
§
 = s∏>> 5 | 
LARc
[2] << 11;

234 
§
 = s∏>> 5 | 
LARc
[3] << 11;

235 *
c
++ = 
§
 >> 6;

236 
§
 = s∏>> 4 | 
LARc
[4] << 12;

237 
§
 = s∏>> 4 | 
LARc
[5] << 12;

238 *
c
++ = 
§
 >> 6;

239 
§
 = s∏>> 3 | 
LARc
[6] << 13;

240 
§
 = s∏>> 3 | 
LARc
[7] << 13;

241 *
c
++ = 
§
 >> 8;

242 
§
 = s∏>> 7 | 
Nc
[0] << 9;

243 
§
 = s∏>> 2 | 
bc
[0] << 14;

244 *
c
++ = 
§
 >> 7;

245 
§
 = s∏>> 2 | 
Mc
[0] << 14;

246 
§
 = s∏>> 6 | 
xmaxc
[0] << 10;

247 *
c
++ = 
§
 >> 7;

248 
§
 = s∏>> 3 | 
xmc
[0] << 13;

249 
§
 = s∏>> 3 | 
xmc
[1] << 13;

250 
§
 = s∏>> 3 | 
xmc
[2] << 13;

251 *
c
++ = 
§
 >> 6;

252 
§
 = s∏>> 3 | 
xmc
[3] << 13;

253 
§
 = s∏>> 3 | 
xmc
[4] << 13;

254 *
c
++ = 
§
 >> 8;

255 
§
 = s∏>> 3 | 
xmc
[5] << 13;

256 
§
 = s∏>> 3 | 
xmc
[6] << 13;

257 
§
 = s∏>> 3 | 
xmc
[7] << 13;

258 *
c
++ = 
§
 >> 7;

259 
§
 = s∏>> 3 | 
xmc
[8] << 13;

260 
§
 = s∏>> 3 | 
xmc
[9] << 13;

261 
§
 = s∏>> 3 | 
xmc
[10] << 13;

262 *
c
++ = 
§
 >> 6;

263 
§
 = s∏>> 3 | 
xmc
[11] << 13;

264 
§
 = s∏>> 3 | 
xmc
[12] << 13;

265 *
c
++ = 
§
 >> 8;

266 
§
 = s∏>> 7 | 
Nc
[1] << 9;

267 
§
 = s∏>> 2 | 
bc
[1] << 14;

268 *
c
++ = 
§
 >> 7;

269 
§
 = s∏>> 2 | 
Mc
[1] << 14;

270 
§
 = s∏>> 6 | 
xmaxc
[1] << 10;

271 *
c
++ = 
§
 >> 7;

272 
§
 = s∏>> 3 | 
xmc
[13] << 13;

273 
§
 = s∏>> 3 | 
xmc
[14] << 13;

274 
§
 = s∏>> 3 | 
xmc
[15] << 13;

275 *
c
++ = 
§
 >> 6;

276 
§
 = s∏>> 3 | 
xmc
[16] << 13;

277 
§
 = s∏>> 3 | 
xmc
[17] << 13;

278 *
c
++ = 
§
 >> 8;

279 
§
 = s∏>> 3 | 
xmc
[18] << 13;

280 
§
 = s∏>> 3 | 
xmc
[19] << 13;

281 
§
 = s∏>> 3 | 
xmc
[20] << 13;

282 *
c
++ = 
§
 >> 7;

283 
§
 = s∏>> 3 | 
xmc
[21] << 13;

284 
§
 = s∏>> 3 | 
xmc
[22] << 13;

285 
§
 = s∏>> 3 | 
xmc
[23] << 13;

286 *
c
++ = 
§
 >> 6;

287 
§
 = s∏>> 3 | 
xmc
[24] << 13;

288 
§
 = s∏>> 3 | 
xmc
[25] << 13;

289 *
c
++ = 
§
 >> 8;

290 
§
 = s∏>> 7 | 
Nc
[2] << 9;

291 
§
 = s∏>> 2 | 
bc
[2] << 14;

292 *
c
++ = 
§
 >> 7;

293 
§
 = s∏>> 2 | 
Mc
[2] << 14;

294 
§
 = s∏>> 6 | 
xmaxc
[2] << 10;

295 *
c
++ = 
§
 >> 7;

296 
§
 = s∏>> 3 | 
xmc
[26] << 13;

297 
§
 = s∏>> 3 | 
xmc
[27] << 13;

298 
§
 = s∏>> 3 | 
xmc
[28] << 13;

299 *
c
++ = 
§
 >> 6;

300 
§
 = s∏>> 3 | 
xmc
[29] << 13;

301 
§
 = s∏>> 3 | 
xmc
[30] << 13;

302 *
c
++ = 
§
 >> 8;

303 
§
 = s∏>> 3 | 
xmc
[31] << 13;

304 
§
 = s∏>> 3 | 
xmc
[32] << 13;

305 
§
 = s∏>> 3 | 
xmc
[33] << 13;

306 *
c
++ = 
§
 >> 7;

307 
§
 = s∏>> 3 | 
xmc
[34] << 13;

308 
§
 = s∏>> 3 | 
xmc
[35] << 13;

309 
§
 = s∏>> 3 | 
xmc
[36] << 13;

310 *
c
++ = 
§
 >> 6;

311 
§
 = s∏>> 3 | 
xmc
[37] << 13;

312 
§
 = s∏>> 3 | 
xmc
[38] << 13;

313 *
c
++ = 
§
 >> 8;

314 
§
 = s∏>> 7 | 
Nc
[3] << 9;

315 
§
 = s∏>> 2 | 
bc
[3] << 14;

316 *
c
++ = 
§
 >> 7;

317 
§
 = s∏>> 2 | 
Mc
[3] << 14;

318 
§
 = s∏>> 6 | 
xmaxc
[3] << 10;

319 *
c
++ = 
§
 >> 7;

320 
§
 = s∏>> 3 | 
xmc
[39] << 13;

321 
§
 = s∏>> 3 | 
xmc
[40] << 13;

322 
§
 = s∏>> 3 | 
xmc
[41] << 13;

323 *
c
++ = 
§
 >> 6;

324 
§
 = s∏>> 3 | 
xmc
[42] << 13;

325 
§
 = s∏>> 3 | 
xmc
[43] << 13;

326 *
c
++ = 
§
 >> 8;

327 
§
 = s∏>> 3 | 
xmc
[44] << 13;

328 
§
 = s∏>> 3 | 
xmc
[45] << 13;

329 
§
 = s∏>> 3 | 
xmc
[46] << 13;

330 *
c
++ = 
§
 >> 7;

331 
§
 = s∏>> 3 | 
xmc
[47] << 13;

332 
§
 = s∏>> 3 | 
xmc
[48] << 13;

333 
§
 = s∏>> 3 | 
xmc
[49] << 13;

334 *
c
++ = 
§
 >> 6;

335 
§
 = s∏>> 3 | 
xmc
[50] << 13;

336 
§
 = s∏>> 3 | 
xmc
[51] << 13;

337 *
c
++ = 
§
 >> 8;

346 *
c
++ = ((
GSM_MAGIC
 & 0xF) << 4)

347 | ((
LARc
[0] >> 2) & 0xF);

348 *
c
++ = ((
LARc
[0] & 0x3) << 6)

349 | (
LARc
[1] & 0x3F);

350 *
c
++ = ((
LARc
[2] & 0x1F) << 3)

351 | ((
LARc
[3] >> 2) & 0x7);

352 *
c
++ = ((
LARc
[3] & 0x3) << 6)

353 | ((
LARc
[4] & 0xF) << 2)

354 | ((
LARc
[5] >> 2) & 0x3);

355 *
c
++ = ((
LARc
[5] & 0x3) << 6)

356 | ((
LARc
[6] & 0x7) << 3)

357 | (
LARc
[7] & 0x7);

358 *
c
++ = ((
Nc
[0] & 0x7F) << 1)

359 | ((
bc
[0] >> 1) & 0x1);

360 *
c
++ = ((
bc
[0] & 0x1) << 7)

361 | ((
Mc
[0] & 0x3) << 5)

362 | ((
xmaxc
[0] >> 1) & 0x1F);

363 *
c
++ = ((
xmaxc
[0] & 0x1) << 7)

364 | ((
xmc
[0] & 0x7) << 4)

365 | ((
xmc
[1] & 0x7) << 1)

366 | ((
xmc
[2] >> 2) & 0x1);

367 *
c
++ = ((
xmc
[2] & 0x3) << 6)

368 | ((
xmc
[3] & 0x7) << 3)

369 | (
xmc
[4] & 0x7);

370 *
c
++ = ((
xmc
[5] & 0x7) << 5)

371 | ((
xmc
[6] & 0x7) << 2)

372 | ((
xmc
[7] >> 1) & 0x3);

373 *
c
++ = ((
xmc
[7] & 0x1) << 7)

374 | ((
xmc
[8] & 0x7) << 4)

375 | ((
xmc
[9] & 0x7) << 1)

376 | ((
xmc
[10] >> 2) & 0x1);

377 *
c
++ = ((
xmc
[10] & 0x3) << 6)

378 | ((
xmc
[11] & 0x7) << 3)

379 | (
xmc
[12] & 0x7);

380 *
c
++ = ((
Nc
[1] & 0x7F) << 1)

381 | ((
bc
[1] >> 1) & 0x1);

382 *
c
++ = ((
bc
[1] & 0x1) << 7)

383 | ((
Mc
[1] & 0x3) << 5)

384 | ((
xmaxc
[1] >> 1) & 0x1F);

385 *
c
++ = ((
xmaxc
[1] & 0x1) << 7)

386 | ((
xmc
[13] & 0x7) << 4)

387 | ((
xmc
[14] & 0x7) << 1)

388 | ((
xmc
[15] >> 2) & 0x1);

389 *
c
++ = ((
xmc
[15] & 0x3) << 6)

390 | ((
xmc
[16] & 0x7) << 3)

391 | (
xmc
[17] & 0x7);

392 *
c
++ = ((
xmc
[18] & 0x7) << 5)

393 | ((
xmc
[19] & 0x7) << 2)

394 | ((
xmc
[20] >> 1) & 0x3);

395 *
c
++ = ((
xmc
[20] & 0x1) << 7)

396 | ((
xmc
[21] & 0x7) << 4)

397 | ((
xmc
[22] & 0x7) << 1)

398 | ((
xmc
[23] >> 2) & 0x1);

399 *
c
++ = ((
xmc
[23] & 0x3) << 6)

400 | ((
xmc
[24] & 0x7) << 3)

401 | (
xmc
[25] & 0x7);

402 *
c
++ = ((
Nc
[2] & 0x7F) << 1)

403 | ((
bc
[2] >> 1) & 0x1);

404 *
c
++ = ((
bc
[2] & 0x1) << 7)

405 | ((
Mc
[2] & 0x3) << 5)

406 | ((
xmaxc
[2] >> 1) & 0x1F);

407 *
c
++ = ((
xmaxc
[2] & 0x1) << 7)

408 | ((
xmc
[26] & 0x7) << 4)

409 | ((
xmc
[27] & 0x7) << 1)

410 | ((
xmc
[28] >> 2) & 0x1);

411 *
c
++ = ((
xmc
[28] & 0x3) << 6)

412 | ((
xmc
[29] & 0x7) << 3)

413 | (
xmc
[30] & 0x7);

414 *
c
++ = ((
xmc
[31] & 0x7) << 5)

415 | ((
xmc
[32] & 0x7) << 2)

416 | ((
xmc
[33] >> 1) & 0x3);

417 *
c
++ = ((
xmc
[33] & 0x1) << 7)

418 | ((
xmc
[34] & 0x7) << 4)

419 | ((
xmc
[35] & 0x7) << 1)

420 | ((
xmc
[36] >> 2) & 0x1);

421 *
c
++ = ((
xmc
[36] & 0x3) << 6)

422 | ((
xmc
[37] & 0x7) << 3)

423 | (
xmc
[38] & 0x7);

424 *
c
++ = ((
Nc
[3] & 0x7F) << 1)

425 | ((
bc
[3] >> 1) & 0x1);

426 *
c
++ = ((
bc
[3] & 0x1) << 7)

427 | ((
Mc
[3] & 0x3) << 5)

428 | ((
xmaxc
[3] >> 1) & 0x1F);

429 *
c
++ = ((
xmaxc
[3] & 0x1) << 7)

430 | ((
xmc
[39] & 0x7) << 4)

431 | ((
xmc
[40] & 0x7) << 1)

432 | ((
xmc
[41] >> 2) & 0x1);

433 *
c
++ = ((
xmc
[41] & 0x3) << 6)

434 | ((
xmc
[42] & 0x7) << 3)

435 | (
xmc
[43] & 0x7);

436 *
c
++ = ((
xmc
[44] & 0x7) << 5)

437 | ((
xmc
[45] & 0x7) << 2)

438 | ((
xmc
[46] >> 1) & 0x3);

439 *
c
++ = ((
xmc
[46] & 0x1) << 7)

440 | ((
xmc
[47] & 0x7) << 4)

441 | ((
xmc
[48] & 0x7) << 1)

442 | ((
xmc
[49] >> 2) & 0x1);

443 *
c
++ = ((
xmc
[49] & 0x3) << 6)

444 | ((
xmc
[50] & 0x7) << 3)

445 | (
xmc
[51] & 0x7);

448 
	}
}

	@libsndfile-1.0.17/src/GSM610/gsm_option.c

7 
	~"gsm610_¥iv.h
"

9 
	~"gsm.h
"

11 
	$gsm_›ti⁄
 (
gsm
 
r
, 
›t
, * 
vÆ
)

13 
ªsu…
 = -1;

15 
›t
) {

16 
GSM_OPT_LTP_CUT
:

17 #ifde‡ 
LTP_CUT


18 
ªsu…
 = 
r
->
…p_cut
;

19 i‡(
vÆ
Ë
r
->
…p_cut
 = *val;

23 
GSM_OPT_VERBOSE
:

24 #i‚def 
NDEBUG


25 
ªsu…
 = 
r
->
vîbo£
;

26 i‡(
vÆ
Ë
r
->
vîbo£
 = *val;

30 
GSM_OPT_FAST
:

32 #if 
	`deföed
(
FAST
Ë&& deföed(
USE_FLOAT_MUL
)

33 
ªsu…
 = 
r
->
Á°
;

34 i‡(
vÆ
Ë
r
->
Á°
 = !!*val;

38 
GSM_OPT_FRAME_CHAIN
:

40 #ifde‡
WAV49


41 
ªsu…
 = 
r
->
‰ame_chaö
;

42 i‡(
vÆ
Ë
r
->
‰ame_chaö
 = *val;

46 
GSM_OPT_FRAME_INDEX
:

48 #ifde‡
WAV49


49 
ªsu…
 = 
r
->
‰ame_ödex
;

50 i‡(
vÆ
Ë
r
->
‰ame_ödex
 = *val;

54 
GSM_OPT_WAV49
:

56 #ifde‡
WAV49


57 
ªsu…
 = 
r
->
wav_fmt
;

58 i‡(
vÆ
Ë
r
->
wav_fmt
 = !!*val;

65  
ªsu…
;

66 
	}
}

	@libsndfile-1.0.17/src/GSM610/long_term.c

7 
	~<°dio.h
>

8 
	~<as£π.h
>

10 
	~"gsm610_¥iv.h
"

12 
	~"gsm.h
"

42 #i‚de‡ 
USE_FLOAT_MUL


44 #ifdef 
LTP_CUT


46 
	$Cut_CÆcuœti⁄_of_the_LTP_∑ømëîs
 (

48 
gsm_°©e
 * 
°
,

50 
w‹d
 * 
d
,

51 
w‹d
 * 
dp
,

52 
w‹d
 * 
bc_out
,

53 
w‹d
 * 
Nc_out


56 
k
, 
œmbda
;

57 
w‹d
 
Nc
, 
bc
;

58 
w‹d
 
wt
[40];

60 
l⁄gw‹d
 
L_ªsu…
;

61 
l⁄gw‹d
 
L_max
, 
L_powî
;

62 
w‹d
 
R
, 
S
, 
dmax
, 
sˇl
, 
be°_k
;

63 
w‹d
 
…p_cut
;

65 
w‹d
 
ãmp
, 
wt_k
;

69 
dmax
 = 0;

70 
k
 = 0; k <= 39; k++) {

71 
ãmp
 = 
d
[
k
];

72 
ãmp
 = 
	`GSM_ABS
(Åemp );

73 i‡(
ãmp
 > 
dmax
) {

74 
dmax
 = 
ãmp
;

75 
be°_k
 = 
k
;

78 
ãmp
 = 0;

79 i‡(
dmax
 =0Ë
sˇl
 = 0;

81 
	`as£π
(
dmax
 > 0);

82 
ãmp
 = 
	`gsm_n‹m
–(
l⁄gw‹d
)
dmax
 << 16 );

84 i‡(
ãmp
 > 6Ë
sˇl
 = 0;

85 
sˇl
 = 6 - 
ãmp
;

86 
	`as£π
(
sˇl
 >= 0);

90 
L_max
 = 0;

91 
Nc
 = 40;

92 
wt_k
 = 
	`SASR_W
(
d
[
be°_k
], 
sˇl
);

94 
œmbda
 = 40;Üambda <= 120;Üambda++) {

95 
L_ªsu…
 = (
l⁄gw‹d
)
wt_k
 * 
dp
[
be°_k
 - 
œmbda
];

96 i‡(
L_ªsu…
 > 
L_max
) {

97 
Nc
 = 
œmbda
;

98 
L_max
 = 
L_ªsu…
;

101 *
Nc_out
 = 
Nc
;

102 
L_max
 <<= 1;

106 
	`as£π
(
sˇl
 <= 100 && scal >= -100);

107 
L_max
 = L_max >> (6 - 
sˇl
);

109 
	`as£π
–
Nc
 <= 120 && Nc >= 40);

114 
L_powî
 = 0;

115 
k
 = 0; k <= 39; k++) {

117 
l⁄gw‹d
 
L_ãmp
;

119 
L_ãmp
 = 
	`SASR_W
–
dp
[
k
 - 
Nc
], 3 );

120 
L_powî
 +
L_ãmp
 * L_temp;

122 
L_powî
 <<= 1;

127 i‡(
L_max
 <= 0) {

128 *
bc_out
 = 0;

131 i‡(
L_max
 >
L_powî
) {

132 *
bc_out
 = 3;

136 
ãmp
 = 
	`gsm_n‹m
–
L_powî
 );

138 
R
 = 
	`SASR
–
L_max
 << 
ãmp
, 16 );

139 
S
 = 
	`SASR
–
L_powî
 << 
ãmp
, 16 );

147 
bc
 = 0; b¯<2; bc++Ëi‡(
R
 <
	`gsm_mu…
(
S
, 
gsm_DLB
[bc])) ;

148 *
bc_out
 = 
bc
;

149 
	}
}

153 
	$CÆcuœti⁄_of_the_LTP_∑ømëîs
 (

154 
w‹d
 * 
d
,

155 
w‹d
 * 
dp
,

156 
w‹d
 * 
bc_out
,

157 
w‹d
 * 
Nc_out


160 
k
, 
œmbda
;

161 
w‹d
 
Nc
, 
bc
;

162 
w‹d
 
wt
[40];

164 
l⁄gw‹d
 
L_max
, 
L_powî
;

165 
w‹d
 
R
, 
S
, 
dmax
, 
sˇl
;

166 
w‹d
 
ãmp
;

170 
dmax
 = 0;

172 
k
 = 0; k <= 39; k++) {

173 
ãmp
 = 
d
[
k
];

174 
ãmp
 = 
	`GSM_ABS
(Åemp );

175 i‡(
ãmp
 > 
dmax
) dmax =Åemp;

178 
ãmp
 = 0;

179 i‡(
dmax
 =0Ë
sˇl
 = 0;

181 
	`as£π
(
dmax
 > 0);

182 
ãmp
 = 
	`gsm_n‹m
–(
l⁄gw‹d
)
dmax
 << 16 );

185 i‡(
ãmp
 > 6Ë
sˇl
 = 0;

186 
sˇl
 = 6 - 
ãmp
;

188 
	`as£π
(
sˇl
 >= 0);

193 
k
 = 0; k <39; k++Ë
wt
[k] = 
	`SASR_W
–
d
[k], 
sˇl
 );

197 
L_max
 = 0;

198 
Nc
 = 40;

200 
œmbda
 = 40;Üambda <= 120;Üambda++) {

202 #unde‡
STEP


203 
	#STEP
(
k
Ë(
l⁄gw‹d
)
wt
[k] * 
dp
[k - 
œmbda
]

	)

205 
l⁄gw‹d
 
L_ªsu…
;

207 
L_ªsu…
 = 
	`STEP
(0) ; L_result += STEP(1) ;

208 
L_ªsu…
 +
	`STEP
(2) ; L_result += STEP(3) ;

209 
L_ªsu…
 +
	`STEP
(4) ; L_result += STEP(5) ;

210 
L_ªsu…
 +
	`STEP
(6) ; L_result += STEP(7) ;

211 
L_ªsu…
 +
	`STEP
(8) ; L_result += STEP(9) ;

212 
L_ªsu…
 +
	`STEP
(10) ; L_result += STEP(11) ;

213 
L_ªsu…
 +
	`STEP
(12) ; L_result += STEP(13) ;

214 
L_ªsu…
 +
	`STEP
(14) ; L_result += STEP(15) ;

215 
L_ªsu…
 +
	`STEP
(16) ; L_result += STEP(17) ;

216 
L_ªsu…
 +
	`STEP
(18) ; L_result += STEP(19) ;

217 
L_ªsu…
 +
	`STEP
(20) ; L_result += STEP(21) ;

218 
L_ªsu…
 +
	`STEP
(22) ; L_result += STEP(23) ;

219 
L_ªsu…
 +
	`STEP
(24) ; L_result += STEP(25) ;

220 
L_ªsu…
 +
	`STEP
(26) ; L_result += STEP(27) ;

221 
L_ªsu…
 +
	`STEP
(28) ; L_result += STEP(29) ;

222 
L_ªsu…
 +
	`STEP
(30) ; L_result += STEP(31) ;

223 
L_ªsu…
 +
	`STEP
(32) ; L_result += STEP(33) ;

224 
L_ªsu…
 +
	`STEP
(34) ; L_result += STEP(35) ;

225 
L_ªsu…
 +
	`STEP
(36) ; L_result += STEP(37) ;

226 
L_ªsu…
 +
	`STEP
(38) ; L_result += STEP(39) ;

228 i‡(
L_ªsu…
 > 
L_max
) {

230 
Nc
 = 
œmbda
;

231 
L_max
 = 
L_ªsu…
;

235 *
Nc_out
 = 
Nc
;

237 
L_max
 <<= 1;

241 
	`as£π
(
sˇl
 <= 100 && scal >= -100);

242 
L_max
 = L_max >> (6 - 
sˇl
);

244 
	`as£π
–
Nc
 <= 120 && Nc >= 40);

249 
L_powî
 = 0;

250 
k
 = 0; k <= 39; k++) {

252 
l⁄gw‹d
 
L_ãmp
;

254 
L_ãmp
 = 
	`SASR_W
–
dp
[
k
 - 
Nc
], 3 );

255 
L_powî
 +
L_ãmp
 * L_temp;

257 
L_powî
 <<= 1;

262 i‡(
L_max
 <= 0) {

263 *
bc_out
 = 0;

266 i‡(
L_max
 >
L_powî
) {

267 *
bc_out
 = 3;

271 
ãmp
 = 
	`gsm_n‹m
–
L_powî
 );

273 
R
 = 
	`SASR_L
–
L_max
 << 
ãmp
, 16 );

274 
S
 = 
	`SASR_L
–
L_powî
 << 
ãmp
, 16 );

282 
bc
 = 0; b¯<2; bc++Ëi‡(
R
 <
	`gsm_mu…
(
S
, 
gsm_DLB
[bc])) ;

283 *
bc_out
 = 
bc
;

284 
	}
}

288 #ifdef 
LTP_CUT


290 
	$Cut_CÆcuœti⁄_of_the_LTP_∑ømëîs
 (

291 
gsm_°©e
 * 
°
,

292 
w‹d
 * 
d
,

293 
w‹d
 * 
dp
,

294 
w‹d
 * 
bc_out
,

295 
w‹d
 * 
Nc_out


298 
k
, 
œmbda
;

299 
w‹d
 
Nc
, 
bc
;

300 
w‹d
 
…p_cut
;

302 
wt_Êﬂt
[40];

303 
dp_Êﬂt_ba£
[120], * 
dp_Êﬂt
 = dp_float_base + 120;

305 
l⁄gw‹d
 
L_max
, 
L_powî
;

306 
w‹d
 
R
, 
S
, 
dmax
, 
sˇl
;

307 
w‹d
 
ãmp
;

311 
dmax
 = 0;

313 
k
 = 0; k <= 39; k++) {

314 
ãmp
 = 
d
[
k
];

315 
ãmp
 = 
	`GSM_ABS
(Åemp );

316 i‡(
ãmp
 > 
dmax
) dmax =Åemp;

319 
ãmp
 = 0;

320 i‡(
dmax
 =0Ë
sˇl
 = 0;

322 
	`as£π
(
dmax
 > 0);

323 
ãmp
 = 
	`gsm_n‹m
–(
l⁄gw‹d
)
dmax
 << 16 );

326 i‡(
ãmp
 > 6Ë
sˇl
 = 0;

327 
sˇl
 = 6 - 
ãmp
;

329 
	`as£π
(
sˇl
 >= 0);

330 
…p_cut
 = (
l⁄gw‹d
)
	`SASR_W
(
dmax
, 
sˇl
Ë* 
°
->ltp_cut / 100;

336 
k
 = 0; k < 40; k++) {

337 
w‹d
 
w
 = 
	`SASR_W
–
d
[
k
], 
sˇl
 );

338 i‡(
w
 < 0 ? w > -
…p_cut
 : w <Ütp_cut) {

339 
wt_Êﬂt
[
k
] = 0.0;

342 
wt_Êﬂt
[
k
] = 
w
;

345 
k
 = -120; k < 0; k++Ë
dp_Êﬂt
[k] = 
dp
[k];

349 
L_max
 = 0;

350 
Nc
 = 40;

352 
œmbda
 = 40;Üambda <= 120;Üambda += 9) {

356 *
Õ
 = 
dp_Êﬂt
 - 
œmbda
;

358 
W
;

359 
a
 = 
Õ
[-8], 
b
 =Üp[-7], 
c
 =Üp[-6],

360 
d
 = 
Õ
[-5], 
e
 =Üp[-4], 
f
 =Üp[-3],

361 
g
 = 
Õ
[-2], 
h
 =Üp[-1];

362 
E
;

363 
S0
 = 0, 
S1
 = 0, 
S2
 = 0, 
S3
 = 0, 
S4
 = 0,

364 
S5
 = 0, 
S6
 = 0, 
S7
 = 0, 
S8
 = 0;

366 #unde‡
STEP


367 
	#STEP
(
K
, 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
) \

368 i‡((
W
 = 
wt_Êﬂt
[
K
]) != 0.0) { \

369 
E
 = 
W
 * 
a
; 
S8
 += E; \

370 
E
 = 
W
 * 
b
; 
S7
 += E; \

371 
E
 = 
W
 * 
c
; 
S6
 += E; \

372 
E
 = 
W
 * 
d
; 
S5
 += E; \

373 
E
 = 
W
 * 
e
; 
S4
 += E; \

374 
E
 = 
W
 * 
f
; 
S3
 += E; \

375 
E
 = 
W
 * 
g
; 
S2
 += E; \

376 
E
 = 
W
 * 
h
; 
S1
 += E; \

377 
a
 = 
Õ
[
K
]; \

378 
E
 = 
W
 * 
a
; 
S0
 +E; } ◊ = 
Õ
[
K
])

	)

380 
	#STEP_A
(
K
Ë
	`STEP
(K, 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
)

	)

381 
	#STEP_B
(
K
Ë
	`STEP
(K, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
, 
a
)

	)

382 
	#STEP_C
(
K
Ë
	`STEP
(K, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
, 
a
, 
b
)

	)

383 
	#STEP_D
(
K
Ë
	`STEP
(K, 
d
, 
e
, 
f
, 
g
, 
h
, 
a
, 
b
, 
c
)

	)

384 
	#STEP_E
(
K
Ë
	`STEP
(K, 
e
, 
f
, 
g
, 
h
, 
a
, 
b
, 
c
, 
d
)

	)

385 
	#STEP_F
(
K
Ë
	`STEP
(K, 
f
, 
g
, 
h
, 
a
, 
b
, 
c
, 
d
, 
e
)

	)

386 
	#STEP_G
(
K
Ë
	`STEP
(K, 
g
, 
h
, 
a
, 
b
, 
c
, 
d
, 
e
, 
f
)

	)

387 
	#STEP_H
(
K
Ë
	`STEP
(K, 
h
, 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
)

	)

389 
	`STEP_A
–0); 
	`STEP_B
–1); 
	`STEP_C
–2); 
	`STEP_D
( 3);

390 
	`STEP_E
–4); 
	`STEP_F
–5); 
	`STEP_G
–6); 
	`STEP_H
( 7);

392 
	`STEP_A
–8); 
	`STEP_B
–9); 
	`STEP_C
(10); 
	`STEP_D
(11);

393 
	`STEP_E
(12); 
	`STEP_F
(13); 
	`STEP_G
(14); 
	`STEP_H
(15);

395 
	`STEP_A
(16); 
	`STEP_B
(17); 
	`STEP_C
(18); 
	`STEP_D
(19);

396 
	`STEP_E
(20); 
	`STEP_F
(21); 
	`STEP_G
(22); 
	`STEP_H
(23);

398 
	`STEP_A
(24); 
	`STEP_B
(25); 
	`STEP_C
(26); 
	`STEP_D
(27);

399 
	`STEP_E
(28); 
	`STEP_F
(29); 
	`STEP_G
(30); 
	`STEP_H
(31);

401 
	`STEP_A
(32); 
	`STEP_B
(33); 
	`STEP_C
(34); 
	`STEP_D
(35);

402 
	`STEP_E
(36); 
	`STEP_F
(37); 
	`STEP_G
(38); 
	`STEP_H
(39);

404 i‡(
S0
 > 
L_max
Ë{ L_max = S0; 
Nc
 = 
œmbda
; }

405 i‡(
S1
 > 
L_max
Ë{ L_max = S1; 
Nc
 = 
œmbda
 + 1; }

406 i‡(
S2
 > 
L_max
Ë{ L_max = S2; 
Nc
 = 
œmbda
 + 2; }

407 i‡(
S3
 > 
L_max
Ë{ L_max = S3; 
Nc
 = 
œmbda
 + 3; }

408 i‡(
S4
 > 
L_max
Ë{ L_max = S4; 
Nc
 = 
œmbda
 + 4; }

409 i‡(
S5
 > 
L_max
Ë{ L_max = S5; 
Nc
 = 
œmbda
 + 5; }

410 i‡(
S6
 > 
L_max
Ë{ L_max = S6; 
Nc
 = 
œmbda
 + 6; }

411 i‡(
S7
 > 
L_max
Ë{ L_max = S7; 
Nc
 = 
œmbda
 + 7; }

412 i‡(
S8
 > 
L_max
Ë{ L_max = S8; 
Nc
 = 
œmbda
 + 8; }

415 *
Nc_out
 = 
Nc
;

417 
L_max
 <<= 1;

421 
	`as£π
(
sˇl
 <= 100 && scal >= -100);

422 
L_max
 = L_max >> (6 - 
sˇl
);

424 
	`as£π
–
Nc
 <= 120 && Nc >= 40);

429 
L_powî
 = 0;

430 
k
 = 0; k <= 39; k++) {

432 
l⁄gw‹d
 
L_ãmp
;

434 
L_ãmp
 = 
	`SASR_W
–
dp
[
k
 - 
Nc
], 3 );

435 
L_powî
 +
L_ãmp
 * L_temp;

437 
L_powî
 <<= 1;

442 i‡(
L_max
 <= 0) {

443 *
bc_out
 = 0;

446 i‡(
L_max
 >
L_powî
) {

447 *
bc_out
 = 3;

451 
ãmp
 = 
	`gsm_n‹m
–
L_powî
 );

453 
R
 = 
	`SASR
–
L_max
 << 
ãmp
, 16 );

454 
S
 = 
	`SASR
–
L_powî
 << 
ãmp
, 16 );

462 
bc
 = 0; b¯<2; bc++Ëi‡(
R
 <
	`gsm_mu…
(
S
, 
gsm_DLB
[bc])) ;

463 *
bc_out
 = 
bc
;

464 
	}
}

468 
	$CÆcuœti⁄_of_the_LTP_∑ømëîs
 (

469 
w‹d
 * 
dö
,

470 
w‹d
 * 
dp
,

471 
w‹d
 * 
bc_out
,

472 
w‹d
 * 
Nc_out


475 
k
, 
œmbda
;

476 
w‹d
 
Nc
, 
bc
;

478 
wt_Êﬂt
[40];

479 
dp_Êﬂt_ba£
[120], * 
dp_Êﬂt
 = dp_float_base + 120;

481 
l⁄gw‹d
 
L_max
, 
L_powî
;

482 
w‹d
 
R
, 
S
, 
dmax
, 
sˇl
;

483 
w‹d
 
ãmp
;

487 
dmax
 = 0;

489 
k
 = 0; k <= 39; k++) {

490 
ãmp
 = 
dö
 [
k
] ;

491 
ãmp
 = 
	`GSM_ABS
 (temp) ;

492 i‡(
ãmp
 > 
dmax
) dmax =Åemp;

495 
ãmp
 = 0;

496 i‡(
dmax
 =0Ë
sˇl
 = 0;

498 
	`as£π
(
dmax
 > 0);

499 
ãmp
 = 
	`gsm_n‹m
–(
l⁄gw‹d
)
dmax
 << 16 );

502 i‡(
ãmp
 > 6Ë
sˇl
 = 0;

503 
sˇl
 = 6 - 
ãmp
;

505 
	`as£π
(
sˇl
 >= 0);

510 
k
 = 0; k < 40; k++Ë
wt_Êﬂt
[k] = 
	`SASR_W
 (
dö
 [k], 
sˇl
) ;

511 
k
 = -120; k < 0; k++Ë
dp_Êﬂt
[k] = 
dp
[k];

515 
L_max
 = 0;

516 
Nc
 = 40;

518 
œmbda
 = 40;Üambda <= 120;Üambda += 9) {

522 *
Õ
 = 
dp_Êﬂt
 - 
œmbda
;

524 
W
;

525 
a
 = 
Õ
[-8], 
b
 =Üp[-7], 
c
 =Üp[-6],

526 
d
 = 
Õ
[-5], 
e
 =Üp[-4], 
f
 =Üp[-3],

527 
g
 = 
Õ
[-2], 
h
 =Üp[-1];

528 
E
;

529 
S0
 = 0, 
S1
 = 0, 
S2
 = 0, 
S3
 = 0, 
S4
 = 0,

530 
S5
 = 0, 
S6
 = 0, 
S7
 = 0, 
S8
 = 0;

532 #unde‡
STEP


533 
	#STEP
(
K
, 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
) \

534 
W
 = 
wt_Êﬂt
[
K
]; \

535 
E
 = 
W
 * 
a
; 
S8
 += E; \

536 
E
 = 
W
 * 
b
; 
S7
 += E; \

537 
E
 = 
W
 * 
c
; 
S6
 += E; \

538 
E
 = 
W
 * 
d
; 
S5
 += E; \

539 
E
 = 
W
 * 
e
; 
S4
 += E; \

540 
E
 = 
W
 * 
f
; 
S3
 += E; \

541 
E
 = 
W
 * 
g
; 
S2
 += E; \

542 
E
 = 
W
 * 
h
; 
S1
 += E; \

543 
a
 = 
Õ
[
K
]; \

544 
E
 = 
W
 * 
a
; 
S0
 +
	)
E

546 
	#STEP_A
(
K
Ë
	`STEP
(K, 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
)

	)

547 
	#STEP_B
(
K
Ë
	`STEP
(K, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
, 
a
)

	)

548 
	#STEP_C
(
K
Ë
	`STEP
(K, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
, 
a
, 
b
)

	)

549 
	#STEP_D
(
K
Ë
	`STEP
(K, 
d
, 
e
, 
f
, 
g
, 
h
, 
a
, 
b
, 
c
)

	)

550 
	#STEP_E
(
K
Ë
	`STEP
(K, 
e
, 
f
, 
g
, 
h
, 
a
, 
b
, 
c
, 
d
)

	)

551 
	#STEP_F
(
K
Ë
	`STEP
(K, 
f
, 
g
, 
h
, 
a
, 
b
, 
c
, 
d
, 
e
)

	)

552 
	#STEP_G
(
K
Ë
	`STEP
(K, 
g
, 
h
, 
a
, 
b
, 
c
, 
d
, 
e
, 
f
)

	)

553 
	#STEP_H
(
K
Ë
	`STEP
(K, 
h
, 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
)

	)

555 
	`STEP_A
–0); 
	`STEP_B
–1); 
	`STEP_C
–2); 
	`STEP_D
( 3);

556 
	`STEP_E
–4); 
	`STEP_F
–5); 
	`STEP_G
–6); 
	`STEP_H
( 7);

558 
	`STEP_A
–8); 
	`STEP_B
–9); 
	`STEP_C
(10); 
	`STEP_D
(11);

559 
	`STEP_E
(12); 
	`STEP_F
(13); 
	`STEP_G
(14); 
	`STEP_H
(15);

561 
	`STEP_A
(16); 
	`STEP_B
(17); 
	`STEP_C
(18); 
	`STEP_D
(19);

562 
	`STEP_E
(20); 
	`STEP_F
(21); 
	`STEP_G
(22); 
	`STEP_H
(23);

564 
	`STEP_A
(24); 
	`STEP_B
(25); 
	`STEP_C
(26); 
	`STEP_D
(27);

565 
	`STEP_E
(28); 
	`STEP_F
(29); 
	`STEP_G
(30); 
	`STEP_H
(31);

567 
	`STEP_A
(32); 
	`STEP_B
(33); 
	`STEP_C
(34); 
	`STEP_D
(35);

568 
	`STEP_E
(36); 
	`STEP_F
(37); 
	`STEP_G
(38); 
	`STEP_H
(39);

570 i‡(
S0
 > 
L_max
Ë{ L_max = S0; 
Nc
 = 
œmbda
; }

571 i‡(
S1
 > 
L_max
Ë{ L_max = S1; 
Nc
 = 
œmbda
 + 1; }

572 i‡(
S2
 > 
L_max
Ë{ L_max = S2; 
Nc
 = 
œmbda
 + 2; }

573 i‡(
S3
 > 
L_max
Ë{ L_max = S3; 
Nc
 = 
œmbda
 + 3; }

574 i‡(
S4
 > 
L_max
Ë{ L_max = S4; 
Nc
 = 
œmbda
 + 4; }

575 i‡(
S5
 > 
L_max
Ë{ L_max = S5; 
Nc
 = 
œmbda
 + 5; }

576 i‡(
S6
 > 
L_max
Ë{ L_max = S6; 
Nc
 = 
œmbda
 + 6; }

577 i‡(
S7
 > 
L_max
Ë{ L_max = S7; 
Nc
 = 
œmbda
 + 7; }

578 i‡(
S8
 > 
L_max
Ë{ L_max = S8; 
Nc
 = 
œmbda
 + 8; }

580 *
Nc_out
 = 
Nc
;

582 
L_max
 <<= 1;

586 
	`as£π
(
sˇl
 <= 100 && scal >= -100);

587 
L_max
 = L_max >> (6 - 
sˇl
);

589 
	`as£π
–
Nc
 <= 120 && Nc >= 40);

594 
L_powî
 = 0;

595 
k
 = 0; k <= 39; k++) {

597 
l⁄gw‹d
 
L_ãmp
;

599 
L_ãmp
 = 
	`SASR_W
–
dp
[
k
 - 
Nc
], 3 );

600 
L_powî
 +
L_ãmp
 * L_temp;

602 
L_powî
 <<= 1;

607 i‡(
L_max
 <= 0) {

608 *
bc_out
 = 0;

611 i‡(
L_max
 >
L_powî
) {

612 *
bc_out
 = 3;

616 
ãmp
 = 
	`gsm_n‹m
–
L_powî
 );

618 
R
 = 
	`SASR_L
 ( 
L_max
 << 
ãmp
, 16 );

619 
S
 = 
	`SASR_L
 ( 
L_powî
 << 
ãmp
, 16 );

627 
bc
 = 0; b¯<2; bc++Ëi‡(
R
 <
	`gsm_mu…
(
S
, 
gsm_DLB
[bc])) ;

628 *
bc_out
 = 
bc
;

629 
	}
}

631 #ifdef 
FAST


632 #ifdef 
LTP_CUT


634 
	$Cut_Fa°_CÆcuœti⁄_of_the_LTP_∑ømëîs
 (

635 
gsm_°©e
 * 
°
,

636 
w‹d
 * 
d
,

637 
w‹d
 * 
dp
,

638 
w‹d
 * 
bc_out
,

639 
w‹d
 * 
Nc_out


642 
k
, 
œmbda
;

643 
wt_Êﬂt
;

644 
w‹d
 
Nc
, 
bc
;

645 
w‹d
 
wt_max
, 
be°_k
, 
…p_cut
;

647 
dp_Êﬂt_ba£
[120], * 
dp_Êﬂt
 = dp_float_base + 120;

649 
L_ªsu…
, 
L_max
, 
L_powî
;

651 
wt_max
 = 0;

653 
k
 = 0; k < 40; ++k) {

654 i‡–
d
[
k
] > 
wt_max
Ëwt_max = d[
be°_k
 = k];

655 i‡(-
d
[
k
] > 
wt_max
Ëwt_max = -d[
be°_k
 = k];

658 
	`as£π
(
wt_max
 >= 0);

659 
wt_Êﬂt
 = ()
wt_max
;

661 
k
 = -120; k < 0; ++kË
dp_Êﬂt
[k] = ()
dp
[k];

665 
L_max
 = 0;

666 
Nc
 = 40;

668 
œmbda
 = 40;Üambda <= 120;Üambda++) {

669 
L_ªsu…
 = 
wt_Êﬂt
 * 
dp_Êﬂt
[
be°_k
 - 
œmbda
];

670 i‡(
L_ªsu…
 > 
L_max
) {

671 
Nc
 = 
œmbda
;

672 
L_max
 = 
L_ªsu…
;

676 *
Nc_out
 = 
Nc
;

677 i‡(
L_max
 <= 0.) {

678 *
bc_out
 = 0;

685 
dp_Êﬂt
 -
Nc
;

686 
L_powî
 = 0;

687 
k
 = 0; k < 40; ++k) {

688 
f
 = 
dp_Êﬂt
[
k
];

689 
L_powî
 +
f
 * f;

692 i‡(
L_max
 >
L_powî
) {

693 *
bc_out
 = 3;

701 
œmbda
 = 
L_max
 / 
L_powî
 * 32768.;

702 
bc
 = 0; b¯<2; ++bcËi‡(
œmbda
 <
gsm_DLB
[bc]) ;

703 *
bc_out
 = 
bc
;

704 
	}
}

708 
	$Fa°_CÆcuœti⁄_of_the_LTP_∑ømëîs
 (

709 
w‹d
 * 
dö
,

710 
w‹d
 * 
dp
,

711 
w‹d
 * 
bc_out
,

712 
w‹d
 * 
Nc_out


715 
k
, 
œmbda
;

716 
w‹d
 
Nc
, 
bc
;

718 
wt_Êﬂt
[40];

719 
dp_Êﬂt_ba£
[120], * 
dp_Êﬂt
 = dp_float_base + 120;

721 
L_max
, 
L_powî
;

723 
k
 = 0; k < 40; ++kË
wt_Êﬂt
[k] = (Ë
dö
 [k] ;

724 
k
 = -120; k < 0; ++kË
dp_Êﬂt
[k] = (Ë
dp
 [k] ;

728 
L_max
 = 0;

729 
Nc
 = 40;

731 
œmbda
 = 40;Üambda <= 120;Üambda += 9) {

735 *
Õ
 = 
dp_Êﬂt
 - 
œmbda
;

737 
W
;

738 
a
 = 
Õ
[-8], 
b
 =Üp[-7], 
c
 =Üp[-6],

739 
d
 = 
Õ
[-5], 
e
 =Üp[-4], 
f
 =Üp[-3],

740 
g
 = 
Õ
[-2], 
h
 =Üp[-1];

741 
E
;

742 
S0
 = 0, 
S1
 = 0, 
S2
 = 0, 
S3
 = 0, 
S4
 = 0,

743 
S5
 = 0, 
S6
 = 0, 
S7
 = 0, 
S8
 = 0;

745 #unde‡
STEP


746 
	#STEP
(
K
, 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
) \

747 
W
 = 
wt_Êﬂt
[
K
]; \

748 
E
 = 
W
 * 
a
; 
S8
 += E; \

749 
E
 = 
W
 * 
b
; 
S7
 += E; \

750 
E
 = 
W
 * 
c
; 
S6
 += E; \

751 
E
 = 
W
 * 
d
; 
S5
 += E; \

752 
E
 = 
W
 * 
e
; 
S4
 += E; \

753 
E
 = 
W
 * 
f
; 
S3
 += E; \

754 
E
 = 
W
 * 
g
; 
S2
 += E; \

755 
E
 = 
W
 * 
h
; 
S1
 += E; \

756 
a
 = 
Õ
[
K
]; \

757 
E
 = 
W
 * 
a
; 
S0
 +
	)
E

759 
	#STEP_A
(
K
Ë
	`STEP
(K, 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
)

	)

760 
	#STEP_B
(
K
Ë
	`STEP
(K, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
, 
a
)

	)

761 
	#STEP_C
(
K
Ë
	`STEP
(K, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
, 
a
, 
b
)

	)

762 
	#STEP_D
(
K
Ë
	`STEP
(K, 
d
, 
e
, 
f
, 
g
, 
h
, 
a
, 
b
, 
c
)

	)

763 
	#STEP_E
(
K
Ë
	`STEP
(K, 
e
, 
f
, 
g
, 
h
, 
a
, 
b
, 
c
, 
d
)

	)

764 
	#STEP_F
(
K
Ë
	`STEP
(K, 
f
, 
g
, 
h
, 
a
, 
b
, 
c
, 
d
, 
e
)

	)

765 
	#STEP_G
(
K
Ë
	`STEP
(K, 
g
, 
h
, 
a
, 
b
, 
c
, 
d
, 
e
, 
f
)

	)

766 
	#STEP_H
(
K
Ë
	`STEP
(K, 
h
, 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
)

	)

768 
	`STEP_A
–0); 
	`STEP_B
–1); 
	`STEP_C
–2); 
	`STEP_D
( 3);

769 
	`STEP_E
–4); 
	`STEP_F
–5); 
	`STEP_G
–6); 
	`STEP_H
( 7);

771 
	`STEP_A
–8); 
	`STEP_B
–9); 
	`STEP_C
(10); 
	`STEP_D
(11);

772 
	`STEP_E
(12); 
	`STEP_F
(13); 
	`STEP_G
(14); 
	`STEP_H
(15);

774 
	`STEP_A
(16); 
	`STEP_B
(17); 
	`STEP_C
(18); 
	`STEP_D
(19);

775 
	`STEP_E
(20); 
	`STEP_F
(21); 
	`STEP_G
(22); 
	`STEP_H
(23);

777 
	`STEP_A
(24); 
	`STEP_B
(25); 
	`STEP_C
(26); 
	`STEP_D
(27);

778 
	`STEP_E
(28); 
	`STEP_F
(29); 
	`STEP_G
(30); 
	`STEP_H
(31);

780 
	`STEP_A
(32); 
	`STEP_B
(33); 
	`STEP_C
(34); 
	`STEP_D
(35);

781 
	`STEP_E
(36); 
	`STEP_F
(37); 
	`STEP_G
(38); 
	`STEP_H
(39);

783 i‡(
S0
 > 
L_max
Ë{ L_max = S0; 
Nc
 = 
œmbda
; }

784 i‡(
S1
 > 
L_max
Ë{ L_max = S1; 
Nc
 = 
œmbda
 + 1; }

785 i‡(
S2
 > 
L_max
Ë{ L_max = S2; 
Nc
 = 
œmbda
 + 2; }

786 i‡(
S3
 > 
L_max
Ë{ L_max = S3; 
Nc
 = 
œmbda
 + 3; }

787 i‡(
S4
 > 
L_max
Ë{ L_max = S4; 
Nc
 = 
œmbda
 + 4; }

788 i‡(
S5
 > 
L_max
Ë{ L_max = S5; 
Nc
 = 
œmbda
 + 5; }

789 i‡(
S6
 > 
L_max
Ë{ L_max = S6; 
Nc
 = 
œmbda
 + 6; }

790 i‡(
S7
 > 
L_max
Ë{ L_max = S7; 
Nc
 = 
œmbda
 + 7; }

791 i‡(
S8
 > 
L_max
Ë{ L_max = S8; 
Nc
 = 
œmbda
 + 8; }

793 *
Nc_out
 = 
Nc
;

795 i‡(
L_max
 <= 0.) {

796 *
bc_out
 = 0;

803 
dp_Êﬂt
 -
Nc
;

804 
L_powî
 = 0;

805 
k
 = 0; k < 40; ++k) {

806 
f
 = 
dp_Êﬂt
[
k
];

807 
L_powî
 +
f
 * f;

810 i‡(
L_max
 >
L_powî
) {

811 *
bc_out
 = 3;

819 
œmbda
 = 
L_max
 / 
L_powî
 * 32768.;

820 
bc
 = 0; b¯<2; ++bcËi‡(
œmbda
 <
gsm_DLB
[bc]) ;

821 *
bc_out
 = 
bc
;

822 
	}
}

830 
	$L⁄g_ãrm_™Æysis_fûãrög
 (

831 
w‹d
 
bc
,

832 
w‹d
 
Nc
,

833 
w‹d
 * 
dp
,

834 
w‹d
 * 
d
,

835 
w‹d
 * 
dµ
,

836 
w‹d
 * 
e


845 
k
;

847 #unde‡
STEP


848 
	#STEP
(
BP
) \

849 
k
 = 0; k <= 39; k++) { \

850 
dµ
[
k
] = 
	`GSM_MULT_R
–
BP
, 
dp
[k - 
Nc
]); \

851 
e
[
k
] = 
	`GSM_SUB
–
d
[k], 
dµ
[k] ); \

852 }

	)

854 
bc
) {

855 0: 
	`STEP
( 3277 ); ;

856 1: 
	`STEP
( 11469 ); ;

857 2: 
	`STEP
( 21299 ); ;

858 3: 
	`STEP
( 32767 ); ;

860 
	}
}

862 
	$Gsm_L⁄g_Tîm_Pªdi˘‹
 (

864 
gsm_°©e
 * 
S
,

866 
w‹d
 * 
d
,

867 
w‹d
 * 
dp
,

869 
w‹d
 * 
e
,

870 
w‹d
 * 
dµ
,

871 
w‹d
 * 
Nc
,

872 
w‹d
 * 
bc


875 
	`as£π
–
d
 );ás£π–
dp
 );ás£π–
e
 );

876 
	`as£π
–
dµ
);ás£π–
Nc
 );ás£π–
bc
 );

878 #i‡
	`deföed
(
FAST
Ë&& deföed(
USE_FLOAT_MUL
)

879 i‡(
S
->
Á°
)

880 #i‡ 
	`deföed
 (
LTP_CUT
)

881 i‡(
S
->
…p_cut
)

882 
	`Cut_Fa°_CÆcuœti⁄_of_the_LTP_∑ømëîs
(
S
,

883 
d
, 
dp
, 
bc
, 
Nc
);

886 
	`Fa°_CÆcuœti⁄_of_the_LTP_∑ømëîs
(
d
, 
dp
, 
bc
, 
Nc
 );

889 #ifde‡
LTP_CUT


890 i‡(
S
->
…p_cut
)

891 
	`Cut_CÆcuœti⁄_of_the_LTP_∑ømëîs
(
S
, 
d
, 
dp
, 
bc
, 
Nc
);

894 
	`CÆcuœti⁄_of_the_LTP_∑ømëîs
(
d
, 
dp
, 
bc
, 
Nc
);

896 
	`L⁄g_ãrm_™Æysis_fûãrög
–*
bc
, *
Nc
, 
dp
, 
d
, 
dµ
, 
e
 );

897 
	}
}

900 
	$Gsm_L⁄g_Tîm_Sy¡hesis_Fûãrög
 (

901 
gsm_°©e
 * 
S
,

903 
w‹d
 
N¸
,

904 
w‹d
 
b¸
,

905 
w‹d
 * 
îp
,

906 
w‹d
 * 
dΩ


914 
k
;

915 
w‹d
 
bΩ
, 
dΩp
, 
Nr
;

919 
Nr
 = 
N¸
 < 40 || N¸ > 120 ? 
S
->
ƒp
 : Ncr;

920 
S
->
ƒp
 = 
Nr
;

921 
	`as£π
(
Nr
 >= 40 && Nr <= 120);

925 
bΩ
 = 
gsm_QLB
[ 
b¸
 ];

930 
	`as£π
(
bΩ
 !
MIN_WORD
);

932 
k
 = 0; k <= 39; k++) {

933 
dΩp
 = 
	`GSM_MULT_R
–
bΩ
, 
dΩ
[ 
k
 - 
Nr
 ] );

934 
dΩ
[
k
] = 
	`GSM_ADD
–
îp
[k], 
dΩp
 );

942 
k
 = 0; k <119; k++Ë
dΩ
[ -120 + k ] = drp[ -80 + k ];

943 
	}
}

	@libsndfile-1.0.17/src/GSM610/lpc.c

7 
	~<°dio.h
>

8 
	~<as£π.h
>

10 
	~"gsm610_¥iv.h
"

12 
	~"gsm.h
"

21 
	$Autoc‹ªœti⁄
 (

22 
w‹d
 * 
s
,

23 
l⁄gw‹d
 * 
L_ACF
)

29 
k
, 
i
;

31 
w‹d
 
ãmp
, 
smax
, 
sˇœuto
;

33 #ifdef 
USE_FLOAT_MUL


34 
Êﬂt_s
[160];

42 
smax
 = 0;

43 
k
 = 0; k <= 159; k++) {

44 
ãmp
 = 
	`GSM_ABS
–
s
[
k
] );

45 i‡(
ãmp
 > 
smax
) smax =Åemp;

50 i‡(
smax
 =0Ë
sˇœuto
 = 0;

52 
	`as£π
(
smax
 > 0);

53 
sˇœuto
 = 4 - 
	`gsm_n‹m
–(
l⁄gw‹d
)
smax
 << 16 );

59 i‡(
sˇœuto
 > 0) {

61 #ifde‡
USE_FLOAT_MUL


62 
	#SCALE
(
n
) \

63 
n
: 
k
 = 0; k <= 159; k++) \

64 
Êﬂt_s
[
k
] = () \

65 (
s
[
k
] = 
	`GSM_MULT_R
(s[k], 16384 >> (
n
-1)));\

66 ;

	)

68 
	#SCALE
(
n
) \

69 
n
: 
k
 = 0; k <= 159; k++) \

70 
s
[
k
] = 
	`GSM_MULT_R
–s[k], 16384 >> (
n
-1) );\

71 ;

	)

74 
sˇœuto
) {

75 
	`SCALE
(1)

76 
	`SCALE
(2)

77 
	`SCALE
(3)

78 
	`SCALE
(4)

80 #unde‡
SCALE


82 #ifdef 
USE_FLOAT_MUL


83 
k
 = 0; k <159; k++Ë
Êﬂt_s
[k] = (Ë
s
[k];

89 #ifdef 
USE_FLOAT_MUL


90 * 
•
 = 
Êﬂt_s
;

91 
¶
 = *
•
;

93 
	#STEP
(
k
Ë
L_ACF
[k] +(
l⁄gw‹d
)(
¶
 * 
•
[ -(kË]);

	)

95 
w‹d
 * 
•
 = 
s
;

96 
w‹d
 
¶
 = *
•
;

98 
	#STEP
(
k
Ë
L_ACF
[k] +((
l⁄gw‹d
)
¶
 * 
•
[ -(kË]);

	)

101 
	#NEXTI
 
¶
 = *++
•


	)

104 
k
 = 9; k--; 
L_ACF
[k] = 0) ;

106 
	`STEP
 (0);

107 
NEXTI
;

108 
	`STEP
(0); STEP(1);

109 
NEXTI
;

110 
	`STEP
(0); STEP(1); STEP(2);

111 
NEXTI
;

112 
	`STEP
(0); STEP(1); STEP(2); STEP(3);

113 
NEXTI
;

114 
	`STEP
(0); STEP(1); STEP(2); STEP(3); STEP(4);

115 
NEXTI
;

116 
	`STEP
(0); STEP(1); STEP(2); STEP(3); STEP(4); STEP(5);

117 
NEXTI
;

118 
	`STEP
(0); STEP(1); STEP(2); STEP(3); STEP(4); STEP(5); STEP(6);

119 
NEXTI
;

120 
	`STEP
(0); STEP(1); STEP(2); STEP(3); STEP(4); STEP(5); STEP(6); STEP(7);

122 
i
 = 8; i <= 159; i++) {

124 
NEXTI
;

126 
	`STEP
(0);

127 
	`STEP
(1); STEP(2); STEP(3); STEP(4);

128 
	`STEP
(5); STEP(6); STEP(7); STEP(8);

131 
k
 = 9; k--; 
L_ACF
[k] <<= 1) ;

136 i‡(
sˇœuto
 > 0) {

137 
	`as£π
(
sˇœuto
 <= 4);

138 
k
 = 160; k--; *
s
++ <<
sˇœuto
) ;

140 
	}
}

142 #i‡
deföed
(
USE_FLOAT_MUL
Ë&& deföed(
FAST
)

144 
	$Fa°_Autoc‹ªœti⁄
 (

145 
w‹d
 * 
s
,

146 
l⁄gw‹d
 * 
L_ACF
)

148 
k
, 
i
;

149 
f_L_ACF
[9];

150 
sˇÀ
;

152 
s_f
[160];

153 *
sf
 = 
s_f
;

155 
i
 = 0; i < 160; ++iË
sf
[i] = 
s
[i];

156 
k
 = 0; k <= 8; k++) {

157 
L_ãmp2
 = 0;

158 *
sÊ
 = 
sf
 - 
k
;

159 
i
 = 
k
; i < 160; ++iË
L_ãmp2
 +
sf
[i] * 
sÊ
[i];

160 
f_L_ACF
[
k
] = 
L_ãmp2
;

162 
sˇÀ
 = 
MAX_LONGWORD
 / 
f_L_ACF
[0];

164 
k
 = 0; k <= 8; k++) {

165 
L_ACF
[
k
] = 
f_L_ACF
[k] * 
sˇÀ
;

167 
	}
}

172 
	$ReÊe˘i⁄_c€fficõ¡s
 (

173 
l⁄gw‹d
 * 
L_ACF
,

174 
w‹d
 * 
r


177 
i
, 
m
, 
n
;

178 
w‹d
 
ãmp
;

179 
w‹d
 
ACF
[9];

180 
w‹d
 
P
[ 9];

181 
w‹d
 
K
[ 9];

186 i‡(
L_ACF
[0] == 0) {

187 
i
 = 8; i--; *
r
++ = 0) ;

191 
	`as£π
–
L_ACF
[0] != 0 );

192 
ãmp
 = 
	`gsm_n‹m
–
L_ACF
[0] );

194 
	`as£π
(
ãmp
 >= 0 &&Åemp < 32);

197 
i
 = 0; i <8; i++Ë
ACF
[i] = 
	`SASR_L
–
L_ACF
[i] << 
ãmp
, 16 );

202 
i
 = 1; i <7; i++Ë
K
[ i ] = 
ACF
[ i ];

203 
i
 = 0; i <8; i++Ë
P
[ i ] = 
ACF
[ i ];

207 
n
 = 1;Ç <8;Ç++, 
r
++) {

209 
ãmp
 = 
P
[1];

210 
ãmp
 = 
	`GSM_ABS
(temp);

211 i‡(
P
[0] < 
ãmp
) {

212 
i
 = 
n
; i <8; i++Ë*
r
++ = 0;

216 *
r
 = 
	`gsm_div
–
ãmp
, 
P
[0] );

218 
	`as£π
(*
r
 >= 0);

219 i‡(
P
[1] > 0Ë*
r
 = -*r;

220 
	`as£π
 (*
r
 !
MIN_WORD
);

221 i‡(
n
 == 8) ;

225 
ãmp
 = 
	`GSM_MULT_R
–
P
[1], *
r
 );

226 
P
[0] = 
	`GSM_ADD
–P[0], 
ãmp
 );

228 
m
 = 1; m <8 - 
n
; m++) {

229 
ãmp
 = 
	`GSM_MULT_R
–
K
[ 
m
 ], *
r
 );

230 
P
[
m
] = 
	`GSM_ADD
–P[ m+1 ], 
ãmp
 );

232 
ãmp
 = 
	`GSM_MULT_R
–
P
[ 
m
+1 ], *
r
 );

233 
K
[
m
] = 
	`GSM_ADD
–K[ m ], 
ãmp
 );

236 
	}
}

240 
	$Tønsf‹m©i⁄_to_Log_Aªa_R©ios
 (

241 
w‹d
 * 
r


251 
w‹d
 
ãmp
;

252 
i
;

257 
i
 = 1; i <8; i++, 
r
++) {

259 
ãmp
 = *
r
;

260 
ãmp
 = 
	`GSM_ABS
(temp);

261 
	`as£π
(
ãmp
 >= 0);

263 i‡(
ãmp
 < 22118) {

264 
ãmp
 >>= 1;

265 } i‡(
ãmp
 < 31130) {

266 
	`as£π
–
ãmp
 >= 11059 );

267 
ãmp
 -= 11059;

269 
	`as£π
–
ãmp
 >= 26112 );

270 
ãmp
 -= 26112;

271 
ãmp
 <<= 2;

274 *
r
 = *∏< 0 ? -
ãmp
 :Åemp;

275 
	`as£π
–*
r
 !
MIN_WORD
 );

277 
	}
}

281 
	$Qu™tiz©i⁄_™d_codög
 (

282 
w‹d
 * 
LAR


285 
w‹d
 
ãmp
;

296 #unde‡
STEP


297 
	#STEP
–
A
, 
B
, 
MAC
, 
MIC
 ) \

298 
ãmp
 = 
	`GSM_MULT
–
A
, *
LAR
 ); \

299 
ãmp
 = 
	`GSM_ADD
–ãmp, 
B
 ); \

300 
ãmp
 = 
	`GSM_ADD
(Åemp, 256 ); \

301 
ãmp
 = 
	`SASR_W
(Åemp, 9 ); \

302 *
LAR
 = 
ãmp
>
MAC
 ? MAC - 
MIC
 : (temp<MIC ? 0 :Åemp - MIC); \

303 
LAR
++;

	)

305 
	`STEP
( 20480, 0, 31, -32 );

306 
	`STEP
( 20480, 0, 31, -32 );

307 
	`STEP
( 20480, 2048, 15, -16 );

308 
	`STEP
( 20480, -2560, 15, -16 );

310 
	`STEP
( 13964, 94, 7, -8 );

311 
	`STEP
( 15360, -1792, 7, -8 );

312 
	`STEP
( 8534, -341, 3, -4 );

313 
	`STEP
( 9036, -1144, 3, -4 );

315 #unde‡
STEP


316 
	}
}

318 
	$Gsm_LPC_A«lysis
 (

319 
gsm_°©e
 *
S
,

320 
w‹d
 * 
s
,

321 
w‹d
 * 
LARc
)

323 
l⁄gw‹d
 
L_ACF
[9];

325 #i‡
	`deföed
(
USE_FLOAT_MUL
Ë&& deföed(
FAST
)

326 i‡(
S
->
Á°
Ë
	`Fa°_Autoc‹ªœti⁄
 (
s
, 
L_ACF
 );

329 
	`Autoc‹ªœti⁄
 (
s
, 
L_ACF
 );

330 
	`ReÊe˘i⁄_c€fficõ¡s
 (
L_ACF
, 
LARc
 );

331 
	`Tønsf‹m©i⁄_to_Log_Aªa_R©ios
 (
LARc
);

332 
	`Qu™tiz©i⁄_™d_codög
 (
LARc
);

333 
	}
}

	@libsndfile-1.0.17/src/GSM610/preprocess.c

7 
	~<°dio.h
>

8 
	~<as£π.h
>

10 
	~"gsm610_¥iv.h
"

12 
	~"gsm.h
"

31 
	$Gsm_Pª¥o˚ss
 (

32 
gsm_°©e
 * 
S
,

33 
w‹d
 * 
s
,

34 
w‹d
 * 
so
 )

37 
w‹d
 
z1
 = 
S
->z1;

38 
l⁄gw‹d
 
L_z2
 = 
S
->L_z2;

39 
w‹d
 
mp
 = 
S
->mp;

41 
w‹d
 
s1
;

42 
l⁄gw‹d
 
L_s2
;

44 
l⁄gw‹d
 
L_ãmp
;

46 
w‹d
 
m•
, 
l•
;

47 
w‹d
 
SO
;

49 
k
 = 160;

51 
k
--) {

55 
SO
 = 
	`SASR_W
–*
s
, 3 ) << 2;

56 
s
++;

58 
	`as£π
 (
SO
 >= -0x4000);

59 
	`as£π
 (
SO
 <= 0x3FFC);

72 
s1
 = 
SO
 - 
z1
;

73 
z1
 = 
SO
;

75 
	`as£π
(
s1
 !
MIN_WORD
);

79 
L_s2
 = 
s1
;

80 
L_s2
 <<= 15;

85 
m•
 = 
	`SASR_L
–
L_z2
, 15 );

86 
l•
 = 
L_z2
-((
l⁄gw‹d
)
m•
<<15);

88 
L_s2
 +
	`GSM_MULT_R
–
l•
, 32735 );

89 
L_ãmp
 = (
l⁄gw‹d
)
m•
 * 32735;

90 
L_z2
 = 
	`GSM_L_ADD
–
L_ãmp
, 
L_s2
 );

94 
L_ãmp
 = 
	`GSM_L_ADD
–
L_z2
, 16384 );

99 
m•
 = 
	`GSM_MULT_R
–
mp
, -28180 );

100 
mp
 = 
	`SASR_L
–
L_ãmp
, 15 );

101 *
so
++ = 
	`GSM_ADD
–
mp
, 
m•
 );

104 
S
->
z1
 = z1;

105 
S
->
L_z2
 = L_z2;

106 
S
->
mp
 = mp;

107 
	}
}

	@libsndfile-1.0.17/src/GSM610/rpe.c

7 
	~<°dio.h
>

8 
	~<as£π.h
>

10 
	~"gsm610_¥iv.h
"

12 
	~"gsm.h
"

19 
	$Weightög_fûãr
 (

20 
w‹d
 * 
e
,

21 
w‹d
 * 
x


32 
l⁄gw‹d
 
L_ªsu…
;

33 
k
 ;

45 
e
 -= 5;

49 
k
 = 0; k <= 39; k++) {

51 
L_ªsu…
 = 8192 >> 1;

59 #unde‡
STEP


60 
	#STEP
–
i
, 
H
 ) (
e
[ 
k
 + i ] * (
l⁄gw‹d
)H)

	)

67 #ifdef 
STUPID_COMPILER


68 
L_ªsu…
 +
	`STEP
( 0, -134 ) ;

69 
L_ªsu…
 +
	`STEP
( 1, -374 ) ;

71 
L_ªsu…
 +
	`STEP
( 3, 2054 ) ;

72 
L_ªsu…
 +
	`STEP
( 4, 5741 ) ;

73 
L_ªsu…
 +
	`STEP
( 5, 8192 ) ;

74 
L_ªsu…
 +
	`STEP
( 6, 5741 ) ;

75 
L_ªsu…
 +
	`STEP
( 7, 2054 ) ;

77 
L_ªsu…
 +
	`STEP
( 9, -374 ) ;

78 
L_ªsu…
 +
	`STEP
( 10, -134 ) ;

80 
L_ªsu…
 +=

81 
	`STEP
( 0, -134 )

82 + 
	`STEP
( 1, -374 )

84 + 
	`STEP
( 3, 2054 )

85 + 
	`STEP
( 4, 5741 )

86 + 
	`STEP
( 5, 8192 )

87 + 
	`STEP
( 6, 5741 )

88 + 
	`STEP
( 7, 2054 )

90 + 
	`STEP
( 9, -374 )

91 + 
	`STEP
(10, -134 )

105 
L_ªsu…
 = 
	`SASR_L
( L_result, 13 );

106 
x
[
k
] = ( 
L_ªsu…
 < 
MIN_WORD
 ? MIN_WORD

107 : (
L_ªsu…
 > 
MAX_WORD
 ? MAX_WORD : L_result ));

109 
	}
}

113 
	$RPE_grid_£À˘i⁄
 (

114 
w‹d
 * 
x
,

115 
w‹d
 * 
xM
,

116 
w‹d
 * 
Mc_out


124 
i
;

125 
l⁄gw‹d
 
L_ªsu…
, 
L_ãmp
;

126 
l⁄gw‹d
 
EM
;

127 
w‹d
 
Mc
;

129 
l⁄gw‹d
 
L_comm⁄_0_3
;

131 
EM
 = 0;

132 
Mc
 = 0;

155 #unde‡
STEP


156 
	#STEP
–
m
, 
i
 ) 
L_ãmp
 = 
	`SASR_W
–
x
[m + 3 * i], 2 ); \

157 
L_ªsu…
 +
L_ãmp
 * L_ãmp;

	)

161 
L_ªsu…
 = 0;

162 
	`STEP
( 0, 1 ); STEP( 0, 2 ); STEP( 0, 3 ); STEP( 0, 4 );

163 
	`STEP
( 0, 5 ); STEP( 0, 6 ); STEP( 0, 7 ); STEP( 0, 8 );

164 
	`STEP
( 0, 9 ); STEP( 0, 10); STEP( 0, 11); STEP( 0, 12);

165 
L_comm⁄_0_3
 = 
L_ªsu…
;

169 
	`STEP
( 0, 0 );

170 
L_ªsu…
 <<= 1;

171 
EM
 = 
L_ªsu…
;

175 
L_ªsu…
 = 0;

176 
	`STEP
( 1, 0 );

177 
	`STEP
( 1, 1 ); STEP( 1, 2 ); STEP( 1, 3 ); STEP( 1, 4 );

178 
	`STEP
( 1, 5 ); STEP( 1, 6 ); STEP( 1, 7 ); STEP( 1, 8 );

179 
	`STEP
( 1, 9 ); STEP( 1, 10); STEP( 1, 11); STEP( 1, 12);

180 
L_ªsu…
 <<= 1;

181 i‡(
L_ªsu…
 > 
EM
) {

182 
Mc
 = 1;

183 
EM
 = 
L_ªsu…
;

188 
L_ªsu…
 = 0;

189 
	`STEP
( 2, 0 );

190 
	`STEP
( 2, 1 ); STEP( 2, 2 ); STEP( 2, 3 ); STEP( 2, 4 );

191 
	`STEP
( 2, 5 ); STEP( 2, 6 ); STEP( 2, 7 ); STEP( 2, 8 );

192 
	`STEP
( 2, 9 ); STEP( 2, 10); STEP( 2, 11); STEP( 2, 12);

193 
L_ªsu…
 <<= 1;

194 i‡(
L_ªsu…
 > 
EM
) {

195 
Mc
 = 2;

196 
EM
 = 
L_ªsu…
;

201 
L_ªsu…
 = 
L_comm⁄_0_3
;

202 
	`STEP
( 3, 12 );

203 
L_ªsu…
 <<= 1;

204 i‡(
L_ªsu…
 > 
EM
) {

205 
Mc
 = 3;

206 
EM
 = 
L_ªsu…
;

214 
i
 = 0; i <12; i ++Ë
xM
[i] = 
x
[
Mc
 + 3*i];

215 *
Mc_out
 = 
Mc
;

216 
	}
}

220 
	$APCM_qu™tiz©i⁄_xmaxc_to_exp_m™t
 (

221 
w‹d
 
xmaxc
,

222 
w‹d
 * 
exp⁄_out
,

223 
w‹d
 * 
m™t_out
 )

225 
w‹d
 
exp⁄
, 
m™t
;

230 
exp⁄
 = 0;

231 i‡(
xmaxc
 > 15Ë
exp⁄
 = 
	`SASR_W
(xmaxc, 3) - 1;

232 
m™t
 = 
xmaxc
 - (
exp⁄
 << 3);

234 i‡(
m™t
 == 0) {

235 
exp⁄
 = -4;

236 
m™t
 = 7;

239 
m™t
 <= 7) {

240 
m™t
 = mant << 1 | 1;

241 
exp⁄
--;

243 
m™t
 -= 8;

246 
	`as£π
–
exp⁄
 >= -4 &&Éxpon <= 6 );

247 
	`as£π
–
m™t
 >= 0 && mant <= 7 );

249 *
exp⁄_out
 = 
exp⁄
;

250 *
m™t_out
 = 
m™t
;

251 
	}
}

253 
	$APCM_qu™tiz©i⁄
 (

254 
w‹d
 * 
xM
,

255 
w‹d
 * 
xMc
,

256 
w‹d
 * 
m™t_out
,

257 
w‹d
 * 
exp⁄_out
,

258 
w‹d
 * 
xmaxc_out


261 
i
, 
ôe°
;

263 
w‹d
 
xmax
, 
xmaxc
, 
ãmp
, 
ãmp1
, 
ãmp2
;

264 
w‹d
 
exp⁄
, 
m™t
;

270 
xmax
 = 0;

271 
i
 = 0; i <= 12; i++) {

272 
ãmp
 = 
xM
[
i
];

273 
ãmp
 = 
	`GSM_ABS
(temp);

274 i‡(
ãmp
 > 
xmax
) xmax =Åemp;

280 
exp⁄
 = 0;

281 
ãmp
 = 
	`SASR_W
–
xmax
, 9 );

282 
ôe°
 = 0;

284 
i
 = 0; i <= 5; i++) {

286 
ôe°
 |(
ãmp
 <= 0);

287 
ãmp
 = 
	`SASR_W
(Åemp, 1 );

289 
	`as£π
(
exp⁄
 <= 5);

290 i‡(
ôe°
 =0Ë
exp⁄
++;

293 
	`as£π
(
exp⁄
 <= 6 &&Éxpon >= 0);

294 
ãmp
 = 
exp⁄
 + 5;

296 
	`as£π
(
ãmp
 <= 11 &&Åemp >= 0);

297 
xmaxc
 = 
	`gsm_add
–
	`SASR_W
(
xmax
, 
ãmp
), (
w‹d
Ë(
exp⁄
 << 3) );

303 
	`APCM_qu™tiz©i⁄_xmaxc_to_exp_m™t
–
xmaxc
, &
exp⁄
, &
m™t
 );

319 
	`as£π
–
exp⁄
 <= 4096 &&Éxpon >= -4096);

320 
	`as£π
–
m™t
 >= 0 && mant <= 7 );

322 
ãmp1
 = 6 - 
exp⁄
;

323 
ãmp2
 = 
gsm_NRFAC
[ 
m™t
 ];

325 
i
 = 0; i <= 12; i++) {

327 
	`as£π
(
ãmp1
 >= 0 &&Åemp1 < 16);

329 
ãmp
 = 
xM
[
i
] << 
ãmp1
;

330 
ãmp
 = 
	`GSM_MULT
–ãmp, 
ãmp2
 );

331 
ãmp
 = 
	`SASR_W
(temp, 12);

332 
xMc
[
i
] = 
ãmp
 + 4;

338 *
m™t_out
 = 
m™t
;

339 *
exp⁄_out
 = 
exp⁄
;

340 *
xmaxc_out
 = 
xmaxc
;

341 
	}
}

345 
	$APCM_övî£_qu™tiz©i⁄
 (

346 
w‹d
 * 
xMc
,

347 
w‹d
 
m™t
,

348 
w‹d
 
exp⁄
,

349 
w‹d
 * 
xMp
)

356 
i
;

357 
w‹d
 
ãmp
, 
ãmp1
, 
ãmp2
, 
ãmp3
;

359 
	`as£π
–
m™t
 >= 0 && mant <= 7 );

361 
ãmp1
 = 
gsm_FAC
[ 
m™t
 ];

362 
ãmp2
 = 
	`gsm_sub
–6, 
exp⁄
 );

363 
ãmp3
 = 
	`gsm_a¶
–1, 
	`gsm_sub
–
ãmp2
, 1 ));

365 
i
 = 13; i--;) {

367 
	`as£π
–*
xMc
 <= 7 && *xMc >= 0 );

370 
ãmp
 = (*
xMc
++ << 1) - 7;

371 
	`as£π
–
ãmp
 <= 7 &&Åemp >= -7 );

373 
ãmp
 <<= 12;

374 
ãmp
 = 
	`GSM_MULT_R
–
ãmp1
,Åemp );

375 
ãmp
 = 
	`GSM_ADD
–ãmp, 
ãmp3
 );

376 *
xMp
++ = 
	`gsm_a§
–
ãmp
, 
ãmp2
 );

378 
	}
}

382 
	$RPE_grid_posôi⁄ög
 (

383 
w‹d
 
Mc
,

384 
w‹d
 * 
xMp
,

385 
w‹d
 * 
ï


395 
i
 = 13;

397 
	`as£π
(0 <
Mc
 && Mc <= 3);

399 
Mc
) {

400 3: *
ï
++ = 0;

402 *
ï
++ = 0;

403 1: *
ï
++ = 0;

404 0: *
ï
++ = *
xMp
++;

405 } --
i
);

407 ++
Mc
 < 4Ë*
ï
++ = 0;

417 
	}
}

429 
	$Gsm_Upd©e_of_ªc⁄°ru˘ed_sh‹t_time_ªsiduÆ_sig«l
 (

430 
w‹d
 * 
dµ
,

431 
w‹d
 * 
ï
,

432 
w‹d
 * 
dp
)

434 
k
;

436 
k
 = 0; k <= 79; k++)

437 
dp
[ -120 + 
k
 ] = dp[ -80 + k ];

439 
k
 = 0; k <= 39; k++)

440 
dp
[ -40 + 
k
 ] = 
	`gsm_add
–
ï
[k], 
dµ
[k] );

441 
	}
}

444 
	$Gsm_RPE_Encodög
 (

447 
w‹d
 * 
e
,

448 
w‹d
 * 
xmaxc
,

449 
w‹d
 * 
Mc
,

450 
w‹d
 * 
xMc
)

452 
w‹d
 
x
[40];

453 
w‹d
 
xM
[13], 
xMp
[13];

454 
w‹d
 
m™t
, 
exp⁄
;

456 
	`Weightög_fûãr
(
e
, 
x
);

457 
	`RPE_grid_£À˘i⁄
(
x
, 
xM
, 
Mc
);

459 
	`APCM_qu™tiz©i⁄
–
xM
, 
xMc
, &
m™t
, &
exp⁄
, 
xmaxc
);

460 
	`APCM_övî£_qu™tiz©i⁄
–
xMc
, 
m™t
, 
exp⁄
, 
xMp
);

462 
	`RPE_grid_posôi⁄ög
–*
Mc
, 
xMp
, 
e
 );

464 
	}
}

466 
	$Gsm_RPE_Decodög
 (

469 
w‹d
 
xmax¸
,

470 
w‹d
 
M¸
,

471 
w‹d
 * 
xM¸
,

472 
w‹d
 * 
îp


475 
w‹d
 
exp⁄
, 
m™t
;

476 
w‹d
 
xMp
[ 13 ];

478 
	`APCM_qu™tiz©i⁄_xmaxc_to_exp_m™t
–
xmax¸
, &
exp⁄
, &
m™t
 );

479 
	`APCM_övî£_qu™tiz©i⁄
–
xM¸
, 
m™t
, 
exp⁄
, 
xMp
 );

480 
	`RPE_grid_posôi⁄ög
–
M¸
, 
xMp
, 
îp
 );

482 
	}
}

	@libsndfile-1.0.17/src/GSM610/short_term.c

7 
	~<°dio.h
>

8 
	~<as£π.h
>

10 
	~"gsm610_¥iv.h
"

12 
	~"gsm.h
"

20 
	$Decodög_of_the_coded_Log_Aªa_R©ios
 (

21 
w‹d
 * 
LARc
,

22 
w‹d
 * 
LARµ
)

24 
w‹d
 
ãmp1
 ;

49 #unde‡
STEP


50 
	#STEP
–
B
, 
MIC
, 
INVA
 ) \

51 
ãmp1
 = 
	`GSM_ADD
–*
LARc
++, 
MIC
 ) << 10; \

52 
ãmp1
 = 
	`GSM_SUB
–ãmp1, 
B
 << 1 ); \

53 
ãmp1
 = 
	`GSM_MULT_R
–
INVA
,Åemp1 ); \

54 *
LARµ
++ = 
	`GSM_ADD
–
ãmp1
,Åemp1 );

	)

56 
	`STEP
( 0, -32, 13107 );

57 
	`STEP
( 0, -32, 13107 );

58 
	`STEP
( 2048, -16, 13107 );

59 
	`STEP
( -2560, -16, 13107 );

61 
	`STEP
( 94, -8, 19223 );

62 
	`STEP
( -1792, -8, 17476 );

63 
	`STEP
( -341, -4, 31454 );

64 
	`STEP
( -1144, -4, 29708 );

69 
	}
}

87 
	$C€fficõ¡s_0_12
 (

88 
w‹d
 * 
LARµ_j_1
,

89 
w‹d
 * 
LARµ_j
,

90 
w‹d
 * 
LARp
)

92 
i
;

94 
i
 = 1; i <8; i++, 
LARp
++, 
LARµ_j_1
++, 
LARµ_j
++) {

95 *
LARp
 = 
	`GSM_ADD
–
	`SASR_W
–*
LARµ_j_1
, 2 ), SASR_W–*
LARµ_j
, 2 ));

96 *
LARp
 = 
	`GSM_ADD
–*LARp, 
	`SASR_W
–*
LARµ_j_1
, 1));

98 
	}
}

100 
	$C€fficõ¡s_13_26
 (

101 
w‹d
 * 
LARµ_j_1
,

102 
w‹d
 * 
LARµ_j
,

103 
w‹d
 * 
LARp
)

105 
i
;

106 
i
 = 1; i <8; i++, 
LARµ_j_1
++, 
LARµ_j
++, 
LARp
++) {

107 *
LARp
 = 
	`GSM_ADD
–
	`SASR_W
–*
LARµ_j_1
, 1), SASR_W–*
LARµ_j
, 1 ));

109 
	}
}

111 
	$C€fficõ¡s_27_39
 (

112 
w‹d
 * 
LARµ_j_1
,

113 
w‹d
 * 
LARµ_j
,

114 
w‹d
 * 
LARp
)

116 
i
;

118 
i
 = 1; i <8; i++, 
LARµ_j_1
++, 
LARµ_j
++, 
LARp
++) {

119 *
LARp
 = 
	`GSM_ADD
–
	`SASR_W
–*
LARµ_j_1
, 2 ), SASR_W–*
LARµ_j
, 2 ));

120 *
LARp
 = 
	`GSM_ADD
–*LARp, 
	`SASR_W
–*
LARµ_j
, 1 ));

122 
	}
}

125 
	$C€fficõ¡s_40_159
 (

126 
w‹d
 * 
LARµ_j
,

127 
w‹d
 * 
LARp
)

129 
i
;

131 
i
 = 1; i <8; i++, 
LARp
++, 
LARµ_j
++)

132 *
LARp
 = *
LARµ_j
;

133 
	}
}

137 
	$LARp_to_Ω
 (

138 
w‹d
 * 
LARp
)

145 
i
;

146 
w‹d
 
ãmp
;

148 
i
 = 1; i <8; i++, 
LARp
++) {

159 i‡(*
LARp
 < 0) {

160 
ãmp
 = *
LARp
 =
MIN_WORD
 ? 
MAX_WORD
 : -(*LARp);

161 *
LARp
 = - ((
ãmp
 < 11059) ?Åemp << 1

162 : ((
ãmp
 < 20070) ?Åemp + 11059

163 : 
	`GSM_ADD
–(
w‹d
Ë(
ãmp
 >> 2), (word) 26112 )));

165 
ãmp
 = *
LARp
;

166 *
LARp
 = (
ãmp
 < 11059) ?Åemp << 1

167 : ((
ãmp
 < 20070) ?Åemp + 11059

168 : 
	`GSM_ADD
–(
w‹d
Ë(
ãmp
 >> 2), (word) 26112 ));

171 
	}
}

175 
	$Sh‹t_ãrm_™Æysis_fûãrög
 (

176 
gsm_°©e
 * 
S
,

177 
w‹d
 * 
Ω
,

178 
k_n
,

179 
w‹d
 * 
s


192 
w‹d
 * 
u
 = 
S
->u;

193 
i
;

194 
w‹d
 
di
, 
zzz
, 
ui
, 
ßv
, 
Ωi
;

196 ; 
k_n
--; 
s
++) {

198 
di
 = 
ßv
 = *
s
;

200 
i
 = 0; i < 8; i++) {

202 
ui
 = 
u
[
i
];

203 
Ωi
 = 
Ω
[
i
];

204 
u
[
i
] = 
ßv
;

206 
zzz
 = 
	`GSM_MULT_R
(
Ωi
, 
di
);

207 
ßv
 = 
	`GSM_ADD
–
ui
, 
zzz
);

209 
zzz
 = 
	`GSM_MULT_R
(
Ωi
, 
ui
);

210 
di
 = 
	`GSM_ADD
–di, 
zzz
 );

213 *
s
 = 
di
;

215 
	}
}

217 #i‡
deföed
(
USE_FLOAT_MUL
Ë&& deföed(
FAST
)

219 
	$Fa°_Sh‹t_ãrm_™Æysis_fûãrög
 (

220 
gsm_°©e
 * 
S
,

221 
w‹d
 * 
Ω
,

222 
k_n
,

223 
w‹d
 * 
s


226 
w‹d
 * 
u
 = 
S
->u;

227 
i
;

229 
uf
[8],

230 
Ωf
[8];

232 
sˇÀf
 = 3.0517578125e-5;

233 
ßv
, 
di
, 
ãmp
;

235 
i
 = 0; i < 8; ++i) {

236 
uf
[
i
] = 
u
[i];

237 
Ωf
[
i
] = 
Ω
[i] * 
sˇÀf
;

239 ; 
k_n
--; 
s
++) {

240 
ßv
 = 
di
 = *
s
;

241 
i
 = 0; i < 8; ++i) {

242 
Ωfi
 = 
Ωf
[
i
];

243 
ufi
 = 
uf
[
i
];

245 
uf
[
i
] = 
ßv
;

246 
ãmp
 = 
Ωfi
 * 
di
 + 
ufi
;

247 
di
 +
Ωfi
 * 
ufi
;

248 
ßv
 = 
ãmp
;

250 *
s
 = 
di
;

252 
i
 = 0; i < 8; ++iË
u
[i] = 
uf
[i];

253 
	}
}

256 
	$Sh‹t_ãrm_sy¡hesis_fûãrög
 (

257 
gsm_°©e
 * 
S
,

258 
w‹d
 * 
ºp
,

259 
k
,

260 
w‹d
 * 
wt
,

261 
w‹d
 * 
§


264 
w‹d
 * 
v
 = 
S
->v;

265 
i
;

266 
w‹d
 
§i
, 
tmp1
, 
tmp2
;

268 
k
--) {

269 
§i
 = *
wt
++;

270 
i
 = 8; i--;) {

274 
tmp1
 = 
ºp
[
i
];

275 
tmp2
 = 
v
[
i
];

276 
tmp2
 = ( 
tmp1
 =
MIN_WORD
 &&Åmp2 == MIN_WORD

277 ? 
MAX_WORD


278 : 0x0FFFF & (–(
l⁄gw‹d
)
tmp1
 * (l⁄gw‹d)
tmp2


281 
§i
 = 
	`GSM_SUB
–§i, 
tmp2
 );

285 
tmp1
 = (Åmp1 =
MIN_WORD
 && 
§i
 == MIN_WORD

286 ? 
MAX_WORD


287 : 0x0FFFF & (–(
l⁄gw‹d
)
tmp1
 * (l⁄gw‹d)
§i


290 
v
[
i
+1] = 
	`GSM_ADD
–v[i], 
tmp1
);

292 *
§
++ = 
v
[0] = 
§i
;

294 
	}
}

297 #i‡
deföed
(
FAST
Ë&& deföed(
USE_FLOAT_MUL
)

299 
	$Fa°_Sh‹t_ãrm_sy¡hesis_fûãrög
 (

300 
gsm_°©e
 * 
S
,

301 
w‹d
 * 
ºp
,

302 
k
,

303 
w‹d
 * 
wt
,

304 
w‹d
 * 
§


307 
w‹d
 * 
v
 = 
S
->v;

308 
i
;

310 
va
[9], 
º∑
[8];

311 
sˇÀf
 = 3.0517578125e-5, 
ãmp
;

313 
i
 = 0; i < 8; ++i) {

314 
va
[
i
] = 
v
[i];

315 
º∑
[
i
] = ()
ºp
[i] * 
sˇÀf
;

317 
k
--) {

318 
§i
 = *
wt
++;

319 
i
 = 8; i--;) {

320 
§i
 -
º∑
[
i
] * 
va
[i];

321 i‡(
§i
 < -32768.) sri = -32768.;

322 i‡(
§i
 > 32767.) sri = 32767.;

324 
ãmp
 = 
va
[
i
] + 
º∑
[i] * 
§i
;

325 i‡(
ãmp
 < -32768.)Åemp = -32768.;

326 i‡(
ãmp
 > 32767.)Åemp = 32767.;

327 
va
[
i
+1] = 
ãmp
;

329 *
§
++ = 
va
[0] = 
§i
;

331 
i
 = 0; i < 9; ++iË
v
[i] = 
va
[i];

332 
	}
}

336 
	$Gsm_Sh‹t_Tîm_A«lysis_Fûãr
 (

338 
gsm_°©e
 * 
S
,

340 
w‹d
 * 
LARc
,

341 
w‹d
 * 
s


344 
w‹d
 * 
LARµ_j
 = 
S
->
LARµ
[ S->
j
 ];

345 
w‹d
 * 
LARµ_j_1
 = 
S
->
LARµ
[ S->
j
 ^= 1 ];

347 
w‹d
 
LARp
[8];

349 #unde‡
FILTER


350 #i‡ 
	`deföed
(
FAST
Ë&& deföed(
USE_FLOAT_MUL
)

351 
	#FILTER
 (* (
S
->
Á°
 \

352 ? 
Fa°_Sh‹t_ãrm_™Æysis_fûãrög
 \

353 : 
Sh‹t_ãrm_™Æysis_fûãrög
 ))

	)

356 
	#FILTER
 
Sh‹t_ãrm_™Æysis_fûãrög


	)

359 
	`Decodög_of_the_coded_Log_Aªa_R©ios
–
LARc
, 
LARµ_j
 );

361 
	`C€fficõ¡s_0_12
–
LARµ_j_1
, 
LARµ_j
, 
LARp
 );

362 
	`LARp_to_Ω
–
LARp
 );

363 
	`FILTER
–
S
, 
LARp
, 13, 
s
);

365 
	`C€fficõ¡s_13_26
–
LARµ_j_1
, 
LARµ_j
, 
LARp
);

366 
	`LARp_to_Ω
–
LARp
 );

367 
	`FILTER
–
S
, 
LARp
, 14, 
s
 + 13);

369 
	`C€fficõ¡s_27_39
–
LARµ_j_1
, 
LARµ_j
, 
LARp
);

370 
	`LARp_to_Ω
–
LARp
 );

371 
	`FILTER
–
S
, 
LARp
, 13, 
s
 + 27);

373 
	`C€fficõ¡s_40_159
–
LARµ_j
, 
LARp
);

374 
	`LARp_to_Ω
–
LARp
 );

375 
	`FILTER
–
S
, 
LARp
, 120, 
s
 + 40);

376 
	}
}

378 
	$Gsm_Sh‹t_Tîm_Sy¡hesis_Fûãr
 (

379 
gsm_°©e
 * 
S
,

381 
w‹d
 * 
LAR¸
,

382 
w‹d
 * 
wt
,

384 
w‹d
 * 
s


387 
w‹d
 * 
LARµ_j
 = 
S
->
LARµ
[ S->
j
 ];

388 
w‹d
 * 
LARµ_j_1
 = 
S
->
LARµ
[ S->
j
 ^=1 ];

390 
w‹d
 
LARp
[8];

392 #unde‡
FILTER


393 #i‡ 
	`deföed
(
FAST
Ë&& deföed(
USE_FLOAT_MUL
)

395 
	#FILTER
 (* (
S
->
Á°
 \

396 ? 
Fa°_Sh‹t_ãrm_sy¡hesis_fûãrög
 \

397 : 
Sh‹t_ãrm_sy¡hesis_fûãrög
 ))

	)

399 
	#FILTER
 
Sh‹t_ãrm_sy¡hesis_fûãrög


	)

402 
	`Decodög_of_the_coded_Log_Aªa_R©ios
–
LAR¸
, 
LARµ_j
 );

404 
	`C€fficõ¡s_0_12
–
LARµ_j_1
, 
LARµ_j
, 
LARp
 );

405 
	`LARp_to_Ω
–
LARp
 );

406 
	`FILTER
–
S
, 
LARp
, 13, 
wt
, 
s
 );

408 
	`C€fficõ¡s_13_26
–
LARµ_j_1
, 
LARµ_j
, 
LARp
);

409 
	`LARp_to_Ω
–
LARp
 );

410 
	`FILTER
–
S
, 
LARp
, 14, 
wt
 + 13, 
s
 + 13 );

412 
	`C€fficõ¡s_27_39
–
LARµ_j_1
, 
LARµ_j
, 
LARp
);

413 
	`LARp_to_Ω
–
LARp
 );

414 
	`FILTER
–
S
, 
LARp
, 13, 
wt
 + 27, 
s
 + 27 );

416 
	`C€fficõ¡s_40_159
–
LARµ_j
, 
LARp
 );

417 
	`LARp_to_Ω
–
LARp
 );

418 
	`FILTER
(
S
, 
LARp
, 120, 
wt
 + 40, 
s
 + 40);

419 
	}
}

	@libsndfile-1.0.17/src/GSM610/table.c

16 
	#GSM_TABLE_C


	)

17 
	~"gsm610_¥iv.h
"

18 
	~"gsm.h
"

23 
w‹d
 
	ggsm_A
[8] = {20480, 20480, 20480, 20480, 13964, 15360, 8534, 9036};

24 
w‹d
 
	ggsm_B
[8] = { 0, 0, 2048, -2560, 94, -1792, -341, -1144};

25 
w‹d
 
	ggsm_MIC
[8] = { -32, -32, -16, -16, -8, -8, -4, -4 };

26 
w‹d
 
	ggsm_MAC
[8] = { 31, 31, 15, 15, 7, 7, 3, 3 };

31 
w‹d
 
	ggsm_INVA
[8]={ 13107, 13107, 13107, 13107, 19223, 17476, 31454, 29708 };

37 
w‹d
 
	ggsm_DLB
[4] = { 6554, 16384, 26214, 32767 };

43 
w‹d
 
	ggsm_QLB
[4] = { 3277, 11469, 21299, 32767 };

49 
w‹d
 
	ggsm_H
[11] = {-134, -374, 0, 2054, 5741, 8192, 5741, 2054, 0, -374, -134 };

55 
w‹d
 
	ggsm_NRFAC
[8] = { 29128, 26215, 23832, 21846, 20165, 18725, 17476, 16384 };

61 
w‹d
 
	ggsm_FAC
[8] = { 18431, 20479, 22527, 24575, 26623, 28671, 30719, 32767 };

	@libsndfile-1.0.17/src/aiff.c

20 
	~"sfc⁄fig.h
"

22 
	~<°dio.h
>

23 
	~<°dlib.h
>

24 
	~<°rög.h
>

25 
	~<time.h
>

26 
	~<˘y≥.h
>

28 
	~"¢dfûe.h
"

29 
	~"s„ndün.h
"

30 
	~"comm⁄.h
"

36 
	#FORM_MARKER
 (
	`MAKE_MARKER
 ('F', 'O', 'R', 'M'))

	)

37 
	#AIFF_MARKER
 (
	`MAKE_MARKER
 ('A', 'I', 'F', 'F'))

	)

38 
	#AIFC_MARKER
 (
	`MAKE_MARKER
 ('A', 'I', 'F', 'C'))

	)

39 
	#COMM_MARKER
 (
	`MAKE_MARKER
 ('C', 'O', 'M', 'M'))

	)

40 
	#SSND_MARKER
 (
	`MAKE_MARKER
 ('S', 'S', 'N', 'D'))

	)

41 
	#MARK_MARKER
 (
	`MAKE_MARKER
 ('M', 'A', 'R', 'K'))

	)

42 
	#INST_MARKER
 (
	`MAKE_MARKER
 ('I', 'N', 'S', 'T'))

	)

43 
	#APPL_MARKER
 (
	`MAKE_MARKER
 ('A', 'P', 'P', 'L'))

	)

45 
	#c_MARKER
 (
	`MAKE_MARKER
 ('(', 'c', ')', ' '))

	)

46 
	#NAME_MARKER
 (
	`MAKE_MARKER
 ('N', 'A', 'M', 'E'))

	)

47 
	#AUTH_MARKER
 (
	`MAKE_MARKER
 ('A', 'U', 'T', 'H'))

	)

48 
	#ANNO_MARKER
 (
	`MAKE_MARKER
 ('A', 'N', 'N', 'O'))

	)

49 
	#COMT_MARKER
 (
	`MAKE_MARKER
 ('C', 'O', 'M', 'T'))

	)

50 
	#FVER_MARKER
 (
	`MAKE_MARKER
 ('F', 'V', 'E', 'R'))

	)

51 
	#SFX_MARKER
 (
	`MAKE_MARKER
 ('S', 'F', 'X', '!'))

	)

53 
	#PEAK_MARKER
 (
	`MAKE_MARKER
 ('P', 'E', 'A', 'K'))

	)

54 
	#basc_MARKER
 (
	`MAKE_MARKER
 ('b', 'a', 's', 'c'))

	)

57 
	#NONE_MARKER
 (
	`MAKE_MARKER
 ('N', 'O', 'N', 'E'))

	)

58 
	#sowt_MARKER
 (
	`MAKE_MARKER
 ('s', 'o', 'w', 't'))

	)

59 
	#twos_MARKER
 (
	`MAKE_MARKER
 ('t', 'w', 'o', 's'))

	)

60 
	#øw_MARKER
 (
	`MAKE_MARKER
 ('r', 'a', 'w', ' '))

	)

61 
	#ö32_MARKER
 (
	`MAKE_MARKER
 ('i', 'n', '3', '2'))

	)

62 
	#ni32_MARKER
 (
	`MAKE_MARKER
 ('2', '3', 'n', 'i'))

	)

64 
	#Ê32_MARKER
 (
	`MAKE_MARKER
 ('f', 'l', '3', '2'))

	)

65 
	#FL32_MARKER
 (
	`MAKE_MARKER
 ('F', 'L', '3', '2'))

	)

66 
	#Ê64_MARKER
 (
	`MAKE_MARKER
 ('f', 'l', '6', '4'))

	)

67 
	#FL64_MARKER
 (
	`MAKE_MARKER
 ('F', 'L', '6', '4'))

	)

69 
	#uœw_MARKER
 (
	`MAKE_MARKER
 ('u', 'l', 'a', 'w'))

	)

70 
	#ULAW_MARKER
 (
	`MAKE_MARKER
 ('U', 'L', 'A', 'W'))

	)

71 
	#Æaw_MARKER
 (
	`MAKE_MARKER
 ('a', 'l', 'a', 'w'))

	)

72 
	#ALAW_MARKER
 (
	`MAKE_MARKER
 ('A', 'L', 'A', 'W'))

	)

74 
	#DWVW_MARKER
 (
	`MAKE_MARKER
 ('D', 'W', 'V', 'W'))

	)

75 
	#GSM_MARKER
 (
	`MAKE_MARKER
 ('G', 'S', 'M', ' '))

	)

76 
	#ima4_MARKER
 (
	`MAKE_MARKER
 ('i', 'm', 'a', '4'))

	)

80 
	#MAC3_MARKER
 (
	`MAKE_MARKER
 ('M', 'A', 'C', '3'))

	)

81 
	#MAC6_MARKER
 (
	`MAKE_MARKER
 ('M', 'A', 'C', '6'))

	)

82 
	#ADP4_MARKER
 (
	`MAKE_MARKER
 ('A', 'D', 'P', '4'))

	)

85 
	#SIZEOF_AIFF_COMM
 18

	)

86 
	#SIZEOF_AIFC_COMM_MIN
 22

	)

87 
	#SIZEOF_AIFC_COMM
 24

	)

88 
	#SIZEOF_SSND_CHUNK
 8

	)

89 
	#SIZEOF_INST_CHUNK
 20

	)

94 
	#AIFC_IMA4_BLOCK_LEN
 34

	)

95 
	#AIFC_IMA4_SAMPLES_PER_BLOCK
 64

	)

97 
	#AIFF_PEAK_CHUNK_SIZE
(
ch
Ë(2 *  (Ë+ ch * ( (Ë+  ()))

	)

104 { 
	mHAVE_FORM
 = 0x01,

105 
	mHAVE_AIFF
 = 0x02,

106 
	mHAVE_AIFC
 = 0x04,

107 
	mHAVE_FVER
 = 0x08,

108 
	mHAVE_COMM
 = 0x10,

109 
	mHAVE_SSND
 = 0x20

113 { 
	msize
 ;

114 
	mnumCh™√ls
 ;

115 
	mnumSam∂eFømes
 ;

116 
	mßm∂eSize
 ;

117 
	mßm∂eR©e
 [10] ;

118 
	mícodög
 ;

119 
	mzîo_byãs
 [2] ;

120 } 
	tCOMM_CHUNK
 ;

123 { 
	moff£t
 ;

124 
	mblocksize
 ;

125 } 
	tSSND_CHUNK
 ;

128 { 
	m∂ayMode
 ;

129 
	mbegöLo›
 ;

130 
	mídLo›
 ;

131 } 
	tINST_LOOP
 ;

134 { 
	mba£NŸe
 ;

135 
	mdëu√
 ;

136 
	mlowNŸe
 ;

137 
	mhighNŸe
 ;

138 
	mlowVñocôy
 ;

139 
	mhighVñocôy
 ;

140 
	mgaö
 ;

141 
INST_LOOP
 
	msu°aö_lo›
 ;

142 
INST_LOOP
 
	mªÀa£_lo›
 ;

143 } 
	tINST_CHUNK
 ;

147 { 
	mbasc_SCALE_MINOR
 = 1,

148 
	mbasc_SCALE_MAJOR
,

149 
	mbasc_SCALE_NEITHER
,

150 
	mbasc_SCALE_BOTH


154 { 
	mbasc_TYPE_LOOP
 = 0,

155 
	mbasc_TYPE_ONE_SHOT


160 { 
	mvîsi⁄
 ;

161 
	mnumBóts
 ;

162 
	mroŸNŸe
 ;

163 
	msˇÀTy≥
 ;

164 
	msigNumî©‹
 ;

165 
	msigDíomö©‹
 ;

166 
	mlo›Ty≥
 ;

167 } 
	tbasc_CHUNK
 ;

170 { 
	mm¨kîID
 ;

171 
	mposôi⁄
 ;

172 } 
	tMARK_ID_POS
 ;

175 { 
sf_cou¡_t
 
	mcomm_off£t
 ;

176 
sf_cou¡_t
 
	ms¢d_off£t
 ;

177 } 
	tAIFF_PRIVATE
 ;

183 
aiff_˛o£
 (
SF_PRIVATE
 *
psf
) ;

185 
ãnbyãÊﬂt2öt
 (*
byãs
) ;

186 
uöt2ãnbyãÊﬂt
 (
num
, *
byãs
) ;

188 
aiff_ªad_comm_chunk
 (
SF_PRIVATE
 *
psf
, 
COMM_CHUNK
 *
comm_fmt
) ;

190 
aiff_ªad_hódî
 (
SF_PRIVATE
 *
psf
, 
COMM_CHUNK
 *
comm_fmt
) ;

192 
aiff_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
) ;

193 
aiff_wrôe_èûî
 (
SF_PRIVATE
 *
psf
) ;

194 
aiff_wrôe_°rögs
 (
SF_PRIVATE
 *
psf
, 
loˇti⁄
) ;

196 
aiff_comm™d
 (
SF_PRIVATE
 *
psf
, 
comm™d
, *
d©a
, 
d©asize
) ;

198 c⁄° *
gë_lo›_mode_°r
 (
mode
) ;

200 
gë_lo›_mode
 (
mode
) ;

202 
aiff_ªad_basc_chunk
 (
SF_PRIVATE
 * 
psf
, ) ;

204 
m¨kî_to_posôi⁄
 (c⁄° 
MARK_ID_POS
 *
m
, 
n
, 
m¨ksize
) ;

211 
	$aiff_›í
 (
SF_PRIVATE
 *
psf
)

212 { 
COMM_CHUNK
 
comm_fmt
 ;

213 
îr‹
, 
subf‹m©
 ;

215 
	`mem£t
 (&
comm_fmt
, 0,  (comm_fmt)) ;

217 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

219 i‡((
psf
->
c⁄èöî_d©a
 = 
	`ˇŒoc
 (1,  (
AIFF_PRIVATE
))Ë=
NULL
)

220  
SFE_MALLOC_FAILED
 ;

222 i‡(
psf
->
mode
 =
SFM_READ
 || (psf->modê=
SFM_RDWR
 &&Ösf->
fûñígth
 > 0))

223 { i‡((
îr‹
 = 
	`aiff_ªad_hódî
 (
psf
, &
comm_fmt
)))

224  
îr‹
 ;

226 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
, 
SEEK_SET
) ;

229 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

230 { i‡(
psf
->
is_pùe
)

231  
SFE_NO_PIPE_WRITE
 ;

233 i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_AIFF
)

234  
SFE_BAD_OPEN_FORMAT
 ;

236 i‡(
psf
->
mode
 =
SFM_WRITE
 && (
subf‹m©
 =
SF_FORMAT_FLOAT
 || subf‹m© =
SF_FORMAT_DOUBLE
))

237 { i‡((
psf
->
≥ak_öfo
 = 
	`≥ak_öfo_ˇŒoc
 (psf->
sf
.
ch™√ls
)Ë=
NULL
)

238  
SFE_MALLOC_FAILED
 ;

239 
psf
->
≥ak_öfo
->
≥ak_loc
 = 
SF_PEAK_START
 ;

242 i‡(
psf
->
mode
 !
SFM_RDWR
 ||Ösf->
fûñígth
 < 40)

243 { 
psf
->
fûñígth
 = 0 ;

244 
psf
->
d©Æígth
 = 0 ;

245 
psf
->
d©aoff£t
 = 0 ;

246 
psf
->
sf
.
‰ames
 = 0 ;

249 
psf
->
°r_Êags
 = 
SF_STR_ALLOW_START
 | 
SF_STR_ALLOW_END
 ;

251 i‡((
îr‹
 = 
	`aiff_wrôe_hódî
 (
psf
, 
SF_FALSE
)))

252  
îr‹
 ;

254 
psf
->
wrôe_hódî
 = 
aiff_wrôe_hódî
 ;

257 
psf
->
c⁄èöî_˛o£
 = 
aiff_˛o£
 ;

258 
psf
->
comm™d
 = 
aiff_comm™d
 ;

260 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
)

261 { 
SF_FORMAT_PCM_U8
 :

262 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

265 
SF_FORMAT_PCM_S8
 :

266 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

269 
SF_FORMAT_PCM_16
 :

270 
SF_FORMAT_PCM_24
 :

271 
SF_FORMAT_PCM_32
 :

272 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

275 
SF_FORMAT_ULAW
 :

276 
îr‹
 = 
	`uœw_öô
 (
psf
) ;

279 
SF_FORMAT_ALAW
 :

280 
îr‹
 = 
	`Æaw_öô
 (
psf
) ;

284 
SF_FORMAT_FLOAT
 :

285 
îr‹
 = 
	`Êﬂt32_öô
 (
psf
) ;

288 
SF_FORMAT_DOUBLE
 :

289 
îr‹
 = 
	`doubÀ64_öô
 (
psf
) ;

292 
SF_FORMAT_DWVW_12
 :

293 
îr‹
 = 
	`dwvw_öô
 (
psf
, 12) ;

296 
SF_FORMAT_DWVW_16
 :

297 
îr‹
 = 
	`dwvw_öô
 (
psf
, 16) ;

300 
SF_FORMAT_DWVW_24
 :

301 
îr‹
 = 
	`dwvw_öô
 (
psf
, 24) ;

304 
SF_FORMAT_DWVW_N
 :

305 i‡(
psf
->
mode
 !
SFM_READ
)

306 { 
îr‹
 = 
SFE_DWVW_BAD_BITWIDTH
 ;

309 i‡(
comm_fmt
.
ßm∂eSize
 >= 8 && comm_fmt.sampleSize < 24)

310 { 
îr‹
 = 
	`dwvw_öô
 (
psf
, 
comm_fmt
.
ßm∂eSize
) ;

311 
psf
->
sf
.
‰ames
 = 
comm_fmt
.
numSam∂eFømes
 ;

314 
	`psf_log_¥ötf
 (
psf
, "AIFC/DWVW : Bad bôwidth %d\n", 
comm_fmt
.
ßm∂eSize
) ;

315 
îr‹
 = 
SFE_DWVW_BAD_BITWIDTH
 ;

318 
SF_FORMAT_IMA_ADPCM
 :

323 
îr‹
 = 
	`aiff_ima_öô
 (
psf
, 
AIFC_IMA4_BLOCK_LEN
, 
AIFC_IMA4_SAMPLES_PER_BLOCK
) ;

327 
SF_FORMAT_GSM610
 :

328 
îr‹
 = 
	`gsm610_öô
 (
psf
) ;

331  :  
SFE_UNIMPLEMENTED
 ;

335  
îr‹
 ;

336 
	}
}

344 
	$m¨kî_to_posôi⁄
 (c⁄° 
MARK_ID_POS
 *
m
, 
n
, 
m¨ksize
)

345 { 
i
 ;

347 
i
 = 0 ; i < 
m¨ksize
 ; i++)

348 i‡(
m
 [
i
].
m¨kîID
 =
n
)

349  
m
 [
i
].
posôi⁄
 ;

351 
	}
}

354 
	$aiff_ªad_hódî
 (
SF_PRIVATE
 *
psf
, 
COMM_CHUNK
 *
comm_fmt
)

355 { 
SSND_CHUNK
 
s¢d_fmt
 ;

356 
MARK_ID_POS
 *
m¨k°r
 = 
NULL
 ;

357 
AIFF_PRIVATE
 *
∑iff
 ;

358 
m¨kî
, 
dw‹d
, 
FORMsize
, 
SSNDsize
, 
byã§ód
 ;

359 
k
, 
found_chunk
 = 0, 
d⁄e
 = 0, 
îr‹
 = 0 ;

360 *
˝å
, 
byã
 ;

361 
ö°r_found
 = 0, 
m¨k_found
 = 0, 
m¨k_cou¡
 = 0 ;

363 i‡((
∑iff
 = 
psf
->
c⁄èöî_d©a
Ë=
NULL
)

364  
SFE_INTERNAL
 ;

366 
∑iff
->
comm_off£t
 = 0 ;

367 
∑iff
->
s¢d_off£t
 = 0 ;

370 
	`psf_böhódî_ªadf
 (
psf
, "p", 0) ;

372 
	`mem£t
 (
comm_fmt
, 0,  (
COMM_CHUNK
)) ;

375 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

381 ! 
d⁄e
)

382 { 
	`psf_böhódî_ªadf
 (
psf
, "m", &
m¨kî
) ;

384 i‡(
psf
->
mode
 =
SFM_RDWR
 && (
found_chunk
 & 
HAVE_SSND
))

385  
SFE_AIFF_RW_SSND_NOT_LAST
 ;

387 
m¨kî
)

388 { 
FORM_MARKER
 :

389 i‡(
found_chunk
)

390  
SFE_AIFF_NO_FORM
 ;

392 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
FORMsize
) ;

394 i‡(
psf
->
fûeoff£t
 > 0 &&Ösf->
fûñígth
 > 
FORMsize
 + 8)

396 
psf
->
fûñígth
 = 
FORMsize
 + 8 ;

397 
	`psf_log_¥ötf
 (
psf
, "FORM : %u\n", 
FORMsize
) ;

399 i‡(
FORMsize
 !
psf
->
fûñígth
 - 2 * 
	`SIGNED_SIZEOF
 (
dw‹d
))

400 { 
dw‹d
 = 
psf
->
fûñígth
 - 2 *  (dword) ;

401 
	`psf_log_¥ötf
 (
psf
, "FORM : %u (should bê%u)\n", 
FORMsize
, 
dw‹d
) ;

402 
FORMsize
 = 
dw‹d
 ;

405 
	`psf_log_¥ötf
 (
psf
, "FORM : %u\n", 
FORMsize
) ;

406 
found_chunk
 |
HAVE_FORM
 ;

409 
AIFC_MARKER
 :

410 
AIFF_MARKER
 :

411 i‡((
found_chunk
 & 
HAVE_FORM
) == 0)

412  
SFE_AIFF_AIFF_NO_FORM
 ;

413 
	`psf_log_¥ötf
 (
psf
, " %M\n", 
m¨kî
) ;

414 
found_chunk
 |(
m¨kî
 =
AIFC_MARKER
Ë? (
HAVE_AIFC
 | 
HAVE_AIFF
) : HAVE_AIFF ;

417 
COMM_MARKER
 :

418 
∑iff
->
comm_off£t
 = 
	`psf_·ñl
 (
psf
) - 4 ;

419 
îr‹
 = 
	`aiff_ªad_comm_chunk
 (
psf
, 
comm_fmt
) ;

421 
psf
->
sf
.
ßm∂î©e
 = 
	`ãnbyãÊﬂt2öt
 (
comm_fmt
->
ßm∂eR©e
) ;

422 
psf
->
sf
.
‰ames
 = 
comm_fmt
->
numSam∂eFømes
 ;

423 
psf
->
sf
.
ch™√ls
 = 
comm_fmt
->
numCh™√ls
 ;

424 
psf
->
byãwidth
 = 
	`BITWIDTH2BYTES
 (
comm_fmt
->
ßm∂eSize
) ;

426 i‡(
îr‹
)

427  
îr‹
 ;

429 
found_chunk
 |
HAVE_COMM
 ;

432 
PEAK_MARKER
 :

434 i‡((
found_chunk
 & (
HAVE_FORM
 | 
HAVE_AIFF
 | 
HAVE_COMM
)) != (HAVE_FORM | HAVE_AIFF | HAVE_COMM))

435  
SFE_AIFF_PEAK_B4_COMM
 ;

437 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
dw‹d
) ;

439 
	`psf_log_¥ötf
 (
psf
, "%M : %d\n", 
m¨kî
, 
dw‹d
) ;

440 i‡(
dw‹d
 !
	`AIFF_PEAK_CHUNK_SIZE
 (
psf
->
sf
.
ch™√ls
))

441 { 
	`psf_böhódî_ªadf
 (
psf
, "j", 
dw‹d
) ;

442 
	`psf_log_¥ötf
 (
psf
, "*** File PEAK chunkÅoo big.\n") ;

443  
SFE_WAV_BAD_PEAK
 ;

446 i‡((
psf
->
≥ak_öfo
 = 
	`≥ak_öfo_ˇŒoc
 (psf->
sf
.
ch™√ls
)Ë=
NULL
)

447  
SFE_MALLOC_FAILED
 ;

450 
	`psf_böhódî_ªadf
 (
psf
, "E44", &’sf->
≥ak_öfo
->
vîsi⁄
), &’sf->≥ak_öfo->
time°amp
)) ;

452 i‡(
psf
->
≥ak_öfo
->
vîsi⁄
 != 1)

453 
	`psf_log_¥ötf
 (
psf
, " vîsi⁄ : %d *** (should bêvîsi⁄ 1)\n",Ösf->
≥ak_öfo
->
vîsi⁄
) ;

455 
	`psf_log_¥ötf
 (
psf
, " vîsi⁄ : %d\n",Ösf->
≥ak_öfo
->
vîsi⁄
) ;

457 
	`psf_log_¥ötf
 (
psf
, "Åimê°am∞: %d\n",Ösf->
≥ak_öfo
->
time°amp
) ;

458 
	`psf_log_¥ötf
 (
psf
, " Ch Position Value\n") ;

460 
˝å
 = 
psf
->
u
.
cbuf
 ;

461 
dw‹d
 = 0 ; dw‹d < (Ë
psf
->
sf
.
ch™√ls
 ; dword++)

462 { 
vÆue
 ;

463 
posôi⁄
 ;

465 
	`psf_böhódî_ªadf
 (
psf
, "Ef4", &
vÆue
, &
posôi⁄
) ;

466 
psf
->
≥ak_öfo
->
≥aks
 [
dw‹d
].
vÆue
 = value ;

467 
psf
->
≥ak_öfo
->
≥aks
 [
dw‹d
].
posôi⁄
 =Öosition ;

469 
	`LSF_SNPRINTF
 (
˝å
,  (
psf
->
u
.
scbuf
), " %2d %-12ld %g\n",

470 
dw‹d
, (Ë
psf
->
≥ak_öfo
->
≥aks
 [dw‹d].
posôi⁄
,Ösf->≥ak_öfo->≥ak†[dw‹d].
vÆue
) ;

471 
˝å
 [ (
psf
->
u
.
scbuf
) - 1] = 0 ;

472 
	`psf_log_¥ötf
 (
psf
, 
˝å
) ;

477 
SSND_MARKER
 :

478 i‡((
found_chunk
 & 
HAVE_AIFC
Ë&& (found_chunk & 
HAVE_FVER
) == 0)

479 
	`psf_log_¥ötf
 (
psf
, "*** Valid AIFC files should haveán FVER chunk.\n") ;

481 
∑iff
->
s¢d_off£t
 = 
	`psf_·ñl
 (
psf
) - 4 ;

482 
	`psf_böhódî_ªadf
 (
psf
, "E444", &
SSNDsize
, &(
s¢d_fmt
.
off£t
), &(s¢d_fmt.
blocksize
)) ;

484 
psf
->
d©Æígth
 = 
SSNDsize
 -  (
s¢d_fmt
) ;

485 
psf
->
d©aoff£t
 = 
	`psf_·ñl
 (psf) ;

487 i‡(
psf
->
d©Æígth
 >Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ||Ösf->datalength < 0)

488 { 
	`psf_log_¥ötf
 (
psf
, " SSND : %u (should bê%D)\n", 
SSNDsize
,Ösf->
fûñígth
 -Ösf->
d©aoff£t
 +  (
SSND_CHUNK
)) ;

489 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

492 
	`psf_log_¥ötf
 (
psf
, " SSND : %u\n", 
SSNDsize
) ;

495 i‡(
psf
->
d©Æígth
 +Ösf->
d©aoff£t
 <Ösf->
fûñígth
)

496 
psf
->
d©´nd
 =Ösf->
d©Æígth
 +Ösf->
d©aoff£t
 ;

498 
	`psf_log_¥ötf
 (
psf
, " Off£à : %u\n", 
s¢d_fmt
.
off£t
) ;

499 
	`psf_log_¥ötf
 (
psf
, " Block Sizê: %u\n", 
s¢d_fmt
.
blocksize
) ;

501 
found_chunk
 |
HAVE_SSND
 ;

503 i‡(! 
psf
->
sf
.
£ekabÀ
)

507 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
 +Ösf->
d©Æígth
 + (
SSNDsize
 & 1), 
SEEK_SET
) ;

510 
c_MARKER
 :

511 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
dw‹d
) ;

512 i‡(
dw‹d
 == 0)

514 i‡(
dw‹d
 > 
	`SIGNED_SIZEOF
 (
psf
->
u
.
scbuf
) - 1)

515 { 
	`psf_log_¥ötf
 (
psf
, " %M : %d (toÿbig)\n", 
m¨kî
, 
dw‹d
) ;

516  
SFE_INTERNAL
 ;

519 
˝å
 = 
psf
->
u
.
cbuf
 ;

520 
	`psf_böhódî_ªadf
 (
psf
, "b", 
˝å
, 
dw‹d
 + (dword & 1)) ;

521 
˝å
 [
dw‹d
] = 0 ;

522 
	`psf_log_¥ötf
 (
psf
, " %M : %s\n", 
m¨kî
, 
˝å
) ;

523 
	`psf_°‹e_°rög
 (
psf
, 
SF_STR_COPYRIGHT
, 
˝å
) ;

526 
AUTH_MARKER
 :

527 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
dw‹d
) ;

528 i‡(
dw‹d
 == 0)

530 i‡(
dw‹d
 > 
	`SIGNED_SIZEOF
 (
psf
->
u
.
scbuf
) - 1)

531 { 
	`psf_log_¥ötf
 (
psf
, " %M : %d (toÿbig)\n", 
m¨kî
, 
dw‹d
) ;

532  
SFE_INTERNAL
 ;

535 
˝å
 = 
psf
->
u
.
cbuf
 ;

536 
	`psf_böhódî_ªadf
 (
psf
, "b", 
˝å
, 
dw‹d
 + (dword & 1)) ;

537 
˝å
 [
dw‹d
] = 0 ;

538 
	`psf_log_¥ötf
 (
psf
, " %M : %s\n", 
m¨kî
, 
˝å
) ;

539 
	`psf_°‹e_°rög
 (
psf
, 
SF_STR_ARTIST
, 
˝å
) ;

542 
COMT_MARKER
 :

543 { 
cou¡
, 
id
, 
Àn
 ;

544 
time°amp
 ;

546 
	`psf_böhódî_ªadf
 (
psf
, "E42", &
dw‹d
, &
cou¡
) ;

547 
	`psf_log_¥ötf
 (
psf
, " %M : %d\¿ cou¡ : %d\n", 
m¨kî
, 
dw‹d
, 
cou¡
) ;

548 
dw‹d
 += (dword & 1) ;

549 i‡(
dw‹d
 == 0)

551 
dw‹d
 -= 2 ;

553 
k
 = 0 ; k < 
cou¡
 ; k++)

554 { 
dw‹d
 -
	`psf_böhódî_ªadf
 (
psf
, "E422", &
time°amp
, &
id
, &
Àn
) ;

555 
	`psf_log_¥ötf
 (
psf
, "Åimê : 0x%x\¿ m¨kî : %x\¿Üígth : %d\n", 
time°amp
, 
id
, 
Àn
) ;

557 i‡(
Àn
 + 1 > 
	`SIGNED_SIZEOF
 (
psf
->
u
.
scbuf
))

558 { 
	`psf_log_¥ötf
 (
psf
, "\nEº‹ : såögÜígth (%dËtoÿbig.\n", 
Àn
) ;

559  
SFE_INTERNAL
 ;

562 
˝å
 = 
psf
->
u
.
cbuf
 ;

563 
dw‹d
 -
	`psf_böhódî_ªadf
 (
psf
, "b", 
˝å
, 
Àn
) ;

564 
˝å
 [
Àn
] = 0 ;

565 
	`psf_log_¥ötf
 (
psf
, " såög : %s\n", 
˝å
) ;

568 i‡(
dw‹d
 > 0)

569 
	`psf_böhódî_ªadf
 (
psf
, "j", 
dw‹d
) ;

573 
APPL_MARKER
 :

574 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
dw‹d
) ;

575 i‡(
dw‹d
 == 0)

577 i‡(
dw‹d
 >
	`SIGNED_SIZEOF
 (
psf
->
u
.
scbuf
) - 1)

578 { 
	`psf_log_¥ötf
 (
psf
, " %M : %d (toÿbig, skùpög)\n", 
m¨kî
, 
dw‹d
) ;

579 
	`psf_böhódî_ªadf
 (
psf
, "j", 
dw‹d
 + (dword & 1)) ;

583 
˝å
 = 
psf
->
u
.
cbuf
 ;

584 
	`psf_böhódî_ªadf
 (
psf
, "b", 
˝å
, 
dw‹d
 + (dword & 1)) ;

585 
˝å
 [
dw‹d
] = 0 ;

587 
k
 = 0 ; k < (Ë
dw‹d
 ; k++)

588 i‡(! 
	`i•röt
 (
˝å
 [
k
]))

589 { 
˝å
 [
k
] = 0 ;

593 
	`psf_log_¥ötf
 (
psf
, " %M : %s\n", 
m¨kî
, 
˝å
) ;

594 
	`psf_°‹e_°rög
 (
psf
, 
SF_STR_SOFTWARE
, 
˝å
) ;

597 
NAME_MARKER
 :

598 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
dw‹d
) ;

599 i‡(
dw‹d
 == 0)

601 i‡(
dw‹d
 > 
	`SIGNED_SIZEOF
 (
psf
->
u
.
scbuf
) - 2)

602 { 
	`psf_log_¥ötf
 (
psf
, " %M : %d (toÿbig)\n", 
m¨kî
, 
dw‹d
) ;

603  
SFE_INTERNAL
 ;

606 
˝å
 = 
psf
->
u
.
cbuf
 ;

607 
	`psf_böhódî_ªadf
 (
psf
, "b", 
˝å
, 
dw‹d
 + (dword & 1)) ;

608 
˝å
 [
dw‹d
] = 0 ;

609 
	`psf_log_¥ötf
 (
psf
, " %M : %s\n", 
m¨kî
, 
˝å
) ;

610 
	`psf_°‹e_°rög
 (
psf
, 
SF_STR_TITLE
, 
˝å
) ;

613 
ANNO_MARKER
 :

614 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
dw‹d
) ;

615 i‡(
dw‹d
 == 0)

617 i‡(
dw‹d
 > 
	`SIGNED_SIZEOF
 (
psf
->
u
.
scbuf
) - 2)

618 { 
	`psf_log_¥ötf
 (
psf
, " %M : %d (toÿbig)\n", 
m¨kî
, 
dw‹d
) ;

619  
SFE_INTERNAL
 ;

622 
˝å
 = 
psf
->
u
.
cbuf
 ;

623 
	`psf_böhódî_ªadf
 (
psf
, "b", 
˝å
, 
dw‹d
 + (dword & 1)) ;

624 
˝å
 [
dw‹d
] = 0 ;

625 
	`psf_log_¥ötf
 (
psf
, " %M : %s\n", 
m¨kî
, 
˝å
) ;

626 
	`psf_°‹e_°rög
 (
psf
, 
SF_STR_COMMENT
, 
˝å
) ;

629 
INST_MARKER
 :

630 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
dw‹d
) ;

631 i‡(
dw‹d
 !
SIZEOF_INST_CHUNK
)

632 { 
	`psf_log_¥ötf
 (
psf
, " %M : %d (should bê%d)\n", 
m¨kî
, 
dw‹d
, 
SIZEOF_INST_CHUNK
) ;

633 
	`psf_böhódî_ªadf
 (
psf
, "j", 
dw‹d
) ;

636 
	`psf_log_¥ötf
 (
psf
, " %M : %d\n", 
m¨kî
, 
dw‹d
) ;

637 { 
byãs
 [6] ;

638 
gaö
 ;

640 i‡(
psf
->
ö°rumít
 =
NULL
 && (psf->ö°rumíà
	`psf_ö°rumít_Æloc
 ()) == NULL)

641  
SFE_MALLOC_FAILED
 ;

643 
	`psf_böhódî_ªadf
 (
psf
, "b", 
byãs
, 6) ;

644 
	`psf_log_¥ötf
 (
psf
, " Base Note : %u\n Detune : %u\n"

647 
byãs
 [0], bytes [1], bytes [2], bytes [3], bytes [4], bytes [5]) ;

648 
psf
->
ö°rumít
->
ba£nŸe
 = 
byãs
 [0] ;

649 
psf
->
ö°rumít
->
dëu√
 = 
byãs
 [1] ;

650 
psf
->
ö°rumít
->
key_lo
 = 
byãs
 [2] ;

651 
psf
->
ö°rumít
->
key_hi
 = 
byãs
 [3] ;

652 
psf
->
ö°rumít
->
vñocôy_lo
 = 
byãs
 [4] ;

653 
psf
->
ö°rumít
->
vñocôy_hi
 = 
byãs
 [5] ;

654 
	`psf_böhódî_ªadf
 (
psf
, "E2", &
gaö
) ;

655 
psf
->
ö°rumít
->
gaö
 = gain ;

656 
	`psf_log_¥ötf
 (
psf
, " Gaö (dBË: %d\n", 
gaö
) ;

658 { 
mode
 ;

659 c⁄° *
lo›_mode
 ;

660 
begö
, 
íd
 ;

662 
	`psf_böhódî_ªadf
 (
psf
, "E222", &
mode
, &
begö
, &
íd
) ;

663 
lo›_mode
 = 
	`gë_lo›_mode_°r
 (
mode
) ;

664 
mode
 = 
	`gë_lo›_mode
 (mode) ;

665 i‡(
mode
 =
SF_LOOP_NONE
)

666 { 
psf
->
ö°rumít
->
lo›_cou¡
 = 0 ;

667 
psf
->
ö°rumít
->
lo›s
 [0].
mode
 = 
SF_LOOP_NONE
 ;

670 { 
psf
->
ö°rumít
->
lo›_cou¡
 = 1 ;

671 
psf
->
ö°rumít
->
lo›s
 [0].
mode
 = 
SF_LOOP_FORWARD
 ;

672 
psf
->
ö°rumít
->
lo›s
 [0].
°¨t
 = 
begö
 ;

673 
psf
->
ö°rumít
->
lo›s
 [0].
íd
 =Énd ;

674 
psf
->
ö°rumít
->
lo›s
 [0].
cou¡
 = 0 ;

676 
	`psf_log_¥ötf
 (
psf
, " Sustain\n mode : %d => %s\n begin : %u\nÉnd : %u\n",

677 
mode
, 
lo›_mode
, 
begö
, 
íd
) ;

678 
	`psf_böhódî_ªadf
 (
psf
, "E222", &
mode
, &
begö
, &
íd
) ;

679 
lo›_mode
 = 
	`gë_lo›_mode_°r
 (
mode
) ;

680 
mode
 = 
	`gë_lo›_mode
 (mode) ;

681 i‡(
mode
 =
SF_LOOP_NONE
)

682 
psf
->
ö°rumít
->
lo›s
 [0].
mode
 = 
SF_LOOP_NONE
 ;

684 { 
psf
->
ö°rumít
->
lo›_cou¡
 += 1 ;

685 
psf
->
ö°rumít
->
lo›s
 [1].
mode
 = 
SF_LOOP_FORWARD
 ;

686 
psf
->
ö°rumít
->
lo›s
 [1].
°¨t
 = 
begö
 ;

687 
psf
->
ö°rumít
->
lo›s
 [1].
íd
 =Énd ;

688 
psf
->
ö°rumít
->
lo›s
 [1].
cou¡
 = 0 ;

690 
	`psf_log_¥ötf
 (
psf
, " Release\n mode : %d => %s\n begin : %u\nÉnd : %u\n",

691 
mode
, 
lo›_mode
, 
begö
, 
íd
) ;

693 
ö°r_found
++ ;

696 
basc_MARKER
 :

697 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
dw‹d
) ;

698 
	`psf_log_¥ötf
 (
psf
, " bas¯: %u\n", 
dw‹d
) ;

700 i‡((
îr‹
 = 
	`aiff_ªad_basc_chunk
 (
psf
, 
dw‹d
)))

701  
îr‹
 ;

704 
MARK_MARKER
 :

705 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
dw‹d
) ;

706 
	`psf_log_¥ötf
 (
psf
, " %M : %d\n", 
m¨kî
, 
dw‹d
) ;

707 { 
m¨k_id
, 
n
 = 0 ;

708 
p°r_Àn
 ;

709 
posôi⁄
 ;

711 
byã§ód
 = 
	`psf_böhódî_ªadf
 (
psf
, "E2", &
n
) ;

712 
m¨k_cou¡
 = 
n
 ;

713 
m¨k°r
 = 
	`ˇŒoc
 (
m¨k_cou¡
,  (
MARK_ID_POS
)) ;

714 
	`psf_log_¥ötf
 (
psf
, " Cou¡ : %d\n", 
m¨k_cou¡
) ;

716 
n
 = 0 ;Ç < 
m¨k_cou¡
 && 
byã§ód
 < 
dw‹d
 ;Ç++)

717 { 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "E241", &
m¨k_id
, &
posôi⁄
, &
p°r_Àn
) ;

718 
	`psf_log_¥ötf
 (
psf
, " M¨k ID : %u\¿ Posôi⁄ : %u\n", 
m¨k_id
, 
posôi⁄
) ;

720 
p°r_Àn
 += (pstr_len & 1) + 1 ;

722 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "b",Ösf->
u
.
scbuf
, 
p°r_Àn
) ;

723 
	`psf_log_¥ötf
 (
psf
, " Namê : %s\n",Ösf->
u
.
scbuf
) ;

725 
m¨k°r
 [
n
].
m¨kîID
 = 
m¨k_id
 ;

726 
m¨k°r
 [
n
].
posôi⁄
 =Öosition ;

735 
m¨k_found
++ ;

736 
	`psf_böhódî_ªadf
 (
psf
, "j", 
dw‹d
 - 
byã§ód
) ;

739 
FVER_MARKER
 :

740 
found_chunk
 |
HAVE_FVER
 ;

743 
SFX_MARKER
 :

744 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
dw‹d
) ;

745 
	`psf_log_¥ötf
 (
psf
, " %M : %d\n", 
m¨kî
, 
dw‹d
) ;

747 
	`psf_böhódî_ªadf
 (
psf
, "j", 
dw‹d
) ;

750 
NONE_MARKER
 :

752 
	`psf_böhódî_ªadf
 (
psf
, "1", &
byã
) ;

753 
dw‹d
 = 
byã
 ;

754 
	`psf_böhódî_ªadf
 (
psf
, "j", 
dw‹d
) ;

758 i‡(
	`i•röt
 ((
m¨kî
 >> 24) & 0xFF) && isprint ((marker >> 16) & 0xFF)

759 && 
	`i•röt
 ((
m¨kî
 >> 8) & 0xFF) && isprint (marker & 0xFF))

760 { 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
dw‹d
) ;

761 
	`psf_log_¥ötf
 (
psf
, " %M : %d (unknow¿m¨kî)\n", 
m¨kî
, 
dw‹d
) ;

763 
	`psf_böhódî_ªadf
 (
psf
, "j", 
dw‹d
) ;

766 i‡((
dw‹d
 = 
	`psf_·ñl
 (
psf
)) & 0x03)

767 { 
	`psf_log_¥ötf
 (
psf
, " Unknow¿chunk m¨kî %Xáàposôi⁄ %d. Resyncög.\n", 
m¨kî
, 
dw‹d
 - 4) ;

769 
	`psf_böhódî_ªadf
 (
psf
, "j", -3) ;

772 
	`psf_log_¥ötf
 (
psf
, "*** Unknow¿chunk m¨kî %Xáàposôi⁄ %D. ExôögÖ¨£r.\n", 
m¨kî
, 
	`psf_·ñl
 (psf)) ;

773 
d⁄e
 = 1 ;

777 i‡((! 
psf
->
sf
.
£ekabÀ
Ë&& (
found_chunk
 & 
HAVE_SSND
))

780 i‡(
	`psf_·ñl
 (
psf
Ë>psf->
fûñígth
 - (2 * 
	`SIGNED_SIZEOF
 (
dw‹d
)))

784 i‡(
ö°r_found
 && 
m¨k_found
)

785 { 
j
 ;

787 
j
 = 0 ; j<
psf
->
ö°rumít
->
lo›_cou¡
 ; j ++)

788 { i‡(
j
 < 
	`ARRAY_LEN
 (
psf
->
ö°rumít
->
lo›s
))

789 { 
psf
->
ö°rumít
->
lo›s
 [
j
].
°¨t
 = 
	`m¨kî_to_posôi⁄
 (
m¨k°r
,Ösf->ö°rumít->lo›†[j].°¨t, 
m¨k_cou¡
) ;

790 
psf
->
ö°rumít
->
lo›s
 [
j
].
íd
 = 
	`m¨kî_to_posôi⁄
 (
m¨k°r
,Ösf->ö°rumít->lo›†[j].íd, 
m¨k_cou¡
) ;

791 
psf
->
ö°rumít
->
lo›s
 [
j
].
mode
 = 
SF_LOOP_FORWARD
 ;

796 i‡(
m¨k°r
)

797 
	`‰ì
 (
m¨k°r
) ;

799 i‡(! (
found_chunk
 & 
HAVE_FORM
))

800  
SFE_AIFF_NO_FORM
 ;

802 i‡(! (
found_chunk
 & 
HAVE_AIFF
))

803  
SFE_AIFF_COMM_NO_FORM
 ;

805 i‡(! (
found_chunk
 & 
HAVE_COMM
))

806  
SFE_AIFF_SSND_NO_COMM
 ;

808 i‡(! 
psf
->
d©aoff£t
)

809  
SFE_AIFF_NO_DATA
 ;

812 
	}
}

815 
	$aiff_˛o£
 (
SF_PRIVATE
 *
psf
)

817 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

818 { 
	`aiff_wrôe_èûî
 (
psf
) ;

819 
	`aiff_wrôe_hódî
 (
psf
, 
SF_TRUE
) ;

823 
	}
}

826 
	$aiff_ªad_comm_chunk
 (
SF_PRIVATE
 *
psf
, 
COMM_CHUNK
 *
comm_fmt
)

827 { 
îr‹
 = 0, 
byã§ód
, 
subf‹m©
 ;

829 
psf
->
u
.
scbuf
 [0] = 0 ;

831 
byã§ód
 = 
	`psf_böhódî_ªadf
 (
psf
, "E4", &(
comm_fmt
->
size
)) ;

837 
comm_fmt
->
size
 += comm_fmt->size & 1 ;

839 
byã§ód
 +=

840 
	`psf_böhódî_ªadf
 (
psf
, "E242b", &(
comm_fmt
->
numCh™√ls
), &(comm_fmt->
numSam∂eFømes
),

841 &(
comm_fmt
->
ßm∂eSize
), &(comm_fmt->
ßm∂eR©e
), 
	`SIGNED_SIZEOF
 (comm_fmt->sampleRate)) ;

843 i‡(
comm_fmt
->
size
 =
SIZEOF_AIFF_COMM
)

844 
comm_fmt
->
ícodög
 = 
NONE_MARKER
 ;

845 i‡(
comm_fmt
->
size
 =
SIZEOF_AIFC_COMM_MIN
)

846 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "Em", &(
comm_fmt
->
ícodög
)) ;

847 i‡(
comm_fmt
->
size
 >
SIZEOF_AIFC_COMM
)

848 { 
ícodög_Àn
 ;

850 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "Em1", &(
comm_fmt
->
ícodög
), &
ícodög_Àn
) ;

852 
	`mem£t
 (
psf
->
u
.
scbuf
, 0, 
comm_fmt
->
size
) ;

854 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "b",Ösf->
u
.
scbuf
,

855 
comm_fmt
->
size
 - 
SIZEOF_AIFC_COMM
 + 1) ;

856 
psf
->
u
.
scbuf
 [
ícodög_Àn
] = 0 ;

859 
	`psf_log_¥ötf
 (
psf
, " COMM : %d\n", 
comm_fmt
->
size
) ;

860 
	`psf_log_¥ötf
 (
psf
, " Sam∂êR©ê: %d\n", 
	`ãnbyãÊﬂt2öt
 (
comm_fmt
->
ßm∂eR©e
)) ;

861 
	`psf_log_¥ötf
 (
psf
, " Føme† : %u%s\n", 
comm_fmt
->
numSam∂eFømes
, (comm_fmt->numSam∂eFøme†=0 &&Ösf->
fûñígth
 > 104) ? " (ShouldÇot be 0)" : "") ;

862 
	`psf_log_¥ötf
 (
psf
, " Ch™√l† : %d\n", 
comm_fmt
->
numCh™√ls
) ;

865 i‡((
comm_fmt
->
ícodög
 =
Ê32_MARKER
 || comm_fmt->ícodög =
FL32_MARKER
Ë&& comm_fmt->
ßm∂eSize
 != 32)

866 { 
	`psf_log_¥ötf
 (
psf
, " Sam∂êSizê: %d (should bê32)\n", 
comm_fmt
->
ßm∂eSize
) ;

867 
comm_fmt
->
ßm∂eSize
 = 32 ;

869 i‡((
comm_fmt
->
ícodög
 =
Ê64_MARKER
 || comm_fmt->ícodög =
FL64_MARKER
Ë&& comm_fmt->
ßm∂eSize
 != 64)

870 { 
	`psf_log_¥ötf
 (
psf
, " Sam∂êSizê: %d (should bê64)\n", 
comm_fmt
->
ßm∂eSize
) ;

871 
comm_fmt
->
ßm∂eSize
 = 64 ;

874 
	`psf_log_¥ötf
 (
psf
, " Sam∂êSizê: %d\n", 
comm_fmt
->
ßm∂eSize
) ;

876 
subf‹m©
 = 
	`s_bôwidth_to_subf‹m©
 (
comm_fmt
->
ßm∂eSize
) ;

878 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

880 
comm_fmt
->
ícodög
)

881 { 
NONE_MARKER
 :

882 
psf
->
sf
.
f‹m©
 = (
SF_FORMAT_AIFF
 | 
subf‹m©
) ;

885 
twos_MARKER
 :

886 
ö32_MARKER
 :

887 
psf
->
sf
.
f‹m©
 = (
SF_ENDIAN_BIG
 | 
SF_FORMAT_AIFF
 | 
subf‹m©
) ;

890 
sowt_MARKER
 :

891 
ni32_MARKER
 :

892 
psf
->
ídün
 = 
SF_ENDIAN_LITTLE
 ;

893 
psf
->
sf
.
f‹m©
 = (
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AIFF
 | 
subf‹m©
) ;

896 
Ê32_MARKER
 :

897 
FL32_MARKER
 :

898 
psf
->
sf
.
f‹m©
 = (
SF_FORMAT_AIFF
 | 
SF_FORMAT_FLOAT
) ;

901 
uœw_MARKER
 :

902 
ULAW_MARKER
 :

903 
psf
->
sf
.
f‹m©
 = (
SF_FORMAT_AIFF
 | 
SF_FORMAT_ULAW
) ;

906 
Æaw_MARKER
 :

907 
ALAW_MARKER
 :

908 
psf
->
sf
.
f‹m©
 = (
SF_FORMAT_AIFF
 | 
SF_FORMAT_ALAW
) ;

911 
Ê64_MARKER
 :

912 
FL64_MARKER
 :

913 
psf
->
sf
.
f‹m©
 = (
SF_FORMAT_AIFF
 | 
SF_FORMAT_DOUBLE
) ;

916 
øw_MARKER
 :

917 
psf
->
sf
.
f‹m©
 = (
SF_FORMAT_AIFF
 | 
SF_FORMAT_PCM_U8
) ;

920 
DWVW_MARKER
 :

921 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_AIFF
 ;

922 
comm_fmt
->
ßm∂eSize
)

924 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_DWVW_12
 ;

927 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_DWVW_16
 ;

930 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_DWVW_24
 ;

934 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_DWVW_N
 ;

939 
GSM_MARKER
 :

940 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_AIFF
 ;

941 
psf
->
sf
.
f‹m©
 = (
SF_FORMAT_AIFF
 | 
SF_FORMAT_GSM610
) ;

945 
ima4_MARKER
 :

946 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

947 
psf
->
sf
.
f‹m©
 = (
SF_FORMAT_AIFF
 | 
SF_FORMAT_IMA_ADPCM
) ;

951 
	`psf_log_¥ötf
 (
psf
, "AIFC : Unim∂emíãd f‹m© : %M\n", 
comm_fmt
->
ícodög
) ;

952 
îr‹
 = 
SFE_UNIMPLEMENTED
 ;

955 i‡(! 
psf
->
u
.
scbuf
 [0])

956 
	`psf_log_¥ötf
 (
psf
, " Encodög : %M\n", 
comm_fmt
->
ícodög
) ;

958 
	`psf_log_¥ötf
 (
psf
, " Encodög : %M => %s\n", 
comm_fmt
->
ícodög
,Ösf->
u
.
scbuf
) ;

960  
îr‹
 ;

961 
	}
}

965 
	$aiff_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
)

966 { 
sf_cou¡_t
 
cuºít
 ;

967 
AIFF_PRIVATE
 *
∑iff
 ;

968 
comm_ßm∂e_øã
 [10], 
comm_zîo_byãs
 [2] = { 0, 0 } ;

969 
comm_ty≥
, 
comm_size
, 
comm_ícodög
, 
comm_‰ames
 ;

970 
k
, 
ídün
 ;

971 
bô_width
 ;

973 i‡((
∑iff
 = 
psf
->
c⁄èöî_d©a
Ë=
NULL
)

974  
SFE_INTERNAL
 ;

976 
cuºít
 = 
	`psf_·ñl
 (
psf
) ;

978 i‡(
ˇlc_Àngth
)

979 { 
psf
->
fûñígth
 = 
	`psf_gë_fûñí
 (psf) ;

981 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

982 i‡(
psf
->
d©´nd
)

983 
psf
->
d©Æígth
 -psf->
fûñígth
 -Ösf->
d©´nd
 ;

985 i‡(
psf
->
byãwidth
 > 0)

986 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 / (psf->
byãwidth
 *Ösf->sf.
ch™√ls
) ;

989 i‡(
psf
->
mode
 =
SFM_RDWR
 &&Ösf->
d©aoff£t
 > 0)

997 
psf
->
hódödex
 = 0 ;

998 
	`psf_f£ek
 (
psf
, 0, 
SEEK_SET
) ;

1000 
	`psf_böhódî_wrôef
 (
psf
, "Etm8", 
FORM_MARKER
,Ösf->
fûñígth
 - 8) ;

1001 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

1004 
psf
->
hódödex
 = 0 ;

1005 
	`psf_f£ek
 (
psf
, 
∑iff
->
comm_off£t
 + 10, 
SEEK_SET
) ;

1007 
	`psf_böhódî_wrôef
 (
psf
, "Et8",Ösf->
sf
.
‰ames
) ;

1008 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

1011 
psf
->
hódödex
 = 0 ;

1012 
	`psf_f£ek
 (
psf
, 
∑iff
->
s¢d_off£t
, 
SEEK_SET
) ;

1014 
	`psf_böhódî_wrôef
 (
psf
, "Etm8", 
SSND_MARKER
,Ösf->
d©Æígth
 + 
SIZEOF_SSND_CHUNK
) ;

1015 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

1017 i‡(
cuºít
 < 
psf
->
d©aoff£t
)

1018 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
, 
SEEK_SET
) ;

1019 i‡(
cuºít
 > 0)

1020 
	`psf_f£ek
 (
psf
, 
cuºít
, 
SEEK_SET
) ;

1025 
ídün
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_ENDMASK
 ;

1026 i‡(
CPU_IS_LITTLE_ENDIAN
 && 
ídün
 =
SF_ENDIAN_CPU
)

1027 
ídün
 = 
SF_ENDIAN_LITTLE
 ;

1030 
bô_width
 = 
psf
->
byãwidth
 * 8 ;

1031 
comm_‰ames
 = (
psf
->
sf
.
‰ames
 > 0xFFFFFFFF) ? 0xFFFFFFFF :Ösf->sf.frames ;

1033 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
)

1034 { 
SF_FORMAT_PCM_S8
 :

1035 
SF_FORMAT_PCM_16
 :

1036 
SF_FORMAT_PCM_24
 :

1037 
SF_FORMAT_PCM_32
 :

1038 
ídün
)

1039 { 
SF_ENDIAN_BIG
 :

1040 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

1041 
comm_ty≥
 = 
AIFC_MARKER
 ;

1042 
comm_size
 = 
SIZEOF_AIFC_COMM
 ;

1043 
comm_ícodög
 = 
twos_MARKER
 ;

1046 
SF_ENDIAN_LITTLE
 :

1047 
psf
->
ídün
 = 
SF_ENDIAN_LITTLE
 ;

1048 
comm_ty≥
 = 
AIFC_MARKER
 ;

1049 
comm_size
 = 
SIZEOF_AIFC_COMM
 ;

1050 
comm_ícodög
 = 
sowt_MARKER
 ;

1054 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

1055 
comm_ty≥
 = 
AIFF_MARKER
 ;

1056 
comm_size
 = 
SIZEOF_AIFF_COMM
 ;

1057 
comm_ícodög
 = 0 ;

1062 
SF_FORMAT_FLOAT
 :

1063 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

1064 
comm_ty≥
 = 
AIFC_MARKER
 ;

1065 
comm_size
 = 
SIZEOF_AIFC_COMM
 ;

1066 
comm_ícodög
 = 
FL32_MARKER
 ;

1069 
SF_FORMAT_DOUBLE
 :

1070 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

1071 
comm_ty≥
 = 
AIFC_MARKER
 ;

1072 
comm_size
 = 
SIZEOF_AIFC_COMM
 ;

1073 
comm_ícodög
 = 
FL64_MARKER
 ;

1076 
SF_FORMAT_ULAW
 :

1077 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

1078 
comm_ty≥
 = 
AIFC_MARKER
 ;

1079 
comm_size
 = 
SIZEOF_AIFC_COMM
 ;

1080 
comm_ícodög
 = 
uœw_MARKER
 ;

1083 
SF_FORMAT_ALAW
 :

1084 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

1085 
comm_ty≥
 = 
AIFC_MARKER
 ;

1086 
comm_size
 = 
SIZEOF_AIFC_COMM
 ;

1087 
comm_ícodög
 = 
Æaw_MARKER
 ;

1090 
SF_FORMAT_PCM_U8
 :

1091 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

1092 
comm_ty≥
 = 
AIFC_MARKER
 ;

1093 
comm_size
 = 
SIZEOF_AIFC_COMM
 ;

1094 
comm_ícodög
 = 
øw_MARKER
 ;

1097 
SF_FORMAT_DWVW_12
 :

1098 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

1099 
comm_ty≥
 = 
AIFC_MARKER
 ;

1100 
comm_size
 = 
SIZEOF_AIFC_COMM
 ;

1101 
comm_ícodög
 = 
DWVW_MARKER
 ;

1104 
bô_width
 = 12 ;

1107 
SF_FORMAT_DWVW_16
 :

1108 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

1109 
comm_ty≥
 = 
AIFC_MARKER
 ;

1110 
comm_size
 = 
SIZEOF_AIFC_COMM
 ;

1111 
comm_ícodög
 = 
DWVW_MARKER
 ;

1114 
bô_width
 = 16 ;

1117 
SF_FORMAT_DWVW_24
 :

1118 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

1119 
comm_ty≥
 = 
AIFC_MARKER
 ;

1120 
comm_size
 = 
SIZEOF_AIFC_COMM
 ;

1121 
comm_ícodög
 = 
DWVW_MARKER
 ;

1124 
bô_width
 = 24 ;

1127 
SF_FORMAT_GSM610
 :

1128 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

1129 
comm_ty≥
 = 
AIFC_MARKER
 ;

1130 
comm_size
 = 
SIZEOF_AIFC_COMM
 ;

1131 
comm_ícodög
 = 
GSM_MARKER
 ;

1134 
bô_width
 = 16 ;

1137 
SF_FORMAT_IMA_ADPCM
 :

1138 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

1139 
comm_ty≥
 = 
AIFC_MARKER
 ;

1140 
comm_size
 = 
SIZEOF_AIFC_COMM
 ;

1141 
comm_ícodög
 = 
ima4_MARKER
 ;

1144 
bô_width
 = 16 ;

1145 
comm_‰ames
 = 
psf
->
sf
.
‰ames
 / 
AIFC_IMA4_SAMPLES_PER_BLOCK
 ;

1148  :  
SFE_BAD_OPEN_FORMAT
 ;

1152 
psf
->
hódî
 [0] = 0 ;

1153 
psf
->
hódödex
 = 0 ;

1154 
	`psf_f£ek
 (
psf
, 0, 
SEEK_SET
) ;

1156 
	`psf_böhódî_wrôef
 (
psf
, "Etm8", 
FORM_MARKER
,Ösf->
fûñígth
 - 8) ;

1159 i‡(
comm_ty≥
 =
AIFC_MARKER
)

1161 
	`psf_böhódî_wrôef
 (
psf
, "Emm44m4", 
comm_ty≥
, 
FVER_MARKER
, 4, 0xA2805140, 
COMM_MARKER
, 
comm_size
) ;

1163 
	`psf_böhódî_wrôef
 (
psf
, "Emm4", 
comm_ty≥
, 
COMM_MARKER
, 
comm_size
) ;

1165 
∑iff
->
comm_off£t
 = 
psf
->
hódödex
 - 8 ;

1167 
	`mem£t
 (
comm_ßm∂e_øã
, 0,  (comm_sample_rate)) ;

1168 
	`uöt2ãnbyãÊﬂt
 (
psf
->
sf
.
ßm∂î©e
, 
comm_ßm∂e_øã
) ;

1170 
	`psf_böhódî_wrôef
 (
psf
, "Et242",Ösf->
sf
.
ch™√ls
, 
comm_‰ames
, 
bô_width
) ;

1171 
	`psf_böhódî_wrôef
 (
psf
, "b", 
comm_ßm∂e_øã
,  (comm_sample_rate)) ;

1174 i‡(
comm_ty≥
 =
AIFC_MARKER
)

1175 
	`psf_böhódî_wrôef
 (
psf
, "mb", 
comm_ícodög
, 
comm_zîo_byãs
,  (comm_zero_bytes)) ;

1177 i‡(
psf
->
ö°rumít
 !
NULL
)

1178 { 
MARK_ID_POS
 
m
 [4] ;

1179 
INST_CHUNK
 
ch
 ;

1180 
˘
 = 0 ;

1182 
	`mem£t
 (
m
, 0,  (m)) ;

1183 
	`mem£t
 (&
ch
, 0,  (ch)) ;

1185 
ch
.
ba£NŸe
 = 
psf
->
ö°rumít
->
ba£nŸe
 ;

1186 
ch
.
dëu√
 = 
psf
->
ö°rumít
->detune ;

1187 
ch
.
lowNŸe
 = 
psf
->
ö°rumít
->
key_lo
 ;

1188 
ch
.
highNŸe
 = 
psf
->
ö°rumít
->
key_hi
 ;

1189 
ch
.
lowVñocôy
 = 
psf
->
ö°rumít
->
vñocôy_lo
 ;

1190 
ch
.
highVñocôy
 = 
psf
->
ö°rumít
->
vñocôy_hi
 ;

1191 
ch
.
gaö
 = 
psf
->
ö°rumít
->gain ;

1192 i‡(
psf
->
ö°rumít
->
lo›s
 [0].
mode
 !
SF_LOOP_NONE
)

1193 { 
ch
.
su°aö_lo›
.
∂ayMode
 = 1 ;

1194 
ch
.
su°aö_lo›
.
begöLo›
 = 
˘
 ;

1195 
m
 [0].
m¨kîID
 = 
˘
++ ;

1196 
m
 [0].
posôi⁄
 = 
psf
->
ö°rumít
->
lo›s
 [0].
°¨t
 ;

1197 
ch
.
su°aö_lo›
.
ídLo›
 = 
˘
 ;

1198 
m
 [1].
m¨kîID
 = 
˘
++ ;

1199 
m
 [1].
posôi⁄
 = 
psf
->
ö°rumít
->
lo›s
 [0].
íd
 ;

1201 i‡(
psf
->
ö°rumít
->
lo›s
 [1].
mode
 !
SF_LOOP_NONE
)

1202 { 
ch
.
ªÀa£_lo›
.
∂ayMode
 = 1 ;

1203 
ch
.
ªÀa£_lo›
.
begöLo›
 = 
˘
 ;

1204 
m
 [2].
m¨kîID
 = 
˘
++ ;

1205 
m
 [2].
posôi⁄
 = 
psf
->
ö°rumít
->
lo›s
 [1].
°¨t
 ;

1206 
ch
.
ªÀa£_lo›
.
ídLo›
 = 
˘
 ;

1207 
m
 [3].
m¨kîID
 = 
˘
++ ;

1208 
m
 [3].
posôi⁄
 = 
psf
->
ö°rumít
->
lo›s
 [1].
íd
 ;

1211 { 
ch
.
ªÀa£_lo›
.
∂ayMode
 = 0 ;

1212 
ch
.
ªÀa£_lo›
.
begöLo›
 = 0 ;

1213 
ch
.
ªÀa£_lo›
.
ídLo›
 = 0 ;

1216 
	`psf_böhódî_wrôef
 (
psf
, "Em4111111", 
INST_MARKER
, 
SIZEOF_INST_CHUNK
, 
ch
.
ba£NŸe
, ch.
dëu√
,

1217 
ch
.
lowNŸe
, ch.
highNŸe
, ch.
lowVñocôy
, ch.
highVñocôy
) ;

1218 
	`psf_böhódî_wrôef
 (
psf
, "2222222", 
ch
.
gaö
, ch.
su°aö_lo›
.
∂ayMode
,

1219 
ch
.
su°aö_lo›
.
begöLo›
, ch.su°aö_lo›.
ídLo›
, ch.
ªÀa£_lo›
.
∂ayMode
,

1220 
ch
.
ªÀa£_lo›
.
begöLo›
, ch.ªÀa£_lo›.
ídLo›
) ;

1222 i‡(
˘
 == 2)

1223 
	`psf_böhódî_wrôef
 (
psf
, "Em42241b241b",

1224 
MARK_MARKER
, 2 + 2 * (2 + 4 + 1 + 9), 2,

1225 
m
 [0].
m¨kîID
, m [0].
posôi⁄
, 8, "begÜo›", 
	`make_size_t
 (9),

1226 
m
 [1].
m¨kîID
, m [1].
posôi⁄
, 8, "ídÜo›", 
	`make_size_t
 (9)) ;

1227 i‡(
˘
 == 4)

1228 
	`psf_böhódî_wrôef
 (
psf
, "Em42 241b 241b 241b 241b",

1229 
MARK_MARKER
, 2 + 4 * (2 + 4 + 1 + 9), 4,

1230 
m
 [0].
m¨kîID
, m [0].
posôi⁄
, 8, "begÜo›", 
	`make_size_t
 (9),

1231 
m
 [1].
m¨kîID
, m [1].
posôi⁄
, 8, "ídÜo›", 
	`make_size_t
 (9),

1232 
m
 [2].
m¨kîID
, m [2].
posôi⁄
, 8, "begÜo›", 
	`make_size_t
 (9),

1233 
m
 [3].
m¨kîID
, m [3].
posôi⁄
, 8, "ídÜo›", 
	`make_size_t
 (9)) ;

1236 i‡(
psf
->
°r_Êags
 & 
SF_STR_LOCATE_START
)

1237 
	`aiff_wrôe_°rögs
 (
psf
, 
SF_STR_LOCATE_START
) ;

1239 i‡(
psf
->
≥ak_öfo
 !
NULL
 &&Ösf->≥ak_öfo->
≥ak_loc
 =
SF_PEAK_START
)

1240 { 
	`psf_böhódî_wrôef
 (
psf
, "Em4", 
PEAK_MARKER
, 
	`AIFF_PEAK_CHUNK_SIZE
 (psf->
sf
.
ch™√ls
)) ;

1241 
	`psf_böhódî_wrôef
 (
psf
, "E44", 1, 
	`time
 (
NULL
)) ;

1242 
k
 = 0 ; k < 
psf
->
sf
.
ch™√ls
 ; k++)

1243 
	`psf_böhódî_wrôef
 (
psf
, "E·8", (Ëpsf->
≥ak_öfo
->
≥aks
 [
k
].
vÆue
,Ösf->≥ak_öfo->≥ak†[k].
posôi⁄
) ;

1247 
∑iff
->
s¢d_off£t
 = 
psf
->
hódödex
 ;

1248 
	`psf_böhódî_wrôef
 (
psf
, "Etm844", 
SSND_MARKER
,Ösf->
d©Æígth
 + 
SIZEOF_SSND_CHUNK
, 0, 0) ;

1251 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

1253 i‡(
psf
->
îr‹
)

1254  
psf
->
îr‹
 ;

1256 
psf
->
d©aoff£t
 =Ösf->
hódödex
 ;

1258 i‡(
cuºít
 < 
psf
->
d©aoff£t
)

1259 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
, 
SEEK_SET
) ;

1260 i‡(
cuºít
 > 0)

1261 
	`psf_f£ek
 (
psf
, 
cuºít
, 
SEEK_SET
) ;

1263  
psf
->
îr‹
 ;

1264 
	}
}

1267 
	$aiff_wrôe_èûî
 (
SF_PRIVATE
 *
psf
)

1268 { 
k
 ;

1271 
psf
->
hódî
 [0] = 0 ;

1272 
psf
->
hódödex
 = 0 ;

1274 
psf
->
d©´nd
 = 
	`psf_f£ek
 (psf, 0, 
SEEK_END
) ;

1277 i‡(
psf
->
d©´nd
 % 2 == 1)

1278 { 
	`psf_fwrôe
 (
psf
->
hódî
, 1, 1,Ösf) ;

1279 
psf
->
d©´nd
 ++ ;

1282 i‡(
psf
->
≥ak_öfo
 !
NULL
 &&Ösf->≥ak_öfo->
≥ak_loc
 =
SF_PEAK_END
)

1283 { 
	`psf_böhódî_wrôef
 (
psf
, "Em4", 
PEAK_MARKER
, 
	`AIFF_PEAK_CHUNK_SIZE
 (psf->
sf
.
ch™√ls
)) ;

1284 
	`psf_böhódî_wrôef
 (
psf
, "E44", 1, 
	`time
 (
NULL
)) ;

1285 
k
 = 0 ; k < 
psf
->
sf
.
ch™√ls
 ; k++)

1286 
	`psf_böhódî_wrôef
 (
psf
, "E·8", (Ëpsf->
≥ak_öfo
->
≥aks
 [
k
].
vÆue
,Ösf->≥ak_öfo->≥ak†[k].
posôi⁄
) ;

1289 i‡(
psf
->
°r_Êags
 & 
SF_STR_LOCATE_END
)

1290 
	`aiff_wrôe_°rögs
 (
psf
, 
SF_STR_LOCATE_END
) ;

1293 i‡(
psf
->
hódödex
 > 0)

1294 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

1297 
	}
}

1300 
	$aiff_wrôe_°rögs
 (
SF_PRIVATE
 *
psf
, 
loˇti⁄
)

1301 { 
k
 ;

1303 
k
 = 0 ; k < 
SF_MAX_STRINGS
 ; k++)

1304 { i‡(
psf
->
°rögs
 [
k
].
ty≥
 == 0)

1307 i‡(
psf
->
°rögs
 [
k
].
Êags
 !
loˇti⁄
)

1310 
psf
->
°rögs
 [
k
].
ty≥
)

1311 { 
SF_STR_SOFTWARE
 :

1312 
	`psf_böhódî_wrôef
 (
psf
, "EmS", 
APPL_MARKER
,Ösf->
°rögs
 [
k
].
°r
) ;

1315 
SF_STR_TITLE
 :

1316 
	`psf_böhódî_wrôef
 (
psf
, "EmS", 
NAME_MARKER
,Ösf->
°rögs
 [
k
].
°r
) ;

1319 
SF_STR_COPYRIGHT
 :

1320 
	`psf_böhódî_wrôef
 (
psf
, "EmS", 
c_MARKER
,Ösf->
°rögs
 [
k
].
°r
) ;

1323 
SF_STR_ARTIST
 :

1324 
	`psf_böhódî_wrôef
 (
psf
, "EmS", 
AUTH_MARKER
,Ösf->
°rögs
 [
k
].
°r
) ;

1327 
SF_STR_COMMENT
 :

1328 
	`psf_böhódî_wrôef
 (
psf
, "EmS", 
ANNO_MARKER
,Ösf->
°rögs
 [
k
].
°r
) ;

1340 
	}
}

1343 
	$aiff_comm™d
 (
SF_PRIVATE
 *
psf
, 
comm™d
, *
d©a
, 
d©asize
)

1346 
psf
 =Ösf ;

1347 
d©a
 = data ;

1348 
d©asize
 = datasize ;

1350 
comm™d
)

1355 
	}
}

1358 
	$gë_lo›_mode_°r
 (
mode
)

1359 { 
mode
)

1366 
	}
}

1369 
	$gë_lo›_mode
 (
mode
)

1370 { 
mode
)

1371 { 0 :  
SF_LOOP_NONE
 ;

1372 1 :  
SF_LOOP_FORWARD
 ;

1373 2 :  
SF_LOOP_BACKWARD
 ;

1376  
SF_LOOP_NONE
 ;

1377 
	}
}

1389 
	$ãnbyãÊﬂt2öt
 (*
byãs
)

1390 { 
vÆ
 = 3 ;

1392 i‡(
byãs
 [0] & 0x80)

1395 i‡(
byãs
 [0] <= 0x3F)

1398 i‡(
byãs
 [0] > 0x40)

1401 i‡(
byãs
 [0] == 0x40 && bytes [1] > 0x1C)

1406 
vÆ
 = (
byãs
 [2] << 23) | (bytes [3] << 15) | (bytes [4] << 7) | (bytes [5] >> 1) ;

1408 
vÆ
 >>(29 - 
byãs
 [1]) ;

1410  
vÆ
 ;

1411 
	}
}

1414 
	$uöt2ãnbyãÊﬂt
 (
num
, *
byãs
)

1415 { 
mask
 = 0x40000000 ;

1416 
cou¡
 ;

1418 i‡(
num
 <= 1)

1419 { 
byãs
 [0] = 0x3F ;

1420 
byãs
 [1] = 0xFF ;

1421 
byãs
 [2] = 0x80 ;

1425 
byãs
 [0] = 0x40 ;

1427 i‡(
num
 >
mask
)

1428 { 
byãs
 [1] = 0x1D ;

1432 
cou¡
 = 0 ; count <= 32 ; count ++)

1433 { i‡(
num
 & 
mask
)

1435 
mask
 >>= 1 ;

1438 
num
 <<
cou¡
 + 1 ;

1439 
byãs
 [1] = 29 - 
cou¡
 ;

1440 
byãs
 [2] = (
num
 >> 24) & 0xFF ;

1441 
byãs
 [3] = (
num
 >> 16) & 0xFF ;

1442 
byãs
 [4] = (
num
 >> 8) & 0xFF ;

1443 
byãs
 [5] = 
num
 & 0xFF ;

1445 
	}
}

1448 
	$aiff_ªad_basc_chunk
 (
SF_PRIVATE
 * 
psf
, 
d©asize
)

1449 { c⁄° * 
ty≥_°r
 ;

1450 
basc_CHUNK
 
bc
 ;

1452 
	`psf_böhódî_ªadf
 (
psf
, "E442", &
bc
.
vîsi⁄
, &bc.
numBóts
, &bc.
roŸNŸe
) ;

1453 
	`psf_böhódî_ªadf
 (
psf
, "E222", &
bc
.
sˇÀTy≥
, &bc.
sigNumî©‹
, &bc.
sigDíomö©‹
) ;

1454 
	`psf_böhódî_ªadf
 (
psf
, "E2j", &
bc
.
lo›Ty≥
, 
d©asize
 -  (bc)) ;

1456 
	`psf_log_¥ötf
 (
psf
, " Version ? : %u\n Num Beats : %u\n Root Note : 0x%x\n",

1457 
bc
.
vîsi⁄
, bc.
numBóts
, bc.
roŸNŸe
) ;

1459 
bc
.
sˇÀTy≥
)

1460 { 
basc_SCALE_MINOR
 :

1461 
ty≥_°r
 = "MINOR" ;

1463 
basc_SCALE_MAJOR
 :

1464 
ty≥_°r
 = "MAJOR" ;

1466 
basc_SCALE_NEITHER
 :

1467 
ty≥_°r
 = "NEITHER" ;

1469 
basc_SCALE_BOTH
 :

1470 
ty≥_°r
 = "BOTH" ;

1473 
ty≥_°r
 = "!!WRONG!!" ;

1477 
	`psf_log_¥ötf
 (
psf
, " SˇÀTy≥ : 0x%x (%s)\n", 
bc
.
sˇÀTy≥
, 
ty≥_°r
) ;

1478 
	`psf_log_¥ötf
 (
psf
, " TimêSig : %d/%d\n", 
bc
.
sigNumî©‹
, bc.
sigDíomö©‹
) ;

1480 
bc
.
lo›Ty≥
)

1481 { 
basc_TYPE_ONE_SHOT
 :

1482 
ty≥_°r
 = "One Shot" ;

1484 
basc_TYPE_LOOP
 :

1485 
ty≥_°r
 = "Loop" ;

1488 
ty≥_°r
 = "!!WRONG!!" ;

1492 
	`psf_log_¥ötf
 (
psf
, " Lo› Ty≥ : 0x%x (%s)\n", 
bc
.
lo›Ty≥
, 
ty≥_°r
) ;

1494 i‡((
psf
->
lo›_öfo
 = 
	`ˇŒoc
 (1,  (
SF_LOOP_INFO
))Ë=
NULL
)

1495  
SFE_MALLOC_FAILED
 ;

1497 
psf
->
lo›_öfo
->
time_sig_num
 = 
bc
.
sigNumî©‹
 ;

1498 
psf
->
lo›_öfo
->
time_sig_dí
 = 
bc
.
sigDíomö©‹
 ;

1499 
psf
->
lo›_öfo
->
lo›_mode
 = (
bc
.
lo›Ty≥
 =
basc_TYPE_ONE_SHOT
Ë? 
SF_LOOP_NONE
 : 
SF_LOOP_FORWARD
 ;

1500 
psf
->
lo›_öfo
->
num_bóts
 = 
bc
.
numBóts
 ;

1503 
psf
->
lo›_öfo
->
bpm
 = (1.0 /Ösf->
sf
.
‰ames
Ë*Ösf->sf.
ßm∂î©e


1504 * ((
bc
.
numBóts
 * 4.0Ë/ bc.
sigDíomö©‹
) * 60.0 ;

1505 
psf
->
lo›_öfo
->
roŸ_key
 = 
bc
.
roŸNŸe
 ;

1508 
	}
}

	@libsndfile-1.0.17/src/alaw.c

19 
	~"¢dfûe.h
"

20 
	~"Êﬂt_ˇ°.h
"

21 
	~"comm⁄.h
"

23 
sf_cou¡_t
 
Æaw_ªad_Æaw2s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

24 
sf_cou¡_t
 
Æaw_ªad_Æaw2i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

25 
sf_cou¡_t
 
Æaw_ªad_Æaw2f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

26 
sf_cou¡_t
 
Æaw_ªad_Æaw2d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

28 
sf_cou¡_t
 
Æaw_wrôe_s2Æaw
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

29 
sf_cou¡_t
 
Æaw_wrôe_i2Æaw
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

30 
sf_cou¡_t
 
Æaw_wrôe_f2Æaw
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

31 
sf_cou¡_t
 
Æaw_wrôe_d2Æaw
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

33 
Æaw2s_¨øy
 (*
buf„r
, 
cou¡
, *
±r
) ;

34 
Æaw2i_¨øy
 (*
buf„r
, 
cou¡
, *
±r
) ;

35 
Æaw2f_¨øy
 (*
buf„r
, 
cou¡
, *
±r
, 
n‹mÁ˘
) ;

36 
Æaw2d_¨øy
 (*
buf„r
, 
cou¡
, *
±r
, 
n‹mÁ˘
) ;

38 
s2Æaw_¨øy
 (c⁄° *
buf„r
, 
cou¡
, *
±r
) ;

39 
i2Æaw_¨øy
 (c⁄° *
buf„r
, 
cou¡
, *
±r
) ;

40 
f2Æaw_¨øy
 (c⁄° *
buf„r
, 
cou¡
, *
±r
, 
n‹mÁ˘
) ;

41 
d2Æaw_¨øy
 (c⁄° *
buf„r
, 
cou¡
, *
±r
, 
n‹mÁ˘
) ;

45 
	$Æaw_öô
 (
SF_PRIVATE
 *
psf
)

47 i‡(
psf
->
mode
 =
SFM_READ
 ||Ösf->modê=
SFM_RDWR
)

48 { 
psf
->
ªad_sh‹t
 = 
Æaw_ªad_Æaw2s
 ;

49 
psf
->
ªad_öt
 = 
Æaw_ªad_Æaw2i
 ;

50 
psf
->
ªad_Êﬂt
 = 
Æaw_ªad_Æaw2f
 ;

51 
psf
->
ªad_doubÀ
 = 
Æaw_ªad_Æaw2d
 ;

54 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

55 { 
psf
->
wrôe_sh‹t
 = 
Æaw_wrôe_s2Æaw
 ;

56 
psf
->
wrôe_öt
 = 
Æaw_wrôe_i2Æaw
 ;

57 
psf
->
wrôe_Êﬂt
 = 
Æaw_wrôe_f2Æaw
 ;

58 
psf
->
wrôe_doubÀ
 = 
Æaw_wrôe_d2Æaw
 ;

61 
psf
->
byãwidth
 = 1 ;

62 
psf
->
blockwidth
 =Ösf->
sf
.
ch™√ls
 ;

64 i‡(
psf
->
fûñígth
 >Ösf->
d©aoff£t
)

65 
psf
->
d©Æígth
 = (psf->
d©´nd
Ë?Ösf->d©´nd -Ösf->
d©aoff£t
 :Ösf->
fûñígth
 -Ösf->dataoffset ;

67 
psf
->
d©Æígth
 = 0 ;

69 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 /Ösf->
blockwidth
 ;

72 
	}
}

79 
	gÆaw_decode
 [256] =

115 
	gÆaw_ícode
 [2048 + 1] =

289 
ölöe
 

290 
	$Æaw2s_¨øy
 (*
buf„r
, 
cou¡
, *
±r
)

291 { --
cou¡
 >= 0)

292 
±r
 [
cou¡
] = 
Æaw_decode
 [(Ë
buf„r
 [count]] ;

293 
	}
}

295 
ölöe
 

296 
	$Æaw2i_¨øy
 (*
buf„r
, 
cou¡
, *
±r
)

297 { --
cou¡
 >= 0)

298 
±r
 [
cou¡
] = 
Æaw_decode
 [(Ë
buf„r
 [count]] << 16 ;

299 
	}
}

301 
ölöe
 

302 
	$Æaw2f_¨øy
 (*
buf„r
, 
cou¡
, *
±r
, 
n‹mÁ˘
)

303 { --
cou¡
 >= 0)

304 
±r
 [
cou¡
] = 
n‹mÁ˘
 * 
Æaw_decode
 [(Ë
buf„r
 [count]] ;

305 
	}
}

307 
ölöe
 

308 
	$Æaw2d_¨øy
 (*
buf„r
, 
cou¡
, *
±r
, 
n‹mÁ˘
)

309 { --
cou¡
 >= 0)

310 
±r
 [
cou¡
] = 
n‹mÁ˘
 * 
Æaw_decode
 [(Ë
buf„r
 [count]] ;

311 
	}
}

313 
ölöe
 

314 
	$s2Æaw_¨øy
 (c⁄° *
±r
, 
cou¡
, *
buf„r
)

315 { --
cou¡
 >= 0)

316 { i‡(
±r
 [
cou¡
] >= 0)

317 
buf„r
 [
cou¡
] = 
Æaw_ícode
 [
±r
 [count] / 16] ;

319 
buf„r
 [
cou¡
] = 0x7F & 
Æaw_ícode
 [
±r
 [count] / -16] ;

321 
	}
}

323 
ölöe
 

324 
	$i2Æaw_¨øy
 (c⁄° *
±r
, 
cou¡
, *
buf„r
)

325 { --
cou¡
 >= 0)

326 { i‡(
±r
 [
cou¡
] >= 0)

327 
buf„r
 [
cou¡
] = 
Æaw_ícode
 [
±r
 [count] >> (16 + 4)] ;

329 
buf„r
 [
cou¡
] = 0x7F & 
Æaw_ícode
 [- 
±r
 [count] >> (16 + 4)] ;

331 
	}
}

333 
ölöe
 

334 
	$f2Æaw_¨øy
 (c⁄° *
±r
, 
cou¡
, *
buf„r
, 
n‹mÁ˘
)

335 { --
cou¡
 >= 0)

336 { i‡(
±r
 [
cou¡
] >= 0)

337 
buf„r
 [
cou¡
] = 
Æaw_ícode
 [
	`Ãötf
 (
n‹mÁ˘
 * 
±r
 [count])] ;

339 
buf„r
 [
cou¡
] = 0x7F & 
Æaw_ícode
 [- 
	`Ãötf
 (
n‹mÁ˘
 * 
±r
 [count])] ;

341 
	}
}

343 
ölöe
 

344 
	$d2Æaw_¨øy
 (c⁄° *
±r
, 
cou¡
, *
buf„r
, 
n‹mÁ˘
)

345 { --
cou¡
 >= 0)

346 { i‡(
±r
 [
cou¡
] >= 0)

347 
buf„r
 [
cou¡
] = 
Æaw_ícode
 [
	`Ãöt
 (
n‹mÁ˘
 * 
±r
 [count])] ;

349 
buf„r
 [
cou¡
] = 0x7F & 
Æaw_ícode
 [- 
	`Ãöt
 (
n‹mÁ˘
 * 
±r
 [count])] ;

351 
	}
}

356 
sf_cou¡_t


357 
	$Æaw_ªad_Æaw2s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

358 { 
buf„æí
, 
ªadcou¡
 ;

359 
sf_cou¡_t
 
tŸÆ
 = 0 ;

361 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

363 
Àn
 > 0)

364 { i‡(
Àn
 < 
buf„æí
)

365 
buf„æí
 = (Ë
Àn
 ;

366 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ucbuf
, 1, 
buf„æí
,Ösf) ;

367 
	`Æaw2s_¨øy
 (
psf
->
u
.
ucbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

368 
tŸÆ
 +
ªadcou¡
 ;

369 i‡(
ªadcou¡
 < 
buf„æí
)

371 
Àn
 -
ªadcou¡
 ;

374  
tŸÆ
 ;

375 
	}
}

377 
sf_cou¡_t


378 
	$Æaw_ªad_Æaw2i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

379 { 
buf„æí
, 
ªadcou¡
 ;

380 
sf_cou¡_t
 
tŸÆ
 = 0 ;

382 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

384 
Àn
 > 0)

385 { i‡(
Àn
 < 
buf„æí
)

386 
buf„æí
 = (Ë
Àn
 ;

387 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ucbuf
, 1, 
buf„æí
,Ösf) ;

388 
	`Æaw2i_¨øy
 (
psf
->
u
.
ucbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

389 
tŸÆ
 +
ªadcou¡
 ;

390 i‡(
ªadcou¡
 < 
buf„æí
)

392 
Àn
 -
ªadcou¡
 ;

395  
tŸÆ
 ;

396 
	}
}

398 
sf_cou¡_t


399 
	$Æaw_ªad_Æaw2f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

400 { 
buf„æí
, 
ªadcou¡
 ;

401 
sf_cou¡_t
 
tŸÆ
 = 0 ;

402 
n‹mÁ˘
 ;

404 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? 1.0 / (() 0x8000) : 1.0 ;

406 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

408 
Àn
 > 0)

409 { i‡(
Àn
 < 
buf„æí
)

410 
buf„æí
 = (Ë
Àn
 ;

411 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ucbuf
, 1, 
buf„æí
,Ösf) ;

412 
	`Æaw2f_¨øy
 (
psf
->
u
.
ucbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

413 
tŸÆ
 +
ªadcou¡
 ;

414 i‡(
ªadcou¡
 < 
buf„æí
)

416 
Àn
 -
ªadcou¡
 ;

419  
tŸÆ
 ;

420 
	}
}

422 
sf_cou¡_t


423 
	$Æaw_ªad_Æaw2d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

424 { 
buf„æí
, 
ªadcou¡
 ;

425 
sf_cou¡_t
 
tŸÆ
 = 0 ;

426 
n‹mÁ˘
 ;

428 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
) ? 1.0 / (() 0x8000) : 1.0 ;

429 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

431 
Àn
 > 0)

432 { i‡(
Àn
 < 
buf„æí
)

433 
buf„æí
 = (Ë
Àn
 ;

434 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ucbuf
, 1, 
buf„æí
,Ösf) ;

435 
	`Æaw2d_¨øy
 (
psf
->
u
.
ucbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

436 
tŸÆ
 +
ªadcou¡
 ;

437 i‡(
ªadcou¡
 < 
buf„æí
)

439 
Àn
 -
ªadcou¡
 ;

442  
tŸÆ
 ;

443 
	}
}

448 
sf_cou¡_t


449 
	$Æaw_wrôe_s2Æaw
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

450 { 
buf„æí
, 
wrôecou¡
 ;

451 
sf_cou¡_t
 
tŸÆ
 = 0 ;

453 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

455 
Àn
 > 0)

456 { i‡(
Àn
 < 
buf„æí
)

457 
buf„æí
 = (Ë
Àn
 ;

458 
	`s2Æaw_¨øy
 (
±r
 + 
tŸÆ
, 
buf„æí
, 
psf
->
u
.
ucbuf
) ;

459 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ucbuf
, 1, 
buf„æí
,Ösf) ;

460 
tŸÆ
 +
wrôecou¡
 ;

461 i‡(
wrôecou¡
 < 
buf„æí
)

463 
Àn
 -
wrôecou¡
 ;

466  
tŸÆ
 ;

467 
	}
}

469 
sf_cou¡_t


470 
	$Æaw_wrôe_i2Æaw
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

471 { 
buf„æí
, 
wrôecou¡
 ;

472 
sf_cou¡_t
 
tŸÆ
 = 0 ;

474 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

476 
Àn
 > 0)

477 { i‡(
Àn
 < 
buf„æí
)

478 
buf„æí
 = (Ë
Àn
 ;

479 
	`i2Æaw_¨øy
 (
±r
 + 
tŸÆ
, 
buf„æí
, 
psf
->
u
.
ucbuf
) ;

480 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ucbuf
, 1, 
buf„æí
,Ösf) ;

481 
tŸÆ
 +
wrôecou¡
 ;

482 i‡(
wrôecou¡
 < 
buf„æí
)

484 
Àn
 -
wrôecou¡
 ;

487  
tŸÆ
 ;

488 
	}
}

490 
sf_cou¡_t


491 
	$Æaw_wrôe_f2Æaw
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

492 { 
buf„æí
, 
wrôecou¡
 ;

493 
sf_cou¡_t
 
tŸÆ
 = 0 ;

494 
n‹mÁ˘
 ;

496 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? (1.0 * 0x7FFF) / 16.0 : 1.0 / 16 ;

498 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

500 
Àn
 > 0)

501 { i‡(
Àn
 < 
buf„æí
)

502 
buf„æí
 = (Ë
Àn
 ;

503 
	`f2Æaw_¨øy
 (
±r
 + 
tŸÆ
, 
buf„æí
, 
psf
->
u
.
ucbuf
, 
n‹mÁ˘
) ;

504 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ucbuf
, 1, 
buf„æí
,Ösf) ;

505 
tŸÆ
 +
wrôecou¡
 ;

506 i‡(
wrôecou¡
 < 
buf„æí
)

508 
Àn
 -
wrôecou¡
 ;

511  
tŸÆ
 ;

512 
	}
}

514 
sf_cou¡_t


515 
	$Æaw_wrôe_d2Æaw
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

516 { 
buf„æí
, 
wrôecou¡
 ;

517 
sf_cou¡_t
 
tŸÆ
 = 0 ;

518 
n‹mÁ˘
 ;

520 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
) ? (1.0 * 0x7FFF) / 16.0 : 1.0 / 16.0 ;

522 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

524 
Àn
 > 0)

525 { i‡(
Àn
 < 
buf„æí
)

526 
buf„æí
 = (Ë
Àn
 ;

527 
	`d2Æaw_¨øy
 (
±r
 + 
tŸÆ
, 
buf„æí
, 
psf
->
u
.
ucbuf
, 
n‹mÁ˘
) ;

528 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ucbuf
, 1, 
buf„æí
,Ösf) ;

529 
tŸÆ
 +
wrôecou¡
 ;

530 i‡(
wrôecou¡
 < 
buf„æí
)

532 
Àn
 -
wrôecou¡
 ;

535  
tŸÆ
 ;

536 
	}
}

	@libsndfile-1.0.17/src/au.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<f˙é.h
>

23 
	~<°rög.h
>

24 
	~<˘y≥.h
>

26 
	~"¢dfûe.h
"

27 
	~"s„ndün.h
"

28 
	~"comm⁄.h
"

34 
	#DOTSND_MARKER
 (
	`MAKE_MARKER
 ('.', 's', 'n', 'd'))

	)

35 
	#DNSDOT_MARKER
 (
	`MAKE_MARKER
 ('d', 'n', 's', '.'))

	)

37 
	#AU_DATA_OFFSET
 24

	)

44 { 
	mAU_ENCODING_ULAW_8
 = 1,

45 
	mAU_ENCODING_PCM_8
 = 2,

46 
	mAU_ENCODING_PCM_16
 = 3,

47 
	mAU_ENCODING_PCM_24
 = 4,

48 
	mAU_ENCODING_PCM_32
 = 5,

50 
	mAU_ENCODING_FLOAT
 = 6,

51 
	mAU_ENCODING_DOUBLE
 = 7,

52 
	mAU_ENCODING_INDIRECT
 = 8,

53 
	mAU_ENCODING_NESTED
 = 9,

54 
	mAU_ENCODING_DSP_CORE
 = 10,

55 
	mAU_ENCODING_DSP_DATA_8
 = 11,

56 
	mAU_ENCODING_DSP_DATA_16
 = 12,

57 
	mAU_ENCODING_DSP_DATA_24
 = 13,

58 
	mAU_ENCODING_DSP_DATA_32
 = 14,

60 
	mAU_ENCODING_DISPLAY
 = 16,

61 
	mAU_ENCODING_MULAW_SQUELCH
 = 17,

62 
	mAU_ENCODING_EMPHASIZED
 = 18,

63 
	mAU_ENCODING_NEXT
 = 19,

64 
	mAU_ENCODING_COMPRESSED_EMPHASIZED
 = 20,

65 
	mAU_ENCODING_DSP_COMMANDS
 = 21,

66 
	mAU_ENCODING_DSP_COMMANDS_SAMPLES
 = 22,

68 
	mAU_ENCODING_ADPCM_G721_32
 = 23,

69 
	mAU_ENCODING_ADPCM_G722
 = 24,

70 
	mAU_ENCODING_ADPCM_G723_24
 = 25,

71 
	mAU_ENCODING_ADPCM_G723_40
 = 26,

73 
	mAU_ENCODING_ALAW_8
 = 27

81 { 
	md©aoff£t
 ;

82 
	md©asize
 ;

83 
	mícodög
 ;

84 
	mßm∂î©e
 ;

85 
	mch™√ls
 ;

86 } 
	tAU_FMT
 ;

93 
au_˛o£
 (
SF_PRIVATE
 *
psf
) ;

95 
au_f‹m©_to_ícodög
 (
f‹m©
) ;

97 
au_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
) ;

98 
au_ªad_hódî
 (
SF_PRIVATE
 *
psf
) ;

105 
	$au_›í
 (
SF_PRIVATE
 *
psf
)

106 { 
subf‹m©
 ;

107 
îr‹
 = 0 ;

109 i‡(
psf
->
mode
 =
SFM_READ
 || (psf->modê=
SFM_RDWR
 &&Ösf->
fûñígth
 > 0))

110 { i‡((
îr‹
 = 
	`au_ªad_hódî
 (
psf
)))

111  
îr‹
 ;

114 i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_AU
)

115  
SFE_BAD_OPEN_FORMAT
 ;

117 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

119 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

120 { 
psf
->
ídün
 =Ösf->
sf
.
f‹m©
 & 
SF_FORMAT_ENDMASK
 ;

121 i‡(
CPU_IS_LITTLE_ENDIAN
 && 
psf
->
ídün
 =
SF_ENDIAN_CPU
)

122 
psf
->
ídün
 = 
SF_ENDIAN_LITTLE
 ;

123 i‡(
psf
->
ídün
 !
SF_ENDIAN_LITTLE
)

124 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

126 i‡(
	`au_wrôe_hódî
 (
psf
, 
SF_FALSE
))

127  
psf
->
îr‹
 ;

129 
psf
->
wrôe_hódî
 = 
au_wrôe_hódî
 ;

132 
psf
->
c⁄èöî_˛o£
 = 
au_˛o£
 ;

134 
psf
->
blockwidth
 =Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

136 
subf‹m©
)

137 { 
SF_FORMAT_ULAW
 :

138 
	`uœw_öô
 (
psf
) ;

141 
SF_FORMAT_PCM_S8
 :

142 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

145 
SF_FORMAT_PCM_16
 :

146 
SF_FORMAT_PCM_24
 :

147 
SF_FORMAT_PCM_32
 :

148 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

151 
SF_FORMAT_ALAW
 :

152 
	`Æaw_öô
 (
psf
) ;

156 
SF_FORMAT_FLOAT
 :

157 
îr‹
 = 
	`Êﬂt32_öô
 (
psf
) ;

160 
SF_FORMAT_DOUBLE
 :

161 
îr‹
 = 
	`doubÀ64_öô
 (
psf
) ;

164 
SF_FORMAT_G721_32
 :

165 
îr‹
 = 
	`g72x_öô
 (
psf
) ;

166 
psf
->
sf
.
£ekabÀ
 = 
SF_FALSE
 ;

169 
SF_FORMAT_G723_24
 :

170 
îr‹
 = 
	`g72x_öô
 (
psf
) ;

171 
psf
->
sf
.
£ekabÀ
 = 
SF_FALSE
 ;

174 
SF_FORMAT_G723_40
 :

175 
îr‹
 = 
	`g72x_öô
 (
psf
) ;

176 
psf
->
sf
.
£ekabÀ
 = 
SF_FALSE
 ;

183  
îr‹
 ;

184 
	}
}

190 
	$au_˛o£
 (
SF_PRIVATE
 *
psf
)

192 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

193 
	`au_wrôe_hódî
 (
psf
, 
SF_TRUE
) ;

196 
	}
}

199 
	$au_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
)

200 { 
sf_cou¡_t
 
cuºít
 ;

201 
ícodög
, 
d©Æígth
 ;

203 i‡(
psf
->
pùeoff£t
 > 0)

206 
cuºít
 = 
	`psf_·ñl
 (
psf
) ;

208 i‡(
ˇlc_Àngth
)

209 { 
psf
->
fûñígth
 = 
	`psf_gë_fûñí
 (psf) ;

211 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

212 i‡(
psf
->
d©´nd
)

213 
psf
->
d©Æígth
 -psf->
fûñígth
 -Ösf->
d©´nd
 ;

215 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 / (psf->
byãwidth
 *Ösf->sf.
ch™√ls
) ;

218 
ícodög
 = 
	`au_f‹m©_to_ícodög
 (
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
) ;

219 i‡(! 
ícodög
)

220  (
psf
->
îr‹
 = 
SFE_BAD_OPEN_FORMAT
) ;

223 
psf
->
hódî
 [0] = 0 ;

224 
psf
->
hódödex
 = 0 ;

230 i‡(
psf
->
is_pùe
 =
SF_FALSE
)

231 
	`psf_f£ek
 (
psf
, 0, 
SEEK_SET
) ;

238 i‡(
psf
->
d©Æígth
 < 0 ||Ösf->datalength > 0x7FFFFFFF)

239 
d©Æígth
 = -1 ;

241 
d©Æígth
 = (Ë(
psf
->datalength & 0x7FFFFFFF) ;

243 i‡(
psf
->
ídün
 =
SF_ENDIAN_BIG
)

244 { 
	`psf_böhódî_wrôef
 (
psf
, "Em4", 
DOTSND_MARKER
, 
AU_DATA_OFFSET
) ;

245 
	`psf_böhódî_wrôef
 (
psf
, "E4444", 
d©Æígth
, 
ícodög
,Ösf->
sf
.
ßm∂î©e
,Ösf->sf.
ch™√ls
) ;

247 i‡(
psf
->
ídün
 =
SF_ENDIAN_LITTLE
)

248 { 
	`psf_böhódî_wrôef
 (
psf
, "em4", 
DNSDOT_MARKER
, 
AU_DATA_OFFSET
) ;

249 
	`psf_böhódî_wrôef
 (
psf
, "e4444", 
d©Æígth
, 
ícodög
,Ösf->
sf
.
ßm∂î©e
,Ösf->sf.
ch™√ls
) ;

252  (
psf
->
îr‹
 = 
SFE_BAD_OPEN_FORMAT
) ;

255 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

257 i‡(
psf
->
îr‹
)

258  
psf
->
îr‹
 ;

260 
psf
->
d©aoff£t
 =Ösf->
hódödex
 ;

262 i‡(
cuºít
 > 0)

263 
	`psf_f£ek
 (
psf
, 
cuºít
, 
SEEK_SET
) ;

265  
psf
->
îr‹
 ;

266 
	}
}

269 
	$au_f‹m©_to_ícodög
 (
f‹m©
)

271 
f‹m©
)

272 { 
SF_FORMAT_PCM_S8
 :  
AU_ENCODING_PCM_8
 ;

273 
SF_FORMAT_PCM_16
 :  
AU_ENCODING_PCM_16
 ;

274 
SF_FORMAT_PCM_24
 :  
AU_ENCODING_PCM_24
 ;

275 
SF_FORMAT_PCM_32
 :  
AU_ENCODING_PCM_32
 ;

277 
SF_FORMAT_FLOAT
 :  
AU_ENCODING_FLOAT
 ;

278 
SF_FORMAT_DOUBLE
 :  
AU_ENCODING_DOUBLE
 ;

280 
SF_FORMAT_ULAW
 :  
AU_ENCODING_ULAW_8
 ;

281 
SF_FORMAT_ALAW
 :  
AU_ENCODING_ALAW_8
 ;

283 
SF_FORMAT_G721_32
 :  
AU_ENCODING_ADPCM_G721_32
 ;

284 
SF_FORMAT_G723_24
 :  
AU_ENCODING_ADPCM_G723_24
 ;

285 
SF_FORMAT_G723_40
 :  
AU_ENCODING_ADPCM_G723_40
 ;

290 
	}
}

293 
	$au_ªad_hódî
 (
SF_PRIVATE
 *
psf
)

294 { 
AU_FMT
 
au_fmt
 ;

295 
m¨kî
, 
dw‹d
 ;

297 
	`mem£t
 (&
au_fmt
, 0,  (au_fmt)) ;

298 
	`psf_böhódî_ªadf
 (
psf
, "pm", 0, &
m¨kî
) ;

299 
	`psf_log_¥ötf
 (
psf
, "%M\n", 
m¨kî
) ;

301 i‡(
m¨kî
 =
DOTSND_MARKER
)

302 { 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

304 
	`psf_böhódî_ªadf
 (
psf
, "E44444", &(
au_fmt
.
d©aoff£t
), &◊u_fmt.
d©asize
),

305 &(
au_fmt
.
ícodög
), &◊u_fmt.
ßm∂î©e
), &◊u_fmt.
ch™√ls
)) ;

307 i‡(
m¨kî
 =
DNSDOT_MARKER
)

308 { 
psf
->
ídün
 = 
SF_ENDIAN_LITTLE
 ;

309 
	`psf_böhódî_ªadf
 (
psf
, "e44444", &(
au_fmt
.
d©aoff£t
), &◊u_fmt.
d©asize
),

310 &(
au_fmt
.
ícodög
), &◊u_fmt.
ßm∂î©e
), &◊u_fmt.
ch™√ls
)) ;

313  
SFE_AU_NO_DOTSND
 ;

315 
	`psf_log_¥ötf
 (
psf
, " D©®Off£à: %d\n", 
au_fmt
.
d©aoff£t
) ;

317 i‡(
psf
->
fûeoff£t
 > 0 && 
au_fmt
.
d©asize
 == -1)

318 { 
	`psf_log_¥ötf
 (
psf
, " Data Size : -1\n") ;

319  
SFE_AU_EMBED_BAD_LEN
 ;

322 i‡(
psf
->
fûeoff£t
 > 0)

323 { 
psf
->
fûñígth
 = 
au_fmt
.
d©aoff£t
 +áu_fmt.
d©asize
 ;

324 
	`psf_log_¥ötf
 (
psf
, " D©®Sizê : %d\n", 
au_fmt
.
d©asize
) ;

326 i‡(
au_fmt
.
d©asize
 =-1 ||áu_fmt.
d©aoff£t
 +áu_fmt.d©asizê=
psf
->
fûñígth
)

327 
	`psf_log_¥ötf
 (
psf
, " D©®Sizê : %d\n", 
au_fmt
.
d©asize
) ;

328 i‡(
au_fmt
.
d©aoff£t
 +áu_fmt.
d©asize
 < 
psf
->
fûñígth
)

329 { 
psf
->
fûñígth
 = 
au_fmt
.
d©aoff£t
 +áu_fmt.
d©asize
 ;

330 
	`psf_log_¥ötf
 (
psf
, " D©®Sizê : %d\n", 
au_fmt
.
d©asize
) ;

333 { 
dw‹d
 = 
psf
->
fûñígth
 - 
au_fmt
.
d©aoff£t
 ;

334 
	`psf_log_¥ötf
 (
psf
, " D©®Sizê : %d (should bê%d)\n", 
au_fmt
.
d©asize
, 
dw‹d
) ;

335 
au_fmt
.
d©asize
 = 
dw‹d
 ;

338 
psf
->
d©aoff£t
 = 
au_fmt
.dataoffset ;

339 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

341 i‡(
	`psf_·ñl
 (
psf
Ë<Ösf->
d©aoff£t
)

342 
	`psf_böhódî_ªadf
 (
psf
, "j",Ösf->
d©aoff£t
 - 
	`psf_·ñl
 (psf)) ;

344 
psf
->
sf
.
ßm∂î©e
 = 
au_fmt
.samplerate ;

345 
psf
->
sf
.
ch™√ls
 = 
au_fmt
.channels ;

348 i‡(
psf
->
ídün
 =
SF_ENDIAN_BIG
)

349 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_AU
 ;

350 i‡(
psf
->
ídün
 =
SF_ENDIAN_LITTLE
)

351 
psf
->
sf
.
f‹m©
 = 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 ;

353 
	`psf_log_¥ötf
 (
psf
, " Encodög : %d => ", 
au_fmt
.
ícodög
) ;

355 
psf
->
sf
.
f‹m©
 =Ösf->sf.f‹m© & 
SF_FORMAT_ENDMASK
 ;

357 
au_fmt
.
ícodög
)

358 { 
AU_ENCODING_ULAW_8
 :

359 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_AU
 | 
SF_FORMAT_ULAW
 ;

360 
psf
->
byãwidth
 = 1 ;

361 
	`psf_log_¥ötf
 (
psf
, "8-bit ISDN u-law\n") ;

364 
AU_ENCODING_PCM_8
 :

365 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_S8
 ;

366 
psf
->
byãwidth
 = 1 ;

367 
	`psf_log_¥ötf
 (
psf
, "8-bitÜinear PCM\n") ;

370 
AU_ENCODING_PCM_16
 :

371 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_16
 ;

372 
psf
->
byãwidth
 = 2 ;

373 
	`psf_log_¥ötf
 (
psf
, "16-bitÜinear PCM\n") ;

376 
AU_ENCODING_PCM_24
 :

377 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_24
 ;

378 
psf
->
byãwidth
 = 3 ;

379 
	`psf_log_¥ötf
 (
psf
, "24-bitÜinear PCM\n") ;

382 
AU_ENCODING_PCM_32
 :

383 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_32
 ;

384 
psf
->
byãwidth
 = 4 ;

385 
	`psf_log_¥ötf
 (
psf
, "32-bitÜinear PCM\n") ;

388 
AU_ENCODING_FLOAT
 :

389 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_AU
 | 
SF_FORMAT_FLOAT
 ;

390 
psf
->
byãwidth
 = 4 ;

391 
	`psf_log_¥ötf
 (
psf
, "32-bit float\n") ;

394 
AU_ENCODING_DOUBLE
 :

395 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_AU
 | 
SF_FORMAT_DOUBLE
 ;

396 
psf
->
byãwidth
 = 8 ;

397 
	`psf_log_¥ötf
 (
psf
, "64-bit doubleÖrecision float\n") ;

400 
AU_ENCODING_ALAW_8
 :

401 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_AU
 | 
SF_FORMAT_ALAW
 ;

402 
psf
->
byãwidth
 = 1 ;

403 
	`psf_log_¥ötf
 (
psf
, "8-bit ISDN A-law\n") ;

406 
AU_ENCODING_ADPCM_G721_32
 :

407 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_AU
 | 
SF_FORMAT_G721_32
 ;

408 
psf
->
byãwidth
 = 0 ;

409 
	`psf_log_¥ötf
 (
psf
, "G721 32kbs ADPCM\n") ;

412 
AU_ENCODING_ADPCM_G723_24
 :

413 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_AU
 | 
SF_FORMAT_G723_24
 ;

414 
psf
->
byãwidth
 = 0 ;

415 
	`psf_log_¥ötf
 (
psf
, "G723 24kbs ADPCM\n") ;

418 
AU_ENCODING_ADPCM_G723_40
 :

419 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_AU
 | 
SF_FORMAT_G723_40
 ;

420 
psf
->
byãwidth
 = 0 ;

421 
	`psf_log_¥ötf
 (
psf
, "G723 40kbs ADPCM\n") ;

424 
AU_ENCODING_ADPCM_G722
 :

425 
	`psf_log_¥ötf
 (
psf
, "G722 64 kbs ADPCM (unsupported)\n") ;

428 
AU_ENCODING_NEXT
 :

429 
	`psf_log_¥ötf
 (
psf
, "Weird NeXTÉncoding format (unsupported)\n") ;

433 
	`psf_log_¥ötf
 (
psf
, "Unknown!!\n") ;

437 
	`psf_log_¥ötf
 (
psf
, " Sam∂êR©ê: %d\n", 
au_fmt
.
ßm∂î©e
) ;

438 
	`psf_log_¥ötf
 (
psf
, " Ch™√l† : %d\n", 
au_fmt
.
ch™√ls
) ;

440 
psf
->
blockwidth
 =Ösf->
sf
.
ch™√ls
 *Ösf->
byãwidth
 ;

442 i‡(! 
psf
->
sf
.
‰ames
 &&Ösf->
blockwidth
)

443 
psf
->
sf
.
‰ames
 = (psf->
fûñígth
 -Ösf->
d©aoff£t
Ë/Ösf->
blockwidth
 ;

446 
	}
}

	@libsndfile-1.0.17/src/avr.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°rög.h
>

24 
	~"¢dfûe.h
"

25 
	~"s„ndün.h
"

26 
	~"comm⁄.h
"

28 
	#TWOBIT_MARKER
 (
	`MAKE_MARKER
 ('2', 'B', 'I', 'T'))

	)

29 
	#AVR_HDR_SIZE
 128

	)

31 
	#SFE_AVR_X
 666

	)

43 { 
	mm¨kî
 ;

44 
	m«me
 [8] ;

45 
	mm⁄o
 ;

46 
	mªz
 ;

47 
	msign
 ;

49 
	mlo›
 ;

50 
	mmidi
 ;

53 
	m§©e
 ;

54 
	m‰ames
 ;

55 
	mlbeg
 ;

57 
	mÀnd
 ;

59 
	mªs1
 ;

60 
	mªs2
 ;

61 
	mªs3
 ;

62 
	mext
 [20] ;

63 
	mu£r
 [64] ;

64 } 
	tAVR_HEADER
 ;

70 
avr_˛o£
 (
SF_PRIVATE
 *
psf
) ;

72 
avr_ªad_hódî
 (
SF_PRIVATE
 *
psf
) ;

73 
avr_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
) ;

80 
	$avr_›í
 (
SF_PRIVATE
 *
psf
)

81 { 
îr‹
 = 0 ;

83 i‡(
psf
->
mode
 =
SFM_READ
 || (psf->modê=
SFM_RDWR
 &&Ösf->
fûñígth
 > 0))

84 { i‡((
îr‹
 = 
	`avr_ªad_hódî
 (
psf
)))

85  
îr‹
 ;

88 i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_AVR
)

89  
SFE_BAD_OPEN_FORMAT
 ;

91 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

92 { 
psf
->
ídün
 =Ösf->
sf
.
f‹m©
 & 
SF_FORMAT_ENDMASK
 ;

93 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

95 i‡(
	`avr_wrôe_hódî
 (
psf
, 
SF_FALSE
))

96  
psf
->
îr‹
 ;

98 
psf
->
wrôe_hódî
 = 
avr_wrôe_hódî
 ;

101 
psf
->
c⁄èöî_˛o£
 = 
avr_˛o£
 ;

103 
psf
->
blockwidth
 =Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

105 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

107  
îr‹
 ;

108 
	}
}

111 
	$avr_ªad_hódî
 (
SF_PRIVATE
 *
psf
)

112 { 
AVR_HEADER
 
hdr
 ;

114 
	`mem£t
 (&
hdr
, 0,  (hdr)) ;

116 
	`psf_böhódî_ªadf
 (
psf
, "pmb", 0, &
hdr
.
m¨kî
, &hdr.
«me
,  (hdr.name)) ;

117 
	`psf_log_¥ötf
 (
psf
, "%M\n", 
hdr
.
m¨kî
) ;

119 i‡(
hdr
.
m¨kî
 !
TWOBIT_MARKER
)

120  
SFE_AVR_X
 ;

122 
	`psf_log_¥ötf
 (
psf
, " Namê : %s\n", 
hdr
.
«me
) ;

124 
	`psf_böhódî_ªadf
 (
psf
, "E22222", &
hdr
.
m⁄o
, &hdr.
ªz
, &hdr.
sign
, &hdr.
lo›
, &hdr.
midi
) ;

126 
psf
->
sf
.
ch™√ls
 = (
hdr
.
m⁄o
 & 1) + 1 ;

128 
	`psf_log_¥ötf
 (
psf
, " Channels : %d\n Bit width : %d\n Signed : %s\n",

129 (
hdr
.
m⁄o
 & 1Ë+ 1, hdr.
ªz
, hdr.
sign
 ? "yes" : "no") ;

131 (
hdr
.
ªz
 << 16Ë+ (hdr.
sign
 & 1))

133 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_AVR
 | 
SF_FORMAT_PCM_U8
 ;

134 
psf
->
byãwidth
 = 1 ;

138 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_AVR
 | 
SF_FORMAT_PCM_S8
 ;

139 
psf
->
byãwidth
 = 1 ;

143 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_AVR
 | 
SF_FORMAT_PCM_16
 ;

144 
psf
->
byãwidth
 = 2 ;

148 
	`psf_log_¥ötf
 (
psf
, "Error : badÑez/sign combination.\n") ;

149  
SFE_AVR_X
 ;

152 
	`psf_böhódî_ªadf
 (
psf
, "E4444", &
hdr
.
§©e
, &hdr.
‰ames
, &hdr.
lbeg
, &hdr.
Ànd
) ;

154 
psf
->
sf
.
‰ames
 = 
hdr
.frames ;

155 
psf
->
sf
.
ßm∂î©e
 = 
hdr
.
§©e
 ;

157 
	`psf_log_¥ötf
 (
psf
, " Føme† : %D\n",Ösf->
sf
.
‰ames
) ;

158 
	`psf_log_¥ötf
 (
psf
, " Sam∂êøã : %d\n",Ösf->
sf
.
ßm∂î©e
) ;

160 
	`psf_böhódî_ªadf
 (
psf
, "E222", &
hdr
.
ªs1
, &hdr.
ªs2
, &hdr.
ªs3
) ;

161 
	`psf_böhódî_ªadf
 (
psf
, "bb", 
hdr
.
ext
,  (hdr.ext), hdr.
u£r
,  (hdr.user)) ;

163 
	`psf_log_¥ötf
 (
psf
, " Exà : %s\¿ U£∏ : %s\n", 
hdr
.
ext
, hdr.
u£r
) ;

165 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

167 
psf
->
d©aoff£t
 = 
AVR_HDR_SIZE
 ;

168 
psf
->
d©Æígth
 = 
hdr
.
‰ames
 * (hdr.
ªz
 / 8) ;

170 i‡(
psf
->
fûeoff£t
 > 0)

171 
psf
->
fûñígth
 = 
AVR_HDR_SIZE
 +Ösf->
d©Æígth
 ;

173 i‡(
	`psf_·ñl
 (
psf
Ë!psf->
d©aoff£t
)

174 
	`psf_böhódî_ªadf
 (
psf
, "j",Ösf->
d©aoff£t
 - 
	`psf_·ñl
 (psf)) ;

176 
psf
->
blockwidth
 =Ösf->
sf
.
ch™√ls
 *Ösf->
byãwidth
 ;

178 i‡(
psf
->
sf
.
‰ames
 =0 &&Ösf->
blockwidth
)

179 
psf
->
sf
.
‰ames
 = (psf->
fûñígth
 -Ösf->
d©aoff£t
Ë/Ösf->
blockwidth
 ;

182 
	}
}

185 
	$avr_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
)

186 { 
sf_cou¡_t
 
cuºít
 ;

187 
sign
 ;

189 i‡(
psf
->
pùeoff£t
 > 0)

192 
cuºít
 = 
	`psf_·ñl
 (
psf
) ;

194 i‡(
ˇlc_Àngth
)

195 { 
psf
->
fûñígth
 = 
	`psf_gë_fûñí
 (psf) ;

197 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

198 i‡(
psf
->
d©´nd
)

199 
psf
->
d©Æígth
 -psf->
fûñígth
 -Ösf->
d©´nd
 ;

201 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 / (psf->
byãwidth
 *Ösf->sf.
ch™√ls
) ;

205 
psf
->
hódî
 [0] = 0 ;

206 
psf
->
hódödex
 = 0 ;

212 i‡(
psf
->
is_pùe
 =
SF_FALSE
)

213 
	`psf_f£ek
 (
psf
, 0, 
SEEK_SET
) ;

215 
	`psf_böhódî_wrôef
 (
psf
, "Emz22", 
TWOBIT_MARKER
, 
	`make_size_t
 (8),

216 
psf
->
sf
.
ch™√ls
 =2 ? 0xFFFF : 0,Ösf->
byãwidth
 * 8) ;

218 
sign
 = ((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_PCM_U8
) ? 0 : 0xFFFF ;

220 
	`psf_böhódî_wrôef
 (
psf
, "E222", 
sign
, 0, 0xFFFF) ;

221 
	`psf_böhódî_wrôef
 (
psf
, "E4444",Ösf->
sf
.
ßm∂î©e
,Ösf->sf.
‰ames
, 0, 0) ;

223 
	`psf_böhódî_wrôef
 (
psf
, "E222zz", 0, 0, 0, 
	`make_size_t
 (20), make_size_t (64)) ;

226 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

228 i‡(
psf
->
îr‹
)

229  
psf
->
îr‹
 ;

231 
psf
->
d©aoff£t
 =Ösf->
hódödex
 ;

233 i‡(
cuºít
 > 0)

234 
	`psf_f£ek
 (
psf
, 
cuºít
, 
SEEK_SET
) ;

236  
psf
->
îr‹
 ;

237 
	}
}

240 
	$avr_˛o£
 (
SF_PRIVATE
 *
psf
)

242 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

243 
	`avr_wrôe_hódî
 (
psf
, 
SF_TRUE
) ;

246 
	}
}

	@libsndfile-1.0.17/src/broadcast.c

20 
	~<°dio.h
>

21 
	~<°rög.h
>

23 
	~"comm⁄.h
"

29 
SF_BROADCAST_INFO
*

30 
	$brﬂdˇ°_öfo_Æloc
 ()

31 { 
SF_BROADCAST_INFO
* 
bext
 ;

33 i‡((
bext
 = 
	`ˇŒoc
 (1,  (
SF_BROADCAST_INFO
))Ë=
NULL
)

34  
NULL
 ;

36  
bext
 ;

37 
	}
}

40 
	$brﬂdˇ°_öfo_c›y
 (
SF_BROADCAST_INFO
* 
d°
, SF_BROADCAST_INFO* 
§c
)

41 { 
	`mem˝y
 (
d°
, 
§c
,  (
SF_BROADCAST_INFO
)) ;

44 
d°
->
vîsi⁄
 = 1 ;

46  
SF_TRUE
 ;

47 
	}
}

50 
	$brﬂdˇ°_add_codög_hi°‹y
 (
SF_BROADCAST_INFO
* 
bext
, 
ch™√ls
, 
ßm∂î©e
)

51 { 
chn°r
 [16] ;

52 
cou¡
 ;

54 
ch™√ls
)

56  
SF_FALSE
 ;

59 
	`°∫˝y
 (
chn°r
, "mono",  (chnstr)) ;

63 
	`°∫˝y
 (
chn°r
, "stereo",  (chnstr)) ;

67 
	`LSF_SNPRINTF
 (
chn°r
,  (chn°r), "%uchn", 
ch™√ls
) ;

71 
cou¡
 = 
	`LSF_SNPRINTF
 (
bext
->
codög_hi°‹y
,  (bext->codög_hi°‹y), "F=%u,A=PCM,M=%s,W=24,T=%s-%s", 
ßm∂î©e
, 
chn°r
, 
PACKAGE
, 
VERSION
) ;

73 i‡(
cou¡
 >
	`SIGNED_SIZEOF
 (
bext
->
codög_hi°‹y
))

74 
bext
->
codög_hi°‹y_size
 =  (bext->
codög_hi°‹y
) ;

76 { 
cou¡
 += count & 1 ;

77 
bext
->
codög_hi°‹y_size
 = 
cou¡
 ;

80  
SF_TRUE
 ;

81 
	}
}

	@libsndfile-1.0.17/src/caf.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

24 
	~<˘y≥.h
>

26 
	~"¢dfûe.h
"

27 
	~"s„ndün.h
"

28 
	~"Êﬂt_ˇ°.h
"

29 
	~"comm⁄.h
"

35 
	#Øc_MARKER
 
	`MAKE_MARKER
 ('a', 'a', 'c', ' ')

	)

36 
	#Æac_MARKER
 
	`MAKE_MARKER
 ('a', 'l', 'a', 'c')

	)

37 
	#Æaw_MARKER
 
	`MAKE_MARKER
 ('a', 'l', 'a', 'w')

	)

38 
	#ˇff_MARKER
 
	`MAKE_MARKER
 ('c', 'a', 'f', 'f')

	)

39 
	#ch™_MARKER
 
	`MAKE_MARKER
 ('c', 'h', 'a', 'n')

	)

40 
	#d©a_MARKER
 
	`MAKE_MARKER
 ('d', 'a', 't', 'a')

	)

41 
	#desc_MARKER
 
	`MAKE_MARKER
 ('d', 'e', 's', 'c')

	)

42 
	#ed˘_MARKER
 
	`MAKE_MARKER
 ('e', 'd', 'c', 't')

	)

43 
	#‰ì_MARKER
 
	`MAKE_MARKER
 ('f', 'r', 'e', 'e')

	)

44 
	#ima4_MARKER
 
	`MAKE_MARKER
 ('i', 'm', 'a', '4')

	)

45 
	#öfo_MARKER
 
	`MAKE_MARKER
 ('i', 'n', 'f', 'o')

	)

46 
	#ö°_MARKER
 
	`MAKE_MARKER
 ('i', 'n', 's', 't')

	)

47 
	#kuki_MARKER
 
	`MAKE_MARKER
 ('k', 'u', 'k', 'i')

	)

48 
	#Õcm_MARKER
 
	`MAKE_MARKER
 ('l', 'p', 'c', 'm')

	)

49 
	#m¨k_MARKER
 
	`MAKE_MARKER
 ('m', 'a', 'r', 'k')

	)

50 
	#midi_MARKER
 
	`MAKE_MARKER
 ('m', 'i', 'd', 'i')

	)

51 
	#mp1_MARKER
 
	`MAKE_MARKER
 ('.', 'm', 'p', '1')

	)

52 
	#mp2_MARKER
 
	`MAKE_MARKER
 ('.', 'm', 'p', '2')

	)

53 
	#mp3_MARKER
 
	`MAKE_MARKER
 ('.', 'm', 'p', '3')

	)

54 
	#ovvw_MARKER
 
	`MAKE_MARKER
 ('o', 'v', 'v', 'w')

	)

55 
	#∑kt_MARKER
 
	`MAKE_MARKER
 ('p', 'a', 'k', 't')

	)

56 
	#≥ak_MARKER
 
	`MAKE_MARKER
 ('p', 'e', 'a', 'k')

	)

57 
	#ªgn_MARKER
 
	`MAKE_MARKER
 ('r', 'e', 'g', 'n')

	)

58 
	#°rg_MARKER
 
	`MAKE_MARKER
 ('s', 't', 'r', 'g')

	)

59 
	#umid_MARKER
 
	`MAKE_MARKER
 ('u', 'm', 'i', 'd')

	)

60 
	#uuid_MARKER
 
	`MAKE_MARKER
 ('u', 'u', 'i', 'd')

	)

61 
	#uœw_MARKER
 
	`MAKE_MARKER
 ('u', 'l', 'a', 'w')

	)

62 
	#MAC3_MARKER
 
	`MAKE_MARKER
 ('M', 'A', 'C', '3')

	)

63 
	#MAC6_MARKER
 
	`MAKE_MARKER
 ('M', 'A', 'C', '6')

	)

65 
	#CAF_PEAK_CHUNK_SIZE
(
ch
Ë((Ë( (Ë+ ch * ( (Ë+ 8)))

	)

67 
	#SFE_CAF_NOT_CAF
 666

	)

68 
	#SFE_CAF_NO_DESC
 667

	)

69 
	#SFE_CAF_BAD_PEAK
 668

	)

76 { 
	m§©e
 [8] ;

77 
	mfmt_id
 ;

78 
	mfmt_Êags
 ;

79 
	mpkt_byãs
 ;

80 
	mpkt_‰ames
 ;

81 
	mch™√ls_≥r_‰ame
 ;

82 
	mbôs_≥r_ch™
 ;

83 } 
	tDESC_CHUNK
 ;

89 
ˇf_˛o£
 (
SF_PRIVATE
 *
psf
) ;

90 
ˇf_ªad_hódî
 (
SF_PRIVATE
 *
psf
) ;

91 
ˇf_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
) ;

98 
	$ˇf_›í
 (
SF_PRIVATE
 *
psf
)

99 { 
subf‹m©
, 
f‹m©
, 
îr‹
 = 0 ;

101 i‡(
psf
->
mode
 =
SFM_READ
 || (psf->modê=
SFM_RDWR
 &&Ösf->
fûñígth
 > 0))

102 { i‡((
îr‹
 = 
	`ˇf_ªad_hódî
 (
psf
)))

103  
îr‹
 ;

106 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

108 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

109 { i‡(
psf
->
is_pùe
)

110  
SFE_NO_PIPE_WRITE
 ;

112 
f‹m©
 = 
psf
->
sf
.f‹m© & 
SF_FORMAT_TYPEMASK
 ;

113 i‡(
f‹m©
 !
SF_FORMAT_CAF
)

114  
SFE_BAD_OPEN_FORMAT
 ;

116 
psf
->
blockwidth
 =Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

118 i‡(
psf
->
mode
 !
SFM_RDWR
 ||Ösf->
fûñígth
 < 44)

119 { 
psf
->
fûñígth
 = 0 ;

120 
psf
->
d©Æígth
 = 0 ;

121 
psf
->
d©aoff£t
 = 0 ;

122 
psf
->
sf
.
‰ames
 = 0 ;

125 
psf
->
°r_Êags
 = 
SF_STR_ALLOW_START
 ;

131 i‡(
psf
->
mode
 =
SFM_WRITE
 && (
subf‹m©
 =
SF_FORMAT_FLOAT
 || subf‹m© =
SF_FORMAT_DOUBLE
))

132 { i‡((
psf
->
≥ak_öfo
 = 
	`≥ak_öfo_ˇŒoc
 (psf->
sf
.
ch™√ls
)Ë=
NULL
)

133  
SFE_MALLOC_FAILED
 ;

134 
psf
->
≥ak_öfo
->
≥ak_loc
 = 
SF_PEAK_START
 ;

137 i‡((
îr‹
 = 
	`ˇf_wrôe_hódî
 (
psf
, 
SF_FALSE
)) != 0)

138  
îr‹
 ;

140 
psf
->
wrôe_hódî
 = 
ˇf_wrôe_hódî
 ;

143 
psf
->
c⁄èöî_˛o£
 = 
ˇf_˛o£
 ;

146 
subf‹m©
)

147 { 
SF_FORMAT_PCM_S8
 :

148 
SF_FORMAT_PCM_16
 :

149 
SF_FORMAT_PCM_24
 :

150 
SF_FORMAT_PCM_32
 :

151 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

154 
SF_FORMAT_ULAW
 :

155 
îr‹
 = 
	`uœw_öô
 (
psf
) ;

158 
SF_FORMAT_ALAW
 :

159 
îr‹
 = 
	`Æaw_öô
 (
psf
) ;

163 
SF_FORMAT_FLOAT
 :

164 
îr‹
 = 
	`Êﬂt32_öô
 (
psf
) ;

167 
SF_FORMAT_DOUBLE
 :

168 
îr‹
 = 
	`doubÀ64_öô
 (
psf
) ;

173  
SFE_UNSUPPORTED_ENCODING
 ;

176  
îr‹
 ;

177 
	}
}

180 
	$ˇf_˛o£
 (
SF_PRIVATE
 *
psf
)

182 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

183 
	`ˇf_wrôe_hódî
 (
psf
, 
SF_TRUE
) ;

186 
	}
}

192 
	$decode_desc_chunk
 (
SF_PRIVATE
 *
psf
, c⁄° 
DESC_CHUNK
 *
desc
)

193 { 
f‹m©
 ;

195 
psf
->
sf
.
ch™√ls
 = 
desc
->
ch™√ls_≥r_‰ame
 ;

197 
f‹m©
 = 
SF_FORMAT_CAF
 | (
psf
->
ídün
 =
SF_ENDIAN_LITTLE
 ? SF_ENDIAN_LITTLE : 0) ;

199 i‡(
desc
->
fmt_id
 =
Õcm_MARKER
 && desc->
fmt_Êags
 & 1)

201 i‡(
desc
->
bôs_≥r_ch™
 =32 && desc->
pkt_byãs
 =4 * desc->
ch™√ls_≥r_‰ame
)

202 { 
psf
->
byãwidth
 = 4 ;

203  
f‹m©
 | 
SF_FORMAT_FLOAT
 ;

205 i‡(
desc
->
bôs_≥r_ch™
 =64 && desc->
pkt_byãs
 =8 * desc->
ch™√ls_≥r_‰ame
)

206 { 
psf
->
byãwidth
 = 8 ;

207  
f‹m©
 | 
SF_FORMAT_DOUBLE
 ;

211 i‡((
desc
->
fmt_Êags
 & 1) != 0)

212 { 
	`psf_log_¥ötf
 (
psf
, "**** Ooops, 'desc' chunk suggests float data, but other info invalid.\n") ;

216 i‡(
desc
->
fmt_id
 =
Õcm_MARKER
)

218 i‡(
desc
->
bôs_≥r_ch™
 =32 && desc->
pkt_byãs
 =4 * desc->
ch™√ls_≥r_‰ame
)

219 { 
psf
->
byãwidth
 = 4 ;

220  
f‹m©
 | 
SF_FORMAT_PCM_32
 ;

222 i‡(
desc
->
bôs_≥r_ch™
 =24 && desc->
pkt_byãs
 =3 * desc->
ch™√ls_≥r_‰ame
)

223 { 
psf
->
byãwidth
 = 3 ;

224  
f‹m©
 | 
SF_FORMAT_PCM_24
 ;

226 i‡(
desc
->
bôs_≥r_ch™
 =16 && desc->
pkt_byãs
 =2 * desc->
ch™√ls_≥r_‰ame
)

227 { 
psf
->
byãwidth
 = 2 ;

228  
f‹m©
 | 
SF_FORMAT_PCM_16
 ;

230 i‡(
desc
->
bôs_≥r_ch™
 =8 && desc->
pkt_byãs
 =1 * desc->
ch™√ls_≥r_‰ame
)

231 { 
psf
->
byãwidth
 = 1 ;

232  
f‹m©
 | 
SF_FORMAT_PCM_S8
 ;

236 i‡(
desc
->
fmt_id
 =
Æaw_MARKER
 && desc->
bôs_≥r_ch™
 == 8)

237 { 
psf
->
byãwidth
 = 1 ;

238  
f‹m©
 | 
SF_FORMAT_ALAW
 ;

241 i‡(
desc
->
fmt_id
 =
uœw_MARKER
 && desc->
bôs_≥r_ch™
 == 8)

242 { 
psf
->
byãwidth
 = 1 ;

243  
f‹m©
 | 
SF_FORMAT_ULAW
 ;

247 
	}
}

250 
	$ˇf_ªad_hódî
 (
SF_PRIVATE
 *
psf
)

251 { 
DESC_CHUNK
 
desc
 ;

252 
sf_cou¡_t
 
chunk_size
 ;

253 
§©e
 ;

254 
vîsi⁄
, 
Êags
 ;

255 
m¨kî
, 
k
, 
have_d©a
 = 0 ;

257 
	`mem£t
 (&
desc
, 0,  (desc)) ;

260 
	`psf_böhódî_ªadf
 (
psf
, "pmE2E2", 0, &
m¨kî
, &
vîsi⁄
, &
Êags
) ;

261 
	`psf_log_¥ötf
 (
psf
, "%M\¿ Vîsi⁄ : %d\¿ Fœg† : %x\n", 
m¨kî
, 
vîsi⁄
, 
Êags
) ;

262 i‡(
m¨kî
 !
ˇff_MARKER
)

263  
SFE_CAF_NOT_CAF
 ;

265 
	`psf_böhódî_ªadf
 (
psf
, "mE8b", &
m¨kî
, &
chunk_size
,Ösf->
u
.
ucbuf
, 8) ;

266 
§©e
 = 
	`doubÀ64_be_ªad
 (
psf
->
u
.
ucbuf
) ;

267 
	`LSF_SNPRINTF
 (
psf
->
u
.
cbuf
,  (psf->u.cbuf), "%5.3f", 
§©e
) ;

268 
	`psf_log_¥ötf
 (
psf
, "%M : %D\¿ Sam∂êøã : %s\n", 
m¨kî
, 
chunk_size
,Ösf->
u
.
cbuf
) ;

269 i‡(
m¨kî
 !
desc_MARKER
)

270  
SFE_CAF_NO_DESC
 ;

272 i‡(
chunk_size
 < 
	`SIGNED_SIZEOF
 (
DESC_CHUNK
))

273 { 
	`psf_log_¥ötf
 (
psf
, "**** Chunk sizeÅoo small. Should be > 32 bytes.\n") ;

274  
SFE_MALFORMED_FILE
 ;

277 
psf
->
sf
.
ßm∂î©e
 = 
	`Ãöt
 (
§©e
) ;

279 
	`psf_böhódî_ªadf
 (
psf
, "mE44444", &
desc
.
fmt_id
, &desc.
fmt_Êags
, &desc.
pkt_byãs
, &desc.
pkt_‰ames
,

280 &
desc
.
ch™√ls_≥r_‰ame
, &desc.
bôs_≥r_ch™
) ;

281 
	`psf_log_¥ötf
 (
psf
, " Format id : %M\n Format flags : %x\n Bytes /Öacket : %u\n"

283 
desc
.
fmt_id
, desc.
fmt_Êags
, desc.
pkt_byãs
, desc.
pkt_‰ames
, desc.
ch™√ls_≥r_‰ame
, desc.
bôs_≥r_ch™
) ;

285 i‡(
chunk_size
 > 
	`SIGNED_SIZEOF
 (
DESC_CHUNK
))

286 
	`psf_böhódî_ªadf
 (
psf
, "j", (Ë(
chunk_size
 -  (
DESC_CHUNK
))) ;

288 
psf
->
sf
.
ch™√ls
 = 
desc
.
ch™√ls_≥r_‰ame
 ;

290 
have_d©a
 =0 && 
	`psf_·ñl
 (
psf
Ë<Ösf->
fûñígth
 - 
	`SIGNED_SIZEOF
 (
m¨kî
))

291 { 
	`psf_böhódî_ªadf
 (
psf
, "mE8", &
m¨kî
, &
chunk_size
) ;

293 
m¨kî
)

294 { 
≥ak_MARKER
 :

295 
	`psf_log_¥ötf
 (
psf
, "%M : %D\n", 
m¨kî
, 
chunk_size
) ;

296 i‡(
chunk_size
 !
	`CAF_PEAK_CHUNK_SIZE
 (
psf
->
sf
.
ch™√ls
))

297 { 
	`psf_böhódî_ªadf
 (
psf
, "j", (Ë
chunk_size
) ;

298 
	`psf_log_¥ötf
 (
psf
, "*** FûêPEAK chunk %D should bê%d.\n", 
chunk_size
, 
	`CAF_PEAK_CHUNK_SIZE
 (psf->
sf
.
ch™√ls
)) ;

299  
SFE_CAF_BAD_PEAK
 ;

302 i‡((
psf
->
≥ak_öfo
 = 
	`≥ak_öfo_ˇŒoc
 (psf->
sf
.
ch™√ls
)Ë=
NULL
)

303  
SFE_MALLOC_FAILED
 ;

306 
	`psf_böhódî_ªadf
 (
psf
, "E4", & (psf->
≥ak_öfo
->
edô_numbî
)) ;

307 
	`psf_log_¥ötf
 (
psf
, "Édô cou¡ : %d\n",Ösf->
≥ak_öfo
->
edô_numbî
) ;

309 
	`psf_log_¥ötf
 (
psf
, " Ch Position Value\n") ;

310 
k
 = 0 ; k < 
psf
->
sf
.
ch™√ls
 ; k++)

311 { 
sf_cou¡_t
 
posôi⁄
 ;

312 
vÆue
 ;

314 
	`psf_böhódî_ªadf
 (
psf
, "Ef8", &
vÆue
, &
posôi⁄
) ;

315 
psf
->
≥ak_öfo
->
≥aks
 [
k
].
vÆue
 = value ;

316 
psf
->
≥ak_öfo
->
≥aks
 [
k
].
posôi⁄
 =Öosition ;

318 
	`LSF_SNPRINTF
 (
psf
->
u
.
cbuf
,  (psf->u.cbuf), " %2d %-12ld %g\n", 
k
, (Ë
posôi⁄
, 
vÆue
) ;

319 
	`psf_log_¥ötf
 (
psf
,Ösf->
u
.
cbuf
) ;

322 
psf
->
≥ak_öfo
->
≥ak_loc
 = 
SF_PEAK_START
 ;

325 
‰ì_MARKER
 :

326 
	`psf_log_¥ötf
 (
psf
, "%M : %D\n", 
m¨kî
, 
chunk_size
) ;

327 
	`psf_böhódî_ªadf
 (
psf
, "j", (Ë
chunk_size
) ;

330 
d©a_MARKER
 :

331 
	`psf_log_¥ötf
 (
psf
, "%M : %D\n", 
m¨kî
, 
chunk_size
) ;

332 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
k
) ;

333 
	`psf_log_¥ötf
 (
psf
, "Édô : %u\n", 
k
) ;

334 
have_d©a
 = 1 ;

338 
	`psf_log_¥ötf
 (
psf
, " %M : %D (skù≥d)\n", 
m¨kî
, 
chunk_size
) ;

339 
	`psf_böhódî_ªadf
 (
psf
, "j", (Ë
chunk_size
) ;

344 i‡(
have_d©a
 == 0)

345 { 
	`psf_log_¥ötf
 (
psf
, "**** Error, couldÇot find 'data' chunk.\n") ;

346  
SFE_MALFORMED_FILE
 ;

349 
	`psf_log_¥ötf
 (
psf
, "End\n") ;

351 
psf
->
d©aoff£t
 = 
	`psf_·ñl
 (psf) ;

352 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

353 
psf
->
ídün
 = (
desc
.
fmt_Êags
 & 2Ë? 
SF_ENDIAN_LITTLE
 : 
SF_ENDIAN_BIG
 ;

355 i‡((
psf
->
sf
.
f‹m©
 = 
	`decode_desc_chunk
 (psf, &
desc
)) == 0)

356  
SFE_UNSUPPORTED_ENCODING
 ;

358 i‡(
psf
->
byãwidth
 > 0)

359 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 /Ösf->
byãwidth
 ;

362 
	}
}

368 
	$ˇf_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
)

369 { 
DESC_CHUNK
 
desc
 ;

370 
sf_cou¡_t
 
cuºít
, 
‰ì_Àn
 ;

371 
subf‹m©
 ;

373 
	`mem£t
 (&
desc
, 0,  (desc)) ;

375 
cuºít
 = 
	`psf_·ñl
 (
psf
) ;

377 i‡(
ˇlc_Àngth
)

378 { 
psf
->
fûñígth
 = 
	`psf_gë_fûñí
 (psf) ;

380 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

382 i‡(
psf
->
d©´nd
)

383 
psf
->
d©Æígth
 -psf->
fûñígth
 -Ösf->
d©´nd
 ;

385 i‡(
psf
->
byãwidth
 > 0)

386 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 / (psf->
byãwidth
 *Ösf->sf.
ch™√ls
) ;

390 
psf
->
hódî
 [0] = 0 ;

391 
psf
->
hódödex
 = 0 ;

392 
	`psf_f£ek
 (
psf
, 0, 
SEEK_SET
) ;

395 
	`psf_böhódî_wrôef
 (
psf
, "Em22", 
ˇff_MARKER
, 1, 0) ;

398 
	`psf_böhódî_wrôef
 (
psf
, "Em8", 
desc_MARKER
, (
sf_cou¡_t
Ë( (
DESC_CHUNK
))) ;

400 
	`doubÀ64_be_wrôe
 (1.0 * 
psf
->
sf
.
ßm∂î©e
,Ösf->
u
.
ucbuf
) ;

401 
	`psf_böhódî_wrôef
 (
psf
, "b",Ösf->
u
.
ucbuf
, 
	`make_size_t
 (8)) ;

403 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

405 
psf
->
ídün
 =Ösf->
sf
.
f‹m©
 & 
SF_FORMAT_ENDMASK
 ;

407 i‡(
CPU_IS_BIG_ENDIAN
 && (
psf
->
ídün
 =0 ||Ösf->ídü¿=
SF_ENDIAN_CPU
))

408 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

409 i‡(
CPU_IS_LITTLE_ENDIAN
 && (
psf
->
ídün
 =
SF_ENDIAN_LITTLE
 ||Ösf->ídü¿=
SF_ENDIAN_CPU
))

410 
psf
->
ídün
 = 
SF_ENDIAN_LITTLE
 ;

412 i‡(
psf
->
ídün
 =
SF_ENDIAN_LITTLE
)

413 
desc
.
fmt_Êags
 = 2 ;

415 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

418 
subf‹m©
)

419 { 
SF_FORMAT_PCM_S8
 :

420 
desc
.
fmt_id
 = 
Õcm_MARKER
 ;

421 
psf
->
byãwidth
 = 1 ;

422 
desc
.
pkt_byãs
 = 
psf
->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

423 
desc
.
pkt_‰ames
 = 1 ;

424 
desc
.
ch™√ls_≥r_‰ame
 = 
psf
->
sf
.
ch™√ls
 ;

425 
desc
.
bôs_≥r_ch™
 = 8 ;

428 
SF_FORMAT_PCM_16
 :

429 
desc
.
fmt_id
 = 
Õcm_MARKER
 ;

430 
psf
->
byãwidth
 = 2 ;

431 
desc
.
pkt_byãs
 = 
psf
->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

432 
desc
.
pkt_‰ames
 = 1 ;

433 
desc
.
ch™√ls_≥r_‰ame
 = 
psf
->
sf
.
ch™√ls
 ;

434 
desc
.
bôs_≥r_ch™
 = 16 ;

437 
SF_FORMAT_PCM_24
 :

438 
psf
->
byãwidth
 = 3 ;

439 
desc
.
pkt_byãs
 = 
psf
->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

440 
desc
.
pkt_‰ames
 = 1 ;

441 
desc
.
ch™√ls_≥r_‰ame
 = 
psf
->
sf
.
ch™√ls
 ;

442 
desc
.
bôs_≥r_ch™
 = 24 ;

443 
desc
.
fmt_id
 = 
Õcm_MARKER
 ;

446 
SF_FORMAT_PCM_32
 :

447 
desc
.
fmt_id
 = 
Õcm_MARKER
 ;

448 
psf
->
byãwidth
 = 4 ;

449 
desc
.
pkt_byãs
 = 
psf
->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

450 
desc
.
pkt_‰ames
 = 1 ;

451 
desc
.
ch™√ls_≥r_‰ame
 = 
psf
->
sf
.
ch™√ls
 ;

452 
desc
.
bôs_≥r_ch™
 = 32 ;

455 
SF_FORMAT_FLOAT
 :

456 
desc
.
fmt_id
 = 
Õcm_MARKER
 ;

457 
desc
.
fmt_Êags
 |= 1 ;

458 
psf
->
byãwidth
 = 4 ;

459 
desc
.
pkt_byãs
 = 
psf
->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

460 
desc
.
pkt_‰ames
 = 1 ;

461 
desc
.
ch™√ls_≥r_‰ame
 = 
psf
->
sf
.
ch™√ls
 ;

462 
desc
.
bôs_≥r_ch™
 = 32 ;

465 
SF_FORMAT_DOUBLE
 :

466 
desc
.
fmt_id
 = 
Õcm_MARKER
 ;

467 
desc
.
fmt_Êags
 |= 1 ;

468 
psf
->
byãwidth
 = 8 ;

469 
desc
.
pkt_byãs
 = 
psf
->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

470 
desc
.
pkt_‰ames
 = 1 ;

471 
desc
.
ch™√ls_≥r_‰ame
 = 
psf
->
sf
.
ch™√ls
 ;

472 
desc
.
bôs_≥r_ch™
 = 64 ;

475 
SF_FORMAT_ALAW
 :

476 
desc
.
fmt_id
 = 
Æaw_MARKER
 ;

477 
psf
->
byãwidth
 = 1 ;

478 
desc
.
pkt_byãs
 = 
psf
->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

479 
desc
.
pkt_‰ames
 = 1 ;

480 
desc
.
ch™√ls_≥r_‰ame
 = 
psf
->
sf
.
ch™√ls
 ;

481 
desc
.
bôs_≥r_ch™
 = 8 ;

484 
SF_FORMAT_ULAW
 :

485 
desc
.
fmt_id
 = 
uœw_MARKER
 ;

486 
psf
->
byãwidth
 = 1 ;

487 
desc
.
pkt_byãs
 = 
psf
->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

488 
desc
.
pkt_‰ames
 = 1 ;

489 
desc
.
ch™√ls_≥r_‰ame
 = 
psf
->
sf
.
ch™√ls
 ;

490 
desc
.
bôs_≥r_ch™
 = 8 ;

494  
SFE_UNIMPLEMENTED
 ;

497 
	`psf_böhódî_wrôef
 (
psf
, "mE44444", 
desc
.
fmt_id
, desc.
fmt_Êags
, desc.
pkt_byãs
, desc.
pkt_‰ames
, desc.
ch™√ls_≥r_‰ame
, desc.
bôs_≥r_ch™
) ;

500 i‡(
psf
->
°r_Êags
 & 
SF_STR_LOCATE_START
)

501 
	`ˇf_wrôe_°rögs
 (
psf
, 
SF_STR_LOCATE_START
) ;

504 i‡(
psf
->
≥ak_öfo
 !
NULL
)

505 { 
k
 ;

506 
	`psf_böhódî_wrôef
 (
psf
, "Em84", 
≥ak_MARKER
, (
sf_cou¡_t
Ë
	`CAF_PEAK_CHUNK_SIZE
 (psf->
sf
.
ch™√ls
),Ösf->
≥ak_öfo
->
edô_numbî
) ;

507 
k
 = 0 ; k < 
psf
->
sf
.
ch™√ls
 ; k++)

508 
	`psf_böhódî_wrôef
 (
psf
, "Ef8", (Ëpsf->
≥ak_öfo
->
≥aks
 [
k
].
vÆue
,Ösf->≥ak_öfo->≥ak†[k].
posôi⁄
) ;

512 
‰ì_Àn
 = 0x1000 - 
psf
->
hódödex
 - 16 - 12 ;

513 
‰ì_Àn
 < 0)

514 
‰ì_Àn
 += 0x1000 ;

515 
	`psf_böhódî_wrôef
 (
psf
, "Em8z", 
‰ì_MARKER
, 
‰ì_Àn
, () free_len) ;

517 
	`psf_böhódî_wrôef
 (
psf
, "Em84", 
d©a_MARKER
,Ösf->
d©Æígth
, 0) ;

519 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

520 i‡(
psf
->
îr‹
)

521  
psf
->
îr‹
 ;

523 
psf
->
d©aoff£t
 =Ösf->
hódödex
 ;

524 i‡(
cuºít
 < 
psf
->
d©aoff£t
)

525 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
, 
SEEK_SET
) ;

526 i‡(
cuºít
 > 0)

527 
	`psf_f£ek
 (
psf
, 
cuºít
, 
SEEK_SET
) ;

529  
psf
->
îr‹
 ;

530 
	}
}

	@libsndfile-1.0.17/src/command.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°rög.h
>

23 
	~<m©h.h
>

25 
	~"¢dfûe.h
"

26 
	~"comm⁄.h
"

28 
SF_FORMAT_INFO
 c⁄° 
	gsim∂e_f‹m©s
 [] =

30 { 
SF_FORMAT_AIFF
 | 
SF_FORMAT_PCM_16
,

34 { 
SF_FORMAT_AIFF
 | 
SF_FORMAT_FLOAT
,

38 { 
SF_FORMAT_AIFF
 | 
SF_FORMAT_PCM_S8
,

42 { 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_16
,

46 { 
SF_FORMAT_AU
 | 
SF_FORMAT_ULAW
,

50 { 
SF_FORMAT_CAF
 | 
SF_FORMAT_PCM_16
,

54 #ifde‡
HAVE_FLAC_ALL_H


55 { 
SF_FORMAT_FLAC
 | 
SF_FORMAT_PCM_16
,

60 { 
SF_FORMAT_RAW
 | 
SF_FORMAT_VOX_ADPCM
,

64 { 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_16
,

68 { 
SF_FORMAT_WAV
 | 
SF_FORMAT_FLOAT
,

72 { 
SF_FORMAT_WAV
 | 
SF_FORMAT_IMA_ADPCM
,

76 { 
SF_FORMAT_WAV
 | 
SF_FORMAT_MS_ADPCM
,

80 { 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_U8
,

87 
	$psf_gë_f‹m©_sim∂e_cou¡
 ()

88 {  ( (
sim∂e_f‹m©s
Ë/  (
SF_FORMAT_INFO
)) ;

89 
	}
}

92 
	$psf_gë_f‹m©_sim∂e
 (
SF_FORMAT_INFO
 *
d©a
)

93 { 
ödx
 ;

95 i‡(
d©a
->
f‹m©
 < 0 || d©a->f‹m© >(
	`SIGNED_SIZEOF
 (
sim∂e_f‹m©s
Ë/ SIGNED_SIZEOF (
SF_FORMAT_INFO
)))

96  
SFE_BAD_CONTROL_CMD
 ;

98 
ödx
 = 
d©a
->
f‹m©
 ;

99 
	`mem˝y
 (
d©a
, &(
sim∂e_f‹m©s
 [
ödx
]), 
	`SIGNED_SIZEOF
 (
SF_FORMAT_INFO
)) ;

102 
	}
}

108 
SF_FORMAT_INFO
 c⁄° 
	gmaj‹_f‹m©s
 [] =

110 { 
SF_FORMAT_AIFF
, "AIFF (Apple/SGI)", "aiff" },

111 { 
SF_FORMAT_AU
, "AU (Sun/NeXT)", "au" },

112 { 
SF_FORMAT_AVR
, "AVR (Audio Visual Research)", "avr" },

113 { 
SF_FORMAT_CAF
, "CAF (Apple Core Audio File)", "caf" },

114 #ifde‡
HAVE_FLAC_ALL_H


115 { 
SF_FORMAT_FLAC
, "FLAC (FLAC Lossless Audio Codec)", "flac" },

117 { 
SF_FORMAT_HTK
, "HTK (HMM Tool Kit)", "htk" },

118 { 
SF_FORMAT_SVX
, "IFF (Amiga IFF/SVX8/SV16)", "iff" },

119 { 
SF_FORMAT_MAT4
, "MAT4 (GNU Octave 2.0 / Matlab 4.2)", "mat" },

120 { 
SF_FORMAT_MAT5
, "MAT5 (GNU Octave 2.1 / Matlab 5.0)", "mat" },

121 { 
SF_FORMAT_PAF
, "PAF (Ensoniq PARIS)", "paf" },

122 { 
SF_FORMAT_PVF
, "PVF (Portable Voice Format)", "pvf" },

123 { 
SF_FORMAT_RAW
, "RAW (header-less)", "raw" },

124 { 
SF_FORMAT_SD2
, "SD2 (Sound Designer II)", "sd2" },

125 { 
SF_FORMAT_SDS
, "SDS (Midi Sample Dump Standard)", "sds" },

126 { 
SF_FORMAT_IRCAM
, "SF (Berkeley/IRCAM/CARL)", "sf" },

127 { 
SF_FORMAT_VOC
, "VOC (Creative Labs)", "voc" },

128 { 
SF_FORMAT_W64
, "W64 (SoundFoundry WAVE 64)", "w64" },

129 { 
SF_FORMAT_WAV
, "WAV (Microsoft)", "wav" },

130 { 
SF_FORMAT_NIST
, "WAV (NIST Sphere)", "wav" },

131 { 
SF_FORMAT_WAVEX
, "WAVEX (Microsoft)", "wav" },

132 { 
SF_FORMAT_XI
, "XI (FastTracker 2)", "xi" },

137 
	$psf_gë_f‹m©_maj‹_cou¡
 ()

138 {  ( (
maj‹_f‹m©s
Ë/  (
SF_FORMAT_INFO
)) ;

139 
	}
}

142 
	$psf_gë_f‹m©_maj‹
 (
SF_FORMAT_INFO
 *
d©a
)

143 { 
ödx
 ;

145 i‡(
d©a
->
f‹m©
 < 0 || d©a->f‹m© >(
	`SIGNED_SIZEOF
 (
maj‹_f‹m©s
Ë/ SIGNED_SIZEOF (
SF_FORMAT_INFO
)))

146  
SFE_BAD_CONTROL_CMD
 ;

148 
ödx
 = 
d©a
->
f‹m©
 ;

149 
	`mem˝y
 (
d©a
, &(
maj‹_f‹m©s
 [
ödx
]), 
	`SIGNED_SIZEOF
 (
SF_FORMAT_INFO
)) ;

152 
	}
}

158 
SF_FORMAT_INFO
 
	gsubty≥_f‹m©s
 [] =

160 { 
SF_FORMAT_PCM_S8
, "Sig√d 8 bô PCM", 
NULL
 },

161 { 
SF_FORMAT_PCM_16
, "Sig√d 16 bô PCM", 
NULL
 },

162 { 
SF_FORMAT_PCM_24
, "Sig√d 24 bô PCM", 
NULL
 },

163 { 
SF_FORMAT_PCM_32
, "Sig√d 32 bô PCM", 
NULL
 },

165 { 
SF_FORMAT_PCM_U8
, "Unsig√d 8 bô PCM", 
NULL
 },

167 { 
SF_FORMAT_FLOAT
, "32 bô flﬂt", 
NULL
 },

168 { 
SF_FORMAT_DOUBLE
, "64 bô flﬂt", 
NULL
 },

170 { 
SF_FORMAT_ULAW
, "U-Law", 
NULL
 },

171 { 
SF_FORMAT_ALAW
, "A-Law", 
NULL
 },

172 { 
SF_FORMAT_IMA_ADPCM
, "IMA ADPCM", 
NULL
 },

173 { 
SF_FORMAT_MS_ADPCM
, "Mi¸oso· ADPCM", 
NULL
 },

175 { 
SF_FORMAT_GSM610
, "GSM 6.10", 
NULL
 },

177 { 
SF_FORMAT_G721_32
, "32kb†G721 ADPCM", 
NULL
 },

178 { 
SF_FORMAT_G723_24
, "24kb†G723 ADPCM", 
NULL
 },

180 { 
SF_FORMAT_DWVW_12
, "12 bô DWVW", 
NULL
 },

181 { 
SF_FORMAT_DWVW_16
, "16 bô DWVW", 
NULL
 },

182 { 
SF_FORMAT_DWVW_24
, "24 bô DWVW", 
NULL
 },

183 { 
SF_FORMAT_VOX_ADPCM
, "VOX ADPCM", "vox" },

185 { 
SF_FORMAT_DPCM_16
, "16 bô DPCM", 
NULL
 },

186 { 
SF_FORMAT_DPCM_8
, "8 bô DPCM", 
NULL
 }

190 
	$psf_gë_f‹m©_subty≥_cou¡
 ()

191 {  ( (
subty≥_f‹m©s
Ë/  (
SF_FORMAT_INFO
)) ;

192 
	}
}

195 
	$psf_gë_f‹m©_subty≥
 (
SF_FORMAT_INFO
 *
d©a
)

196 { 
ödx
 ;

198 i‡(
d©a
->
f‹m©
 < 0 || d©a->f‹m© >(
	`SIGNED_SIZEOF
 (
subty≥_f‹m©s
Ë/ SIGNED_SIZEOF (
SF_FORMAT_INFO
)))

199  
SFE_BAD_CONTROL_CMD
 ;

201 
ödx
 = 
d©a
->
f‹m©
 ;

202 
	`mem˝y
 (
d©a
, &(
subty≥_f‹m©s
 [
ödx
]),  (
SF_FORMAT_INFO
)) ;

205 
	}
}

211 
	$psf_gë_f‹m©_öfo
 (
SF_FORMAT_INFO
 *
d©a
)

212 { 
k
, 
f‹m©
 ;

214 i‡(
d©a
->
f‹m©
 & 
SF_FORMAT_TYPEMASK
)

215 { 
f‹m©
 = 
d©a
->f‹m© & 
SF_FORMAT_TYPEMASK
 ;

217 
k
 = 0 ; k < (
	`SIGNED_SIZEOF
 (
maj‹_f‹m©s
Ë/ SIGNED_SIZEOF (
SF_FORMAT_INFO
)) ; k++)

218 { i‡(
f‹m©
 =
maj‹_f‹m©s
 [
k
].format)

219 { 
	`mem˝y
 (
d©a
, &(
maj‹_f‹m©s
 [
k
]),  (
SF_FORMAT_INFO
)) ;

224 i‡(
d©a
->
f‹m©
 & 
SF_FORMAT_SUBMASK
)

225 { 
f‹m©
 = 
d©a
->f‹m© & 
SF_FORMAT_SUBMASK
 ;

227 
k
 = 0 ; k < (
	`SIGNED_SIZEOF
 (
subty≥_f‹m©s
Ë/ SIGNED_SIZEOF (
SF_FORMAT_INFO
)) ; k++)

228 { i‡(
f‹m©
 =
subty≥_f‹m©s
 [
k
].format)

229 { 
	`mem˝y
 (
d©a
, &(
subty≥_f‹m©s
 [
k
]),  (
SF_FORMAT_INFO
)) ;

235 
	`mem£t
 (
d©a
, 0,  (
SF_FORMAT_INFO
)) ;

237  
SFE_BAD_CONTROL_CMD
 ;

238 
	}
}

244 
	$psf_ˇlc_sig«l_max
 (
SF_PRIVATE
 *
psf
, 
n‹mÆize
)

245 { 
sf_cou¡_t
 
posôi⁄
 ;

246 
max_vÆ
, 
ãmp
, *
d©a
 ;

247 
k
, 
Àn
, 
ªadcou¡
, 
ßve_°©e
 ;

250 i‡(! 
psf
->
sf
.
£ekabÀ
)

251 { 
psf
->
îr‹
 = 
SFE_NOT_SEEKABLE
 ;

255 i‡(! 
psf
->
ªad_doubÀ
)

256 { 
psf
->
îr‹
 = 
SFE_UNIMPLEMENTED
 ;

260 
ßve_°©e
 = 
	`sf_comm™d
 ((
SNDFILE
*Ë
psf
, 
SFC_GET_NORM_DOUBLE
, 
NULL
, 0) ;

261 
	`sf_comm™d
 ((
SNDFILE
*Ë
psf
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
n‹mÆize
) ;

265 
posôi⁄
 = 
	`sf_£ek
 ((
SNDFILE
*Ë
psf
, 0, 
SEEK_CUR
) ;

267 
	`sf_£ek
 ((
SNDFILE
*Ë
psf
, 0, 
SEEK_SET
) ;

269 
d©a
 = 
psf
->
u
.
dbuf
 ;

270 
Àn
 = 
	`ARRAY_LEN
 (
psf
->
u
.
dbuf
) ;

272 
ªadcou¡
 = 1, 
max_vÆ
 = 0.0 ;Ñeadcount > 0 ; )

273 { 
ªadcou¡
 = 
	`sf_ªad_doubÀ
 ((
SNDFILE
*Ë
psf
, 
d©a
, 
Àn
) ;

274 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

275 { 
ãmp
 = 
	`Ábs
 (
d©a
 [
k
]) ;

276 
max_vÆ
 = 
ãmp
 > max_val ?Åemp : max_val ;

281 
	`sf_£ek
 ((
SNDFILE
*Ë
psf
, 
posôi⁄
, 
SEEK_SET
) ;

282 
	`sf_comm™d
 ((
SNDFILE
*Ë
psf
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
ßve_°©e
) ;

284  
max_vÆ
 ;

285 
	}
}

288 
	$psf_ˇlc_max_Æl_ch™√ls
 (
SF_PRIVATE
 *
psf
, *
≥aks
, 
n‹mÆize
)

289 { 
sf_cou¡_t
 
posôi⁄
 ;

290 
ãmp
, *
d©a
 ;

291 
k
, 
Àn
, 
ªadcou¡
, 
ßve_°©e
 ;

292 
ch™
 ;

295 i‡(! 
psf
->
sf
.
£ekabÀ
)

296  (
psf
->
îr‹
 = 
SFE_NOT_SEEKABLE
) ;

298 i‡(! 
psf
->
ªad_doubÀ
)

299  (
psf
->
îr‹
 = 
SFE_UNIMPLEMENTED
) ;

301 
ßve_°©e
 = 
	`sf_comm™d
 ((
SNDFILE
*Ë
psf
, 
SFC_GET_NORM_DOUBLE
, 
NULL
, 0) ;

302 
	`sf_comm™d
 ((
SNDFILE
*Ë
psf
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
n‹mÆize
) ;

304 
	`mem£t
 (
≥aks
, 0,  (Ë* 
psf
->
sf
.
ch™√ls
) ;

307 
posôi⁄
 = 
	`sf_£ek
 ((
SNDFILE
*Ë
psf
, 0, 
SEEK_CUR
) ;

308 
	`sf_£ek
 ((
SNDFILE
*Ë
psf
, 0, 
SEEK_SET
) ;

310 
Àn
 = 
	`ARRAY_LEN
 (
psf
->
u
.
dbuf
) ;

312 
d©a
 = 
psf
->
u
.
dbuf
 ;

314 
ch™
 = 0 ;

315 
ªadcou¡
 = 
Àn
 ;

316 
ªadcou¡
 > 0)

317 { 
ªadcou¡
 = 
	`sf_ªad_doubÀ
 ((
SNDFILE
*Ë
psf
, 
d©a
, 
Àn
) ;

318 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

319 { 
ãmp
 = 
	`Ábs
 (
d©a
 [
k
]) ;

320 
≥aks
 [
ch™
] = 
ãmp
 >Öeaks [chan] ?Åemp :Öeaks [chan] ;

321 
ch™
 = (ch™ + 1Ë% 
psf
->
sf
.
ch™√ls
 ;

325 
	`sf_£ek
 ((
SNDFILE
*Ë
psf
, 
posôi⁄
, 
SEEK_SET
) ;

327 
	`sf_comm™d
 ((
SNDFILE
*Ë
psf
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
ßve_°©e
) ;

330 
	}
}

333 
	$psf_gë_sig«l_max
 (
SF_PRIVATE
 *
psf
, *
≥ak
)

334 { 
k
 ;

336 i‡(
psf
->
≥ak_öfo
 =
NULL
)

337  
SF_FALSE
 ;

339 
≥ak
 [0] = 
psf
->
≥ak_öfo
->
≥aks
 [0].
vÆue
 ;

341 
k
 = 1 ; k < 
psf
->
sf
.
ch™√ls
 ; k++)

342 
≥ak
 [0] = 
	`SF_MAX
 (≥ak [0], 
psf
->
≥ak_öfo
->
≥aks
 [
k
].
vÆue
) ;

344  
SF_TRUE
 ;

345 
	}
}

348 
	$psf_gë_max_Æl_ch™√ls
 (
SF_PRIVATE
 *
psf
, *
≥aks
)

349 { 
k
 ;

351 i‡(
psf
->
≥ak_öfo
 =
NULL
)

352  
SF_FALSE
 ;

354 
k
 = 0 ; k < 
psf
->
sf
.
ch™√ls
 ; k++)

355 
≥aks
 [
k
] = 
psf
->
≥ak_öfo
->≥ak†[k].
vÆue
 ;

357  
SF_TRUE
 ;

358 
	}
}

	@libsndfile-1.0.17/src/common.c

19 
	~<°d¨g.h
>

20 
	~<°rög.h
>

21 
	~<˘y≥.h
>

22 
	~<m©h.h
>

23 
	~<time.h
>

25 
	~"¢dfûe.h
"

26 
	~"s„ndün.h
"

27 
	~"comm⁄.h
"

38 
ölöe
 

39 
	$log_putch¨
 (
SF_PRIVATE
 *
psf
, 
ch
)

40 { i‡(
psf
->
logödex
 < 
	`SIGNED_SIZEOF
 (psf->
logbuf„r
) - 1)

41 { 
psf
->
logbuf„r
 [psf->
logödex
++] = 
ch
 ;

42 
psf
->
logbuf„r
 [psf->
logödex
] = 0 ;

45 
	}
}

48 
	$psf_log_¥ötf
 (
SF_PRIVATE
 *
psf
, c⁄° *
f‹m©
, ...)

49 { 
va_li°
 
≠
 ;

50 
u
 ;

51 
d
, 
ãns
, 
shi·
, 
width
, 
width_•ecifõr
, 
À·_Æign
 ;

52 
c
, *
°Ωå
, 
i°r
 [5], 
Àad_ch¨
, 
sign_ch¨
 ;

54 
	`va_°¨t
 (
≠
, 
f‹m©
) ;

56 (
c
 = *
f‹m©
++))

57 { i‡(
c
 != '%')

58 { 
	`log_putch¨
 (
psf
, 
c
) ;

62 i‡(
f‹m©
 [0] == '%')

63 { 
	`log_putch¨
 (
psf
, '%') ;

64 
f‹m©
 ++ ;

68 
sign_ch¨
 = 0 ;

69 
À·_Æign
 = 
SF_FALSE
 ;

71 { 
f‹m©
 [0])

74 
sign_ch¨
 = 
f‹m©
 [0] ;

75 
f‹m©
 ++ ;

79 
À·_Æign
 = 
SF_TRUE
 ;

80 
f‹m©
 ++ ;

89 i‡(
f‹m©
 [0] == 0)

92 
Àad_ch¨
 = ' ' ;

93 i‡(
f‹m©
 [0] == '0')

94 
Àad_ch¨
 = '0' ;

96 
width_•ecifõr
 = 0 ;

97 (
c
 = *
f‹m©
++Ë&& 
	`isdigô
 (c))

98 
width_•ecifõr
 = width_•ecifõ∏* 10 + (
c
 - '0') ;

100 
c
)

102 
	`va_íd
 (
≠
) ;

106 
°Ωå
 = 
	`va_¨g
 (
≠
, *) ;

107 i‡(
°Ωå
 =
NULL
)

109 
width_•ecifõr
 -
	`°æí
 (
°Ωå
) ;

110 i‡(
À·_Æign
 =
SF_FALSE
)

111 
width_•ecifõr
 -- > 0)

112 
	`log_putch¨
 (
psf
, ' ') ;

113 *
°Ωå
)

114 
	`log_putch¨
 (
psf
, *
°Ωå
++) ;

115 
width_•ecifõr
 -- > 0)

116 
	`log_putch¨
 (
psf
, ' ') ;

120 
d
 = 
	`va_¨g
 (
≠
, ) ;

122 i‡(
d
 < 0)

123 { 
d
 = -d ;

124 
sign_ch¨
 = '-' ;

125 i‡(
Àad_ch¨
 !'0' && 
À·_Æign
 =
SF_FALSE
)

126 
width_•ecifõr
 -- ;

129 
ãns
 = 1 ;

130 
width
 = 1 ;

131 
d
 / 
ãns
 >= 10)

132 { 
ãns
 *= 10 ;

133 
width
 ++ ;

136 
width_•ecifõr
 -
width
 ;

138 i‡(
sign_ch¨
 == ' ')

139 { 
	`log_putch¨
 (
psf
, ' ') ;

140 
width_•ecifõr
 -- ;

143 i‡(
À·_Æign
 =
SF_FALSE
 && 
Àad_ch¨
 != '0')

144 { i‡(
sign_ch¨
 == '+')

145 
width_•ecifõr
 -- ;

147 
width_•ecifõr
 -- > 0)

148 
	`log_putch¨
 (
psf
, 
Àad_ch¨
) ;

151 i‡(
sign_ch¨
 == '+' || sign_char == '-')

152 { 
	`log_putch¨
 (
psf
, 
sign_ch¨
) ;

153 
width_•ecifõr
 -- ;

156 i‡(
À·_Æign
 =
SF_FALSE
)

157 
width_•ecifõr
 -- > 0)

158 
	`log_putch¨
 (
psf
, 
Àad_ch¨
) ;

160 
ãns
 > 0)

161 { 
	`log_putch¨
 (
psf
, '0' + 
d
 / 
ãns
) ;

162 
d
 %
ãns
 ;

163 
ãns
 /= 10 ;

166 
width_•ecifõr
 -- > 0)

167 
	`log_putch¨
 (
psf
, 
Àad_ch¨
) ;

171 { 
sf_cou¡_t
 
D
, 
Tís
 ;

173 
D
 = 
	`va_¨g
 (
≠
, 
sf_cou¡_t
) ;

175 i‡(
D
 == 0)

176 { -- 
width_•ecifõr
 > 0)

177 
	`log_putch¨
 (
psf
, 
Àad_ch¨
) ;

178 
	`log_putch¨
 (
psf
, '0') ;

181 i‡(
D
 < 0)

182 { 
	`log_putch¨
 (
psf
, '-') ;

183 
D
 = -D ;

185 
Tís
 = 1 ;

186 
width
 = 1 ;

187 
D
 / 
Tís
 >= 10)

188 { 
Tís
 *= 10 ;

189 
width
 ++ ;

192 
width_•ecifõr
 > 
width
)

193 { 
	`log_putch¨
 (
psf
, 
Àad_ch¨
) ;

194 
width_•ecifõr
-- ;

197 
Tís
 > 0)

198 { 
	`log_putch¨
 (
psf
, '0' + 
D
 / 
Tís
) ;

199 
D
 %
Tís
 ;

200 
Tís
 /= 10 ;

206 
u
 = 
	`va_¨g
 (
≠
, ) ;

208 
ãns
 = 1 ;

209 
width
 = 1 ;

210 
u
 / 
ãns
 >= 10)

211 { 
ãns
 *= 10 ;

212 
width
 ++ ;

215 
width_•ecifõr
 -
width
 ;

217 i‡(
sign_ch¨
 == ' ')

218 { 
	`log_putch¨
 (
psf
, ' ') ;

219 
width_•ecifõr
 -- ;

222 i‡(
À·_Æign
 =
SF_FALSE
 && 
Àad_ch¨
 != '0')

223 { i‡(
sign_ch¨
 == '+')

224 
width_•ecifõr
 -- ;

226 
width_•ecifõr
 -- > 0)

227 
	`log_putch¨
 (
psf
, 
Àad_ch¨
) ;

230 i‡(
sign_ch¨
 == '+' || sign_char == '-')

231 { 
	`log_putch¨
 (
psf
, 
sign_ch¨
) ;

232 
width_•ecifõr
 -- ;

235 i‡(
À·_Æign
 =
SF_FALSE
)

236 
width_•ecifõr
 -- > 0)

237 
	`log_putch¨
 (
psf
, 
Àad_ch¨
) ;

239 
ãns
 > 0)

240 { 
	`log_putch¨
 (
psf
, '0' + 
u
 / 
ãns
) ;

241 
u
 %
ãns
 ;

242 
ãns
 /= 10 ;

245 
width_•ecifõr
 -- > 0)

246 
	`log_putch¨
 (
psf
, 
Àad_ch¨
) ;

250 
c
 = 
	`va_¨g
 (
≠
, ) & 0xFF ;

251 
	`log_putch¨
 (
psf
, 
c
) ;

256 
d
 = 
	`va_¨g
 (
≠
, ) ;

258 i‡(
d
 == 0)

259 { --
width_•ecifõr
 > 0)

260 
	`log_putch¨
 (
psf
, 
Àad_ch¨
) ;

261 
	`log_putch¨
 (
psf
, '0') ;

264 
shi·
 = 28 ;

265 
width
 = (
width_•ecifõr
 < 8) ? 8 : width_specifier ;

266 ! ((0xF << 
shi·
Ë& 
d
))

267 { 
shi·
 -= 4 ;

268 
width
 -- ;

271 
width
 > 0 && 
width_•ecifõr
 > width)

272 { 
	`log_putch¨
 (
psf
, 
Àad_ch¨
) ;

273 
width_•ecifõr
-- ;

276 
shi·
 >= 0)

277 { 
c
 = (
d
 >> 
shi·
) & 0xF ;

278 
	`log_putch¨
 (
psf
, (
c
 > 9) ? c + 'A' - 10 : c + '0') ;

279 
shi·
 -= 4 ;

284 
d
 = 
	`va_¨g
 (
≠
, ) ;

285 i‡(
CPU_IS_LITTLE_ENDIAN
)

286 { 
i°r
 [0] = 
d
 & 0xFF ;

287 
i°r
 [1] = (
d
 >> 8) & 0xFF ;

288 
i°r
 [2] = (
d
 >> 16) & 0xFF ;

289 
i°r
 [3] = (
d
 >> 24) & 0xFF ;

292 { 
i°r
 [3] = 
d
 & 0xFF ;

293 
i°r
 [2] = (
d
 >> 8) & 0xFF ;

294 
i°r
 [1] = (
d
 >> 16) & 0xFF ;

295 
i°r
 [0] = (
d
 >> 24) & 0xFF ;

297 
i°r
 [4] = 0 ;

298 
°Ωå
 = 
i°r
 ;

299 *
°Ωå
)

300 { 
c
 = *
°Ωå
++ ;

301 
	`log_putch¨
 (
psf
, 
c
) ;

306 
	`log_putch¨
 (
psf
, '*') ;

307 
	`log_putch¨
 (
psf
, 
c
) ;

308 
	`log_putch¨
 (
psf
, '*') ;

313 
	`va_íd
 (
≠
) ;

315 
	}
}

317 #i‚de‡
PSF_LOG_PRINTF_ONLY


327 
	$psf_asciihódî_¥ötf
 (
SF_PRIVATE
 *
psf
, c⁄° *
f‹m©
, ...)

328 { 
va_li°
 
¨g±r
 ;

329 
maxÀn
 ;

330 *
°¨t
 ;

332 
maxÀn
 = 
	`°æí
 ((*Ë
psf
->
hódî
) ;

333 
°¨t
 = ((*Ë
psf
->
hódî
Ë+ 
maxÀn
 ;

334 
maxÀn
 =  (
psf
->
hódî
) - maxlen ;

336 
	`va_°¨t
 (
¨g±r
, 
f‹m©
) ;

337 
	`LSF_VSNPRINTF
 (
°¨t
, 
maxÀn
, 
f‹m©
, 
¨g±r
) ;

338 
	`va_íd
 (
¨g±r
) ;

341 
°¨t
 [
maxÀn
 - 1] = 0 ;

343 
psf
->
hódödex
 = 
	`°æí
 ((*Ëpsf->
hódî
) ;

346 
	}
}

392 
ölöe
 

393 
	$hódî_put_byã
 (
SF_PRIVATE
 *
psf
, 
x
)

394 { i‡(
psf
->
hódödex
 < 
	`SIGNED_SIZEOF
 (psf->
hódî
) - 1)

395 
psf
->
hódî
 [psf->
hódödex
++] = 
x
 ;

396 
	}
}

398 #i‡(
CPU_IS_BIG_ENDIAN
 == 1)

399 
ölöe
 

400 
	$hódî_put_m¨kî
 (
SF_PRIVATE
 *
psf
, 
x
)

401 { i‡(
psf
->
hódödex
 < 
	`SIGNED_SIZEOF
 (psf->
hódî
) - 4)

402 { 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 24) ;

403 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 16) ;

404 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 8) ;

405 
psf
->
hódî
 [psf->
hódödex
++] = 
x
 ;

407 
	}
}

409 #ñi‡(
CPU_IS_LITTLE_ENDIAN
 == 1)

410 
ölöe
 

411 
	$hódî_put_m¨kî
 (
SF_PRIVATE
 *
psf
, 
x
)

412 { i‡(
psf
->
hódödex
 < 
	`SIGNED_SIZEOF
 (psf->
hódî
) - 4)

413 { 
psf
->
hódî
 [psf->
hódödex
++] = 
x
 ;

414 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 8) ;

415 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 16) ;

416 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 24) ;

418 
	}
}

425 
ölöe
 

426 
	$hódî_put_be_sh‹t
 (
SF_PRIVATE
 *
psf
, 
x
)

427 { i‡(
psf
->
hódödex
 < 
	`SIGNED_SIZEOF
 (psf->
hódî
) - 2)

428 { 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 8) ;

429 
psf
->
hódî
 [psf->
hódödex
++] = 
x
 ;

431 
	}
}

433 
ölöe
 

434 
	$hódî_put_À_sh‹t
 (
SF_PRIVATE
 *
psf
, 
x
)

435 { i‡(
psf
->
hódödex
 < 
	`SIGNED_SIZEOF
 (psf->
hódî
) - 2)

436 { 
psf
->
hódî
 [psf->
hódödex
++] = 
x
 ;

437 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 8) ;

439 
	}
}

441 
ölöe
 

442 
	$hódî_put_be_3byã
 (
SF_PRIVATE
 *
psf
, 
x
)

443 { i‡(
psf
->
hódödex
 < 
	`SIGNED_SIZEOF
 (psf->
hódî
) - 3)

444 { 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 16) ;

445 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 8) ;

446 
psf
->
hódî
 [psf->
hódödex
++] = 
x
 ;

448 
	}
}

450 
ölöe
 

451 
	$hódî_put_À_3byã
 (
SF_PRIVATE
 *
psf
, 
x
)

452 { i‡(
psf
->
hódödex
 < 
	`SIGNED_SIZEOF
 (psf->
hódî
) - 3)

453 { 
psf
->
hódî
 [psf->
hódödex
++] = 
x
 ;

454 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 8) ;

455 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 16) ;

457 
	}
}

459 
ölöe
 

460 
	$hódî_put_be_öt
 (
SF_PRIVATE
 *
psf
, 
x
)

461 { i‡(
psf
->
hódödex
 < 
	`SIGNED_SIZEOF
 (psf->
hódî
) - 4)

462 { 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 24) ;

463 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 16) ;

464 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 8) ;

465 
psf
->
hódî
 [psf->
hódödex
++] = 
x
 ;

467 
	}
}

469 
ölöe
 

470 
	$hódî_put_À_öt
 (
SF_PRIVATE
 *
psf
, 
x
)

471 { i‡(
psf
->
hódödex
 < 
	`SIGNED_SIZEOF
 (psf->
hódî
) - 4)

472 { 
psf
->
hódî
 [psf->
hódödex
++] = 
x
 ;

473 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 8) ;

474 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 16) ;

475 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 24) ;

477 
	}
}

479 #i‡(
SIZEOF_SF_COUNT_T
 == 4)

481 
ölöe
 

482 
	$hódî_put_be_8byã
 (
SF_PRIVATE
 *
psf
, 
sf_cou¡_t
 
x
)

483 { i‡(
psf
->
hódödex
 < 
	`SIGNED_SIZEOF
 (psf->
hódî
) - 8)

484 { 
psf
->
hódî
 [psf->
hódödex
++] = 0 ;

485 
psf
->
hódî
 [psf->
hódödex
++] = 0 ;

486 
psf
->
hódî
 [psf->
hódödex
++] = 0 ;

487 
psf
->
hódî
 [psf->
hódödex
++] = 0 ;

488 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 24) ;

489 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 16) ;

490 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 8) ;

491 
psf
->
hódî
 [psf->
hódödex
++] = 
x
 ;

493 
	}
}

495 
ölöe
 

496 
	$hódî_put_À_8byã
 (
SF_PRIVATE
 *
psf
, 
sf_cou¡_t
 
x
)

497 { i‡(
psf
->
hódödex
 < 
	`SIGNED_SIZEOF
 (psf->
hódî
) - 8)

498 { 
psf
->
hódî
 [psf->
hódödex
++] = 
x
 ;

499 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 8) ;

500 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 16) ;

501 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 24) ;

502 
psf
->
hódî
 [psf->
hódödex
++] = 0 ;

503 
psf
->
hódî
 [psf->
hódödex
++] = 0 ;

504 
psf
->
hódî
 [psf->
hódödex
++] = 0 ;

505 
psf
->
hódî
 [psf->
hódödex
++] = 0 ;

507 
	}
}

509 #ñi‡(
SIZEOF_SF_COUNT_T
 == 8)

511 
ölöe
 

512 
	$hódî_put_be_8byã
 (
SF_PRIVATE
 *
psf
, 
sf_cou¡_t
 
x
)

513 { i‡(
psf
->
hódödex
 < 
	`SIGNED_SIZEOF
 (psf->
hódî
) - 8)

514 { 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 56) ;

515 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 48) ;

516 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 40) ;

517 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 32) ;

518 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 24) ;

519 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 16) ;

520 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 8) ;

521 
psf
->
hódî
 [psf->
hódödex
++] = 
x
 ;

523 
	}
}

525 
ölöe
 

526 
	$hódî_put_À_8byã
 (
SF_PRIVATE
 *
psf
, 
sf_cou¡_t
 
x
)

527 { i‡(
psf
->
hódödex
 < 
	`SIGNED_SIZEOF
 (psf->
hódî
) - 8)

528 { 
psf
->
hódî
 [psf->
hódödex
++] = 
x
 ;

529 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 8) ;

530 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 16) ;

531 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 24) ;

532 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 32) ;

533 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 40) ;

534 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 48) ;

535 
psf
->
hódî
 [psf->
hódödex
++] = (
x
 >> 56) ;

537 
	}
}

544 
	$psf_böhódî_wrôef
 (
SF_PRIVATE
 *
psf
, c⁄° *
f‹m©
, ...)

545 { 
va_li°
 
¨g±r
 ;

546 
sf_cou¡_t
 
cou¡d©a
 ;

547 
l⁄gd©a
 ;

548 
d©a
 ;

549 
Êﬂtd©a
 ;

550 
doubÀd©a
 ;

551 *
böd©a
 ;

552 
size_t
 
size
 ;

553 
c
, *
°Ωå
 ;

554 
cou¡
 = 0, 
åunc_8to4
 ;

556 
åunc_8to4
 = 
SF_FALSE
 ;

558 
	`va_°¨t
 (
¨g±r
, 
f‹m©
) ;

560 (
c
 = *
f‹m©
++))

561 { 
c
)

566 
psf
->
rwf_ídün
 = 
SF_ENDIAN_LITTLE
 ;

570 
psf
->
rwf_ídün
 = 
SF_ENDIAN_BIG
 ;

574 
åunc_8to4
 = 
SF_TRUE
 ;

578 
åunc_8to4
 = 
SF_FALSE
 ;

582 
d©a
 = 
	`va_¨g
 (
¨g±r
, ) ;

583 
	`hódî_put_m¨kî
 (
psf
, 
d©a
) ;

584 
cou¡
 += 4 ;

588 
d©a
 = 
	`va_¨g
 (
¨g±r
, ) ;

589 
	`hódî_put_byã
 (
psf
, 
d©a
) ;

590 
cou¡
 += 1 ;

594 
d©a
 = 
	`va_¨g
 (
¨g±r
, ) ;

595 i‡(
psf
->
rwf_ídün
 =
SF_ENDIAN_BIG
)

596 { 
	`hódî_put_be_sh‹t
 (
psf
, 
d©a
) ;

599 { 
	`hódî_put_À_sh‹t
 (
psf
, 
d©a
) ;

601 
cou¡
 += 2 ;

605 
d©a
 = 
	`va_¨g
 (
¨g±r
, ) ;

606 i‡(
psf
->
rwf_ídün
 =
SF_ENDIAN_BIG
)

607 { 
	`hódî_put_be_3byã
 (
psf
, 
d©a
) ;

610 { 
	`hódî_put_À_3byã
 (
psf
, 
d©a
) ;

612 
cou¡
 += 3 ;

616 
d©a
 = 
	`va_¨g
 (
¨g±r
, ) ;

617 i‡(
psf
->
rwf_ídün
 =
SF_ENDIAN_BIG
)

618 { 
	`hódî_put_be_öt
 (
psf
, 
d©a
) ;

621 { 
	`hódî_put_À_öt
 (
psf
, 
d©a
) ;

623 
cou¡
 += 4 ;

627 
cou¡d©a
 = 
	`va_¨g
 (
¨g±r
, 
sf_cou¡_t
) ;

628 i‡(
psf
->
rwf_ídün
 =
SF_ENDIAN_BIG
 && 
åunc_8to4
 =
SF_FALSE
)

629 { 
	`hódî_put_be_8byã
 (
psf
, 
cou¡d©a
) ;

630 
cou¡
 += 8 ;

632 i‡(
psf
->
rwf_ídün
 =
SF_ENDIAN_LITTLE
 && 
åunc_8to4
 =
SF_FALSE
)

633 { 
	`hódî_put_À_8byã
 (
psf
, 
cou¡d©a
) ;

634 
cou¡
 += 8 ;

636 i‡(
psf
->
rwf_ídün
 =
SF_ENDIAN_BIG
 && 
åunc_8to4
 =
SF_TRUE
)

637 { 
l⁄gd©a
 = 
cou¡d©a
 & 0xFFFFFFFF ;

638 
	`hódî_put_be_öt
 (
psf
, 
l⁄gd©a
) ;

639 
cou¡
 += 4 ;

641 i‡(
psf
->
rwf_ídün
 =
SF_ENDIAN_LITTLE
 && 
åunc_8to4
 =
SF_TRUE
)

642 { 
l⁄gd©a
 = 
cou¡d©a
 & 0xFFFFFFFF ;

643 
	`hódî_put_À_öt
 (
psf
, 
l⁄gd©a
) ;

644 
cou¡
 += 4 ;

650 
Êﬂtd©a
 = (Ë
	`va_¨g
 (
¨g±r
, ) ;

651 i‡(
psf
->
rwf_ídün
 =
SF_ENDIAN_BIG
)

652 
	`Êﬂt32_be_wrôe
 (
Êﬂtd©a
, 
psf
->
hódî
 +Ösf->
hódödex
) ;

654 
	`Êﬂt32_À_wrôe
 (
Êﬂtd©a
, 
psf
->
hódî
 +Ösf->
hódödex
) ;

655 
psf
->
hódödex
 += 4 ;

656 
cou¡
 += 4 ;

660 
doubÀd©a
 = 
	`va_¨g
 (
¨g±r
, ) ;

661 i‡(
psf
->
rwf_ídün
 =
SF_ENDIAN_BIG
)

662 
	`doubÀ64_be_wrôe
 (
doubÀd©a
, 
psf
->
hódî
 +Ösf->
hódödex
) ;

664 
	`doubÀ64_À_wrôe
 (
doubÀd©a
, 
psf
->
hódî
 +Ösf->
hódödex
) ;

665 
psf
->
hódödex
 += 8 ;

666 
cou¡
 += 8 ;

671 
°Ωå
 = 
	`va_¨g
 (
¨g±r
, *) ;

672 
size
 = 
	`°æí
 (
°Ωå
) + 1 ;

673 
size
 += (size & 1) ;

674 i‡(
psf
->
rwf_ídün
 =
SF_ENDIAN_BIG
)

675 
	`hódî_put_be_öt
 (
psf
, 
size
) ;

677 
	`hódî_put_À_öt
 (
psf
, 
size
) ;

678 
	`mem˝y
 (&(
psf
->
hódî
 [psf->
hódödex
]), 
°Ωå
, 
size
) ;

679 
psf
->
hódödex
 +
size
 ;

680 
psf
->
hódî
 [psf->
hódödex
 - 1] = 0 ;

681 
cou¡
 +4 + 
size
 ;

689 
°Ωå
 = 
	`va_¨g
 (
¨g±r
, *) ;

690 
size
 = 
	`°æí
 (
°Ωå
) ;

691 i‡(
psf
->
rwf_ídün
 =
SF_ENDIAN_BIG
)

692 
	`hódî_put_be_öt
 (
psf
, 
size
) ;

694 
	`hódî_put_À_öt
 (
psf
, 
size
) ;

695 
	`mem˝y
 (&(
psf
->
hódî
 [psf->
hódödex
]), 
°Ωå
, 
size
 + 1) ;

696 
size
 += (size & 1) ;

697 
psf
->
hódödex
 +
size
 ;

698 
psf
->
hódî
 [psf->
hódödex
] = 0 ;

699 
cou¡
 +4 + 
size
 ;

703 
böd©a
 = 
	`va_¨g
 (
¨g±r
, *) ;

704 
size
 = 
	`va_¨g
 (
¨g±r
, 
size_t
) ;

705 
	`mem˝y
 (&(
psf
->
hódî
 [psf->
hódödex
]), 
böd©a
, 
size
) ;

706 
psf
->
hódödex
 +
size
 ;

707 
cou¡
 +
size
 ;

711 
size
 = 
	`va_¨g
 (
¨g±r
, 
size_t
) ;

712 
cou¡
 +
size
 ;

713 
size
)

714 { 
psf
->
hódî
 [psf->
hódödex
] = 0 ;

715 
psf
->
hódödex
 ++ ;

716 
size
 -- ;

721 
böd©a
 = 
	`va_¨g
 (
¨g±r
, *) ;

722 
	`mem˝y
 (&(
psf
->
hódî
 [psf->
hódödex
]), 
böd©a
, 16) ;

723 
psf
->
hódödex
 += 16 ;

724 
cou¡
 += 16 ;

728 
size
 = 
	`va_¨g
 (
¨g±r
, 
size_t
) ;

729 
psf
->
hódödex
 +
size
 ;

730 
cou¡
 = 
size
 ;

734 
	`psf_log_¥ötf
 (
psf
, "*** InvÆid f‹m© s≥cifõ∏`%c'\n", 
c
) ;

735 
psf
->
îr‹
 = 
SFE_INTERNAL
 ;

740 
	`va_íd
 (
¨g±r
) ;

741  
cou¡
 ;

742 
	}
}

755 #i‡(
CPU_IS_BIG_ENDIAN
 == 1)

756 
	#GET_MARKER
(
±r
) ( ((ptr) [0] << 24) | ((ptr) [1] << 16) | \

757 ((
±r
Ë[2] << 8Ë| (’åË[3]Ë)

	)

759 #ñi‡(
CPU_IS_LITTLE_ENDIAN
 == 1)

760 
	#GET_MARKER
(
±r
) ( ((ptr) [0]) | ((ptr) [1] << 8) | \

761 ((
±r
Ë[2] << 16Ë| (’åË[3] << 24Ë)

	)

767 
	#GET_LE_SHORT
(
±r
Ë–(’åË[1] << 8Ë| (’åË[0]Ë)

	)

768 
	#GET_BE_SHORT
(
±r
Ë–(’åË[0] << 8Ë| (’åË[1]Ë)

	)

770 
	#GET_LE_3BYTE
(
±r
Ë–(’åË[2] << 16Ë| (’åË[1] << 8Ë| (’åË[0]Ë)

	)

771 
	#GET_BE_3BYTE
(
±r
Ë–(’åË[0] << 16Ë| (’åË[1] << 8Ë| (’åË[2]Ë)

	)

773 
	#GET_LE_INT
(
±r
) ( ((ptr) [3] << 24) | ((ptr) [2] << 16) | \

774 ((
±r
Ë[1] << 8Ë| (’åË[0]Ë)

	)

776 
	#GET_BE_INT
(
±r
) ( ((ptr) [0] << 24) | ((ptr) [1] << 16) | \

777 ((
±r
Ë[2] << 8Ë| (’åË[3]Ë)

	)

779 #i‡(
SIZEOF_LONG
 == 4)

780 
	#GET_LE_8BYTE
(
±r
) ( ((ptr) [3] << 24) | ((ptr) [2] << 16) | \

781 ((
±r
Ë[1] << 8Ë| (’åË[0]Ë)

	)

783 
	#GET_BE_8BYTE
(
±r
) ( ((ptr) [4] << 24) | ((ptr) [5] << 16) | \

784 ((
±r
Ë[6] << 8Ë| (’åË[7]Ë)

	)

786 
	#GET_LE_8BYTE
(
±r
) ( (((ptr) [7] * 1L) << 56) | (((ptr) [6] * 1L) << 48) | \

787 (((
±r
) [5] * 1L) << 40) | (((ptr) [4] * 1L) << 32) | \

788 (((
±r
) [3] * 1L) << 24) | (((ptr) [2] * 1L) << 16) | \

789 (((
±r
Ë[1] * 1LË<< 8 ) | (’åË[0]))

	)

791 
	#GET_BE_8BYTE
(
±r
) ( (((ptr) [0] * 1L) << 56) | (((ptr) [1] * 1L) << 48) | \

792 (((
±r
) [2] * 1L) << 40) | (((ptr) [3] * 1L) << 32) | \

793 (((
±r
) [4] * 1L) << 24) | (((ptr) [5] * 1L) << 16) | \

794 (((
±r
Ë[6] * 1LË<< 8 ) | (’åË[7]))

	)

799 
	$hódî_ªad
 (
SF_PRIVATE
 *
psf
, *
±r
, 
byãs
)

800 { 
cou¡
 = 0 ;

802 i‡(
psf
->
hódödex
 >
	`SIGNED_SIZEOF
 (psf->
hódî
))

803 { 
	`mem£t
 (
±r
, 0, 
	`SIGNED_SIZEOF
 (
psf
->
hódî
Ë-Ösf->
hódödex
) ;

806 
	`psf_f£ek
 (
psf
, 
byãs
, 
SEEK_CUR
) ;

807  
byãs
 ;

810 i‡(
psf
->
hódödex
 + 
byãs
 > 
	`SIGNED_SIZEOF
 (psf->
hódî
))

811 { 
mo°
 ;

813 
mo°
 = 
	`SIGNED_SIZEOF
 (
psf
->
hódî
Ë-Ösf->
hódödex
 ;

814 
	`psf_‰ód
 (
psf
->
hódî
 +Ösf->
hódíd
, 1, 
mo°
,Ösf) ;

815 
	`mem£t
 ((*Ë
±r
 + 
mo°
, 0, 
byãs
 - most) ;

817 
	`psf_f£ek
 (
psf
, 
byãs
 - 
mo°
, 
SEEK_CUR
) ;

818  
byãs
 ;

821 i‡(
psf
->
hódödex
 + 
byãs
 >Ösf->
hódíd
)

822 { 
cou¡
 = 
	`psf_‰ód
 (
psf
->
hódî
 +Ösf->
hódíd
, 1, 
byãs
 - (psf->hódíd -Ösf->
hódödex
),Ösf) ;

823 i‡(
cou¡
 !
byãs
 - (Ë(
psf
->
hódíd
 -Ösf->
hódödex
))

824 { 
	`psf_log_¥ötf
 (
psf
, "Error :Ösf_freadÑeturned short count.\n") ;

827 
psf
->
hódíd
 +
cou¡
 ;

830 
	`mem˝y
 (
±r
, 
psf
->
hódî
 +Ösf->
hódödex
, 
byãs
) ;

831 
psf
->
hódödex
 +
byãs
 ;

833  
byãs
 ;

834 
	}
}

837 
	$hódî_£ek
 (
SF_PRIVATE
 *
psf
, 
sf_cou¡_t
 
posôi⁄
, 
whí˚
)

840 
whí˚
)

841 { 
SEEK_SET
 :

842 i‡(
posôi⁄
 > 
	`SIGNED_SIZEOF
 (
psf
->
hódî
))

844 
	`psf_f£ek
 (
psf
, 
posôi⁄
, 
whí˚
) ;

847 i‡(
posôi⁄
 > 
psf
->
hódíd
)

848 
psf
->
hódíd
 +
	`psf_‰ód
 (psf->
hódî
 +Ösf->hódíd, 1, 
posôi⁄
 -Ösf->headend,Ösf) ;

849 
psf
->
hódödex
 = 
posôi⁄
 ;

852 
SEEK_CUR
 :

853 i‡(
psf
->
hódödex
 + 
posôi⁄
 < 0)

856 i‡(
psf
->
hódödex
 >
	`SIGNED_SIZEOF
 (psf->
hódî
))

857 { 
	`psf_f£ek
 (
psf
, 
posôi⁄
, 
whí˚
) ;

861 i‡(
psf
->
hódödex
 + 
posôi⁄
 <psf->
hódíd
)

862 { 
psf
->
hódödex
 +
posôi⁄
 ;

866 i‡(
psf
->
hódödex
 + 
posôi⁄
 > 
	`SIGNED_SIZEOF
 (psf->
hódî
))

868 
psf
->
hódödex
 =Ösf->
hódíd
 ;

869 
	`psf_f£ek
 (
psf
, 
posôi⁄
, 
SEEK_CUR
) ;

873 
psf
->
hódíd
 +
	`psf_‰ód
 (psf->
hódî
 +Ösf->hódíd, 1, 
posôi⁄
 - (psf->hódíd -Ösf->
hódödex
),Ösf) ;

874 
psf
->
hódödex
 =Ösf->
hódíd
 ;

877 
SEEK_END
 :

879 
	`psf_log_¥ötf
 (
psf
, "Bad whenceÖaram in header_seek().\n") ;

884 
	}
}

887 
	$hódî_gës
 (
SF_PRIVATE
 *
psf
, *
±r
, 
bufsize
)

889 
k
 ;

891 
k
 = 0 ; k < 
bufsize
 - 1 ; k++)

892 { i‡(
psf
->
hódödex
 <Ösf->
hódíd
)

893 { 
±r
 [
k
] = 
psf
->
hódî
 [psf->
hódödex
] ;

894 
psf
->
hódödex
 ++ ;

897 { 
psf
->
hódíd
 +
	`psf_‰ód
 (psf->
hódî
 +Ösf->headend, 1, 1,Ösf) ;

898 
±r
 [
k
] = 
psf
->
hódî
 [psf->
hódödex
] ;

899 
psf
->
hódödex
 =Ösf->
hódíd
 ;

902 i‡(
±r
 [
k
] == '\n')

906 
±r
 [
k
] = 0 ;

908  
k
 ;

909 
	}
}

912 
	$psf_böhódî_ªadf
 (
SF_PRIVATE
 *
psf
, c⁄° *
f‹m©
, ...)

913 { 
va_li°
 
¨g±r
 ;

914 
sf_cou¡_t
 *
cou¡±r
, 
cou¡d©a
 ;

915 *
u˝å
, 
sixãí_byãs
 [16] ;

916 *
öçå
, 
ötd©a
 ;

917 *
sh‹çå
 ;

918 *
ch¨±r
 ;

919 *
Êﬂçå
 ;

920 *
doubÀ±r
 ;

921 
c
 ;

922 
byã_cou¡
 = 0, 
cou¡
 ;

924 i‡(! 
f‹m©
)

925  
	`psf_·ñl
 (
psf
) ;

927 
	`va_°¨t
 (
¨g±r
, 
f‹m©
) ;

929 (
c
 = *
f‹m©
++))

930 { 
c
)

932 
psf
->
rwf_ídün
 = 
SF_ENDIAN_LITTLE
 ;

936 
psf
->
rwf_ídün
 = 
SF_ENDIAN_BIG
 ;

940 
öçå
 = 
	`va_¨g
 (
¨g±r
, *) ;

941 
u˝å
 = (*Ë
öçå
 ;

942 
byã_cou¡
 +
	`hódî_ªad
 (
psf
, 
u˝å
,  ()) ;

943 *
öçå
 = 
	`GET_MARKER
 (
u˝å
) ;

947 
öçå
 = 
	`va_¨g
 (
¨g±r
, *) ;

948 
u˝å
 = (*Ë
öçå
 ;

949 
byã_cou¡
 +
	`hódî_ªad
 (
psf
, 
sixãí_byãs
,  (sixteen_bytes)) ;

950 { 
k
 ;

951 
ötd©a
 = 0 ;

952 
k
 = 0 ; k < 16 ; k++)

953 
ötd©a
 ^
sixãí_byãs
 [
k
] << k ;

955 *
öçå
 = 
ötd©a
 ;

959 
ch¨±r
 = 
	`va_¨g
 (
¨g±r
, *) ;

960 *
ch¨±r
 = 0 ;

961 
byã_cou¡
 +
	`hódî_ªad
 (
psf
, 
ch¨±r
,  ()) ;

965 
sh‹çå
 = 
	`va_¨g
 (
¨g±r
, *) ;

966 *
sh‹çå
 = 0 ;

967 
u˝å
 = (*Ë
sh‹çå
 ;

968 
byã_cou¡
 +
	`hódî_ªad
 (
psf
, 
u˝å
,  ()) ;

969 i‡(
psf
->
rwf_ídün
 =
SF_ENDIAN_BIG
)

970 *
sh‹çå
 = 
	`GET_BE_SHORT
 (
u˝å
) ;

972 *
sh‹çå
 = 
	`GET_LE_SHORT
 (
u˝å
) ;

976 
öçå
 = 
	`va_¨g
 (
¨g±r
, *) ;

977 *
öçå
 = 0 ;

978 
byã_cou¡
 +
	`hódî_ªad
 (
psf
, 
sixãí_byãs
, 3) ;

979 i‡(
psf
->
rwf_ídün
 =
SF_ENDIAN_BIG
)

980 *
öçå
 = 
	`GET_BE_3BYTE
 (
sixãí_byãs
) ;

982 *
öçå
 = 
	`GET_LE_3BYTE
 (
sixãí_byãs
) ;

986 
öçå
 = 
	`va_¨g
 (
¨g±r
, *) ;

987 *
öçå
 = 0 ;

988 
u˝å
 = (*Ë
öçå
 ;

989 
byã_cou¡
 +
	`hódî_ªad
 (
psf
, 
u˝å
,  ()) ;

990 i‡(
psf
->
rwf_ídün
 =
SF_ENDIAN_BIG
)

991 *
öçå
 = 
	`GET_BE_INT
 (
u˝å
) ;

993 *
öçå
 = 
	`GET_LE_INT
 (
u˝å
) ;

997 
cou¡±r
 = 
	`va_¨g
 (
¨g±r
, 
sf_cou¡_t
 *) ;

998 *
cou¡±r
 = 0 ;

999 
byã_cou¡
 +
	`hódî_ªad
 (
psf
, 
sixãí_byãs
, 8) ;

1000 i‡(
psf
->
rwf_ídün
 =
SF_ENDIAN_BIG
)

1001 
cou¡d©a
 = 
	`GET_BE_8BYTE
 (
sixãí_byãs
) ;

1003 
cou¡d©a
 = 
	`GET_LE_8BYTE
 (
sixãí_byãs
) ;

1004 *
cou¡±r
 = 
cou¡d©a
 ;

1008 
Êﬂçå
 = 
	`va_¨g
 (
¨g±r
, *) ;

1009 *
Êﬂçå
 = 0.0 ;

1010 
byã_cou¡
 +
	`hódî_ªad
 (
psf
, 
Êﬂçå
,  ()) ;

1011 i‡(
psf
->
rwf_ídün
 =
SF_ENDIAN_BIG
)

1012 *
Êﬂçå
 = 
	`Êﬂt32_be_ªad
 ((*) floatptr) ;

1014 *
Êﬂçå
 = 
	`Êﬂt32_À_ªad
 ((*) floatptr) ;

1018 
doubÀ±r
 = 
	`va_¨g
 (
¨g±r
, *) ;

1019 *
doubÀ±r
 = 0.0 ;

1020 
byã_cou¡
 +
	`hódî_ªad
 (
psf
, 
doubÀ±r
,  ()) ;

1021 i‡(
psf
->
rwf_ídün
 =
SF_ENDIAN_BIG
)

1022 *
doubÀ±r
 = 
	`doubÀ64_be_ªad
 ((*) doubleptr) ;

1024 *
doubÀ±r
 = 
	`doubÀ64_À_ªad
 ((*) doubleptr) ;

1028 
	`psf_log_¥ötf
 (
psf
, "Format conversion 's'Çot implemented yet.\n") ;

1041 
ch¨±r
 = 
	`va_¨g
 (
¨g±r
, *) ;

1042 
cou¡
 = 
	`va_¨g
 (
¨g±r
, ) ;

1043 i‡(
cou¡
 > 0)

1044 
byã_cou¡
 +
	`hódî_ªad
 (
psf
, 
ch¨±r
, 
cou¡
) ;

1048 
ch¨±r
 = 
	`va_¨g
 (
¨g±r
, *) ;

1049 
cou¡
 = 
	`va_¨g
 (
¨g±r
, ) ;

1050 i‡(
cou¡
 > 0)

1051 
byã_cou¡
 +
	`hódî_gës
 (
psf
, 
ch¨±r
, 
cou¡
) ;

1055 
	`psf_log_¥ötf
 (
psf
, "Format conversion 'z'Çot implemented yet.\n") ;

1068 
cou¡
 = 
	`va_¨g
 (
¨g±r
, ) ;

1069 
	`hódî_£ek
 (
psf
, 
cou¡
, 
SEEK_SET
) ;

1070 
byã_cou¡
 = 
cou¡
 ;

1075 
cou¡
 = 
	`va_¨g
 (
¨g±r
, ) ;

1076 
	`hódî_£ek
 (
psf
, 
cou¡
, 
SEEK_CUR
) ;

1077 
byã_cou¡
 +
cou¡
 ;

1081 
	`psf_log_¥ötf
 (
psf
, "*** InvÆid f‹m© s≥cifõ∏`%c'\n", 
c
) ;

1082 
psf
->
îr‹
 = 
SFE_INTERNAL
 ;

1087 
	`va_íd
 (
¨g±r
) ;

1089  
byã_cou¡
 ;

1090 
	}
}

1095 
sf_cou¡_t


1096 
	$psf_deÁu…_£ek
 (
SF_PRIVATE
 *
psf
, 
mode
, 
sf_cou¡_t
 
ßm∂es_‰om_°¨t
)

1097 { 
sf_cou¡_t
 
posôi⁄
, 
ªtvÆ
 ;

1099 i‡(! (
psf
->
blockwidth
 &&Ösf->
d©aoff£t
 >= 0))

1100 { 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

1101  
PSF_SEEK_ERROR
 ;

1104 i‡(! 
psf
->
sf
.
£ekabÀ
)

1105 { 
psf
->
îr‹
 = 
SFE_NOT_SEEKABLE
 ;

1106  
PSF_SEEK_ERROR
 ;

1109 
posôi⁄
 = 
psf
->
d©aoff£t
 +Ösf->
blockwidth
 * 
ßm∂es_‰om_°¨t
 ;

1111 i‡((
ªtvÆ
 = 
	`psf_f£ek
 (
psf
, 
posôi⁄
, 
SEEK_SET
)) !=Öosition)

1112 { 
psf
->
îr‹
 = 
SFE_SEEK_FAILED
 ;

1113  
PSF_SEEK_ERROR
 ;

1116 
mode
 = mode ;

1118  
ßm∂es_‰om_°¨t
 ;

1119 
	}
}

1125 
	$psf_hexdump
 (*
±r
, 
Àn
)

1126 { 
ascii
 [17], *
d©a
 ;

1127 
k
, 
m
 ;

1129 i‡((
d©a
 = 
±r
Ë=
NULL
)

1131 i‡(
Àn
 <= 0)

1134 
	`puts
 ("") ;

1135 
k
 = 0 ; k < 
Àn
 ; k += 16)

1136 { 
	`mem£t
 (
ascii
, ' ',  (ascii)) ;

1138 
	`¥ötf
 ("%08X: ", 
k
) ;

1139 
m
 = 0 ; m < 16 && 
k
 + m < 
Àn
 ; m++)

1140 { 
	`¥ötf
 (
m
 =8 ? " %02X " : "%02X ", 
d©a
 [
k
 + m] & 0xFF) ;

1141 
ascii
 [
m
] = 
	`i•röt
 (
d©a
 [
k
 + m]) ? data [k + m] : '.' ;

1144 i‡(
m
 <8Ë
	`¥ötf
 (" ") ;

1145  ; 
m
 < 16 ; m++Ë
	`¥ötf
 (" ") ;

1147 
ascii
 [16] = 0 ;

1148 
	`¥ötf
 (" %s\n", 
ascii
) ;

1151 
	`puts
 ("") ;

1152 
	}
}

1155 
	$psf_log_SF_INFO
 (
SF_PRIVATE
 *
psf
)

1156 { 
	`psf_log_¥ötf
 (
psf
, "---------------------------------\n") ;

1158 
	`psf_log_¥ötf
 (
psf
, " Sam∂êøã : %d\n",Ösf->
sf
.
ßm∂î©e
) ;

1159 
	`psf_log_¥ötf
 (
psf
, " Føme† : %D\n",Ösf->
sf
.
‰ames
) ;

1160 
	`psf_log_¥ötf
 (
psf
, " Ch™√l† : %d\n",Ösf->
sf
.
ch™√ls
) ;

1162 
	`psf_log_¥ötf
 (
psf
, " F‹m© : 0x%X\n",Ösf->
sf
.
f‹m©
) ;

1163 
	`psf_log_¥ötf
 (
psf
, " Se˘i⁄† : %d\n",Ösf->
sf
.
£˘i⁄s
) ;

1164 
	`psf_log_¥ötf
 (
psf
, " SìkabÀ : %s\n",Ösf->
sf
.
£ekabÀ
 ? "TRUE" : "FALSE") ;

1166 
	`psf_log_¥ötf
 (
psf
, "---------------------------------\n") ;

1167 
	}
}

1172 
SF_INSTRUMENT
 *

1173 
	$psf_ö°rumít_Æloc
 ()

1174 { 
SF_INSTRUMENT
 *
ö°r
 ;

1176 
ö°r
 = 
	`ˇŒoc
 (1,  (
SF_INSTRUMENT
)) ;

1178 i‡(
ö°r
 =
NULL
)

1179  
NULL
 ;

1182 
ö°r
->
ba£nŸe
 = -1 ;

1183 
ö°r
->
vñocôy_lo
 = -1 ;

1184 
ö°r
->
vñocôy_hi
 = -1 ;

1185 
ö°r
->
key_lo
 = -1 ;

1186 
ö°r
->
key_hi
 = -1 ;

1188  
ö°r
 ;

1189 
	}
}

1192 
	$psf_mem£t
 (*
s
, 
c
, 
sf_cou¡_t
 
Àn
)

1193 { *
±r
 ;

1194 
£tcou¡
 ;

1196 
±r
 = (*Ë
s
 ;

1198 
Àn
 > 0)

1199 { 
£tcou¡
 = (
Àn
 > 0x10000000) ? 0x10000000 : ()Üen ;

1201 
	`mem£t
 (
±r
, 
c
, 
£tcou¡
) ;

1203 
±r
 +
£tcou¡
 ;

1204 
Àn
 -
£tcou¡
 ;

1207  
s
 ;

1208 
	}
}

1210 
	$psf_gë_d©e_°r
 (*
°r
, 
maxÀn
)

1211 { 
time_t
 
cuºít
 ;

1212 
tm
 
timed©a
, *
tm±r
 ;

1214 
	`time
 (&
cuºít
) ;

1216 #i‡
	`deföed
 (
HAVE_GMTIME_R
)

1218 
tm±r
 = 
	`gmtime_r
 (&
cuºít
, &
timed©a
) ;

1219 #ñi‡
	`deföed
 (
HAVE_GMTIME
)

1221 
tm±r
 = 
	`gmtime
 (&
cuºít
) ;

1222 
	`mem˝y
 (&
timed©a
, 
tm±r
,  (timedata)) ;

1224 
tm±r
 = 
NULL
 ;

1227 i‡(
tm±r
)

1228 
	`LSF_SNPRINTF
 (
°r
, 
maxÀn
, "%4d-%02d-%02d %02d:%02d:%02d UTC",

1229 1900 + 
timed©a
.
tm_yór
,Åimed©a.
tm_m⁄
,Åimed©a.
tm_mday
,

1230 
timed©a
.
tm_hour
,Åimed©a.
tm_mö
,Åimed©a.
tm_£c
) ;

1232 
	`LSF_SNPRINTF
 (
°r
, 
maxÀn
, "Unknown date") ;

1235 
	}
}

1238 
	$subf‹m©_to_byãwidth
 (
f‹m©
)

1240 
f‹m©
)

1241 { 
SF_FORMAT_PCM_U8
 :

1242 
SF_FORMAT_PCM_S8
 :

1244 
SF_FORMAT_PCM_16
 :

1246 
SF_FORMAT_PCM_24
 :

1248 
SF_FORMAT_PCM_32
 :

1249 
SF_FORMAT_FLOAT
 :

1251 
SF_FORMAT_DOUBLE
 :

1256 
	}
}

1259 
	$s_bôwidth_to_subf‹m©
 (
bôs
)

1260 { 
¨øy
 [] =

1261 { 
SF_FORMAT_PCM_S8
, 
SF_FORMAT_PCM_16
, 
SF_FORMAT_PCM_24
, 
SF_FORMAT_PCM_32


1264 i‡(
bôs
 < 8 || bits > 32)

1267  
¨øy
 [((
bôs
 + 7) / 8) - 1] ;

1268 
	}
}

1271 
	$u_bôwidth_to_subf‹m©
 (
bôs
)

1272 { 
¨øy
 [] =

1273 { 
SF_FORMAT_PCM_U8
, 
SF_FORMAT_PCM_16
, 
SF_FORMAT_PCM_24
, 
SF_FORMAT_PCM_32


1276 i‡(
bôs
 < 8 || bits > 32)

1279  
¨øy
 [((
bôs
 + 7) / 8) - 1] ;

1280 
	}
}

	@libsndfile-1.0.17/src/common.h

19 #i‚de‡
SNDFILE_COMMON_H


20 
	#SNDFILE_COMMON_H


	)

22 
	~"sfc⁄fig.h
"

24 
	~<°dlib.h
>

26 #i‡
HAVE_STDINT_H


27 
	~<°döt.h
>

30 #i‚de‡
SNDFILE_H


31 
	~"¢dfûe.h
"

32 #ñi‡
HAVE_INTTYPES_H


33 
	~<öây≥s.h
>

36 #ifde‡
__˝lu•lus


40 #ifde‡
UNUSED


41 #ñi‡
deföed
 (
__GNUC__
)

42 
	#UNUSED
(
x
Ë
UNUSED_
 ## x 
	`__©åibuã__
 ((
unu£d
))

	)

43 #ñi‡
deföed
 (
__LCLINT__
)

44 
	#UNUSED
(
x
Ë 
	)
x

46 
	#UNUSED
(
x
Ë
	)
x

49 #ifde‡
__GNUC__


50 
	#WARN_UNUSED
 
	`__©åibuã__
 ((
w¨n_unu£d_ªsu…
))

	)

52 
	#WARN_UNUSED


	)

55 
	#SF_BUFFER_LEN
 (8192*2)

	)

56 
	#SF_FILENAME_LEN
 (512)

	)

57 
	#SF_SYSERR_LEN
 (256)

	)

58 
	#SF_MAX_STRINGS
 (16)

	)

59 
	#SF_STR_BUFFER_LEN
 (8192)

	)

60 
	#SF_HEADER_LEN
 (4100 + 
SF_STR_BUFFER_LEN
)

	)

62 
	#PSF_SEEK_ERROR
 ((
sf_cou¡_t
Ë-1)

	)

65 
	#BITWIDTH2BYTES
(
x
Ë(((xË+ 7Ë/ 8)

	)

71 
	#SIGNED_SIZEOF
(
x
Ë((Ë (x))

	)

73 
	#ARRAY_LEN
(
x
Ë((Ë( (xË/  ((xË[0])))

	)

75 
	#SF_MAX
(
a
,
b
Ë(◊Ë> (bË? (aË: (b))

	)

76 
	#SF_MIN
(
a
,
b
Ë(◊Ë< (bË? (aË: (b))

	)

80 
	mSF_PEAK_START
 = 42,

81 
	mSF_PEAK_END
 = 43,

84 
	mSF_SCALE_MAX
 = 52,

85 
	mSF_SCALE_MIN
 = 53,

88 
	mSF_STR_ALLOW_START
 = 0x0100,

89 
	mSF_STR_ALLOW_END
 = 0x0200,

92 
	mSF_STR_LOCATE_START
 = 0x0400,

93 
	mSF_STR_LOCATE_END
 = 0x0800,

95 
	mSFD_TYPEMASK
 = 0x0FFFFFFF

98 
	#SFM_MASK
 (
SFM_READ
 | 
SFM_WRITE
 | 
SFM_RDWR
)

	)

99 
	#SFM_UNMASK
 (~
SFM_MASK
)

	)

110 
	mSF_FORMAT_WVE
 = 0x4020000,

111 
	mSF_FORMAT_TXW
 = 0x4030000,

112 
	mSF_FORMAT_DWD
 = 0x4040000,

115 
	mSF_FORMAT_OGG
 = 0x4090000,

117 
	mSF_FORMAT_REX
 = 0x40A0000,

118 
	mSF_FORMAT_REX2
 = 0x40D0000,

119 
	mSF_FORMAT_KRZ
 = 0x40E0000,

120 
	mSF_FORMAT_WMA
 = 0x4100000,

121 
	mSF_FORMAT_SHN
 = 0x4110000,

124 
	mSF_FORMAT_VORBIS
 = 0x1001,

126 
	mSF_FORMAT_SVX_FIB
 = 0x1020,

127 
	mSF_FORMAT_SVX_EXP
 = 0x1021,

129 
	mSF_FORMAT_PCM_N
 = 0x1030

138 { 
	mvÆue
 ;

139 
sf_cou¡_t
 
	mposôi⁄
 ;

140 } 
	tPEAK_POS
 ;

144 
	m≥ak_loc
 ;

147 
	mvîsi⁄
 ;

148 
	mtime°amp
 ;

151 
	medô_numbî
 ;

153 #i‡
HAVE_FLEXIBLE_ARRAY


155 
PEAK_POS
 
	m≥aks
 [] ;

164 
PEAK_POS
 
	m≥aks
 [0] ;

166 } 
	tPEAK_INFO
 ;

168 
ölöe
 
PEAK_INFO
 *

169 
	$≥ak_öfo_ˇŒoc
 (
ch™√ls
)

170 {  
	`ˇŒoc
 (1,  (
PEAK_INFO
Ë+ 
ch™√ls
 *  (
PEAK_POS
)) ;

171 
	}
}

174 { 
	mty≥
 ;

175 
	mÊags
 ;

176 *
	m°r
 ;

177 } 
	tSTR_DATA
 ;

179 
ölöe
 
size_t


180 
	$make_size_t
 (
x
)

181 {  (
size_t
Ë
x
 ;

182 
	}
}

190 
	ssf_¥iv©e_èg


193 { 
	mdbuf
 [
SF_BUFFER_LEN
 /  ()] ;

194 #i‡(
deföed
 (
SIZEOF_INT64_T
) && (SIZEOF_INT64_T == 8))

195 
öt64_t
 
	mlbuf
 [
SF_BUFFER_LEN
 /  (int64_t)] ;

197 
	mlbuf
 [
SF_BUFFER_LEN
 /  ()] ;

199 
	mfbuf
 [
SF_BUFFER_LEN
 /  ()] ;

200 
	mibuf
 [
SF_BUFFER_LEN
 /  ()] ;

201 
	msbuf
 [
SF_BUFFER_LEN
 /  ()] ;

202 
	mcbuf
 [
SF_BUFFER_LEN
 /  ()] ;

203 sig√d 
	mscbuf
 [
SF_BUFFER_LEN
 /  (signed )] ;

204 
	mucbuf
 [
SF_BUFFER_LEN
 /  (signed )] ;

205 } 
	mu
 ;

207 
	mfûï©h
 [
SF_FILENAME_LEN
] ;

208 
	mr§˝©h
 [
SF_FILENAME_LEN
] ;

209 
	mdúe˘‹y
 [
SF_FILENAME_LEN
] ;

210 
	mfûíame
 [
SF_FILENAME_LEN
 / 4] ;

212 
	msy£º
 [
SF_SYSERR_LEN
] ;

217 
	mlogbuf„r
 [
SF_BUFFER_LEN
] ;

218 
	mhódî
 [
SF_HEADER_LEN
] ;

219 
	mrwf_ídün
 ;

224 
STR_DATA
 
	m°rögs
 [
SF_MAX_STRINGS
] ;

225 
	m°r_°‹age
 [
SF_STR_BUFFER_LEN
] ;

226 *
	m°r_íd
 ;

227 
	m°r_Êags
 ;

230 
	mMagick
 ;

233 
	mlogödex
 ;

234 
	mhódödex
, 
	mhódíd
 ;

235 
	mhas_ãxt
 ;

236 
	mdo_nŸ_˛o£_des¸ùt‹
 ;

238 #i‡
USE_WINDOWS_API


243 *
	mhfûe
, *
	mhr§c
, *
	mhßved
 ;

246 
	mfûedes
, 
	mr§cdes
, 
	mßvedes
 ;

249 
	mîr‹
 ;

251 
	mmode
 ;

252 
	mídün
 ;

253 
	mÊﬂt_ídsw≠
 ;

259 
	mÊﬂt_öt_mu…
 ;

260 
	mÊﬂt_max
 ;

263 
	mis_pùe
 ;

264 
sf_cou¡_t
 
	mpùeoff£t
 ;

267 
	madd_˛ùpög
 ;

269 
SF_INFO
 
	msf
 ;

271 
	mhave_wrôãn
 ;

272 
PEAK_INFO
 *
	m≥ak_öfo
 ;

275 
SF_LOOP_INFO
 *
	mlo›_öfo
 ;

276 
SF_INSTRUMENT
 *
	mö°rumít
 ;

279 
SF_BROADCAST_INFO
 *
	mbrﬂdˇ°_öfo
 ;

282 *
	mch™√l_m≠
 ;

284 
sf_cou¡_t
 
	mfûñígth
 ;

285 
sf_cou¡_t
 
	mfûeoff£t
 ;

287 
sf_cou¡_t
 
	mr§˛ígth
 ;

289 
sf_cou¡_t
 
	md©aoff£t
 ;

290 
sf_cou¡_t
 
	md©Æígth
 ;

291 
sf_cou¡_t
 
	md©´nd
 ;

293 
	mblockwidth
 ;

294 
	mbyãwidth
 ;

296 *
	mdôhî
 ;

297 *
	möãæóve
 ;

299 
	mœ°_›
 ;

300 
sf_cou¡_t
 
	mªad_cuºít
 ;

301 
sf_cou¡_t
 
	mwrôe_cuºít
 ;

303 *
	mc⁄èöî_d©a
 ;

307 *
	mcodec_d©a
 ;

311 
SF_DITHER_INFO
 
	mwrôe_dôhî
 ;

312 
SF_DITHER_INFO
 
	mªad_dôhî
 ;

314 
	mn‹m_doubÀ
 ;

315 
	mn‹m_Êﬂt
 ;

317 
	mauto_hódî
 ;

319 
	mõì_ª∂a˚
 ;

322 
sf_cou¡_t
 (*
ªad_sh‹t
Ë(
	msf_¥iv©e_èg
*, *
	m±r
, sf_cou¡_à
	mÀn
) ;

323 
sf_cou¡_t
 (*
ªad_öt
Ë(
	msf_¥iv©e_èg
*, *
	m±r
, sf_cou¡_à
	mÀn
) ;

324 
sf_cou¡_t
 (*
ªad_Êﬂt
Ë(
	msf_¥iv©e_èg
*, *
	m±r
, sf_cou¡_à
	mÀn
) ;

325 
sf_cou¡_t
 (*
ªad_doubÀ
Ë(
	msf_¥iv©e_èg
*, *
	m±r
, sf_cou¡_à
	mÀn
) ;

327 
sf_cou¡_t
 (*
wrôe_sh‹t
Ë(
	msf_¥iv©e_èg
*, c⁄° *
	m±r
, sf_cou¡_à
	mÀn
) ;

328 
sf_cou¡_t
 (*
wrôe_öt
Ë(
	msf_¥iv©e_èg
*, c⁄° *
	m±r
, sf_cou¡_à
	mÀn
) ;

329 
sf_cou¡_t
 (*
wrôe_Êﬂt
Ë(
	msf_¥iv©e_èg
*, c⁄° *
	m±r
, sf_cou¡_à
	mÀn
) ;

330 
sf_cou¡_t
 (*
wrôe_doubÀ
Ë(
	msf_¥iv©e_èg
*, c⁄° *
	m±r
, sf_cou¡_à
	mÀn
) ;

332 
sf_cou¡_t
 (*
£ek
Ë(
	msf_¥iv©e_èg
*, 
	mmode
, sf_cou¡_à
	mßm∂es_‰om_°¨t
) ;

333 (*
	mwrôe_hódî
Ë(
	msf_¥iv©e_èg
*, 
	mˇlc_Àngth
) ;

334 (*
	mcomm™d
Ë(
	msf_¥iv©e_èg
*, comm™d, *
	md©a
, 
	md©asize
) ;

340 (*
	mcodec_˛o£
Ë(
	msf_¥iv©e_èg
*) ;

341 (*
	mc⁄èöî_˛o£
Ë(
	msf_¥iv©e_èg
*) ;

343 *
	mf‹m©_desc
 ;

346 
	mvútuÆ_io
 ;

347 
SF_VIRTUAL_IO
 
	mvio
 ;

348 *
	mvio_u£r_d©a
 ;

349 } 
	tSF_PRIVATE
 ;

354 { 
	mSFE_NO_ERROR
 = 
SF_ERR_NO_ERROR
,

355 
	mSFE_BAD_OPEN_FORMAT
 = 
SF_ERR_UNRECOGNISED_FORMAT
,

356 
	mSFE_SYSTEM
 = 
SF_ERR_SYSTEM
,

357 
	mSFE_MALFORMED_FILE
 = 
SF_ERR_MALFORMED_FILE
,

358 
	mSFE_UNSUPPORTED_ENCODING
 = 
SF_ERR_UNSUPPORTED_ENCODING
,

360 
	mSFE_BAD_FILE
,

361 
	mSFE_BAD_FILE_READ
,

362 
	mSFE_OPEN_FAILED
,

363 
	mSFE_BAD_SNDFILE_PTR
,

364 
	mSFE_BAD_SF_INFO_PTR
,

365 
	mSFE_BAD_SF_INCOMPLETE
,

366 
	mSFE_BAD_FILE_PTR
,

367 
	mSFE_BAD_INT_PTR
,

368 
	mSFE_BAD_STAT_SIZE
,

369 
	mSFE_MALLOC_FAILED
,

370 
	mSFE_UNIMPLEMENTED
,

371 
	mSFE_BAD_READ_ALIGN
,

372 
	mSFE_BAD_WRITE_ALIGN
,

373 
	mSFE_UNKNOWN_FORMAT
,

374 
	mSFE_NOT_READMODE
,

375 
	mSFE_NOT_WRITEMODE
,

376 
	mSFE_BAD_MODE_RW
,

377 
	mSFE_BAD_SF_INFO
,

378 
	mSFE_BAD_OFFSET
,

379 
	mSFE_NO_EMBED_SUPPORT
,

380 
	mSFE_NO_EMBEDDED_RDWR
,

381 
	mSFE_NO_PIPE_WRITE
,

383 
	mSFE_INTERNAL
,

384 
	mSFE_BAD_CONTROL_CMD
,

385 
	mSFE_BAD_ENDIAN
,

386 
	mSFE_CHANNEL_COUNT
,

387 
	mSFE_BAD_RDWR_FORMAT
,

389 
	mSFE_BAD_VIRTUAL_IO
,

391 
	mSFE_INTERLEAVE_MODE
,

392 
	mSFE_INTERLEAVE_SEEK
,

393 
	mSFE_INTERLEAVE_READ
,

395 
	mSFE_BAD_SEEK
,

396 
	mSFE_NOT_SEEKABLE
,

397 
	mSFE_AMBIGUOUS_SEEK
,

398 
	mSFE_WRONG_SEEK
,

399 
	mSFE_SEEK_FAILED
,

401 
	mSFE_BAD_OPEN_MODE
,

402 
	mSFE_OPEN_PIPE_RDWR
,

403 
	mSFE_RDWR_POSITION
,

404 
	mSFE_RDWR_BAD_HEADER
,

406 
	mSFE_STR_NO_SUPPORT
,

407 
	mSFE_STR_NOT_WRITE
,

408 
	mSFE_STR_MAX_DATA
,

409 
	mSFE_STR_MAX_COUNT
,

410 
	mSFE_STR_BAD_TYPE
,

411 
	mSFE_STR_NO_ADD_END
,

412 
	mSFE_STR_BAD_STRING
,

413 
	mSFE_STR_WEIRD
,

415 
	mSFE_WAV_NO_RIFF
,

416 
	mSFE_WAV_NO_WAVE
,

417 
	mSFE_WAV_NO_FMT
,

418 
	mSFE_WAV_FMT_SHORT
,

419 
	mSFE_WAV_BAD_FACT
,

420 
	mSFE_WAV_BAD_PEAK
,

421 
	mSFE_WAV_PEAK_B4_FMT
,

422 
	mSFE_WAV_BAD_FORMAT
,

423 
	mSFE_WAV_BAD_BLOCKALIGN
,

424 
	mSFE_WAV_NO_DATA
,

425 
	mSFE_WAV_BAD_LIST
,

426 
	mSFE_WAV_ADPCM_NOT4BIT
,

427 
	mSFE_WAV_ADPCM_CHANNELS
,

428 
	mSFE_WAV_GSM610_FORMAT
,

429 
	mSFE_WAV_UNKNOWN_CHUNK
,

430 
	mSFE_WAV_WVPK_DATA
,

432 
	mSFE_AIFF_NO_FORM
,

433 
	mSFE_AIFF_AIFF_NO_FORM
,

434 
	mSFE_AIFF_COMM_NO_FORM
,

435 
	mSFE_AIFF_SSND_NO_COMM
,

436 
	mSFE_AIFF_UNKNOWN_CHUNK
,

437 
	mSFE_AIFF_COMM_CHUNK_SIZE
,

438 
	mSFE_AIFF_BAD_COMM_CHUNK
,

439 
	mSFE_AIFF_PEAK_B4_COMM
,

440 
	mSFE_AIFF_BAD_PEAK
,

441 
	mSFE_AIFF_NO_SSND
,

442 
	mSFE_AIFF_NO_DATA
,

443 
	mSFE_AIFF_RW_SSND_NOT_LAST
,

445 
	mSFE_AU_UNKNOWN_FORMAT
,

446 
	mSFE_AU_NO_DOTSND
,

447 
	mSFE_AU_EMBED_BAD_LEN
,

449 
	mSFE_RAW_READ_BAD_SPEC
,

450 
	mSFE_RAW_BAD_BITWIDTH
,

451 
	mSFE_RAW_BAD_FORMAT
,

453 
	mSFE_PAF_NO_MARKER
,

454 
	mSFE_PAF_VERSION
,

455 
	mSFE_PAF_UNKNOWN_FORMAT
,

456 
	mSFE_PAF_SHORT_HEADER
,

458 
	mSFE_SVX_NO_FORM
,

459 
	mSFE_SVX_NO_BODY
,

460 
	mSFE_SVX_NO_DATA
,

461 
	mSFE_SVX_BAD_COMP
,

462 
	mSFE_SVX_BAD_NAME_LENGTH
,

464 
	mSFE_NIST_BAD_HEADER
,

465 
	mSFE_NIST_CRLF_CONVERISON
,

466 
	mSFE_NIST_BAD_ENCODING
,

468 
	mSFE_VOC_NO_CREATIVE
,

469 
	mSFE_VOC_BAD_FORMAT
,

470 
	mSFE_VOC_BAD_VERSION
,

471 
	mSFE_VOC_BAD_MARKER
,

472 
	mSFE_VOC_BAD_SECTIONS
,

473 
	mSFE_VOC_MULTI_SAMPLERATE
,

474 
	mSFE_VOC_MULTI_SECTION
,

475 
	mSFE_VOC_MULTI_PARAM
,

476 
	mSFE_VOC_SECTION_COUNT
,

477 
	mSFE_VOC_NO_PIPE
,

479 
	mSFE_IRCAM_NO_MARKER
,

480 
	mSFE_IRCAM_BAD_CHANNELS
,

481 
	mSFE_IRCAM_UNKNOWN_FORMAT
,

483 
	mSFE_W64_64_BIT
,

484 
	mSFE_W64_NO_RIFF
,

485 
	mSFE_W64_NO_WAVE
,

486 
	mSFE_W64_NO_FMT
,

487 
	mSFE_W64_NO_DATA
,

488 
	mSFE_W64_FMT_SHORT
,

489 
	mSFE_W64_FMT_TOO_BIG
,

490 
	mSFE_W64_ADPCM_NOT4BIT
,

491 
	mSFE_W64_ADPCM_CHANNELS
,

492 
	mSFE_W64_GSM610_FORMAT
,

494 
	mSFE_MAT4_BAD_NAME
,

495 
	mSFE_MAT4_NO_SAMPLERATE
,

496 
	mSFE_MAT4_ZERO_CHANNELS
,

498 
	mSFE_MAT5_BAD_ENDIAN
,

499 
	mSFE_MAT5_NO_BLOCK
,

500 
	mSFE_MAT5_SAMPLE_RATE
,

501 
	mSFE_MAT5_ZERO_CHANNELS
,

503 
	mSFE_PVF_NO_PVF1
,

504 
	mSFE_PVF_BAD_HEADER
,

505 
	mSFE_PVF_BAD_BITWIDTH
,

507 
	mSFE_DWVW_BAD_BITWIDTH
,

508 
	mSFE_G72X_NOT_MONO
,

510 
	mSFE_XI_BAD_HEADER
,

511 
	mSFE_XI_EXCESS_SAMPLES
,

512 
	mSFE_XI_NO_PIPE
,

514 
	mSFE_HTK_NO_PIPE
,

516 
	mSFE_SDS_NOT_SDS
,

517 
	mSFE_SDS_BAD_BIT_WIDTH
,

519 
	mSFE_SD2_FD_DISALLOWED
,

520 
	mSFE_SD2_BAD_DATA_OFFSET
,

521 
	mSFE_SD2_BAD_MAP_OFFSET
,

522 
	mSFE_SD2_BAD_DATA_LENGTH
,

523 
	mSFE_SD2_BAD_MAP_LENGTH
,

524 
	mSFE_SD2_BAD_RSRC
,

525 
	mSFE_SD2_BAD_SAMPLE_SIZE
,

527 
	mSFE_FLAC_BAD_HEADER
,

528 
	mSFE_FLAC_NEW_DECODER
,

529 
	mSFE_FLAC_INIT_DECODER
,

530 
	mSFE_FLAC_LOST_SYNC
,

531 
	mSFE_FLAC_BAD_SAMPLE_RATE
,

532 
	mSFE_FLAC_UNKOWN_ERROR
,

534 
	mSFE_MAX_ERROR


537 
subf‹m©_to_byãwidth
 (
f‹m©
) ;

538 
s_bôwidth_to_subf‹m©
 (
bôs
) ;

539 
u_bôwidth_to_subf‹m©
 (
bôs
) ;

544 
Êﬂt32_be_ªad
 (*
˝å
) ;

545 
Êﬂt32_À_ªad
 (*
˝å
) ;

546 
Êﬂt32_be_wrôe
 (
ö
, *
out
) ;

547 
Êﬂt32_À_wrôe
 (
ö
, *
out
) ;

549 
doubÀ64_be_ªad
 (*
˝å
) ;

550 
doubÀ64_À_ªad
 (*
˝å
) ;

551 
doubÀ64_be_wrôe
 (
ö
, *
out
) ;

552 
doubÀ64_À_wrôe
 (
ö
, *
out
) ;

556 
psf_log_¥ötf
 (
SF_PRIVATE
 *
psf
, c⁄° *
f‹m©
, ...) ;

557 
psf_log_SF_INFO
 (
SF_PRIVATE
 *
psf
) ;

559 
psf_hexdump
 (*
±r
, 
Àn
) ;

563 
psf_böhódî_wrôef
 (
SF_PRIVATE
 *
psf
, c⁄° *
f‹m©
, ...) ;

564 
psf_asciihódî_¥ötf
 (
SF_PRIVATE
 *
psf
, c⁄° *
f‹m©
, ...) ;

568 
psf_böhódî_ªadf
 (
SF_PRIVATE
 *
psf
, c⁄° *
f‹m©
, ...) ;

572 
≥ak_upd©e_sh‹t
 (
SF_PRIVATE
 *
psf
, *
±r
, 
size_t
 
ôems
) ;

573 
≥ak_upd©e_öt
 (
SF_PRIVATE
 *
psf
, *
±r
, 
size_t
 
ôems
) ;

574 
≥ak_upd©e_doubÀ
 (
SF_PRIVATE
 *
psf
, *
±r
, 
size_t
 
ôems
) ;

578 
psf_gë_f‹m©_sim∂e_cou¡
 () ;

579 
psf_gë_f‹m©_sim∂e
 (
SF_FORMAT_INFO
 *
d©a
) ;

581 
psf_gë_f‹m©_öfo
 (
SF_FORMAT_INFO
 *
d©a
) ;

583 
psf_gë_f‹m©_maj‹_cou¡
 () ;

584 
psf_gë_f‹m©_maj‹
 (
SF_FORMAT_INFO
 *
d©a
) ;

586 
psf_gë_f‹m©_subty≥_cou¡
 () ;

587 
psf_gë_f‹m©_subty≥
 (
SF_FORMAT_INFO
 *
d©a
) ;

589 
psf_gíî©e_f‹m©_desc
 (
SF_PRIVATE
 *
psf
) ;

591 
psf_ˇlc_sig«l_max
 (
SF_PRIVATE
 *
psf
, 
n‹mÆize
) ;

592 
psf_ˇlc_max_Æl_ch™√ls
 (
SF_PRIVATE
 *
psf
, *
≥aks
, 
n‹mÆize
) ;

594 
psf_gë_sig«l_max
 (
SF_PRIVATE
 *
psf
, *
≥ak
) ;

595 
psf_gë_max_Æl_ch™√ls
 (
SF_PRIVATE
 *
psf
, *
≥aks
) ;

599 c⁄° * 
psf_gë_°rög
 (
SF_PRIVATE
 *
psf
, 
°r_ty≥
) ;

600 
psf_£t_°rög
 (
SF_PRIVATE
 *
psf
, 
°r_ty≥
, c⁄° *
°r
) ;

601 
psf_°‹e_°rög
 (
SF_PRIVATE
 *
psf
, 
°r_ty≥
, c⁄° *
°r
) ;

604 
sf_cou¡_t
 
psf_deÁu…_£ek
 (
SF_PRIVATE
 *
psf
, 
mode
, sf_cou¡_à
ßm∂es_‰om_°¨t
) ;

607 
psf_gë_d©e_°r
 (*
°r
, 
maxÀn
) ;

609 
macos_guess_fûe_ty≥
 (
SF_PRIVATE
 *
psf
, c⁄° *
fûíame
) ;

616 
psf_f›í
 (
SF_PRIVATE
 *
psf
, c⁄° *
∑th«me
, 
Êags
) ;

617 
psf_£t_°dio
 (
SF_PRIVATE
 *
psf
, 
mode
) ;

618 
psf_fûe_vÆid
 (
SF_PRIVATE
 *
psf
) ;

619 
psf_£t_fûe
 (
SF_PRIVATE
 *
psf
, 
fd
) ;

620 
psf_öô_fûes
 (
SF_PRIVATE
 *
psf
) ;

621 
psf_u£_r§c
 (
SF_PRIVATE
 *
psf
, 
⁄_off
) ;

623 
sf_cou¡_t
 
psf_f£ek
 (
SF_PRIVATE
 *
psf
, sf_cou¡_à
off£t
, 
whí˚
) ;

624 
sf_cou¡_t
 
psf_‰ód
 (*
±r
, sf_cou¡_à
byãs
, sf_cou¡_à
cou¡
, 
SF_PRIVATE
 *
psf
) ;

625 
sf_cou¡_t
 
psf_fwrôe
 (c⁄° *
±r
, sf_cou¡_à
byãs
, sf_cou¡_à
cou¡
, 
SF_PRIVATE
 *
psf
) ;

626 
sf_cou¡_t
 
psf_fgës
 (*
buf„r
, sf_cou¡_à
bufsize
, 
SF_PRIVATE
 *
psf
) ;

627 
sf_cou¡_t
 
psf_·ñl
 (
SF_PRIVATE
 *
psf
) ;

628 
sf_cou¡_t
 
psf_gë_fûñí
 (
SF_PRIVATE
 *
psf
) ;

630 
psf_fsync
 (
SF_PRIVATE
 *
psf
) ;

632 
psf_is_pùe
 (
SF_PRIVATE
 *
psf
) ;

634 
psf_·runˇã
 (
SF_PRIVATE
 *
psf
, 
sf_cou¡_t
 
Àn
) ;

635 
psf_f˛o£
 (
SF_PRIVATE
 *
psf
) ;

638 
psf_›í_r§c
 (
SF_PRIVATE
 *
psf
, 
mode
) ;

639 
psf_˛o£_r§c
 (
SF_PRIVATE
 *
psf
) ;

650 
aiff_›í
 (
SF_PRIVATE
 *
psf
) ;

651 
au_›í
 (
SF_PRIVATE
 *
psf
) ;

652 
avr_›í
 (
SF_PRIVATE
 *
psf
) ;

653 
htk_›í
 (
SF_PRIVATE
 *
psf
) ;

654 
úˇm_›í
 (
SF_PRIVATE
 *
psf
) ;

655 
m©4_›í
 (
SF_PRIVATE
 *
psf
) ;

656 
m©5_›í
 (
SF_PRIVATE
 *
psf
) ;

657 
ni°_›í
 (
SF_PRIVATE
 *
psf
) ;

658 
∑f_›í
 (
SF_PRIVATE
 *
psf
) ;

659 
pvf_›í
 (
SF_PRIVATE
 *
psf
) ;

660 
øw_›í
 (
SF_PRIVATE
 *
psf
) ;

661 
sd2_›í
 (
SF_PRIVATE
 *
psf
) ;

662 
sds_›í
 (
SF_PRIVATE
 *
psf
) ;

663 
svx_›í
 (
SF_PRIVATE
 *
psf
) ;

664 
voc_›í
 (
SF_PRIVATE
 *
psf
) ;

665 
w64_›í
 (
SF_PRIVATE
 *
psf
) ;

666 
wav_›í
 (
SF_PRIVATE
 *
psf
) ;

667 
xi_›í
 (
SF_PRIVATE
 *
psf
) ;

668 
Êac_›í
 (
SF_PRIVATE
 *
psf
) ;

669 
ˇf_›í
 (
SF_PRIVATE
 *
psf
) ;

673 
m≥g_›í
 (
SF_PRIVATE
 *
psf
) ;

674 
ogg_›í
 (
SF_PRIVATE
 *
psf
) ;

675 
rx2_›í
 (
SF_PRIVATE
 *
psf
) ;

676 
txw_›í
 (
SF_PRIVATE
 *
psf
) ;

677 
wve_›í
 (
SF_PRIVATE
 *
psf
) ;

678 
dwd_›í
 (
SF_PRIVATE
 *
psf
) ;

680 
macbö¨y3_›í
 (
SF_PRIVATE
 *
psf
) ;

686 
pcm_öô
 (
SF_PRIVATE
 *
psf
) ;

687 
uœw_öô
 (
SF_PRIVATE
 *
psf
) ;

688 
Æaw_öô
 (
SF_PRIVATE
 *
psf
) ;

689 
Êﬂt32_öô
 (
SF_PRIVATE
 *
psf
) ;

690 
doubÀ64_öô
 (
SF_PRIVATE
 *
psf
) ;

691 
dwvw_öô
 (
SF_PRIVATE
 *
psf
, 
bôwidth
) ;

692 
gsm610_öô
 (
SF_PRIVATE
 *
psf
) ;

693 
vox_adpcm_öô
 (
SF_PRIVATE
 *
psf
) ;

694 
Êac_öô
 (
SF_PRIVATE
 *
psf
) ;

695 
g72x_öô
 (
SF_PRIVATE
 * 
psf
) ;

697 
dôhî_öô
 (
SF_PRIVATE
 *
psf
, 
mode
) ;

699 
wav_w64_ima_öô
 (
SF_PRIVATE
 *
psf
, 
blockÆign
, 
ßm∂e•îblock
) ;

700 
wav_w64_mßdpcm_öô
 (
SF_PRIVATE
 *
psf
, 
blockÆign
, 
ßm∂e•îblock
) ;

702 
aiff_ima_öô
 (
SF_PRIVATE
 *
psf
, 
blockÆign
, 
ßm∂e•îblock
) ;

704 
öãæóve_öô
 (
SF_PRIVATE
 *
psf
) ;

710 *
psf_mem£t
 (*
s
, 
c
, 
sf_cou¡_t
 
n
) ;

712 
SF_INSTRUMENT
 * 
psf_ö°rumít_Æloc
 () ;

715 
SF_BROADCAST_INFO
* 
brﬂdˇ°_öfo_Æloc
 () ;

716 
brﬂdˇ°_öfo_c›y
 (
SF_BROADCAST_INFO
* 
d°
, SF_BROADCAST_INFO* 
§c
) ;

717 
brﬂdˇ°_add_codög_hi°‹y
 (
SF_BROADCAST_INFO
* 
bext
, 
ch™√ls
, 
ßm∂î©e
) ;

724 #i‡
USE_WINDOWS_API


725 
	#LSF_SNPRINTF
 
_¢¥ötf


	)

726 #ñif (
HAVE_SNPRINTF
 && ! 
FORCE_MISSING_SNPRINTF
)

727 
	#LSF_SNPRINTF
 
¢¥ötf


	)

729 
missög_¢¥ötf
 (*
°r
, 
size_t
 
n
, c⁄° *
fmt
, ...) ;

730 
	#LSF_SNPRINTF
 
missög_¢¥ötf


	)

733 #i‡
USE_WINDOWS_API


734 
	#LSF_VSNPRINTF
 
_v¢¥ötf


	)

735 #ñif (
HAVE_VSNPRINTF
 && ! 
FORCE_MISSING_SNPRINTF
)

736 
	#LSF_VSNPRINTF
 
v¢¥ötf


	)

738 
missög_v¢¥ötf
 (*
°r
, 
size_t
 
n
, c⁄° *
fmt
, ...) ;

739 
	#LSF_VSNPRINTF
 
missög_v¢¥ötf


	)

747 { 
	mSFC_TEST_AIFF_ADD_INST_CHUNK
 = 0x2000,

748 
	mSFC_TEST_WAV_ADD_INFO_CHUNK
 = 0x2010

759 
sf_dôhî_sh‹t
 (c⁄° 
SF_DITHER_INFO
 *
dôhî
, c⁄° *
ö
, *
out
, 
cou¡
) ;

760 
sf_dôhî_öt
 (c⁄° 
SF_DITHER_INFO
 *
dôhî
, c⁄° *
ö
, *
out
, 
cou¡
) ;

761 
sf_dôhî_Êﬂt
 (c⁄° 
SF_DITHER_INFO
 *
dôhî
, c⁄° *
ö
, *
out
, 
cou¡
) ;

762 
sf_dôhî_doubÀ
 (c⁄° 
SF_DITHER_INFO
 *
dôhî
, c⁄° *
ö
, *
out
, 
cou¡
) ;

	@libsndfile-1.0.17/src/dither.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dlib.h
>

23 
	~"¢dfûe.h
"

24 
	~"s„ndün.h
"

25 
	~"comm⁄.h
"

56 
	#SFE_DITHER_BAD_PTR
 666

	)

57 
	#SFE_DITHER_BAD_TYPE
 667

	)

60 { 
	mªad_sh‹t_dôhî_bôs
, 
	mªad_öt_dôhî_bôs
 ;

61 
	mwrôe_sh‹t_dôhî_bôs
, 
	mwrôe_öt_dôhî_bôs
 ;

62 
	mªad_Êﬂt_dôhî_sˇÀ
, 
	mªad_doubÀ_dôhî_bôs
 ;

63 
	mwrôe_Êﬂt_dôhî_sˇÀ
, 
	mwrôe_doubÀ_dôhî_bôs
 ;

65 
sf_cou¡_t
 (*
ªad_sh‹t
Ë(
SF_PRIVATE
 *
	mpsf
, *
	m±r
, sf_cou¡_à
	mÀn
) ;

66 
sf_cou¡_t
 (*
ªad_öt
Ë(
SF_PRIVATE
 *
	mpsf
, *
	m±r
, sf_cou¡_à
	mÀn
) ;

67 
sf_cou¡_t
 (*
ªad_Êﬂt
Ë(
SF_PRIVATE
 *
	mpsf
, *
	m±r
, sf_cou¡_à
	mÀn
) ;

68 
sf_cou¡_t
 (*
ªad_doubÀ
Ë(
SF_PRIVATE
 *
	mpsf
, *
	m±r
, sf_cou¡_à
	mÀn
) ;

70 
sf_cou¡_t
 (*
wrôe_sh‹t
Ë(
SF_PRIVATE
 *
	mpsf
, c⁄° *
	m±r
, sf_cou¡_à
	mÀn
) ;

71 
sf_cou¡_t
 (*
wrôe_öt
Ë(
SF_PRIVATE
 *
	mpsf
, c⁄° *
	m±r
, sf_cou¡_à
	mÀn
) ;

72 
sf_cou¡_t
 (*
wrôe_Êﬂt
Ë(
SF_PRIVATE
 *
	mpsf
, c⁄° *
	m±r
, sf_cou¡_à
	mÀn
) ;

73 
sf_cou¡_t
 (*
wrôe_doubÀ
Ë(
SF_PRIVATE
 *
	mpsf
, c⁄° *
	m±r
, sf_cou¡_à
	mÀn
) ;

75 
	mbuf„r
 [
SF_BUFFER_LEN
 /  ()] ;

76 } 
	tDITHER_DATA
 ;

78 
sf_cou¡_t
 
dôhî_ªad_sh‹t
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

79 
sf_cou¡_t
 
dôhî_ªad_öt
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

81 
sf_cou¡_t
 
dôhî_wrôe_sh‹t
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

82 
sf_cou¡_t
 
dôhî_wrôe_öt
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

83 
sf_cou¡_t
 
dôhî_wrôe_Êﬂt
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

84 
sf_cou¡_t
 
dôhî_wrôe_doubÀ
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

87 
	$dôhî_öô
 (
SF_PRIVATE
 *
psf
, 
mode
)

88 { 
DITHER_DATA
 *
pdôhî
 ;

90 
pdôhî
 = 
psf
->
dôhî
 ;

93 i‡(
mode
 =
SFM_READ
 && 
psf
->
ªad_dôhî
.
ty≥
 =
SFD_NO_DITHER
)

94 { i‡(
pdôhî
 =
NULL
)

97 i‡(
pdôhî
->
ªad_sh‹t
)

98 
psf
->
ªad_sh‹t
 = 
pdôhî
->read_short ;

99 i‡(
pdôhî
->
ªad_öt
)

100 
psf
->
ªad_öt
 = 
pdôhî
->read_int ;

101 i‡(
pdôhî
->
ªad_Êﬂt
)

102 
psf
->
ªad_Êﬂt
 = 
pdôhî
->read_float ;

103 i‡(
pdôhî
->
ªad_doubÀ
)

104 
psf
->
ªad_doubÀ
 = 
pdôhî
->read_double ;

109 i‡(
mode
 =
SFM_WRITE
 && 
psf
->
wrôe_dôhî
.
ty≥
 =
SFD_NO_DITHER
)

110 { i‡(
pdôhî
 =
NULL
)

113 i‡(
pdôhî
->
wrôe_sh‹t
)

114 
psf
->
wrôe_sh‹t
 = 
pdôhî
->write_short ;

115 i‡(
pdôhî
->
wrôe_öt
)

116 
psf
->
wrôe_öt
 = 
pdôhî
->write_int ;

117 i‡(
pdôhî
->
wrôe_Êﬂt
)

118 
psf
->
wrôe_Êﬂt
 = 
pdôhî
->write_float ;

119 i‡(
pdôhî
->
wrôe_doubÀ
)

120 
psf
->
wrôe_doubÀ
 = 
pdôhî
->write_double ;

125 i‡(
mode
 =
SFM_READ
 && 
psf
->
ªad_dôhî
.
ty≥
 != 0)

126 { i‡(
pdôhî
 =
NULL
)

127 
pdôhî
 = 
psf
->
dôhî
 = 
	`ˇŒoc
 (1,  (
DITHER_DATA
)) ;

128 i‡(
pdôhî
 =
NULL
)

129  
SFE_MALLOC_FAILED
 ;

131 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
)

132 { 
SF_FORMAT_DOUBLE
 :

133 
SF_FORMAT_FLOAT
 :

134 
pdôhî
->
ªad_öt
 = 
psf
->read_int ;

135 
psf
->
ªad_öt
 = 
dôhî_ªad_öt
 ;

137 
SF_FORMAT_PCM_32
 :

138 
SF_FORMAT_PCM_24
 :

139 
SF_FORMAT_PCM_16
 :

140 
SF_FORMAT_PCM_S8
 :

141 
SF_FORMAT_PCM_U8
 :

142 
pdôhî
->
ªad_sh‹t
 = 
psf
->read_short ;

143 
psf
->
ªad_sh‹t
 = 
dôhî_ªad_sh‹t
 ;

150 i‡(
mode
 =
SFM_WRITE
 && 
psf
->
wrôe_dôhî
.
ty≥
 != 0)

151 { i‡(
pdôhî
 =
NULL
)

152 
pdôhî
 = 
psf
->
dôhî
 = 
	`ˇŒoc
 (1,  (
DITHER_DATA
)) ;

153 i‡(
pdôhî
 =
NULL
)

154  
SFE_MALLOC_FAILED
 ;

156 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
)

157 { 
SF_FORMAT_DOUBLE
 :

158 
SF_FORMAT_FLOAT
 :

159 
pdôhî
->
wrôe_öt
 = 
psf
->write_int ;

160 
psf
->
wrôe_öt
 = 
dôhî_wrôe_öt
 ;

162 
SF_FORMAT_PCM_32
 :

163 
SF_FORMAT_PCM_24
 :

164 
SF_FORMAT_PCM_16
 :

165 
SF_FORMAT_PCM_S8
 :

166 
SF_FORMAT_PCM_U8
 :

171 
pdôhî
->
wrôe_sh‹t
 = 
psf
->write_short ;

172 
psf
->
wrôe_sh‹t
 = 
dôhî_wrôe_sh‹t
 ;

174 
pdôhî
->
wrôe_öt
 = 
psf
->write_int ;

175 
psf
->
wrôe_öt
 = 
dôhî_wrôe_öt
 ;

177 
pdôhî
->
wrôe_Êﬂt
 = 
psf
->write_float ;

178 
psf
->
wrôe_Êﬂt
 = 
dôhî_wrôe_Êﬂt
 ;

180 
pdôhî
->
wrôe_doubÀ
 = 
psf
->write_double ;

181 
psf
->
wrôe_doubÀ
 = 
dôhî_wrôe_doubÀ
 ;

185 
	}
}

190 
dôhî_sh‹t
 (c⁄° *
ö
, *
out
, 
‰ames
, 
ch™√ls
) ;

191 
dôhî_öt
 (c⁄° *
ö
, *
out
, 
‰ames
, 
ch™√ls
) ;

193 
dôhî_Êﬂt
 (c⁄° *
ö
, *
out
, 
‰ames
, 
ch™√ls
) ;

194 
dôhî_doubÀ
 (c⁄° *
ö
, *
out
, 
‰ames
, 
ch™√ls
) ;

196 
sf_cou¡_t


197 
	$dôhî_ªad_sh‹t
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

198 { 
psf
 =Ösf ;

199 
±r
 =Ötr ;

200  
Àn
 ;

201 
	}
}

203 
sf_cou¡_t


204 
	$dôhî_ªad_öt
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

205 { 
psf
 =Ösf ;

206 
±r
 =Ötr ;

207  
Àn
 ;

208 
	}
}

213 
sf_cou¡_t


214 
	$dôhî_wrôe_sh‹t
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

215 { 
DITHER_DATA
 *
pdôhî
 ;

216 
buf„æí
, 
wrôecou¡
, 
thiswrôe
 ;

217 
sf_cou¡_t
 
tŸÆ
 = 0 ;

219 i‡((
pdôhî
 = 
psf
->
dôhî
Ë=
NULL
)

220 { 
psf
->
îr‹
 = 
SFE_DITHER_BAD_PTR
 ;

224 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
)

225 { 
SF_FORMAT_PCM_S8
 :

226 
SF_FORMAT_PCM_U8
 :

227 
SF_FORMAT_DPCM_8
 :

231  
pdôhî
->
	`wrôe_sh‹t
 (
psf
, 
±r
, 
Àn
) ;

234 
buf„æí
 =  (
pdôhî
->
buf„r
) /  () ;

236 
Àn
 > 0)

237 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen : ()Üen ;

238 
wrôecou¡
 /
psf
->
sf
.
ch™√ls
 ;

239 
wrôecou¡
 *
psf
->
sf
.
ch™√ls
 ;

241 
	`dôhî_sh‹t
 (
±r
, (*Ë
pdôhî
->
buf„r
, 
wrôecou¡
 / 
psf
->
sf
.
ch™√ls
,Ösf->sf.channels) ;

243 
thiswrôe
 = 
pdôhî
->
	`wrôe_sh‹t
 (
psf
, (*Ëpdôhî->
buf„r
, 
wrôecou¡
) ;

244 
tŸÆ
 +
thiswrôe
 ;

245 
Àn
 -
thiswrôe
 ;

246 i‡(
thiswrôe
 < 
wrôecou¡
)

250  
tŸÆ
 ;

251 
	}
}

253 
sf_cou¡_t


254 
	$dôhî_wrôe_öt
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

255 { 
DITHER_DATA
 *
pdôhî
 ;

256 
buf„æí
, 
wrôecou¡
, 
thiswrôe
 ;

257 
sf_cou¡_t
 
tŸÆ
 = 0 ;

259 i‡((
pdôhî
 = 
psf
->
dôhî
Ë=
NULL
)

260 { 
psf
->
îr‹
 = 
SFE_DITHER_BAD_PTR
 ;

264 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
)

265 { 
SF_FORMAT_PCM_S8
 :

266 
SF_FORMAT_PCM_U8
 :

267 
SF_FORMAT_PCM_16
 :

268 
SF_FORMAT_PCM_24
 :

270 
SF_FORMAT_DPCM_8
 :

271 
SF_FORMAT_DPCM_16
 :

275  
pdôhî
->
	`wrôe_öt
 (
psf
, 
±r
, 
Àn
) ;

279 
buf„æí
 =  (
pdôhî
->
buf„r
) /  () ;

281 
Àn
 > 0)

282 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen : ()Üen ;

283 
wrôecou¡
 /
psf
->
sf
.
ch™√ls
 ;

284 
wrôecou¡
 *
psf
->
sf
.
ch™√ls
 ;

286 
	`dôhî_öt
 (
±r
, (*Ë
pdôhî
->
buf„r
, 
wrôecou¡
 / 
psf
->
sf
.
ch™√ls
,Ösf->sf.channels) ;

288 
thiswrôe
 = 
pdôhî
->
	`wrôe_öt
 (
psf
, (*Ëpdôhî->
buf„r
, 
wrôecou¡
) ;

289 
tŸÆ
 +
thiswrôe
 ;

290 
Àn
 -
thiswrôe
 ;

291 i‡(
thiswrôe
 < 
wrôecou¡
)

295  
tŸÆ
 ;

296 
	}
}

298 
sf_cou¡_t


299 
	$dôhî_wrôe_Êﬂt
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

300 { 
DITHER_DATA
 *
pdôhî
 ;

301 
buf„æí
, 
wrôecou¡
, 
thiswrôe
 ;

302 
sf_cou¡_t
 
tŸÆ
 = 0 ;

304 i‡((
pdôhî
 = 
psf
->
dôhî
Ë=
NULL
)

305 { 
psf
->
îr‹
 = 
SFE_DITHER_BAD_PTR
 ;

309 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
)

310 { 
SF_FORMAT_PCM_S8
 :

311 
SF_FORMAT_PCM_U8
 :

312 
SF_FORMAT_PCM_16
 :

313 
SF_FORMAT_PCM_24
 :

315 
SF_FORMAT_DPCM_8
 :

316 
SF_FORMAT_DPCM_16
 :

320  
pdôhî
->
	`wrôe_Êﬂt
 (
psf
, 
±r
, 
Àn
) ;

323 
buf„æí
 =  (
pdôhî
->
buf„r
) /  () ;

325 
Àn
 > 0)

326 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen : ()Üen ;

327 
wrôecou¡
 /
psf
->
sf
.
ch™√ls
 ;

328 
wrôecou¡
 *
psf
->
sf
.
ch™√ls
 ;

330 
	`dôhî_Êﬂt
 (
±r
, (*Ë
pdôhî
->
buf„r
, 
wrôecou¡
 / 
psf
->
sf
.
ch™√ls
,Ösf->sf.channels) ;

332 
thiswrôe
 = 
pdôhî
->
	`wrôe_Êﬂt
 (
psf
, (*Ëpdôhî->
buf„r
, 
wrôecou¡
) ;

333 
tŸÆ
 +
thiswrôe
 ;

334 
Àn
 -
thiswrôe
 ;

335 i‡(
thiswrôe
 < 
wrôecou¡
)

339  
tŸÆ
 ;

340 
	}
}

342 
sf_cou¡_t


343 
	$dôhî_wrôe_doubÀ
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

344 { 
DITHER_DATA
 *
pdôhî
 ;

345 
buf„æí
, 
wrôecou¡
, 
thiswrôe
 ;

346 
sf_cou¡_t
 
tŸÆ
 = 0 ;

348 i‡((
pdôhî
 = 
psf
->
dôhî
Ë=
NULL
)

349 { 
psf
->
îr‹
 = 
SFE_DITHER_BAD_PTR
 ;

353 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
)

354 { 
SF_FORMAT_PCM_S8
 :

355 
SF_FORMAT_PCM_U8
 :

356 
SF_FORMAT_PCM_16
 :

357 
SF_FORMAT_PCM_24
 :

359 
SF_FORMAT_DPCM_8
 :

360 
SF_FORMAT_DPCM_16
 :

364  
pdôhî
->
	`wrôe_doubÀ
 (
psf
, 
±r
, 
Àn
) ;

368 
buf„æí
 =  (
pdôhî
->
buf„r
) /  () ;

370 
Àn
 > 0)

371 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen : ()Üen ;

372 
wrôecou¡
 /
psf
->
sf
.
ch™√ls
 ;

373 
wrôecou¡
 *
psf
->
sf
.
ch™√ls
 ;

375 
	`dôhî_doubÀ
 (
±r
, (*Ë
pdôhî
->
buf„r
, 
wrôecou¡
 / 
psf
->
sf
.
ch™√ls
,Ösf->sf.channels) ;

377 
thiswrôe
 = 
pdôhî
->
	`wrôe_doubÀ
 (
psf
, (*Ëpdôhî->
buf„r
, 
wrôecou¡
) ;

378 
tŸÆ
 +
thiswrôe
 ;

379 
Àn
 -
thiswrôe
 ;

380 i‡(
thiswrôe
 < 
wrôecou¡
)

384  
tŸÆ
 ;

385 
	}
}

391 
	$dôhî_sh‹t
 (c⁄° *
ö
, *
out
, 
‰ames
, 
ch™√ls
)

392 { 
ch
, 
k
 ;

394 
ch
 = 0 ; ch < 
ch™√ls
 ; ch++)

395 
k
 = 
ch
 ; k < 
ch™√ls
 * 
‰ames
 ; k += channels)

396 
out
 [
k
] = 
ö
 [k] ;

398 
	}
}

401 
	$dôhî_öt
 (c⁄° *
ö
, *
out
, 
‰ames
, 
ch™√ls
)

402 { 
ch
, 
k
 ;

404 
ch
 = 0 ; ch < 
ch™√ls
 ; ch++)

405 
k
 = 
ch
 ; k < 
ch™√ls
 * 
‰ames
 ; k += channels)

406 
out
 [
k
] = 
ö
 [k] ;

408 
	}
}

411 
	$dôhî_Êﬂt
 (c⁄° *
ö
, *
out
, 
‰ames
, 
ch™√ls
)

412 { 
ch
, 
k
 ;

414 
ch
 = 0 ; ch < 
ch™√ls
 ; ch++)

415 
k
 = 
ch
 ; k < 
ch™√ls
 * 
‰ames
 ; k += channels)

416 
out
 [
k
] = 
ö
 [k] ;

418 
	}
}

421 
	$dôhî_doubÀ
 (c⁄° *
ö
, *
out
, 
‰ames
, 
ch™√ls
)

422 { 
ch
, 
k
 ;

424 
ch
 = 0 ; ch < 
ch™√ls
 ; ch++)

425 
k
 = 
ch
 ; k < 
ch™√ls
 * 
‰ames
 ; k += channels)

426 
out
 [
k
] = 
ö
 [k] ;

428 
	}
}

441 
	$DO_NOT_USE_sf_dôhî_sh‹t
 (c⁄° 
SF_DITHER_INFO
 *
dôhî
, c⁄° *
ö
, *
out
, 
‰ames
, 
ch™√ls
)

442 { 
ch
, 
k
 ;

444 i‡(! 
dôhî
)

445  
SFE_DITHER_BAD_PTR
 ;

447 
dôhî
->
ty≥
 & 
SFD_TYPEMASK
)

448 { 
SFD_WHITE
 :

449 
SFD_TRIANGULAR_PDF
 :

450 
ch
 = 0 ; ch < 
ch™√ls
 ; ch++)

451 
k
 = 
ch
 ; k < 
ch™√ls
 * 
‰ames
 ; k += channels)

452 
out
 [
k
] = 
ö
 [k] ;

456  
SFE_DITHER_BAD_TYPE
 ;

460 
	}
}

463 
	$DO_NOT_USE_sf_dôhî_öt
 (c⁄° 
SF_DITHER_INFO
 *
dôhî
, c⁄° *
ö
, *
out
, 
‰ames
, 
ch™√ls
)

464 { 
ch
, 
k
 ;

466 i‡(! 
dôhî
)

467  
SFE_DITHER_BAD_PTR
 ;

469 
dôhî
->
ty≥
 & 
SFD_TYPEMASK
)

470 { 
SFD_WHITE
 :

471 
SFD_TRIANGULAR_PDF
 :

472 
ch
 = 0 ; ch < 
ch™√ls
 ; ch++)

473 
k
 = 
ch
 ; k < 
ch™√ls
 * 
‰ames
 ; k += channels)

474 
out
 [
k
] = 
ö
 [k] ;

478  
SFE_DITHER_BAD_TYPE
 ;

482 
	}
}

485 
	$DO_NOT_USE_sf_dôhî_Êﬂt
 (c⁄° 
SF_DITHER_INFO
 *
dôhî
, c⁄° *
ö
, *
out
, 
‰ames
, 
ch™√ls
)

486 { 
ch
, 
k
 ;

488 i‡(! 
dôhî
)

489  
SFE_DITHER_BAD_PTR
 ;

491 
dôhî
->
ty≥
 & 
SFD_TYPEMASK
)

492 { 
SFD_WHITE
 :

493 
SFD_TRIANGULAR_PDF
 :

494 
ch
 = 0 ; ch < 
ch™√ls
 ; ch++)

495 
k
 = 
ch
 ; k < 
ch™√ls
 * 
‰ames
 ; k += channels)

496 
out
 [
k
] = 
ö
 [k] ;

500  
SFE_DITHER_BAD_TYPE
 ;

504 
	}
}

507 
	$DO_NOT_USE_sf_dôhî_doubÀ
 (c⁄° 
SF_DITHER_INFO
 *
dôhî
, c⁄° *
ö
, *
out
, 
‰ames
, 
ch™√ls
)

508 { 
ch
, 
k
 ;

510 i‡(! 
dôhî
)

511  
SFE_DITHER_BAD_PTR
 ;

513 
dôhî
->
ty≥
 & 
SFD_TYPEMASK
)

514 { 
SFD_WHITE
 :

515 
SFD_TRIANGULAR_PDF
 :

516 
ch
 = 0 ; ch < 
ch™√ls
 ; ch++)

517 
k
 = 
ch
 ; k < 
ch™√ls
 * 
‰ames
 ; k += channels)

518 
out
 [
k
] = 
ö
 [k] ;

522  
SFE_DITHER_BAD_TYPE
 ;

526 
	}
}

	@libsndfile-1.0.17/src/double64.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

25 
	~"¢dfûe.h
"

26 
	~"s„ndün.h
"

27 
	~"comm⁄.h
"

28 
	~"Êﬂt_ˇ°.h
"

30 #i‡
CPU_IS_LITTLE_ENDIAN


31 
	#DOUBLE64_READ
 
doubÀ64_À_ªad


	)

32 
	#DOUBLE64_WRITE
 
doubÀ64_À_wrôe


	)

33 #ñi‡
CPU_IS_BIG_ENDIAN


34 
	#DOUBLE64_READ
 
doubÀ64_be_ªad


	)

35 
	#DOUBLE64_WRITE
 
doubÀ64_be_wrôe


	)

39 
	#SENSIBLE_LEN
 (0x8000000)

	)

47 { 
	mDOUBLE_UNKNOWN
 = 0x00,

48 
	mDOUBLE_CAN_RW_LE
 = 0x23,

49 
	mDOUBLE_CAN_RW_BE
 = 0x34,

50 
	mDOUBLE_BROKEN_LE
 = 0x45,

51 
	mDOUBLE_BROKEN_BE
 = 0x56

58 
sf_cou¡_t
 
ho°_ªad_d2s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

59 
sf_cou¡_t
 
ho°_ªad_d2i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

60 
sf_cou¡_t
 
ho°_ªad_d2f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

61 
sf_cou¡_t
 
ho°_ªad_d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

63 
sf_cou¡_t
 
ho°_wrôe_s2d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

64 
sf_cou¡_t
 
ho°_wrôe_i2d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

65 
sf_cou¡_t
 
ho°_wrôe_f2d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

66 
sf_cou¡_t
 
ho°_wrôe_d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

68 
doubÀ64_≥ak_upd©e
 (
SF_PRIVATE
 *
psf
, c⁄° *
buf„r
, 
cou¡
, 
sf_cou¡_t
 
ödx
) ;

70 
doubÀ64_gë_ˇ∑bûôy
 (
SF_PRIVATE
 *
psf
) ;

72 
sf_cou¡_t
 
ª∂a˚_ªad_d2s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

73 
sf_cou¡_t
 
ª∂a˚_ªad_d2i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

74 
sf_cou¡_t
 
ª∂a˚_ªad_d2f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

75 
sf_cou¡_t
 
ª∂a˚_ªad_d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

77 
sf_cou¡_t
 
ª∂a˚_wrôe_s2d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

78 
sf_cou¡_t
 
ª∂a˚_wrôe_i2d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

79 
sf_cou¡_t
 
ª∂a˚_wrôe_f2d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

80 
sf_cou¡_t
 
ª∂a˚_wrôe_d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

82 
d2bd_ªad
 (*
buf„r
, 
cou¡
) ;

83 
bd2d_wrôe
 (*
buf„r
, 
cou¡
) ;

90 
	$doubÀ64_öô
 (
SF_PRIVATE
 *
psf
)

91 { 
doubÀ64_ˇps
 ;

93 
doubÀ64_ˇps
 = 
	`doubÀ64_gë_ˇ∑bûôy
 (
psf
) ;

95 
psf
->
blockwidth
 =  (Ë*Ösf->
sf
.
ch™√ls
 ;

97 i‡(
psf
->
mode
 =
SFM_READ
 ||Ösf->modê=
SFM_RDWR
)

98 { 
psf
->
ídün
 + 
doubÀ64_ˇps
)

99 { (
SF_ENDIAN_BIG
 + 
DOUBLE_CAN_RW_BE
) :

100 
psf
->
Êﬂt_ídsw≠
 = 
SF_FALSE
 ;

101 
psf
->
ªad_sh‹t
 = 
ho°_ªad_d2s
 ;

102 
psf
->
ªad_öt
 = 
ho°_ªad_d2i
 ;

103 
psf
->
ªad_Êﬂt
 = 
ho°_ªad_d2f
 ;

104 
psf
->
ªad_doubÀ
 = 
ho°_ªad_d
 ;

107 (
SF_ENDIAN_LITTLE
 + 
DOUBLE_CAN_RW_LE
) :

108 
psf
->
Êﬂt_ídsw≠
 = 
SF_FALSE
 ;

109 
psf
->
ªad_sh‹t
 = 
ho°_ªad_d2s
 ;

110 
psf
->
ªad_öt
 = 
ho°_ªad_d2i
 ;

111 
psf
->
ªad_Êﬂt
 = 
ho°_ªad_d2f
 ;

112 
psf
->
ªad_doubÀ
 = 
ho°_ªad_d
 ;

115 (
SF_ENDIAN_BIG
 + 
DOUBLE_CAN_RW_LE
) :

116 
psf
->
Êﬂt_ídsw≠
 = 
SF_TRUE
 ;

117 
psf
->
ªad_sh‹t
 = 
ho°_ªad_d2s
 ;

118 
psf
->
ªad_öt
 = 
ho°_ªad_d2i
 ;

119 
psf
->
ªad_Êﬂt
 = 
ho°_ªad_d2f
 ;

120 
psf
->
ªad_doubÀ
 = 
ho°_ªad_d
 ;

123 (
SF_ENDIAN_LITTLE
 + 
DOUBLE_CAN_RW_BE
) :

124 
psf
->
Êﬂt_ídsw≠
 = 
SF_TRUE
 ;

125 
psf
->
ªad_sh‹t
 = 
ho°_ªad_d2s
 ;

126 
psf
->
ªad_öt
 = 
ho°_ªad_d2i
 ;

127 
psf
->
ªad_Êﬂt
 = 
ho°_ªad_d2f
 ;

128 
psf
->
ªad_doubÀ
 = 
ho°_ªad_d
 ;

132 (
SF_ENDIAN_BIG
 + 
DOUBLE_BROKEN_BE
) :

133 
psf
->
Êﬂt_ídsw≠
 = 
SF_FALSE
 ;

134 
psf
->
ªad_sh‹t
 = 
ª∂a˚_ªad_d2s
 ;

135 
psf
->
ªad_öt
 = 
ª∂a˚_ªad_d2i
 ;

136 
psf
->
ªad_Êﬂt
 = 
ª∂a˚_ªad_d2f
 ;

137 
psf
->
ªad_doubÀ
 = 
ª∂a˚_ªad_d
 ;

140 (
SF_ENDIAN_LITTLE
 + 
DOUBLE_BROKEN_LE
) :

141 
psf
->
Êﬂt_ídsw≠
 = 
SF_FALSE
 ;

142 
psf
->
ªad_sh‹t
 = 
ª∂a˚_ªad_d2s
 ;

143 
psf
->
ªad_öt
 = 
ª∂a˚_ªad_d2i
 ;

144 
psf
->
ªad_Êﬂt
 = 
ª∂a˚_ªad_d2f
 ;

145 
psf
->
ªad_doubÀ
 = 
ª∂a˚_ªad_d
 ;

148 (
SF_ENDIAN_BIG
 + 
DOUBLE_BROKEN_LE
) :

149 
psf
->
Êﬂt_ídsw≠
 = 
SF_TRUE
 ;

150 
psf
->
ªad_sh‹t
 = 
ª∂a˚_ªad_d2s
 ;

151 
psf
->
ªad_öt
 = 
ª∂a˚_ªad_d2i
 ;

152 
psf
->
ªad_Êﬂt
 = 
ª∂a˚_ªad_d2f
 ;

153 
psf
->
ªad_doubÀ
 = 
ª∂a˚_ªad_d
 ;

156 (
SF_ENDIAN_LITTLE
 + 
DOUBLE_BROKEN_BE
) :

157 
psf
->
Êﬂt_ídsw≠
 = 
SF_TRUE
 ;

158 
psf
->
ªad_sh‹t
 = 
ª∂a˚_ªad_d2s
 ;

159 
psf
->
ªad_öt
 = 
ª∂a˚_ªad_d2i
 ;

160 
psf
->
ªad_Êﬂt
 = 
ª∂a˚_ªad_d2f
 ;

161 
psf
->
ªad_doubÀ
 = 
ª∂a˚_ªad_d
 ;

168 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

169 { 
psf
->
ídün
 + 
doubÀ64_ˇps
)

170 { (
SF_ENDIAN_LITTLE
 + 
DOUBLE_CAN_RW_LE
) :

171 
psf
->
Êﬂt_ídsw≠
 = 
SF_FALSE
 ;

172 
psf
->
wrôe_sh‹t
 = 
ho°_wrôe_s2d
 ;

173 
psf
->
wrôe_öt
 = 
ho°_wrôe_i2d
 ;

174 
psf
->
wrôe_Êﬂt
 = 
ho°_wrôe_f2d
 ;

175 
psf
->
wrôe_doubÀ
 = 
ho°_wrôe_d
 ;

178 (
SF_ENDIAN_BIG
 + 
DOUBLE_CAN_RW_BE
) :

179 
psf
->
Êﬂt_ídsw≠
 = 
SF_FALSE
 ;

180 
psf
->
wrôe_sh‹t
 = 
ho°_wrôe_s2d
 ;

181 
psf
->
wrôe_öt
 = 
ho°_wrôe_i2d
 ;

182 
psf
->
wrôe_Êﬂt
 = 
ho°_wrôe_f2d
 ;

183 
psf
->
wrôe_doubÀ
 = 
ho°_wrôe_d
 ;

186 (
SF_ENDIAN_BIG
 + 
DOUBLE_CAN_RW_LE
) :

187 
psf
->
Êﬂt_ídsw≠
 = 
SF_TRUE
 ;

188 
psf
->
wrôe_sh‹t
 = 
ho°_wrôe_s2d
 ;

189 
psf
->
wrôe_öt
 = 
ho°_wrôe_i2d
 ;

190 
psf
->
wrôe_Êﬂt
 = 
ho°_wrôe_f2d
 ;

191 
psf
->
wrôe_doubÀ
 = 
ho°_wrôe_d
 ;

194 (
SF_ENDIAN_LITTLE
 + 
DOUBLE_CAN_RW_BE
) :

195 
psf
->
Êﬂt_ídsw≠
 = 
SF_TRUE
 ;

196 
psf
->
wrôe_sh‹t
 = 
ho°_wrôe_s2d
 ;

197 
psf
->
wrôe_öt
 = 
ho°_wrôe_i2d
 ;

198 
psf
->
wrôe_Êﬂt
 = 
ho°_wrôe_f2d
 ;

199 
psf
->
wrôe_doubÀ
 = 
ho°_wrôe_d
 ;

203 (
SF_ENDIAN_LITTLE
 + 
DOUBLE_BROKEN_LE
) :

204 
psf
->
Êﬂt_ídsw≠
 = 
SF_FALSE
 ;

205 
psf
->
wrôe_sh‹t
 = 
ª∂a˚_wrôe_s2d
 ;

206 
psf
->
wrôe_öt
 = 
ª∂a˚_wrôe_i2d
 ;

207 
psf
->
wrôe_Êﬂt
 = 
ª∂a˚_wrôe_f2d
 ;

208 
psf
->
wrôe_doubÀ
 = 
ª∂a˚_wrôe_d
 ;

211 (
SF_ENDIAN_BIG
 + 
DOUBLE_BROKEN_BE
) :

212 
psf
->
Êﬂt_ídsw≠
 = 
SF_FALSE
 ;

213 
psf
->
wrôe_sh‹t
 = 
ª∂a˚_wrôe_s2d
 ;

214 
psf
->
wrôe_öt
 = 
ª∂a˚_wrôe_i2d
 ;

215 
psf
->
wrôe_Êﬂt
 = 
ª∂a˚_wrôe_f2d
 ;

216 
psf
->
wrôe_doubÀ
 = 
ª∂a˚_wrôe_d
 ;

219 (
SF_ENDIAN_BIG
 + 
DOUBLE_BROKEN_LE
) :

220 
psf
->
Êﬂt_ídsw≠
 = 
SF_TRUE
 ;

221 
psf
->
wrôe_sh‹t
 = 
ª∂a˚_wrôe_s2d
 ;

222 
psf
->
wrôe_öt
 = 
ª∂a˚_wrôe_i2d
 ;

223 
psf
->
wrôe_Êﬂt
 = 
ª∂a˚_wrôe_f2d
 ;

224 
psf
->
wrôe_doubÀ
 = 
ª∂a˚_wrôe_d
 ;

227 (
SF_ENDIAN_LITTLE
 + 
DOUBLE_BROKEN_BE
) :

228 
psf
->
Êﬂt_ídsw≠
 = 
SF_TRUE
 ;

229 
psf
->
wrôe_sh‹t
 = 
ª∂a˚_wrôe_s2d
 ;

230 
psf
->
wrôe_öt
 = 
ª∂a˚_wrôe_i2d
 ;

231 
psf
->
wrôe_Êﬂt
 = 
ª∂a˚_wrôe_f2d
 ;

232 
psf
->
wrôe_doubÀ
 = 
ª∂a˚_wrôe_d
 ;

239 i‡(
psf
->
fûñígth
 >Ösf->
d©aoff£t
)

240 { 
psf
->
d©Æígth
 = (psf->
d©´nd
 > 0Ë?Ösf->d©´nd -Ösf->
d©aoff£t
 :

241 
psf
->
fûñígth
 -Ösf->
d©aoff£t
 ;

244 
psf
->
d©Æígth
 = 0 ;

246 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 /Ösf->
blockwidth
 ;

249 
	}
}

278 
	$doubÀ64_be_ªad
 (*
˝å
)

279 { 
exp⁄ít
, 
√g©ive
, 
uµî
, 
lowî
 ;

280 
dvÆue
 ;

282 
√g©ive
 = (
˝å
 [0] & 0x80) ? 1 : 0 ;

283 
exp⁄ít
 = ((
˝å
 [0] & 0x7F) << 4) | ((cptr [1] >> 4) & 0xF) ;

286 
uµî
 = (((
˝å
 [1] & 0xF) << 24) | (cptr [2] << 16) | (cptr [3] << 8) | cptr [4]) ;

287 
lowî
 = (
˝å
 [5] << 16) | (cptr [6] << 8) | cptr [7] ;

289 i‡(
exp⁄ít
 =0 && 
uµî
 =0 && 
lowî
 == 0)

292 
dvÆue
 = 
uµî
 + 
lowî
 / (() 0x1000000) ;

293 
dvÆue
 += 0x10000000 ;

295 
exp⁄ít
 =Éxponent - 0x3FF ;

297 
dvÆue
 = dvalue / (() 0x10000000) ;

299 i‡(
√g©ive
)

300 
dvÆue
 *= -1 ;

302 i‡(
exp⁄ít
 > 0)

303 
dvÆue
 *(1 << 
exp⁄ít
) ;

304 i‡(
exp⁄ít
 < 0)

305 
dvÆue
 /(1 << 
	`abs
 (
exp⁄ít
)) ;

307  
dvÆue
 ;

308 
	}
}

311 
	$doubÀ64_À_ªad
 (*
˝å
)

312 { 
exp⁄ít
, 
√g©ive
, 
uµî
, 
lowî
 ;

313 
dvÆue
 ;

315 
√g©ive
 = (
˝å
 [7] & 0x80) ? 1 : 0 ;

316 
exp⁄ít
 = ((
˝å
 [7] & 0x7F) << 4) | ((cptr [6] >> 4) & 0xF) ;

319 
uµî
 = ((
˝å
 [6] & 0xF) << 24) | (cptr [5] << 16) | (cptr [4] << 8) | cptr [3] ;

320 
lowî
 = (
˝å
 [2] << 16) | (cptr [1] << 8) | cptr [0] ;

322 i‡(
exp⁄ít
 =0 && 
uµî
 =0 && 
lowî
 == 0)

325 
dvÆue
 = 
uµî
 + 
lowî
 / (() 0x1000000) ;

326 
dvÆue
 += 0x10000000 ;

328 
exp⁄ít
 =Éxponent - 0x3FF ;

330 
dvÆue
 = dvalue / (() 0x10000000) ;

332 i‡(
√g©ive
)

333 
dvÆue
 *= -1 ;

335 i‡(
exp⁄ít
 > 0)

336 
dvÆue
 *(1 << 
exp⁄ít
) ;

337 i‡(
exp⁄ít
 < 0)

338 
dvÆue
 /(1 << 
	`abs
 (
exp⁄ít
)) ;

340  
dvÆue
 ;

341 
	}
}

344 
	$doubÀ64_be_wrôe
 (
ö
, *
out
)

345 { 
exp⁄ít
, 
m™tisß
 ;

347 
	`mem£t
 (
out
, 0,  ()) ;

349 i‡(
	`Ábs
 (
ö
) < 1e-30)

352 i‡(
ö
 < 0.0)

353 { 
ö
 *= -1.0 ;

354 
out
 [0] |= 0x80 ;

357 
ö
 = 
	`‰exp
 (ö, &
exp⁄ít
) ;

359 
exp⁄ít
 += 1022 ;

361 
out
 [0] |(
exp⁄ít
 >> 4) & 0x7F ;

362 
out
 [1] |(
exp⁄ít
 << 4) & 0xF0 ;

364 
ö
 *= 0x20000000 ;

365 
m™tisß
 = 
	`Ãöt
 (
	`Êo‹
 (
ö
)) ;

367 
out
 [1] |(
m™tisß
 >> 24) & 0xF ;

368 
out
 [2] = (
m™tisß
 >> 16) & 0xFF ;

369 
out
 [3] = (
m™tisß
 >> 8) & 0xFF ;

370 
out
 [4] = 
m™tisß
 & 0xFF ;

372 
ö
 = 
	`fmod
 (in, 1.0) ;

373 
ö
 *= 0x1000000 ;

374 
m™tisß
 = 
	`Ãöt
 (
	`Êo‹
 (
ö
)) ;

376 
out
 [5] = (
m™tisß
 >> 16) & 0xFF ;

377 
out
 [6] = (
m™tisß
 >> 8) & 0xFF ;

378 
out
 [7] = 
m™tisß
 & 0xFF ;

381 
	}
}

384 
	$doubÀ64_À_wrôe
 (
ö
, *
out
)

385 { 
exp⁄ít
, 
m™tisß
 ;

387 
	`mem£t
 (
out
, 0,  ()) ;

389 i‡(
	`Ábs
 (
ö
) < 1e-30)

392 i‡(
ö
 < 0.0)

393 { 
ö
 *= -1.0 ;

394 
out
 [7] |= 0x80 ;

397 
ö
 = 
	`‰exp
 (ö, &
exp⁄ít
) ;

399 
exp⁄ít
 += 1022 ;

401 
out
 [7] |(
exp⁄ít
 >> 4) & 0x7F ;

402 
out
 [6] |(
exp⁄ít
 << 4) & 0xF0 ;

404 
ö
 *= 0x20000000 ;

405 
m™tisß
 = 
	`Ãöt
 (
	`Êo‹
 (
ö
)) ;

407 
out
 [6] |(
m™tisß
 >> 24) & 0xF ;

408 
out
 [5] = (
m™tisß
 >> 16) & 0xFF ;

409 
out
 [4] = (
m™tisß
 >> 8) & 0xFF ;

410 
out
 [3] = 
m™tisß
 & 0xFF ;

412 
ö
 = 
	`fmod
 (in, 1.0) ;

413 
ö
 *= 0x1000000 ;

414 
m™tisß
 = 
	`Ãöt
 (
	`Êo‹
 (
ö
)) ;

416 
out
 [2] = (
m™tisß
 >> 16) & 0xFF ;

417 
out
 [1] = (
m™tisß
 >> 8) & 0xFF ;

418 
out
 [0] = 
m™tisß
 & 0xFF ;

421 
	}
}

428 
	$doubÀ64_≥ak_upd©e
 (
SF_PRIVATE
 *
psf
, c⁄° *
buf„r
, 
cou¡
, 
sf_cou¡_t
 
ödx
)

429 { 
ch™
 ;

430 
k
, 
posôi⁄
 ;

431 
fmaxvÆ
 ;

433 
ch™
 = 0 ; ch™ < 
psf
->
sf
.
ch™√ls
 ; chan++)

434 { 
fmaxvÆ
 = 
	`Ábs
 (
buf„r
 [
ch™
]) ;

435 
posôi⁄
 = 0 ;

436 
k
 = 
ch™
 ; k < 
cou¡
 ; k +
psf
->
sf
.
ch™√ls
)

437 i‡(
fmaxvÆ
 < 
	`Ábs
 (
buf„r
 [
k
]))

438 { 
fmaxvÆ
 = 
	`Ábs
 (
buf„r
 [
k
]) ;

439 
posôi⁄
 = 
k
 ;

442 i‡(
fmaxvÆ
 > 
psf
->
≥ak_öfo
->
≥aks
 [
ch™
].
vÆue
)

443 { 
psf
->
≥ak_öfo
->
≥aks
 [
ch™
].
vÆue
 = 
fmaxvÆ
 ;

444 
psf
->
≥ak_öfo
->
≥aks
 [
ch™
].
posôi⁄
 =Ösf->
wrôe_cuºít
 + 
ödx
 + (posôi⁄ /Ösf->
sf
.
ch™√ls
) ;

449 
	}
}

452 
	$doubÀ64_gë_ˇ∑bûôy
 (
SF_PRIVATE
 *
psf
)

454 { 
d
 ;

455 
c
 [8] ;

456 } 
d©a
 ;

458 
d©a
.
d
 = 1.234567890123456789 ;

460 i‡(! 
psf
->
õì_ª∂a˚
)

462 i‡(
d©a
.
c
 [0] == 0xfb && data.c [1] == 0x59 && data.c [2] == 0x8c && data.c [3] == 0x42 &&

463 
d©a
.
c
 [4] == 0xca && data.c [5] == 0xc0 && data.c [6] == 0xf3 && data.c [7] == 0x3f)

464  
DOUBLE_CAN_RW_LE
 ;

467 i‡(
d©a
.
c
 [0] == 0x3f && data.c [1] == 0xf3 && data.c [2] == 0xc0 && data.c [3] == 0xca &&

468 
d©a
.
c
 [4] == 0x42 && data.c [5] == 0x8c && data.c [6] == 0x59 && data.c [7] == 0xfb)

469  
DOUBLE_CAN_RW_BE
 ;

473 
	`psf_log_¥ötf
 (
psf
, "Using IEEEÑeplacement code for double.\n") ;

475  (
CPU_IS_LITTLE_ENDIAN
Ë? 
DOUBLE_BROKEN_LE
 : 
DOUBLE_BROKEN_BE
 ;

476 
	}
}

481 
ölöe
 

482 
	$d2s_¨øy
 (c⁄° *
§c
, 
cou¡
, *
de°
, 
sˇÀ
)

483 { --
cou¡
 >= 0)

484 { 
de°
 [
cou¡
] = 
	`Ãöt
 (
sˇÀ
 * 
§c
 [count]) ;

486 
	}
}

488 
ölöe
 

489 
	$d2i_¨øy
 (c⁄° *
§c
, 
cou¡
, *
de°
, 
sˇÀ
)

490 { --
cou¡
 >= 0)

491 { 
de°
 [
cou¡
] = 
	`Ãöt
 (
sˇÀ
 * 
§c
 [count]) ;

493 
	}
}

495 
ölöe
 

496 
	$d2f_¨øy
 (c⁄° *
§c
, 
cou¡
, *
de°
)

497 { --
cou¡
 >= 0)

498 { 
de°
 [
cou¡
] = 
§c
 [count] ;

500 
	}
}

502 
ölöe
 

503 
	$s2d_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
)

504 { --
cou¡
 >= 0)

505 { 
de°
 [
cou¡
] = 
§c
 [count] ;

507 
	}
}

509 
ölöe
 

510 
	$i2d_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
)

511 { --
cou¡
 >= 0)

512 { 
de°
 [
cou¡
] = 
§c
 [count] ;

514 
	}
}

516 
ölöe
 

517 
	$f2d_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
)

518 { --
cou¡
 >= 0)

519 { 
de°
 [
cou¡
] = 
§c
 [count] ;

521 
	}
}

526 
sf_cou¡_t


527 
	$ho°_ªad_d2s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

528 { 
buf„æí
, 
ªadcou¡
 ;

529 
sf_cou¡_t
 
tŸÆ
 = 0 ;

530 
sˇÀ
 ;

532 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
dbuf
) ;

533 
sˇÀ
 = (
psf
->
Êﬂt_öt_mu…
 =0Ë? 1.0 : 0x7FFF /Ösf->
Êﬂt_max
 ;

535 
Àn
 > 0)

536 { i‡(
Àn
 < 
buf„æí
)

537 
buf„æí
 = (Ë
Àn
 ;

538 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
dbuf
,  (), 
buf„æí
,Ösf) ;

540 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

541 
	`ídsw≠_doubÀ_¨øy
 (
psf
->
u
.
dbuf
, 
ªadcou¡
) ;

543 
	`d2s_¨øy
 (
psf
->
u
.
dbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
sˇÀ
) ;

544 
tŸÆ
 +
ªadcou¡
 ;

545 
Àn
 -
ªadcou¡
 ;

546 i‡(
ªadcou¡
 < 
buf„æí
)

550  
tŸÆ
 ;

551 
	}
}

553 
sf_cou¡_t


554 
	$ho°_ªad_d2i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

555 { 
buf„æí
, 
ªadcou¡
 ;

556 
sf_cou¡_t
 
tŸÆ
 = 0 ;

557 
sˇÀ
 ;

558 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
dbuf
) ;

559 
sˇÀ
 = (
psf
->
Êﬂt_öt_mu…
 =0Ë? 1.0 : 0x7FFFFFFF /Ösf->
Êﬂt_max
 ;

561 
Àn
 > 0)

562 { i‡(
Àn
 < 
buf„æí
)

563 
buf„æí
 = (Ë
Àn
 ;

564 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
dbuf
,  (), 
buf„æí
,Ösf) ;

566 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

567 
	`ídsw≠_doubÀ_¨øy
 (
psf
->
u
.
dbuf
, 
buf„æí
) ;

569 
	`d2i_¨øy
 (
psf
->
u
.
dbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
sˇÀ
) ;

570 
tŸÆ
 +
ªadcou¡
 ;

571 
Àn
 -
ªadcou¡
 ;

572 i‡(
ªadcou¡
 < 
buf„æí
)

576  
tŸÆ
 ;

577 
	}
}

579 
sf_cou¡_t


580 
	$ho°_ªad_d2f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

581 { 
buf„æí
, 
ªadcou¡
 ;

582 
sf_cou¡_t
 
tŸÆ
 = 0 ;

584 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
dbuf
) ;

586 
Àn
 > 0)

587 { i‡(
Àn
 < 
buf„æí
)

588 
buf„æí
 = (Ë
Àn
 ;

589 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
dbuf
,  (), 
buf„æí
,Ösf) ;

591 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

592 
	`ídsw≠_doubÀ_¨øy
 (
psf
->
u
.
dbuf
, 
buf„æí
) ;

594 
	`d2f_¨øy
 (
psf
->
u
.
dbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

595 
tŸÆ
 +
ªadcou¡
 ;

596 
Àn
 -
ªadcou¡
 ;

597 i‡(
ªadcou¡
 < 
buf„æí
)

601  
tŸÆ
 ;

602 
	}
}

604 
sf_cou¡_t


605 
	$ho°_ªad_d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

606 { 
buf„æí
 ;

607 
sf_cou¡_t
 
ªadcou¡
, 
tŸÆ
 = 0 ;

609 
ªadcou¡
 = 
	`psf_‰ód
 (
±r
,  (), 
Àn
, 
psf
) ;

611 i‡(
psf
->
Êﬂt_ídsw≠
 !
SF_TRUE
)

612  
ªadcou¡
 ;

615 i‡(
ªadcou¡
 < 
SENSIBLE_LEN
)

616 { 
	`ídsw≠_doubÀ_¨øy
 (
±r
, 
ªadcou¡
) ;

617  
ªadcou¡
 ;

620 
buf„æí
 = 
SENSIBLE_LEN
 ;

621 
Àn
 > 0)

622 { i‡(
Àn
 < 
buf„æí
)

623 
buf„æí
 = (Ë
Àn
 ;

625 
	`ídsw≠_doubÀ_¨øy
 (
±r
 + 
tŸÆ
, 
buf„æí
) ;

627 
tŸÆ
 +
buf„æí
 ;

628 
Àn
 -
buf„æí
 ;

631  
tŸÆ
 ;

632 
	}
}

634 
sf_cou¡_t


635 
	$ho°_wrôe_s2d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

636 { 
buf„æí
, 
wrôecou¡
 ;

637 
sf_cou¡_t
 
tŸÆ
 = 0 ;

639 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
dbuf
) ;

641 
Àn
 > 0)

642 { i‡(
Àn
 < 
buf„æí
)

643 
buf„æí
 = (Ë
Àn
 ;

645 
	`s2d_¨øy
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
dbuf
, 
buf„æí
) ;

647 i‡(
psf
->
≥ak_öfo
)

648 
	`doubÀ64_≥ak_upd©e
 (
psf
,Ösf->
u
.
dbuf
, 
buf„æí
, 
tŸÆ
 /Ösf->
sf
.
ch™√ls
) ;

650 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

651 
	`ídsw≠_doubÀ_¨øy
 (
psf
->
u
.
dbuf
, 
buf„æí
) ;

653 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
dbuf
,  (), 
buf„æí
,Ösf) ;

654 
tŸÆ
 +
wrôecou¡
 ;

655 i‡(
wrôecou¡
 < 
buf„æí
)

657 
Àn
 -
wrôecou¡
 ;

660  
tŸÆ
 ;

661 
	}
}

663 
sf_cou¡_t


664 
	$ho°_wrôe_i2d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

665 { 
buf„æí
, 
wrôecou¡
 ;

666 
sf_cou¡_t
 
tŸÆ
 = 0 ;

668 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
dbuf
) ;

670 
Àn
 > 0)

671 { i‡(
Àn
 < 
buf„æí
)

672 
buf„æí
 = (Ë
Àn
 ;

673 
	`i2d_¨øy
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
dbuf
, 
buf„æí
) ;

675 i‡(
psf
->
≥ak_öfo
)

676 
	`doubÀ64_≥ak_upd©e
 (
psf
,Ösf->
u
.
dbuf
, 
buf„æí
, 
tŸÆ
 /Ösf->
sf
.
ch™√ls
) ;

678 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

679 
	`ídsw≠_doubÀ_¨øy
 (
psf
->
u
.
dbuf
, 
buf„æí
) ;

681 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
dbuf
,  (), 
buf„æí
,Ösf) ;

682 
tŸÆ
 +
wrôecou¡
 ;

683 i‡(
wrôecou¡
 < 
buf„æí
)

685 
Àn
 -
wrôecou¡
 ;

688  
tŸÆ
 ;

689 
	}
}

691 
sf_cou¡_t


692 
	$ho°_wrôe_f2d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

693 { 
buf„æí
, 
wrôecou¡
 ;

694 
sf_cou¡_t
 
tŸÆ
 = 0 ;

696 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
dbuf
) ;

698 
Àn
 > 0)

699 { i‡(
Àn
 < 
buf„æí
)

700 
buf„æí
 = (Ë
Àn
 ;

701 
	`f2d_¨øy
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
dbuf
, 
buf„æí
) ;

703 i‡(
psf
->
≥ak_öfo
)

704 
	`doubÀ64_≥ak_upd©e
 (
psf
,Ösf->
u
.
dbuf
, 
buf„æí
, 
tŸÆ
 /Ösf->
sf
.
ch™√ls
) ;

706 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

707 
	`ídsw≠_doubÀ_¨øy
 (
psf
->
u
.
dbuf
, 
buf„æí
) ;

709 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
dbuf
,  (), 
buf„æí
,Ösf) ;

710 
tŸÆ
 +
wrôecou¡
 ;

711 i‡(
wrôecou¡
 < 
buf„æí
)

713 
Àn
 -
wrôecou¡
 ;

716  
tŸÆ
 ;

717 
	}
}

719 
sf_cou¡_t


720 
	$ho°_wrôe_d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

721 { 
buf„æí
, 
wrôecou¡
 ;

722 
sf_cou¡_t
 
tŸÆ
 = 0 ;

724 i‡(
psf
->
≥ak_öfo
)

725 
	`doubÀ64_≥ak_upd©e
 (
psf
, 
±r
, 
Àn
, 0) ;

727 i‡(
psf
->
Êﬂt_ídsw≠
 !
SF_TRUE
)

728  
	`psf_fwrôe
 (
±r
,  (), 
Àn
, 
psf
) ;

730 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
dbuf
) ;

732 
Àn
 > 0)

733 { i‡(
Àn
 < 
buf„æí
)

734 
buf„æí
 = (Ë
Àn
 ;

736 
	`ídsw≠_doubÀ_c›y
 (
psf
->
u
.
dbuf
, 
±r
 + 
tŸÆ
, 
buf„æí
) ;

738 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
dbuf
,  (), 
buf„æí
,Ösf) ;

739 
tŸÆ
 +
wrôecou¡
 ;

740 i‡(
wrôecou¡
 < 
buf„æí
)

742 
Àn
 -
wrôecou¡
 ;

745  
tŸÆ
 ;

746 
	}
}

751 
sf_cou¡_t


752 
	$ª∂a˚_ªad_d2s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

753 { 
buf„æí
, 
ªadcou¡
 ;

754 
sf_cou¡_t
 
tŸÆ
 = 0 ;

755 
sˇÀ
 ;

757 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
dbuf
) ;

758 
sˇÀ
 = (
psf
->
Êﬂt_öt_mu…
 =0Ë? 1.0 : 0x7FFF /Ösf->
Êﬂt_max
 ;

760 
Àn
 > 0)

761 { i‡(
Àn
 < 
buf„æí
)

762 
buf„æí
 = (Ë
Àn
 ;

763 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
dbuf
,  (), 
buf„æí
,Ösf) ;

765 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

766 
	`ídsw≠_doubÀ_¨øy
 (
psf
->
u
.
dbuf
, 
buf„æí
) ;

768 
	`d2bd_ªad
 (
psf
->
u
.
dbuf
, 
buf„æí
) ;

770 
	`d2s_¨øy
 (
psf
->
u
.
dbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
sˇÀ
) ;

771 
tŸÆ
 +
ªadcou¡
 ;

772 i‡(
ªadcou¡
 < 
buf„æí
)

774 
Àn
 -
ªadcou¡
 ;

777  
tŸÆ
 ;

778 
	}
}

780 
sf_cou¡_t


781 
	$ª∂a˚_ªad_d2i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

782 { 
buf„æí
, 
ªadcou¡
 ;

783 
sf_cou¡_t
 
tŸÆ
 = 0 ;

784 
sˇÀ
 ;

786 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
dbuf
) ;

787 
sˇÀ
 = (
psf
->
Êﬂt_öt_mu…
 =0Ë? 1.0 : 0x7FFFFFFF /Ösf->
Êﬂt_max
 ;

789 
Àn
 > 0)

790 { i‡(
Àn
 < 
buf„æí
)

791 
buf„æí
 = (Ë
Àn
 ;

792 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
dbuf
,  (), 
buf„æí
,Ösf) ;

794 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

795 
	`ídsw≠_doubÀ_¨øy
 (
psf
->
u
.
dbuf
, 
buf„æí
) ;

797 
	`d2bd_ªad
 (
psf
->
u
.
dbuf
, 
buf„æí
) ;

799 
	`d2i_¨øy
 (
psf
->
u
.
dbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
sˇÀ
) ;

800 
tŸÆ
 +
ªadcou¡
 ;

801 i‡(
ªadcou¡
 < 
buf„æí
)

803 
Àn
 -
ªadcou¡
 ;

806  
tŸÆ
 ;

807 
	}
}

809 
sf_cou¡_t


810 
	$ª∂a˚_ªad_d2f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

811 { 
buf„æí
, 
ªadcou¡
 ;

812 
sf_cou¡_t
 
tŸÆ
 = 0 ;

814 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
dbuf
) ;

816 
Àn
 > 0)

817 { i‡(
Àn
 < 
buf„æí
)

818 
buf„æí
 = (Ë
Àn
 ;

819 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
dbuf
,  (), 
buf„æí
,Ösf) ;

821 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

822 
	`ídsw≠_doubÀ_¨øy
 (
psf
->
u
.
dbuf
, 
buf„æí
) ;

824 
	`d2bd_ªad
 (
psf
->
u
.
dbuf
, 
buf„æí
) ;

826 
	`mem˝y
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
dbuf
, 
buf„æí
 *  ()) ;

828 
tŸÆ
 +
ªadcou¡
 ;

829 i‡(
ªadcou¡
 < 
buf„æí
)

831 
Àn
 -
ªadcou¡
 ;

834  
tŸÆ
 ;

835 
	}
}

837 
sf_cou¡_t


838 
	$ª∂a˚_ªad_d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

839 { 
buf„æí
, 
ªadcou¡
 ;

840 
sf_cou¡_t
 
tŸÆ
 = 0 ;

843 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
dbuf
) ;

845 
Àn
 > 0)

846 { i‡(
Àn
 < 
buf„æí
)

847 
buf„æí
 = (Ë
Àn
 ;

848 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
dbuf
,  (), 
buf„æí
,Ösf) ;

850 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

851 
	`ídsw≠_doubÀ_¨øy
 (
psf
->
u
.
dbuf
, 
ªadcou¡
) ;

853 
	`d2bd_ªad
 (
psf
->
u
.
dbuf
, 
ªadcou¡
) ;

855 
	`mem˝y
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
dbuf
, 
ªadcou¡
 *  ()) ;

857 
tŸÆ
 +
ªadcou¡
 ;

858 i‡(
ªadcou¡
 < 
buf„æí
)

860 
Àn
 -
ªadcou¡
 ;

863  
tŸÆ
 ;

864 
	}
}

866 
sf_cou¡_t


867 
	$ª∂a˚_wrôe_s2d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

868 { 
buf„æí
, 
wrôecou¡
 ;

869 
sf_cou¡_t
 
tŸÆ
 = 0 ;

871 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
dbuf
) ;

873 
Àn
 > 0)

874 { i‡(
Àn
 < 
buf„æí
)

875 
buf„æí
 = (Ë
Àn
 ;

876 
	`s2d_¨øy
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
dbuf
, 
buf„æí
) ;

878 i‡(
psf
->
≥ak_öfo
)

879 
	`doubÀ64_≥ak_upd©e
 (
psf
,Ösf->
u
.
dbuf
, 
buf„æí
, 
tŸÆ
 /Ösf->
sf
.
ch™√ls
) ;

881 
	`bd2d_wrôe
 (
psf
->
u
.
dbuf
, 
buf„æí
) ;

883 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

884 
	`ídsw≠_doubÀ_¨øy
 (
psf
->
u
.
dbuf
, 
buf„æí
) ;

886 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
dbuf
,  (), 
buf„æí
,Ösf) ;

887 
tŸÆ
 +
wrôecou¡
 ;

888 i‡(
wrôecou¡
 < 
buf„æí
)

890 
Àn
 -
wrôecou¡
 ;

893  
tŸÆ
 ;

894 
	}
}

896 
sf_cou¡_t


897 
	$ª∂a˚_wrôe_i2d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

898 { 
buf„æí
, 
wrôecou¡
 ;

899 
sf_cou¡_t
 
tŸÆ
 = 0 ;

901 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
dbuf
) ;

903 
Àn
 > 0)

904 { i‡(
Àn
 < 
buf„æí
)

905 
buf„æí
 = (Ë
Àn
 ;

906 
	`i2d_¨øy
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
dbuf
, 
buf„æí
) ;

908 i‡(
psf
->
≥ak_öfo
)

909 
	`doubÀ64_≥ak_upd©e
 (
psf
,Ösf->
u
.
dbuf
, 
buf„æí
, 
tŸÆ
 /Ösf->
sf
.
ch™√ls
) ;

911 
	`bd2d_wrôe
 (
psf
->
u
.
dbuf
, 
buf„æí
) ;

913 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

914 
	`ídsw≠_doubÀ_¨øy
 (
psf
->
u
.
dbuf
, 
buf„æí
) ;

916 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
dbuf
,  (), 
buf„æí
,Ösf) ;

917 
tŸÆ
 +
wrôecou¡
 ;

918 i‡(
wrôecou¡
 < 
buf„æí
)

920 
Àn
 -
wrôecou¡
 ;

923  
tŸÆ
 ;

924 
	}
}

926 
sf_cou¡_t


927 
	$ª∂a˚_wrôe_f2d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

928 { 
buf„æí
, 
wrôecou¡
 ;

929 
sf_cou¡_t
 
tŸÆ
 = 0 ;

931 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
dbuf
) ;

933 
Àn
 > 0)

934 { i‡(
Àn
 < 
buf„æí
)

935 
buf„æí
 = (Ë
Àn
 ;

936 
	`f2d_¨øy
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
dbuf
, 
buf„æí
) ;

938 
	`bd2d_wrôe
 (
psf
->
u
.
dbuf
, 
buf„æí
) ;

940 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

941 
	`ídsw≠_doubÀ_¨øy
 (
psf
->
u
.
dbuf
, 
buf„æí
) ;

943 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
dbuf
,  (), 
buf„æí
,Ösf) ;

944 
tŸÆ
 +
wrôecou¡
 ;

945 i‡(
wrôecou¡
 < 
buf„æí
)

947 
Àn
 -
wrôecou¡
 ;

950  
tŸÆ
 ;

951 
	}
}

953 
sf_cou¡_t


954 
	$ª∂a˚_wrôe_d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

955 { 
buf„æí
, 
wrôecou¡
 ;

956 
sf_cou¡_t
 
tŸÆ
 = 0 ;

959 i‡(
psf
->
≥ak_öfo
)

960 
	`doubÀ64_≥ak_upd©e
 (
psf
, 
±r
, 
Àn
, 0) ;

962 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
dbuf
) ;

964 
Àn
 > 0)

965 { i‡(
Àn
 < 
buf„æí
)

966 
buf„æí
 = (Ë
Àn
 ;

968 
	`mem˝y
 (
psf
->
u
.
dbuf
, 
±r
 + 
tŸÆ
, 
buf„æí
 *  ()) ;

970 
	`bd2d_wrôe
 (
psf
->
u
.
dbuf
, 
buf„æí
) ;

972 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

973 
	`ídsw≠_doubÀ_¨øy
 (
psf
->
u
.
dbuf
, 
buf„æí
) ;

975 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
dbuf
,  (), 
buf„æí
,Ösf) ;

976 
tŸÆ
 +
wrôecou¡
 ;

977 i‡(
wrôecou¡
 < 
buf„æí
)

979 
Àn
 -
wrôecou¡
 ;

982  
tŸÆ
 ;

983 
	}
}

989 
	$d2bd_ªad
 (*
buf„r
, 
cou¡
)

990 { --
cou¡
 >= 0)

991 { 
buf„r
 [
cou¡
] = 
	`DOUBLE64_READ
 ((*) (buffer + count)) ;

993 
	}
}

996 
	$bd2d_wrôe
 (*
buf„r
, 
cou¡
)

997 { --
cou¡
 >= 0)

998 { 
	`DOUBLE64_WRITE
 (
buf„r
 [
cou¡
], (*) (buffer + count)) ;

1000 
	}
}

	@libsndfile-1.0.17/src/dwd.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<f˙é.h
>

23 
	~<°rög.h
>

24 
	~<˘y≥.h
>

26 
	~"¢dfûe.h
"

27 
	~"s„ndün.h
"

28 
	~"comm⁄.h
"

30 #i‡(
ENABLE_EXPERIMENTAL_CODE
 == 0)

33 
	$dwd_›í
 (
SF_PRIVATE
 *
psf
)

34 { i‡(
psf
)

35  
SFE_UNIMPLEMENTED
 ;

36  (
psf
 && 0) ;

37 
	}
}

45 
	#SFE_DWD_NO_DWD
 1666

	)

46 
	#SFE_DWD_BAND_BIT_WIDTH
 1667

	)

47 
	#SFE_DWD_COMPRESSION
 1668

	)

49 
	#DWD_IDENTIFIER
 "Düm⁄dW¨êDigôized\n\0\x1a"

	)

50 
	#DWD_IDENTIFIER_LEN
 24

	)

52 
	#DWD_HEADER_LEN
 57

	)

62 
dwd_ªad_hódî
 (
SF_PRIVATE
 *
psf
) ;

64 
dwd_˛o£
 (
SF_PRIVATE
 *
psf
) ;

71 
	$dwd_›í
 (
SF_PRIVATE
 *
psf
)

72 { 
subf‹m©
, 
îr‹
 = 0 ;

74 i‡(
psf
->
mode
 =
SFM_READ
 || (psf->modê=
SFM_RDWR
 &&Ösf->
fûñígth
 > 0))

75 { i‡((
îr‹
 = 
	`dwd_ªad_hódî
 (
psf
)))

76  
îr‹
 ;

79 i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_DWD
)

80  
SFE_BAD_OPEN_FORMAT
 ;

82 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

84 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

99 
psf
->
c⁄èöî_˛o£
 = 
dwd_˛o£
 ;

103  
îr‹
 ;

104 
	}
}

110 
	$dwd_˛o£
 (
SF_PRIVATE
 *
psf
)

112 
psf
 =Ösf ;

115 
	}
}

122 { 
	mmaj‹
, 
	mmö‹
, 
	mcom¥essi⁄
, 
	mch™√ls
, 
	mbôwidth
 ;

123 
	m§©e
, 
	mmaxvÆ
 ;

124 
	mid
, 
	md©Æí
, 
	m‰ames
, 
	moff£t
 ;

125 } 
	tDWD_HEADER
 ;

128 
	$dwd_ªad_hódî
 (
SF_PRIVATE
 *
psf
)

129 { 
DWD_HEADER
 
dwdh
 ;

131 
	`mem£t
 (
psf
->
u
.
cbuf
, 0,  (psf->u.cbuf)) ;

133 
	`psf_böhódî_ªadf
 (
psf
, "pb", 0,Ösf->
u
.
cbuf
, 
DWD_IDENTIFIER_LEN
) ;

135 i‡(
	`memcmp
 (
psf
->
u
.
cbuf
, 
DWD_IDENTIFIER
, 
DWD_IDENTIFIER_LEN
) != 0)

136  
SFE_DWD_NO_DWD
 ;

138 
	`psf_log_¥ötf
 (
psf
, "Ród o∆y : Düm⁄dW¨êDigôized (.dwd)\n",Ösf->
u
.
cbuf
) ;

140 
	`psf_böhódî_ªadf
 (
psf
, "11", &
dwdh
.
maj‹
, &dwdh.
mö‹
) ;

141 
	`psf_böhódî_ªadf
 (
psf
, "e4j1", &
dwdh
.
id
, 1, &dwdh.
com¥essi⁄
) ;

142 
	`psf_böhódî_ªadf
 (
psf
, "e211", &
dwdh
.
§©e
, &dwdh.
ch™√ls
, &dwdh.
bôwidth
) ;

143 
	`psf_böhódî_ªadf
 (
psf
, "e24", &
dwdh
.
maxvÆ
, &dwdh.
d©Æí
) ;

144 
	`psf_böhódî_ªadf
 (
psf
, "e44", &
dwdh
.
‰ames
, &dwdh.
off£t
) ;

146 
	`psf_log_¥ötf
 (
psf
, " Version Major : %d\n Version Minor : %d\n Unique ID : %08X\n",

147 
dwdh
.
maj‹
, dwdh.
mö‹
, dwdh.
id
) ;

148 
	`psf_log_¥ötf
 (
psf
, " Com¥essi⁄ : %d => ", 
dwdh
.
com¥essi⁄
) ;

150 i‡(
dwdh
.
com¥essi⁄
 != 0)

151 { 
	`psf_log_¥ötf
 (
psf
, "Unsupported compression\n") ;

152  
SFE_DWD_COMPRESSION
 ;

155 
	`psf_log_¥ötf
 (
psf
, "None\n") ;

157 
	`psf_log_¥ötf
 (
psf
, " Sample Rate : %d\n Channels : %d\n"

159 
dwdh
.
§©e
, dwdh.
ch™√ls
, dwdh.
bôwidth
) ;

161 
dwdh
.
bôwidth
)

163 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_DWD
 | 
SF_FORMAT_PCM_S8
 ;

164 
psf
->
byãwidth
 = 1 ;

168 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_DWD
 | 
SF_FORMAT_PCM_16
 ;

169 
psf
->
byãwidth
 = 2 ;

173 
	`psf_log_¥ötf
 (
psf
, "*** Bad bô width %d\n", 
dwdh
.
bôwidth
) ;

174  
SFE_DWD_BAND_BIT_WIDTH
 ;

177 i‡(
psf
->
fûñígth
 !
dwdh
.
off£t
 + dwdh.
d©Æí
)

178 { 
	`psf_log_¥ötf
 (
psf
, " D©®Lígth : %d (should bê%D)\n", 
dwdh
.
d©Æí
,Ösf->
fûñígth
 - dwdh.
off£t
) ;

179 
dwdh
.
d©Æí
 = (Ë(
psf
->
fûñígth
 - dwdh.
off£t
) ;

182 
	`psf_log_¥ötf
 (
psf
, " D©®Lígth : %d\n", 
dwdh
.
d©Æí
) ;

184 
	`psf_log_¥ötf
 (
psf
, " Max VÆuê : %d\n", 
dwdh
.
maxvÆ
) ;

185 
	`psf_log_¥ötf
 (
psf
, " Føme† : %d\n", 
dwdh
.
‰ames
) ;

186 
	`psf_log_¥ötf
 (
psf
, " D©®Off£à : %d\n", 
dwdh
.
off£t
) ;

188 
psf
->
d©Æígth
 = 
dwdh
.
d©Æí
 ;

189 
psf
->
d©aoff£t
 = 
dwdh
.
off£t
 ;

191 
psf
->
ídün
 = 
SF_ENDIAN_LITTLE
 ;

193 
psf
->
sf
.
ßm∂î©e
 = 
dwdh
.
§©e
 ;

194 
psf
->
sf
.
ch™√ls
 = 
dwdh
.channels ;

195 
psf
->
sf
.
£˘i⁄s
 = 1 ;

197  
	`pcm_öô
 (
psf
) ;

198 
	}
}

	@libsndfile-1.0.17/src/dwvw.c

29 
	~"sfc⁄fig.h
"

31 
	~<°dio.h
>

32 
	~<°dlib.h
>

33 
	~<°rög.h
>

35 
	~"¢dfûe.h
"

36 
	~"s„ndün.h
"

37 
	~"Êﬂt_ˇ°.h
"

38 
	~"comm⁄.h
"

41 { 
	mdwm_maxsize
, 
	mbô_width
, 
	mmax_dñè
, 
	m•™
 ;

42 
	mßm∂ecou¡
 ;

43 
	mbô_cou¡
, 
	mbôs
, 
	mœ°_dñè_width
, 
	mœ°_ßm∂e
 ;

45 { 
	mödex
, 
	míd
 ;

46 
	mbuf„r
 [256] ;

47 } 
	mb
 ;

48 } 
	tDWVW_PRIVATE
 ;

53 
sf_cou¡_t
 
dwvw_ªad_s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

54 
sf_cou¡_t
 
dwvw_ªad_i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

55 
sf_cou¡_t
 
dwvw_ªad_f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

56 
sf_cou¡_t
 
dwvw_ªad_d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

58 
sf_cou¡_t
 
dwvw_wrôe_s
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

59 
sf_cou¡_t
 
dwvw_wrôe_i
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

60 
sf_cou¡_t
 
dwvw_wrôe_f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

61 
sf_cou¡_t
 
dwvw_wrôe_d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

63 
sf_cou¡_t
 
dwvw_£ek
 (
SF_PRIVATE
 *
psf
, 
mode
, sf_cou¡_à
off£t
) ;

64 
dwvw_˛o£
 (
SF_PRIVATE
 *
psf
) ;

66 
dwvw_decode_d©a
 (
SF_PRIVATE
 *
psf
, 
DWVW_PRIVATE
 *
pdwvw
, *
±r
, 
Àn
) ;

67 
dwvw_decode_lﬂd_bôs
 (
SF_PRIVATE
 *
psf
, 
DWVW_PRIVATE
 *
pdwvw
, 
bô_cou¡
) ;

69 
dwvw_ícode_d©a
 (
SF_PRIVATE
 *
psf
, 
DWVW_PRIVATE
 *
pdwvw
, c⁄° *
±r
, 
Àn
) ;

70 
dwvw_ícode_°‹e_bôs
 (
SF_PRIVATE
 *
psf
, 
DWVW_PRIVATE
 *
pdwvw
, 
d©a
, 
√w_bôs
) ;

71 
dwvw_ªad_ª£t
 (
DWVW_PRIVATE
 *
pdwvw
) ;

78 
	$dwvw_öô
 (
SF_PRIVATE
 *
psf
, 
bôwidth
)

79 { 
DWVW_PRIVATE
 *
pdwvw
 ;

81 i‡(
psf
->
codec_d©a
 !
NULL
)

82 { 
	`psf_log_¥ötf
 (
psf
, "***Ösf->codec_data isÇot NULL.\n") ;

83  
SFE_INTERNAL
 ;

86 i‡(
bôwidth
 > 24)

87  
SFE_DWVW_BAD_BITWIDTH
 ;

89 i‡(
psf
->
mode
 =
SFM_RDWR
)

90  
SFE_BAD_MODE_RW
 ;

92 i‡((
pdwvw
 = 
	`ˇŒoc
 (1,  (
DWVW_PRIVATE
))Ë=
NULL
)

93  
SFE_MALLOC_FAILED
 ;

95 
psf
->
codec_d©a
 = (*Ë
pdwvw
 ;

97 
pdwvw
->
bô_width
 = 
bôwidth
 ;

98 
pdwvw
->
dwm_maxsize
 = 
bôwidth
 / 2 ;

99 
pdwvw
->
max_dñè
 = 1 << (
bôwidth
 - 1) ;

100 
pdwvw
->
•™
 = 1 << 
bôwidth
 ;

102 
	`dwvw_ªad_ª£t
 (
pdwvw
) ;

104 i‡(
psf
->
mode
 =
SFM_READ
)

105 { 
psf
->
ªad_sh‹t
 = 
dwvw_ªad_s
 ;

106 
psf
->
ªad_öt
 = 
dwvw_ªad_i
 ;

107 
psf
->
ªad_Êﬂt
 = 
dwvw_ªad_f
 ;

108 
psf
->
ªad_doubÀ
 = 
dwvw_ªad_d
 ;

111 i‡(
psf
->
mode
 =
SFM_WRITE
)

112 { 
psf
->
wrôe_sh‹t
 = 
dwvw_wrôe_s
 ;

113 
psf
->
wrôe_öt
 = 
dwvw_wrôe_i
 ;

114 
psf
->
wrôe_Êﬂt
 = 
dwvw_wrôe_f
 ;

115 
psf
->
wrôe_doubÀ
 = 
dwvw_wrôe_d
 ;

118 
psf
->
codec_˛o£
 = 
dwvw_˛o£
 ;

119 
psf
->
£ek
 = 
dwvw_£ek
 ;

122 
psf
->
sf
.
‰ames
 = 
SF_COUNT_MAX
 ;

123 
psf
->
d©Æígth
 =Ösf->
sf
.
‰ames
 ;

127 
	}
}

133 
	$dwvw_˛o£
 (
SF_PRIVATE
 *
psf
)

134 { 
DWVW_PRIVATE
 *
pdwvw
 ;

136 i‡(
psf
->
codec_d©a
 =
NULL
)

138 
pdwvw
 = (
DWVW_PRIVATE
*Ë
psf
->
codec_d©a
 ;

140 i‡(
psf
->
mode
 =
SFM_WRITE
)

141 { 
œ°_vÆues
 [12] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } ;

144 
	`dwvw_ícode_d©a
 (
psf
, 
pdwvw
, 
œ°_vÆues
, 12) ;

147 
	`psf_fwrôe
 (
pdwvw
->
b
.
buf„r
, 1,Ödwvw->b.
ödex
, 
psf
) ;

149 i‡(
psf
->
wrôe_hódî
)

150 
psf
->
	`wrôe_hódî
 (psf, 
SF_TRUE
) ;

154 
	}
}

156 
sf_cou¡_t


157 
	$dwvw_£ek
 (
SF_PRIVATE
 *
psf
, 
mode
, 
sf_cou¡_t
 
off£t
)

158 { 
DWVW_PRIVATE
 *
pdwvw
 ;

160 
mode
 = mode ;

162 i‡(! 
psf
->
codec_d©a
)

163 { 
psf
->
îr‹
 = 
SFE_INTERNAL
 ;

164  
PSF_SEEK_ERROR
 ;

167 
pdwvw
 = (
DWVW_PRIVATE
*Ë
psf
->
codec_d©a
 ;

169 i‡(
off£t
 == 0)

170 { 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
, 
SEEK_SET
) ;

171 
	`dwvw_ªad_ª£t
 (
pdwvw
) ;

175 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

176  
PSF_SEEK_ERROR
 ;

177 
	}
}

183 
sf_cou¡_t


184 
	$dwvw_ªad_s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

185 { 
DWVW_PRIVATE
 *
pdwvw
 ;

186 *
ùå
 ;

187 
k
, 
buf„æí
, 
ªadcou¡
 = 0, 
cou¡
 ;

188 
sf_cou¡_t
 
tŸÆ
 = 0 ;

190 i‡(! 
psf
->
codec_d©a
)

192 
pdwvw
 = (
DWVW_PRIVATE
*Ë
psf
->
codec_d©a
 ;

194 
ùå
 = 
psf
->
u
.
ibuf
 ;

195 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

196 
Àn
 > 0)

197 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

198 
cou¡
 = 
	`dwvw_decode_d©a
 (
psf
, 
pdwvw
, 
ùå
, 
ªadcou¡
) ;

199 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

200 
±r
 [
tŸÆ
 + 
k
] = 
ùå
 [k] >> 16 ;

202 
tŸÆ
 +
cou¡
 ;

203 
Àn
 -
ªadcou¡
 ;

204 i‡(
cou¡
 !
ªadcou¡
)

208  
tŸÆ
 ;

209 
	}
}

211 
sf_cou¡_t


212 
	$dwvw_ªad_i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

213 { 
DWVW_PRIVATE
 *
pdwvw
 ;

214 
ªadcou¡
, 
cou¡
 ;

215 
sf_cou¡_t
 
tŸÆ
 = 0 ;

217 i‡(! 
psf
->
codec_d©a
)

219 
pdwvw
 = (
DWVW_PRIVATE
*Ë
psf
->
codec_d©a
 ;

221 
Àn
 > 0)

222 { 
ªadcou¡
 = (
Àn
 > 0x10000000) ? 0x10000000 : ()Üen ;

224 
cou¡
 = 
	`dwvw_decode_d©a
 (
psf
, 
pdwvw
, 
±r
, 
ªadcou¡
) ;

226 
tŸÆ
 +
cou¡
 ;

227 
Àn
 -
cou¡
 ;

229 i‡(
cou¡
 !
ªadcou¡
)

233  
tŸÆ
 ;

234 
	}
}

236 
sf_cou¡_t


237 
	$dwvw_ªad_f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

238 { 
DWVW_PRIVATE
 *
pdwvw
 ;

239 *
ùå
 ;

240 
k
, 
buf„æí
, 
ªadcou¡
 = 0, 
cou¡
 ;

241 
sf_cou¡_t
 
tŸÆ
 = 0 ;

242 
n‹mÁ˘
 ;

244 i‡(! 
psf
->
codec_d©a
)

246 
pdwvw
 = (
DWVW_PRIVATE
*Ë
psf
->
codec_d©a
 ;

248 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? 1.0 / (() 0x80000000) : 1.0 ;

250 
ùå
 = 
psf
->
u
.
ibuf
 ;

251 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

252 
Àn
 > 0)

253 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

254 
cou¡
 = 
	`dwvw_decode_d©a
 (
psf
, 
pdwvw
, 
ùå
, 
ªadcou¡
) ;

255 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

256 
±r
 [
tŸÆ
 + 
k
] = 
n‹mÁ˘
 * (Ë(
ùå
 [k]) ;

258 
tŸÆ
 +
cou¡
 ;

259 
Àn
 -
ªadcou¡
 ;

260 i‡(
cou¡
 !
ªadcou¡
)

264  
tŸÆ
 ;

265 
	}
}

267 
sf_cou¡_t


268 
	$dwvw_ªad_d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

269 { 
DWVW_PRIVATE
 *
pdwvw
 ;

270 *
ùå
 ;

271 
k
, 
buf„æí
, 
ªadcou¡
 = 0, 
cou¡
 ;

272 
sf_cou¡_t
 
tŸÆ
 = 0 ;

273 
n‹mÁ˘
 ;

275 i‡(! 
psf
->
codec_d©a
)

277 
pdwvw
 = (
DWVW_PRIVATE
*Ë
psf
->
codec_d©a
 ;

279 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? 1.0 / (() 0x80000000) : 1.0 ;

281 
ùå
 = 
psf
->
u
.
ibuf
 ;

282 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

283 
Àn
 > 0)

284 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

285 
cou¡
 = 
	`dwvw_decode_d©a
 (
psf
, 
pdwvw
, 
ùå
, 
ªadcou¡
) ;

286 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

287 
±r
 [
tŸÆ
 + 
k
] = 
n‹mÁ˘
 * (Ë(
ùå
 [k]) ;

289 
tŸÆ
 +
cou¡
 ;

290 
Àn
 -
ªadcou¡
 ;

291 i‡(
cou¡
 !
ªadcou¡
)

295  
tŸÆ
 ;

296 
	}
}

299 
	$dwvw_decode_d©a
 (
SF_PRIVATE
 *
psf
, 
DWVW_PRIVATE
 *
pdwvw
, *
±r
, 
Àn
)

300 { 
cou¡
 ;

301 
dñè_width_modifõr
, 
dñè_width
, 
dñè_√g©ive
, 
dñè
, 
ßm∂e
 ;

304 
dñè_width
 = 
pdwvw
->
œ°_dñè_width
 ;

305 
ßm∂e
 = 
pdwvw
->
œ°_ßm∂e
 ;

307 
cou¡
 = 0 ; cou¡ < 
Àn
 ; count++)

309 
dñè_width_modifõr
 = 
	`dwvw_decode_lﬂd_bôs
 (
psf
, 
pdwvw
, -1) ;

312 i‡(
dñè_width_modifõr
 < 0)

315 i‡(
dñè_width_modifõr
 && 
	`dwvw_decode_lﬂd_bôs
 (
psf
, 
pdwvw
, 1))

316 
dñè_width_modifõr
 = - delta_width_modifier ;

319 
dñè_width
 = (dñè_width + 
dñè_width_modifõr
 + 
pdwvw
->
bô_width
) %Ödwvw->bit_width ;

322 
dñè
 = 0 ;

323 i‡(
dñè_width
)

324 { 
dñè
 = 
	`dwvw_decode_lﬂd_bôs
 (
psf
, 
pdwvw
, 
dñè_width
 - 1) | (1 << (delta_width - 1)) ;

325 
dñè_√g©ive
 = 
	`dwvw_decode_lﬂd_bôs
 (
psf
, 
pdwvw
, 1) ;

326 i‡(
dñè
 =
pdwvw
->
max_dñè
 - 1)

327 
dñè
 +
	`dwvw_decode_lﬂd_bôs
 (
psf
, 
pdwvw
, 1) ;

328 i‡(
dñè_√g©ive
)

329 
dñè
 = -delta ;

333 
ßm∂e
 +
dñè
 ;

335 i‡(
ßm∂e
 >
pdwvw
->
max_dñè
)

336 
ßm∂e
 -
pdwvw
->
•™
 ;

337 i‡(
ßm∂e
 < - 
pdwvw
->
max_dñè
)

338 
ßm∂e
 +
pdwvw
->
•™
 ;

341 
±r
 [
cou¡
] = 
ßm∂e
 << (32 - 
pdwvw
->
bô_width
) ;

343 i‡(
pdwvw
->
b
.
íd
 =0 &&Ödwvw->
bô_cou¡
 == 0)

347 
pdwvw
->
œ°_dñè_width
 = 
dñè_width
 ;

348 
pdwvw
->
œ°_ßm∂e
 = 
ßm∂e
 ;

350 
pdwvw
->
ßm∂ecou¡
 +
cou¡
 ;

352  
cou¡
 ;

353 
	}
}

356 
	$dwvw_decode_lﬂd_bôs
 (
SF_PRIVATE
 *
psf
, 
DWVW_PRIVATE
 *
pdwvw
, 
bô_cou¡
)

357 { 
ouçut
 = 0, 
gë_dwm
 = 
SF_FALSE
 ;

365 i‡(
bô_cou¡
 < 0)

366 { 
gë_dwm
 = 
SF_TRUE
 ;

368 
bô_cou¡
 = 
pdwvw
->
dwm_maxsize
 ;

372 
pdwvw
->
bô_cou¡
 < bit_count)

373 { i‡(
pdwvw
->
b
.
ödex
 >pdwvw->b.
íd
)

374 { 
pdwvw
->
b
.
íd
 = 
	`psf_‰ód
 (pdwvw->b.
buf„r
, 1,  (pdwvw->b.buf„r), 
psf
) ;

375 
pdwvw
->
b
.
ödex
 = 0 ;

379 i‡(
bô_cou¡
 < 8 && 
pdwvw
->
b
.
íd
 == 0)

382 
pdwvw
->
bôs
 = (pdwvw->bits << 8) ;

384 i‡(
pdwvw
->
b
.
ödex
 <Ödwvw->b.
íd
)

385 { 
pdwvw
->
bôs
 |pdwvw->
b
.
buf„r
 [pdwvw->b.
ödex
] ;

386 
pdwvw
->
b
.
ödex
 ++ ;

388 
pdwvw
->
bô_cou¡
 += 8 ;

392 i‡(! 
gë_dwm
)

393 { 
ouçut
 = (
pdwvw
->
bôs
 >> (pdwvw->
bô_cou¡
 - bit_count)) & ((1 << bit_count) - 1) ;

394 
pdwvw
->
bô_cou¡
 -= bit_count ;

395  
ouçut
 ;

399 
ouçut
 < (
pdwvw
->
dwm_maxsize
))

400 { 
pdwvw
->
bô_cou¡
 -= 1 ;

401 i‡(
pdwvw
->
bôs
 & (1 <<Ödwvw->
bô_cou¡
))

403 
ouçut
 += 1 ;

406  
ouçut
 ;

407 
	}
}

410 
	$dwvw_ªad_ª£t
 (
DWVW_PRIVATE
 *
pdwvw
)

411 { 
pdwvw
->
ßm∂ecou¡
 = 0 ;

412 
pdwvw
->
b
.
ödex
 = 0 ;

413 
pdwvw
->
b
.
íd
 = 0 ;

414 
pdwvw
->
bô_cou¡
 = 0 ;

415 
pdwvw
->
bôs
 = 0 ;

416 
pdwvw
->
œ°_dñè_width
 = 0 ;

417 
pdwvw
->
œ°_ßm∂e
 = 0 ;

418 
	}
}

421 
	$dwvw_ícode_°‹e_bôs
 (
SF_PRIVATE
 *
psf
, 
DWVW_PRIVATE
 *
pdwvw
, 
d©a
, 
√w_bôs
)

422 { 
byã
 ;

425 
pdwvw
->
bôs
 = (pdwvw->bô†<< 
√w_bôs
Ë| (
d©a
 & ((1 <<Çew_bits) - 1)) ;

426 
pdwvw
->
bô_cou¡
 +
√w_bôs
 ;

429 
pdwvw
->
bô_cou¡
 >= 8)

430 { 
byã
 = 
pdwvw
->
bôs
 >> (pdwvw->
bô_cou¡
 - 8) ;

431 
pdwvw
->
bô_cou¡
 -= 8 ;

432 
pdwvw
->
b
.
buf„r
 [pdwvw->b.
ödex
] = 
byã
 & 0xFF ;

433 
pdwvw
->
b
.
ödex
 ++ ;

436 i‡(
pdwvw
->
b
.
ödex
 > 
	`SIGNED_SIZEOF
 (pdwvw->b.
buf„r
) - 4)

437 { 
	`psf_fwrôe
 (
pdwvw
->
b
.
buf„r
, 1,Ödwvw->b.
ödex
, 
psf
) ;

438 
pdwvw
->
b
.
ödex
 = 0 ;

442 
	}
}

447 
	$dump_bôs
 (
DWVW_PRIVATE
 *
pdwvw
)

448 { 
k
, 
mask
 ;

450 
k
 = 0 ; k < 10 && k < 
pdwvw
->
b
.
ödex
 ; k++)

451 { 
mask
 = 0x80 ;

452 
mask
)

453 { 
	`putch¨
 (
mask
 & 
pdwvw
->
b
.
buf„r
 [
k
] ? '1' : '0') ;

454 
mask
 >>= 1 ;

456 
	`putch¨
 (' ') ;

459 
k
 = 
pdwvw
->
bô_cou¡
 - 1 ; k >= 0 ; k --)

460 
	`putch¨
 (
pdwvw
->
bôs
 & (1 << 
k
) ? '1' : '0') ;

462 
	`putch¨
 ('\n') ;

463 
	}
}

466 
	#HIGHEST_BIT
(
x
,
cou¡
) \

467 { 
y
 = 
x
 ; \

468 (
cou¡
) = 0 ; \

469 
y
) \

470 { (
cou¡
) ++ ; \

471 
y
 >>= 1 ; \

473 } ;

	)

476 
	$dwvw_ícode_d©a
 (
SF_PRIVATE
 *
psf
, 
DWVW_PRIVATE
 *
pdwvw
, c⁄° *
±r
, 
Àn
)

477 { 
cou¡
 ;

478 
dñè_width_modifõr
, 
dñè
, 
dñè_√g©ive
, 
dñè_width
, 
exåa_bô
 ;

480 
cou¡
 = 0 ; cou¡ < 
Àn
 ; count++)

481 { 
dñè
 = (
±r
 [
cou¡
] >> (32 - 
pdwvw
->
bô_width
)Ë-Ödwvw->
œ°_ßm∂e
 ;

484 
exåa_bô
 = -1 ;

485 
dñè_√g©ive
 = 0 ;

486 i‡(
dñè
 < -
pdwvw
->
max_dñè
)

487 
dñè
 = 
pdwvw
->
max_dñè
 + (delta %Ödwvw->max_delta) ;

488 i‡(
dñè
 =-
pdwvw
->
max_dñè
)

489 { 
exåa_bô
 = 1 ;

490 
dñè_√g©ive
 = 1 ;

491 
dñè
 = 
pdwvw
->
max_dñè
 - 1 ;

493 i‡(
dñè
 > 
pdwvw
->
max_dñè
)

494 { 
dñè_√g©ive
 = 1 ;

495 
dñè
 = 
pdwvw
->
•™
 - delta ;

496 
dñè
 = 
	`abs
 (delta) ;

498 i‡(
dñè
 =
pdwvw
->
max_dñè
)

499 { 
exåa_bô
 = 1 ;

500 
dñè
 = 
pdwvw
->
max_dñè
 - 1 ;

502 i‡(
dñè
 < 0)

503 { 
dñè_√g©ive
 = 1 ;

504 
dñè
 = 
	`abs
 (delta) ;

507 i‡(
dñè
 =
pdwvw
->
max_dñè
 - 1 && 
exåa_bô
 == -1)

508 
exåa_bô
 = 0 ;

511 
	`HIGHEST_BIT
 (
dñè
, 
dñè_width
) ;

514 
dñè_width_modifõr
 = (
dñè_width
 - 
pdwvw
->
œ°_dñè_width
Ë%Ödwvw->
bô_width
 ;

515 i‡(
dñè_width_modifõr
 > 
pdwvw
->
dwm_maxsize
)

516 
dñè_width_modifõr
 -
pdwvw
->
bô_width
 ;

517 i‡(
dñè_width_modifõr
 < -
pdwvw
->
dwm_maxsize
)

518 
dñè_width_modifõr
 +
pdwvw
->
bô_width
 ;

521 
	`dwvw_ícode_°‹e_bôs
 (
psf
, 
pdwvw
, 0, 
	`abs
 (
dñè_width_modifõr
)) ;

522 i‡(
	`abs
 (
dñè_width_modifõr
Ë!
pdwvw
->
dwm_maxsize
)

523 
	`dwvw_ícode_°‹e_bôs
 (
psf
, 
pdwvw
, 1, 1) ;

526 i‡(
dñè_width_modifõr
 < 0)

527 
	`dwvw_ícode_°‹e_bôs
 (
psf
, 
pdwvw
, 1, 1) ;

528 i‡(
dñè_width_modifõr
 > 0)

529 
	`dwvw_ícode_°‹e_bôs
 (
psf
, 
pdwvw
, 0, 1) ;

532 i‡(
dñè_width
)

533 { 
	`dwvw_ícode_°‹e_bôs
 (
psf
, 
pdwvw
, 
dñè
, 
	`abs
 (
dñè_width
) - 1) ;

534 
	`dwvw_ícode_°‹e_bôs
 (
psf
, 
pdwvw
, (
dñè_√g©ive
 ? 1 : 0), 1) ;

538 i‡(
exåa_bô
 >= 0)

539 
	`dwvw_ícode_°‹e_bôs
 (
psf
, 
pdwvw
, 
exåa_bô
, 1) ;

541 
pdwvw
->
œ°_ßm∂e
 = 
±r
 [
cou¡
] >> (32 -Ödwvw->
bô_width
) ;

542 
pdwvw
->
œ°_dñè_width
 = 
dñè_width
 ;

545 
pdwvw
->
ßm∂ecou¡
 +
cou¡
 ;

547  
cou¡
 ;

548 
	}
}

550 
sf_cou¡_t


551 
	$dwvw_wrôe_s
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

552 { 
DWVW_PRIVATE
 *
pdwvw
 ;

553 *
ùå
 ;

554 
k
, 
buf„æí
, 
wrôecou¡
 = 0, 
cou¡
 ;

555 
sf_cou¡_t
 
tŸÆ
 = 0 ;

557 i‡(! 
psf
->
codec_d©a
)

559 
pdwvw
 = (
DWVW_PRIVATE
*Ë
psf
->
codec_d©a
 ;

561 
ùå
 = 
psf
->
u
.
ibuf
 ;

562 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

563 
Àn
 > 0)

564 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

565 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

566 
ùå
 [
k
] = 
±r
 [
tŸÆ
 + k] << 16 ;

567 
cou¡
 = 
	`dwvw_ícode_d©a
 (
psf
, 
pdwvw
, 
ùå
, 
wrôecou¡
) ;

569 
tŸÆ
 +
cou¡
 ;

570 
Àn
 -
wrôecou¡
 ;

571 i‡(
cou¡
 !
wrôecou¡
)

575  
tŸÆ
 ;

576 
	}
}

578 
sf_cou¡_t


579 
	$dwvw_wrôe_i
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

580 { 
DWVW_PRIVATE
 *
pdwvw
 ;

581 
wrôecou¡
, 
cou¡
 ;

582 
sf_cou¡_t
 
tŸÆ
 = 0 ;

584 i‡(! 
psf
->
codec_d©a
)

586 
pdwvw
 = (
DWVW_PRIVATE
*Ë
psf
->
codec_d©a
 ;

588 
Àn
 > 0)

589 { 
wrôecou¡
 = (
Àn
 > 0x10000000) ? 0x10000000 : ()Üen ;

591 
cou¡
 = 
	`dwvw_ícode_d©a
 (
psf
, 
pdwvw
, 
±r
, 
wrôecou¡
) ;

593 
tŸÆ
 +
cou¡
 ;

594 
Àn
 -
cou¡
 ;

596 i‡(
cou¡
 !
wrôecou¡
)

600  
tŸÆ
 ;

601 
	}
}

603 
sf_cou¡_t


604 
	$dwvw_wrôe_f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

605 { 
DWVW_PRIVATE
 *
pdwvw
 ;

606 *
ùå
 ;

607 
k
, 
buf„æí
, 
wrôecou¡
 = 0, 
cou¡
 ;

608 
sf_cou¡_t
 
tŸÆ
 = 0 ;

609 
n‹mÁ˘
 ;

611 i‡(! 
psf
->
codec_d©a
)

613 
pdwvw
 = (
DWVW_PRIVATE
*Ë
psf
->
codec_d©a
 ;

615 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? (1.0 * 0x7FFFFFFF) : 1.0 ;

617 
ùå
 = 
psf
->
u
.
ibuf
 ;

618 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

619 
Àn
 > 0)

620 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

621 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

622 
ùå
 [
k
] = 
	`Ãötf
 (
n‹mÁ˘
 * 
±r
 [
tŸÆ
 + k]) ;

623 
cou¡
 = 
	`dwvw_ícode_d©a
 (
psf
, 
pdwvw
, 
ùå
, 
wrôecou¡
) ;

625 
tŸÆ
 +
cou¡
 ;

626 
Àn
 -
wrôecou¡
 ;

627 i‡(
cou¡
 !
wrôecou¡
)

631  
tŸÆ
 ;

632 
	}
}

634 
sf_cou¡_t


635 
	$dwvw_wrôe_d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

636 { 
DWVW_PRIVATE
 *
pdwvw
 ;

637 *
ùå
 ;

638 
k
, 
buf„æí
, 
wrôecou¡
 = 0, 
cou¡
 ;

639 
sf_cou¡_t
 
tŸÆ
 = 0 ;

640 
n‹mÁ˘
 ;

642 i‡(! 
psf
->
codec_d©a
)

644 
pdwvw
 = (
DWVW_PRIVATE
*Ë
psf
->
codec_d©a
 ;

646 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? (1.0 * 0x7FFFFFFF) : 1.0 ;

648 
ùå
 = 
psf
->
u
.
ibuf
 ;

649 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

650 
Àn
 > 0)

651 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

652 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

653 
ùå
 [
k
] = 
	`Ãöt
 (
n‹mÁ˘
 * 
±r
 [
tŸÆ
 + k]) ;

654 
cou¡
 = 
	`dwvw_ícode_d©a
 (
psf
, 
pdwvw
, 
ùå
, 
wrôecou¡
) ;

656 
tŸÆ
 +
cou¡
 ;

657 
Àn
 -
wrôecou¡
 ;

658 i‡(
cou¡
 !
wrôecou¡
)

662  
tŸÆ
 ;

663 
	}
}

	@libsndfile-1.0.17/src/file_io.c

35 
	~"sfc⁄fig.h
"

37 
	~<°dio.h
>

38 
	~<°dlib.h
>

40 #i‡
HAVE_UNISTD_H


41 
	~<uni°d.h
>

44 #i‡(
HAVE_DECL_S_IRGRP
 == 0)

45 
	~<sf_uni°d.h
>

48 
	~<°rög.h
>

49 
	~<f˙é.h
>

50 
	~<î∫o.h
>

51 
	~<sys/°©.h
>

53 
	~"¢dfûe.h
"

54 
	~"comm⁄.h
"

56 
	#SENSIBLE_SIZE
 (0x40000000)

	)

58 
psf_log_sy£º
 (
SF_PRIVATE
 *
psf
, 
îr‹
) ;

60 #i‡(
USE_WINDOWS_API
 == 0)

66 
psf_˛o£_fd
 (
fd
) ;

67 
psf_›í_fd
 (c⁄° * 
∑th
, 
mode
) ;

68 
sf_cou¡_t
 
psf_gë_fûñí_fd
 (
fd
) ;

71 
	$psf_f›í
 (
SF_PRIVATE
 *
psf
, c⁄° *
∑th«me
, 
›í_mode
)

73 
psf
->
îr‹
 = 0 ;

74 
psf
->
fûedes
 = 
	`psf_›í_fd
 (
∑th«me
, 
›í_mode
) ;

76 i‡(
psf
->
fûedes
 =- 
SFE_BAD_OPEN_MODE
)

77 { 
psf
->
îr‹
 = 
SFE_BAD_OPEN_MODE
 ;

78 
psf
->
fûedes
 = -1 ;

79  
psf
->
îr‹
 ;

82 i‡(
psf
->
fûedes
 == -1)

83 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

85 
psf
->
mode
 = 
›í_mode
 ;

87  
psf
->
îr‹
 ;

88 
	}
}

91 
	$psf_f˛o£
 (
SF_PRIVATE
 *
psf
)

92 { 
ªtvÆ
 ;

94 i‡(
psf
->
vútuÆ_io
)

97 i‡(
psf
->
do_nŸ_˛o£_des¸ùt‹
)

98 { 
psf
->
fûedes
 = -1 ;

102 i‡((
ªtvÆ
 = 
	`psf_˛o£_fd
 (
psf
->
fûedes
)) == -1)

103 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

105 
psf
->
fûedes
 = -1 ;

107  
ªtvÆ
 ;

108 
	}
}

111 
	$psf_›í_r§c
 (
SF_PRIVATE
 *
psf
, 
›í_mode
)

113 i‡(
psf
->
r§cdes
 > 0)

117 
	`LSF_SNPRINTF
 (
psf
->
r§˝©h
,  (psf->r§˝©h), "%s/r§c",Ösf->
fûï©h
) ;

118 
psf
->
îr‹
 = 
SFE_NO_ERROR
 ;

119 i‡((
psf
->
r§cdes
 = 
	`psf_›í_fd
 (psf->
r§˝©h
, 
›í_mode
)) >= 0)

120 { 
psf
->
r§˛ígth
 = 
	`psf_gë_fûñí_fd
 (psf->
r§cdes
) ;

121 i‡(
psf
->
r§˛ígth
 > 0 || (
›í_mode
 & 
SFM_WRITE
))

122  
SFE_NO_ERROR
 ;

123 
	`psf_˛o£_fd
 (
psf
->
r§cdes
) ;

124 
psf
->
r§cdes
 = -1 ;

127 i‡(
psf
->
r§cdes
 =- 
SFE_BAD_OPEN_MODE
)

128 { 
psf
->
îr‹
 = 
SFE_BAD_OPEN_MODE
 ;

129  
psf
->
îr‹
 ;

136 
	`LSF_SNPRINTF
 (
psf
->
r§˝©h
,  (psf->r§˝©h), "%s._%s",Ösf->
dúe˘‹y
,Ösf->
fûíame
) ;

137 
psf
->
îr‹
 = 
SFE_NO_ERROR
 ;

138 i‡((
psf
->
r§cdes
 = 
	`psf_›í_fd
 (psf->
r§˝©h
, 
›í_mode
)) >= 0)

139 { 
psf
->
r§˛ígth
 = 
	`psf_gë_fûñí_fd
 (psf->
r§cdes
) ;

140  
SFE_NO_ERROR
 ;

147 
	`LSF_SNPRINTF
 (
psf
->
r§˝©h
,  (psf->r§˝©h), "%s.AµÀDoubÀ/%s",Ösf->
dúe˘‹y
,Ösf->
fûíame
) ;

148 
psf
->
îr‹
 = 
SFE_NO_ERROR
 ;

149 i‡((
psf
->
r§cdes
 = 
	`psf_›í_fd
 (psf->
r§˝©h
, 
›í_mode
)) >= 0)

150 { 
psf
->
r§˛ígth
 = 
	`psf_gë_fûñí_fd
 (psf->
r§cdes
) ;

151  
SFE_NO_ERROR
 ;

155 i‡(
psf
->
r§cdes
 == -1)

156 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

158 
psf
->
r§cdes
 = -1 ;

160  
psf
->
îr‹
 ;

161 
	}
}

163 
sf_cou¡_t


164 
	$psf_gë_fûñí
 (
SF_PRIVATE
 *
psf
)

165 { 
sf_cou¡_t
 
fûñí
 ;

167 i‡(
psf
->
vútuÆ_io
)

168  
psf
->
vio
.
	`gë_fûñí
 (psf->
vio_u£r_d©a
) ;

170 
fûñí
 = 
	`psf_gë_fûñí_fd
 (
psf
->
fûedes
) ;

172 i‡(
fûñí
 == -1)

173 { 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

174  (
sf_cou¡_t
) -1 ;

177 i‡(
fûñí
 =-
SFE_BAD_STAT_SIZE
)

178 { 
psf
->
îr‹
 = 
SFE_BAD_STAT_SIZE
 ;

179  (
sf_cou¡_t
) -1 ;

182 
psf
->
mode
)

183 { 
SFM_WRITE
 :

184 
fûñí
 = fûñí - 
psf
->
fûeoff£t
 ;

187 
SFM_READ
 :

188 i‡(
psf
->
fûeoff£t
 > 0 &&Ösf->
fûñígth
 > 0)

189 
fûñí
 = 
psf
->
fûñígth
 ;

192 
SFM_RDWR
 :

202 
fûñí
 = -1 ;

205  
fûñí
 ;

206 
	}
}

209 
	$psf_˛o£_r§c
 (
SF_PRIVATE
 *
psf
)

211 i‡(
psf
->
r§cdes
 >= 0)

212 
	`psf_˛o£_fd
 (
psf
->
r§cdes
) ;

213 
psf
->
r§cdes
 = -1 ;

215 
	}
}

218 
	$psf_£t_°dio
 (
SF_PRIVATE
 *
psf
, 
mode
)

219 { 
îr‹
 = 0 ;

221 
mode
)

222 { 
SFM_RDWR
 :

223 
îr‹
 = 
SFE_OPEN_PIPE_RDWR
 ;

226 
SFM_READ
 :

227 
psf
->
fûedes
 = 0 ;

230 
SFM_WRITE
 :

231 
psf
->
fûedes
 = 1 ;

235 
îr‹
 = 
SFE_BAD_OPEN_MODE
 ;

238 
psf
->
fûñígth
 = 0 ;

240  
îr‹
 ;

241 
	}
}

244 
	$psf_£t_fûe
 (
SF_PRIVATE
 *
psf
, 
fd
)

245 { 
psf
->
fûedes
 = 
fd
 ;

246 
	}
}

249 
	$psf_fûe_vÆid
 (
SF_PRIVATE
 *
psf
)

250 {  (
psf
->
fûedes
 >0Ë? 
SF_TRUE
 : 
SF_FALSE
 ;

251 
	}
}

253 
sf_cou¡_t


254 
	$psf_f£ek
 (
SF_PRIVATE
 *
psf
, 
sf_cou¡_t
 
off£t
, 
whí˚
)

255 { 
sf_cou¡_t
 
√w_posôi⁄
 ;

257 i‡(
psf
->
vútuÆ_io
)

258  
psf
->
vio
.
	`£ek
 (
off£t
, 
whí˚
,Ösf->
vio_u£r_d©a
) ;

260 
whí˚
)

261 { 
SEEK_SET
 :

262 
off£t
 +
psf
->
fûeoff£t
 ;

265 
SEEK_END
 :

266 i‡(
psf
->
mode
 =
SFM_WRITE
)

267 { 
√w_posôi⁄
 = 
	`l£ek
 (
psf
->
fûedes
, 
off£t
, 
whí˚
) ;

269 i‡(
√w_posôi⁄
 < 0)

270 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

272  
√w_posôi⁄
 - 
psf
->
fûeoff£t
 ;

279 
whí˚
 = 
SEEK_SET
 ;

280 
off£t
 = 
	`l£ek
 (
psf
->
fûedes
, 0, 
SEEK_END
) + offset ;

288 
√w_posôi⁄
 = 
	`l£ek
 (
psf
->
fûedes
, 
off£t
, 
whí˚
) ;

290 i‡(
√w_posôi⁄
 < 0)

291 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

293 
√w_posôi⁄
 -
psf
->
fûeoff£t
 ;

295  
√w_posôi⁄
 ;

296 
	}
}

298 
sf_cou¡_t


299 
	$psf_‰ód
 (*
±r
, 
sf_cou¡_t
 
byãs
, sf_cou¡_à
ôems
, 
SF_PRIVATE
 *
psf
)

300 { 
sf_cou¡_t
 
tŸÆ
 = 0 ;

301 
ssize_t
 
cou¡
 ;

303 i‡(
psf
->
vútuÆ_io
)

304  
psf
->
vio
.
	`ªad
 (
±r
, 
byãs
*
ôems
,Ösf->
vio_u£r_d©a
) / bytes ;

306 
ôems
 *
byãs
 ;

309 i‡(
ôems
 <= 0)

312 
ôems
 > 0)

314 
cou¡
 = (
ôems
 > 
SENSIBLE_SIZE
Ë? SENSIBLE_SIZE : (
ssize_t
) items ;

316 
cou¡
 = 
	`ªad
 (
psf
->
fûedes
, ((*Ë
±r
Ë+ 
tŸÆ
, (
size_t
) count) ;

318 i‡(
cou¡
 == -1)

319 { i‡(
î∫o
 =
EINTR
)

322 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

326 i‡(
cou¡
 == 0)

329 
tŸÆ
 +
cou¡
 ;

330 
ôems
 -
cou¡
 ;

333 i‡(
psf
->
is_pùe
)

334 
psf
->
pùeoff£t
 +
tŸÆ
 ;

336  
tŸÆ
 / 
byãs
 ;

337 
	}
}

339 
sf_cou¡_t


340 
	$psf_fwrôe
 (c⁄° *
±r
, 
sf_cou¡_t
 
byãs
, sf_cou¡_à
ôems
, 
SF_PRIVATE
 *
psf
)

341 { 
sf_cou¡_t
 
tŸÆ
 = 0 ;

342 
ssize_t
 
cou¡
 ;

344 i‡(
psf
->
vútuÆ_io
)

345  
psf
->
vio
.
	`wrôe
 (
±r
, 
byãs
*
ôems
,Ösf->
vio_u£r_d©a
) / bytes ;

347 
ôems
 *
byãs
 ;

350 i‡(
ôems
 <= 0)

353 
ôems
 > 0)

355 
cou¡
 = (
ôems
 > 
SENSIBLE_SIZE
) ? SENSIBLE_SIZE : items ;

357 
cou¡
 = 
	`wrôe
 (
psf
->
fûedes
, ((c⁄° *Ë
±r
Ë+ 
tŸÆ
, count) ;

359 i‡(
cou¡
 == -1)

360 { i‡(
î∫o
 =
EINTR
)

363 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

367 i‡(
cou¡
 == 0)

370 
tŸÆ
 +
cou¡
 ;

371 
ôems
 -
cou¡
 ;

374 i‡(
psf
->
is_pùe
)

375 
psf
->
pùeoff£t
 +
tŸÆ
 ;

377  
tŸÆ
 / 
byãs
 ;

378 
	}
}

380 
sf_cou¡_t


381 
	$psf_·ñl
 (
SF_PRIVATE
 *
psf
)

382 { 
sf_cou¡_t
 
pos
 ;

384 i‡(
psf
->
vútuÆ_io
)

385  
psf
->
vio
.
	`ãŒ
 (psf->
vio_u£r_d©a
) ;

387 i‡(
psf
->
is_pùe
)

388  
psf
->
pùeoff£t
 ;

390 
pos
 = 
	`l£ek
 (
psf
->
fûedes
, 0, 
SEEK_CUR
) ;

392 i‡(
pos
 =((
sf_cou¡_t
) -1))

393 { 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

397  
pos
 - 
psf
->
fûeoff£t
 ;

398 
	}
}

401 
	$psf_˛o£_fd
 (
fd
)

402 { 
ªtvÆ
 ;

404 (
ªtvÆ
 = 
	`˛o£
 (
fd
)Ë=-1 && 
î∫o
 =
EINTR
)

407  
ªtvÆ
 ;

408 
	}
}

410 
sf_cou¡_t


411 
	$psf_fgës
 (*
buf„r
, 
sf_cou¡_t
 
bufsize
, 
SF_PRIVATE
 *
psf
)

412 { 
sf_cou¡_t
 
k
 = 0 ;

413 
sf_cou¡_t
 
cou¡
 ;

415 
k
 < 
bufsize
 - 1)

416 { 
cou¡
 = 
	`ªad
 (
psf
->
fûedes
, &(
buf„r
 [
k
]), 1) ;

418 i‡(
cou¡
 == -1)

419 { i‡(
î∫o
 =
EINTR
)

422 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

426 i‡(
cou¡
 =0 || 
buf„r
 [
k
++] == '\n')

430 
buf„r
 [
k
] = 0 ;

432  
k
 ;

433 
	}
}

436 
	$psf_is_pùe
 (
SF_PRIVATE
 *
psf
)

437 { 
°©
 
°©buf
 ;

439 i‡(
psf
->
vútuÆ_io
)

440  
SF_FALSE
 ;

442 i‡(
	`f°©
 (
psf
->
fûedes
, &
°©buf
) == -1)

443 { 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

445  
SF_TRUE
 ;

448 i‡(
	`S_ISFIFO
 (
°©buf
.
°_mode
Ë|| 
	`S_ISSOCK
 (statbuf.st_mode))

449  
SF_TRUE
 ;

451  
SF_FALSE
 ;

452 
	}
}

454 
sf_cou¡_t


455 
	$psf_gë_fûñí_fd
 (
fd
)

456 { 
°©
 
°©buf
 ;

462 i‡( (
°©buf
.
°_size
Ë=4 &&  (
sf_cou¡_t
) == 8)

463  (
sf_cou¡_t
Ë-
SFE_BAD_STAT_SIZE
 ;

465 i‡(
	`f°©
 (
fd
, &
°©buf
) == -1)

466  (
sf_cou¡_t
) -1 ;

468  
°©buf
.
°_size
 ;

469 
	}
}

472 
	$psf_·runˇã
 (
SF_PRIVATE
 *
psf
, 
sf_cou¡_t
 
Àn
)

473 { 
ªtvÆ
 ;

476 i‡(
Àn
 < 0)

479 i‡(( (
off_t
Ë<  (
sf_cou¡_t
)Ë&& 
Àn
 > 0x7FFFFFFF)

482 
ªtvÆ
 = 
	`·runˇã
 (
psf
->
fûedes
, 
Àn
) ;

484 i‡(
ªtvÆ
 == -1)

485 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

487  
ªtvÆ
 ;

488 
	}
}

491 
	$psf_öô_fûes
 (
SF_PRIVATE
 *
psf
)

492 { 
psf
->
fûedes
 = -1 ;

493 
psf
->
r§cdes
 = -1 ;

494 
psf
->
ßvedes
 = -1 ;

495 
	}
}

498 
	$psf_u£_r§c
 (
SF_PRIVATE
 *
psf
, 
⁄_off
)

500 i‡(
⁄_off
)

501 { i‡(
psf
->
fûedes
 !psf->
r§cdes
)

502 { 
psf
->
ßvedes
 =Ösf->
fûedes
 ;

503 
psf
->
fûedes
 =Ösf->
r§cdes
 ;

506 i‡(
psf
->
fûedes
 =psf->
r§cdes
)

507 
psf
->
fûedes
 =Ösf->
ßvedes
 ;

510 
	}
}

513 
	$psf_›í_fd
 (c⁄° * 
∑th«me
, 
›í_mode
)

514 { 
fd
, 
oÊag
, 
mode
 ;

521 i‡( (
off_t
Ë! (
sf_cou¡_t
))

522 { 
	`puts
 ("\n\n*** FatalÉrror : sizeof (off_t) != sizeof (sf_count_t)") ;

523 
	`puts
 ("*** This meansÅhatÜibsndfile wasÇot configured correctly.\n") ;

524 
	`exô
 (1) ;

527 
›í_mode
)

528 { 
SFM_READ
 :

529 
oÊag
 = 
O_RDONLY
 ;

530 
mode
 = 0 ;

533 
SFM_WRITE
 :

534 
oÊag
 = 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 ;

535 
mode
 = 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IROTH
 ;

538 
SFM_RDWR
 :

539 
oÊag
 = 
O_RDWR
 | 
O_CREAT
 ;

540 
mode
 = 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IROTH
 ;

544  - 
SFE_BAD_OPEN_MODE
 ;

548 #i‡
OS_IS_WIN32


550 
oÊag
 |
O_BINARY
 ;

553 i‡(
mode
 == 0)

554 
fd
 = 
	`›í
 (
∑th«me
, 
oÊag
) ;

556 
fd
 = 
	`›í
 (
∑th«me
, 
oÊag
, 
mode
) ;

558  
fd
 ;

559 
	}
}

562 
	$psf_log_sy£º
 (
SF_PRIVATE
 *
psf
, 
îr‹
)

565 i‡(
psf
->
îr‹
 == 0)

566 { 
psf
->
îr‹
 = 
SFE_SYSTEM
 ;

567 
	`LSF_SNPRINTF
 (
psf
->
sy£º
,  (psf->sy£º), "Sy°emÉº‹ : %s.", 
	`°ªº‹
 (
îr‹
)) ;

571 
	}
}

574 
	$psf_fsync
 (
SF_PRIVATE
 *
psf
)

576 #i‡
HAVE_FSYNC


577 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

578 
	`fsync
 (
psf
->
fûedes
) ;

580 
psf
 = 
NULL
 ;

582 
	}
}

584 #ñif 
USE_WINDOWS_API


588 
	~<wödows.h
>

589 
	~<io.h
>

591 #i‚de‡
HAVE_SSIZE_T


592 
	tssize_t
 ;

595 
psf_˛o£_h™dÀ
 (
HANDLE
 
h™dÀ
) ;

596 
HANDLE
 
psf_›í_h™dÀ
 (c⁄° * 
∑th
, 
mode
) ;

597 
sf_cou¡_t
 
psf_gë_fûñí_h™dÀ
 (
HANDLE
 
h™dÀ
) ;

600 
	$psf_f›í
 (
SF_PRIVATE
 *
psf
, c⁄° *
∑th«me
, 
›í_mode
)

602 
psf
->
îr‹
 = 0 ;

603 
psf
->
hfûe
 = 
	`psf_›í_h™dÀ
 (
∑th«me
, 
›í_mode
) ;

605 i‡(
psf
->
hfûe
 =
NULL
)

606 
	`psf_log_sy£º
 (
psf
, 
	`GëLa°Eº‹
()) ;

608 
psf
->
mode
 = 
›í_mode
 ;

610  
psf
->
îr‹
 ;

611 
	}
}

614 
	$psf_f˛o£
 (
SF_PRIVATE
 *
psf
)

615 { 
ªtvÆ
 ;

617 i‡(
psf
->
vútuÆ_io
)

620 i‡(
psf
->
do_nŸ_˛o£_des¸ùt‹
)

621 { 
psf
->
hfûe
 = 
NULL
 ;

625 i‡((
ªtvÆ
 = 
	`psf_˛o£_h™dÀ
 (
psf
->
hfûe
)) == -1)

626 
	`psf_log_sy£º
 (
psf
, 
	`GëLa°Eº‹
 ()) ;

628 
psf
->
hfûe
 = 
NULL
 ;

630  
ªtvÆ
 ;

631 
	}
}

634 
	$psf_›í_r§c
 (
SF_PRIVATE
 *
psf
, 
›í_mode
)

636 i‡(
psf
->
hr§c
 !
NULL
)

640 
	`LSF_SNPRINTF
 (
psf
->
r§˝©h
,  (psf->r§˝©h), "%s/r§c",Ösf->
fûï©h
) ;

641 
psf
->
îr‹
 = 
SFE_NO_ERROR
 ;

642 i‡((
psf
->
hr§c
 = 
	`psf_›í_h™dÀ
 (psf->
r§˝©h
, 
›í_mode
)Ë!
NULL
)

643 { 
psf
->
r§˛ígth
 = 
	`psf_gë_fûñí_h™dÀ
 (psf->
hr§c
) ;

644  
SFE_NO_ERROR
 ;

651 
	`LSF_SNPRINTF
 (
psf
->
r§˝©h
,  (psf->r§˝©h), "%s._%s",Ösf->
dúe˘‹y
,Ösf->
fûíame
) ;

652 
psf
->
îr‹
 = 
SFE_NO_ERROR
 ;

653 i‡((
psf
->
hr§c
 = 
	`psf_›í_h™dÀ
 (psf->
r§˝©h
, 
›í_mode
)Ë!
NULL
)

654 { 
psf
->
r§˛ígth
 = 
	`psf_gë_fûñí_h™dÀ
 (psf->
hr§c
) ;

655  
SFE_NO_ERROR
 ;

662 
	`LSF_SNPRINTF
 (
psf
->
r§˝©h
,  (psf->r§˝©h), "%s.AµÀDoubÀ/%s",Ösf->
dúe˘‹y
,Ösf->
fûíame
) ;

663 
psf
->
îr‹
 = 
SFE_NO_ERROR
 ;

664 i‡((
psf
->
hr§c
 = 
	`psf_›í_h™dÀ
 (psf->
r§˝©h
, 
›í_mode
)Ë!
NULL
)

665 { 
psf
->
r§˛ígth
 = 
	`psf_gë_fûñí_h™dÀ
 (psf->
hr§c
) ;

666  
SFE_NO_ERROR
 ;

670 i‡(
psf
->
hr§c
 =
NULL
)

671 
	`psf_log_sy£º
 (
psf
, 
	`GëLa°Eº‹
 ()) ;

673 
psf
->
hr§c
 = 
NULL
 ;

675  
psf
->
îr‹
 ;

676 
	}
}

678  
sf_cou¡_t


679 
	$psf_gë_fûñí
 (
SF_PRIVATE
 *
psf
)

680 { 
sf_cou¡_t
 
fûñí
 ;

682 i‡(
psf
->
vútuÆ_io
)

683  
psf
->
vio
.
	`gë_fûñí
 (psf->
vio_u£r_d©a
) ;

685 
fûñí
 = 
	`psf_gë_fûñí_h™dÀ
 (
psf
->
hfûe
) ;

687 i‡(
fûñí
 == -1)

688 { 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

689  (
sf_cou¡_t
) -1 ;

692 i‡(
fûñí
 =-
SFE_BAD_STAT_SIZE
)

693 { 
psf
->
îr‹
 = 
SFE_BAD_STAT_SIZE
 ;

694  (
sf_cou¡_t
) -1 ;

697 
psf
->
mode
)

698 { 
SFM_WRITE
 :

699 
fûñí
 = fûñí - 
psf
->
fûeoff£t
 ;

702 
SFM_READ
 :

703 i‡(
psf
->
fûeoff£t
 > 0 &&Ösf->
fûñígth
 > 0)

704 
fûñí
 = 
psf
->
fûñígth
 ;

707 
SFM_RDWR
 :

717 
fûñí
 = -1 ;

720  
fûñí
 ;

721 
	}
}

724 
	$psf_öô_fûes
 (
SF_PRIVATE
 *
psf
)

725 { 
psf
->
hfûe
 = 
NULL
 ;

726 
psf
->
hr§c
 = 
NULL
 ;

727 
psf
->
hßved
 = 
NULL
 ;

728 
	}
}

731 
	$psf_u£_r§c
 (
SF_PRIVATE
 *
psf
, 
⁄_off
)

733 i‡(
⁄_off
)

734 { i‡(
psf
->
hfûe
 !psf->
hr§c
)

735 { 
psf
->
hßved
 =Ösf->
hfûe
 ;

736 
psf
->
hfûe
 =Ösf->
hr§c
 ;

739 i‡(
psf
->
hfûe
 =psf->
hr§c
)

740 
psf
->
hfûe
 =Ösf->
hßved
 ;

743 
	}
}

745  
HANDLE


746 
	$psf_›í_h™dÀ
 (c⁄° * 
∑th«me
, 
›í_mode
)

747 { 
DWORD
 
dwDesúedAc˚ss
 ;

748 
DWORD
 
dwSh¨eMode
 ;

749 
DWORD
 
dwCª©i⁄Di°ributi⁄
 ;

750 
HANDLE
 
h™dÀ
 ;

752 
›í_mode
)

753 { 
SFM_READ
 :

754 
dwDesúedAc˚ss
 = 
GENERIC_READ
 ;

755 
dwSh¨eMode
 = 
FILE_SHARE_READ
 | 
FILE_SHARE_WRITE
 ;

756 
dwCª©i⁄Di°ributi⁄
 = 
OPEN_EXISTING
 ;

759 
SFM_WRITE
 :

760 
dwDesúedAc˚ss
 = 
GENERIC_WRITE
 ;

761 
dwSh¨eMode
 = 
FILE_SHARE_READ
 | 
FILE_SHARE_WRITE
 ;

762 
dwCª©i⁄Di°ributi⁄
 = 
CREATE_ALWAYS
 ;

765 
SFM_RDWR
 :

766 
dwDesúedAc˚ss
 = 
GENERIC_READ
 | 
GENERIC_WRITE
 ;

767 
dwSh¨eMode
 = 
FILE_SHARE_READ
 | 
FILE_SHARE_WRITE
 ;

768 
dwCª©i⁄Di°ributi⁄
 = 
OPEN_ALWAYS
 ;

772  
NULL
 ;

775 
h™dÀ
 = 
	`Cª©eFûe
 (

776 
∑th«me
,

777 
dwDesúedAc˚ss
,

778 
dwSh¨eMode
,

780 
dwCª©i⁄Di°ributi⁄
,

781 
FILE_ATTRIBUTE_NORMAL
,

782 
NULL


785 i‡(
h™dÀ
 =
INVALID_HANDLE_VALUE
)

786  
NULL
 ;

788  
h™dÀ
 ;

789 
	}
}

792 
	$psf_log_sy£º
 (
SF_PRIVATE
 *
psf
, 
îr‹
)

793 { 
LPVOID
 
ÕMsgBuf
 ;

796 i‡(
psf
->
îr‹
 == 0)

797 { 
psf
->
îr‹
 = 
SFE_SYSTEM
 ;

799 
	`F‹m©Mesßge
 (

800 
FORMAT_MESSAGE_ALLOCATE_BUFFER
 | 
FORMAT_MESSAGE_FROM_SYSTEM
,

801 
NULL
,

802 
îr‹
,

803 
	`MAKELANGID
 (
LANG_NEUTRAL
, 
SUBLANG_DEFAULT
),

804 (
LPTSTR
Ë&
ÕMsgBuf
,

806 
NULL


809 
	`LSF_SNPRINTF
 (
psf
->
sy£º
,  (psf->sy£º), "Sy°emÉº‹ : %s", 
ÕMsgBuf
) ;

810 
	`LoˇlFªe
 (
ÕMsgBuf
) ;

814 
	}
}

818 
	$psf_˛o£_r§c
 (
SF_PRIVATE
 *
psf
)

820 i‡(
psf
->
hr§c
 !
NULL
)

821 
	`psf_˛o£_h™dÀ
 (
psf
->
hr§c
) ;

822 
psf
->
hr§c
 = 
NULL
 ;

824 
	}
}

828 
	$psf_£t_°dio
 (
SF_PRIVATE
 *
psf
, 
mode
)

829 { 
HANDLE
 
h™dÀ
 = 
NULL
 ;

830 
îr‹
 = 0 ;

832 
mode
)

833 { 
SFM_RDWR
 :

834 
îr‹
 = 
SFE_OPEN_PIPE_RDWR
 ;

837 
SFM_READ
 :

838 
h™dÀ
 = 
	`GëStdH™dÀ
 (
STD_INPUT_HANDLE
) ;

839 
psf
->
do_nŸ_˛o£_des¸ùt‹
 = 1 ;

842 
SFM_WRITE
 :

843 
h™dÀ
 = 
	`GëStdH™dÀ
 (
STD_OUTPUT_HANDLE
) ;

844 
psf
->
do_nŸ_˛o£_des¸ùt‹
 = 1 ;

848 
îr‹
 = 
SFE_BAD_OPEN_MODE
 ;

852 
psf
->
hfûe
 = 
h™dÀ
 ;

853 
psf
->
fûñígth
 = 0 ;

855  
îr‹
 ;

856 
	}
}

859 
	$psf_£t_fûe
 (
SF_PRIVATE
 *
psf
, 
fd
)

860 { 
HANDLE
 
h™dÀ
 ;

861 
osfh™dÀ
 ;

863 
osfh™dÀ
 = 
	`_gë_osfh™dÀ
 (
fd
) ;

864 
h™dÀ
 = (
HANDLE
Ë
osfh™dÀ
 ;

866 
psf
->
hfûe
 = 
h™dÀ
 ;

867 
	}
}

870 
	$psf_fûe_vÆid
 (
SF_PRIVATE
 *
psf
)

871 { i‡(
psf
->
hfûe
 =
NULL
)

872  
SF_FALSE
 ;

873 i‡(
psf
->
hfûe
 =
INVALID_HANDLE_VALUE
)

874  
SF_FALSE
 ;

875  
SF_TRUE
 ;

876 
	}
}

878  
sf_cou¡_t


879 
	$psf_f£ek
 (
SF_PRIVATE
 *
psf
, 
sf_cou¡_t
 
off£t
, 
whí˚
)

880 { 
sf_cou¡_t
 
√w_posôi⁄
 ;

881 
LONG
 
lDi°™˚ToMove
, 
lDi°™˚ToMoveHigh
 ;

882 
DWORD
 
dwMoveMëhod
 ;

883 
DWORD
 
dwResu…
, 
dwEº‹
 ;

885 i‡(
psf
->
vútuÆ_io
)

886  
psf
->
vio
.
	`£ek
 (
off£t
, 
whí˚
,Ösf->
vio_u£r_d©a
) ;

888 
whí˚
)

889 { 
SEEK_SET
 :

890 
off£t
 +
psf
->
fûeoff£t
 ;

891 
dwMoveMëhod
 = 
FILE_BEGIN
 ;

894 
SEEK_END
 :

895 
dwMoveMëhod
 = 
FILE_END
 ;

899 
dwMoveMëhod
 = 
FILE_CURRENT
 ;

903 
lDi°™˚ToMove
 = (
DWORD
Ë(
off£t
 & 0xFFFFFFFF) ;

904 
lDi°™˚ToMoveHigh
 = (
DWORD
Ë((
off£t
 >> 32) & 0xFFFFFFFF) ;

906 
dwResu…
 = 
	`SëFûePoöãr
 (
psf
->
hfûe
, 
lDi°™˚ToMove
, &
lDi°™˚ToMoveHigh
, 
dwMoveMëhod
) ;

908 i‡(
dwResu…
 == 0xFFFFFFFF)

909 
dwEº‹
 = 
	`GëLa°Eº‹
 () ;

911 
dwEº‹
 = 
NO_ERROR
 ;

913 i‡(
dwEº‹
 !
NO_ERROR
)

914 { 
	`psf_log_sy£º
 (
psf
, 
dwEº‹
) ;

918 
√w_posôi⁄
 = (
dwResu…
 + ((
__öt64
Ë
lDi°™˚ToMoveHigh
 << 32)Ë- 
psf
->
fûeoff£t
 ;

920  
√w_posôi⁄
 ;

921 
	}
}

923  
sf_cou¡_t


924 
	$psf_‰ód
 (*
±r
, 
sf_cou¡_t
 
byãs
, sf_cou¡_à
ôems
, 
SF_PRIVATE
 *
psf
)

925 { 
sf_cou¡_t
 
tŸÆ
 = 0 ;

926 
ssize_t
 
cou¡
 ;

927 
DWORD
 
dwNumbîOfByãsRód
 ;

929 i‡(
psf
->
vútuÆ_io
)

930  
psf
->
vio
.
	`ªad
 (
±r
, 
byãs
*
ôems
,Ösf->
vio_u£r_d©a
) / bytes ;

932 
ôems
 *
byãs
 ;

935 i‡(
ôems
 <= 0)

938 
ôems
 > 0)

940 
cou¡
 = (
ôems
 > 
SENSIBLE_SIZE
Ë? SENSIBLE_SIZE : (
ssize_t
) items ;

942 i‡(
	`RódFûe
 (
psf
->
hfûe
, ((*Ë
±r
Ë+ 
tŸÆ
, 
cou¡
, &
dwNumbîOfByãsRód
, 0) == 0)

943 { 
	`psf_log_sy£º
 (
psf
, 
	`GëLa°Eº‹
 ()) ;

947 
cou¡
 = 
dwNumbîOfByãsRód
 ;

949 i‡(
cou¡
 == 0)

952 
tŸÆ
 +
cou¡
 ;

953 
ôems
 -
cou¡
 ;

956 i‡(
psf
->
is_pùe
)

957 
psf
->
pùeoff£t
 +
tŸÆ
 ;

959  
tŸÆ
 / 
byãs
 ;

960 
	}
}

962  
sf_cou¡_t


963 
	$psf_fwrôe
 (c⁄° *
±r
, 
sf_cou¡_t
 
byãs
, sf_cou¡_à
ôems
, 
SF_PRIVATE
 *
psf
)

964 { 
sf_cou¡_t
 
tŸÆ
 = 0 ;

965 
ssize_t
 
cou¡
 ;

966 
DWORD
 
dwNumbîOfByãsWrôãn
 ;

968 i‡(
psf
->
vútuÆ_io
)

969  
psf
->
vio
.
	`wrôe
 (
±r
, 
byãs
 * 
ôems
,Ösf->
vio_u£r_d©a
) / bytes ;

971 
ôems
 *
byãs
 ;

974 i‡(
ôems
 <= 0)

977 
ôems
 > 0)

979 
cou¡
 = (
ôems
 > 
SENSIBLE_SIZE
Ë? SENSIBLE_SIZE : (
ssize_t
) items ;

981 i‡(
	`WrôeFûe
 (
psf
->
hfûe
, ((c⁄° *Ë
±r
Ë+ 
tŸÆ
, 
cou¡
, &
dwNumbîOfByãsWrôãn
, 0) == 0)

982 { 
	`psf_log_sy£º
 (
psf
, 
	`GëLa°Eº‹
 ()) ;

986 
cou¡
 = 
dwNumbîOfByãsWrôãn
 ;

988 i‡(
cou¡
 == 0)

991 
tŸÆ
 +
cou¡
 ;

992 
ôems
 -
cou¡
 ;

995 i‡(
psf
->
is_pùe
)

996 
psf
->
pùeoff£t
 +
tŸÆ
 ;

998  
tŸÆ
 / 
byãs
 ;

999 
	}
}

1001  
sf_cou¡_t


1002 
	$psf_·ñl
 (
SF_PRIVATE
 *
psf
)

1003 { 
sf_cou¡_t
 
pos
 ;

1004 
LONG
 
lDi°™˚ToMoveLow
, 
lDi°™˚ToMoveHigh
 ;

1005 
DWORD
 
dwResu…
, 
dwEº‹
 ;

1007 i‡(
psf
->
vútuÆ_io
)

1008  
psf
->
vio
.
	`ãŒ
 (psf->
vio_u£r_d©a
) ;

1010 i‡(
psf
->
is_pùe
)

1011  
psf
->
pùeoff£t
 ;

1013 
lDi°™˚ToMoveLow
 = 0 ;

1014 
lDi°™˚ToMoveHigh
 = 0 ;

1016 
dwResu…
 = 
	`SëFûePoöãr
 (
psf
->
hfûe
, 
lDi°™˚ToMoveLow
, &
lDi°™˚ToMoveHigh
, 
FILE_CURRENT
) ;

1018 i‡(
dwResu…
 == 0xFFFFFFFF)

1019 
dwEº‹
 = 
	`GëLa°Eº‹
 () ;

1021 
dwEº‹
 = 
NO_ERROR
 ;

1023 i‡(
dwEº‹
 !
NO_ERROR
)

1024 { 
	`psf_log_sy£º
 (
psf
, 
dwEº‹
) ;

1028 
pos
 = (
dwResu…
 + ((
__öt64
Ë
lDi°™˚ToMoveHigh
 << 32)) ;

1030  
pos
 - 
psf
->
fûeoff£t
 ;

1031 
	}
}

1034 
	$psf_˛o£_h™dÀ
 (
HANDLE
 
h™dÀ
)

1035 { i‡(
	`Clo£H™dÀ
 (
h™dÀ
) == 0)

1039 
	}
}

1041  
sf_cou¡_t


1042 
	$psf_fgës
 (*
buf„r
, 
sf_cou¡_t
 
bufsize
, 
SF_PRIVATE
 *
psf
)

1043 { 
sf_cou¡_t
 
k
 = 0 ;

1044 
sf_cou¡_t
 
cou¡
 ;

1045 
DWORD
 
dwNumbîOfByãsRód
 ;

1047 
k
 < 
bufsize
 - 1)

1048 { i‡(
	`RódFûe
 (
psf
->
hfûe
, &(
buf„r
 [
k
]), 1, &
dwNumbîOfByãsRód
, 0) == 0)

1049 { 
	`psf_log_sy£º
 (
psf
, 
	`GëLa°Eº‹
 ()) ;

1053 { 
cou¡
 = 
dwNumbîOfByãsRód
 ;

1055 i‡(
cou¡
 =0 || 
buf„r
 [
k
++] == '\n')

1060 
buf„r
 [
k
] = 0 ;

1062  
k
 ;

1063 
	}
}

1066 
	$psf_is_pùe
 (
SF_PRIVATE
 *
psf
)

1068 i‡(
psf
->
vútuÆ_io
)

1069  
SF_FALSE
 ;

1071 i‡(
	`GëFûeTy≥
 (
psf
->
hfûe
Ë=
FILE_TYPE_DISK
)

1072  
SF_FALSE
 ;

1075  
SF_TRUE
 ;

1076 
	}
}

1078  
sf_cou¡_t


1079 
	$psf_gë_fûñí_h™dÀ
 (
HANDLE
 
h™dÀ
)

1080 { 
sf_cou¡_t
 
fûñí
 ;

1081 
DWORD
 
dwFûeSizeLow
, 
dwFûeSizeHigh
, 
dwEº‹
 = 
NO_ERROR
 ;

1083 
dwFûeSizeLow
 = 
	`GëFûeSize
 (
h™dÀ
, &
dwFûeSizeHigh
) ;

1085 i‡(
dwFûeSizeLow
 == 0xFFFFFFFF)

1086 
dwEº‹
 = 
	`GëLa°Eº‹
 () ;

1088 i‡(
dwEº‹
 !
NO_ERROR
)

1089  (
sf_cou¡_t
) -1 ;

1091 
fûñí
 = 
dwFûeSizeLow
 + ((
__öt64
Ë
dwFûeSizeHigh
 << 32) ;

1093  
fûñí
 ;

1094 
	}
}

1097 
	$psf_fsync
 (
SF_PRIVATE
 *
psf
)

1098 { 
	`FlushFûeBuf„rs
 (
psf
->
hfûe
) ;

1099 
	}
}

1103 
	$psf_·runˇã
 (
SF_PRIVATE
 *
psf
, 
sf_cou¡_t
 
Àn
)

1104 { 
ªtvÆ
 = 0 ;

1105 
LONG
 
lDi°™˚ToMoveLow
, 
lDi°™˚ToMoveHigh
 ;

1106 
DWORD
 
dwResu…
, 
dwEº‹
 = 
NO_ERROR
 ;

1114 i‡(
Àn
 < 0)

1117 
lDi°™˚ToMoveLow
 = (
DWORD
Ë(
Àn
 & 0xFFFFFFFF) ;

1118 
lDi°™˚ToMoveHigh
 = (
DWORD
Ë((
Àn
 >> 32) & 0xFFFFFFFF) ;

1120 
dwResu…
 = 
	`SëFûePoöãr
 (
psf
->
hfûe
, 
lDi°™˚ToMoveLow
, &
lDi°™˚ToMoveHigh
, 
FILE_BEGIN
) ;

1122 i‡(
dwResu…
 == 0xFFFFFFFF)

1123 
dwEº‹
 = 
	`GëLa°Eº‹
 () ;

1125 i‡(
dwEº‹
 !
NO_ERROR
)

1126 { 
ªtvÆ
 = -1 ;

1127 
	`psf_log_sy£º
 (
psf
, 
dwEº‹
) ;

1135 i‡(
	`SëEndOfFûe
 (
psf
->
hfûe
) == 0)

1136 { 
ªtvÆ
 = -1 ;

1137 
	`psf_log_sy£º
 (
psf
, 
	`GëLa°Eº‹
 ()) ;

1141  
ªtvÆ
 ;

1142 
	}
}

1161 
	~<io.h
>

1162 
	~<dúe˘.h
>

1164 #i‚de‡
HAVE_SSIZE_T


1165 
	tssize_t
 ;

1169 
	$psf_f›í
 (
SF_PRIVATE
 *
psf
, c⁄° *
∑th«me
, 
›í_mode
)

1170 { 
oÊag
, 
mode
 ;

1172 
›í_mode
)

1173 { 
SFM_READ
 :

1174 
oÊag
 = 
O_RDONLY
 | 
O_BINARY
 ;

1175 
mode
 = 0 ;

1178 
SFM_WRITE
 :

1179 
oÊag
 = 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 | 
O_BINARY
 ;

1180 
mode
 = 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 ;

1183 
SFM_RDWR
 :

1184 
oÊag
 = 
O_RDWR
 | 
O_CREAT
 | 
O_BINARY
 ;

1185 
mode
 = 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 ;

1189 
psf
->
îr‹
 = 
SFE_BAD_OPEN_MODE
 ;

1194 i‡(
mode
 == 0)

1195 
psf
->
fûedes
 = 
	`›í
 (
∑th«me
, 
oÊag
) ;

1197 
psf
->
fûedes
 = 
	`›í
 (
∑th«me
, 
oÊag
, 
mode
) ;

1199 i‡(
psf
->
fûedes
 == -1)

1200 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

1202  
psf
->
fûedes
 ;

1203 
	}
}

1205  
sf_cou¡_t


1206 
	$psf_f£ek
 (
SF_PRIVATE
 *
psf
, 
sf_cou¡_t
 
off£t
, 
whí˚
)

1207 { 
sf_cou¡_t
 
√w_posôi⁄
 ;

1209 i‡(
psf
->
vútuÆ_io
)

1210  
psf
->
vio
.
	`£ek
 (
off£t
, 
whí˚
,Ösf->
vio_u£r_d©a
) ;

1212 
whí˚
)

1213 { 
SEEK_SET
 :

1214 
off£t
 +
psf
->
fûeoff£t
 ;

1217 
SEEK_END
 :

1218 i‡(
psf
->
mode
 =
SFM_WRITE
)

1219 { 
√w_posôi⁄
 = 
	`_l£eki64
 (
psf
->
fûedes
, 
off£t
, 
whí˚
) ;

1221 i‡(
√w_posôi⁄
 < 0)

1222 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

1224  
√w_posôi⁄
 - 
psf
->
fûeoff£t
 ;

1231 
whí˚
 = 
SEEK_SET
 ;

1232 
off£t
 = 
	`_l£eki64
 (
psf
->
fûedes
, 0, 
SEEK_END
) + offset ;

1246 i‡(
off£t
 =0 && 
whí˚
 =
SEEK_CUR
)

1247 
√w_posôi⁄
 = 
	`_ãŒi64
 (
psf
->
fûedes
) ;

1249 
√w_posôi⁄
 = 
	`_l£eki64
 (
psf
->
fûedes
, 
off£t
, 
whí˚
) ;

1251 i‡(
√w_posôi⁄
 < 0)

1252 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

1254 
√w_posôi⁄
 -
psf
->
fûeoff£t
 ;

1256  
√w_posôi⁄
 ;

1257 
	}
}

1259  
sf_cou¡_t


1260 
	$psf_‰ód
 (*
±r
, 
sf_cou¡_t
 
byãs
, sf_cou¡_à
ôems
, 
SF_PRIVATE
 *
psf
)

1261 { 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1262 
ssize_t
 
cou¡
 ;

1264 i‡(
psf
->
vútuÆ_io
)

1265  
psf
->
vio
.
	`ªad
 (
±r
, 
byãs
*
ôems
,Ösf->
vio_u£r_d©a
) / bytes ;

1267 
ôems
 *
byãs
 ;

1270 i‡(
ôems
 <= 0)

1273 
ôems
 > 0)

1275 
cou¡
 = (
ôems
 > 
SENSIBLE_SIZE
Ë? SENSIBLE_SIZE : (
ssize_t
) items ;

1277 
cou¡
 = 
	`ªad
 (
psf
->
fûedes
, ((*Ë
±r
Ë+ 
tŸÆ
, (
size_t
) count) ;

1279 i‡(
cou¡
 == -1)

1280 { i‡(
î∫o
 =
EINTR
)

1283 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

1287 i‡(
cou¡
 == 0)

1290 
tŸÆ
 +
cou¡
 ;

1291 
ôems
 -
cou¡
 ;

1294  
tŸÆ
 / 
byãs
 ;

1295 
	}
}

1297  
sf_cou¡_t


1298 
	$psf_fwrôe
 (c⁄° *
±r
, 
sf_cou¡_t
 
byãs
, sf_cou¡_à
ôems
, 
SF_PRIVATE
 *
psf
)

1299 { 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1300 
ssize_t
 
cou¡
 ;

1302 i‡(
psf
->
vútuÆ_io
)

1303  
psf
->
vio
.
	`wrôe
 (
±r
, 
byãs
*
ôems
,Ösf->
vio_u£r_d©a
) / bytes ;

1305 
ôems
 *
byãs
 ;

1308 i‡(
ôems
 <= 0)

1311 
ôems
 > 0)

1313 
cou¡
 = (
ôems
 > 
SENSIBLE_SIZE
) ? SENSIBLE_SIZE : items ;

1315 
cou¡
 = 
	`wrôe
 (
psf
->
fûedes
, ((c⁄° *Ë
±r
Ë+ 
tŸÆ
, count) ;

1317 i‡(
cou¡
 == -1)

1318 { i‡(
î∫o
 =
EINTR
)

1321 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

1325 i‡(
cou¡
 == 0)

1328 
tŸÆ
 +
cou¡
 ;

1329 
ôems
 -
cou¡
 ;

1332  
tŸÆ
 / 
byãs
 ;

1333 
	}
}

1335  
sf_cou¡_t


1336 
	$psf_·ñl
 (
SF_PRIVATE
 *
psf
)

1337 { 
sf_cou¡_t
 
pos
 ;

1339 i‡(
psf
->
vútuÆ_io
)

1340  
psf
->
vio
.
	`ãŒ
 (psf->
vio_u£r_d©a
) ;

1342 
pos
 = 
	`_ãŒi64
 (
psf
->
fûedes
) ;

1344 i‡(
pos
 =((
sf_cou¡_t
) -1))

1345 { 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

1349  
pos
 - 
psf
->
fûeoff£t
 ;

1350 
	}
}

1353 
	$psf_f˛o£
 (
SF_PRIVATE
 *
psf
)

1354 { 
ªtvÆ
 ;

1356 (
ªtvÆ
 = 
	`˛o£
 (
psf
->
fûedes
)Ë=-1 && 
î∫o
 =
EINTR
)

1359 i‡(
ªtvÆ
 == -1)

1360 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

1362 
psf
->
fûedes
 = -1 ;

1364  
ªtvÆ
 ;

1365 
	}
}

1367  
sf_cou¡_t


1368 
	$psf_fgës
 (*
buf„r
, 
sf_cou¡_t
 
bufsize
, 
SF_PRIVATE
 *
psf
)

1369 { 
sf_cou¡_t
 
k
 = 0 ;

1370 
sf_cou¡_t
 
cou¡
 ;

1372 
k
 < 
bufsize
 - 1)

1373 { 
cou¡
 = 
	`ªad
 (
psf
->
fûedes
, &(
buf„r
 [
k
]), 1) ;

1375 i‡(
cou¡
 == -1)

1376 { i‡(
î∫o
 =
EINTR
)

1379 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

1383 i‡(
cou¡
 =0 || 
buf„r
 [
k
++] == '\n')

1387 
buf„r
 [
k
] = 0 ;

1389  
k
 ;

1390 
	}
}

1393 
	$psf_is_pùe
 (
SF_PRIVATE
 *
psf
)

1394 { 
°©
 
°©buf
 ;

1396 i‡(
psf
->
vútuÆ_io
)

1397  
SF_FALSE
 ;

1400 i‡(
	`f°©
 (
psf
->
fûedes
, &
°©buf
) == -1)

1401 { 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

1403  
SF_TRUE
 ;

1407 i‡(
	`S_ISFIFO
 (
°©buf
.
°_mode
Ë|| 
	`S_ISSOCK
 (statbuf.st_mode))

1408  
SF_TRUE
 ;

1410  
SF_FALSE
 ;

1411 
	}
}

1413  
sf_cou¡_t


1414 
	$psf_gë_fûñí
 (
SF_PRIVATE
 *
psf
)

1422 
_°©i64
 
°©buf
 ;

1424 i‡(
	`_f°©i64
 (
psf
->
fûedes
, &
°©buf
))

1425 { 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

1426  (
sf_cou¡_t
) -1 ;

1429  
°©buf
.
°_size
 ;

1431 
sf_cou¡_t
 
cuºít
, 
fûñí
 ;

1433 i‡(
psf
->
vútuÆ_io
)

1434  
psf
->
vio
.
	`gë_fûñí
 (psf->
vio_u£r_d©a
) ;

1436 i‡((
cuºít
 = 
	`_ãŒi64
 (
psf
->
fûedes
)) < 0)

1437 { 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

1438  (
sf_cou¡_t
) -1 ;

1454 
	`_l£eki64
 (
psf
->
fûedes
, 0, 
SEEK_END
) ;

1456 i‡((
fûñí
 = 
	`_l£eki64
 (
psf
->
fûedes
, 0, 
SEEK_END
)) < 0)

1457 { 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

1458  (
sf_cou¡_t
) -1 ;

1461 i‡(
fûñí
 > 
cuºít
)

1462 
	`_l£eki64
 (
psf
->
fûedes
, 
cuºít
, 
SEEK_SET
) ;

1464 
psf
->
mode
)

1465 { 
SFM_WRITE
 :

1466 
fûñí
 = fûñí - 
psf
->
fûeoff£t
 ;

1469 
SFM_READ
 :

1470 i‡(
psf
->
fûeoff£t
 > 0 &&Ösf->
fûñígth
 > 0)

1471 
fûñí
 = 
psf
->
fûñígth
 ;

1474 
SFM_RDWR
 :

1483 
fûñí
 = 0 ;

1486  
fûñí
 ;

1488 
	}
}

1491 
	$psf_·runˇã
 (
SF_PRIVATE
 *
psf
, 
sf_cou¡_t
 
Àn
)

1492 { 
ªtvÆ
 ;

1495 i‡(
Àn
 < 0)

1505 i‡(
Àn
 > 0x7FFFFFFF)

1508 
ªtvÆ
 = 
	`chsize
 (
psf
->
fûedes
, 
Àn
) ;

1510 i‡(
ªtvÆ
 == -1)

1511 
	`psf_log_sy£º
 (
psf
, 
î∫o
) ;

1513  
ªtvÆ
 ;

1514 
	}
}

1518 
	$psf_log_sy£º
 (
SF_PRIVATE
 *
psf
, 
îr‹
)

1521 i‡(
psf
->
îr‹
 == 0)

1522 { 
psf
->
îr‹
 = 
SFE_SYSTEM
 ;

1523 
	`LSF_SNPRINTF
 (
psf
->
sy£º
,  (psf->sy£º), "Sy°emÉº‹ : %s", 
	`°ªº‹
 (
îr‹
)) ;

1527 
	}
}

	@libsndfile-1.0.17/src/flac.c

20 
	~"sfc⁄fig.h
"

22 
	~<°dio.h
>

23 
	~<°dlib.h
>

24 
	~<f˙é.h
>

25 
	~<°rög.h
>

26 
	~<˘y≥.h
>

28 
	~"¢dfûe.h
"

29 
	~"comm⁄.h
"

32 #i‚de‡
HAVE_FLAC_ALL_H


35 
	$Êac_›í
 (
SF_PRIVATE
 *
psf
)

36 { i‡(
psf
)

37  
SFE_UNIMPLEMENTED
 ;

38  (
psf
 && 0) ;

39 
	}
}

44 
	~<FLAC/Æl.h
>

46 
	~"s„ndün.h
"

47 
	~"Êﬂt_ˇ°.h
"

53 
	#ENC_BUFFER_SIZE
 4096

	)

56 { 
	mPFLAC_PCM_SHORT
 = 0,

57 
	mPFLAC_PCM_INT
 = 1,

58 
	mPFLAC_PCM_FLOAT
 = 2,

59 
	mPFLAC_PCM_DOUBLE
 = 3

60 } 
	tPFLAC_PCM
 ;

63 { 
FLAC__SìkabÀSåómDecodî
 *
	mfsd
 ;

64 
FLAC__SìkabÀSåómEncodî
 *
	mf£
 ;

65 
PFLAC_PCM
 
	mpcmty≥
 ;

66 * 
	m±r
 ;

67 
	mpos
, 
	mÀn
, 
	mªmaö
 ;

69 c⁄° 
FLAC__öt32
 * c⁄° * 
	mwbuf„r
 ;

70 
FLAC__öt32
 * 
	mrbuf„r
 [
FLAC__MAX_CHANNELS
] ;

72 
FLAC__öt32
* 
	mícbuf„r
 ;

73 
	mbuf„Ωos
 ;

75 c⁄° 
FLAC__Føme
 *
	m‰ame
 ;

76 
FLAC__boﬁ
 
	mbuf„rbackup
 ;

77 } 
	tFLAC_PRIVATE
 ;

79 
sf_cou¡_t
 
Êac_£ek
 (
SF_PRIVATE
 *
psf
, 
mode
, sf_cou¡_à
off£t
) ;

80 
Êac_˛o£
 (
SF_PRIVATE
 *
psf
) ;

82 
Êac_íc_öô
 (
SF_PRIVATE
 *
psf
) ;

83 
Êac_ªad_hódî
 (
SF_PRIVATE
 *
psf
) ;

85 
sf_cou¡_t
 
Êac_ªad_Êac2s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

86 
sf_cou¡_t
 
Êac_ªad_Êac2i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

87 
sf_cou¡_t
 
Êac_ªad_Êac2f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

88 
sf_cou¡_t
 
Êac_ªad_Êac2d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

90 
sf_cou¡_t
 
Êac_wrôe_s2Êac
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

91 
sf_cou¡_t
 
Êac_wrôe_i2Êac
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

92 
sf_cou¡_t
 
Êac_wrôe_f2Êac
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

93 
sf_cou¡_t
 
Êac_wrôe_d2Êac
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

95 
f2Êac8_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
) ;

96 
f2Êac16_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
) ;

97 
f2Êac24_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
) ;

98 
f2Êac8_˛ù_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
) ;

99 
f2Êac16_˛ù_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
) ;

100 
f2Êac24_˛ù_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
) ;

101 
d2Êac8_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
) ;

102 
d2Êac16_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
) ;

103 
d2Êac24_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
) ;

104 
d2Êac8_˛ù_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
) ;

105 
d2Êac16_˛ù_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
) ;

106 
d2Êac24_˛ù_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
) ;

108 
Êac_comm™d
 (
SF_PRIVATE
 *
psf
, 
comm™d
, *
d©a
, 
d©asize
) ;

111 
FLAC__SìkabÀSåómDecodîRódSètus
 
sf_Êac_ªad_ˇŒback
 (c⁄° 
FLAC__SìkabÀSåómDecodî
 *
decodî
, 
FLAC__byã
 
buf„r
 [], *
byãs
, *
˛õ¡_d©a
) ;

112 
FLAC__SìkabÀSåómDecodîSìkSètus
 
sf_Êac_£ek_ˇŒback
 (c⁄° 
FLAC__SìkabÀSåómDecodî
 *
decodî
, 
FLAC__uöt64
 
absﬁuã_byã_off£t
, *
˛õ¡_d©a
) ;

113 
FLAC__SìkabÀSåómDecodîTñlSètus
 
sf_Êac_ãŒ_ˇŒback
 (c⁄° 
FLAC__SìkabÀSåómDecodî
 *
decodî
, 
FLAC__uöt64
 *
absﬁuã_byã_off£t
, *
˛õ¡_d©a
) ;

114 
FLAC__SìkabÀSåómDecodîLígthSètus
 
sf_Êac_Àngth_ˇŒback
 (c⁄° 
FLAC__SìkabÀSåómDecodî
 *
decodî
, 
FLAC__uöt64
 *
°ªam_Àngth
, *
˛õ¡_d©a
) ;

115 
FLAC__boﬁ
 
sf_Êac_eof_ˇŒback
 (c⁄° 
FLAC__SìkabÀSåómDecodî
 *
decodî
, *
˛õ¡_d©a
) ;

116 
FLAC__SåómDecodîWrôeSètus
 
sf_Êac_wrôe_ˇŒback
 (c⁄° 
FLAC__SìkabÀSåómDecodî
 *
decodî
, c⁄° 
FLAC__Føme
 *
‰ame
, c⁄° 
FLAC__öt32
 * c⁄° 
buf„r
 [], *
˛õ¡_d©a
) ;

117 
sf_Êac_mëa_ˇŒback
 (c⁄° 
FLAC__SìkabÀSåómDecodî
 *
decodî
, c⁄° 
FLAC__SåómMëad©a
 *
mëad©a
, *
˛õ¡_d©a
) ;

118 
sf_Êac_îr‹_ˇŒback
 (c⁄° 
FLAC__SìkabÀSåómDecodî
 *
decodî
, 
FLAC__SåómDecodîEº‹Sètus
 
°©us
, *
˛õ¡_d©a
) ;

121 
FLAC__SìkabÀSåómEncodîSìkSètus
 
sf_Êac_íc_£ek_ˇŒback
 (c⁄° 
FLAC__SìkabÀSåómEncodî
 *
ícodî
, 
FLAC__uöt64
 
absﬁuã_byã_off£t
, *
˛õ¡_d©a
) ;

122 #ifde‡
HAVE_FLAC_1_1_1


123 
FLAC__SìkabÀSåómEncodîTñlSètus
 
sf_Êac_íc_ãŒ_ˇŒback
 (c⁄° 
FLAC__SìkabÀSåómEncodî
 *
ícodî
, 
FLAC__uöt64
 *
absﬁuã_byã_off£t
, *
˛õ¡_d©a
) ;

125 
FLAC__SåómEncodîWrôeSètus
 
sf_Êac_íc_wrôe_ˇŒback
 (c⁄° 
FLAC__SìkabÀSåómEncodî
 *
ícodî
, c⁄° 
FLAC__byã
 
buf„r
 [], 
byãs
, 
ßm∂es
, 
cuºít_‰ame
, *
˛õ¡_d©a
) ;

127 c⁄° 
	gÀgÆ_ßm∂e_øãs
 [] =

132 
	$s2Êac8_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
)

133 { --
cou¡
 >= 0)

134 
de°
 [
cou¡
] = 
§c
 [count] >> 8 ;

135 
	}
}

138 
	$s2Êac16_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
)

139 { --
cou¡
 >= 0)

140 
de°
 [
cou¡
] = 
§c
 [count] ;

141 
	}
}

144 
	$s2Êac24_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
)

145 { --
cou¡
 >= 0)

146 
de°
 [
cou¡
] = 
§c
 [count] << 8 ;

147 
	}
}

150 
	$i2Êac8_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
)

151 { --
cou¡
 >= 0)

152 
de°
 [
cou¡
] = 
§c
 [count] >> 24 ;

153 
	}
}

156 
	$i2Êac16_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
)

158 --
cou¡
 >= 0)

159 
de°
 [
cou¡
] = 
§c
 [count] >> 16 ;

160 
	}
}

163 
	$i2Êac24_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
)

164 { --
cou¡
 >= 0)

165 
de°
 [
cou¡
] = 
§c
 [count] >> 8 ;

166 
	}
}

168 
sf_cou¡_t


169 
	$Êac_buf„r_c›y
 (
SF_PRIVATE
 *
psf
)

170 { 
FLAC_PRIVATE
* 
pÊac
 = (FLAC_PRIVATE*Ë
psf
->
codec_d©a
 ;

171 c⁄° 
FLAC__Føme
 *
‰ame
 = 
pÊac
->frame ;

172 c⁄° 
FLAC__öt32
* c⁄° *
buf„r
 = 
pÊac
->
wbuf„r
 ;

173 
i
 = 0, 
j
, 
off£t
 ;

175 i‡(
pÊac
->
±r
 =
NULL
)

180 
pÊac
->
buf„rbackup
 = 
SF_TRUE
 ;

181 
i
 = 0 ; i < 
‰ame
->
hódî
.
ch™√ls
 ; i++)

182 { i‡(
pÊac
->
rbuf„r
 [
i
] =
NULL
)

183 
pÊac
->
rbuf„r
 [
i
] = 
	`ˇŒoc
 (
‰ame
->
hódî
.
blocksize
,  (
FLAC__öt32
)) ;

184 
	`mem˝y
 (
pÊac
->
rbuf„r
 [
i
], 
buf„r
 [i], 
‰ame
->
hódî
.
blocksize
 *  (
FLAC__öt32
)) ;

186 
pÊac
->
wbuf„r
 = (c⁄° 
FLAC__öt32
* c⁄°*ËpÊac->
rbuf„r
 ;

191 
pÊac
->
pcmty≥
)

192 { 
PFLAC_PCM_SHORT
 :

193 { *
ªçcm
 = ((*Ë
pÊac
->
±r
) ;

194 
shi·
 = 16 - 
‰ame
->
hódî
.
bôs_≥r_ßm∂e
 ;

195 i‡(
shi·
 < 0)

196 { 
shi·
 = 
	`abs
 (shift) ;

197 
i
 = 0 ; i < 
‰ame
->
hódî
.
blocksize
 && 
pÊac
->
ªmaö
 > 0 ; i++)

198 { 
off£t
 = 
pÊac
->
pos
 + 
i
 * 
‰ame
->
hódî
.
ch™√ls
 ;

199 
j
 = 0 ; j < 
‰ame
->
hódî
.
ch™√ls
 ; j++)

200 
ªçcm
 [
off£t
 + 
j
] = 
buf„r
 [j][
pÊac
->
buf„Ωos
] >> 
shi·
 ;

201 
pÊac
->
ªmaö
 -
‰ame
->
hódî
.
ch™√ls
 ;

202 
pÊac
->
buf„Ωos
++ ;

206 { 
i
 = 0 ; i < 
‰ame
->
hódî
.
blocksize
 && 
pÊac
->
ªmaö
 > 0 ; i++)

207 { 
off£t
 = 
pÊac
->
pos
 + 
i
 * 
‰ame
->
hódî
.
ch™√ls
 ;

209 i‡(
pÊac
->
buf„Ωos
 >
‰ame
->
hódî
.
blocksize
)

212 
j
 = 0 ; j < 
‰ame
->
hódî
.
ch™√ls
 ; j++)

213 
ªçcm
 [
off£t
 + 
j
] = (
buf„r
 [j][
pÊac
->
buf„Ωos
]Ë<< 
shi·
 ;

215 
pÊac
->
ªmaö
 -
‰ame
->
hódî
.
ch™√ls
 ;

216 
pÊac
->
buf„Ωos
++ ;

222 
PFLAC_PCM_INT
 :

223 { *
ªçcm
 = ((*Ë
pÊac
->
±r
) ;

224 
shi·
 = 32 - 
‰ame
->
hódî
.
bôs_≥r_ßm∂e
 ;

225 
i
 = 0 ; i < 
‰ame
->
hódî
.
blocksize
 && 
pÊac
->
ªmaö
 > 0 ; i++)

226 { 
off£t
 = 
pÊac
->
pos
 + 
i
 * 
‰ame
->
hódî
.
ch™√ls
 ;

228 i‡(
pÊac
->
buf„Ωos
 >
‰ame
->
hódî
.
blocksize
)

231 
j
 = 0 ; j < 
‰ame
->
hódî
.
ch™√ls
 ; j++)

232 
ªçcm
 [
off£t
 + 
j
] = 
buf„r
 [j][
pÊac
->
buf„Ωos
] << 
shi·
 ;

233 
pÊac
->
ªmaö
 -
‰ame
->
hódî
.
ch™√ls
 ;

234 
pÊac
->
buf„Ωos
++ ;

239 
PFLAC_PCM_FLOAT
 :

240 { *
ªçcm
 = ((*Ë
pÊac
->
±r
) ;

241 
n‹m
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
Ë? 1.0 / (1 << (
‰ame
->
hódî
.
bôs_≥r_ßm∂e
 - 1)) : 1.0 ;

243 
i
 = 0 ; i < 
‰ame
->
hódî
.
blocksize
 && 
pÊac
->
ªmaö
 > 0 ; i++)

244 { 
off£t
 = 
pÊac
->
pos
 + 
i
 * 
‰ame
->
hódî
.
ch™√ls
 ;

246 i‡(
pÊac
->
buf„Ωos
 >
‰ame
->
hódî
.
blocksize
)

249 
j
 = 0 ; j < 
‰ame
->
hódî
.
ch™√ls
 ; j++)

250 
ªçcm
 [
off£t
 + 
j
] = 
buf„r
 [j][
pÊac
->
buf„Ωos
] * 
n‹m
 ;

251 
pÊac
->
ªmaö
 -
‰ame
->
hódî
.
ch™√ls
 ;

252 
pÊac
->
buf„Ωos
++ ;

257 
PFLAC_PCM_DOUBLE
 :

258 { *
ªçcm
 = ((*Ë
pÊac
->
±r
) ;

259 
n‹m
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
Ë? 1.0 / (1 << (
‰ame
->
hódî
.
bôs_≥r_ßm∂e
 - 1)) : 1.0 ;

261 
i
 = 0 ; i < 
‰ame
->
hódî
.
blocksize
 && 
pÊac
->
ªmaö
 > 0 ; i++)

262 { 
off£t
 = 
pÊac
->
pos
 + 
i
 * 
‰ame
->
hódî
.
ch™√ls
 ;

264 i‡(
pÊac
->
buf„Ωos
 >
‰ame
->
hódî
.
blocksize
)

267 
j
 = 0 ; j < 
‰ame
->
hódî
.
ch™√ls
 ; j++)

268 
ªçcm
 [
off£t
 + 
j
] = 
buf„r
 [j][
pÊac
->
buf„Ωos
] * 
n‹m
 ;

269 
pÊac
->
ªmaö
 -
‰ame
->
hódî
.
ch™√ls
 ;

270 
pÊac
->
buf„Ωos
++ ;

279 
off£t
 = 
i
 * 
‰ame
->
hódî
.
ch™√ls
 ;

280 
pÊac
->
pos
 +
i
 * 
‰ame
->
hódî
.
ch™√ls
 ;

282  
off£t
 ;

283 
	}
}

286 
FLAC__SìkabÀSåómDecodîRódSètus


287 
sf_Êac_ªad_ˇŒback
 (c⁄° 
FLAC__SìkabÀSåómDecodî
 * 
UNUSED
 (
decodî
), 
FLAC__byã
 
buf„r
 [], *
byãs
, *
˛õ¡_d©a
)

288 { 
SF_PRIVATE
 *
	gpsf
 = (SF_PRIVATE*Ë
˛õ¡_d©a
 ;

290 *
	gbyãs
 = 
psf_‰ód
 (
buf„r
, 1, *
byãs
, 
psf
) ;

291 i‡(*
	gbyãs
 > 0 && 
	gpsf
->
	gîr‹
 == 0)

292  
FLAC__SEEKABLE_STREAM_DECODER_READ_STATUS_OK
 ;

294  
	gFLAC__SEEKABLE_STREAM_DECODER_READ_STATUS_ERROR
 ;

297 
FLAC__SìkabÀSåómDecodîSìkSètus


298 
sf_Êac_£ek_ˇŒback
 (c⁄° 
FLAC__SìkabÀSåómDecodî
 * 
UNUSED
 (
decodî
), 
FLAC__uöt64
 
absﬁuã_byã_off£t
, *
˛õ¡_d©a
)

299 { 
SF_PRIVATE
 *
	gpsf
 = (SF_PRIVATE*Ë
˛õ¡_d©a
 ;

301 
psf_f£ek
 (
psf
, 
absﬁuã_byã_off£t
, 
SEEK_SET
) ;

302 i‡(
	gpsf
->
	gîr‹
)

303  
	gFLAC__SEEKABLE_STREAM_DECODER_SEEK_STATUS_ERROR
 ;

305  
	gFLAC__SEEKABLE_STREAM_DECODER_SEEK_STATUS_OK
 ;

308 
FLAC__SìkabÀSåómDecodîTñlSètus


309 
sf_Êac_ãŒ_ˇŒback
 (c⁄° 
FLAC__SìkabÀSåómDecodî
 * 
UNUSED
 (
decodî
), 
FLAC__uöt64
 *
absﬁuã_byã_off£t
, *
˛õ¡_d©a
)

310 { 
SF_PRIVATE
 *
	gpsf
 = (SF_PRIVATE*Ë
˛õ¡_d©a
 ;

312 *
	gabsﬁuã_byã_off£t
 = 
psf_·ñl
 (
psf
) ;

313 i‡(
	gpsf
->
	gîr‹
)

314  
	gFLAC__SEEKABLE_STREAM_DECODER_TELL_STATUS_ERROR
 ;

316  
	gFLAC__SEEKABLE_STREAM_DECODER_TELL_STATUS_OK
 ;

319 
FLAC__SìkabÀSåómDecodîLígthSètus


320 
sf_Êac_Àngth_ˇŒback
 (c⁄° 
FLAC__SìkabÀSåómDecodî
 * 
UNUSED
 (
decodî
), 
FLAC__uöt64
 *
°ªam_Àngth
, *
˛õ¡_d©a
)

321 { 
SF_PRIVATE
 *
	gpsf
 = (SF_PRIVATE*Ë
˛õ¡_d©a
 ;

323 i‡((*
	g°ªam_Àngth
 = 
psf
->
fûñígth
) == 0)

324  
FLAC__SEEKABLE_STREAM_DECODER_LENGTH_STATUS_ERROR
 ;

326  
	gFLAC__SEEKABLE_STREAM_DECODER_LENGTH_STATUS_OK
 ;

329 
FLAC__boﬁ


330 
sf_Êac_eof_ˇŒback
 (c⁄° 
FLAC__SìkabÀSåómDecodî
 *
UNUSED
 (
decodî
), *
˛õ¡_d©a
)

331 { 
SF_PRIVATE
 *
	gpsf
 = (SF_PRIVATE*Ë
˛õ¡_d©a
 ;

333 i‡(
psf_·ñl
 (
psf
Ë=psf->
fûñígth
)

334  
SF_TRUE
 ;

336  
	gSF_FALSE
 ;

339 
FLAC__SåómDecodîWrôeSètus


340 
sf_Êac_wrôe_ˇŒback
 (c⁄° 
FLAC__SìkabÀSåómDecodî
 * 
UNUSED
 (
decodî
), c⁄° 
FLAC__Føme
 *
‰ame
, c⁄° 
FLAC__öt32
 * c⁄° 
buf„r
 [], *
˛õ¡_d©a
)

341 { 
SF_PRIVATE
 *
	gpsf
 = (SF_PRIVATE*Ë
˛õ¡_d©a
 ;

342 
FLAC_PRIVATE
* 
	gpÊac
 = (FLAC_PRIVATE*Ë
psf
->
codec_d©a
 ;

344 
	gpÊac
->
	g‰ame
 = 
‰ame
 ;

345 
	gpÊac
->
	gbuf„Ωos
 = 0 ;

347 
	gpÊac
->
	gbuf„rbackup
 = 
SF_FALSE
 ;

348 
	gpÊac
->
	gwbuf„r
 = 
buf„r
 ;

350 
Êac_buf„r_c›y
 (
psf
) ;

352  
	gFLAC__STREAM_DECODER_WRITE_STATUS_CONTINUE
 ;

356 
sf_Êac_mëa_ˇŒback
 (c⁄° 
FLAC__SìkabÀSåómDecodî
 * 
UNUSED
 (
decodî
), c⁄° 
FLAC__SåómMëad©a
 *
mëad©a
, *
˛õ¡_d©a
)

357 { 
SF_PRIVATE
 *
	gpsf
 = (SF_PRIVATE*Ë
˛õ¡_d©a
 ;

359 
	gmëad©a
->
	gty≥
)

360 { 
	gFLAC__METADATA_TYPE_STREAMINFO
 :

361 
psf
->
sf
.
ch™√ls
 = 
mëad©a
->
d©a
.
°ªam_öfo
.channels ;

362 
	gpsf
->
	gsf
.
	gßm∂î©e
 = 
mëad©a
->
d©a
.
°ªam_öfo
.
ßm∂e_øã
 ;

363 
	gpsf
->
	gsf
.
	g‰ames
 = 
mëad©a
->
d©a
.
°ªam_öfo
.
tŸÆ_ßm∂es
 ;

365 
	gmëad©a
->
	gd©a
.
	g°ªam_öfo
.
	gbôs_≥r_ßm∂e
)

367 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_PCM_S8
 ;

370 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_PCM_16
 ;

373 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_PCM_24
 ;

376 
psf_log_¥ötf
 (
psf
, "sf_Êac_mëa_ˇŒback : bôs_≥r_ßm∂ê%dÇŸ yë im∂emíãd.\n", 
mëad©a
->
d©a
.
°ªam_öfo
.
bôs_≥r_ßm∂e
) ;

382 
psf_log_¥ötf
 (
psf
, "sf_Êac_mëa_ˇŒback : mëad©a-ty≥ %dÇŸ yë im∂emíãd.\n", 
mëad©a
->
ty≥
) ;

390 
sf_Êac_îr‹_ˇŒback
 (c⁄° 
FLAC__SìkabÀSåómDecodî
 * 
UNUSED
 (
decodî
), 
FLAC__SåómDecodîEº‹Sètus
 
°©us
, *
˛õ¡_d©a
)

391 { 
SF_PRIVATE
 *
	gpsf
 = (SF_PRIVATE*Ë
˛õ¡_d©a
 ;

393 
psf_log_¥ötf
 (
psf
, "ERROR : %s\n", 
FLAC__SåómDecodîEº‹SètusSåög
 [
°©us
]) ;

395 
	g°©us
)

396 { 
	gFLAC__STREAM_DECODER_ERROR_STATUS_LOST_SYNC
 :

397 
psf
->
îr‹
 = 
SFE_FLAC_LOST_SYNC
 ;

399 
	gFLAC__STREAM_DECODER_ERROR_STATUS_BAD_HEADER
 :

400 
psf
->
îr‹
 = 
SFE_FLAC_BAD_HEADER
 ;

403 
psf
->
îr‹
 = 
SFE_FLAC_UNKOWN_ERROR
 ;

410 
FLAC__SìkabÀSåómEncodîSìkSètus


411 
sf_Êac_íc_£ek_ˇŒback
 (c⁄° 
FLAC__SìkabÀSåómEncodî
 * 
UNUSED
 (
ícodî
), 
FLAC__uöt64
 
absﬁuã_byã_off£t
, *
˛õ¡_d©a
)

412 { 
SF_PRIVATE
 *
	gpsf
 = (SF_PRIVATE*Ë
˛õ¡_d©a
 ;

414 
psf_f£ek
 (
psf
, 
absﬁuã_byã_off£t
, 
SEEK_SET
) ;

415 i‡(
	gpsf
->
	gîr‹
)

416  
	gFLAC__SEEKABLE_STREAM_ENCODER_SEEK_STATUS_ERROR
 ;

418  
	gFLAC__SEEKABLE_STREAM_ENCODER_SEEK_STATUS_OK
 ;

421 #ifde‡
HAVE_FLAC_1_1_1


422 
FLAC__SìkabÀSåómEncodîTñlSètus


423 
sf_Êac_íc_ãŒ_ˇŒback
 (c⁄° 
FLAC__SìkabÀSåómEncodî
 *
UNUSED
 (
ícodî
), 
FLAC__uöt64
 *
absﬁuã_byã_off£t
, *
˛õ¡_d©a
)

424 { 
SF_PRIVATE
 *
	gpsf
 = (SF_PRIVATE*Ë
˛õ¡_d©a
 ;

426 *
	gabsﬁuã_byã_off£t
 = 
psf_·ñl
 (
psf
) ;

427 i‡(
	gpsf
->
	gîr‹
)

428  
	gFLAC__SEEKABLE_STREAM_ENCODER_TELL_STATUS_ERROR
 ;

430  
	gFLAC__SEEKABLE_STREAM_ENCODER_TELL_STATUS_OK
 ;

434 
FLAC__SåómEncodîWrôeSètus


435 
sf_Êac_íc_wrôe_ˇŒback
 (c⁄° 
FLAC__SìkabÀSåómEncodî
 * 
UNUSED
 (
ícodî
), c⁄° 
FLAC__byã
 
buf„r
 [], 
byãs
, UNUSED (
ßm∂es
), UNUSED (
cuºít_‰ame
), *
˛õ¡_d©a
)

436 { 
SF_PRIVATE
 *
	gpsf
 = (SF_PRIVATE*Ë
˛õ¡_d©a
 ;

438 i‡(
psf_fwrôe
 (
buf„r
, 1, 
byãs
, 
psf
Ë=byã†&&Ösf->
îr‹
 == 0)

439  
FLAC__STREAM_ENCODER_WRITE_STATUS_OK
 ;

441  
	gFLAC__STREAM_ENCODER_WRITE_STATUS_FATAL_ERROR
 ;

449 
	$Êac_›í
 (
SF_PRIVATE
 *
psf
)

450 { 
subf‹m©
 ;

451 
îr‹
 = 0 ;

453 
FLAC_PRIVATE
* 
pÊac
 = 
	`ˇŒoc
 (1,  (FLAC_PRIVATE)) ;

454 
psf
->
codec_d©a
 = 
pÊac
 ;

456 i‡(
psf
->
mode
 =
SFM_RDWR
)

457  
SFE_UNIMPLEMENTED
 ;

459 i‡(
psf
->
mode
 =
SFM_READ
)

460 { i‡((
îr‹
 = 
	`Êac_ªad_hódî
 (
psf
)))

461  
îr‹
 ;

464 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

466 i‡(
psf
->
mode
 =
SFM_WRITE
)

467 { i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_FLAC
)

468  
SFE_BAD_OPEN_FORMAT
 ;

470 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

472 i‡((
îr‹
 = 
	`Êac_íc_öô
 (
psf
)))

473  
îr‹
 ;

476 
psf
->
d©Æígth
 =Ösf->
fûñígth
 ;

477 
psf
->
d©aoff£t
 = 0 ;

478 
psf
->
blockwidth
 = 0 ;

479 
psf
->
byãwidth
 = 1 ;

481 
psf
->
c⁄èöî_˛o£
 = 
Êac_˛o£
 ;

482 
psf
->
£ek
 = 
Êac_£ek
 ;

483 
psf
->
comm™d
 = 
Êac_comm™d
 ;

485 
psf
->
blockwidth
 =Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

487 
subf‹m©
)

488 { 
SF_FORMAT_PCM_S8
 :

489 
SF_FORMAT_PCM_16
 :

490 
SF_FORMAT_PCM_24
 :

491 
îr‹
 = 
	`Êac_öô
 (
psf
) ;

494  :  
SFE_UNIMPLEMENTED
 ;

497  
îr‹
 ;

498 
	}
}

504 
	$Êac_˛o£
 (
SF_PRIVATE
 *
psf
)

505 { 
FLAC_PRIVATE
* 
pÊac
 ;

506 
k
 ;

508 i‡((
pÊac
 = (
FLAC_PRIVATE
*Ë
psf
->
codec_d©a
Ë=
NULL
)

511 i‡(
psf
->
mode
 =
SFM_WRITE
)

512 { 
	`FLAC__£ekabÀ_°ªam_ícodî_föish
 (
pÊac
->
f£
) ;

513 
	`FLAC__£ekabÀ_°ªam_ícodî_dñëe
 (
pÊac
->
f£
) ;

514 i‡(
pÊac
->
ícbuf„r
)

515 
	`‰ì
 (
pÊac
->
ícbuf„r
) ;

518 i‡(
psf
->
mode
 =
SFM_READ
)

519 { 
	`FLAC__£ekabÀ_°ªam_decodî_föish
 (
pÊac
->
fsd
) ;

520 
	`FLAC__£ekabÀ_°ªam_decodî_dñëe
 (
pÊac
->
fsd
) ;

523 
k
 = 0 ; k < 
	`ARRAY_LEN
 (
pÊac
->
rbuf„r
) ; k++)

524 
	`‰ì
 (
pÊac
->
rbuf„r
 [
k
]) ;

526 
	`‰ì
 (
pÊac
) ;

527 
psf
->
codec_d©a
 = 
NULL
 ;

530 
	}
}

533 
	$Êac_íc_öô
 (
SF_PRIVATE
 *
psf
)

534 { 
FLAC_PRIVATE
* 
pÊac
 = (FLAC_PRIVATE*Ë
psf
->
codec_d©a
 ;

535 
bps
 ;

536 
k
, 
found
 ;

538 
found
 = 0 ;

539 
k
 = 0 ; k < 
	`ARRAY_LEN
 (
ÀgÆ_ßm∂e_øãs
) ; k++)

540 i‡(
psf
->
sf
.
ßm∂î©e
 =
ÀgÆ_ßm∂e_øãs
 [
k
])

541 { 
found
 = 1 ;

545 i‡(
found
 == 0)

546  
SFE_FLAC_BAD_SAMPLE_RATE
 ;

548 
	`psf_f£ek
 (
psf
, 0, 
SEEK_SET
) ;

549 i‡((
pÊac
->
f£
 = 
	`FLAC__£ekabÀ_°ªam_ícodî_√w
 ()Ë=
NULL
)

550  
SFE_FLAC_NEW_DECODER
 ;

551 
	`FLAC__£ekabÀ_°ªam_ícodî_£t_wrôe_ˇŒback
 (
pÊac
->
f£
, 
sf_Êac_íc_wrôe_ˇŒback
) ;

552 
	`FLAC__£ekabÀ_°ªam_ícodî_£t_£ek_ˇŒback
 (
pÊac
->
f£
, 
sf_Êac_íc_£ek_ˇŒback
) ;

554 #ifde‡
HAVE_FLAC_1_1_1


555 
	`FLAC__£ekabÀ_°ªam_ícodî_£t_ãŒ_ˇŒback
 (
pÊac
->
f£
, 
sf_Êac_íc_ãŒ_ˇŒback
) ;

557 
	`FLAC__£ekabÀ_°ªam_ícodî_£t_˛õ¡_d©a
 (
pÊac
->
f£
, 
psf
) ;

558 
	`FLAC__£ekabÀ_°ªam_ícodî_£t_ch™√ls
 (
pÊac
->
f£
, 
psf
->
sf
.
ch™√ls
) ;

559 
	`FLAC__£ekabÀ_°ªam_ícodî_£t_ßm∂e_øã
 (
pÊac
->
f£
, 
psf
->
sf
.
ßm∂î©e
) ;

561 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
)

562 { 
SF_FORMAT_PCM_S8
 :

563 
bps
 = 8 ;

565 
SF_FORMAT_PCM_16
 :

566 
bps
 = 16 ;

568 
SF_FORMAT_PCM_24
 :

569 
bps
 = 24 ;

573 
bps
 = 0 ;

577 
	`FLAC__£ekabÀ_°ªam_ícodî_£t_bôs_≥r_ßm∂e
 (
pÊac
->
f£
, 
bps
) ;

579 i‡((
bps
 = 
	`FLAC__£ekabÀ_°ªam_ícodî_öô
 (
pÊac
->
f£
)Ë!
FLAC__SEEKABLE_STREAM_DECODER_OK
)

580 { 
	`psf_log_¥ötf
 (
psf
, "Eº‹ : FLACÉncodî inôÑëu∫edÉº‹ : %s\n", 
	`FLAC__£ekabÀ_°ªam_ícodî_gë_ªsﬁved_°©e_°rög
 (
pÊac
->
f£
)) ;

581  
SFE_FLAC_INIT_DECODER
 ;

584 i‡(
psf
->
îr‹
 == 0)

585 
psf
->
d©aoff£t
 = 
	`psf_·ñl
 (psf) ;

586 
pÊac
->
ícbuf„r
 = 
	`ˇŒoc
 (
ENC_BUFFER_SIZE
,  (
FLAC__öt32
)) ;

588  
psf
->
îr‹
 ;

589 
	}
}

592 
	$Êac_ªad_hódî
 (
SF_PRIVATE
 *
psf
)

593 { 
FLAC_PRIVATE
* 
pÊac
 = (FLAC_PRIVATE*Ë
psf
->
codec_d©a
 ;

595 
	`psf_f£ek
 (
psf
, 0, 
SEEK_SET
) ;

596 i‡((
pÊac
->
fsd
 = 
	`FLAC__£ekabÀ_°ªam_decodî_√w
 ()Ë=
NULL
)

597  
SFE_FLAC_NEW_DECODER
 ;

599 
	`FLAC__£ekabÀ_°ªam_decodî_£t_ªad_ˇŒback
 (
pÊac
->
fsd
, 
sf_Êac_ªad_ˇŒback
) ;

600 
	`FLAC__£ekabÀ_°ªam_decodî_£t_£ek_ˇŒback
 (
pÊac
->
fsd
, 
sf_Êac_£ek_ˇŒback
) ;

601 
	`FLAC__£ekabÀ_°ªam_decodî_£t_ãŒ_ˇŒback
 (
pÊac
->
fsd
, 
sf_Êac_ãŒ_ˇŒback
) ;

602 
	`FLAC__£ekabÀ_°ªam_decodî_£t_Àngth_ˇŒback
 (
pÊac
->
fsd
, 
sf_Êac_Àngth_ˇŒback
) ;

603 
	`FLAC__£ekabÀ_°ªam_decodî_£t_eof_ˇŒback
 (
pÊac
->
fsd
, 
sf_Êac_eof_ˇŒback
) ;

604 
	`FLAC__£ekabÀ_°ªam_decodî_£t_wrôe_ˇŒback
 (
pÊac
->
fsd
, 
sf_Êac_wrôe_ˇŒback
) ;

605 
	`FLAC__£ekabÀ_°ªam_decodî_£t_mëad©a_ˇŒback
 (
pÊac
->
fsd
, 
sf_Êac_mëa_ˇŒback
) ;

606 
	`FLAC__£ekabÀ_°ªam_decodî_£t_îr‹_ˇŒback
 (
pÊac
->
fsd
, 
sf_Êac_îr‹_ˇŒback
) ;

607 
	`FLAC__£ekabÀ_°ªam_decodî_£t_˛õ¡_d©a
 (
pÊac
->
fsd
, 
psf
) ;

609 i‡(
	`FLAC__£ekabÀ_°ªam_decodî_öô
 (
pÊac
->
fsd
Ë!
FLAC__SEEKABLE_STREAM_DECODER_OK
)

610  
SFE_FLAC_INIT_DECODER
 ;

612 
	`FLAC__£ekabÀ_°ªam_decodî_¥o˚ss_u¡û_íd_of_mëad©a
 (
pÊac
->
fsd
) ;

613 i‡(
psf
->
îr‹
 == 0)

614 { 
FLAC__uöt64
 
posôi⁄
 ;

615 
	`FLAC__£ekabÀ_°ªam_decodî_gë_decode_posôi⁄
 (
pÊac
->
fsd
, &
posôi⁄
) ;

616 
psf
->
d©aoff£t
 = 
posôi⁄
 ;

619  
psf
->
îr‹
 ;

620 
	}
}

623 
	$Êac_comm™d
 (
SF_PRIVATE
 *
psf
, 
comm™d
, *
d©a
, 
d©asize
)

626 
psf
 =Ösf ;

627 
d©a
 = data ;

628 
d©asize
 = datasize ;

630 
comm™d
)

635 
	}
}

638 
	$Êac_öô
 (
SF_PRIVATE
 *
psf
)

640 i‡(
psf
->
mode
 =
SFM_RDWR
)

641  
SFE_BAD_MODE_RW
 ;

643 i‡(
psf
->
mode
 =
SFM_READ
)

644 { 
psf
->
ªad_sh‹t
 = 
Êac_ªad_Êac2s
 ;

645 
psf
->
ªad_öt
 = 
Êac_ªad_Êac2i
 ;

646 
psf
->
ªad_Êﬂt
 = 
Êac_ªad_Êac2f
 ;

647 
psf
->
ªad_doubÀ
 = 
Êac_ªad_Êac2d
 ;

650 i‡(
psf
->
mode
 =
SFM_WRITE
)

651 { 
psf
->
wrôe_sh‹t
 = 
Êac_wrôe_s2Êac
 ;

652 
psf
->
wrôe_öt
 = 
Êac_wrôe_i2Êac
 ;

653 
psf
->
wrôe_Êﬂt
 = 
Êac_wrôe_f2Êac
 ;

654 
psf
->
wrôe_doubÀ
 = 
Êac_wrôe_d2Êac
 ;

657 
psf
->
byãwidth
 = 1 ;

658 
psf
->
blockwidth
 =Ösf->
sf
.
ch™√ls
 ;

660 i‡(
psf
->
fûñígth
 >Ösf->
d©aoff£t
)

661 
psf
->
d©Æígth
 = (psf->
d©´nd
Ë?Ösf->d©´nd -Ösf->
d©aoff£t
 :Ösf->
fûñígth
 -Ösf->dataoffset ;

663 
psf
->
d©Æígth
 = 0 ;

666 
	}
}

669 
	$Êac_ªad_lo›
 (
SF_PRIVATE
 *
psf
, 
Àn
)

670 { 
FLAC_PRIVATE
* 
pÊac
 = (FLAC_PRIVATE*Ë
psf
->
codec_d©a
 ;

672 
pÊac
->
pos
 = 0 ;

673 
pÊac
->
Àn
 =Üen ;

674 
pÊac
->
ªmaö
 = 
Àn
 ;

675 i‡(
pÊac
->
‰ame
 !
NULL
 &&ÖÊac->
buf„Ωos
 <ÖÊac->‰ame->
hódî
.
blocksize
)

676 
	`Êac_buf„r_c›y
 (
psf
) ;

678 
pÊac
->
pos
 <ÖÊac->
Àn
)

679 { i‡(
	`FLAC__£ekabÀ_°ªam_decodî_¥o˚ss_sögÀ
 (
pÊac
->
fsd
) == 0)

681 i‡(
	`FLAC__£ekabÀ_°ªam_decodî_gë_°©e
 (
pÊac
->
fsd
Ë!
FLAC__SEEKABLE_STREAM_DECODER_OK
)

685 
pÊac
->
±r
 = 
NULL
 ;

687  
pÊac
->
pos
 ;

688 
	}
}

690 
sf_cou¡_t


691 
	$Êac_ªad_Êac2s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

692 { 
FLAC_PRIVATE
* 
pÊac
 = (FLAC_PRIVATE*Ë
psf
->
codec_d©a
 ;

693 
sf_cou¡_t
 
tŸÆ
 = 0, 
cuºít
 ;

694 
ªadÀn
 ;

696 
pÊac
->
pcmty≥
 = 
PFLAC_PCM_SHORT
 ;

698 
tŸÆ
 < 
Àn
)

699 { 
pÊac
->
±r
 =Öå + 
tŸÆ
 ;

700 
ªadÀn
 = (
Àn
 - 
tŸÆ
 > 0x1000000) ? 0x1000000 : () (len -Åotal) ;

701 
cuºít
 = 
	`Êac_ªad_lo›
 (
psf
, 
ªadÀn
) ;

702 i‡(
cuºít
 == 0)

704 
tŸÆ
 +
cuºít
 ;

707  
tŸÆ
 ;

708 
	}
}

710 
sf_cou¡_t


711 
	$Êac_ªad_Êac2i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

712 { 
FLAC_PRIVATE
* 
pÊac
 = (FLAC_PRIVATE*Ë
psf
->
codec_d©a
 ;

713 
sf_cou¡_t
 
tŸÆ
 = 0, 
cuºít
 ;

714 
ªadÀn
 ;

716 
pÊac
->
pcmty≥
 = 
PFLAC_PCM_INT
 ;

718 
tŸÆ
 < 
Àn
)

719 { 
pÊac
->
±r
 =Öå + 
tŸÆ
 ;

720 
ªadÀn
 = (
Àn
 - 
tŸÆ
 > 0x1000000) ? 0x1000000 : () (len -Åotal) ;

721 
cuºít
 = 
	`Êac_ªad_lo›
 (
psf
, 
ªadÀn
) ;

722 i‡(
cuºít
 == 0)

724 
tŸÆ
 +
cuºít
 ;

727  
tŸÆ
 ;

728 
	}
}

730 
sf_cou¡_t


731 
	$Êac_ªad_Êac2f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

732 { 
FLAC_PRIVATE
* 
pÊac
 = (FLAC_PRIVATE*Ë
psf
->
codec_d©a
 ;

733 
sf_cou¡_t
 
tŸÆ
 = 0, 
cuºít
 ;

734 
ªadÀn
 ;

736 
pÊac
->
pcmty≥
 = 
PFLAC_PCM_FLOAT
 ;

738 
tŸÆ
 < 
Àn
)

739 { 
pÊac
->
±r
 =Öå + 
tŸÆ
 ;

740 
ªadÀn
 = (
Àn
 - 
tŸÆ
 > 0x1000000) ? 0x1000000 : () (len -Åotal) ;

741 
cuºít
 = 
	`Êac_ªad_lo›
 (
psf
, 
ªadÀn
) ;

742 i‡(
cuºít
 == 0)

744 
tŸÆ
 +
cuºít
 ;

747  
tŸÆ
 ;

748 
	}
}

750 
sf_cou¡_t


751 
	$Êac_ªad_Êac2d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

752 { 
FLAC_PRIVATE
* 
pÊac
 = (FLAC_PRIVATE*Ë
psf
->
codec_d©a
 ;

753 
sf_cou¡_t
 
tŸÆ
 = 0, 
cuºít
 ;

754 
ªadÀn
 ;

756 
pÊac
->
pcmty≥
 = 
PFLAC_PCM_DOUBLE
 ;

758 
tŸÆ
 < 
Àn
)

759 { 
pÊac
->
±r
 =Öå + 
tŸÆ
 ;

760 
ªadÀn
 = (
Àn
 - 
tŸÆ
 > 0x1000000) ? 0x1000000 : () (len -Åotal) ;

761 
cuºít
 = 
	`Êac_ªad_lo›
 (
psf
, 
ªadÀn
) ;

762 i‡(
cuºít
 == 0)

764 
tŸÆ
 +
cuºít
 ;

767  
tŸÆ
 ;

768 
	}
}

770 
sf_cou¡_t


771 
	$Êac_wrôe_s2Êac
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

772 { 
FLAC_PRIVATE
* 
pÊac
 = (FLAC_PRIVATE*Ë
psf
->
codec_d©a
 ;

773 (*
c⁄vît
Ë(c⁄° *, 
FLAC__öt32
 *, ) ;

774 
buf„æí
, 
wrôecou¡
, 
thiswrôe
 ;

775 
sf_cou¡_t
 
tŸÆ
 = 0 ;

776 
FLAC__öt32
* 
buf„r
 = 
pÊac
->
ícbuf„r
 ;

778 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
)

779 { 
SF_FORMAT_PCM_S8
 :

780 
c⁄vît
 = 
s2Êac8_¨øy
 ;

782 
SF_FORMAT_PCM_16
 :

783 
c⁄vît
 = 
s2Êac16_¨øy
 ;

785 
SF_FORMAT_PCM_24
 :

786 
c⁄vît
 = 
s2Êac24_¨øy
 ;

792 
buf„æí
 = 
ENC_BUFFER_SIZE
 / ( (
FLAC__öt32
Ë* 
psf
->
sf
.
ch™√ls
) ;

793 
buf„æí
 *
psf
->
sf
.
ch™√ls
 ;

795 
Àn
 > 0)

796 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen : ()Üen ;

797 
	`c⁄vît
 (
±r
 + 
tŸÆ
, 
buf„r
, 
wrôecou¡
) ;

798 i‡(
	`FLAC__£ekabÀ_°ªam_ícodî_¥o˚ss_öãæóved
 (
pÊac
->
f£
, 
buf„r
, 
wrôecou¡
/
psf
->
sf
.
ch™√ls
))

799 
thiswrôe
 = 
wrôecou¡
 ;

802 
tŸÆ
 +
thiswrôe
 ;

803 i‡(
thiswrôe
 < 
wrôecou¡
)

806 
Àn
 -
thiswrôe
 ;

809  
tŸÆ
 ;

810 
	}
}

812 
sf_cou¡_t


813 
	$Êac_wrôe_i2Êac
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

814 { 
FLAC_PRIVATE
* 
pÊac
 = (FLAC_PRIVATE*Ë
psf
->
codec_d©a
 ;

815 (*
c⁄vît
Ë(c⁄° *, 
FLAC__öt32
 *, ) ;

816 
buf„æí
, 
wrôecou¡
, 
thiswrôe
 ;

817 
sf_cou¡_t
 
tŸÆ
 = 0 ;

818 
FLAC__öt32
* 
buf„r
 = 
pÊac
->
ícbuf„r
 ;

820 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
)

821 { 
SF_FORMAT_PCM_S8
 :

822 
c⁄vît
 = 
i2Êac8_¨øy
 ;

824 
SF_FORMAT_PCM_16
 :

825 
c⁄vît
 = 
i2Êac16_¨øy
 ;

827 
SF_FORMAT_PCM_24
 :

828 
c⁄vît
 = 
i2Êac24_¨øy
 ;

834 
buf„æí
 = 
ENC_BUFFER_SIZE
 / ( (
FLAC__öt32
Ë* 
psf
->
sf
.
ch™√ls
) ;

835 
buf„æí
 *
psf
->
sf
.
ch™√ls
 ;

837 
Àn
 > 0)

838 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen : ()Üen ;

839 
	`c⁄vît
 (
±r
 + 
tŸÆ
, 
buf„r
, 
wrôecou¡
) ;

840 i‡(
	`FLAC__£ekabÀ_°ªam_ícodî_¥o˚ss_öãæóved
 (
pÊac
->
f£
, 
buf„r
, 
wrôecou¡
/
psf
->
sf
.
ch™√ls
))

841 
thiswrôe
 = 
wrôecou¡
 ;

844 
tŸÆ
 +
thiswrôe
 ;

845 i‡(
thiswrôe
 < 
wrôecou¡
)

848 
Àn
 -
thiswrôe
 ;

851  
tŸÆ
 ;

852 
	}
}

854 
sf_cou¡_t


855 
	$Êac_wrôe_f2Êac
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

856 { 
FLAC_PRIVATE
* 
pÊac
 = (FLAC_PRIVATE*Ë
psf
->
codec_d©a
 ;

857 (*
c⁄vît
Ë(c⁄° *, 
FLAC__öt32
 *, , ) ;

858 
buf„æí
, 
wrôecou¡
, 
thiswrôe
 ;

859 
sf_cou¡_t
 
tŸÆ
 = 0 ;

860 
FLAC__öt32
* 
buf„r
 = 
pÊac
->
ícbuf„r
 ;

862 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
)

863 { 
SF_FORMAT_PCM_S8
 :

864 
c⁄vît
 = (
psf
->
add_˛ùpög
Ë? 
f2Êac8_˛ù_¨øy
 : 
f2Êac8_¨øy
 ;

866 
SF_FORMAT_PCM_16
 :

867 
c⁄vît
 = (
psf
->
add_˛ùpög
Ë? 
f2Êac16_˛ù_¨øy
 : 
f2Êac16_¨øy
 ;

869 
SF_FORMAT_PCM_24
 :

870 
c⁄vît
 = (
psf
->
add_˛ùpög
Ë? 
f2Êac24_˛ù_¨øy
 : 
f2Êac24_¨øy
 ;

876 
buf„æí
 = 
ENC_BUFFER_SIZE
 / ( (
FLAC__öt32
Ë* 
psf
->
sf
.
ch™√ls
) ;

877 
buf„æí
 *
psf
->
sf
.
ch™√ls
 ;

879 
Àn
 > 0)

880 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen : ()Üen ;

881 
	`c⁄vît
 (
±r
 + 
tŸÆ
, 
buf„r
, 
wrôecou¡
, 
psf
->
n‹m_Êﬂt
) ;

882 i‡(
	`FLAC__£ekabÀ_°ªam_ícodî_¥o˚ss_öãæóved
 (
pÊac
->
f£
, 
buf„r
, 
wrôecou¡
/
psf
->
sf
.
ch™√ls
))

883 
thiswrôe
 = 
wrôecou¡
 ;

886 
tŸÆ
 +
thiswrôe
 ;

887 i‡(
thiswrôe
 < 
wrôecou¡
)

890 
Àn
 -
thiswrôe
 ;

893  
tŸÆ
 ;

894 
	}
}

897 
	$f2Êac8_˛ù_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
)

898 { 
n‹mÁ˘
, 
sˇÀd_vÆue
 ;

900 
n‹mÁ˘
 = 
n‹mÆize
 ? (8.0 * 0x10) : 1.0 ;

902 --
cou¡
 >= 0)

903 { 
sˇÀd_vÆue
 = 
§c
 [
cou¡
] * 
n‹mÁ˘
 ;

904 i‡(
CPU_CLIPS_POSITIVE
 =0 && 
sˇÀd_vÆue
 >= (1.0 * 0x7F))

905 { 
de°
 [
cou¡
] = 0x7F ;

908 i‡(
CPU_CLIPS_NEGATIVE
 =0 && 
sˇÀd_vÆue
 <= (-8.0 * 0x10))

909 { 
de°
 [
cou¡
] = 0x80 ;

912 
de°
 [
cou¡
] = 
	`Ãötf
 (
sˇÀd_vÆue
) ;

916 
	}
}

919 
	$f2Êac16_˛ù_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
)

921 
n‹mÁ˘
, 
sˇÀd_vÆue
 ;

923 
n‹mÁ˘
 = 
n‹mÆize
 ? (8.0 * 0x1000) : 1.0 ;

925 --
cou¡
 >= 0) {

926 
sˇÀd_vÆue
 = 
§c
 [
cou¡
] * 
n‹mÁ˘
 ;

927 i‡(
CPU_CLIPS_POSITIVE
 =0 && 
sˇÀd_vÆue
 >= (1.0 * 0x7FFF)) {

928 
de°
 [
cou¡
] = 0x7FFF ;

931 i‡(
CPU_CLIPS_NEGATIVE
 =0 && 
sˇÀd_vÆue
 <= (-8.0 * 0x1000)) {

932 
de°
 [
cou¡
] = 0x8000 ;

935 
de°
 [
cou¡
] = 
	`Ãötf
 (
sˇÀd_vÆue
) ;

937 
	}
}

940 
	$f2Êac24_˛ù_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
)

941 { 
n‹mÁ˘
, 
sˇÀd_vÆue
 ;

943 
n‹mÁ˘
 = 
n‹mÆize
 ? (8.0 * 0x100000) : 1.0 ;

945 --
cou¡
 >= 0)

946 { 
sˇÀd_vÆue
 = 
§c
 [
cou¡
] * 
n‹mÁ˘
 ;

947 i‡(
CPU_CLIPS_POSITIVE
 =0 && 
sˇÀd_vÆue
 >= (1.0 * 0x7FFFFF))

948 { 
de°
 [
cou¡
] = 0x7FFFFF ;

952 i‡(
CPU_CLIPS_NEGATIVE
 =0 && 
sˇÀd_vÆue
 <= (-8.0 * 0x100000))

953 { 
de°
 [
cou¡
] = 0x800000 ;

956 
de°
 [
cou¡
] = 
	`Ãötf
 (
sˇÀd_vÆue
) ;

960 
	}
}

963 
	$f2Êac8_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
)

964 { 
n‹mÁ˘
 = 
n‹mÆize
 ? (1.0 * 0x7F) : 1.0 ;

966 --
cou¡
 >= 0)

967 
de°
 [
cou¡
] = 
	`Ãötf
 (
§c
 [cou¡] * 
n‹mÁ˘
) ;

968 
	}
}

971 
	$f2Êac16_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
)

972 { 
n‹mÁ˘
 = 
n‹mÆize
 ? (1.0 * 0x7FFF) : 1.0 ;

974 --
cou¡
 >= 0)

975 
de°
 [
cou¡
] = 
	`Ãötf
 (
§c
 [cou¡] * 
n‹mÁ˘
) ;

976 
	}
}

979 
	$f2Êac24_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
)

980 { 
n‹mÁ˘
 = 
n‹mÆize
 ? (1.0 * 0x7FFFFF) : 1.0 ;

982 --
cou¡
 >= 0)

983 
de°
 [
cou¡
] = 
	`Ãötf
 (
§c
 [cou¡] * 
n‹mÁ˘
) ;

984 
	}
}

986 
sf_cou¡_t


987 
	$Êac_wrôe_d2Êac
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

988 { 
FLAC_PRIVATE
* 
pÊac
 = (FLAC_PRIVATE*Ë
psf
->
codec_d©a
 ;

989 (*
c⁄vît
Ë(c⁄° *, 
FLAC__öt32
 *, , ) ;

990 
buf„æí
, 
wrôecou¡
, 
thiswrôe
 ;

991 
sf_cou¡_t
 
tŸÆ
 = 0 ;

992 
FLAC__öt32
* 
buf„r
 = 
pÊac
->
ícbuf„r
 ;

994 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
)

995 { 
SF_FORMAT_PCM_S8
 :

996 
c⁄vît
 = (
psf
->
add_˛ùpög
Ë? 
d2Êac8_˛ù_¨øy
 : 
d2Êac8_¨øy
 ;

998 
SF_FORMAT_PCM_16
 :

999 
c⁄vît
 = (
psf
->
add_˛ùpög
Ë? 
d2Êac16_˛ù_¨øy
 : 
d2Êac16_¨øy
 ;

1001 
SF_FORMAT_PCM_24
 :

1002 
c⁄vît
 = (
psf
->
add_˛ùpög
Ë? 
d2Êac24_˛ù_¨øy
 : 
d2Êac24_¨øy
 ;

1008 
buf„æí
 = 
ENC_BUFFER_SIZE
 / ( (
FLAC__öt32
Ë* 
psf
->
sf
.
ch™√ls
) ;

1009 
buf„æí
 *
psf
->
sf
.
ch™√ls
 ;

1011 
Àn
 > 0)

1012 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen : ()Üen ;

1013 
	`c⁄vît
 (
±r
 + 
tŸÆ
, 
buf„r
, 
wrôecou¡
, 
psf
->
n‹m_doubÀ
) ;

1014 i‡(
	`FLAC__£ekabÀ_°ªam_ícodî_¥o˚ss_öãæóved
 (
pÊac
->
f£
, 
buf„r
, 
wrôecou¡
/
psf
->
sf
.
ch™√ls
))

1015 
thiswrôe
 = 
wrôecou¡
 ;

1018 
tŸÆ
 +
thiswrôe
 ;

1019 i‡(
thiswrôe
 < 
wrôecou¡
)

1022 
Àn
 -
thiswrôe
 ;

1025  
tŸÆ
 ;

1026 
	}
}

1029 
	$d2Êac8_˛ù_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
)

1030 { 
n‹mÁ˘
, 
sˇÀd_vÆue
 ;

1032 
n‹mÁ˘
 = 
n‹mÆize
 ? (8.0 * 0x10) : 1.0 ;

1034 --
cou¡
 >= 0)

1035 { 
sˇÀd_vÆue
 = 
§c
 [
cou¡
] * 
n‹mÁ˘
 ;

1036 i‡(
CPU_CLIPS_POSITIVE
 =0 && 
sˇÀd_vÆue
 >= (1.0 * 0x7F))

1037 { 
de°
 [
cou¡
] = 0x7F ;

1040 i‡(
CPU_CLIPS_NEGATIVE
 =0 && 
sˇÀd_vÆue
 <= (-8.0 * 0x10))

1041 { 
de°
 [
cou¡
] = 0x80 ;

1044 
de°
 [
cou¡
] = 
	`Ãöt
 (
sˇÀd_vÆue
) ;

1048 
	}
}

1051 
	$d2Êac16_˛ù_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
)

1052 { 
n‹mÁ˘
, 
sˇÀd_vÆue
 ;

1054 
n‹mÁ˘
 = 
n‹mÆize
 ? (8.0 * 0x1000) : 1.0 ;

1056 --
cou¡
 >= 0)

1057 { 
sˇÀd_vÆue
 = 
§c
 [
cou¡
] * 
n‹mÁ˘
 ;

1058 i‡(
CPU_CLIPS_POSITIVE
 =0 && 
sˇÀd_vÆue
 >= (1.0 * 0x7FFF))

1059 { 
de°
 [
cou¡
] = 0x7FFF ;

1062 i‡(
CPU_CLIPS_NEGATIVE
 =0 && 
sˇÀd_vÆue
 <= (-8.0 * 0x1000))

1063 { 
de°
 [
cou¡
] = 0x8000 ;

1066 
de°
 [
cou¡
] = 
	`Ãöt
 (
sˇÀd_vÆue
) ;

1070 
	}
}

1073 
	$d2Êac24_˛ù_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
)

1074 { 
n‹mÁ˘
, 
sˇÀd_vÆue
 ;

1076 
n‹mÁ˘
 = 
n‹mÆize
 ? (8.0 * 0x100000) : 1.0 ;

1078 --
cou¡
 >= 0)

1079 { 
sˇÀd_vÆue
 = 
§c
 [
cou¡
] * 
n‹mÁ˘
 ;

1080 i‡(
CPU_CLIPS_POSITIVE
 =0 && 
sˇÀd_vÆue
 >= (1.0 * 0x7FFFFF))

1081 { 
de°
 [
cou¡
] = 0x7FFFFF ;

1084 i‡(
CPU_CLIPS_NEGATIVE
 =0 && 
sˇÀd_vÆue
 <= (-8.0 * 0x100000))

1085 { 
de°
 [
cou¡
] = 0x800000 ;

1088 
de°
 [
cou¡
] = 
	`Ãöt
 (
sˇÀd_vÆue
) ;

1092 
	}
}

1095 
	$d2Êac8_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
)

1096 { 
n‹mÁ˘
 = 
n‹mÆize
 ? (1.0 * 0x7F) : 1.0 ;

1098 --
cou¡
 >= 0)

1099 
de°
 [
cou¡
] = 
	`Ãöt
 (
§c
 [cou¡] * 
n‹mÁ˘
) ;

1100 
	}
}

1103 
	$d2Êac16_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
)

1104 { 
n‹mÁ˘
 = 
n‹mÆize
 ? (1.0 * 0x7FFF) : 1.0 ;

1106 --
cou¡
 >= 0)

1107 
de°
 [
cou¡
] = 
	`Ãöt
 (
§c
 [cou¡] * 
n‹mÁ˘
) ;

1108 
	}
}

1111 
	$d2Êac24_¨øy
 (c⁄° *
§c
, 
FLAC__öt32
 *
de°
, 
cou¡
, 
n‹mÆize
)

1112 { 
n‹mÁ˘
 = 
n‹mÆize
 ? (1.0 * 0x7FFFFF) : 1.0 ;

1114 --
cou¡
 >= 0)

1115 
de°
 [
cou¡
] = 
	`Ãöt
 (
§c
 [cou¡] * 
n‹mÁ˘
) ;

1116 
	}
}

1118 
sf_cou¡_t


1119 
Êac_£ek
 (
SF_PRIVATE
 *
psf
, 
UNUSED
 (
mode
), 
sf_cou¡_t
 
off£t
)

1120 { 
FLAC_PRIVATE
* 
	gpÊac
 = (FLAC_PRIVATE*Ë
psf
->
codec_d©a
 ;

1122 i‡(
	gpÊac
 =
NULL
)

1125 i‡(
	gpsf
->
	gd©aoff£t
 < 0)

1126 { 
	gpsf
->
	gîr‹
 = 
SFE_BAD_SEEK
 ;

1127  ((
	gsf_cou¡_t
) -1) ;

1130 
	gpÊac
->
	g‰ame
 = 
NULL
 ;

1132 i‡(
	gpsf
->
	gmode
 =
SFM_READ
)

1133 { 
FLAC__uöt64
 
posôi⁄
 ;

1134 i‡(
FLAC__£ekabÀ_°ªam_decodî_£ek_absﬁuã
 (
pÊac
->
fsd
, 
off£t
))

1135 { 
FLAC__£ekabÀ_°ªam_decodî_gë_decode_posôi⁄
 (
pÊac
->
fsd
, &
posôi⁄
) ;

1136  
	goff£t
 ;

1139  ((
	gsf_cou¡_t
) -1) ;

1143 
	gpsf
->
	gîr‹
 = 
SFE_BAD_SEEK
 ;

1145  ((
	gsf_cou¡_t
) -1) ;

	@libsndfile-1.0.17/src/float32.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

25 
	~"¢dfûe.h
"

26 
	~"s„ndün.h
"

27 
	~"comm⁄.h
"

28 
	~"Êﬂt_ˇ°.h
"

30 #i‡
CPU_IS_LITTLE_ENDIAN


31 
	#FLOAT32_READ
 
Êﬂt32_À_ªad


	)

32 
	#FLOAT32_WRITE
 
Êﬂt32_À_wrôe


	)

33 #ñi‡
CPU_IS_BIG_ENDIAN


34 
	#FLOAT32_READ
 
Êﬂt32_be_ªad


	)

35 
	#FLOAT32_WRITE
 
Êﬂt32_be_wrôe


	)

44 { 
	mFLOAT_UNKNOWN
 = 0x00,

45 
	mFLOAT_CAN_RW_LE
 = 0x12,

46 
	mFLOAT_CAN_RW_BE
 = 0x23,

47 
	mFLOAT_BROKEN_LE
 = 0x34,

48 
	mFLOAT_BROKEN_BE
 = 0x45

55 
sf_cou¡_t
 
ho°_ªad_f2s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

56 
sf_cou¡_t
 
ho°_ªad_f2i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

57 
sf_cou¡_t
 
ho°_ªad_f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

58 
sf_cou¡_t
 
ho°_ªad_f2d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

60 
sf_cou¡_t
 
ho°_wrôe_s2f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

61 
sf_cou¡_t
 
ho°_wrôe_i2f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

62 
sf_cou¡_t
 
ho°_wrôe_f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

63 
sf_cou¡_t
 
ho°_wrôe_d2f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

65 
Êﬂt32_≥ak_upd©e
 (
SF_PRIVATE
 *
psf
, c⁄° *
buf„r
, 
cou¡
, 
sf_cou¡_t
 
ödx
) ;

67 
sf_cou¡_t
 
ª∂a˚_ªad_f2s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

68 
sf_cou¡_t
 
ª∂a˚_ªad_f2i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

69 
sf_cou¡_t
 
ª∂a˚_ªad_f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

70 
sf_cou¡_t
 
ª∂a˚_ªad_f2d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

72 
sf_cou¡_t
 
ª∂a˚_wrôe_s2f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

73 
sf_cou¡_t
 
ª∂a˚_wrôe_i2f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

74 
sf_cou¡_t
 
ª∂a˚_wrôe_f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

75 
sf_cou¡_t
 
ª∂a˚_wrôe_d2f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

77 
bf2f_¨øy
 (*
buf„r
, 
cou¡
) ;

78 
f2bf_¨øy
 (*
buf„r
, 
cou¡
) ;

80 
Êﬂt32_gë_ˇ∑bûôy
 (
SF_PRIVATE
 *
psf
) ;

87 
	$Êﬂt32_öô
 (
SF_PRIVATE
 *
psf
)

88 { 
Êﬂt_ˇps
 ;

90 
Êﬂt_ˇps
 = 
	`Êﬂt32_gë_ˇ∑bûôy
 (
psf
) ;

92 
psf
->
blockwidth
 =  (Ë*Ösf->
sf
.
ch™√ls
 ;

94 i‡(
psf
->
mode
 =
SFM_READ
 ||Ösf->modê=
SFM_RDWR
)

95 { 
psf
->
ídün
 + 
Êﬂt_ˇps
)

96 { (
SF_ENDIAN_BIG
 + 
FLOAT_CAN_RW_BE
) :

97 
psf
->
Êﬂt_ídsw≠
 = 
SF_FALSE
 ;

98 
psf
->
ªad_sh‹t
 = 
ho°_ªad_f2s
 ;

99 
psf
->
ªad_öt
 = 
ho°_ªad_f2i
 ;

100 
psf
->
ªad_Êﬂt
 = 
ho°_ªad_f
 ;

101 
psf
->
ªad_doubÀ
 = 
ho°_ªad_f2d
 ;

104 (
SF_ENDIAN_LITTLE
 + 
FLOAT_CAN_RW_LE
) :

105 
psf
->
Êﬂt_ídsw≠
 = 
SF_FALSE
 ;

106 
psf
->
ªad_sh‹t
 = 
ho°_ªad_f2s
 ;

107 
psf
->
ªad_öt
 = 
ho°_ªad_f2i
 ;

108 
psf
->
ªad_Êﬂt
 = 
ho°_ªad_f
 ;

109 
psf
->
ªad_doubÀ
 = 
ho°_ªad_f2d
 ;

112 (
SF_ENDIAN_BIG
 + 
FLOAT_CAN_RW_LE
) :

113 
psf
->
Êﬂt_ídsw≠
 = 
SF_TRUE
 ;

114 
psf
->
ªad_sh‹t
 = 
ho°_ªad_f2s
 ;

115 
psf
->
ªad_öt
 = 
ho°_ªad_f2i
 ;

116 
psf
->
ªad_Êﬂt
 = 
ho°_ªad_f
 ;

117 
psf
->
ªad_doubÀ
 = 
ho°_ªad_f2d
 ;

120 (
SF_ENDIAN_LITTLE
 + 
FLOAT_CAN_RW_BE
) :

121 
psf
->
Êﬂt_ídsw≠
 = 
SF_TRUE
 ;

122 
psf
->
ªad_sh‹t
 = 
ho°_ªad_f2s
 ;

123 
psf
->
ªad_öt
 = 
ho°_ªad_f2i
 ;

124 
psf
->
ªad_Êﬂt
 = 
ho°_ªad_f
 ;

125 
psf
->
ªad_doubÀ
 = 
ho°_ªad_f2d
 ;

129 (
SF_ENDIAN_BIG
 + 
FLOAT_BROKEN_LE
) :

130 
psf
->
Êﬂt_ídsw≠
 = 
SF_TRUE
 ;

131 
psf
->
ªad_sh‹t
 = 
ª∂a˚_ªad_f2s
 ;

132 
psf
->
ªad_öt
 = 
ª∂a˚_ªad_f2i
 ;

133 
psf
->
ªad_Êﬂt
 = 
ª∂a˚_ªad_f
 ;

134 
psf
->
ªad_doubÀ
 = 
ª∂a˚_ªad_f2d
 ;

137 (
SF_ENDIAN_LITTLE
 + 
FLOAT_BROKEN_LE
) :

138 
psf
->
Êﬂt_ídsw≠
 = 
SF_FALSE
 ;

139 
psf
->
ªad_sh‹t
 = 
ª∂a˚_ªad_f2s
 ;

140 
psf
->
ªad_öt
 = 
ª∂a˚_ªad_f2i
 ;

141 
psf
->
ªad_Êﬂt
 = 
ª∂a˚_ªad_f
 ;

142 
psf
->
ªad_doubÀ
 = 
ª∂a˚_ªad_f2d
 ;

145 (
SF_ENDIAN_BIG
 + 
FLOAT_BROKEN_BE
) :

146 
psf
->
Êﬂt_ídsw≠
 = 
SF_FALSE
 ;

147 
psf
->
ªad_sh‹t
 = 
ª∂a˚_ªad_f2s
 ;

148 
psf
->
ªad_öt
 = 
ª∂a˚_ªad_f2i
 ;

149 
psf
->
ªad_Êﬂt
 = 
ª∂a˚_ªad_f
 ;

150 
psf
->
ªad_doubÀ
 = 
ª∂a˚_ªad_f2d
 ;

153 (
SF_ENDIAN_LITTLE
 + 
FLOAT_BROKEN_BE
) :

154 
psf
->
Êﬂt_ídsw≠
 = 
SF_TRUE
 ;

155 
psf
->
ªad_sh‹t
 = 
ª∂a˚_ªad_f2s
 ;

156 
psf
->
ªad_öt
 = 
ª∂a˚_ªad_f2i
 ;

157 
psf
->
ªad_Êﬂt
 = 
ª∂a˚_ªad_f
 ;

158 
psf
->
ªad_doubÀ
 = 
ª∂a˚_ªad_f2d
 ;

165 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

166 { 
psf
->
ídün
 + 
Êﬂt_ˇps
)

167 { (
SF_ENDIAN_LITTLE
 + 
FLOAT_CAN_RW_LE
) :

168 
psf
->
Êﬂt_ídsw≠
 = 
SF_FALSE
 ;

169 
psf
->
wrôe_sh‹t
 = 
ho°_wrôe_s2f
 ;

170 
psf
->
wrôe_öt
 = 
ho°_wrôe_i2f
 ;

171 
psf
->
wrôe_Êﬂt
 = 
ho°_wrôe_f
 ;

172 
psf
->
wrôe_doubÀ
 = 
ho°_wrôe_d2f
 ;

175 (
SF_ENDIAN_BIG
 + 
FLOAT_CAN_RW_BE
) :

176 
psf
->
Êﬂt_ídsw≠
 = 
SF_FALSE
 ;

177 
psf
->
wrôe_sh‹t
 = 
ho°_wrôe_s2f
 ;

178 
psf
->
wrôe_öt
 = 
ho°_wrôe_i2f
 ;

179 
psf
->
wrôe_Êﬂt
 = 
ho°_wrôe_f
 ;

180 
psf
->
wrôe_doubÀ
 = 
ho°_wrôe_d2f
 ;

183 (
SF_ENDIAN_BIG
 + 
FLOAT_CAN_RW_LE
) :

184 
psf
->
Êﬂt_ídsw≠
 = 
SF_TRUE
 ;

185 
psf
->
wrôe_sh‹t
 = 
ho°_wrôe_s2f
 ;

186 
psf
->
wrôe_öt
 = 
ho°_wrôe_i2f
 ;

187 
psf
->
wrôe_Êﬂt
 = 
ho°_wrôe_f
 ;

188 
psf
->
wrôe_doubÀ
 = 
ho°_wrôe_d2f
 ;

191 (
SF_ENDIAN_LITTLE
 + 
FLOAT_CAN_RW_BE
) :

192 
psf
->
Êﬂt_ídsw≠
 = 
SF_TRUE
 ;

193 
psf
->
wrôe_sh‹t
 = 
ho°_wrôe_s2f
 ;

194 
psf
->
wrôe_öt
 = 
ho°_wrôe_i2f
 ;

195 
psf
->
wrôe_Êﬂt
 = 
ho°_wrôe_f
 ;

196 
psf
->
wrôe_doubÀ
 = 
ho°_wrôe_d2f
 ;

200 (
SF_ENDIAN_BIG
 + 
FLOAT_BROKEN_LE
) :

201 
psf
->
Êﬂt_ídsw≠
 = 
SF_TRUE
 ;

202 
psf
->
wrôe_sh‹t
 = 
ª∂a˚_wrôe_s2f
 ;

203 
psf
->
wrôe_öt
 = 
ª∂a˚_wrôe_i2f
 ;

204 
psf
->
wrôe_Êﬂt
 = 
ª∂a˚_wrôe_f
 ;

205 
psf
->
wrôe_doubÀ
 = 
ª∂a˚_wrôe_d2f
 ;

208 (
SF_ENDIAN_LITTLE
 + 
FLOAT_BROKEN_LE
) :

209 
psf
->
Êﬂt_ídsw≠
 = 
SF_FALSE
 ;

210 
psf
->
wrôe_sh‹t
 = 
ª∂a˚_wrôe_s2f
 ;

211 
psf
->
wrôe_öt
 = 
ª∂a˚_wrôe_i2f
 ;

212 
psf
->
wrôe_Êﬂt
 = 
ª∂a˚_wrôe_f
 ;

213 
psf
->
wrôe_doubÀ
 = 
ª∂a˚_wrôe_d2f
 ;

216 (
SF_ENDIAN_BIG
 + 
FLOAT_BROKEN_BE
) :

217 
psf
->
Êﬂt_ídsw≠
 = 
SF_FALSE
 ;

218 
psf
->
wrôe_sh‹t
 = 
ª∂a˚_wrôe_s2f
 ;

219 
psf
->
wrôe_öt
 = 
ª∂a˚_wrôe_i2f
 ;

220 
psf
->
wrôe_Êﬂt
 = 
ª∂a˚_wrôe_f
 ;

221 
psf
->
wrôe_doubÀ
 = 
ª∂a˚_wrôe_d2f
 ;

224 (
SF_ENDIAN_LITTLE
 + 
FLOAT_BROKEN_BE
) :

225 
psf
->
Êﬂt_ídsw≠
 = 
SF_TRUE
 ;

226 
psf
->
wrôe_sh‹t
 = 
ª∂a˚_wrôe_s2f
 ;

227 
psf
->
wrôe_öt
 = 
ª∂a˚_wrôe_i2f
 ;

228 
psf
->
wrôe_Êﬂt
 = 
ª∂a˚_wrôe_f
 ;

229 
psf
->
wrôe_doubÀ
 = 
ª∂a˚_wrôe_d2f
 ;

236 i‡(
psf
->
fûñígth
 >Ösf->
d©aoff£t
)

237 { 
psf
->
d©Æígth
 = (psf->
d©´nd
 > 0Ë?Ösf->d©´nd -Ösf->
d©aoff£t
 :

238 
psf
->
fûñígth
 -Ösf->
d©aoff£t
 ;

241 
psf
->
d©Æígth
 = 0 ;

243 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 /Ösf->
blockwidth
 ;

246 
	}
}

249 
	$Êﬂt32_be_ªad
 (*
˝å
)

250 { 
exp⁄ít
, 
m™tisß
, 
√g©ive
 ;

251 
fvÆue
 ;

253 
√g©ive
 = 
˝å
 [0] & 0x80 ;

254 
exp⁄ít
 = ((
˝å
 [0] & 0x7F) << 1) | ((cptr [1] & 0x80) ? 1 : 0) ;

255 
m™tisß
 = ((
˝å
 [1] & 0x7F) << 16) | (cptr [2] << 8) | (cptr [3]) ;

257 i‡(! (
exp⁄ít
 || 
m™tisß
))

260 
m™tisß
 |= 0x800000 ;

261 
exp⁄ít
 =Éxponent ?Éxponent - 127 : 0 ;

263 
fvÆue
 = 
m™tisß
 ? (() mantissa) / (() 0x800000) : 0.0 ;

265 i‡(
√g©ive
)

266 
fvÆue
 *= -1 ;

268 i‡(
exp⁄ít
 > 0)

269 
fvÆue
 *(1 << 
exp⁄ít
) ;

270 i‡(
exp⁄ít
 < 0)

271 
fvÆue
 /(1 << 
	`abs
 (
exp⁄ít
)) ;

273  
fvÆue
 ;

274 
	}
}

277 
	$Êﬂt32_À_ªad
 (*
˝å
)

278 { 
exp⁄ít
, 
m™tisß
, 
√g©ive
 ;

279 
fvÆue
 ;

281 
√g©ive
 = 
˝å
 [3] & 0x80 ;

282 
exp⁄ít
 = ((
˝å
 [3] & 0x7F) << 1) | ((cptr [2] & 0x80) ? 1 : 0) ;

283 
m™tisß
 = ((
˝å
 [2] & 0x7F) << 16) | (cptr [1] << 8) | (cptr [0]) ;

285 i‡(! (
exp⁄ít
 || 
m™tisß
))

288 
m™tisß
 |= 0x800000 ;

289 
exp⁄ít
 =Éxponent ?Éxponent - 127 : 0 ;

291 
fvÆue
 = 
m™tisß
 ? (() mantissa) / (() 0x800000) : 0.0 ;

293 i‡(
√g©ive
)

294 
fvÆue
 *= -1 ;

296 i‡(
exp⁄ít
 > 0)

297 
fvÆue
 *(1 << 
exp⁄ít
) ;

298 i‡(
exp⁄ít
 < 0)

299 
fvÆue
 /(1 << 
	`abs
 (
exp⁄ít
)) ;

301  
fvÆue
 ;

302 
	}
}

305 
	$Êﬂt32_À_wrôe
 (
ö
, *
out
)

306 { 
exp⁄ít
, 
m™tisß
, 
√g©ive
 = 0 ;

308 
	`mem£t
 (
out
, 0,  ()) ;

310 i‡(
	`Ábs
 (
ö
) < 1e-30)

313 i‡(
ö
 < 0.0)

314 { 
ö
 *= -1.0 ;

315 
√g©ive
 = 1 ;

318 
ö
 = 
	`‰exp
 (ö, &
exp⁄ít
) ;

320 
exp⁄ít
 += 126 ;

322 
ö
 *= () 0x1000000 ;

323 
m™tisß
 = (((Ë
ö
) & 0x7FFFFF) ;

325 i‡(
√g©ive
)

326 
out
 [3] |= 0x80 ;

328 i‡(
exp⁄ít
 & 0x01)

329 
out
 [2] |= 0x80 ;

331 
out
 [0] = 
m™tisß
 & 0xFF ;

332 
out
 [1] = (
m™tisß
 >> 8) & 0xFF ;

333 
out
 [2] |(
m™tisß
 >> 16) & 0x7F ;

334 
out
 [3] |(
exp⁄ít
 >> 1) & 0x7F ;

337 
	}
}

340 
	$Êﬂt32_be_wrôe
 (
ö
, *
out
)

341 { 
exp⁄ít
, 
m™tisß
, 
√g©ive
 = 0 ;

343 
	`mem£t
 (
out
, 0,  ()) ;

345 i‡(
	`Ábs
 (
ö
) < 1e-30)

348 i‡(
ö
 < 0.0)

349 { 
ö
 *= -1.0 ;

350 
√g©ive
 = 1 ;

353 
ö
 = 
	`‰exp
 (ö, &
exp⁄ít
) ;

355 
exp⁄ít
 += 126 ;

357 
ö
 *= () 0x1000000 ;

358 
m™tisß
 = (((Ë
ö
) & 0x7FFFFF) ;

360 i‡(
√g©ive
)

361 
out
 [0] |= 0x80 ;

363 i‡(
exp⁄ít
 & 0x01)

364 
out
 [1] |= 0x80 ;

366 
out
 [3] = 
m™tisß
 & 0xFF ;

367 
out
 [2] = (
m™tisß
 >> 8) & 0xFF ;

368 
out
 [1] |(
m™tisß
 >> 16) & 0x7F ;

369 
out
 [0] |(
exp⁄ít
 >> 1) & 0x7F ;

372 
	}
}

379 
	$Êﬂt32_≥ak_upd©e
 (
SF_PRIVATE
 *
psf
, c⁄° *
buf„r
, 
cou¡
, 
sf_cou¡_t
 
ödx
)

380 { 
ch™
 ;

381 
k
, 
posôi⁄
 ;

382 
fmaxvÆ
 ;

384 
ch™
 = 0 ; ch™ < 
psf
->
sf
.
ch™√ls
 ; chan++)

385 { 
fmaxvÆ
 = 
	`Ábs
 (
buf„r
 [
ch™
]) ;

386 
posôi⁄
 = 0 ;

387 
k
 = 
ch™
 ; k < 
cou¡
 ; k +
psf
->
sf
.
ch™√ls
)

388 i‡(
fmaxvÆ
 < 
	`Ábs
 (
buf„r
 [
k
]))

389 { 
fmaxvÆ
 = 
	`Ábs
 (
buf„r
 [
k
]) ;

390 
posôi⁄
 = 
k
 ;

393 i‡(
fmaxvÆ
 > 
psf
->
≥ak_öfo
->
≥aks
 [
ch™
].
vÆue
)

394 { 
psf
->
≥ak_öfo
->
≥aks
 [
ch™
].
vÆue
 = 
fmaxvÆ
 ;

395 
psf
->
≥ak_öfo
->
≥aks
 [
ch™
].
posôi⁄
 =Ösf->
wrôe_cuºít
 + 
ödx
 + (posôi⁄ /Ösf->
sf
.
ch™√ls
) ;

400 
	}
}

403 
	$Êﬂt32_gë_ˇ∑bûôy
 (
SF_PRIVATE
 *
psf
)

405 { 
f
 ;

406 
i
 ;

407 
c
 [4] ;

408 } 
d©a
 ;

410 
d©a
.
f
 = () 1.23456789 ;

412 i‡(! 
psf
->
õì_ª∂a˚
)

414 i‡(
d©a
.
c
 [0] == 0x52 && data.c [1] == 0x06 && data.c [2] == 0x9e && data.c [3] == 0x3f)

415  
FLOAT_CAN_RW_LE
 ;

418 i‡(
d©a
.
c
 [3] == 0x52 && data.c [2] == 0x06 && data.c [1] == 0x9e && data.c [0] == 0x3f)

419  
FLOAT_CAN_RW_BE
 ;

423 
	`psf_log_¥ötf
 (
psf
, "Using IEEEÑeplacement code for float.\n") ;

425  (
CPU_IS_LITTLE_ENDIAN
Ë? 
FLOAT_BROKEN_LE
 : 
FLOAT_BROKEN_BE
 ;

426 
	}
}

431 
ölöe
 

432 
	$f2s_¨øy
 (c⁄° *
§c
, 
cou¡
, *
de°
, 
sˇÀ
)

433 { --
cou¡
 >= 0)

434 { 
de°
 [
cou¡
] = 
	`Ãötf
 (
sˇÀ
 * 
§c
 [count]) ;

436 
	}
}

438 
ölöe
 

439 
	$f2i_¨øy
 (c⁄° *
§c
, 
cou¡
, *
de°
, 
sˇÀ
)

440 { --
cou¡
 >= 0)

441 { 
de°
 [
cou¡
] = 
	`Ãötf
 (
sˇÀ
 * 
§c
 [count]) ;

443 
	}
}

445 
ölöe
 

446 
	$f2d_¨øy
 (c⁄° *
§c
, 
cou¡
, *
de°
)

447 { --
cou¡
 >= 0)

448 { 
de°
 [
cou¡
] = 
§c
 [count] ;

450 
	}
}

452 
ölöe
 

453 
	$s2f_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
)

454 { --
cou¡
 >= 0)

455 { 
de°
 [
cou¡
] = 
§c
 [count] ;

458 
	}
}

460 
ölöe
 

461 
	$i2f_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
)

462 { --
cou¡
 >= 0)

463 { 
de°
 [
cou¡
] = 
§c
 [count] ;

465 
	}
}

467 
ölöe
 

468 
	$d2f_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
)

469 { --
cou¡
 >= 0)

470 { 
de°
 [
cou¡
] = 
§c
 [count] ;

472 
	}
}

477 
sf_cou¡_t


478 
	$ho°_ªad_f2s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

479 { 
buf„æí
, 
ªadcou¡
 ;

480 
sf_cou¡_t
 
tŸÆ
 = 0 ;

481 
sˇÀ
 ;

483 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
fbuf
) ;

484 
sˇÀ
 = (
psf
->
Êﬂt_öt_mu…
 =0Ë? 1.0 : 0x7FFF /Ösf->
Êﬂt_max
 ;

486 
Àn
 > 0)

487 { i‡(
Àn
 < 
buf„æí
)

488 
buf„æí
 = (Ë
Àn
 ;

489 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
fbuf
,  (), 
buf„æí
,Ösf) ;

492 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

493 
	`ídsw≠_öt_¨øy
 (
psf
->
u
.
ibuf
, 
buf„æí
) ;

495 
	`f2s_¨øy
 (
psf
->
u
.
fbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
sˇÀ
) ;

496 
tŸÆ
 +
ªadcou¡
 ;

497 i‡(
ªadcou¡
 < 
buf„æí
)

499 
Àn
 -
ªadcou¡
 ;

502  
tŸÆ
 ;

503 
	}
}

505 
sf_cou¡_t


506 
	$ho°_ªad_f2i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

507 { 
buf„æí
, 
ªadcou¡
 ;

508 
sf_cou¡_t
 
tŸÆ
 = 0 ;

509 
sˇÀ
 ;

511 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
fbuf
) ;

512 
sˇÀ
 = (
psf
->
Êﬂt_öt_mu…
 =0Ë? 1.0 : 0x7FFFFFFF /Ösf->
Êﬂt_max
 ;

514 
Àn
 > 0)

515 { i‡(
Àn
 < 
buf„æí
)

516 
buf„æí
 = (Ë
Àn
 ;

517 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
fbuf
,  (), 
buf„æí
,Ösf) ;

519 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

520 
	`ídsw≠_öt_¨øy
 (
psf
->
u
.
ibuf
, 
buf„æí
) ;

522 
	`f2i_¨øy
 (
psf
->
u
.
fbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
sˇÀ
) ;

523 
tŸÆ
 +
ªadcou¡
 ;

524 i‡(
ªadcou¡
 < 
buf„æí
)

526 
Àn
 -
ªadcou¡
 ;

529  
tŸÆ
 ;

530 
	}
}

532 
sf_cou¡_t


533 
	$ho°_ªad_f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

534 { 
buf„æí
, 
ªadcou¡
 ;

535 
sf_cou¡_t
 
tŸÆ
 = 0 ;

537 i‡(
psf
->
Êﬂt_ídsw≠
 !
SF_TRUE
)

538  
	`psf_‰ód
 (
±r
,  (), 
Àn
, 
psf
) ;

540 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
fbuf
) ;

542 
Àn
 > 0)

543 { i‡(
Àn
 < 
buf„æí
)

544 
buf„æí
 = (Ë
Àn
 ;

545 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
fbuf
,  (), 
buf„æí
,Ösf) ;

547 
	`ídsw≠_öt_c›y
 ((*Ë(
±r
 + 
tŸÆ
), 
psf
->
u
.
ibuf
, 
ªadcou¡
) ;

549 
tŸÆ
 +
ªadcou¡
 ;

550 i‡(
ªadcou¡
 < 
buf„æí
)

552 
Àn
 -
ªadcou¡
 ;

555  
tŸÆ
 ;

556 
	}
}

558 
sf_cou¡_t


559 
	$ho°_ªad_f2d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

560 { 
buf„æí
, 
ªadcou¡
 ;

561 
sf_cou¡_t
 
tŸÆ
 = 0 ;

563 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
fbuf
) ;

565 
Àn
 > 0)

566 { i‡(
Àn
 < 
buf„æí
)

567 
buf„æí
 = (Ë
Àn
 ;

568 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
fbuf
,  (), 
buf„æí
,Ösf) ;

570 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

571 
	`ídsw≠_öt_¨øy
 (
psf
->
u
.
ibuf
, 
buf„æí
) ;

574 
	`f2d_¨øy
 (
psf
->
u
.
fbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

575 
tŸÆ
 +
ªadcou¡
 ;

576 i‡(
ªadcou¡
 < 
buf„æí
)

578 
Àn
 -
ªadcou¡
 ;

581  
tŸÆ
 ;

582 
	}
}

584 
sf_cou¡_t


585 
	$ho°_wrôe_s2f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

586 { 
buf„æí
, 
wrôecou¡
 ;

587 
sf_cou¡_t
 
tŸÆ
 = 0 ;

589 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
fbuf
) ;

591 
Àn
 > 0)

592 { i‡(
Àn
 < 
buf„æí
)

593 
buf„æí
 = (Ë
Àn
 ;

594 
	`s2f_¨øy
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
fbuf
, 
buf„æí
) ;

596 i‡(
psf
->
≥ak_öfo
)

597 
	`Êﬂt32_≥ak_upd©e
 (
psf
,Ösf->
u
.
fbuf
, 
buf„æí
, 
tŸÆ
 /Ösf->
sf
.
ch™√ls
) ;

599 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

600 
	`ídsw≠_öt_¨øy
 (
psf
->
u
.
ibuf
, 
buf„æí
) ;

602 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
fbuf
,  (), 
buf„æí
,Ösf) ;

603 
tŸÆ
 +
wrôecou¡
 ;

604 i‡(
wrôecou¡
 < 
buf„æí
)

606 
Àn
 -
wrôecou¡
 ;

609  
tŸÆ
 ;

610 
	}
}

612 
sf_cou¡_t


613 
	$ho°_wrôe_i2f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

614 { 
buf„æí
, 
wrôecou¡
 ;

615 
sf_cou¡_t
 
tŸÆ
 = 0 ;

617 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
fbuf
) ;

619 
Àn
 > 0)

620 { i‡(
Àn
 < 
buf„æí
)

621 
buf„æí
 = (Ë
Àn
 ;

622 
	`i2f_¨øy
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
fbuf
, 
buf„æí
) ;

624 i‡(
psf
->
≥ak_öfo
)

625 
	`Êﬂt32_≥ak_upd©e
 (
psf
,Ösf->
u
.
fbuf
, 
buf„æí
, 
tŸÆ
 /Ösf->
sf
.
ch™√ls
) ;

627 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

628 
	`ídsw≠_öt_¨øy
 (
psf
->
u
.
ibuf
, 
buf„æí
) ;

630 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
fbuf
,  (Ë, 
buf„æí
,Ösf) ;

631 
tŸÆ
 +
wrôecou¡
 ;

632 i‡(
wrôecou¡
 < 
buf„æí
)

634 
Àn
 -
wrôecou¡
 ;

637  
tŸÆ
 ;

638 
	}
}

640 
sf_cou¡_t


641 
	$ho°_wrôe_f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

642 { 
buf„æí
, 
wrôecou¡
 ;

643 
sf_cou¡_t
 
tŸÆ
 = 0 ;

645 i‡(
psf
->
≥ak_öfo
)

646 
	`Êﬂt32_≥ak_upd©e
 (
psf
, 
±r
, 
Àn
, 0) ;

648 i‡(
psf
->
Êﬂt_ídsw≠
 !
SF_TRUE
)

649  
	`psf_fwrôe
 (
±r
,  (), 
Àn
, 
psf
) ;

651 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
fbuf
) ;

653 
Àn
 > 0)

654 { i‡(
Àn
 < 
buf„æí
)

655 
buf„æí
 = (Ë
Àn
 ;

657 
	`ídsw≠_öt_c›y
 (
psf
->
u
.
ibuf
, (c⁄° *Ë(
±r
 + 
tŸÆ
), 
buf„æí
) ;

659 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
fbuf
,  (), 
buf„æí
,Ösf) ;

660 
tŸÆ
 +
wrôecou¡
 ;

661 i‡(
wrôecou¡
 < 
buf„æí
)

663 
Àn
 -
wrôecou¡
 ;

666  
tŸÆ
 ;

667 
	}
}

669 
sf_cou¡_t


670 
	$ho°_wrôe_d2f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

671 { 
buf„æí
, 
wrôecou¡
 ;

672 
sf_cou¡_t
 
tŸÆ
 = 0 ;

674 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
fbuf
) ;

676 
Àn
 > 0)

677 { i‡(
Àn
 < 
buf„æí
)

678 
buf„æí
 = (Ë
Àn
 ;

680 
	`d2f_¨øy
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
fbuf
, 
buf„æí
) ;

682 i‡(
psf
->
≥ak_öfo
)

683 
	`Êﬂt32_≥ak_upd©e
 (
psf
,Ösf->
u
.
fbuf
, 
buf„æí
, 
tŸÆ
 /Ösf->
sf
.
ch™√ls
) ;

685 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

686 
	`ídsw≠_öt_¨øy
 (
psf
->
u
.
ibuf
, 
buf„æí
) ;

688 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
fbuf
,  (), 
buf„æí
,Ösf) ;

689 
tŸÆ
 +
wrôecou¡
 ;

690 i‡(
wrôecou¡
 < 
buf„æí
)

692 
Àn
 -
wrôecou¡
 ;

695  
tŸÆ
 ;

696 
	}
}

701 
sf_cou¡_t


702 
	$ª∂a˚_ªad_f2s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

703 { 
buf„æí
, 
ªadcou¡
 ;

704 
sf_cou¡_t
 
tŸÆ
 = 0 ;

705 
sˇÀ
 ;

707 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
fbuf
) ;

708 
sˇÀ
 = (
psf
->
Êﬂt_öt_mu…
 =0Ë? 1.0 : 0x7FFF /Ösf->
Êﬂt_max
 ;

710 
Àn
 > 0)

711 { i‡(
Àn
 < 
buf„æí
)

712 
buf„æí
 = (Ë
Àn
 ;

713 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
fbuf
,  (), 
buf„æí
,Ösf) ;

715 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

716 
	`ídsw≠_öt_¨øy
 (
psf
->
u
.
ibuf
, 
buf„æí
) ;

718 
	`bf2f_¨øy
 (
psf
->
u
.
fbuf
, 
buf„æí
) ;

720 
	`f2s_¨øy
 (
psf
->
u
.
fbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
sˇÀ
) ;

721 
tŸÆ
 +
ªadcou¡
 ;

722 i‡(
ªadcou¡
 < 
buf„æí
)

724 
Àn
 -
ªadcou¡
 ;

727  
tŸÆ
 ;

728 
	}
}

730 
sf_cou¡_t


731 
	$ª∂a˚_ªad_f2i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

732 { 
buf„æí
, 
ªadcou¡
 ;

733 
sf_cou¡_t
 
tŸÆ
 = 0 ;

734 
sˇÀ
 ;

736 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
fbuf
) ;

737 
sˇÀ
 = (
psf
->
Êﬂt_öt_mu…
 =0Ë? 1.0 : 0x7FFF /Ösf->
Êﬂt_max
 ;

739 
Àn
 > 0)

740 { i‡(
Àn
 < 
buf„æí
)

741 
buf„æí
 = (Ë
Àn
 ;

742 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
fbuf
,  (), 
buf„æí
,Ösf) ;

744 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

745 
	`ídsw≠_öt_¨øy
 (
psf
->
u
.
ibuf
, 
buf„æí
) ;

747 
	`bf2f_¨øy
 (
psf
->
u
.
fbuf
, 
buf„æí
) ;

749 
	`f2i_¨øy
 (
psf
->
u
.
fbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
sˇÀ
) ;

750 
tŸÆ
 +
ªadcou¡
 ;

751 i‡(
ªadcou¡
 < 
buf„æí
)

753 
Àn
 -
ªadcou¡
 ;

756  
tŸÆ
 ;

757 
	}
}

759 
sf_cou¡_t


760 
	$ª∂a˚_ªad_f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

761 { 
buf„æí
, 
ªadcou¡
 ;

762 
sf_cou¡_t
 
tŸÆ
 = 0 ;

766 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
fbuf
) ;

768 
Àn
 > 0)

769 { i‡(
Àn
 < 
buf„æí
)

770 
buf„æí
 = (Ë
Àn
 ;

771 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
fbuf
,  (), 
buf„æí
,Ösf) ;

773 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

774 
	`ídsw≠_öt_¨øy
 (
psf
->
u
.
ibuf
, 
buf„æí
) ;

776 
	`bf2f_¨øy
 (
psf
->
u
.
fbuf
, 
buf„æí
) ;

778 
	`mem˝y
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
fbuf
, 
buf„æí
 *  ()) ;

780 
tŸÆ
 +
ªadcou¡
 ;

781 i‡(
ªadcou¡
 < 
buf„æí
)

783 
Àn
 -
ªadcou¡
 ;

786  
tŸÆ
 ;

787 
	}
}

789 
sf_cou¡_t


790 
	$ª∂a˚_ªad_f2d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

791 { 
buf„æí
, 
ªadcou¡
 ;

792 
sf_cou¡_t
 
tŸÆ
 = 0 ;

794 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
fbuf
) ;

796 
Àn
 > 0)

797 { i‡(
Àn
 < 
buf„æí
)

798 
buf„æí
 = (Ë
Àn
 ;

799 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
fbuf
,  (), 
buf„æí
,Ösf) ;

801 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

802 
	`ídsw≠_öt_¨øy
 (
psf
->
u
.
ibuf
, 
buf„æí
) ;

804 
	`bf2f_¨øy
 (
psf
->
u
.
fbuf
, 
buf„æí
) ;

806 
	`f2d_¨øy
 (
psf
->
u
.
fbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

807 
tŸÆ
 +
ªadcou¡
 ;

808 i‡(
ªadcou¡
 < 
buf„æí
)

810 
Àn
 -
ªadcou¡
 ;

813  
tŸÆ
 ;

814 
	}
}

816 
sf_cou¡_t


817 
	$ª∂a˚_wrôe_s2f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

818 { 
buf„æí
, 
wrôecou¡
 ;

819 
sf_cou¡_t
 
tŸÆ
 = 0 ;

821 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
fbuf
) ;

823 
Àn
 > 0)

824 { i‡(
Àn
 < 
buf„æí
)

825 
buf„æí
 = (Ë
Àn
 ;

826 
	`s2f_¨øy
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
fbuf
, 
buf„æí
) ;

828 i‡(
psf
->
≥ak_öfo
)

829 
	`Êﬂt32_≥ak_upd©e
 (
psf
,Ösf->
u
.
fbuf
, 
buf„æí
, 
tŸÆ
 /Ösf->
sf
.
ch™√ls
) ;

831 
	`f2bf_¨øy
 (
psf
->
u
.
fbuf
, 
buf„æí
) ;

833 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

834 
	`ídsw≠_öt_¨øy
 (
psf
->
u
.
ibuf
, 
buf„æí
) ;

836 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
fbuf
,  (), 
buf„æí
,Ösf) ;

837 
tŸÆ
 +
wrôecou¡
 ;

838 i‡(
wrôecou¡
 < 
buf„æí
)

840 
Àn
 -
wrôecou¡
 ;

843  
tŸÆ
 ;

844 
	}
}

846 
sf_cou¡_t


847 
	$ª∂a˚_wrôe_i2f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

848 { 
buf„æí
, 
wrôecou¡
 ;

849 
sf_cou¡_t
 
tŸÆ
 = 0 ;

851 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
fbuf
) ;

853 
Àn
 > 0)

854 { i‡(
Àn
 < 
buf„æí
)

855 
buf„æí
 = (Ë
Àn
 ;

856 
	`i2f_¨øy
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
fbuf
, 
buf„æí
) ;

858 i‡(
psf
->
≥ak_öfo
)

859 
	`Êﬂt32_≥ak_upd©e
 (
psf
,Ösf->
u
.
fbuf
, 
buf„æí
, 
tŸÆ
 /Ösf->
sf
.
ch™√ls
) ;

861 
	`f2bf_¨øy
 (
psf
->
u
.
fbuf
, 
buf„æí
) ;

863 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

864 
	`ídsw≠_öt_¨øy
 (
psf
->
u
.
ibuf
, 
buf„æí
) ;

866 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
fbuf
,  (), 
buf„æí
,Ösf) ;

867 
tŸÆ
 +
wrôecou¡
 ;

868 i‡(
wrôecou¡
 < 
buf„æí
)

870 
Àn
 -
wrôecou¡
 ;

873  
tŸÆ
 ;

874 
	}
}

876 
sf_cou¡_t


877 
	$ª∂a˚_wrôe_f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

878 { 
buf„æí
, 
wrôecou¡
 ;

879 
sf_cou¡_t
 
tŸÆ
 = 0 ;

882 i‡(
psf
->
≥ak_öfo
)

883 
	`Êﬂt32_≥ak_upd©e
 (
psf
, 
±r
, 
Àn
, 0) ;

885 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
fbuf
) ;

887 
Àn
 > 0)

888 { i‡(
Àn
 < 
buf„æí
)

889 
buf„æí
 = (Ë
Àn
 ;

891 
	`mem˝y
 (
psf
->
u
.
fbuf
, 
±r
 + 
tŸÆ
, 
buf„æí
 *  ()) ;

893 
	`f2bf_¨øy
 (
psf
->
u
.
fbuf
, 
buf„æí
) ;

895 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

896 
	`ídsw≠_öt_¨øy
 (
psf
->
u
.
ibuf
, 
buf„æí
) ;

898 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
fbuf
,  (Ë, 
buf„æí
,Ösf) ;

899 
tŸÆ
 +
wrôecou¡
 ;

900 i‡(
wrôecou¡
 < 
buf„æí
)

902 
Àn
 -
wrôecou¡
 ;

905  
tŸÆ
 ;

906 
	}
}

908 
sf_cou¡_t


909 
	$ª∂a˚_wrôe_d2f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

910 { 
buf„æí
, 
wrôecou¡
 ;

911 
sf_cou¡_t
 
tŸÆ
 = 0 ;

913 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
fbuf
) ;

915 
Àn
 > 0)

916 { i‡(
Àn
 < 
buf„æí
)

917 
buf„æí
 = (Ë
Àn
 ;

918 
	`d2f_¨øy
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
fbuf
, 
buf„æí
) ;

920 i‡(
psf
->
≥ak_öfo
)

921 
	`Êﬂt32_≥ak_upd©e
 (
psf
,Ösf->
u
.
fbuf
, 
buf„æí
, 
tŸÆ
 /Ösf->
sf
.
ch™√ls
) ;

923 
	`f2bf_¨øy
 (
psf
->
u
.
fbuf
, 
buf„æí
) ;

925 i‡(
psf
->
Êﬂt_ídsw≠
 =
SF_TRUE
)

926 
	`ídsw≠_öt_¨øy
 (
psf
->
u
.
ibuf
, 
buf„æí
) ;

928 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
fbuf
,  (), 
buf„æí
,Ösf) ;

929 
tŸÆ
 +
wrôecou¡
 ;

930 i‡(
wrôecou¡
 < 
buf„æí
)

932 
Àn
 -
wrôecou¡
 ;

935  
tŸÆ
 ;

936 
	}
}

942 
	$bf2f_¨øy
 (*
buf„r
, 
cou¡
)

943 { --
cou¡
 >= 0)

944 { 
buf„r
 [
cou¡
] = 
	`FLOAT32_READ
 ((*) (buffer + count)) ;

946 
	}
}

949 
	$f2bf_¨øy
 (*
buf„r
, 
cou¡
)

950 { --
cou¡
 >= 0)

951 { 
	`FLOAT32_WRITE
 (
buf„r
 [
cou¡
], (*) (buffer + count)) ;

953 
	}
}

	@libsndfile-1.0.17/src/float_cast.h

21 #i‚de‡
FLOAT_CAST_HEADER


22 
	#FLOAT_CAST_HEADER


	)

48 
	~"sfc⁄fig.h
"

56 
	#HAVE_LRINT_REPLACEMENT
 0

	)

58 #i‡(
HAVE_LRINT
 && 
HAVE_LRINTF
)

68 
	#_ISOC9X_SOURCE
 1

	)

69 
	#_ISOC99_SOURCE
 1

	)

71 
	#__USE_ISOC9X
 1

	)

72 
	#__USE_ISOC99
 1

	)

74 
	~<m©h.h
>

76 #ñi‡(
deföed
 (
__CYGWIN__
))

78 
	~<m©h.h
>

80 #unde‡
HAVE_LRINT_REPLACEMENT


81 
	#HAVE_LRINT_REPLACEMENT
 1

	)

83 #unde‡
Ãöt


84 #unde‡
Ãötf


86 
	#Ãöt
 
doubÀ2öt


	)

87 
	#Ãötf
 
Êﬂt2öt


	)

98 
ölöe
 
	$doubÀ2öt
 (
ö
)

99 { 
ªtvÆ
 ;

101 
__asm__
 
__vﬁ©ûe__


103 : "=m" (
ªtvÆ
)

104 : "t" (
ö
)

108  
ªtvÆ
 ;

109 
	}
}

111 
ölöe
 
	$Êﬂt2öt
 (
ö
)

112 { 
ªtvÆ
 ;

114 
__asm__
 
__vﬁ©ûe__


116 : "=m" (
ªtvÆ
)

117 : "t" (
ö
)

121  
ªtvÆ
 ;

122 
	}
}

124 #ñi‡(
deföed
 (
WIN32
Ë|| deföed (
_WIN32
))

126 #unde‡
HAVE_LRINT_REPLACEMENT


127 
	#HAVE_LRINT_REPLACEMENT
 1

	)

129 
	~<m©h.h
>

136 
__ölöe
 

137 
	$Ãöt
 (
Êt
)

138 { 
ötgr
 ;

140 
_asm


141 { 
Êd
 
Êt


142 
fi°p
 
ötgr


145  
ötgr
 ;

146 
	}
}

148 
__ölöe
 

149 
	$Ãötf
 (
Êt
)

150 { 
ötgr
 ;

152 
_asm


153 { 
Êd
 
Êt


154 
fi°p
 
ötgr


157  
ötgr
 ;

158 
	}
}

160 #ñi‡(
deföed
 (
__MWERKS__
Ë&& deföed (
macötosh
))

164 #unde‡
HAVE_LRINT_REPLACEMENT


165 
	#HAVE_LRINT_REPLACEMENT
 1

	)

166 
	~<m©h.h
>

168 #unde‡
Ãöt


169 #unde‡
Ãötf


171 
	#Ãöt
 
doubÀ2öt


	)

172 
	#Ãötf
 
Êﬂt2öt


	)

174 
ölöe
 

175 
	$Êﬂt2öt
 (
ö
)

176 { 
ªs
 [2] ;

178 
asm


179 { 
f˘iw
 
ö
, in

180 
°fd
 
ö
, 
ªs


182  
ªs
 [1] ;

183 
	}
}

185 
ölöe
 

186 
	$doubÀ2öt
 (
ö
)

187 { 
ªs
 [2] ;

189 
asm


190 { 
f˘iw
 
ö
, in

191 
°fd
 
ö
, 
ªs


193  
ªs
 [1] ;

194 
	}
}

196 #ñi‡(
deföed
 (
__MACH__
Ë&& deföed (
__APPLE__
))

200 #unde‡
HAVE_LRINT_REPLACEMENT


201 
	#HAVE_LRINT_REPLACEMENT
 1

	)

202 
	~<m©h.h
>

204 #unde‡
Ãöt


205 #unde‡
Ãötf


207 
	#Ãöt
 
doubÀ2öt


	)

208 
	#Ãötf
 
Êﬂt2öt


	)

210 
ölöe
 

211 
	$Êﬂt2öt
 (
ö
)

212 { 
ªs
 [2] ;

214 
__asm__
 
__vﬁ©ûe__


217 : "=m" (
ªs
)

218 : "f" (
ö
)

222  
ªs
 [1] ;

223 
	}
}

225 
ölöe
 

226 
	$doubÀ2öt
 (
ö
)

227 { 
ªs
 [2] ;

229 
__asm__
 
__vﬁ©ûe__


232 : "=m" (
ªs
)

233 : "f" (
ö
)

237  
ªs
 [1] ;

238 
	}
}

241 #i‚de‡
__sgi


246 
	~<m©h.h
>

248 
	#Ãöt
(
dbl
Ë((Ë(dbl))

	)

249 
	#Ãötf
(
Êt
Ë((Ë(Êt))

	)

	@libsndfile-1.0.17/src/g72x.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

25 
	~"¢dfûe.h
"

26 
	~"s„ndün.h
"

27 
	~"Êﬂt_ˇ°.h
"

28 
	~"comm⁄.h
"

29 
	~"G72x/g72x.h
"

32 
	gg72x_°©e
 ;

33 
g72x_°©e
 
	tG72x_STATE
 ;

37 
g72x_°©e
 * 
	m¥iv©e
 ;

40 
	mblocksize
, 
	mßm∂e•îblock
, 
	mbyã•îblock
 ;

43 
	mblocks_tŸÆ
, 
	mblock_cuº
, 
	mßm∂e_cuº
 ;

44 
	mblock
 [
G72x_BLOCK_SIZE
] ;

45 
	mßm∂es
 [
G72x_BLOCK_SIZE
] ;

46 } 
	tG72x_PRIVATE
 ;

48 
psf_g72x_decode_block
 (
SF_PRIVATE
 *
psf
, 
G72x_PRIVATE
 *
pg72x
) ;

49 
psf_g72x_ícode_block
 (
SF_PRIVATE
 *
psf
, 
G72x_PRIVATE
 *
pg72x
) ;

51 
sf_cou¡_t
 
g72x_ªad_s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

52 
sf_cou¡_t
 
g72x_ªad_i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

53 
sf_cou¡_t
 
g72x_ªad_f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

54 
sf_cou¡_t
 
g72x_ªad_d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

56 
sf_cou¡_t
 
g72x_wrôe_s
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

57 
sf_cou¡_t
 
g72x_wrôe_i
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

58 
sf_cou¡_t
 
g72x_wrôe_f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

59 
sf_cou¡_t
 
g72x_wrôe_d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

61 
sf_cou¡_t
 
g72x_£ek
 (
SF_PRIVATE
 *
psf
, 
mode
, sf_cou¡_à
off£t
) ;

63 
g72x_˛o£
 (
SF_PRIVATE
 *
psf
) ;

71 
	$g72x_öô
 (
SF_PRIVATE
 * 
psf
)

72 { 
G72x_PRIVATE
 *
pg72x
 ;

73 
bô•îßm∂e
, 
byã•îblock
, 
codec
 ;

75 i‡(
psf
->
codec_d©a
 !
NULL
)

76 { 
	`psf_log_¥ötf
 (
psf
, "***Ösf->codec_data isÇot NULL.\n") ;

77  
SFE_INTERNAL
 ;

80 
psf
->
sf
.
£ekabÀ
 = 
SF_FALSE
 ;

82 i‡(
psf
->
sf
.
ch™√ls
 != 1)

83  
SFE_G72X_NOT_MONO
 ;

85 i‡((
pg72x
 = 
	`ˇŒoc
 (1,  (
G72x_PRIVATE
))Ë=
NULL
)

86  
SFE_MALLOC_FAILED
 ;

88 
psf
->
codec_d©a
 = (*Ë
pg72x
 ;

90 
pg72x
->
block_cuº
 = 0 ;

91 
pg72x
->
ßm∂e_cuº
 = 0 ;

93 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
)

94 { 
SF_FORMAT_G721_32
 :

95 
codec
 = 
G721_32_BITS_PER_SAMPLE
 ;

96 
byã•îblock
 = 
G721_32_BYTES_PER_BLOCK
 ;

97 
bô•îßm∂e
 = 
G721_32_BITS_PER_SAMPLE
 ;

100 
SF_FORMAT_G723_24
:

101 
codec
 = 
G723_24_BITS_PER_SAMPLE
 ;

102 
byã•îblock
 = 
G723_24_BYTES_PER_BLOCK
 ;

103 
bô•îßm∂e
 = 
G723_24_BITS_PER_SAMPLE
 ;

106 
SF_FORMAT_G723_40
:

107 
codec
 = 
G723_40_BITS_PER_SAMPLE
 ;

108 
byã•îblock
 = 
G723_40_BYTES_PER_BLOCK
 ;

109 
bô•îßm∂e
 = 
G723_40_BITS_PER_SAMPLE
 ;

112  :  
SFE_UNIMPLEMENTED
 ;

115 
psf
->
blockwidth
 =Ösf->
byãwidth
 = 1 ;

117 
psf
->
fûñígth
 = 
	`psf_gë_fûñí
 (psf) ;

118 i‡(
psf
->
fûñígth
 <Ösf->
d©aoff£t
)

119 
psf
->
fûñígth
 =Ösf->
d©aoff£t
 ;

121 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

122 i‡(
psf
->
d©´nd
 > 0)

123 
psf
->
d©Æígth
 -psf->
fûñígth
 -Ösf->
d©´nd
 ;

125 i‡(
psf
->
mode
 =
SFM_READ
)

126 { 
pg72x
->
¥iv©e
 = 
	`g72x_ªadî_öô
 (
codec
, &’g72x->
blocksize
), &’g72x->
ßm∂e•îblock
)) ;

127 i‡(
pg72x
->
¥iv©e
 =
NULL
)

128  
SFE_MALLOC_FAILED
 ;

130 
pg72x
->
byã•îblock
 = bytesperblock ;

132 
psf
->
ªad_sh‹t
 = 
g72x_ªad_s
 ;

133 
psf
->
ªad_öt
 = 
g72x_ªad_i
 ;

134 
psf
->
ªad_Êﬂt
 = 
g72x_ªad_f
 ;

135 
psf
->
ªad_doubÀ
 = 
g72x_ªad_d
 ;

137 
psf
->
£ek
 = 
g72x_£ek
 ;

139 i‡(
psf
->
d©Æígth
 % 
pg72x
->
blocksize
)

140 { 
	`psf_log_¥ötf
 (
psf
, "*** OddÖsf->d©Æígth (%DËshould bê®mu…ùÀ o‡%d\n",Ösf->
d©Æígth
, 
pg72x
->
blocksize
) ;

141 
pg72x
->
blocks_tŸÆ
 = (
psf
->
d©Æígth
 /Ög72x->
blocksize
) + 1 ;

144 
pg72x
->
blocks_tŸÆ
 = 
psf
->
d©Æígth
 /Ög72x->
blocksize
 ;

146 
psf
->
sf
.
‰ames
 = 
pg72x
->
blocks_tŸÆ
 *Ög72x->
ßm∂e•îblock
 ;

148 
	`psf_g72x_decode_block
 (
psf
, 
pg72x
) ;

150 i‡(
psf
->
mode
 =
SFM_WRITE
)

151 { 
pg72x
->
¥iv©e
 = 
	`g72x_wrôî_öô
 (
codec
, &’g72x->
blocksize
), &’g72x->
ßm∂e•îblock
)) ;

152 i‡(
pg72x
->
¥iv©e
 =
NULL
)

153  
SFE_MALLOC_FAILED
 ;

155 
pg72x
->
byã•îblock
 = bytesperblock ;

157 
psf
->
wrôe_sh‹t
 = 
g72x_wrôe_s
 ;

158 
psf
->
wrôe_öt
 = 
g72x_wrôe_i
 ;

159 
psf
->
wrôe_Êﬂt
 = 
g72x_wrôe_f
 ;

160 
psf
->
wrôe_doubÀ
 = 
g72x_wrôe_d
 ;

162 i‡(
psf
->
d©Æígth
 % 
pg72x
->
blocksize
)

163 
pg72x
->
blocks_tŸÆ
 = (
psf
->
d©Æígth
 /Ög72x->
blocksize
) + 1 ;

165 
pg72x
->
blocks_tŸÆ
 = 
psf
->
d©Æígth
 /Ög72x->
blocksize
 ;

167 i‡(
psf
->
d©Æígth
 > 0)

168 
psf
->
sf
.
‰ames
 = (8 *Ösf->
d©Æígth
Ë/ 
bô•îßm∂e
 ;

170 i‡((
psf
->
sf
.
‰ames
 * 
bô•îßm∂e
Ë/ 8 !psf->
d©Æígth
)

171 
	`psf_log_¥ötf
 (
psf
, "*** Warning : weirdÖsf->datalength.\n") ;

174 
psf
->
codec_˛o£
 = 
g72x_˛o£
 ;

177 
	}
}

184 
	$psf_g72x_decode_block
 (
SF_PRIVATE
 *
psf
, 
G72x_PRIVATE
 *
pg72x
)

185 { 
k
 ;

187 
pg72x
->
block_cuº
 ++ ;

188 
pg72x
->
ßm∂e_cuº
 = 0 ;

190 i‡(
pg72x
->
block_cuº
 >Ög72x->
blocks_tŸÆ
)

191 { 
	`mem£t
 (
pg72x
->
ßm∂es
, 0, 
G72x_BLOCK_SIZE
 *  ()) ;

195 i‡((
k
 = 
	`psf_‰ód
 (
pg72x
->
block
, 1,Ög72x->
byã•îblock
, 
psf
)) !=Ög72x->bytesperblock)

196 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög : sh‹àªad (%d !%d).\n", 
k
, 
pg72x
->
byã•îblock
) ;

198 
pg72x
->
blocksize
 = 
k
 ;

199 
	`g72x_decode_block
 (
pg72x
->
¥iv©e
,Ög72x->
block
,Ög72x->
ßm∂es
) ;

202 
	}
}

205 
	$g72x_ªad_block
 (
SF_PRIVATE
 *
psf
, 
G72x_PRIVATE
 *
pg72x
, *
±r
, 
Àn
)

206 { 
cou¡
, 
tŸÆ
 = 0, 
ödx
 = 0 ;

208 
ödx
 < 
Àn
)

209 { i‡(
pg72x
->
block_cuº
 >Ög72x->
blocks_tŸÆ
)

210 { 
	`mem£t
 (&(
±r
 [
ödx
]), 0, (
Àn
 - indx) *  ()) ;

211  
tŸÆ
 ;

214 i‡(
pg72x
->
ßm∂e_cuº
 >pg72x->
ßm∂e•îblock
)

215 
	`psf_g72x_decode_block
 (
psf
, 
pg72x
) ;

217 
cou¡
 = 
pg72x
->
ßm∂e•îblock
 -Ög72x->
ßm∂e_cuº
 ;

218 
cou¡
 = (
Àn
 - 
ödx
 > count) ? count :Üen - indx ;

220 
	`mem˝y
 (&(
±r
 [
ödx
]), &(
pg72x
->
ßm∂es
 [pg72x->
ßm∂e_cuº
]), 
cou¡
 *  ()) ;

221 
ödx
 +
cou¡
 ;

222 
pg72x
->
ßm∂e_cuº
 +
cou¡
 ;

223 
tŸÆ
 = 
ödx
 ;

226  
tŸÆ
 ;

227 
	}
}

229 
sf_cou¡_t


230 
	$g72x_ªad_s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

231 { 
G72x_PRIVATE
 *
pg72x
 ;

232 
ªadcou¡
, 
cou¡
 ;

233 
sf_cou¡_t
 
tŸÆ
 = 0 ;

235 i‡(
psf
->
codec_d©a
 =
NULL
)

237 
pg72x
 = (
G72x_PRIVATE
*Ë
psf
->
codec_d©a
 ;

239 
Àn
 > 0)

240 { 
ªadcou¡
 = (
Àn
 > 0x10000000) ? 0x10000000 : ()Üen ;

242 
cou¡
 = 
	`g72x_ªad_block
 (
psf
, 
pg72x
, 
±r
, 
ªadcou¡
) ;

244 
tŸÆ
 +
cou¡
 ;

245 
Àn
 -
cou¡
 ;

247 i‡(
cou¡
 !
ªadcou¡
)

251  
tŸÆ
 ;

252 
	}
}

254 
sf_cou¡_t


255 
	$g72x_ªad_i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

256 { 
G72x_PRIVATE
 *
pg72x
 ;

257 *
•å
 ;

258 
k
, 
buf„æí
, 
ªadcou¡
 = 0, 
cou¡
 ;

259 
sf_cou¡_t
 
tŸÆ
 = 0 ;

261 i‡(
psf
->
codec_d©a
 =
NULL
)

263 
pg72x
 = (
G72x_PRIVATE
*Ë
psf
->
codec_d©a
 ;

265 
•å
 = 
psf
->
u
.
sbuf
 ;

266 
buf„æí
 = 
SF_BUFFER_LEN
 /  () ;

267 
Àn
 > 0)

268 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

269 
cou¡
 = 
	`g72x_ªad_block
 (
psf
, 
pg72x
, 
•å
, 
ªadcou¡
) ;

271 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

272 
±r
 [
tŸÆ
 + 
k
] = 
•å
 [k] << 16 ;

274 
tŸÆ
 +
cou¡
 ;

275 
Àn
 -
ªadcou¡
 ;

276 i‡(
cou¡
 !
ªadcou¡
)

280  
tŸÆ
 ;

281 
	}
}

283 
sf_cou¡_t


284 
	$g72x_ªad_f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

285 { 
G72x_PRIVATE
 *
pg72x
 ;

286 *
•å
 ;

287 
k
, 
buf„æí
, 
ªadcou¡
 = 0, 
cou¡
 ;

288 
sf_cou¡_t
 
tŸÆ
 = 0 ;

289 
n‹mÁ˘
 ;

291 i‡(
psf
->
codec_d©a
 =
NULL
)

293 
pg72x
 = (
G72x_PRIVATE
*Ë
psf
->
codec_d©a
 ;

295 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? 1.0 / (() 0x8000) : 1.0 ;

297 
•å
 = 
psf
->
u
.
sbuf
 ;

298 
buf„æí
 = 
SF_BUFFER_LEN
 /  () ;

299 
Àn
 > 0)

300 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

301 
cou¡
 = 
	`g72x_ªad_block
 (
psf
, 
pg72x
, 
•å
, 
ªadcou¡
) ;

302 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

303 
±r
 [
tŸÆ
 + 
k
] = 
n‹mÁ˘
 * 
•å
 [k] ;

305 
tŸÆ
 +
cou¡
 ;

306 
Àn
 -
ªadcou¡
 ;

307 i‡(
cou¡
 !
ªadcou¡
)

311  
tŸÆ
 ;

312 
	}
}

314 
sf_cou¡_t


315 
	$g72x_ªad_d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

316 { 
G72x_PRIVATE
 *
pg72x
 ;

317 *
•å
 ;

318 
k
, 
buf„æí
, 
ªadcou¡
 = 0, 
cou¡
 ;

319 
sf_cou¡_t
 
tŸÆ
 = 0 ;

320 
n‹mÁ˘
 ;

322 i‡(
psf
->
codec_d©a
 =
NULL
)

324 
pg72x
 = (
G72x_PRIVATE
*Ë
psf
->
codec_d©a
 ;

326 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? 1.0 / (() 0x8000) : 1.0 ;

328 
•å
 = 
psf
->
u
.
sbuf
 ;

329 
buf„æí
 = 
SF_BUFFER_LEN
 /  () ;

330 
Àn
 > 0)

331 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

332 
cou¡
 = 
	`g72x_ªad_block
 (
psf
, 
pg72x
, 
•å
, 
ªadcou¡
) ;

333 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

334 
±r
 [
tŸÆ
 + 
k
] = 
n‹mÁ˘
 * (Ë(
•å
 [k]) ;

336 
tŸÆ
 +
cou¡
 ;

337 
Àn
 -
ªadcou¡
 ;

338 i‡(
cou¡
 !
ªadcou¡
)

342  
tŸÆ
 ;

343 
	}
}

345 
sf_cou¡_t


346 
	$g72x_£ek
 (
SF_PRIVATE
 *
psf
, 
mode
, 
sf_cou¡_t
 
off£t
)

349 
mode
 ++ ;

350 
off£t
 ++ ;

352 
	`psf_log_¥ötf
 (
psf
, "seek unsupported\n") ;

424 
	}
}

431 
	$psf_g72x_ícode_block
 (
SF_PRIVATE
 *
psf
, 
G72x_PRIVATE
 *
pg72x
)

432 { 
k
 ;

435 
	`g72x_ícode_block
 (
pg72x
->
¥iv©e
,Ög72x->
ßm∂es
,Ög72x->
block
) ;

438 i‡((
k
 = 
	`psf_fwrôe
 (
pg72x
->
block
, 1,Ög72x->
blocksize
, 
psf
)) !=Ög72x->blocksize)

439 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög : sh‹àwrôê(%d !%d).\n", 
k
, 
pg72x
->
blocksize
) ;

441 
pg72x
->
ßm∂e_cuº
 = 0 ;

442 
pg72x
->
block_cuº
 ++ ;

445 
	`mem£t
 (
pg72x
->
ßm∂es
, 0, 
G72x_BLOCK_SIZE
 *  ()) ;

448 
	}
}

451 
	$g72x_wrôe_block
 (
SF_PRIVATE
 *
psf
, 
G72x_PRIVATE
 *
pg72x
, c⁄° *
±r
, 
Àn
)

452 { 
cou¡
, 
tŸÆ
 = 0, 
ödx
 = 0 ;

454 
ödx
 < 
Àn
)

455 { 
cou¡
 = 
pg72x
->
ßm∂e•îblock
 -Ög72x->
ßm∂e_cuº
 ;

457 i‡(
cou¡
 > 
Àn
 - 
ödx
)

458 
cou¡
 = 
Àn
 - 
ödx
 ;

460 
	`mem˝y
 (&(
pg72x
->
ßm∂es
 [pg72x->
ßm∂e_cuº
]), &(
±r
 [
ödx
]), 
cou¡
 *  ()) ;

461 
ödx
 +
cou¡
 ;

462 
pg72x
->
ßm∂e_cuº
 +
cou¡
 ;

463 
tŸÆ
 = 
ödx
 ;

465 i‡(
pg72x
->
ßm∂e_cuº
 >pg72x->
ßm∂e•îblock
)

466 
	`psf_g72x_ícode_block
 (
psf
, 
pg72x
) ;

469  
tŸÆ
 ;

470 
	}
}

472 
sf_cou¡_t


473 
	$g72x_wrôe_s
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

474 { 
G72x_PRIVATE
 *
pg72x
 ;

475 
wrôecou¡
, 
cou¡
 ;

476 
sf_cou¡_t
 
tŸÆ
 = 0 ;

478 i‡(
psf
->
codec_d©a
 =
NULL
)

480 
pg72x
 = (
G72x_PRIVATE
*Ë
psf
->
codec_d©a
 ;

482 
Àn
 > 0)

483 { 
wrôecou¡
 = (
Àn
 > 0x10000000) ? 0x10000000 : ()Üen ;

485 
cou¡
 = 
	`g72x_wrôe_block
 (
psf
, 
pg72x
, 
±r
, 
wrôecou¡
) ;

487 
tŸÆ
 +
cou¡
 ;

488 
Àn
 -
cou¡
 ;

489 i‡(
cou¡
 !
wrôecou¡
)

493  
tŸÆ
 ;

494 
	}
}

496 
sf_cou¡_t


497 
	$g72x_wrôe_i
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

498 { 
G72x_PRIVATE
 *
pg72x
 ;

499 *
•å
 ;

500 
k
, 
buf„æí
, 
wrôecou¡
 = 0, 
cou¡
 ;

501 
sf_cou¡_t
 
tŸÆ
 = 0 ;

503 i‡(
psf
->
codec_d©a
 =
NULL
)

505 
pg72x
 = (
G72x_PRIVATE
*Ë
psf
->
codec_d©a
 ;

507 
•å
 = 
psf
->
u
.
sbuf
 ;

508 
buf„æí
 = ((
SF_BUFFER_LEN
 / 
psf
->
blockwidth
) *Ösf->blockwidth) /  () ;

509 
Àn
 > 0)

510 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

511 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

512 
•å
 [
k
] = 
±r
 [
tŸÆ
 + k] >> 16 ;

513 
cou¡
 = 
	`g72x_wrôe_block
 (
psf
, 
pg72x
, 
•å
, 
wrôecou¡
) ;

515 
tŸÆ
 +
cou¡
 ;

516 
Àn
 -
wrôecou¡
 ;

517 i‡(
cou¡
 !
wrôecou¡
)

520  
tŸÆ
 ;

521 
	}
}

523 
sf_cou¡_t


524 
	$g72x_wrôe_f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

525 { 
G72x_PRIVATE
 *
pg72x
 ;

526 *
•å
 ;

527 
k
, 
buf„æí
, 
wrôecou¡
 = 0, 
cou¡
 ;

528 
sf_cou¡_t
 
tŸÆ
 = 0 ;

529 
n‹mÁ˘
 ;

531 i‡(
psf
->
codec_d©a
 =
NULL
)

533 
pg72x
 = (
G72x_PRIVATE
*Ë
psf
->
codec_d©a
 ;

535 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? (1.0 * 0x8000) : 1.0 ;

537 
•å
 = 
psf
->
u
.
sbuf
 ;

538 
buf„æí
 = ((
SF_BUFFER_LEN
 / 
psf
->
blockwidth
) *Ösf->blockwidth) /  () ;

539 
Àn
 > 0)

540 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

541 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

542 
•å
 [
k
] = 
	`Ãötf
 (
n‹mÁ˘
 * 
±r
 [
tŸÆ
 + k]) ;

543 
cou¡
 = 
	`g72x_wrôe_block
 (
psf
, 
pg72x
, 
•å
, 
wrôecou¡
) ;

545 
tŸÆ
 +
cou¡
 ;

546 
Àn
 -
wrôecou¡
 ;

547 i‡(
cou¡
 !
wrôecou¡
)

551  
tŸÆ
 ;

552 
	}
}

554 
sf_cou¡_t


555 
	$g72x_wrôe_d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

556 { 
G72x_PRIVATE
 *
pg72x
 ;

557 *
•å
 ;

558 
k
, 
buf„æí
, 
wrôecou¡
 = 0, 
cou¡
 ;

559 
sf_cou¡_t
 
tŸÆ
 = 0 ;

560 
n‹mÁ˘
 ;

562 i‡(
psf
->
codec_d©a
 =
NULL
)

564 
pg72x
 = (
G72x_PRIVATE
*Ë
psf
->
codec_d©a
 ;

566 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? (1.0 * 0x8000) : 1.0 ;

568 
•å
 = 
psf
->
u
.
sbuf
 ;

569 
buf„æí
 = ((
SF_BUFFER_LEN
 / 
psf
->
blockwidth
) *Ösf->blockwidth) /  () ;

570 
Àn
 > 0)

571 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

572 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

573 
•å
 [
k
] = 
	`Ãöt
 (
n‹mÁ˘
 * 
±r
 [
tŸÆ
 + k]) ;

574 
cou¡
 = 
	`g72x_wrôe_block
 (
psf
, 
pg72x
, 
•å
, 
wrôecou¡
) ;

576 
tŸÆ
 +
cou¡
 ;

577 
Àn
 -
wrôecou¡
 ;

578 i‡(
cou¡
 !
wrôecou¡
)

582  
tŸÆ
 ;

583 
	}
}

586 
	$g72x_˛o£
 (
SF_PRIVATE
 *
psf
)

587 { 
G72x_PRIVATE
 *
pg72x
 ;

589 
pg72x
 = (
G72x_PRIVATE
*Ë
psf
->
codec_d©a
 ;

591 i‡(
psf
->
mode
 =
SFM_WRITE
)

596 i‡(
pg72x
->
ßm∂e_cuº
 &&Ög72x->ßm∂e_cuº < 
G72x_BLOCK_SIZE
)

597 
	`psf_g72x_ícode_block
 (
psf
, 
pg72x
) ;

599 i‡(
psf
->
wrôe_hódî
)

600 
psf
->
	`wrôe_hódî
 (psf, 
SF_FALSE
) ;

604 
	`‰ì
 (
pg72x
->
¥iv©e
) ;

607 
	}
}

	@libsndfile-1.0.17/src/gsm610.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

25 
	~"¢dfûe.h
"

26 
	~"s„ndün.h
"

27 
	~"Êﬂt_ˇ°.h
"

28 
	~"comm⁄.h
"

29 
	~"wav_w64.h
"

30 
	~"GSM610/gsm.h
"

32 
	#GSM610_BLOCKSIZE
 33

	)

33 
	#GSM610_SAMPLES
 160

	)

35 
	sgsm610_èg


36 { 
	mblocks
 ;

37 
	mblockcou¡
, 
	mßm∂ecou¡
 ;

38 
	mßm∂e•îblock
, 
	mblocksize
 ;

40 (*
	mdecode_block
Ë(
SF_PRIVATE
 *
	mpsf
, 
gsm610_èg
 *
	mpgsm610
) ;

41 (*
	mícode_block
Ë(
SF_PRIVATE
 *
	mpsf
, 
gsm610_èg
 *
	mpgsm610
) ;

43 
	mßm∂es
 [
WAV_W64_GSM610_SAMPLES
] ;

44 
	mblock
 [
WAV_W64_GSM610_BLOCKSIZE
] ;

47 
gsm
 
	mgsm_d©a
 ;

48 } 
	tGSM610_PRIVATE
 ;

50 
sf_cou¡_t
 
gsm610_ªad_s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

51 
sf_cou¡_t
 
gsm610_ªad_i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

52 
sf_cou¡_t
 
gsm610_ªad_f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

53 
sf_cou¡_t
 
gsm610_ªad_d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

55 
sf_cou¡_t
 
gsm610_wrôe_s
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

56 
sf_cou¡_t
 
gsm610_wrôe_i
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

57 
sf_cou¡_t
 
gsm610_wrôe_f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

58 
sf_cou¡_t
 
gsm610_wrôe_d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

60 
gsm610_ªad_block
 (
SF_PRIVATE
 *
psf
, 
GSM610_PRIVATE
 *
pgsm610
, *
±r
, 
Àn
) ;

61 
gsm610_wrôe_block
 (
SF_PRIVATE
 *
psf
, 
GSM610_PRIVATE
 *
pgsm610
, c⁄° *
±r
, 
Àn
) ;

63 
gsm610_decode_block
 (
SF_PRIVATE
 *
psf
, 
GSM610_PRIVATE
 *
pgsm610
) ;

64 
gsm610_ícode_block
 (
SF_PRIVATE
 *
psf
, 
GSM610_PRIVATE
 *
pgsm610
) ;

66 
gsm610_wav_decode_block
 (
SF_PRIVATE
 *
psf
, 
GSM610_PRIVATE
 *
pgsm610
) ;

67 
gsm610_wav_ícode_block
 (
SF_PRIVATE
 *
psf
, 
GSM610_PRIVATE
 *
pgsm610
) ;

69 
sf_cou¡_t
 
gsm610_£ek
 (
SF_PRIVATE
 *
psf
, 
mode
, sf_cou¡_à
off£t
) ;

71 
gsm610_˛o£
 (
SF_PRIVATE
 *
psf
) ;

78 
	$gsm610_öô
 (
SF_PRIVATE
 *
psf
)

79 { 
GSM610_PRIVATE
 *
pgsm610
 ;

80 
åue_Êag
 = 1 ;

82 i‡(
psf
->
codec_d©a
 !
NULL
)

83 { 
	`psf_log_¥ötf
 (
psf
, "***Ösf->codec_data isÇot NULL.\n") ;

84  
SFE_INTERNAL
 ;

87 i‡(
psf
->
mode
 =
SFM_RDWR
)

88  
SFE_BAD_MODE_RW
 ;

90 
psf
->
sf
.
£ekabÀ
 = 
SF_FALSE
 ;

92 i‡((
pgsm610
 = 
	`ˇŒoc
 (1,  (
GSM610_PRIVATE
))Ë=
NULL
)

93  
SFE_MALLOC_FAILED
 ;

95 
psf
->
codec_d©a
 = 
pgsm610
 ;

97 
	`mem£t
 (
pgsm610
, 0,  (
GSM610_PRIVATE
)) ;

105 i‡((
pgsm610
->
gsm_d©a
 = 
	`gsm_¸óã
 ()Ë=
NULL
)

106  
SFE_MALLOC_FAILED
 ;

108 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
)

109 { 
SF_FORMAT_WAV
 :

110 
SF_FORMAT_WAVEX
 :

111 
SF_FORMAT_W64
 :

112 
	`gsm_›ti⁄
 (
pgsm610
->
gsm_d©a
, 
GSM_OPT_WAV49
, &
åue_Êag
) ;

114 
pgsm610
->
ícode_block
 = 
gsm610_wav_ícode_block
 ;

115 
pgsm610
->
decode_block
 = 
gsm610_wav_decode_block
 ;

117 
pgsm610
->
ßm∂e•îblock
 = 
WAV_W64_GSM610_SAMPLES
 ;

118 
pgsm610
->
blocksize
 = 
WAV_W64_GSM610_BLOCKSIZE
 ;

121 
SF_FORMAT_AIFF
 :

122 
SF_FORMAT_RAW
 :

123 
pgsm610
->
ícode_block
 = 
gsm610_ícode_block
 ;

124 
pgsm610
->
decode_block
 = 
gsm610_decode_block
 ;

126 
pgsm610
->
ßm∂e•îblock
 = 
GSM610_SAMPLES
 ;

127 
pgsm610
->
blocksize
 = 
GSM610_BLOCKSIZE
 ;

131  
SFE_INTERNAL
 ;

135 i‡(
psf
->
mode
 =
SFM_READ
)

136 { i‡(
psf
->
d©Æígth
 % 
pgsm610
->
blocksize
 == 0)

137 
pgsm610
->
blocks
 = 
psf
->
d©Æígth
 /Ögsm610->
blocksize
 ;

138 i‡(
psf
->
d©Æígth
 % 
pgsm610
->
blocksize
 =1 &&Ögsm610->blocksizê=
GSM610_BLOCKSIZE
)

146 
pgsm610
->
blocks
 = 
psf
->
d©Æígth
 /Ögsm610->
blocksize
 ;

149 { 
	`psf_log_¥ötf
 (
psf
, "*** Warning : data chunk seemsÅo beÅruncated.\n") ;

150 
pgsm610
->
blocks
 = 
psf
->
d©Æígth
 /Ögsm610->
blocksize
 + 1 ;

153 
psf
->
sf
.
‰ames
 = 
pgsm610
->
ßm∂e•îblock
 *Ögsm610->
blocks
 ;

155 
pgsm610
->
	`decode_block
 (
psf
,Ögsm610) ;

157 
psf
->
ªad_sh‹t
 = 
gsm610_ªad_s
 ;

158 
psf
->
ªad_öt
 = 
gsm610_ªad_i
 ;

159 
psf
->
ªad_Êﬂt
 = 
gsm610_ªad_f
 ;

160 
psf
->
ªad_doubÀ
 = 
gsm610_ªad_d
 ;

163 i‡(
psf
->
mode
 =
SFM_WRITE
)

164 { 
pgsm610
->
blockcou¡
 = 0 ;

165 
pgsm610
->
ßm∂ecou¡
 = 0 ;

167 
psf
->
wrôe_sh‹t
 = 
gsm610_wrôe_s
 ;

168 
psf
->
wrôe_öt
 = 
gsm610_wrôe_i
 ;

169 
psf
->
wrôe_Êﬂt
 = 
gsm610_wrôe_f
 ;

170 
psf
->
wrôe_doubÀ
 = 
gsm610_wrôe_d
 ;

173 
psf
->
codec_˛o£
 = 
gsm610_˛o£
 ;

175 
psf
->
£ek
 = 
gsm610_£ek
 ;

177 
psf
->
fûñígth
 = 
	`psf_gë_fûñí
 (psf) ;

178 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

181 
	}
}

188 
	$gsm610_wav_decode_block
 (
SF_PRIVATE
 *
psf
, 
GSM610_PRIVATE
 *
pgsm610
)

189 { 
k
 ;

191 
pgsm610
->
blockcou¡
 ++ ;

192 
pgsm610
->
ßm∂ecou¡
 = 0 ;

194 i‡(
pgsm610
->
blockcou¡
 >Ögsm610->
blocks
)

195 { 
	`mem£t
 (
pgsm610
->
ßm∂es
, 0, 
WAV_W64_GSM610_SAMPLES
 *  ()) ;

199 i‡((
k
 = 
	`psf_‰ód
 (
pgsm610
->
block
, 1, 
WAV_W64_GSM610_BLOCKSIZE
, 
psf
)) != WAV_W64_GSM610_BLOCKSIZE)

200 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög : sh‹àªad (%d !%d).\n", 
k
, 
WAV_W64_GSM610_BLOCKSIZE
) ;

202 i‡(
	`gsm_decode
 (
pgsm610
->
gsm_d©a
,Ögsm610->
block
,Ögsm610->
ßm∂es
) < 0)

203 { 
	`psf_log_¥ötf
 (
psf
, "Eº‹ from gsm_decode(Ë⁄ fømê: %d\n", 
pgsm610
->
blockcou¡
) ;

207 i‡(
	`gsm_decode
 (
pgsm610
->
gsm_d©a
,Ögsm610->
block
 + (
WAV_W64_GSM610_BLOCKSIZE
 + 1Ë/ 2,Ögsm610->
ßm∂es
 + 
WAV_W64_GSM610_SAMPLES
 / 2) < 0)

208 { 
	`psf_log_¥ötf
 (
psf
, "Eº‹ from gsm_decode(Ë⁄ fømê: %d.5\n", 
pgsm610
->
blockcou¡
) ;

213 
	}
}

216 
	$gsm610_decode_block
 (
SF_PRIVATE
 *
psf
, 
GSM610_PRIVATE
 *
pgsm610
)

217 { 
k
 ;

219 
pgsm610
->
blockcou¡
 ++ ;

220 
pgsm610
->
ßm∂ecou¡
 = 0 ;

222 i‡(
pgsm610
->
blockcou¡
 >Ögsm610->
blocks
)

223 { 
	`mem£t
 (
pgsm610
->
ßm∂es
, 0, 
GSM610_SAMPLES
 *  ()) ;

227 i‡((
k
 = 
	`psf_‰ód
 (
pgsm610
->
block
, 1, 
GSM610_BLOCKSIZE
, 
psf
)) != GSM610_BLOCKSIZE)

228 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög : sh‹àªad (%d !%d).\n", 
k
, 
GSM610_BLOCKSIZE
) ;

230 i‡(
	`gsm_decode
 (
pgsm610
->
gsm_d©a
,Ögsm610->
block
,Ögsm610->
ßm∂es
) < 0)

231 { 
	`psf_log_¥ötf
 (
psf
, "Eº‹ from gsm_decode(Ë⁄ fømê: %d\n", 
pgsm610
->
blockcou¡
) ;

236 
	}
}

239 
	$gsm610_ªad_block
 (
SF_PRIVATE
 *
psf
, 
GSM610_PRIVATE
 *
pgsm610
, *
±r
, 
Àn
)

240 { 
cou¡
, 
tŸÆ
 = 0, 
ödx
 = 0 ;

242 
ödx
 < 
Àn
)

243 { i‡(
pgsm610
->
blockcou¡
 >pgsm610->
blocks
 &&Ögsm610->
ßm∂ecou¡
 >pgsm610->
ßm∂e•îblock
)

244 { 
	`mem£t
 (&(
±r
 [
ödx
]), 0, (
Àn
 - indx) *  ()) ;

245  
tŸÆ
 ;

248 i‡(
pgsm610
->
ßm∂ecou¡
 >pgsm610->
ßm∂e•îblock
)

249 
pgsm610
->
	`decode_block
 (
psf
,Ögsm610) ;

251 
cou¡
 = 
pgsm610
->
ßm∂e•îblock
 -Ögsm610->
ßm∂ecou¡
 ;

252 
cou¡
 = (
Àn
 - 
ödx
 > count) ? count :Üen - indx ;

254 
	`mem˝y
 (&(
±r
 [
ödx
]), &(
pgsm610
->
ßm∂es
 [pgsm610->
ßm∂ecou¡
]), 
cou¡
 *  ()) ;

255 
ödx
 +
cou¡
 ;

256 
pgsm610
->
ßm∂ecou¡
 +
cou¡
 ;

257 
tŸÆ
 = 
ödx
 ;

260  
tŸÆ
 ;

261 
	}
}

263 
sf_cou¡_t


264 
	$gsm610_ªad_s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

265 { 
GSM610_PRIVATE
 *
pgsm610
 ;

266 
ªadcou¡
, 
cou¡
 ;

267 
sf_cou¡_t
 
tŸÆ
 = 0 ;

269 i‡(
psf
->
codec_d©a
 =
NULL
)

271 
pgsm610
 = (
GSM610_PRIVATE
*Ë
psf
->
codec_d©a
 ;

273 
Àn
 > 0)

274 { 
ªadcou¡
 = (
Àn
 > 0x10000000) ? 0x1000000 : ()Üen ;

276 
cou¡
 = 
	`gsm610_ªad_block
 (
psf
, 
pgsm610
, 
±r
, 
ªadcou¡
) ;

278 
tŸÆ
 +
cou¡
 ;

279 
Àn
 -
cou¡
 ;

281 i‡(
cou¡
 !
ªadcou¡
)

285  
tŸÆ
 ;

286 
	}
}

288 
sf_cou¡_t


289 
	$gsm610_ªad_i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

290 { 
GSM610_PRIVATE
 *
pgsm610
 ;

291 *
•å
 ;

292 
k
, 
buf„æí
, 
ªadcou¡
 = 0, 
cou¡
 ;

293 
sf_cou¡_t
 
tŸÆ
 = 0 ;

295 i‡(
psf
->
codec_d©a
 =
NULL
)

297 
pgsm610
 = (
GSM610_PRIVATE
*Ë
psf
->
codec_d©a
 ;

299 
•å
 = 
psf
->
u
.
sbuf
 ;

300 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

301 
Àn
 > 0)

302 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

303 
cou¡
 = 
	`gsm610_ªad_block
 (
psf
, 
pgsm610
, 
•å
, 
ªadcou¡
) ;

304 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

305 
±r
 [
tŸÆ
 + 
k
] = 
•å
 [k] << 16 ;

307 
tŸÆ
 +
cou¡
 ;

308 
Àn
 -
ªadcou¡
 ;

310  
tŸÆ
 ;

311 
	}
}

313 
sf_cou¡_t


314 
	$gsm610_ªad_f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

315 { 
GSM610_PRIVATE
 *
pgsm610
 ;

316 *
•å
 ;

317 
k
, 
buf„æí
, 
ªadcou¡
 = 0, 
cou¡
 ;

318 
sf_cou¡_t
 
tŸÆ
 = 0 ;

319 
n‹mÁ˘
 ;

321 i‡(
psf
->
codec_d©a
 =
NULL
)

323 
pgsm610
 = (
GSM610_PRIVATE
*Ë
psf
->
codec_d©a
 ;

325 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? 1.0 / (() 0x8000) : 1.0 ;

327 
•å
 = 
psf
->
u
.
sbuf
 ;

328 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

329 
Àn
 > 0)

330 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

331 
cou¡
 = 
	`gsm610_ªad_block
 (
psf
, 
pgsm610
, 
•å
, 
ªadcou¡
) ;

332 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

333 
±r
 [
tŸÆ
 + 
k
] = 
n‹mÁ˘
 * 
•å
 [k] ;

335 
tŸÆ
 +
cou¡
 ;

336 
Àn
 -
ªadcou¡
 ;

338  
tŸÆ
 ;

339 
	}
}

341 
sf_cou¡_t


342 
	$gsm610_ªad_d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

343 { 
GSM610_PRIVATE
 *
pgsm610
 ;

344 *
•å
 ;

345 
k
, 
buf„æí
, 
ªadcou¡
 = 0, 
cou¡
 ;

346 
sf_cou¡_t
 
tŸÆ
 = 0 ;

347 
n‹mÁ˘
 ;

349 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? 1.0 / (() 0x8000) : 1.0 ;

351 i‡(
psf
->
codec_d©a
 =
NULL
)

353 
pgsm610
 = (
GSM610_PRIVATE
*Ë
psf
->
codec_d©a
 ;

355 
•å
 = 
psf
->
u
.
sbuf
 ;

356 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

357 
Àn
 > 0)

358 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

359 
cou¡
 = 
	`gsm610_ªad_block
 (
psf
, 
pgsm610
, 
•å
, 
ªadcou¡
) ;

360 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

361 
±r
 [
tŸÆ
 + 
k
] = 
n‹mÁ˘
 * 
•å
 [k] ;

363 
tŸÆ
 +
cou¡
 ;

364 
Àn
 -
ªadcou¡
 ;

366  
tŸÆ
 ;

367 
	}
}

369 
sf_cou¡_t


370 
	$gsm610_£ek
 (
SF_PRIVATE
 *
psf
, 
mode
, 
sf_cou¡_t
 
off£t
)

371 { 
GSM610_PRIVATE
 *
pgsm610
 ;

372 
√wblock
, 
√wßm∂e
 ;

374 
mode
 = mode ;

376 i‡(
psf
->
codec_d©a
 =
NULL
)

378 
pgsm610
 = (
GSM610_PRIVATE
*Ë
psf
->
codec_d©a
 ;

380 i‡(
psf
->
d©aoff£t
 < 0)

381 { 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

382  
PSF_SEEK_ERROR
 ;

385 i‡(
off£t
 == 0)

386 { 
åue_Êag
 = 1 ;

388 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
, 
SEEK_SET
) ;

389 
pgsm610
->
blockcou¡
 = 0 ;

391 
	`gsm_öô
 (
pgsm610
->
gsm_d©a
) ;

392 i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_WAV
 ||

393 (
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_W64
)

394 
	`gsm_›ti⁄
 (
pgsm610
->
gsm_d©a
, 
GSM_OPT_WAV49
, &
åue_Êag
) ;

396 
pgsm610
->
	`decode_block
 (
psf
,Ögsm610) ;

397 
pgsm610
->
ßm∂ecou¡
 = 0 ;

401 i‡(
off£t
 < 0 || off£à> 
pgsm610
->
blocks
 *Ögsm610->
ßm∂e•îblock
)

402 { 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

403  
PSF_SEEK_ERROR
 ;

406 
√wblock
 = 
off£t
 / 
pgsm610
->
ßm∂e•îblock
 ;

407 
√wßm∂e
 = 
off£t
 % 
pgsm610
->
ßm∂e•îblock
 ;

409 i‡(
psf
->
mode
 =
SFM_READ
)

410 { i‡(
psf
->
ªad_cuºít
 !
√wblock
 * 
pgsm610
->
ßm∂e•îblock
 + 
√wßm∂e
)

411 { 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
 + 
√wblock
 * 
pgsm610
->
ßm∂e•îblock
, 
SEEK_SET
) ;

412 
pgsm610
->
blockcou¡
 = 
√wblock
 ;

413 
pgsm610
->
	`decode_block
 (
psf
,Ögsm610) ;

414 
pgsm610
->
ßm∂ecou¡
 = 
√wßm∂e
 ;

417  
√wblock
 * 
pgsm610
->
ßm∂e•îblock
 + 
√wßm∂e
 ;

421 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

422  
PSF_SEEK_ERROR
 ;

423 
	}
}

430 
	$gsm610_ícode_block
 (
SF_PRIVATE
 *
psf
, 
GSM610_PRIVATE
 *
pgsm610
)

431 { 
k
 ;

434 
	`gsm_ícode
 (
pgsm610
->
gsm_d©a
,Ögsm610->
ßm∂es
,Ögsm610->
block
) ;

437 i‡((
k
 = 
	`psf_fwrôe
 (
pgsm610
->
block
, 1, 
GSM610_BLOCKSIZE
, 
psf
)) != GSM610_BLOCKSIZE)

438 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög : sh‹àwrôê(%d !%d).\n", 
k
, 
GSM610_BLOCKSIZE
) ;

440 
pgsm610
->
ßm∂ecou¡
 = 0 ;

441 
pgsm610
->
blockcou¡
 ++ ;

444 
	`mem£t
 (
pgsm610
->
ßm∂es
, 0, 
WAV_W64_GSM610_SAMPLES
 *  ()) ;

447 
	}
}

450 
	$gsm610_wav_ícode_block
 (
SF_PRIVATE
 *
psf
, 
GSM610_PRIVATE
 *
pgsm610
)

451 { 
k
 ;

454 
	`gsm_ícode
 (
pgsm610
->
gsm_d©a
,Ögsm610->
ßm∂es
,Ögsm610->
block
) ;

455 
	`gsm_ícode
 (
pgsm610
->
gsm_d©a
,Ögsm610->
ßm∂es
+
WAV_W64_GSM610_SAMPLES
/2,Ögsm610->
block
+
WAV_W64_GSM610_BLOCKSIZE
/2) ;

458 i‡((
k
 = 
	`psf_fwrôe
 (
pgsm610
->
block
, 1, 
WAV_W64_GSM610_BLOCKSIZE
, 
psf
)) != WAV_W64_GSM610_BLOCKSIZE)

459 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög : sh‹àwrôê(%d !%d).\n", 
k
, 
WAV_W64_GSM610_BLOCKSIZE
) ;

461 
pgsm610
->
ßm∂ecou¡
 = 0 ;

462 
pgsm610
->
blockcou¡
 ++ ;

465 
	`mem£t
 (
pgsm610
->
ßm∂es
, 0, 
WAV_W64_GSM610_SAMPLES
 *  ()) ;

468 
	}
}

471 
	$gsm610_wrôe_block
 (
SF_PRIVATE
 *
psf
, 
GSM610_PRIVATE
 *
pgsm610
, c⁄° *
±r
, 
Àn
)

472 { 
cou¡
, 
tŸÆ
 = 0, 
ödx
 = 0 ;

474 
ödx
 < 
Àn
)

475 { 
cou¡
 = 
pgsm610
->
ßm∂e•îblock
 -Ögsm610->
ßm∂ecou¡
 ;

477 i‡(
cou¡
 > 
Àn
 - 
ödx
)

478 
cou¡
 = 
Àn
 - 
ödx
 ;

480 
	`mem˝y
 (&(
pgsm610
->
ßm∂es
 [pgsm610->
ßm∂ecou¡
]), &(
±r
 [
ödx
]), 
cou¡
 *  ()) ;

481 
ödx
 +
cou¡
 ;

482 
pgsm610
->
ßm∂ecou¡
 +
cou¡
 ;

483 
tŸÆ
 = 
ödx
 ;

485 i‡(
pgsm610
->
ßm∂ecou¡
 >pgsm610->
ßm∂e•îblock
)

486 
pgsm610
->
	`ícode_block
 (
psf
,Ögsm610) ;

489  
tŸÆ
 ;

490 
	}
}

492 
sf_cou¡_t


493 
	$gsm610_wrôe_s
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

494 { 
GSM610_PRIVATE
 *
pgsm610
 ;

495 
wrôecou¡
, 
cou¡
 ;

496 
sf_cou¡_t
 
tŸÆ
 = 0 ;

498 i‡(
psf
->
codec_d©a
 =
NULL
)

500 
pgsm610
 = (
GSM610_PRIVATE
*Ë
psf
->
codec_d©a
 ;

502 
Àn
 > 0)

503 { 
wrôecou¡
 = (
Àn
 > 0x10000000) ? 0x10000000 : ()Üen ;

505 
cou¡
 = 
	`gsm610_wrôe_block
 (
psf
, 
pgsm610
, 
±r
, 
wrôecou¡
) ;

507 
tŸÆ
 +
cou¡
 ;

508 
Àn
 -
cou¡
 ;

510 i‡(
cou¡
 !
wrôecou¡
)

514  
tŸÆ
 ;

515 
	}
}

517 
sf_cou¡_t


518 
	$gsm610_wrôe_i
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

519 { 
GSM610_PRIVATE
 *
pgsm610
 ;

520 *
•å
 ;

521 
k
, 
buf„æí
, 
wrôecou¡
 = 0, 
cou¡
 ;

522 
sf_cou¡_t
 
tŸÆ
 = 0 ;

524 i‡(
psf
->
codec_d©a
 =
NULL
)

526 
pgsm610
 = (
GSM610_PRIVATE
*Ë
psf
->
codec_d©a
 ;

528 
•å
 = 
psf
->
u
.
sbuf
 ;

529 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

530 
Àn
 > 0)

531 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

532 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

533 
•å
 [
k
] = 
±r
 [
tŸÆ
 + k] >> 16 ;

534 
cou¡
 = 
	`gsm610_wrôe_block
 (
psf
, 
pgsm610
, 
•å
, 
wrôecou¡
) ;

536 
tŸÆ
 +
cou¡
 ;

537 
Àn
 -
wrôecou¡
 ;

539  
tŸÆ
 ;

540 
	}
}

542 
sf_cou¡_t


543 
	$gsm610_wrôe_f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

544 { 
GSM610_PRIVATE
 *
pgsm610
 ;

545 *
•å
 ;

546 
k
, 
buf„æí
, 
wrôecou¡
 = 0, 
cou¡
 ;

547 
sf_cou¡_t
 
tŸÆ
 = 0 ;

548 
n‹mÁ˘
 ;

550 i‡(
psf
->
codec_d©a
 =
NULL
)

552 
pgsm610
 = (
GSM610_PRIVATE
*Ë
psf
->
codec_d©a
 ;

554 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? (1.0 * 0x7FFF) : 1.0 ;

556 
•å
 = 
psf
->
u
.
sbuf
 ;

557 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

558 
Àn
 > 0)

559 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

560 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

561 
•å
 [
k
] = 
	`Ãötf
 (
n‹mÁ˘
 * 
±r
 [
tŸÆ
 + k]) ;

562 
cou¡
 = 
	`gsm610_wrôe_block
 (
psf
, 
pgsm610
, 
•å
, 
wrôecou¡
) ;

564 
tŸÆ
 +
cou¡
 ;

565 
Àn
 -
wrôecou¡
 ;

567  
tŸÆ
 ;

568 
	}
}

570 
sf_cou¡_t


571 
	$gsm610_wrôe_d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

572 { 
GSM610_PRIVATE
 *
pgsm610
 ;

573 *
•å
 ;

574 
k
, 
buf„æí
, 
wrôecou¡
 = 0, 
cou¡
 ;

575 
sf_cou¡_t
 
tŸÆ
 = 0 ;

576 
n‹mÁ˘
 ;

578 i‡(
psf
->
codec_d©a
 =
NULL
)

580 
pgsm610
 = (
GSM610_PRIVATE
*Ë
psf
->
codec_d©a
 ;

582 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? (1.0 * 0x7FFF) : 1.0 ;

584 
•å
 = 
psf
->
u
.
sbuf
 ;

585 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

586 
Àn
 > 0)

587 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

588 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

589 
•å
 [
k
] = 
	`Ãöt
 (
n‹mÁ˘
 * 
±r
 [
tŸÆ
 + k]) ;

590 
cou¡
 = 
	`gsm610_wrôe_block
 (
psf
, 
pgsm610
, 
•å
, 
wrôecou¡
) ;

592 
tŸÆ
 +
cou¡
 ;

593 
Àn
 -
wrôecou¡
 ;

595  
tŸÆ
 ;

596 
	}
}

599 
	$gsm610_˛o£
 (
SF_PRIVATE
 *
psf
)

600 { 
GSM610_PRIVATE
 *
pgsm610
 ;

602 i‡(
psf
->
codec_d©a
 =
NULL
)

605 
pgsm610
 = (
GSM610_PRIVATE
*Ë
psf
->
codec_d©a
 ;

607 i‡(
psf
->
mode
 =
SFM_WRITE
)

612 i‡(
pgsm610
->
ßm∂ecou¡
 &&Ögsm610->ßm∂ecou¡ <Ögsm610->
ßm∂e•îblock
)

613 
pgsm610
->
	`ícode_block
 (
psf
,Ögsm610) ;

616 i‡(
pgsm610
->
gsm_d©a
)

617 
	`gsm_de°roy
 (
pgsm610
->
gsm_d©a
) ;

620 
	}
}

	@libsndfile-1.0.17/src/htk.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<f˙é.h
>

23 
	~<°rög.h
>

24 
	~<˘y≥.h
>

26 
	~"¢dfûe.h
"

27 
	~"s„ndün.h
"

28 
	~"comm⁄.h
"

34 
	#SFE_HTK_BAD_FILE_LEN
 1666

	)

35 
	#SFE_HTK_NOT_WAVEFORM
 1667

	)

41 
htk_˛o£
 (
SF_PRIVATE
 *
psf
) ;

43 
htk_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
) ;

44 
htk_ªad_hódî
 (
SF_PRIVATE
 *
psf
) ;

51 
	$htk_›í
 (
SF_PRIVATE
 *
psf
)

52 { 
subf‹m©
 ;

53 
îr‹
 = 0 ;

55 i‡(
psf
->
is_pùe
)

56  
SFE_HTK_NO_PIPE
 ;

58 i‡(
psf
->
mode
 =
SFM_READ
 || (psf->modê=
SFM_RDWR
 &&Ösf->
fûñígth
 > 0))

59 { i‡((
îr‹
 = 
	`htk_ªad_hódî
 (
psf
)))

60  
îr‹
 ;

63 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

65 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

66 { i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_HTK
)

67  
SFE_BAD_OPEN_FORMAT
 ;

69 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

71 i‡(
	`htk_wrôe_hódî
 (
psf
, 
SF_FALSE
))

72  
psf
->
îr‹
 ;

74 
psf
->
wrôe_hódî
 = 
htk_wrôe_hódî
 ;

77 
psf
->
c⁄èöî_˛o£
 = 
htk_˛o£
 ;

79 
psf
->
blockwidth
 =Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

81 
subf‹m©
)

82 { 
SF_FORMAT_PCM_16
 :

83 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

89  
îr‹
 ;

90 
	}
}

96 
	$htk_˛o£
 (
SF_PRIVATE
 *
psf
)

98 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

99 
	`htk_wrôe_hódî
 (
psf
, 
SF_TRUE
) ;

102 
	}
}

105 
	$htk_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
)

106 { 
sf_cou¡_t
 
cuºít
 ;

107 
ßm∂e_cou¡
, 
ßm∂e_≥riod
 ;

109 
cuºít
 = 
	`psf_·ñl
 (
psf
) ;

111 i‡(
ˇlc_Àngth
)

112 
psf
->
fûñígth
 = 
	`psf_gë_fûñí
 (psf) ;

115 
psf
->
hódî
 [0] = 0 ;

116 
psf
->
hódödex
 = 0 ;

117 
	`psf_f£ek
 (
psf
, 0, 
SEEK_SET
) ;

119 i‡(
psf
->
fûñígth
 > 12)

120 
ßm∂e_cou¡
 = (
psf
->
fûñígth
 - 12) / 2 ;

122 
ßm∂e_cou¡
 = 0 ;

124 
ßm∂e_≥riod
 = 10000000 / 
psf
->
sf
.
ßm∂î©e
 ;

126 
	`psf_böhódî_wrôef
 (
psf
, "E444", 
ßm∂e_cou¡
, 
ßm∂e_≥riod
, 0x20000) ;

129 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

131 i‡(
psf
->
îr‹
)

132  
psf
->
îr‹
 ;

134 
psf
->
d©aoff£t
 =Ösf->
hódödex
 ;

136 i‡(
cuºít
 > 0)

137 
	`psf_f£ek
 (
psf
, 
cuºít
, 
SEEK_SET
) ;

139  
psf
->
îr‹
 ;

140 
	}
}

186 
	$htk_ªad_hódî
 (
SF_PRIVATE
 *
psf
)

187 { 
ßm∂e_cou¡
, 
ßm∂e_≥riod
, 
m¨kî
 ;

189 
	`psf_böhódî_ªadf
 (
psf
, "pE444", 0, &
ßm∂e_cou¡
, &
ßm∂e_≥riod
, &
m¨kî
) ;

191 i‡(2 * 
ßm∂e_cou¡
 + 12 !
psf
->
fûñígth
)

192  
SFE_HTK_BAD_FILE_LEN
 ;

194 i‡(
m¨kî
 != 0x20000)

195  
SFE_HTK_NOT_WAVEFORM
 ;

197 
psf
->
sf
.
ch™√ls
 = 1 ;

198 
psf
->
sf
.
ßm∂î©e
 = 10000000 / 
ßm∂e_≥riod
 ;

200 
	`psf_log_¥ötf
 (
psf
, "HTK Waveform file\n Sample Count : %d\n Sample Period : %d => %d Hz\n",

201 
ßm∂e_cou¡
, 
ßm∂e_≥riod
, 
psf
->
sf
.
ßm∂î©e
) ;

203 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_HTK
 | 
SF_FORMAT_PCM_16
 ;

204 
psf
->
byãwidth
 = 2 ;

207 
psf
->
d©aoff£t
 = 12 ;

208 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

210 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

212 
psf
->
blockwidth
 =Ösf->
sf
.
ch™√ls
 *Ösf->
byãwidth
 ;

214 i‡(! 
psf
->
sf
.
‰ames
 &&Ösf->
blockwidth
)

215 
psf
->
sf
.
‰ames
 = (psf->
fûñígth
 -Ösf->
d©aoff£t
Ë/Ösf->
blockwidth
 ;

218 
	}
}

	@libsndfile-1.0.17/src/ima_adpcm.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

25 
	~"¢dfûe.h
"

26 
	~"s„ndün.h
"

27 
	~"Êﬂt_ˇ°.h
"

28 
	~"comm⁄.h
"

30 
	sIMA_ADPCM_PRIVATE_èg


31 { (*
	mdecode_block
Ë(
SF_PRIVATE
 *
	mpsf
, 
IMA_ADPCM_PRIVATE_èg
 *
	mpima
) ;

32 (*
	mícode_block
Ë(
SF_PRIVATE
 *
	mpsf
, 
IMA_ADPCM_PRIVATE_èg
 *
	mpima
) ;

34 
	mch™√ls
, 
	mblocksize
, 
	mßm∂e•îblock
, 
	mblocks
 ;

35 
	mblockcou¡
, 
	mßm∂ecou¡
 ;

36 
	m¥evious
 [2] ;

37 
	m°ïödx
 [2] ;

38 *
	mblock
 ;

39 *
	mßm∂es
 ;

40 #i‡
HAVE_FLEXIBLE_ARRAY


41 
	md©a
 [] ;

43 
	md©a
 [0] ;

45 } 
	tIMA_ADPCM_PRIVATE
 ;

51 
	gima_ödx_adju°
 [16] =

58 
	gima_°ï_size
 [89] =

68 
ima_ªadî_öô
 (
SF_PRIVATE
 *
psf
, 
blockÆign
, 
ßm∂e•îblock
) ;

69 
ima_wrôî_öô
 (
SF_PRIVATE
 *
psf
, 
blockÆign
) ;

71 
ima_ªad_block
 (
SF_PRIVATE
 *
psf
, 
IMA_ADPCM_PRIVATE
 *
pima
, *
±r
, 
Àn
) ;

72 
ima_wrôe_block
 (
SF_PRIVATE
 *
psf
, 
IMA_ADPCM_PRIVATE
 *
pima
, c⁄° *
±r
, 
Àn
) ;

74 
sf_cou¡_t
 
ima_ªad_s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

75 
sf_cou¡_t
 
ima_ªad_i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

76 
sf_cou¡_t
 
ima_ªad_f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

77 
sf_cou¡_t
 
ima_ªad_d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

79 
sf_cou¡_t
 
ima_wrôe_s
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

80 
sf_cou¡_t
 
ima_wrôe_i
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

81 
sf_cou¡_t
 
ima_wrôe_f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

82 
sf_cou¡_t
 
ima_wrôe_d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

84 
sf_cou¡_t
 
ima_£ek
 (
SF_PRIVATE
 *
psf
, 
mode
, sf_cou¡_à
off£t
) ;

86 
ima_˛o£
 (
SF_PRIVATE
 *
psf
) ;

88 
wav_w64_ima_decode_block
 (
SF_PRIVATE
 *
psf
, 
IMA_ADPCM_PRIVATE
 *
pima
) ;

89 
wav_w64_ima_ícode_block
 (
SF_PRIVATE
 *
psf
, 
IMA_ADPCM_PRIVATE
 *
pima
) ;

92 
aiff_ima_decode_block
 (
SF_PRIVATE
 *
psf
, 
IMA_ADPCM_PRIVATE
 *
pima
) ;

93 
aiff_ima_ícode_block
 (
SF_PRIVATE
 *
psf
, 
IMA_ADPCM_PRIVATE
 *
pima
) ;

101 
	$wav_w64_ima_öô
 (
SF_PRIVATE
 *
psf
, 
blockÆign
, 
ßm∂e•îblock
)

102 { 
îr‹
 ;

104 i‡(
psf
->
codec_d©a
 !
NULL
)

105 { 
	`psf_log_¥ötf
 (
psf
, "***Ösf->codec_data isÇot NULL.\n") ;

106  
SFE_INTERNAL
 ;

109 i‡(
psf
->
mode
 =
SFM_RDWR
)

110  
SFE_BAD_MODE_RW
 ;

112 i‡(
psf
->
mode
 =
SFM_READ
)

113 i‡((
îr‹
 = 
	`ima_ªadî_öô
 (
psf
, 
blockÆign
, 
ßm∂e•îblock
)))

114  
îr‹
 ;

116 i‡(
psf
->
mode
 =
SFM_WRITE
)

117 i‡((
îr‹
 = 
	`ima_wrôî_öô
 (
psf
, 
blockÆign
)))

118  
îr‹
 ;

120 
psf
->
codec_˛o£
 = 
ima_˛o£
 ;

121 
psf
->
£ek
 = 
ima_£ek
 ;

124 
	}
}

127 
	$aiff_ima_öô
 (
SF_PRIVATE
 *
psf
, 
blockÆign
, 
ßm∂e•îblock
)

128 { 
îr‹
 ;

130 i‡(
psf
->
mode
 =
SFM_RDWR
)

131  
SFE_BAD_MODE_RW
 ;

133 i‡(
psf
->
mode
 =
SFM_READ
)

134 i‡((
îr‹
 = 
	`ima_ªadî_öô
 (
psf
, 
blockÆign
, 
ßm∂e•îblock
)))

135  
îr‹
 ;

137 i‡(
psf
->
mode
 =
SFM_WRITE
)

138 i‡((
îr‹
 = 
	`ima_wrôî_öô
 (
psf
, 
blockÆign
)))

139  
îr‹
 ;

141 
psf
->
codec_˛o£
 = 
ima_˛o£
 ;

144 
	}
}

147 
	$ima_˛o£
 (
SF_PRIVATE
 *
psf
)

148 { 
IMA_ADPCM_PRIVATE
 *
pima
 ;

150 
pima
 = (
IMA_ADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

152 i‡(
psf
->
mode
 =
SFM_WRITE
)

156 i‡(
pima
->
ßm∂ecou¡
 &&Öima->ßm∂ecou¡ <Öima->
ßm∂e•îblock
)

157 
pima
->
	`ícode_block
 (
psf
,Öima) ;

159 
psf
->
sf
.
‰ames
 = 
pima
->
ßm∂e•îblock
 *Öima->
blockcou¡
 /Ösf->sf.
ch™√ls
 ;

163 
	}
}

170 
	$ima_ªadî_öô
 (
SF_PRIVATE
 *
psf
, 
blockÆign
, 
ßm∂e•îblock
)

171 { 
IMA_ADPCM_PRIVATE
 *
pima
 ;

172 
pimasize
, 
cou¡
 ;

174 i‡(
psf
->
mode
 !
SFM_READ
)

175  
SFE_BAD_MODE_RW
 ;

177 
pimasize
 =  (
IMA_ADPCM_PRIVATE
Ë+ 
blockÆign
 * 
psf
->
sf
.
ch™√ls
 + 3 *Ösf->sf.ch™√l†* 
ßm∂e•îblock
 ;

179 i‡(! (
pima
 = 
	`mÆloc
 (
pimasize
)))

180  
SFE_MALLOC_FAILED
 ;

182 
psf
->
codec_d©a
 = (*Ë
pima
 ;

184 
	`mem£t
 (
pima
, 0, 
pimasize
) ;

186 
pima
->
ßm∂es
 =Öima->
d©a
 ;

187 
pima
->
block
 = (*Ë’ima->
d©a
 + 
ßm∂e•îblock
 * 
psf
->
sf
.
ch™√ls
) ;

189 
pima
->
ch™√ls
 = 
psf
->
sf
.channels ;

190 
pima
->
blocksize
 = 
blockÆign
 ;

191 
pima
->
ßm∂e•îblock
 = samplesperblock ;

193 
psf
->
fûñígth
 = 
	`psf_gë_fûñí
 (psf) ;

194 
psf
->
d©Æígth
 = (psf->
d©´nd
Ë?Ösf->d©´nd -Ösf->
d©aoff£t
 :

195 
psf
->
fûñígth
 -Ösf->
d©aoff£t
 ;

197 i‡(
psf
->
d©Æígth
 % 
pima
->
blocksize
)

198 
pima
->
blocks
 = 
psf
->
d©Æígth
 /Öima->
blocksize
 + 1 ;

200 
pima
->
blocks
 = 
psf
->
d©Æígth
 /Öima->
blocksize
 ;

202 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
)

203 { 
SF_FORMAT_WAV
 :

204 
SF_FORMAT_W64
 :

205 
cou¡
 = 2 * (
pima
->
blocksize
 - 4 *Öima->
ch™√ls
) /Öima->channels + 1 ;

207 i‡(
pima
->
ßm∂e•îblock
 !
cou¡
)

208 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög : sam∂e•îblock should bê%d.\n", 
cou¡
) ;

210 
pima
->
decode_block
 = 
wav_w64_ima_decode_block
 ;

212 
psf
->
sf
.
‰ames
 = 
pima
->
ßm∂e•îblock
 *Öima->
blocks
 ;

215 
SF_FORMAT_AIFF
 :

216 
	`psf_log_¥ötf
 (
psf
, "stillÇeedÅo check block count\n") ;

217 
pima
->
decode_block
 = 
aiff_ima_decode_block
 ;

218 
psf
->
sf
.
‰ames
 = 
pima
->
ßm∂e•îblock
 *Öima->
blocks
 /Öima->
ch™√ls
 ;

222 
	`psf_log_¥ötf
 (
psf
, "ima_reader_init: badÖsf->sf.format\n") ;

223  
SFE_INTERNAL
 ;

227 
pima
->
	`decode_block
 (
psf
,Öima) ;

229 
psf
->
ªad_sh‹t
 = 
ima_ªad_s
 ;

230 
psf
->
ªad_öt
 = 
ima_ªad_i
 ;

231 
psf
->
ªad_Êﬂt
 = 
ima_ªad_f
 ;

232 
psf
->
ªad_doubÀ
 = 
ima_ªad_d
 ;

235 
	}
}

238 
	$aiff_ima_decode_block
 (
SF_PRIVATE
 *
psf
, 
IMA_ADPCM_PRIVATE
 *
pima
)

239 { *
blockd©a
 ;

240 
ch™
, 
k
, 
diff
, 
byãcode
 ;

241 
°ï
, 
°ïödx
, 
¥edi˘‹
, *
ßm∂ed©a
 ;

243 
cou¡
 = 0 ;

244 
cou¡
 ++ ;

246 
pima
->
blockcou¡
 +pima->
ch™√ls
 ;

247 
pima
->
ßm∂ecou¡
 = 0 ;

249 i‡(
pima
->
blockcou¡
 >Öima->
blocks
)

250 { 
	`mem£t
 (
pima
->
ßm∂es
, 0,Öima->
ßm∂e•îblock
 *Öima->
ch™√ls
 *  ()) ;

254 i‡((
k
 = 
	`psf_‰ód
 (
pima
->
block
, 1,Öima->
blocksize
 *Öima->
ch™√ls
, 
psf
)) !=Öima->blocksize *Öima->channels)

255 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög : sh‹àªad (%d !%d).\n", 
k
, 
pima
->
blocksize
) ;

258 
ch™
 = 0 ; ch™ < 
pima
->
ch™√ls
 ; chan++)

259 { 
blockd©a
 = 
pima
->
block
 + 
ch™
 * 34 ;

260 
ßm∂ed©a
 = 
pima
->
ßm∂es
 + 
ch™
 ;

262 
¥edi˘‹
 = (
blockd©a
 [0] << 8) | (blockdata [1] & 0x80) ;

263 
°ïödx
 = 
blockd©a
 [1] & 0x7F ;

266 i‡(
cou¡
 < 5)

267 
	`¥ötf
 ("\nchan: %dÖredictor: %d stepindx: %d (%d)\n",

268 
ch™
, 
¥edi˘‹
, 
°ïödx
, 
ima_°ï_size
 [stepindx]) ;

271 i‡(
°ïödx
 < 0) stepindx = 0 ;

272 i‡(
°ïödx
 > 88) stepindx = 88 ;

278 
k
 = 0 ; k < 
pima
->
blocksize
 - 2 ; k++)

279 { 
byãcode
 = 
blockd©a
 [
k
 + 2] ;

280 
ßm∂ed©a
 [
pima
->
ch™√ls
 * (2 * 
k
 + 0)] = 
byãcode
 & 0xF ;

281 
ßm∂ed©a
 [
pima
->
ch™√ls
 * (2 * 
k
 + 1)] = (
byãcode
 >> 4) & 0xF ;

285 
k
 = 0 ; k < 
pima
->
ßm∂e•îblock
 ; k ++)

286 { 
°ï
 = 
ima_°ï_size
 [
°ïödx
] ;

288 
byãcode
 = 
pima
->
ßm∂es
 [pima->
ch™√ls
 * 
k
 + 
ch™
] ;

290 
°ïödx
 +
ima_ödx_adju°
 [
byãcode
] ;

292 i‡(
°ïödx
 < 0) stepindx = 0 ;

293 i‡(
°ïödx
 > 88) stepindx = 88 ;

295 
diff
 = 
°ï
 >> 3 ;

296 i‡(
byãcode
 & 1Ë
diff
 +
°ï
 >> 2 ;

297 i‡(
byãcode
 & 2Ë
diff
 +
°ï
 >> 1 ;

298 i‡(
byãcode
 & 4Ë
diff
 +
°ï
 ;

299 i‡(
byãcode
 & 8Ë
diff
 = -diff ;

301 
¥edi˘‹
 +
diff
 ;

303 
pima
->
ßm∂es
 [pima->
ch™√ls
 * 
k
 + 
ch™
] = 
¥edi˘‹
 ;

307 i‡(
cou¡
 < 5)

309 
k
 = 0 ; k < 10 ; k++)

310 
	`¥ötf
 ("% 7d,", 
pima
->
ßm∂es
 [
k
]) ;

311 
	`puts
 ("") ;

315 
	}
}

318 
	$aiff_ima_ícode_block
 (
SF_PRIVATE
 *
psf
, 
IMA_ADPCM_PRIVATE
 *
pima
)

319 { 
ch™
, 
k
, 
°ï
, 
diff
, 
vpdiff
, 
blocködx
, 
ödx
 ;

320 
byãcode
, 
mask
 ;

322 
cou¡
 = 0 ;

323 i‡(0 && 
cou¡
 == 0)

324 { 
pima
->
ßm∂es
 [0] = 0 ;

325 
	`¥ötf
 ("blocksizê: %d\n", 
pima
->
blocksize
) ;

326 
	`¥ötf
 ("pima->°ïödx [0] : %d\n", 
pima
->
°ïödx
 [0]) ;

328 
cou¡
 ++ ;

331 
ch™
 = 0 ; ch™ < 
pima
->
ch™√ls
 ; chan ++)

332 { 
blocködx
 = 
ch™
 * 
pima
->
blocksize
 ;

334 
pima
->
block
 [
blocködx
] = (pima->
ßm∂es
 [
ch™
] >> 8) & 0xFF ;

335 
pima
->
block
 [
blocködx
 + 1] = (pima->
ßm∂es
 [
ch™
] & 0x80Ë+ (pima->
°ïödx
 [chan] & 0x7F) ;

337 
pima
->
¥evious
 [
ch™
] =Öima->
ßm∂es
 [chan] ;

341 
k
 = 
pima
->
ch™√ls
 ; k < (pima->
ßm∂e•îblock
 *Öima->channels) ; k ++)

342 { 
ch™
 = (
pima
->
ch™√ls
 > 1Ë? (
k
 % 2) : 0 ;

344 
diff
 = 
pima
->
ßm∂es
 [
k
] -Öima->
¥evious
 [
ch™
] ;

346 
byãcode
 = 0 ;

347 
°ï
 = 
ima_°ï_size
 [
pima
->
°ïödx
 [
ch™
]] ;

348 
vpdiff
 = 
°ï
 >> 3 ;

349 i‡(
diff
 < 0)

350 { 
byãcode
 = 8 ;

351 
diff
 = -diff ;

353 
mask
 = 4 ;

354 
mask
)

355 { i‡(
diff
 >
°ï
)

356 { 
byãcode
 |
mask
 ;

357 
diff
 -
°ï
 ;

358 
vpdiff
 +
°ï
 ;

360 
°ï
 >>= 1 ;

361 
mask
 >>= 1 ;

364 i‡(
byãcode
 & 8)

365 
pima
->
¥evious
 [
ch™
] -
vpdiff
 ;

367 
pima
->
¥evious
 [
ch™
] +
vpdiff
 ;

369 i‡(
pima
->
¥evious
 [
ch™
] > 32767)

370 
pima
->
¥evious
 [
ch™
] = 32767 ;

371 i‡(
pima
->
¥evious
 [
ch™
] < -32768)

372 
pima
->
¥evious
 [
ch™
] = -32768 ;

374 
pima
->
°ïödx
 [
ch™
] +
ima_ödx_adju°
 [
byãcode
] ;

375 i‡(
pima
->
°ïödx
 [
ch™
] < 0)

376 
pima
->
°ïödx
 [
ch™
] = 0 ;

377 i‡(
pima
->
°ïödx
 [
ch™
] > 88)

378 
pima
->
°ïödx
 [
ch™
] = 88 ;

380 
pima
->
ßm∂es
 [
k
] = 
byãcode
 ;

385 
ch™
 = 0 ; ch™ < 
pima
->
ch™√ls
 ; chan ++)

386 { 
ödx
 = 
pima
->
ch™√ls
 ; indx <Öima->ch™√l†*Öima->
ßm∂e•îblock
 ; indx += 2 *Öima->channels)

387 { 
blocködx
 = 
ch™
 * 
pima
->
blocksize
 + 2 + 
ödx
 / 2 ;

389 i‡(0 && 
cou¡
 ++ < 5)

390 
	`¥ötf
 ("ch™: %d blocködx: %3d indx: %3d\n", 
ch™
, 
blocködx
, 
ödx
) ;

392 
pima
->
block
 [
blocködx
] =Öima->
ßm∂es
 [
ödx
] & 0x0F ;

393 
pima
->
block
 [
blocködx
] |’ima->
ßm∂es
 [
ödx
 +Öima->
ch™√ls
] << 4) & 0xF0 ;

399 i‡((
k
 = 
	`psf_fwrôe
 (
pima
->
block
, 1,Öima->
ch™√ls
 *Öima->
blocksize
, 
psf
)) !=Öima->channels *Öima->blocksize)

400 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög : sh‹àwrôê(%d !%d).\n", 
k
, 
pima
->
ch™√ls
 *Öima->
blocksize
) ;

402 
	`mem£t
 (
pima
->
ßm∂es
, 0,Öima->
ch™√ls
 *Öima->
ßm∂e•îblock
 *  ()) ;

403 
pima
->
ßm∂ecou¡
 = 0 ;

404 
pima
->
blockcou¡
 ++ ;

407 
	}
}

410 
	$wav_w64_ima_decode_block
 (
SF_PRIVATE
 *
psf
, 
IMA_ADPCM_PRIVATE
 *
pima
)

411 { 
ch™
, 
k
, 
cuºít
, 
blocködx
, 
ödx
, 
ödx°¨t
, 
diff
 ;

412 
°ï
, 
byãcode
, 
°ïödx
 [2] ;

414 
pima
->
blockcou¡
 ++ ;

415 
pima
->
ßm∂ecou¡
 = 0 ;

417 i‡(
pima
->
blockcou¡
 >Öima->
blocks
)

418 { 
	`mem£t
 (
pima
->
ßm∂es
, 0,Öima->
ßm∂e•îblock
 *Öima->
ch™√ls
 *  ()) ;

422 i‡((
k
 = 
	`psf_‰ód
 (
pima
->
block
, 1,Öima->
blocksize
, 
psf
)) !=Öima->blocksize)

423 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög : sh‹àªad (%d !%d).\n", 
k
, 
pima
->
blocksize
) ;

427 
ch™
 = 0 ; ch™ < 
pima
->
ch™√ls
 ; chan++)

428 { 
cuºít
 = 
pima
->
block
 [
ch™
*4] | (pima->block [chan*4+1] << 8) ;

429 i‡(
cuºít
 & 0x8000)

430 
cuºít
 -= 0x10000 ;

432 
°ïödx
 [
ch™
] = 
pima
->
block
 [chan*4+2] ;

433 i‡(
°ïödx
 [
ch™
] < 0)

434 
°ïödx
 [
ch™
] = 0 ;

435 i‡(
°ïödx
 [
ch™
] > 88)

436 
°ïödx
 [
ch™
] = 88 ;

438 i‡(
pima
->
block
 [
ch™
*4+3] != 0)

439 
	`psf_log_¥ötf
 (
psf
, "IMA ADPCM synchronisationÉrror.\n") ;

441 
pima
->
ßm∂es
 [
ch™
] = 
cuºít
 ;

449 
blocködx
 = 4 * 
pima
->
ch™√ls
 ;

451 
ödx°¨t
 = 
pima
->
ch™√ls
 ;

452 
blocködx
 < 
pima
->
blocksize
)

453 { 
ch™
 = 0 ; ch™ < 
pima
->
ch™√ls
 ; chan++)

454 { 
ödx
 = 
ödx°¨t
 + 
ch™
 ;

455 
k
 = 0 ; k < 4 ; k++)

456 { 
byãcode
 = 
pima
->
block
 [
blocködx
++] ;

457 
pima
->
ßm∂es
 [
ödx
] = 
byãcode
 & 0x0F ;

458 
ödx
 +
pima
->
ch™√ls
 ;

459 
pima
->
ßm∂es
 [
ödx
] = (
byãcode
 >> 4) & 0x0F ;

460 
ödx
 +
pima
->
ch™√ls
 ;

463 
ödx°¨t
 +8 * 
pima
->
ch™√ls
 ;

468 
k
 = 
pima
->
ch™√ls
 ; k < (pima->
ßm∂e•îblock
 *Öima->channels) ; k ++)

469 { 
ch™
 = (
pima
->
ch™√ls
 > 1Ë? (
k
 % 2) : 0 ;

471 
byãcode
 = 
pima
->
ßm∂es
 [
k
] & 0xF ;

473 
°ï
 = 
ima_°ï_size
 [
°ïödx
 [
ch™
]] ;

474 
cuºít
 = 
pima
->
ßm∂es
 [
k
 -Öima->
ch™√ls
] ;

476 
diff
 = 
°ï
 >> 3 ;

477 i‡(
byãcode
 & 1)

478 
diff
 +
°ï
 >> 2 ;

479 i‡(
byãcode
 & 2)

480 
diff
 +
°ï
 >> 1 ;

481 i‡(
byãcode
 & 4)

482 
diff
 +
°ï
 ;

483 i‡(
byãcode
 & 8)

484 
diff
 = -diff ;

486 
cuºít
 +
diff
 ;

488 i‡(
cuºít
 > 32767)

489 
cuºít
 = 32767 ;

490 i‡(
cuºít
 < -32768)

491 
cuºít
 = -32768 ;

493 
°ïödx
 [
ch™
] +
ima_ödx_adju°
 [
byãcode
] ;

495 i‡(
°ïödx
 [
ch™
] < 0)

496 
°ïödx
 [
ch™
] = 0 ;

497 i‡(
°ïödx
 [
ch™
] > 88)

498 
°ïödx
 [
ch™
] = 88 ;

500 
pima
->
ßm∂es
 [
k
] = 
cuºít
 ;

504 
	}
}

507 
	$wav_w64_ima_ícode_block
 (
SF_PRIVATE
 *
psf
, 
IMA_ADPCM_PRIVATE
 *
pima
)

508 { 
ch™
, 
k
, 
°ï
, 
diff
, 
vpdiff
, 
blocködx
, 
ödx
, 
ödx°¨t
 ;

509 
byãcode
, 
mask
 ;

512 
ch™
 = 0 ; ch™ < 
pima
->
ch™√ls
 ; chan++)

513 { 
pima
->
block
 [
ch™
*4] =Öima->
ßm∂es
 [chan] & 0xFF ;

514 
pima
->
block
 [
ch™
*4+1] = (pima->
ßm∂es
 [chan] >> 8) & 0xFF ;

516 
pima
->
block
 [
ch™
*4+2] =Öima->
°ïödx
 [chan] ;

517 
pima
->
block
 [
ch™
*4+3] = 0 ;

519 
pima
->
¥evious
 [
ch™
] =Öima->
ßm∂es
 [chan] ;

524 
k
 = 
pima
->
ch™√ls
 ; k < (pima->
ßm∂e•îblock
 *Öima->channels) ; k ++)

525 { 
ch™
 = (
pima
->
ch™√ls
 > 1Ë? (
k
 % 2) : 0 ;

527 
diff
 = 
pima
->
ßm∂es
 [
k
] -Öima->
¥evious
 [
ch™
] ;

529 
byãcode
 = 0 ;

530 
°ï
 = 
ima_°ï_size
 [
pima
->
°ïödx
 [
ch™
]] ;

531 
vpdiff
 = 
°ï
 >> 3 ;

532 i‡(
diff
 < 0)

533 { 
byãcode
 = 8 ;

534 
diff
 = -diff ;

536 
mask
 = 4 ;

537 
mask
)

538 { i‡(
diff
 >
°ï
)

539 { 
byãcode
 |
mask
 ;

540 
diff
 -
°ï
 ;

541 
vpdiff
 +
°ï
 ;

543 
°ï
 >>= 1 ;

544 
mask
 >>= 1 ;

547 i‡(
byãcode
 & 8)

548 
pima
->
¥evious
 [
ch™
] -
vpdiff
 ;

550 
pima
->
¥evious
 [
ch™
] +
vpdiff
 ;

552 i‡(
pima
->
¥evious
 [
ch™
] > 32767)

553 
pima
->
¥evious
 [
ch™
] = 32767 ;

554 i‡(
pima
->
¥evious
 [
ch™
] < -32768)

555 
pima
->
¥evious
 [
ch™
] = -32768 ;

557 
pima
->
°ïödx
 [
ch™
] +
ima_ödx_adju°
 [
byãcode
] ;

558 i‡(
pima
->
°ïödx
 [
ch™
] < 0)

559 
pima
->
°ïödx
 [
ch™
] = 0 ;

560 i‡(
pima
->
°ïödx
 [
ch™
] > 88)

561 
pima
->
°ïödx
 [
ch™
] = 88 ;

563 
pima
->
ßm∂es
 [
k
] = 
byãcode
 ;

568 
blocködx
 = 4 * 
pima
->
ch™√ls
 ;

570 
ödx°¨t
 = 
pima
->
ch™√ls
 ;

571 
blocködx
 < 
pima
->
blocksize
)

572 { 
ch™
 = 0 ; ch™ < 
pima
->
ch™√ls
 ; chan++)

573 { 
ödx
 = 
ödx°¨t
 + 
ch™
 ;

574 
k
 = 0 ; k < 4 ; k++)

575 { 
pima
->
block
 [
blocködx
] =Öima->
ßm∂es
 [
ödx
] & 0x0F ;

576 
ödx
 +
pima
->
ch™√ls
 ;

577 
pima
->
block
 [
blocködx
] |’ima->
ßm∂es
 [
ödx
] << 4) & 0xF0 ;

578 
ödx
 +
pima
->
ch™√ls
 ;

579 
blocködx
 ++ ;

582 
ödx°¨t
 +8 * 
pima
->
ch™√ls
 ;

587 i‡((
k
 = 
	`psf_fwrôe
 (
pima
->
block
, 1,Öima->
blocksize
, 
psf
)) !=Öima->blocksize)

588 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög : sh‹àwrôê(%d !%d).\n", 
k
, 
pima
->
blocksize
) ;

590 
	`mem£t
 (
pima
->
ßm∂es
, 0,Öima->
ßm∂e•îblock
 *  ()) ;

591 
pima
->
ßm∂ecou¡
 = 0 ;

592 
pima
->
blockcou¡
 ++ ;

595 
	}
}

598 
	$ima_ªad_block
 (
SF_PRIVATE
 *
psf
, 
IMA_ADPCM_PRIVATE
 *
pima
, *
±r
, 
Àn
)

599 { 
cou¡
, 
tŸÆ
 = 0, 
ödx
 = 0 ;

601 
ödx
 < 
Àn
)

602 { i‡(
pima
->
blockcou¡
 >pima->
blocks
 &&Öima->
ßm∂ecou¡
 >pima->
ßm∂e•îblock
)

603 { 
	`mem£t
 (&(
±r
 [
ödx
]), 0, (
size_t
Ë((
Àn
 - indx) *  ())) ;

604  
tŸÆ
 ;

607 i‡(
pima
->
ßm∂ecou¡
 >pima->
ßm∂e•îblock
)

608 
pima
->
	`decode_block
 (
psf
,Öima) ;

610 
cou¡
 = (
pima
->
ßm∂e•îblock
 -Öima->
ßm∂ecou¡
Ë*Öima->
ch™√ls
 ;

611 
cou¡
 = (
Àn
 - 
ödx
 > count) ? count :Üen - indx ;

613 
	`mem˝y
 (&(
±r
 [
ödx
]), &(
pima
->
ßm∂es
 [pima->
ßm∂ecou¡
 *Öima->
ch™√ls
]), 
cou¡
 *  ()) ;

614 
ödx
 +
cou¡
 ;

615 
pima
->
ßm∂ecou¡
 +
cou¡
 /Öima->
ch™√ls
 ;

616 
tŸÆ
 = 
ödx
 ;

619  
tŸÆ
 ;

620 
	}
}

622 
sf_cou¡_t


623 
	$ima_ªad_s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

624 { 
IMA_ADPCM_PRIVATE
 *
pima
 ;

625 
ªadcou¡
, 
cou¡
 ;

626 
sf_cou¡_t
 
tŸÆ
 = 0 ;

628 i‡(! 
psf
->
codec_d©a
)

630 
pima
 = (
IMA_ADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

632 
Àn
 > 0)

633 { 
ªadcou¡
 = (
Àn
 > 0x10000000) ? 0x10000000 : ()Üen ;

635 
cou¡
 = 
	`ima_ªad_block
 (
psf
, 
pima
, 
±r
, 
ªadcou¡
) ;

637 
tŸÆ
 +
cou¡
 ;

638 
Àn
 -
cou¡
 ;

639 i‡(
cou¡
 !
ªadcou¡
)

643  
tŸÆ
 ;

644 
	}
}

646 
sf_cou¡_t


647 
	$ima_ªad_i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

648 { 
IMA_ADPCM_PRIVATE
 *
pima
 ;

649 *
•å
 ;

650 
k
, 
buf„æí
, 
ªadcou¡
, 
cou¡
 ;

651 
sf_cou¡_t
 
tŸÆ
 = 0 ;

653 i‡(! 
psf
->
codec_d©a
)

655 
pima
 = (
IMA_ADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

657 
•å
 = 
psf
->
u
.
sbuf
 ;

658 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

659 
Àn
 > 0)

660 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen : ()Üen ;

661 
cou¡
 = 
	`ima_ªad_block
 (
psf
, 
pima
, 
•å
, 
ªadcou¡
) ;

662 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

663 
±r
 [
tŸÆ
 + 
k
] = ((Ë
•å
 [k]) << 16 ;

664 
tŸÆ
 +
cou¡
 ;

665 
Àn
 -
ªadcou¡
 ;

666 i‡(
cou¡
 !
ªadcou¡
)

670  
tŸÆ
 ;

671 
	}
}

673 
sf_cou¡_t


674 
	$ima_ªad_f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

675 { 
IMA_ADPCM_PRIVATE
 *
pima
 ;

676 *
•å
 ;

677 
k
, 
buf„æí
, 
ªadcou¡
, 
cou¡
 ;

678 
sf_cou¡_t
 
tŸÆ
 = 0 ;

679 
n‹mÁ˘
 ;

681 i‡(! 
psf
->
codec_d©a
)

683 
pima
 = (
IMA_ADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

685 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? 1.0 / (() 0x8000) : 1.0 ;

687 
•å
 = 
psf
->
u
.
sbuf
 ;

688 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

689 
Àn
 > 0)

690 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen : ()Üen ;

691 
cou¡
 = 
	`ima_ªad_block
 (
psf
, 
pima
, 
•å
, 
ªadcou¡
) ;

692 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

693 
±r
 [
tŸÆ
 + 
k
] = 
n‹mÁ˘
 * (Ë(
•å
 [k]) ;

694 
tŸÆ
 +
cou¡
 ;

695 
Àn
 -
ªadcou¡
 ;

696 i‡(
cou¡
 !
ªadcou¡
)

700  
tŸÆ
 ;

701 
	}
}

703 
sf_cou¡_t


704 
	$ima_ªad_d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

705 { 
IMA_ADPCM_PRIVATE
 *
pima
 ;

706 *
•å
 ;

707 
k
, 
buf„æí
, 
ªadcou¡
, 
cou¡
 ;

708 
sf_cou¡_t
 
tŸÆ
 = 0 ;

709 
n‹mÁ˘
 ;

711 i‡(! 
psf
->
codec_d©a
)

713 
pima
 = (
IMA_ADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

715 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? 1.0 / (() 0x8000) : 1.0 ;

717 
•å
 = 
psf
->
u
.
sbuf
 ;

718 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

719 
Àn
 > 0)

720 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen : ()Üen ;

721 
cou¡
 = 
	`ima_ªad_block
 (
psf
, 
pima
, 
•å
, 
ªadcou¡
) ;

722 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

723 
±r
 [
tŸÆ
 + 
k
] = 
n‹mÁ˘
 * (Ë(
•å
 [k]) ;

724 
tŸÆ
 +
cou¡
 ;

725 
Àn
 -
ªadcou¡
 ;

726 i‡(
cou¡
 !
ªadcou¡
)

730  
tŸÆ
 ;

731 
	}
}

733 
sf_cou¡_t


734 
	$ima_£ek
 (
SF_PRIVATE
 *
psf
, 
mode
, 
sf_cou¡_t
 
off£t
)

735 { 
IMA_ADPCM_PRIVATE
 *
pima
 ;

736 
√wblock
, 
√wßm∂e
 ;

738 i‡(! 
psf
->
codec_d©a
)

740 
pima
 = (
IMA_ADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

742 i‡(
psf
->
d©Æígth
 < 0 ||Ösf->
d©aoff£t
 < 0)

743 { 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

744  
PSF_SEEK_ERROR
 ;

747 i‡(
off£t
 == 0)

748 { 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
, 
SEEK_SET
) ;

749 
pima
->
blockcou¡
 = 0 ;

750 
pima
->
	`decode_block
 (
psf
,Öima) ;

751 
pima
->
ßm∂ecou¡
 = 0 ;

755 i‡(
off£t
 < 0 || off£à> 
pima
->
blocks
 *Öima->
ßm∂e•îblock
)

756 { 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

757  
PSF_SEEK_ERROR
 ;

760 
√wblock
 = 
off£t
 / 
pima
->
ßm∂e•îblock
 ;

761 
√wßm∂e
 = 
off£t
 % 
pima
->
ßm∂e•îblock
 ;

763 i‡(
mode
 =
SFM_READ
)

764 { 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
 + 
√wblock
 * 
pima
->
blocksize
, 
SEEK_SET
) ;

765 
pima
->
blockcou¡
 = 
√wblock
 ;

766 
pima
->
	`decode_block
 (
psf
,Öima) ;

767 
pima
->
ßm∂ecou¡
 = 
√wßm∂e
 ;

771 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

772  
PSF_SEEK_ERROR
 ;

775  
√wblock
 * 
pima
->
ßm∂e•îblock
 + 
√wßm∂e
 ;

776 
	}
}

783 
	$ima_wrôî_öô
 (
SF_PRIVATE
 *
psf
, 
blockÆign
)

784 { 
IMA_ADPCM_PRIVATE
 *
pima
 ;

785 
ßm∂e•îblock
 ;

786 
pimasize
 ;

788 i‡(
psf
->
mode
 !
SFM_WRITE
)

789  
SFE_BAD_MODE_RW
 ;

791 
ßm∂e•îblock
 = 2 * (
blockÆign
 - 4 * 
psf
->
sf
.
ch™√ls
) /Ösf->sf.channels + 1 ;

793 
pimasize
 =  (
IMA_ADPCM_PRIVATE
Ë+ 
blockÆign
 + 3 * 
psf
->
sf
.
ch™√ls
 * 
ßm∂e•îblock
 ;

795 i‡((
pima
 = 
	`ˇŒoc
 (1, 
pimasize
)Ë=
NULL
)

796  
SFE_MALLOC_FAILED
 ;

798 
psf
->
codec_d©a
 = (*Ë
pima
 ;

800 
pima
->
ch™√ls
 = 
psf
->
sf
.channels ;

801 
pima
->
blocksize
 = 
blockÆign
 ;

802 
pima
->
ßm∂e•îblock
 = samplesperblock ;

804 
pima
->
block
 = (*Ëpima->
d©a
 ;

805 
pima
->
ßm∂es
 = (*Ë’ima->
d©a
 + 
blockÆign
) ;

807 
pima
->
ßm∂ecou¡
 = 0 ;

809 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
)

810 { 
SF_FORMAT_WAV
 :

811 
SF_FORMAT_W64
 :

812 
pima
->
ícode_block
 = 
wav_w64_ima_ícode_block
 ;

815 
SF_FORMAT_AIFF
 :

816 
pima
->
ícode_block
 = 
aiff_ima_ícode_block
 ;

820 
	`psf_log_¥ötf
 (
psf
, "ima_reader_init: badÖsf->sf.format\n") ;

821  
SFE_INTERNAL
 ;

825 
psf
->
wrôe_sh‹t
 = 
ima_wrôe_s
 ;

826 
psf
->
wrôe_öt
 = 
ima_wrôe_i
 ;

827 
psf
->
wrôe_Êﬂt
 = 
ima_wrôe_f
 ;

828 
psf
->
wrôe_doubÀ
 = 
ima_wrôe_d
 ;

831 
	}
}

837 
	$ima_wrôe_block
 (
SF_PRIVATE
 *
psf
, 
IMA_ADPCM_PRIVATE
 *
pima
, c⁄° *
±r
, 
Àn
)

838 { 
cou¡
, 
tŸÆ
 = 0, 
ödx
 = 0 ;

840 
ödx
 < 
Àn
)

841 { 
cou¡
 = (
pima
->
ßm∂e•îblock
 -Öima->
ßm∂ecou¡
Ë*Öima->
ch™√ls
 ;

843 i‡(
cou¡
 > 
Àn
 - 
ödx
)

844 
cou¡
 = 
Àn
 - 
ödx
 ;

846 
	`mem˝y
 (&(
pima
->
ßm∂es
 [pima->
ßm∂ecou¡
 *Öima->
ch™√ls
]), &(
±r
 [
tŸÆ
]), 
cou¡
 *  ()) ;

847 
ödx
 +
cou¡
 ;

848 
pima
->
ßm∂ecou¡
 +
cou¡
 /Öima->
ch™√ls
 ;

849 
tŸÆ
 = 
ödx
 ;

851 i‡(
pima
->
ßm∂ecou¡
 >pima->
ßm∂e•îblock
)

852 
pima
->
	`ícode_block
 (
psf
,Öima) ;

855  
tŸÆ
 ;

856 
	}
}

858 
sf_cou¡_t


859 
	$ima_wrôe_s
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

860 { 
IMA_ADPCM_PRIVATE
 *
pima
 ;

861 
wrôecou¡
, 
cou¡
 ;

862 
sf_cou¡_t
 
tŸÆ
 = 0 ;

864 i‡(! 
psf
->
codec_d©a
)

866 
pima
 = (
IMA_ADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

868 
Àn
)

869 { 
wrôecou¡
 = (
Àn
 > 0x10000000) ? 0x10000000 : ()Üen ;

871 
cou¡
 = 
	`ima_wrôe_block
 (
psf
, 
pima
, 
±r
, 
wrôecou¡
) ;

873 
tŸÆ
 +
cou¡
 ;

874 
Àn
 -
cou¡
 ;

875 i‡(
cou¡
 !
wrôecou¡
)

879  
tŸÆ
 ;

880 
	}
}

882 
sf_cou¡_t


883 
	$ima_wrôe_i
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

884 { 
IMA_ADPCM_PRIVATE
 *
pima
 ;

885 *
•å
 ;

886 
k
, 
buf„æí
, 
wrôecou¡
, 
cou¡
 ;

887 
sf_cou¡_t
 
tŸÆ
 = 0 ;

889 i‡(! 
psf
->
codec_d©a
)

891 
pima
 = (
IMA_ADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

893 
•å
 = 
psf
->
u
.
sbuf
 ;

894 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

895 
Àn
 > 0)

896 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen : ()Üen ;

897 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

898 
•å
 [
k
] = 
±r
 [
tŸÆ
 + k] >> 16 ;

899 
cou¡
 = 
	`ima_wrôe_block
 (
psf
, 
pima
, 
•å
, 
wrôecou¡
) ;

900 
tŸÆ
 +
cou¡
 ;

901 
Àn
 -
wrôecou¡
 ;

902 i‡(
cou¡
 !
wrôecou¡
)

906  
tŸÆ
 ;

907 
	}
}

909 
sf_cou¡_t


910 
	$ima_wrôe_f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

911 { 
IMA_ADPCM_PRIVATE
 *
pima
 ;

912 *
•å
 ;

913 
k
, 
buf„æí
, 
wrôecou¡
, 
cou¡
 ;

914 
sf_cou¡_t
 
tŸÆ
 = 0 ;

915 
n‹mÁ˘
 ;

917 i‡(! 
psf
->
codec_d©a
)

919 
pima
 = (
IMA_ADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

921 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? (1.0 * 0x7FFF) : 1.0 ;

923 
•å
 = 
psf
->
u
.
sbuf
 ;

924 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

925 
Àn
 > 0)

926 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen : ()Üen ;

927 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

928 
•å
 [
k
] = 
	`Ãötf
 (
n‹mÁ˘
 * 
±r
 [
tŸÆ
 + k]) ;

929 
cou¡
 = 
	`ima_wrôe_block
 (
psf
, 
pima
, 
•å
, 
wrôecou¡
) ;

930 
tŸÆ
 +
cou¡
 ;

931 
Àn
 -
wrôecou¡
 ;

932 i‡(
cou¡
 !
wrôecou¡
)

936  
tŸÆ
 ;

937 
	}
}

939 
sf_cou¡_t


940 
	$ima_wrôe_d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

941 { 
IMA_ADPCM_PRIVATE
 *
pima
 ;

942 *
•å
 ;

943 
k
, 
buf„æí
, 
wrôecou¡
, 
cou¡
 ;

944 
sf_cou¡_t
 
tŸÆ
 = 0 ;

945 
n‹mÁ˘
 ;

947 i‡(! 
psf
->
codec_d©a
)

949 
pima
 = (
IMA_ADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

951 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? (1.0 * 0x7FFF) : 1.0 ;

953 
•å
 = 
psf
->
u
.
sbuf
 ;

954 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

955 
Àn
 > 0)

956 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen : ()Üen ;

957 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

958 
•å
 [
k
] = 
	`Ãöt
 (
n‹mÁ˘
 * 
±r
 [
tŸÆ
 + k]) ;

959 
cou¡
 = 
	`ima_wrôe_block
 (
psf
, 
pima
, 
•å
, 
wrôecou¡
) ;

960 
tŸÆ
 +
cou¡
 ;

961 
Àn
 -
wrôecou¡
 ;

962 i‡(
cou¡
 !
wrôecou¡
)

966  
tŸÆ
 ;

967 
	}
}

	@libsndfile-1.0.17/src/interleave.c

19 
	~"s„ndün.h
"

21 
	~<°dlib.h
>

23 
	~"¢dfûe.h
"

24 
	~"comm⁄.h
"

26 
	#INTERLEAVE_CHANNELS
 6

	)

29 { 
	mbuf„r
 [
SF_BUFFER_LEN
 /  ()] ;

31 
sf_cou¡_t
 
	mch™√l_Àn
 ;

33 
sf_cou¡_t
 (*
ªad_sh‹t
Ë(
	mSF_PRIVATE
*, *
	m±r
, sf_cou¡_à
	mÀn
) ;

34 
sf_cou¡_t
 (*
ªad_öt
Ë(
	mSF_PRIVATE
*, *
	m±r
, sf_cou¡_à
	mÀn
) ;

35 
sf_cou¡_t
 (*
ªad_Êﬂt
Ë(
	mSF_PRIVATE
*, *
	m±r
, sf_cou¡_à
	mÀn
) ;

36 
sf_cou¡_t
 (*
ªad_doubÀ
Ë(
	mSF_PRIVATE
*, *
	m±r
, sf_cou¡_à
	mÀn
) ;

38 } 
	tINTERLEAVE_DATA
 ;

42 
sf_cou¡_t
 
öãæóve_ªad_sh‹t
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

43 
sf_cou¡_t
 
öãæóve_ªad_öt
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

44 
sf_cou¡_t
 
öãæóve_ªad_Êﬂt
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

45 
sf_cou¡_t
 
öãæóve_ªad_doubÀ
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

47 
sf_cou¡_t
 
öãæóve_£ek
 (
SF_PRIVATE
*, 
mode
, sf_cou¡_à
ßm∂es_‰om_°¨t
) ;

53 
	$öãæóve_öô
 (
SF_PRIVATE
 *
psf
)

54 { 
INTERLEAVE_DATA
 *
pd©a
 ;

56 i‡(
psf
->
mode
 !
SFM_READ
)

57  
SFE_INTERLEAVE_MODE
 ;

59 i‡(
psf
->
öãæóve
)

60 { 
	`psf_log_¥ötf
 (
psf
, "*** Weird,álready have interleave.\n") ;

65 i‡(! (
pd©a
 = 
	`mÆloc
 ( (
INTERLEAVE_DATA
))))

66  
SFE_MALLOC_FAILED
 ;

68 
	`puts
 ("interleave_init") ;

70 
psf
->
öãæóve
 = 
pd©a
 ;

73 
pd©a
->
ªad_sh‹t
 = 
psf
->read_short ;

74 
pd©a
->
ªad_öt
 = 
psf
->read_int ;

75 
pd©a
->
ªad_Êﬂt
 = 
psf
->read_float ;

76 
pd©a
->
ªad_doubÀ
 = 
psf
->read_double ;

78 
pd©a
->
ch™√l_Àn
 = 
psf
->
sf
.
‰ames
 *Ösf->
byãwidth
 ;

81 
psf
->
ªad_sh‹t
 = 
öãæóve_ªad_sh‹t
 ;

82 
psf
->
ªad_öt
 = 
öãæóve_ªad_öt
 ;

83 
psf
->
ªad_Êﬂt
 = 
öãæóve_ªad_Êﬂt
 ;

84 
psf
->
ªad_doubÀ
 = 
öãæóve_ªad_doubÀ
 ;

86 
psf
->
£ek
 = 
öãæóve_£ek
 ;

89 
	}
}

94 
sf_cou¡_t


95 
	$öãæóve_ªad_sh‹t
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

96 { 
INTERLEAVE_DATA
 *
pd©a
 ;

97 
sf_cou¡_t
 
off£t
, 
ãm∂í
 ;

98 
ch™
, 
cou¡
, 
k
 ;

99 *
ö±r
, *
ouçå
 ;

101 i‡(! (
pd©a
 = 
psf
->
öãæóve
))

104 
ö±r
 = (*Ë
pd©a
->
buf„r
 ;

106 
ch™
 = 0 ; ch™ < 
psf
->
sf
.
ch™√ls
 ; chan++)

107 { 
ouçå
 = 
±r
 + 
ch™
 ;

109 
off£t
 = 
psf
->
d©aoff£t
 + 
ch™
 *Ösf->
byãwidth
 *Ösf->
ªad_cuºít
 ;

111 i‡(
	`psf_f£ek
 (
psf
, 
off£t
, 
SEEK_SET
) != offset)

112 { 
psf
->
îr‹
 = 
SFE_INTERLEAVE_SEEK
 ;

116 
ãm∂í
 = 
Àn
 / 
psf
->
sf
.
ch™√ls
 ;

118 
ãm∂í
 > 0)

119 { i‡(
ãm∂í
 > 
	`SIGNED_SIZEOF
 (
pd©a
->
buf„r
) / SIGNED_SIZEOF ())

120 
cou¡
 = 
	`SIGNED_SIZEOF
 (
pd©a
->
buf„r
) / SIGNED_SIZEOF () ;

122 
cou¡
 = (Ë
ãm∂í
 ;

124 i‡(
pd©a
->
	`ªad_sh‹t
 (
psf
, 
ö±r
, 
cou¡
) != count)

125 { 
psf
->
îr‹
 = 
SFE_INTERLEAVE_READ
 ;

129 
k
 = 0 ; k < 
cou¡
 ; k++)

130 { *
ouçå
 = 
ö±r
 [
k
] ;

131 
ouçå
 +
psf
->
sf
.
ch™√ls
 ;

134 
ãm∂í
 -
cou¡
 ;

138  
Àn
 ;

139 
	}
}

141 
sf_cou¡_t


142 
	$öãæóve_ªad_öt
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

143 { 
INTERLEAVE_DATA
 *
pd©a
 ;

144 
sf_cou¡_t
 
off£t
, 
ãm∂í
 ;

145 
ch™
, 
cou¡
, 
k
 ;

146 *
ö±r
, *
ouçå
 ;

148 i‡(! (
pd©a
 = 
psf
->
öãæóve
))

151 
ö±r
 = (*Ë
pd©a
->
buf„r
 ;

153 
ch™
 = 0 ; ch™ < 
psf
->
sf
.
ch™√ls
 ; chan++)

154 { 
ouçå
 = 
±r
 + 
ch™
 ;

156 
off£t
 = 
psf
->
d©aoff£t
 + 
ch™
 *Ösf->
byãwidth
 *Ösf->
ªad_cuºít
 ;

158 i‡(
	`psf_f£ek
 (
psf
, 
off£t
, 
SEEK_SET
) != offset)

159 { 
psf
->
îr‹
 = 
SFE_INTERLEAVE_SEEK
 ;

163 
ãm∂í
 = 
Àn
 / 
psf
->
sf
.
ch™√ls
 ;

165 
ãm∂í
 > 0)

166 { i‡(
ãm∂í
 > 
	`SIGNED_SIZEOF
 (
pd©a
->
buf„r
) / SIGNED_SIZEOF ())

167 
cou¡
 = 
	`SIGNED_SIZEOF
 (
pd©a
->
buf„r
) / SIGNED_SIZEOF () ;

169 
cou¡
 = (Ë
ãm∂í
 ;

171 i‡(
pd©a
->
	`ªad_öt
 (
psf
, 
ö±r
, 
cou¡
) != count)

172 { 
psf
->
îr‹
 = 
SFE_INTERLEAVE_READ
 ;

176 
k
 = 0 ; k < 
cou¡
 ; k++)

177 { *
ouçå
 = 
ö±r
 [
k
] ;

178 
ouçå
 +
psf
->
sf
.
ch™√ls
 ;

181 
ãm∂í
 -
cou¡
 ;

185  
Àn
 ;

186 
	}
}

188 
sf_cou¡_t


189 
	$öãæóve_ªad_Êﬂt
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

190 { 
INTERLEAVE_DATA
 *
pd©a
 ;

191 
sf_cou¡_t
 
off£t
, 
ãm∂í
 ;

192 
ch™
, 
cou¡
, 
k
 ;

193 *
ö±r
, *
ouçå
 ;

195 i‡(! (
pd©a
 = 
psf
->
öãæóve
))

198 
ö±r
 = (*Ë
pd©a
->
buf„r
 ;

200 
ch™
 = 0 ; ch™ < 
psf
->
sf
.
ch™√ls
 ; chan++)

201 { 
ouçå
 = 
±r
 + 
ch™
 ;

203 
off£t
 = 
psf
->
d©aoff£t
 + 
pd©a
->
ch™√l_Àn
 * 
ch™
 +Ösf->
ªad_cuºít
 *Ösf->
byãwidth
 ;

207 i‡(
	`psf_f£ek
 (
psf
, 
off£t
, 
SEEK_SET
) != offset)

208 { 
psf
->
îr‹
 = 
SFE_INTERLEAVE_SEEK
 ;

213 
ãm∂í
 = 
Àn
 / 
psf
->
sf
.
ch™√ls
 ;

215 
ãm∂í
 > 0)

216 { i‡(
ãm∂í
 > 
	`SIGNED_SIZEOF
 (
pd©a
->
buf„r
) / SIGNED_SIZEOF ())

217 
cou¡
 = 
	`SIGNED_SIZEOF
 (
pd©a
->
buf„r
) / SIGNED_SIZEOF () ;

219 
cou¡
 = (Ë
ãm∂í
 ;

221 i‡(
pd©a
->
	`ªad_Êﬂt
 (
psf
, 
ö±r
, 
cou¡
) != count)

222 { 
psf
->
îr‹
 = 
SFE_INTERLEAVE_READ
 ;

227 
k
 = 0 ; k < 
cou¡
 ; k++)

228 { *
ouçå
 = 
ö±r
 [
k
] ;

229 
ouçå
 +
psf
->
sf
.
ch™√ls
 ;

232 
ãm∂í
 -
cou¡
 ;

236  
Àn
 ;

237 
	}
}

239 
sf_cou¡_t


240 
	$öãæóve_ªad_doubÀ
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

241 { 
INTERLEAVE_DATA
 *
pd©a
 ;

242 
sf_cou¡_t
 
off£t
, 
ãm∂í
 ;

243 
ch™
, 
cou¡
, 
k
 ;

244 *
ö±r
, *
ouçå
 ;

246 i‡(! (
pd©a
 = 
psf
->
öãæóve
))

249 
ö±r
 = (*Ë
pd©a
->
buf„r
 ;

251 
ch™
 = 0 ; ch™ < 
psf
->
sf
.
ch™√ls
 ; chan++)

252 { 
ouçå
 = 
±r
 + 
ch™
 ;

254 
off£t
 = 
psf
->
d©aoff£t
 + 
ch™
 *Ösf->
byãwidth
 *Ösf->
ªad_cuºít
 ;

256 i‡(
	`psf_f£ek
 (
psf
, 
off£t
, 
SEEK_SET
) != offset)

257 { 
psf
->
îr‹
 = 
SFE_INTERLEAVE_SEEK
 ;

261 
ãm∂í
 = 
Àn
 / 
psf
->
sf
.
ch™√ls
 ;

263 
ãm∂í
 > 0)

264 { i‡(
ãm∂í
 > 
	`SIGNED_SIZEOF
 (
pd©a
->
buf„r
) / SIGNED_SIZEOF ())

265 
cou¡
 = 
	`SIGNED_SIZEOF
 (
pd©a
->
buf„r
) / SIGNED_SIZEOF () ;

267 
cou¡
 = (Ë
ãm∂í
 ;

269 i‡(
pd©a
->
	`ªad_doubÀ
 (
psf
, 
ö±r
, 
cou¡
) != count)

270 { 
psf
->
îr‹
 = 
SFE_INTERLEAVE_READ
 ;

274 
k
 = 0 ; k < 
cou¡
 ; k++)

275 { *
ouçå
 = 
ö±r
 [
k
] ;

276 
ouçå
 +
psf
->
sf
.
ch™√ls
 ;

279 
ãm∂í
 -
cou¡
 ;

283  
Àn
 ;

284 
	}
}

289 
sf_cou¡_t


290 
	$öãæóve_£ek
 (
SF_PRIVATE
 *
psf
, 
mode
, 
sf_cou¡_t
 
ßm∂es_‰om_°¨t
)

291 { 
psf
 =Ös‡; 
mode
 = mode ;

298  
ßm∂es_‰om_°¨t
 ;

299 
	}
}

	@libsndfile-1.0.17/src/ircam.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<f˙é.h
>

23 
	~<°rög.h
>

24 
	~<˘y≥.h
>

26 
	~"¢dfûe.h
"

27 
	~"s„ndün.h
"

28 
	~"comm⁄.h
"

38 
	#IRCAM_BE_MASK
 (
	`MAKE_MARKER
 (0xFF, 0xFF, 0x00, 0xFF))

	)

39 
	#IRCAM_BE_MARKER
 (
	`MAKE_MARKER
 (0x64, 0xA3, 0x00, 0x00))

	)

41 
	#IRCAM_LE_MASK
 (
	`MAKE_MARKER
 (0xFF, 0x00, 0xFF, 0xFF))

	)

42 
	#IRCAM_LE_MARKER
 (
	`MAKE_MARKER
 (0x00, 0x00, 0xA3, 0x64))

	)

44 
	#IRCAM_02B_MARKER
 (
	`MAKE_MARKER
 (0x64, 0xA3, 0x02, 0x00))

	)

45 
	#IRCAM_03L_MARKER
 (
	`MAKE_MARKER
 (0x64, 0xA3, 0x03, 0x00))

	)

47 
	#IRCAM_DATA_OFFSET
 (1024)

	)

54 { 
	mIRCAM_PCM_16
 = 0x00002,

55 
	mIRCAM_FLOAT
 = 0x00004,

56 
	mIRCAM_ALAW
 = 0x10001,

57 
	mIRCAM_ULAW
 = 0x20001,

58 
	mIRCAM_PCM_32
 = 0x40004

66 
úˇm_˛o£
 (
SF_PRIVATE
 *
psf
) ;

67 
úˇm_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
) ;

68 
úˇm_ªad_hódî
 (
SF_PRIVATE
 *
psf
) ;

70 
gë_ícodög
 (
subf‹m©
) ;

72 c⁄° * 
gë_ícodög_°r
 (
ícodög
) ;

79 
	$úˇm_›í
 (
SF_PRIVATE
 *
psf
)

80 { 
subf‹m©
 ;

81 
îr‹
 = 
SFE_NO_ERROR
 ;

83 i‡(
psf
->
mode
 =
SFM_READ
 || (psf->modê=
SFM_RDWR
 &&Ösf->
fûñígth
 > 0))

84 { i‡((
îr‹
 = 
	`úˇm_ªad_hódî
 (
psf
)))

85  
îr‹
 ;

88 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

90 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

91 { i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_IRCAM
)

92  
SFE_BAD_OPEN_FORMAT
 ;

94 
psf
->
ídün
 =Ösf->
sf
.
f‹m©
 & 
SF_FORMAT_ENDMASK
 ;

95 i‡(
psf
->
ídün
 =0 ||Ösf->ídü¿=
SF_ENDIAN_CPU
)

96 
psf
->
ídün
 = (
CPU_IS_BIG_ENDIAN
Ë? 
SF_ENDIAN_BIG
 : 
SF_ENDIAN_LITTLE
 ;

98 
psf
->
d©aoff£t
 = 
IRCAM_DATA_OFFSET
 ;

100 i‡((
îr‹
 = 
	`úˇm_wrôe_hódî
 (
psf
, 
SF_FALSE
)))

101  
îr‹
 ;

103 
psf
->
wrôe_hódî
 = 
úˇm_wrôe_hódî
 ;

106 
psf
->
c⁄èöî_˛o£
 = 
úˇm_˛o£
 ;

108 
subf‹m©
)

109 { 
SF_FORMAT_ULAW
 :

110 
îr‹
 = 
	`uœw_öô
 (
psf
) ;

113 
SF_FORMAT_ALAW
 :

114 
îr‹
 = 
	`Æaw_öô
 (
psf
) ;

117 
SF_FORMAT_PCM_16
 :

118 
SF_FORMAT_PCM_32
 :

119 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

122 
SF_FORMAT_FLOAT
 :

123 
îr‹
 = 
	`Êﬂt32_öô
 (
psf
) ;

129  
îr‹
 ;

130 
	}
}

136 
	$úˇm_ªad_hódî
 (
SF_PRIVATE
 *
psf
)

137 { 
m¨kî
, 
ícodög
 ;

138 
ßm∂î©e
 ;

139 
îr‹
 = 
SFE_NO_ERROR
 ;

141 
	`psf_böhódî_ªadf
 (
psf
, "ïmf44", 0, &
m¨kî
, &
ßm∂î©e
, &’sf->
sf
.
ch™√ls
), &
ícodög
) ;

143 i‡(((
m¨kî
 & 
IRCAM_BE_MASK
Ë!
IRCAM_BE_MARKER
Ë&& ((m¨kî & 
IRCAM_LE_MASK
Ë!
IRCAM_LE_MARKER
))

144 { 
	`psf_log_¥ötf
 (
psf
, "m¨kî: 0x%X\n", 
m¨kî
) ;

145  
SFE_IRCAM_NO_MARKER
 ;

148 
psf
->
ídün
 = 
SF_ENDIAN_LITTLE
 ;

150 i‡(
psf
->
sf
.
ch™√ls
 > 256)

151 { 
	`psf_böhódî_ªadf
 (
psf
, "Epmf44", 0, &
m¨kî
, &
ßm∂î©e
, &’sf->
sf
.
ch™√ls
), &
ícodög
) ;

154 i‡(
psf
->
sf
.
ch™√ls
 > 256)

155 { 
	`psf_log_¥ötf
 (
psf
, "m¨kî: 0x%X\n", 
m¨kî
) ;

156  
SFE_IRCAM_BAD_CHANNELS
 ;

159 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

162 
	`psf_log_¥ötf
 (
psf
, "m¨kî: 0x%X\n", 
m¨kî
) ;

164 
psf
->
sf
.
ßm∂î©e
 = () samplerate ;

166 
	`psf_log_¥ötf
 (
psf
, " Sample Rate : %d\n"

168 " Encodög : %X => %s\n", 
psf
->
sf
.
ßm∂î©e
,Ösf->sf.
ch™√ls
, 
ícodög
, 
	`gë_ícodög_°r
 (encoding)) ;

170 
ícodög
)

171 { 
IRCAM_PCM_16
 :

172 
psf
->
byãwidth
 = 2 ;

173 
psf
->
blockwidth
 =Ösf->
sf
.
ch™√ls
 *Ösf->
byãwidth
 ;

175 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_IRCAM
 | 
SF_FORMAT_PCM_16
 ;

178 
IRCAM_PCM_32
 :

179 
psf
->
byãwidth
 = 4 ;

180 
psf
->
blockwidth
 =Ösf->
sf
.
ch™√ls
 *Ösf->
byãwidth
 ;

182 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_IRCAM
 | 
SF_FORMAT_PCM_32
 ;

185 
IRCAM_FLOAT
 :

186 
psf
->
byãwidth
 = 4 ;

187 
psf
->
blockwidth
 =Ösf->
sf
.
ch™√ls
 *Ösf->
byãwidth
 ;

189 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_IRCAM
 | 
SF_FORMAT_FLOAT
 ;

192 
IRCAM_ALAW
 :

193 
psf
->
byãwidth
 = 1 ;

194 
psf
->
blockwidth
 =Ösf->
sf
.
ch™√ls
 *Ösf->
byãwidth
 ;

196 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_IRCAM
 | 
SF_FORMAT_ALAW
 ;

199 
IRCAM_ULAW
 :

200 
psf
->
byãwidth
 = 1 ;

201 
psf
->
blockwidth
 =Ösf->
sf
.
ch™√ls
 *Ösf->
byãwidth
 ;

203 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_IRCAM
 | 
SF_FORMAT_ULAW
 ;

207 
îr‹
 = 
SFE_IRCAM_UNKNOWN_FORMAT
 ;

211 i‡(
psf
->
ídün
 =
SF_ENDIAN_BIG
)

212 
psf
->
sf
.
f‹m©
 |
SF_ENDIAN_BIG
 ;

214 
psf
->
sf
.
f‹m©
 |
SF_ENDIAN_LITTLE
 ;

216 i‡(
îr‹
)

217  
îr‹
 ;

219 
psf
->
d©aoff£t
 = 
IRCAM_DATA_OFFSET
 ;

220 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

222 i‡(
psf
->
sf
.
‰ames
 =0 &&Ösf->
blockwidth
)

223 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 /Ösf->
blockwidth
 ;

225 
	`psf_log_¥ötf
 (
psf
, " Sam∂e† : %d\n",Ösf->
sf
.
‰ames
) ;

227 
	`psf_böhódî_ªadf
 (
psf
, "p", 
IRCAM_DATA_OFFSET
) ;

230 
	}
}

233 
	$úˇm_˛o£
 (
SF_PRIVATE
 *
psf
)

235 
	`psf_log_¥ötf
 (
psf
, "close\n") ;

238 
	}
}

241 
	$úˇm_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
)

242 { 
ícodög
 ;

243 
ßm∂î©e
 ;

244 
sf_cou¡_t
 
cuºít
 ;

246 i‡(
psf
->
pùeoff£t
 > 0)

249 
cuºít
 = 
	`psf_·ñl
 (
psf
) ;

251 
ˇlc_Àngth
 = calc_length ;

254 
ícodög
 = 
	`gë_ícodög
 (
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
) ;

256 i‡(
ícodög
 == 0)

257  
SFE_BAD_OPEN_FORMAT
 ;

260 
psf
->
hódî
 [0] = 0 ;

261 
psf
->
hódödex
 = 0 ;

263 i‡(
psf
->
is_pùe
 =
SF_FALSE
)

264 
	`psf_f£ek
 (
psf
, 0, 
SEEK_SET
) ;

266 
ßm∂î©e
 = 
psf
->
sf
.samplerate ;

268 
psf
->
ídün
)

269 { 
SF_ENDIAN_BIG
 :

270 
	`psf_böhódî_wrôef
 (
psf
, "Emf", 
IRCAM_02B_MARKER
, 
ßm∂î©e
) ;

271 
	`psf_böhódî_wrôef
 (
psf
, "E44",Ösf->
sf
.
ch™√ls
, 
ícodög
) ;

274 
SF_ENDIAN_LITTLE
 :

275 
	`psf_böhódî_wrôef
 (
psf
, "emf", 
IRCAM_03L_MARKER
, 
ßm∂î©e
) ;

276 
	`psf_böhódî_wrôef
 (
psf
, "e44",Ösf->
sf
.
ch™√ls
, 
ícodög
) ;

279  :  
SFE_BAD_OPEN_FORMAT
 ;

282 
	`psf_böhódî_wrôef
 (
psf
, "z", (
size_t
Ë(
IRCAM_DATA_OFFSET
 -Ösf->
hódödex
)) ;

285 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

287 i‡(
psf
->
îr‹
)

288  
psf
->
îr‹
 ;

290 i‡(
cuºít
 > 0)

291 
	`psf_f£ek
 (
psf
, 
cuºít
, 
SEEK_SET
) ;

293  
psf
->
îr‹
 ;

294 
	}
}

297 
	$gë_ícodög
 (
subf‹m©
)

298 { 
subf‹m©
)

299 { 
SF_FORMAT_PCM_16
 :  
IRCAM_PCM_16
 ;

300 
SF_FORMAT_PCM_32
 :  
IRCAM_PCM_32
 ;

302 
SF_FORMAT_FLOAT
 :  
IRCAM_FLOAT
 ;

304 
SF_FORMAT_ULAW
 :  
IRCAM_ULAW
 ;

305 
SF_FORMAT_ALAW
 :  
IRCAM_ALAW
 ;

311 
	}
}

314 
	$gë_ícodög_°r
 (
ícodög
)

315 { 
ícodög
)

316 { 
IRCAM_PCM_16
 :  "16 bit PCM" ;

317 
IRCAM_FLOAT
 :  "32 bit float" ;

318 
IRCAM_ALAW
 :  "AÜaw" ;

319 
IRCAM_ULAW
 :  "uÜaw" ;

320 
IRCAM_PCM_32
 :  "32 bit PCM" ;

323 
	}
}

	@libsndfile-1.0.17/src/macbinary3.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dlib.h
>

22 
	~<°rög.h
>

24 
	~"¢dfûe.h
"

25 
	~"s„ndün.h
"

26 
	~"comm⁄.h
"

28 #i‡(
OS_IS_MACOSX
 == 1)

30 
	~<C‹eSîvi˚s.h
>

33 
	$macbö¨y3_›í
 (
SF_PRIVATE
 *
psf
)

35 i‡(
psf
)

39 
	}
}

44 
	$macbö¨y3_›í
 (
SF_PRIVATE
 *
psf
)

46 
psf
 =Ösf ;

48 
	}
}

	@libsndfile-1.0.17/src/macos.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dlib.h
>

22 
	~<°rög.h
>

23 
	~<sys/°©.h
>

25 
	~"¢dfûe.h
"

26 
	~"s„ndün.h
"

27 
	~"comm⁄.h
"

29 
	#STR_MARKER
 
	`MAKE_MARKER
 ('S', 'T', 'R', ' ')

	)

32 
	$macos_guess_fûe_ty≥
 (
SF_PRIVATE
 *
psf
, c⁄° *
fûíame
)

33 { 
r§c_«me
 [1024] ;

34 
°©
 
°©buf
 ;

35 
f‹m©
 ;

37 
psf
 =Ösf ;

39 
	`¢¥ötf
 (
r§c_«me
,  (r§c_«me), "%s/r§c", 
fûíame
) ;

42 i‡(
	`°©
 (
r§c_«me
, &
°©buf
) != 0)

43 { 
	`psf_log_¥ötf
 (
psf
, "NoÑesource fork.\n") ;

47 i‡(
°©buf
.
°_size
 == 0)

48 { 
	`psf_log_¥ötf
 (
psf
, "Have zero sizeÑesource fork.\n") ;

52 
f‹m©
 = 0 ;

54  
f‹m©
 ;

55 
	}
}

	@libsndfile-1.0.17/src/mat4.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<f˙é.h
>

23 
	~<°rög.h
>

24 
	~<˘y≥.h
>

26 
	~"¢dfûe.h
"

27 
	~"s„ndün.h
"

28 
	~"comm⁄.h
"

29 
	~"Êﬂt_ˇ°.h
"

42 
	#MAT4_BE_DOUBLE
 (
	`MAKE_MARKER
 (0, 0, 0x03, 0xE8))

	)

43 
	#MAT4_LE_DOUBLE
 (
	`MAKE_MARKER
 (0, 0, 0, 0))

	)

45 
	#MAT4_BE_FLOAT
 (
	`MAKE_MARKER
 (0, 0, 0x03, 0xF2))

	)

46 
	#MAT4_LE_FLOAT
 (
	`MAKE_MARKER
 (0x0A, 0, 0, 0))

	)

48 
	#MAT4_BE_PCM_32
 (
	`MAKE_MARKER
 (0, 0, 0x03, 0xFC))

	)

49 
	#MAT4_LE_PCM_32
 (
	`MAKE_MARKER
 (0x14, 0, 0, 0))

	)

51 
	#MAT4_BE_PCM_16
 (
	`MAKE_MARKER
 (0, 0, 0x04, 0x06))

	)

52 
	#MAT4_LE_PCM_16
 (
	`MAKE_MARKER
 (0x1E, 0, 0, 0))

	)

55 
	#MAT4_BE_PCM_U8
 (
	`MAKE_MARKER
 (0, 0, 0x04, 0x1A))

	)

56 
	#MAT4_LE_PCM_U8
 (
	`MAKE_MARKER
 (0x32, 0, 0, 0))

	)

62 
m©4_˛o£
 (
SF_PRIVATE
 *
psf
) ;

64 
m©4_f‹m©_to_ícodög
 (
f‹m©
, 
ídün
) ;

66 
m©4_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
) ;

67 
m©4_ªad_hódî
 (
SF_PRIVATE
 *
psf
) ;

69 c⁄° * 
m©4_m¨kî_to_°r
 (
m¨kî
) ;

76 
	$m©4_›í
 (
SF_PRIVATE
 *
psf
)

77 { 
subf‹m©
, 
îr‹
 = 0 ;

79 i‡(
psf
->
mode
 =
SFM_READ
 || (psf->modê=
SFM_RDWR
 &&Ösf->
fûñígth
 > 0))

80 { i‡((
îr‹
 = 
	`m©4_ªad_hódî
 (
psf
)))

81  
îr‹
 ;

84 i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_MAT4
)

85  
SFE_BAD_OPEN_FORMAT
 ;

87 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

89 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

90 { i‡(
psf
->
is_pùe
)

91  
SFE_NO_PIPE_WRITE
 ;

93 
psf
->
ídün
 =Ösf->
sf
.
f‹m©
 & 
SF_FORMAT_ENDMASK
 ;

94 i‡(
CPU_IS_LITTLE_ENDIAN
 && (
psf
->
ídün
 =
SF_ENDIAN_CPU
 ||Ösf->endian == 0))

95 
psf
->
ídün
 = 
SF_ENDIAN_LITTLE
 ;

96 i‡(
CPU_IS_BIG_ENDIAN
 && (
psf
->
ídün
 =
SF_ENDIAN_CPU
 ||Ösf->endian == 0))

97 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

99 i‡((
îr‹
 = 
	`m©4_wrôe_hódî
 (
psf
, 
SF_FALSE
)))

100  
îr‹
 ;

102 
psf
->
wrôe_hódî
 = 
m©4_wrôe_hódî
 ;

105 
psf
->
c⁄èöî_˛o£
 = 
m©4_˛o£
 ;

107 
psf
->
blockwidth
 =Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

109 
subf‹m©
)

110 { 
SF_FORMAT_PCM_16
 :

111 
SF_FORMAT_PCM_32
 :

112 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

115 
SF_FORMAT_FLOAT
 :

116 
îr‹
 = 
	`Êﬂt32_öô
 (
psf
) ;

119 
SF_FORMAT_DOUBLE
 :

120 
îr‹
 = 
	`doubÀ64_öô
 (
psf
) ;

126 i‡(
îr‹
)

127  
îr‹
 ;

129  
îr‹
 ;

130 
	}
}

136 
	$m©4_˛o£
 (
SF_PRIVATE
 *
psf
)

138 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

139 
	`m©4_wrôe_hódî
 (
psf
, 
SF_TRUE
) ;

142 
	}
}

148 
	$m©4_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
)

149 { 
sf_cou¡_t
 
cuºít
 ;

150 
ícodög
 ;

151 
ßm∂î©e
 ;

153 
cuºít
 = 
	`psf_·ñl
 (
psf
) ;

155 i‡(
ˇlc_Àngth
)

156 { 
psf
->
fûñígth
 = 
	`psf_gë_fûñí
 (psf) ;

158 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

159 i‡(
psf
->
d©´nd
)

160 
psf
->
d©Æígth
 -psf->
fûñígth
 -Ösf->
d©´nd
 ;

162 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 / (psf->
byãwidth
 *Ösf->sf.
ch™√ls
) ;

165 
ícodög
 = 
	`m©4_f‹m©_to_ícodög
 (
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
,Ösf->
ídün
) ;

167 i‡(
ícodög
 == -1)

168  
SFE_BAD_OPEN_FORMAT
 ;

171 
psf
->
hódî
 [0] = 0 ;

172 
psf
->
hódödex
 = 0 ;

173 
	`psf_f£ek
 (
psf
, 0, 
SEEK_SET
) ;

176 
ßm∂î©e
 = 
psf
->
sf
.samplerate ;

178 i‡(
psf
->
ídün
 =
SF_ENDIAN_BIG
)

179 { 
	`psf_böhódî_wrôef
 (
psf
, "Em444", 
MAT4_BE_DOUBLE
, 1, 1, 0) ;

180 
	`psf_böhódî_wrôef
 (
psf
, "E4bd", 11, "ßm∂î©e", 
	`make_size_t
 (11), 
ßm∂î©e
) ;

181 
	`psf_böhódî_wrôef
 (
psf
, "tEm484", 
ícodög
,Ösf->
sf
.
ch™√ls
,Ösf->sf.
‰ames
, 0) ;

182 
	`psf_böhódî_wrôef
 (
psf
, "E4b", 9, "waved©a", 
	`make_size_t
 (9)) ;

184 i‡(
psf
->
ídün
 =
SF_ENDIAN_LITTLE
)

185 { 
	`psf_böhódî_wrôef
 (
psf
, "em444", 
MAT4_LE_DOUBLE
, 1, 1, 0) ;

186 
	`psf_böhódî_wrôef
 (
psf
, "e4bd", 11, "ßm∂î©e", 
	`make_size_t
 (11), 
ßm∂î©e
) ;

187 
	`psf_böhódî_wrôef
 (
psf
, "ãm484", 
ícodög
,Ösf->
sf
.
ch™√ls
,Ösf->sf.
‰ames
, 0) ;

188 
	`psf_böhódî_wrôef
 (
psf
, "e4b", 9, "waved©a", 
	`make_size_t
 (9)) ;

191  
SFE_BAD_OPEN_FORMAT
 ;

194 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

196 i‡(
psf
->
îr‹
)

197  
psf
->
îr‹
 ;

199 
psf
->
d©aoff£t
 =Ösf->
hódödex
 ;

201 i‡(
cuºít
 > 0)

202 
	`psf_f£ek
 (
psf
, 
cuºít
, 
SEEK_SET
) ;

204  
psf
->
îr‹
 ;

205 
	}
}

208 
	$m©4_ªad_hódî
 (
SF_PRIVATE
 *
psf
)

209 { 
m¨kî
, 
«mesize
, 
rows
, 
cﬁs
, 
imag
 ;

210 
vÆue
 ;

211 c⁄° *
m¨kî_°r
 ;

212 
«me
 [64] ;

214 
	`psf_böhódî_ªadf
 (
psf
, "pm", 0, &
m¨kî
) ;

217 i‡(
m¨kî
 =
MAT4_BE_DOUBLE
)

218 { 
psf
->
ídün
 =Ösf->
rwf_ídün
 = 
SF_ENDIAN_BIG
 ;

219 
m¨kî_°r
 = "bigÉndian double" ;

221 i‡(
m¨kî
 =
MAT4_LE_DOUBLE
)

222 { 
psf
->
ídün
 =Ösf->
rwf_ídün
 = 
SF_ENDIAN_LITTLE
 ;

223 
m¨kî_°r
 = "littleÉndian double" ;

226  
SFE_UNIMPLEMENTED
 ;

228 
	`psf_log_¥ötf
 (
psf
, "GNU O˘avê2.0 / MATLAB v4.2 f‹m©\nM¨kî : %s\n", 
m¨kî_°r
) ;

230 
	`psf_böhódî_ªadf
 (
psf
, "444", &
rows
, &
cﬁs
, &
imag
) ;

232 
	`psf_log_¥ötf
 (
psf
, " Row† : %d\¿Cﬁ† : %d\¿Imag : %s\n", 
rows
, 
cﬁs
, 
imag
 ? "True" : "False") ;

234 
	`psf_böhódî_ªadf
 (
psf
, "4", &
«mesize
) ;

236 i‡(
«mesize
 >
	`SIGNED_SIZEOF
 (
«me
))

237  
SFE_MAT4_BAD_NAME
 ;

239 
	`psf_böhódî_ªadf
 (
psf
, "b", 
«me
, 
«mesize
) ;

240 
«me
 [
«mesize
] = 0 ;

242 
	`psf_log_¥ötf
 (
psf
, " Namê : %s\n", 
«me
) ;

244 
	`psf_böhódî_ªadf
 (
psf
, "d", &
vÆue
) ;

246 
	`LSF_SNPRINTF
 (
psf
->
u
.
cbuf
,  (psf->u.cbuf), " VÆuê: %f\n", 
vÆue
) ;

247 
	`psf_log_¥ötf
 (
psf
,Ösf->
u
.
cbuf
) ;

249 i‡((
rows
 !1Ë|| (
cﬁs
 != 1))

250  
SFE_MAT4_NO_SAMPLERATE
 ;

252 
psf
->
sf
.
ßm∂î©e
 = 
	`Ãöt
 (
vÆue
) ;

256 
	`psf_böhódî_ªadf
 (
psf
, "m", &
m¨kî
) ;

258 
	`psf_log_¥ötf
 (
psf
, "M¨kî : %s\n", 
	`m©4_m¨kî_to_°r
 (
m¨kî
)) ;

260 
	`psf_böhódî_ªadf
 (
psf
, "444", &
rows
, &
cﬁs
, &
imag
) ;

262 
	`psf_log_¥ötf
 (
psf
, " Row† : %d\¿Cﬁ† : %d\¿Imag : %s\n", 
rows
, 
cﬁs
, 
imag
 ? "True" : "False") ;

264 
	`psf_böhódî_ªadf
 (
psf
, "4", &
«mesize
) ;

266 i‡(
«mesize
 >
	`SIGNED_SIZEOF
 (
«me
))

267  
SFE_MAT4_BAD_NAME
 ;

269 
	`psf_böhódî_ªadf
 (
psf
, "b", 
«me
, 
«mesize
) ;

270 
«me
 [
«mesize
] = 0 ;

272 
	`psf_log_¥ötf
 (
psf
, " Namê : %s\n", 
«me
) ;

274 
psf
->
d©aoff£t
 = 
	`psf_·ñl
 (psf) ;

276 i‡(
rows
 =0 && 
cﬁs
 == 0)

277 { 
	`psf_log_¥ötf
 (
psf
, "*** Error : zero channel count.\n") ;

278  
SFE_MAT4_ZERO_CHANNELS
 ;

281 
psf
->
sf
.
ch™√ls
 = 
rows
 ;

282 
psf
->
sf
.
‰ames
 = 
cﬁs
 ;

284 
psf
->
sf
.
f‹m©
 =Ösf->
ídün
 | 
SF_FORMAT_MAT4
 ;

285 
m¨kî
)

286 { 
MAT4_BE_DOUBLE
 :

287 
MAT4_LE_DOUBLE
 :

288 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_DOUBLE
 ;

289 
psf
->
byãwidth
 = 8 ;

292 
MAT4_BE_FLOAT
 :

293 
MAT4_LE_FLOAT
 :

294 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_FLOAT
 ;

295 
psf
->
byãwidth
 = 4 ;

298 
MAT4_BE_PCM_32
 :

299 
MAT4_LE_PCM_32
 :

300 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_PCM_32
 ;

301 
psf
->
byãwidth
 = 4 ;

304 
MAT4_BE_PCM_16
 :

305 
MAT4_LE_PCM_16
 :

306 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_PCM_16
 ;

307 
psf
->
byãwidth
 = 2 ;

311 
	`psf_log_¥ötf
 (
psf
, "*** Eº‹ : Bad m¨kî %08X\n", 
m¨kî
) ;

312  
SFE_UNIMPLEMENTED
 ;

315 i‡((
psf
->
fûñígth
 -Ösf->
d©aoff£t
Ë<Ösf->
sf
.
ch™√ls
 *Ösf->sf.
‰ames
 *Ösf->
byãwidth
)

316 { 
	`psf_log_¥ötf
 (
psf
, "*** File seemsÅo beÅruncated. %D <--> %D\n",

317 
psf
->
fûñígth
 -Ösf->
d©aoff£t
,Ösf->
sf
.
ch™√ls
 *Ösf->sf.
‰ames
 *Ösf->
byãwidth
) ;

319 i‡((
psf
->
fûñígth
 -Ösf->
d©aoff£t
Ë>Ösf->
sf
.
ch™√ls
 *Ösf->sf.
‰ames
 *Ösf->
byãwidth
)

320 
psf
->
d©´nd
 =Ösf->
d©aoff£t
 + 
rows
 * 
cﬁs
 *Ösf->
byãwidth
 ;

322 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 -Ösf->
d©´nd
 ;

324 
psf
->
sf
.
£˘i⁄s
 = 1 ;

327 
	}
}

330 
	$m©4_f‹m©_to_ícodög
 (
f‹m©
, 
ídün
)

332 
f‹m©
 | 
ídün
)

333 { (
SF_FORMAT_PCM_16
 | 
SF_ENDIAN_BIG
) :

334  
MAT4_BE_PCM_16
 ;

336 (
SF_FORMAT_PCM_16
 | 
SF_ENDIAN_LITTLE
) :

337  
MAT4_LE_PCM_16
 ;

339 (
SF_FORMAT_PCM_32
 | 
SF_ENDIAN_BIG
) :

340  
MAT4_BE_PCM_32
 ;

342 (
SF_FORMAT_PCM_32
 | 
SF_ENDIAN_LITTLE
) :

343  
MAT4_LE_PCM_32
 ;

345 (
SF_FORMAT_FLOAT
 | 
SF_ENDIAN_BIG
) :

346  
MAT4_BE_FLOAT
 ;

348 (
SF_FORMAT_FLOAT
 | 
SF_ENDIAN_LITTLE
) :

349  
MAT4_LE_FLOAT
 ;

351 (
SF_FORMAT_DOUBLE
 | 
SF_ENDIAN_BIG
) :

352  
MAT4_BE_DOUBLE
 ;

354 (
SF_FORMAT_DOUBLE
 | 
SF_ENDIAN_LITTLE
) :

355  
MAT4_LE_DOUBLE
 ;

361 
	}
}

364 
	$m©4_m¨kî_to_°r
 (
m¨kî
)

365 { 
°r
 [32] ;

367 
m¨kî
)

369 
MAT4_BE_PCM_16
 :  "bigÉndian 16 bit PCM" ;

370 
MAT4_LE_PCM_16
 :  "littleÉndian 16 bit PCM" ;

372 
MAT4_BE_PCM_32
 :  "bigÉndian 32 bit PCM" ;

373 
MAT4_LE_PCM_32
 :  "littleÉndian 32 bit PCM" ;

376 
MAT4_BE_FLOAT
 :  "bigÉndian float" ;

377 
MAT4_LE_FLOAT
 :  "bigÉndian float" ;

379 
MAT4_BE_DOUBLE
 :  "bigÉndian double" ;

380 
MAT4_LE_DOUBLE
 :  "littleÉndian double" ;

384 
°r
 [ (str) - 1] = 0 ;

385 
	`LSF_SNPRINTF
 (
°r
,  (°rË- 1, "%08X", 
m¨kî
) ;

386  
°r
 ;

387 
	}
}

	@libsndfile-1.0.17/src/mat5.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<f˙é.h
>

23 
	~<°rög.h
>

24 
	~<˘y≥.h
>

26 
	~"¢dfûe.h
"

27 
	~"s„ndün.h
"

28 
	~"comm⁄.h
"

29 
	~"Êﬂt_ˇ°.h
"

42 
	#MATL_MARKER
 (
	`MAKE_MARKER
 ('M', 'A', 'T', 'L'))

	)

44 
	#IM_MARKER
 (('I' << 8Ë+ 'M')

	)

45 
	#MI_MARKER
 (('M' << 8Ë+ 'I')

	)

52 { 
	mMAT5_TYPE_SCHAR
 = 0x1,

53 
	mMAT5_TYPE_UCHAR
 = 0x2,

54 
	mMAT5_TYPE_INT16
 = 0x3,

55 
	mMAT5_TYPE_UINT16
 = 0x4,

56 
	mMAT5_TYPE_INT32
 = 0x5,

57 
	mMAT5_TYPE_UINT32
 = 0x6,

58 
	mMAT5_TYPE_FLOAT
 = 0x7,

59 
	mMAT5_TYPE_DOUBLE
 = 0x9,

60 
	mMAT5_TYPE_ARRAY
 = 0xE,

62 
	mMAT5_TYPE_COMP_USHORT
 = 0x00020004,

63 
	mMAT5_TYPE_COMP_UINT
 = 0x00040006

67 { 
sf_cou¡_t
 
	msize
 ;

68 
	mrows
, 
	mcﬁs
 ;

69 
	m«me
 [32] ;

70 } 
	tMAT5_MATRIX
 ;

76 
m©5_˛o£
 (
SF_PRIVATE
 *
psf
) ;

78 
m©5_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
) ;

79 
m©5_ªad_hódî
 (
SF_PRIVATE
 *
psf
) ;

86 
	$m©5_›í
 (
SF_PRIVATE
 *
psf
)

87 { 
subf‹m©
, 
îr‹
 = 0 ;

89 i‡(
psf
->
mode
 =
SFM_READ
 || (psf->modê=
SFM_RDWR
 &&Ösf->
fûñígth
 > 0))

90 { i‡((
îr‹
 = 
	`m©5_ªad_hódî
 (
psf
)))

91  
îr‹
 ;

94 i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_MAT5
)

95  
SFE_BAD_OPEN_FORMAT
 ;

97 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

99 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

100 { i‡(
psf
->
is_pùe
)

101  
SFE_NO_PIPE_WRITE
 ;

103 
psf
->
ídün
 =Ösf->
sf
.
f‹m©
 & 
SF_FORMAT_ENDMASK
 ;

104 i‡(
CPU_IS_LITTLE_ENDIAN
 && (
psf
->
ídün
 =
SF_ENDIAN_CPU
 ||Ösf->endian == 0))

105 
psf
->
ídün
 = 
SF_ENDIAN_LITTLE
 ;

106 i‡(
CPU_IS_BIG_ENDIAN
 && (
psf
->
ídün
 =
SF_ENDIAN_CPU
 ||Ösf->endian == 0))

107 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

109 i‡((
îr‹
 = 
	`m©5_wrôe_hódî
 (
psf
, 
SF_FALSE
)))

110  
îr‹
 ;

112 
psf
->
wrôe_hódî
 = 
m©5_wrôe_hódî
 ;

115 
psf
->
c⁄èöî_˛o£
 = 
m©5_˛o£
 ;

117 
psf
->
blockwidth
 =Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

119 
subf‹m©
)

120 { 
SF_FORMAT_PCM_U8
 :

121 
SF_FORMAT_PCM_16
 :

122 
SF_FORMAT_PCM_32
 :

123 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

126 
SF_FORMAT_FLOAT
 :

127 
îr‹
 = 
	`Êﬂt32_öô
 (
psf
) ;

130 
SF_FORMAT_DOUBLE
 :

131 
îr‹
 = 
	`doubÀ64_öô
 (
psf
) ;

137  
îr‹
 ;

138 
	}
}

144 
	$m©5_˛o£
 (
SF_PRIVATE
 *
psf
)

146 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

147 
	`m©5_wrôe_hódî
 (
psf
, 
SF_TRUE
) ;

150 
	}
}

156 
	$m©5_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
)

157 { c⁄° *
fûíame
 = "MATLAB 5.0 MAT-fûe, wrôã¿by " 
PACKAGE
 "-" 
VERSION
 ", " ;

158 c⁄° *
§_«me
 = "samplerate\0\0\0\0\0\0\0\0\0\0\0" ;

159 c⁄° *
wd_«me
 = "wavedata\0" ;

160 
sf_cou¡_t
 
cuºít
, 
d©asize
 ;

161 
ícodög
 ;

163 
cuºít
 = 
	`psf_·ñl
 (
psf
) ;

165 i‡(
ˇlc_Àngth
)

166 { 
	`psf_f£ek
 (
psf
, 0, 
SEEK_END
) ;

167 
psf
->
fûñígth
 = 
	`psf_·ñl
 (psf) ;

168 
	`psf_f£ek
 (
psf
, 0, 
SEEK_SET
) ;

170 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

171 i‡(
psf
->
d©´nd
)

172 
psf
->
d©Æígth
 -psf->
fûñígth
 -Ösf->
d©´nd
 ;

174 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 / (psf->
byãwidth
 *Ösf->sf.
ch™√ls
) ;

177 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
)

178 { 
SF_FORMAT_PCM_U8
 :

179 
ícodög
 = 
MAT5_TYPE_UCHAR
 ;

182 
SF_FORMAT_PCM_16
 :

183 
ícodög
 = 
MAT5_TYPE_INT16
 ;

186 
SF_FORMAT_PCM_32
 :

187 
ícodög
 = 
MAT5_TYPE_INT32
 ;

190 
SF_FORMAT_FLOAT
 :

191 
ícodög
 = 
MAT5_TYPE_FLOAT
 ;

194 
SF_FORMAT_DOUBLE
 :

195 
ícodög
 = 
MAT5_TYPE_DOUBLE
 ;

199  
SFE_BAD_OPEN_FORMAT
 ;

203 
psf
->
hódî
 [0] = 0 ;

204 
psf
->
hódödex
 = 0 ;

205 
	`psf_f£ek
 (
psf
, 0, 
SEEK_SET
) ;

207 
	`psf_gë_d©e_°r
 (
psf
->
u
.
cbuf
,  (psf->u.
scbuf
)) ;

208 
	`psf_böhódî_wrôef
 (
psf
, "bb", 
fûíame
, 
	`°æí
 (fûíame),Ösf->
u
.
cbuf
, strlen (psf->u.cbuf) + 1) ;

210 
	`mem£t
 (
psf
->
u
.
scbuf
, ' ', 124 -Ösf->
hódödex
) ;

211 
	`psf_böhódî_wrôef
 (
psf
, "b",Ösf->
u
.
scbuf
, 
	`make_size_t
 (124 -Ösf->
hódödex
)) ;

213 
psf
->
rwf_ídün
 =Ösf->
ídün
 ;

215 i‡(
psf
->
rwf_ídün
 =
SF_ENDIAN_BIG
)

216 
	`psf_böhódî_wrôef
 (
psf
, "2b", 0x0100, "MI", 
	`make_size_t
 (2)) ;

218 
	`psf_böhódî_wrôef
 (
psf
, "2b", 0x0100, "IM", 
	`make_size_t
 (2)) ;

220 
	`psf_böhódî_wrôef
 (
psf
, "444444", 
MAT5_TYPE_ARRAY
, 64, 
MAT5_TYPE_UINT32
, 8, 6, 0) ;

221 
	`psf_böhódî_wrôef
 (
psf
, "4444", 
MAT5_TYPE_INT32
, 8, 1, 1) ;

222 
	`psf_böhódî_wrôef
 (
psf
, "44b", 
MAT5_TYPE_SCHAR
, 
	`°æí
 (
§_«me
), sr_«me, 
	`make_size_t
 (16)) ;

224 i‡(
psf
->
sf
.
ßm∂î©e
 > 0xFFFF)

225 
	`psf_böhódî_wrôef
 (
psf
, "44", 
MAT5_TYPE_COMP_UINT
,Ösf->
sf
.
ßm∂î©e
) ;

227 { 
ßm∂î©e
 = 
psf
->
sf
.samplerate ;

229 
	`psf_böhódî_wrôef
 (
psf
, "422", 
MAT5_TYPE_COMP_USHORT
, 
ßm∂î©e
, 0) ;

232 
d©asize
 = 
psf
->
sf
.
‰ames
 *Ösf->sf.
ch™√ls
 *Ösf->
byãwidth
 ;

234 
	`psf_böhódî_wrôef
 (
psf
, "t484444", 
MAT5_TYPE_ARRAY
, 
d©asize
 + 64, 
MAT5_TYPE_UINT32
, 8, 6, 0) ;

235 
	`psf_böhódî_wrôef
 (
psf
, "t4448", 
MAT5_TYPE_INT32
, 8,Ösf->
sf
.
ch™√ls
,Ösf->sf.
‰ames
) ;

236 
	`psf_böhódî_wrôef
 (
psf
, "44b", 
MAT5_TYPE_SCHAR
, 
	`°æí
 (
wd_«me
), wd_name, strlen (wd_name)) ;

238 
d©asize
 = 
psf
->
sf
.
‰ames
 *Ösf->sf.
ch™√ls
 *Ösf->
byãwidth
 ;

239 i‡(
d©asize
 > 0x7FFFFFFF)

240 
d©asize
 = 0x7FFFFFFF ;

242 
	`psf_böhódî_wrôef
 (
psf
, "t48", 
ícodög
, 
d©asize
) ;

245 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

247 i‡(
psf
->
îr‹
)

248  
psf
->
îr‹
 ;

250 
psf
->
d©aoff£t
 =Ösf->
hódödex
 ;

252 i‡(
cuºít
 > 0)

253 
	`psf_f£ek
 (
psf
, 
cuºít
, 
SEEK_SET
) ;

255  
psf
->
îr‹
 ;

256 
	}
}

259 
	$m©5_ªad_hódî
 (
SF_PRIVATE
 *
psf
)

260 { 
«me
 [32] ;

261 
vîsi⁄
, 
ídün
 ;

262 
ty≥
, 
size
, 
Êags1
, 
Êags2
, 
rows
, 
cﬁs
 ;

264 
	`psf_böhódî_ªadf
 (
psf
, "pb", 0,Ösf->
u
.
cbuf
, 124) ;

266 
psf
->
u
.
scbuf
 [125] = 0 ;

268 i‡(
	`°æí
 (
psf
->
u
.
cbuf
) >= 124)

269  
SFE_UNIMPLEMENTED
 ;

271 i‡(
	`°r°r
 (
psf
->
u
.
cbuf
, "MATLAB 5.0 MAT-file") ==Ösf->u.cbuf)

272 
	`psf_log_¥ötf
 (
psf
, "%s\n",Ösf->
u
.
scbuf
) ;

275 
	`psf_böhódî_ªadf
 (
psf
, "E22", &
vîsi⁄
, &
ídün
) ;

277 i‡(
ídün
 =
MI_MARKER
)

278 { 
psf
->
ídün
 =Ösf->
rwf_ídün
 = 
SF_ENDIAN_BIG
 ;

279 i‡(
CPU_IS_LITTLE_ENDIAN
Ë
vîsi⁄
 = 
	`ENDSWAP_SHORT
 (version) ;

281 i‡(
ídün
 =
IM_MARKER
)

282 { 
psf
->
ídün
 =Ösf->
rwf_ídün
 = 
SF_ENDIAN_LITTLE
 ;

283 i‡(
CPU_IS_BIG_ENDIAN
Ë
vîsi⁄
 = 
	`ENDSWAP_SHORT
 (version) ;

286  
SFE_MAT5_BAD_ENDIAN
 ;

288 i‡((
CPU_IS_LITTLE_ENDIAN
 && 
ídün
 =
IM_MARKER
) ||

289 (
CPU_IS_BIG_ENDIAN
 && 
ídün
 =
MI_MARKER
))

290 
vîsi⁄
 = 
	`ENDSWAP_SHORT
 (version) ;

292 
	`psf_log_¥ötf
 (
psf
, "Vîsi⁄ : 0x%04X\n", 
vîsi⁄
) ;

293 
	`psf_log_¥ötf
 (
psf
, "Endü¿ : 0x%04X => %s\n", 
ídün
,

294 (
psf
->
ídün
 =
SF_ENDIAN_LITTLE
) ? "Little" : "Big") ;

297 
	`psf_böhódî_ªadf
 (
psf
, "44", &
ty≥
, &
size
) ;

298 
	`psf_log_¥ötf
 (
psf
, "Block\¿Ty≥ : %X Sizê: %d\n", 
ty≥
, 
size
) ;

300 i‡(
ty≥
 !
MAT5_TYPE_ARRAY
)

301  
SFE_MAT5_NO_BLOCK
 ;

303 
	`psf_böhódî_ªadf
 (
psf
, "44", &
ty≥
, &
size
) ;

304 
	`psf_log_¥ötf
 (
psf
, " Ty≥ : %X Sizê: %d\n", 
ty≥
, 
size
) ;

306 i‡(
ty≥
 !
MAT5_TYPE_UINT32
)

307  
SFE_MAT5_NO_BLOCK
 ;

309 
	`psf_böhódî_ªadf
 (
psf
, "44", &
Êags1
, &
Êags2
) ;

310 
	`psf_log_¥ötf
 (
psf
, " Flg1 : %X Flg2 : %d\n", 
Êags1
, 
Êags2
) ;

312 
	`psf_böhódî_ªadf
 (
psf
, "44", &
ty≥
, &
size
) ;

313 
	`psf_log_¥ötf
 (
psf
, " Ty≥ : %X Sizê: %d\n", 
ty≥
, 
size
) ;

315 i‡(
ty≥
 !
MAT5_TYPE_INT32
)

316  
SFE_MAT5_NO_BLOCK
 ;

318 
	`psf_böhódî_ªadf
 (
psf
, "44", &
rows
, &
cﬁs
) ;

319 
	`psf_log_¥ötf
 (
psf
, " Row†: %X Cﬁ†: %d\n", 
rows
, 
cﬁs
) ;

321 i‡(
rows
 !1 || 
cﬁs
 != 1)

322  
SFE_MAT5_SAMPLE_RATE
 ;

324 
	`psf_böhódî_ªadf
 (
psf
, "4", &
ty≥
) ;

326 i‡(
ty≥
 =
MAT5_TYPE_SCHAR
)

327 { 
	`psf_böhódî_ªadf
 (
psf
, "4", &
size
) ;

328 
	`psf_log_¥ötf
 (
psf
, " Ty≥ : %X Sizê: %d\n", 
ty≥
, 
size
) ;

329 i‡(
size
 > 
	`SIGNED_SIZEOF
 (
«me
) - 1)

330 { 
	`psf_log_¥ötf
 (
psf
, "Error : BadÇameÜength.\n") ;

331  
SFE_MAT5_NO_BLOCK
 ;

334 
	`psf_böhódî_ªadf
 (
psf
, "bj", 
«me
, 
size
, (8 - (size % 8)) % 8) ;

335 
«me
 [
size
] = 0 ;

337 i‡((
ty≥
 & 0xFFFFË=
MAT5_TYPE_SCHAR
)

338 { 
size
 = 
ty≥
 >> 16 ;

339 i‡(
size
 > 4)

340 { 
	`psf_log_¥ötf
 (
psf
, "Error : BadÇameÜength.\n") ;

341  
SFE_MAT5_NO_BLOCK
 ;

344 
	`psf_log_¥ötf
 (
psf
, " Ty≥ : %X\n", 
ty≥
) ;

345 
	`psf_böhódî_ªadf
 (
psf
, "4", &
«me
) ;

346 
«me
 [
size
] = 0 ;

349  
SFE_MAT5_NO_BLOCK
 ;

351 
	`psf_log_¥ötf
 (
psf
, " Namê: %s\n", 
«me
) ;

355 
	`psf_böhódî_ªadf
 (
psf
, "44", &
ty≥
, &
size
) ;

357 
ty≥
)

358 { 
MAT5_TYPE_DOUBLE
 :

359 { 
ßm∂î©e
 ;

361 
	`psf_böhódî_ªadf
 (
psf
, "d", &
ßm∂î©e
) ;

362 
	`LSF_SNPRINTF
 (
«me
,  («me), "%f\n", 
ßm∂î©e
) ;

363 
	`psf_log_¥ötf
 (
psf
, " VÆ : %s\n", 
«me
) ;

365 
psf
->
sf
.
ßm∂î©e
 = 
	`Ãöt
 (samplerate) ;

369 
MAT5_TYPE_COMP_USHORT
 :

370 { 
ßm∂î©e
 ;

372 
	`psf_böhódî_ªadf
 (
psf
, "j2j", -4, &
ßm∂î©e
, 2) ;

373 
	`psf_log_¥ötf
 (
psf
, " VÆ : %u\n", 
ßm∂î©e
) ;

374 
psf
->
sf
.
ßm∂î©e
 = samplerate ;

378 
MAT5_TYPE_COMP_UINT
 :

379 
	`psf_log_¥ötf
 (
psf
, " VÆ : %u\n", 
size
) ;

380 
psf
->
sf
.
ßm∂î©e
 = 
size
 ;

384 
	`psf_log_¥ötf
 (
psf
, " Ty≥ : %X Sizê: %d ***\n", 
ty≥
, 
size
) ;

385  
SFE_MAT5_SAMPLE_RATE
 ;

391 
	`psf_böhódî_ªadf
 (
psf
, "44", &
ty≥
, &
size
) ;

392 
	`psf_log_¥ötf
 (
psf
, " Ty≥ : %X Sizê: %d\n", 
ty≥
, 
size
) ;

394 i‡(
ty≥
 !
MAT5_TYPE_ARRAY
)

395  
SFE_MAT5_NO_BLOCK
 ;

397 
	`psf_böhódî_ªadf
 (
psf
, "44", &
ty≥
, &
size
) ;

398 
	`psf_log_¥ötf
 (
psf
, " Ty≥ : %X Sizê: %d\n", 
ty≥
, 
size
) ;

400 i‡(
ty≥
 !
MAT5_TYPE_UINT32
)

401  
SFE_MAT5_NO_BLOCK
 ;

403 
	`psf_böhódî_ªadf
 (
psf
, "44", &
Êags1
, &
Êags2
) ;

404 
	`psf_log_¥ötf
 (
psf
, " Flg1 : %X Flg2 : %d\n", 
Êags1
, 
Êags2
) ;

406 
	`psf_böhódî_ªadf
 (
psf
, "44", &
ty≥
, &
size
) ;

407 
	`psf_log_¥ötf
 (
psf
, " Ty≥ : %X Sizê: %d\n", 
ty≥
, 
size
) ;

409 i‡(
ty≥
 !
MAT5_TYPE_INT32
)

410  
SFE_MAT5_NO_BLOCK
 ;

412 
	`psf_böhódî_ªadf
 (
psf
, "44", &
rows
, &
cﬁs
) ;

413 
	`psf_log_¥ötf
 (
psf
, " Row†: %X Cﬁ†: %d\n", 
rows
, 
cﬁs
) ;

415 
	`psf_böhódî_ªadf
 (
psf
, "4", &
ty≥
) ;

417 i‡(
ty≥
 =
MAT5_TYPE_SCHAR
)

418 { 
	`psf_böhódî_ªadf
 (
psf
, "4", &
size
) ;

419 
	`psf_log_¥ötf
 (
psf
, " Ty≥ : %X Sizê: %d\n", 
ty≥
, 
size
) ;

420 i‡(
size
 > 
	`SIGNED_SIZEOF
 (
«me
) - 1)

421 { 
	`psf_log_¥ötf
 (
psf
, "Error : BadÇameÜength.\n") ;

422  
SFE_MAT5_NO_BLOCK
 ;

425 
	`psf_böhódî_ªadf
 (
psf
, "bj", 
«me
, 
size
, (8 - (size % 8)) % 8) ;

426 
«me
 [
size
] = 0 ;

428 i‡((
ty≥
 & 0xFFFFË=
MAT5_TYPE_SCHAR
)

429 { 
size
 = 
ty≥
 >> 16 ;

430 i‡(
size
 > 4)

431 { 
	`psf_log_¥ötf
 (
psf
, "Error : BadÇameÜength.\n") ;

432  
SFE_MAT5_NO_BLOCK
 ;

435 
	`psf_log_¥ötf
 (
psf
, " Ty≥ : %X\n", 
ty≥
) ;

436 
	`psf_böhódî_ªadf
 (
psf
, "4", &
«me
) ;

437 
«me
 [
size
] = 0 ;

440  
SFE_MAT5_NO_BLOCK
 ;

442 
	`psf_log_¥ötf
 (
psf
, " Namê: %s\n", 
«me
) ;

444 
	`psf_böhódî_ªadf
 (
psf
, "44", &
ty≥
, &
size
) ;

445 
	`psf_log_¥ötf
 (
psf
, " Ty≥ : %X Sizê: %d\n", 
ty≥
, 
size
) ;

449 i‡(
rows
 =0 && 
cﬁs
 == 0)

450 { 
	`psf_log_¥ötf
 (
psf
, "*** Error : zero channel count.\n") ;

451  
SFE_MAT5_ZERO_CHANNELS
 ;

454 
psf
->
sf
.
ch™√ls
 = 
rows
 ;

455 
psf
->
sf
.
‰ames
 = 
cﬁs
 ;

457 
psf
->
sf
.
f‹m©
 =Ösf->
ídün
 | 
SF_FORMAT_MAT5
 ;

459 
ty≥
)

460 { 
MAT5_TYPE_DOUBLE
 :

461 
	`psf_log_¥ötf
 (
psf
, "DataÅype : double\n") ;

462 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_DOUBLE
 ;

463 
psf
->
byãwidth
 = 8 ;

466 
MAT5_TYPE_FLOAT
 :

467 
	`psf_log_¥ötf
 (
psf
, "DataÅype : float\n") ;

468 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_FLOAT
 ;

469 
psf
->
byãwidth
 = 4 ;

472 
MAT5_TYPE_INT32
 :

473 
	`psf_log_¥ötf
 (
psf
, "DataÅype : 32 bit PCM\n") ;

474 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_PCM_32
 ;

475 
psf
->
byãwidth
 = 4 ;

478 
MAT5_TYPE_INT16
 :

479 
	`psf_log_¥ötf
 (
psf
, "DataÅype : 16 bit PCM\n") ;

480 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_PCM_16
 ;

481 
psf
->
byãwidth
 = 2 ;

484 
MAT5_TYPE_UCHAR
 :

485 
	`psf_log_¥ötf
 (
psf
, "DataÅype : unsigned 8 bit PCM\n") ;

486 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_PCM_U8
 ;

487 
psf
->
byãwidth
 = 1 ;

491 
	`psf_log_¥ötf
 (
psf
, "*** Eº‹ : Bad m¨kî %08X\n", 
ty≥
) ;

492  
SFE_UNIMPLEMENTED
 ;

495 
psf
->
d©aoff£t
 = 
	`psf_·ñl
 (psf) ;

496 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

499 
	}
}

	@libsndfile-1.0.17/src/ms_adpcm.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

25 
	~"¢dfûe.h
"

26 
	~"s„ndün.h
"

27 
	~"Êﬂt_ˇ°.h
"

28 
	~"comm⁄.h
"

29 
	~"wav_w64.h
"

33 
	#RIFF_MARKER
 (
	`MAKE_MARKER
 ('R', 'I', 'F', 'F'))

	)

34 
	#WAVE_MARKER
 (
	`MAKE_MARKER
 ('W', 'A', 'V', 'E'))

	)

35 
	#fmt_MARKER
 (
	`MAKE_MARKER
 ('f', 'm', 't', ' '))

	)

36 
	#Á˘_MARKER
 (
	`MAKE_MARKER
 ('f', 'a', 'c', 't'))

	)

37 
	#d©a_MARKER
 (
	`MAKE_MARKER
 ('d', 'a', 't', 'a'))

	)

39 
	#WAVE_FORMAT_MS_ADPCM
 0x0002

	)

42 { 
	mch™√ls
, 
	mblocksize
, 
	mßm∂e•îblock
, 
	mblocks
, 
	md©¨emaöög
 ;

43 
	mblockcou¡
 ;

44 
sf_cou¡_t
 
	mßm∂ecou¡
 ;

45 *
	mßm∂es
 ;

46 *
	mblock
 ;

47 #i‡
HAVE_FLEXIBLE_ARRAY


48 
	mdummyd©a
 [] ;

50 
	mdummyd©a
 [0] ;

52 } 
	tMSADPCM_PRIVATE
 ;

58 
	gAd≠èti⁄TabÀ
 [] =

67 
	gAd≠tC€ff1
 [
MSADPCM_ADAPT_COEFF_COUNT
] =

71 
	gAd≠tC€ff2
 [
MSADPCM_ADAPT_COEFF_COUNT
] =

104 
mßdpcm_decode_block
 (
SF_PRIVATE
 *
psf
, 
MSADPCM_PRIVATE
 *
pms
) ;

105 
sf_cou¡_t
 
mßdpcm_ªad_block
 (
SF_PRIVATE
 *
psf
, 
MSADPCM_PRIVATE
 *
pms
, *
±r
, 
Àn
) ;

107 
mßdpcm_ícode_block
 (
SF_PRIVATE
 *
psf
, 
MSADPCM_PRIVATE
 *
pms
) ;

108 
sf_cou¡_t
 
mßdpcm_wrôe_block
 (
SF_PRIVATE
 *
psf
, 
MSADPCM_PRIVATE
 *
pms
, c⁄° *
±r
, 
Àn
) ;

110 
sf_cou¡_t
 
mßdpcm_ªad_s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

111 
sf_cou¡_t
 
mßdpcm_ªad_i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

112 
sf_cou¡_t
 
mßdpcm_ªad_f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

113 
sf_cou¡_t
 
mßdpcm_ªad_d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

115 
sf_cou¡_t
 
mßdpcm_wrôe_s
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

116 
sf_cou¡_t
 
mßdpcm_wrôe_i
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

117 
sf_cou¡_t
 
mßdpcm_wrôe_f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

118 
sf_cou¡_t
 
mßdpcm_wrôe_d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

120 
sf_cou¡_t
 
mßdpcm_£ek
 (
SF_PRIVATE
 *
psf
, 
mode
, sf_cou¡_à
off£t
) ;

121 
mßdpcm_˛o£
 (
SF_PRIVATE
 *
psf
) ;

123 
choo£_¥edi˘‹
 (
ch™√ls
, *
d©a
, *
b¥ed
, *
idñè
) ;

130 
	$wav_w64_mßdpcm_öô
 (
SF_PRIVATE
 *
psf
, 
blockÆign
, 
ßm∂e•îblock
)

131 { 
MSADPCM_PRIVATE
 *
pms
 ;

132 
pmssize
 ;

133 
cou¡
 ;

135 i‡(
psf
->
codec_d©a
 !
NULL
)

136 { 
	`psf_log_¥ötf
 (
psf
, "***Ösf->codec_data isÇot NULL.\n") ;

137  
SFE_INTERNAL
 ;

140 i‡(
psf
->
mode
 =
SFM_WRITE
)

141 
ßm∂e•îblock
 = 2 + 2 * (
blockÆign
 - 7 * 
psf
->
sf
.
ch™√ls
) /Ösf->sf.channels ;

143 
pmssize
 =  (
MSADPCM_PRIVATE
Ë+ 
blockÆign
 + 3 * 
psf
->
sf
.
ch™√ls
 * 
ßm∂e•îblock
 ;

145 i‡(! (
psf
->
codec_d©a
 = 
	`mÆloc
 (
pmssize
)))

146  
SFE_MALLOC_FAILED
 ;

147 
pms
 = (
MSADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

148 
	`mem£t
 (
pms
, 0, 
pmssize
) ;

150 
pms
->
ßm∂es
 =Öms->
dummyd©a
 ;

151 
pms
->
block
 = (*Ë’ms->
dummyd©a
 + 
psf
->
sf
.
ch™√ls
 * 
ßm∂e•îblock
) ;

153 
pms
->
ch™√ls
 = 
psf
->
sf
.channels ;

154 
pms
->
blocksize
 = 
blockÆign
 ;

155 
pms
->
ßm∂e•îblock
 = samplesperblock ;

157 i‡(
psf
->
mode
 =
SFM_READ
)

158 { 
pms
->
d©¨emaöög
 = 
psf
->
d©Æígth
 ;

160 i‡(
psf
->
d©Æígth
 % 
pms
->
blocksize
)

161 
pms
->
blocks
 = 
psf
->
d©Æígth
 /Öms->
blocksize
 + 1 ;

163 
pms
->
blocks
 = 
psf
->
d©Æígth
 /Öms->
blocksize
 ;

165 
cou¡
 = 2 * (
pms
->
blocksize
 - 6 *Öms->
ch™√ls
) /Öms->channels ;

166 i‡(
pms
->
ßm∂e•îblock
 !
cou¡
)

167 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög : sam∂e•îblock shoud bê%d.\n", 
cou¡
) ;

169 
psf
->
sf
.
‰ames
 = (psf->
d©Æígth
 / 
pms
->
blocksize
Ë*Öms->
ßm∂e•îblock
 ;

171 
	`psf_log_¥ötf
 (
psf
, " bpred idelta\n") ;

173 
	`mßdpcm_decode_block
 (
psf
, 
pms
) ;

175 
psf
->
ªad_sh‹t
 = 
mßdpcm_ªad_s
 ;

176 
psf
->
ªad_öt
 = 
mßdpcm_ªad_i
 ;

177 
psf
->
ªad_Êﬂt
 = 
mßdpcm_ªad_f
 ;

178 
psf
->
ªad_doubÀ
 = 
mßdpcm_ªad_d
 ;

181 i‡(
psf
->
mode
 =
SFM_WRITE
)

182 { 
pms
->
ßm∂es
 =Öms->
dummyd©a
 ;

184 
pms
->
ßm∂ecou¡
 = 0 ;

186 
psf
->
wrôe_sh‹t
 = 
mßdpcm_wrôe_s
 ;

187 
psf
->
wrôe_öt
 = 
mßdpcm_wrôe_i
 ;

188 
psf
->
wrôe_Êﬂt
 = 
mßdpcm_wrôe_f
 ;

189 
psf
->
wrôe_doubÀ
 = 
mßdpcm_wrôe_d
 ;

192 
psf
->
codec_˛o£
 = 
mßdpcm_˛o£
 ;

193 
psf
->
£ek
 = 
mßdpcm_£ek
 ;

196 
	}
}

199 
	$mßdpcm_decode_block
 (
SF_PRIVATE
 *
psf
, 
MSADPCM_PRIVATE
 *
pms
)

200 { 
ch™
, 
k
, 
blocködx
, 
ßm∂eödx
 ;

201 
byãcode
, 
b¥ed
 [2], 
ch™_idñè
 [2] ;

203 
¥edi˘
 ;

204 
cuºít
 ;

205 
idñè
 ;

207 
pms
->
blockcou¡
 ++ ;

208 
pms
->
ßm∂ecou¡
 = 0 ;

210 i‡(
pms
->
blockcou¡
 >Öms->
blocks
)

211 { 
	`mem£t
 (
pms
->
ßm∂es
, 0,Öms->
ßm∂e•îblock
 *Öms->
ch™√ls
) ;

215 i‡((
k
 = 
	`psf_‰ód
 (
pms
->
block
, 1,Öms->
blocksize
, 
psf
)) !=Öms->blocksize)

216 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög : sh‹àªad (%d !%d).\n", 
k
, 
pms
->
blocksize
) ;

220 i‡(
pms
->
ch™√ls
 == 1)

221 { 
b¥ed
 [0] = 
pms
->
block
 [0] ;

223 i‡(
b¥ed
 [0] >= 7)

224 
	`psf_log_¥ötf
 (
psf
, "MS ADPCM synchr⁄ißti⁄Éº‹ (%d).\n", 
b¥ed
 [0]) ;

226 
ch™_idñè
 [0] = 
pms
->
block
 [1] | (pms->block [2] << 8) ;

227 
ch™_idñè
 [1] = 0 ;

229 
	`psf_log_¥ötf
 (
psf
, "(%dË(%d)\n", 
b¥ed
 [0], 
ch™_idñè
 [0]) ;

231 
pms
->
ßm∂es
 [1] =Öms->
block
 [3] | (pms->block [4] << 8) ;

232 
pms
->
ßm∂es
 [0] =Öms->
block
 [5] | (pms->block [6] << 8) ;

233 
blocködx
 = 7 ;

236 { 
b¥ed
 [0] = 
pms
->
block
 [0] ;

237 
b¥ed
 [1] = 
pms
->
block
 [1] ;

239 i‡(
b¥ed
 [0] >= 7 || bpred [1] >= 7)

240 
	`psf_log_¥ötf
 (
psf
, "MS ADPCM synchr⁄ißti⁄Éº‹ (%d %d).\n", 
b¥ed
 [0], bpred [1]) ;

242 
ch™_idñè
 [0] = 
pms
->
block
 [2] | (pms->block [3] << 8) ;

243 
ch™_idñè
 [1] = 
pms
->
block
 [4] | (pms->block [5] << 8) ;

245 
	`psf_log_¥ötf
 (
psf
, "(%d, %dË(%d, %d)\n", 
b¥ed
 [0], b¥ed [1], 
ch™_idñè
 [0], chan_idelta [1]) ;

247 
pms
->
ßm∂es
 [2] =Öms->
block
 [6] | (pms->block [7] << 8) ;

248 
pms
->
ßm∂es
 [3] =Öms->
block
 [8] | (pms->block [9] << 8) ;

250 
pms
->
ßm∂es
 [0] =Öms->
block
 [10] | (pms->block [11] << 8) ;

251 
pms
->
ßm∂es
 [1] =Öms->
block
 [12] | (pms->block [13] << 8) ;

253 
blocködx
 = 14 ;

271 
ßm∂eödx
 = 2 * 
pms
->
ch™√ls
 ;

272 
blocködx
 < 
pms
->
blocksize
)

273 { 
byãcode
 = 
pms
->
block
 [
blocködx
++] ;

274 
pms
->
ßm∂es
 [
ßm∂eödx
++] = (
byãcode
 >> 4) & 0x0F ;

275 
pms
->
ßm∂es
 [
ßm∂eödx
++] = 
byãcode
 & 0x0F ;

280 
k
 = 2 * 
pms
->
ch™√ls
 ; k < (pms->
ßm∂e•îblock
 *Öms->channels) ; k ++)

281 { 
ch™
 = (
pms
->
ch™√ls
 > 1Ë? (
k
 % 2) : 0 ;

283 
byãcode
 = 
pms
->
ßm∂es
 [
k
] & 0xF ;

286 
idñè
 = 
ch™_idñè
 [
ch™
] ;

287 
ch™_idñè
 [
ch™
] = (
Ad≠èti⁄TabÀ
 [
byãcode
] * 
idñè
) >> 8 ;

288 i‡(
ch™_idñè
 [
ch™
] < 16)

289 
ch™_idñè
 [
ch™
] = 16 ;

290 i‡(
byãcode
 & 0x8)

291 
byãcode
 -= 0x10 ;

293 
¥edi˘
 = ((
pms
->
ßm∂es
 [
k
 -Öms->
ch™√ls
] * 
Ad≠tC€ff1
 [
b¥ed
 [
ch™
]])

294 + (
pms
->
ßm∂es
 [
k
 - 2 *Öms->
ch™√ls
] * 
Ad≠tC€ff2
 [
b¥ed
 [
ch™
]])) >> 8 ;

295 
cuºít
 = (
byãcode
 * 
idñè
Ë+ 
¥edi˘
 ;

297 i‡(
cuºít
 > 32767)

298 
cuºít
 = 32767 ;

299 i‡(
cuºít
 < -32768)

300 
cuºít
 = -32768 ;

302 
pms
->
ßm∂es
 [
k
] = 
cuºít
 ;

306 
	}
}

308 
sf_cou¡_t


309 
	$mßdpcm_ªad_block
 (
SF_PRIVATE
 *
psf
, 
MSADPCM_PRIVATE
 *
pms
, *
±r
, 
Àn
)

310 { 
cou¡
, 
tŸÆ
 = 0, 
ödx
 = 0 ;

312 
ödx
 < 
Àn
)

313 { i‡(
pms
->
blockcou¡
 >pms->
blocks
 &&Öms->
ßm∂ecou¡
 >pms->
ßm∂e•îblock
)

314 { 
	`mem£t
 (&(
±r
 [
ödx
]), 0, (
size_t
Ë((
Àn
 - indx) *  ())) ;

315  
tŸÆ
 ;

318 i‡(
pms
->
ßm∂ecou¡
 >pms->
ßm∂e•îblock
)

319 
	`mßdpcm_decode_block
 (
psf
, 
pms
) ;

321 
cou¡
 = (
pms
->
ßm∂e•îblock
 -Öms->
ßm∂ecou¡
Ë*Öms->
ch™√ls
 ;

322 
cou¡
 = (
Àn
 - 
ödx
 > count) ? count :Üen - indx ;

324 
	`mem˝y
 (&(
±r
 [
ödx
]), &(
pms
->
ßm∂es
 [pms->
ßm∂ecou¡
 *Öms->
ch™√ls
]), 
cou¡
 *  ()) ;

325 
ödx
 +
cou¡
 ;

326 
pms
->
ßm∂ecou¡
 +
cou¡
 /Öms->
ch™√ls
 ;

327 
tŸÆ
 = 
ödx
 ;

330  
tŸÆ
 ;

331 
	}
}

333 
sf_cou¡_t


334 
	$mßdpcm_ªad_s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

335 { 
MSADPCM_PRIVATE
 *
pms
 ;

336 
ªadcou¡
, 
cou¡
 ;

337 
sf_cou¡_t
 
tŸÆ
 = 0 ;

339 i‡(! 
psf
->
codec_d©a
)

341 
pms
 = (
MSADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

343 
Àn
 > 0)

344 { 
ªadcou¡
 = (
Àn
 > 0x10000000) ? 0x10000000 : ()Üen ;

346 
cou¡
 = 
	`mßdpcm_ªad_block
 (
psf
, 
pms
, 
±r
, 
ªadcou¡
) ;

348 
tŸÆ
 +
cou¡
 ;

349 
Àn
 -
cou¡
 ;

350 i‡(
cou¡
 !
ªadcou¡
)

354  
tŸÆ
 ;

355 
	}
}

357 
sf_cou¡_t


358 
	$mßdpcm_ªad_i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

359 { 
MSADPCM_PRIVATE
 *
pms
 ;

360 *
•å
 ;

361 
k
, 
buf„æí
, 
ªadcou¡
 = 0, 
cou¡
 ;

362 
sf_cou¡_t
 
tŸÆ
 = 0 ;

364 i‡(! 
psf
->
codec_d©a
)

366 
pms
 = (
MSADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

368 
•å
 = 
psf
->
u
.
sbuf
 ;

369 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

370 
Àn
 > 0)

371 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

372 
cou¡
 = 
	`mßdpcm_ªad_block
 (
psf
, 
pms
, 
•å
, 
ªadcou¡
) ;

373 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

374 
±r
 [
tŸÆ
 + 
k
] = 
•å
 [k] << 16 ;

375 
tŸÆ
 +
cou¡
 ;

376 
Àn
 -
ªadcou¡
 ;

377 i‡(
cou¡
 !
ªadcou¡
)

380  
tŸÆ
 ;

381 
	}
}

383 
sf_cou¡_t


384 
	$mßdpcm_ªad_f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

385 { 
MSADPCM_PRIVATE
 *
pms
 ;

386 *
•å
 ;

387 
k
, 
buf„æí
, 
ªadcou¡
 = 0, 
cou¡
 ;

388 
sf_cou¡_t
 
tŸÆ
 = 0 ;

389 
n‹mÁ˘
 ;

391 i‡(! 
psf
->
codec_d©a
)

393 
pms
 = (
MSADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

395 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? 1.0 / (() 0x8000) : 1.0 ;

396 
•å
 = 
psf
->
u
.
sbuf
 ;

397 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

398 
Àn
 > 0)

399 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

400 
cou¡
 = 
	`mßdpcm_ªad_block
 (
psf
, 
pms
, 
•å
, 
ªadcou¡
) ;

401 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

402 
±r
 [
tŸÆ
 + 
k
] = 
n‹mÁ˘
 * (Ë(
•å
 [k]) ;

403 
tŸÆ
 +
cou¡
 ;

404 
Àn
 -
ªadcou¡
 ;

405 i‡(
cou¡
 !
ªadcou¡
)

408  
tŸÆ
 ;

409 
	}
}

411 
sf_cou¡_t


412 
	$mßdpcm_ªad_d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

413 { 
MSADPCM_PRIVATE
 *
pms
 ;

414 *
•å
 ;

415 
k
, 
buf„æí
, 
ªadcou¡
 = 0, 
cou¡
 ;

416 
sf_cou¡_t
 
tŸÆ
 = 0 ;

417 
n‹mÁ˘
 ;

419 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? 1.0 / (() 0x8000) : 1.0 ;

421 i‡(! 
psf
->
codec_d©a
)

423 
pms
 = (
MSADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

425 
•å
 = 
psf
->
u
.
sbuf
 ;

426 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

427 
Àn
 > 0)

428 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

429 
cou¡
 = 
	`mßdpcm_ªad_block
 (
psf
, 
pms
, 
•å
, 
ªadcou¡
) ;

430 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

431 
±r
 [
tŸÆ
 + 
k
] = 
n‹mÁ˘
 * (Ë(
•å
 [k]) ;

432 
tŸÆ
 +
cou¡
 ;

433 
Àn
 -
ªadcou¡
 ;

434 i‡(
cou¡
 !
ªadcou¡
)

437  
tŸÆ
 ;

438 
	}
}

440 
sf_cou¡_t


441 
	$mßdpcm_£ek
 (
SF_PRIVATE
 *
psf
, 
mode
, 
sf_cou¡_t
 
off£t
)

442 { 
MSADPCM_PRIVATE
 *
pms
 ;

443 
√wblock
, 
√wßm∂e
 ;

445 i‡(! 
psf
->
codec_d©a
)

447 
pms
 = (
MSADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

449 i‡(
psf
->
d©Æígth
 < 0 ||Ösf->
d©aoff£t
 < 0)

450 { 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

451  
PSF_SEEK_ERROR
 ;

454 i‡(
off£t
 == 0)

455 { 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
, 
SEEK_SET
) ;

456 
pms
->
blockcou¡
 = 0 ;

457 
	`mßdpcm_decode_block
 (
psf
, 
pms
) ;

458 
pms
->
ßm∂ecou¡
 = 0 ;

462 i‡(
off£t
 < 0 || off£à> 
pms
->
blocks
 *Öms->
ßm∂e•îblock
)

463 { 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

464  
PSF_SEEK_ERROR
 ;

467 
√wblock
 = 
off£t
 / 
pms
->
ßm∂e•îblock
 ;

468 
√wßm∂e
 = 
off£t
 % 
pms
->
ßm∂e•îblock
 ;

470 i‡(
mode
 =
SFM_READ
)

471 { 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
 + 
√wblock
 * 
pms
->
blocksize
, 
SEEK_SET
) ;

472 
pms
->
blockcou¡
 = 
√wblock
 ;

473 
	`mßdpcm_decode_block
 (
psf
, 
pms
) ;

474 
pms
->
ßm∂ecou¡
 = 
√wßm∂e
 ;

478 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

479  
PSF_SEEK_ERROR
 ;

482  
√wblock
 * 
pms
->
ßm∂e•îblock
 + 
√wßm∂e
 ;

483 
	}
}

490 
	$mßdpcm_wrôe_ad≠t_c€ffs
 (
SF_PRIVATE
 *
psf
)

491 { 
k
 ;

493 
k
 = 0 ; k < 
MSADPCM_ADAPT_COEFF_COUNT
 ; k++)

494 
	`psf_böhódî_wrôef
 (
psf
, "22", 
Ad≠tC€ff1
 [
k
], 
Ad≠tC€ff2
 [k]) ;

495 
	}
}

501 
	$mßdpcm_ícode_block
 (
SF_PRIVATE
 *
psf
, 
MSADPCM_PRIVATE
 *
pms
)

502 { 
blocködx
 ;

503 
byã
 ;

504 
ch™
, 
k
, 
¥edi˘
, 
b¥ed
 [2], 
idñè
 [2], 
îr‹dñè
, 
√wßmp
 ;

506 
	`choo£_¥edi˘‹
 (
pms
->
ch™√ls
,Öms->
ßm∂es
, 
b¥ed
, 
idñè
) ;

510 i‡(
pms
->
ch™√ls
 == 1)

511 { 
pms
->
block
 [0] = 
b¥ed
 [0] ;

512 
pms
->
block
 [1] = 
idñè
 [0] & 0xFF ;

513 
pms
->
block
 [2] = 
idñè
 [0] >> 8 ;

514 
pms
->
block
 [3] =Öms->
ßm∂es
 [1] & 0xFF ;

515 
pms
->
block
 [4] =Öms->
ßm∂es
 [1] >> 8 ;

516 
pms
->
block
 [5] =Öms->
ßm∂es
 [0] & 0xFF ;

517 
pms
->
block
 [6] =Öms->
ßm∂es
 [0] >> 8 ;

519 
blocködx
 = 7 ;

520 
byã
 = 0 ;

524 
k
 = 2 ; k < 
pms
->
ßm∂e•îblock
 ; k++)

525 { 
¥edi˘
 = (
pms
->
ßm∂es
 [
k
-1] * 
Ad≠tC€ff1
 [
b¥ed
 [0]] +Öms->ßm∂e†[k-2] * 
Ad≠tC€ff2
 [bpred [0]]) >> 8 ;

526 
îr‹dñè
 = (
pms
->
ßm∂es
 [
k
] - 
¥edi˘
Ë/ 
idñè
 [0] ;

527 i‡(
îr‹dñè
 < -8)

528 
îr‹dñè
 = -8 ;

529 i‡(
îr‹dñè
 > 7)

530 
îr‹dñè
 = 7 ;

531 
√wßmp
 = 
¥edi˘
 + (
idñè
 [0] * 
îr‹dñè
) ;

532 i‡(
√wßmp
 > 32767)

533 
√wßmp
 = 32767 ;

534 i‡(
√wßmp
 < -32768)

535 
√wßmp
 = -32768 ;

536 i‡(
îr‹dñè
 < 0)

537 
îr‹dñè
 += 0x10 ;

539 
byã
 = (byã << 4Ë| (
îr‹dñè
 & 0xF) ;

540 i‡(
k
 % 2)

541 { 
pms
->
block
 [
blocködx
++] = 
byã
 ;

542 
byã
 = 0 ;

545 
idñè
 [0] = (idñè [0] * 
Ad≠èti⁄TabÀ
 [
îr‹dñè
]) >> 8 ;

546 i‡(
idñè
 [0] < 16)

547 
idñè
 [0] = 16 ;

548 
pms
->
ßm∂es
 [
k
] = 
√wßmp
 ;

553 
pms
->
block
 [0] = 
b¥ed
 [0] ;

554 
pms
->
block
 [1] = 
b¥ed
 [1] ;

556 
pms
->
block
 [2] = 
idñè
 [0] & 0xFF ;

557 
pms
->
block
 [3] = 
idñè
 [0] >> 8 ;

558 
pms
->
block
 [4] = 
idñè
 [1] & 0xFF ;

559 
pms
->
block
 [5] = 
idñè
 [1] >> 8 ;

561 
pms
->
block
 [6] =Öms->
ßm∂es
 [2] & 0xFF ;

562 
pms
->
block
 [7] =Öms->
ßm∂es
 [2] >> 8 ;

563 
pms
->
block
 [8] =Öms->
ßm∂es
 [3] & 0xFF ;

564 
pms
->
block
 [9] =Öms->
ßm∂es
 [3] >> 8 ;

566 
pms
->
block
 [10] =Öms->
ßm∂es
 [0] & 0xFF ;

567 
pms
->
block
 [11] =Öms->
ßm∂es
 [0] >> 8 ;

568 
pms
->
block
 [12] =Öms->
ßm∂es
 [1] & 0xFF ;

569 
pms
->
block
 [13] =Öms->
ßm∂es
 [1] >> 8 ;

571 
blocködx
 = 14 ;

572 
byã
 = 0 ;

573 
ch™
 = 1 ;

575 
k
 = 4 ; k < 2 * 
pms
->
ßm∂e•îblock
 ; k++)

576 { 
ch™
 = 
k
 & 1 ;

578 
¥edi˘
 = (
pms
->
ßm∂es
 [
k
-2] * 
Ad≠tC€ff1
 [
b¥ed
 [
ch™
]] +Öms->ßm∂e†[k-4] * 
Ad≠tC€ff2
 [bpred [chan]]) >> 8 ;

579 
îr‹dñè
 = (
pms
->
ßm∂es
 [
k
] - 
¥edi˘
Ë/ 
idñè
 [
ch™
] ;

582 i‡(
îr‹dñè
 < -8)

583 
îr‹dñè
 = -8 ;

584 i‡(
îr‹dñè
 > 7)

585 
îr‹dñè
 = 7 ;

586 
√wßmp
 = 
¥edi˘
 + (
idñè
 [
ch™
] * 
îr‹dñè
) ;

587 i‡(
√wßmp
 > 32767)

588 
√wßmp
 = 32767 ;

589 i‡(
√wßmp
 < -32768)

590 
√wßmp
 = -32768 ;

591 i‡(
îr‹dñè
 < 0)

592 
îr‹dñè
 += 0x10 ;

594 
byã
 = (byã << 4Ë| (
îr‹dñè
 & 0xF) ;

596 i‡(
ch™
)

597 { 
pms
->
block
 [
blocködx
++] = 
byã
 ;

598 
byã
 = 0 ;

601 
idñè
 [
ch™
] = (idñè [ch™] * 
Ad≠èti⁄TabÀ
 [
îr‹dñè
]) >> 8 ;

602 i‡(
idñè
 [
ch™
] < 16)

603 
idñè
 [
ch™
] = 16 ;

604 
pms
->
ßm∂es
 [
k
] = 
√wßmp
 ;

610 i‡((
k
 = 
	`psf_fwrôe
 (
pms
->
block
, 1,Öms->
blocksize
, 
psf
)) !=Öms->blocksize)

611 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög : sh‹àwrôê(%d !%d).\n", 
k
, 
pms
->
blocksize
) ;

613 
	`mem£t
 (
pms
->
ßm∂es
, 0,Öms->
ßm∂e•îblock
 *  ()) ;

615 
pms
->
blockcou¡
 ++ ;

616 
pms
->
ßm∂ecou¡
 = 0 ;

619 
	}
}

621 
sf_cou¡_t


622 
	$mßdpcm_wrôe_block
 (
SF_PRIVATE
 *
psf
, 
MSADPCM_PRIVATE
 *
pms
, c⁄° *
±r
, 
Àn
)

623 { 
cou¡
, 
tŸÆ
 = 0, 
ödx
 = 0 ;

625 
ödx
 < 
Àn
)

626 { 
cou¡
 = (
pms
->
ßm∂e•îblock
 -Öms->
ßm∂ecou¡
Ë*Öms->
ch™√ls
 ;

628 i‡(
cou¡
 > 
Àn
 - 
ödx
)

629 
cou¡
 = 
Àn
 - 
ödx
 ;

631 
	`mem˝y
 (&(
pms
->
ßm∂es
 [pms->
ßm∂ecou¡
 *Öms->
ch™√ls
]), &(
±r
 [
tŸÆ
]), 
cou¡
 *  ()) ;

632 
ödx
 +
cou¡
 ;

633 
pms
->
ßm∂ecou¡
 +
cou¡
 /Öms->
ch™√ls
 ;

634 
tŸÆ
 = 
ödx
 ;

636 i‡(
pms
->
ßm∂ecou¡
 >pms->
ßm∂e•îblock
)

637 
	`mßdpcm_ícode_block
 (
psf
, 
pms
) ;

640  
tŸÆ
 ;

641 
	}
}

643 
sf_cou¡_t


644 
	$mßdpcm_wrôe_s
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

645 { 
MSADPCM_PRIVATE
 *
pms
 ;

646 
wrôecou¡
, 
cou¡
 ;

647 
sf_cou¡_t
 
tŸÆ
 = 0 ;

649 i‡(! 
psf
->
codec_d©a
)

651 
pms
 = (
MSADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

653 
Àn
 > 0)

654 { 
wrôecou¡
 = (
Àn
 > 0x10000000) ? 0x10000000 : ()Üen ;

656 
cou¡
 = 
	`mßdpcm_wrôe_block
 (
psf
, 
pms
, 
±r
, 
wrôecou¡
) ;

658 
tŸÆ
 +
cou¡
 ;

659 
Àn
 -
cou¡
 ;

660 i‡(
cou¡
 !
wrôecou¡
)

664  
tŸÆ
 ;

665 
	}
}

667 
sf_cou¡_t


668 
	$mßdpcm_wrôe_i
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

669 { 
MSADPCM_PRIVATE
 *
pms
 ;

670 *
•å
 ;

671 
k
, 
buf„æí
, 
wrôecou¡
, 
cou¡
 ;

672 
sf_cou¡_t
 
tŸÆ
 = 0 ;

674 i‡(! 
psf
->
codec_d©a
)

676 
pms
 = (
MSADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

678 
•å
 = 
psf
->
u
.
sbuf
 ;

679 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

680 
Àn
 > 0)

681 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

682 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

683 
•å
 [
k
] = 
±r
 [
tŸÆ
 + k] >> 16 ;

684 
cou¡
 = 
	`mßdpcm_wrôe_block
 (
psf
, 
pms
, 
•å
, 
wrôecou¡
) ;

685 
tŸÆ
 +
cou¡
 ;

686 
Àn
 -
wrôecou¡
 ;

687 i‡(
cou¡
 !
wrôecou¡
)

690  
tŸÆ
 ;

691 
	}
}

693 
sf_cou¡_t


694 
	$mßdpcm_wrôe_f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

695 { 
MSADPCM_PRIVATE
 *
pms
 ;

696 *
•å
 ;

697 
k
, 
buf„æí
, 
wrôecou¡
, 
cou¡
 ;

698 
sf_cou¡_t
 
tŸÆ
 = 0 ;

699 
n‹mÁ˘
 ;

701 i‡(! 
psf
->
codec_d©a
)

703 
pms
 = (
MSADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

705 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? (1.0 * 0x7FFF) : 1.0 ;

707 
•å
 = 
psf
->
u
.
sbuf
 ;

708 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

709 
Àn
 > 0)

710 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

711 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

712 
•å
 [
k
] = 
	`Ãötf
 (
n‹mÁ˘
 * 
±r
 [
tŸÆ
 + k]) ;

713 
cou¡
 = 
	`mßdpcm_wrôe_block
 (
psf
, 
pms
, 
•å
, 
wrôecou¡
) ;

714 
tŸÆ
 +
cou¡
 ;

715 
Àn
 -
wrôecou¡
 ;

716 i‡(
cou¡
 !
wrôecou¡
)

719  
tŸÆ
 ;

720 
	}
}

722 
sf_cou¡_t


723 
	$mßdpcm_wrôe_d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

724 { 
MSADPCM_PRIVATE
 *
pms
 ;

725 *
•å
 ;

726 
k
, 
buf„æí
, 
wrôecou¡
, 
cou¡
 ;

727 
sf_cou¡_t
 
tŸÆ
 = 0 ;

728 
n‹mÁ˘
 ;

730 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? (1.0 * 0x7FFF) : 1.0 ;

732 i‡(! 
psf
->
codec_d©a
)

734 
pms
 = (
MSADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

736 
•å
 = 
psf
->
u
.
sbuf
 ;

737 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

738 
Àn
 > 0)

739 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

740 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

741 
•å
 [
k
] = 
	`Ãöt
 (
n‹mÁ˘
 * 
±r
 [
tŸÆ
 + k]) ;

742 
cou¡
 = 
	`mßdpcm_wrôe_block
 (
psf
, 
pms
, 
•å
, 
wrôecou¡
) ;

743 
tŸÆ
 +
cou¡
 ;

744 
Àn
 -
wrôecou¡
 ;

745 i‡(
cou¡
 !
wrôecou¡
)

748  
tŸÆ
 ;

749 
	}
}

755 
	$mßdpcm_˛o£
 (
SF_PRIVATE
 *
psf
)

756 { 
MSADPCM_PRIVATE
 *
pms
 ;

758 
pms
 = (
MSADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

760 i‡(
psf
->
mode
 =
SFM_WRITE
)

765 i‡(
pms
->
ßm∂ecou¡
 &&Öms->ßm∂ecou¡ <Öms->
ßm∂e•îblock
)

766 
	`mßdpcm_ícode_block
 (
psf
, 
pms
) ;

770 
	}
}

792 
	#IDELTA_COUNT
 3

	)

795 
	$choo£_¥edi˘‹
 (
ch™√ls
, *
d©a
, *
block_¥ed
, *
idñè
)

796 { 
ch™
, 
k
, 
b¥ed
, 
idñè_sum
, 
be°_b¥ed
, 
be°_idñè
 ;

798 
ch™
 = 0 ; ch™ < 
ch™√ls
 ; chan++)

799 { 
be°_b¥ed
 = 
be°_idñè
 = 0 ;

801 
b¥ed
 = 0 ; bpred < 7 ; bpred++)

802 { 
idñè_sum
 = 0 ;

803 
k
 = 2 ; k < 2 + 
IDELTA_COUNT
 ; k++)

804 
idñè_sum
 +
	`abs
 (
d©a
 [
k
 * 
ch™√ls
] - ((d©®[(k - 1Ë* ch™√ls] * 
Ad≠tC€ff1
 [
b¥ed
] + d©®[(k - 2Ë* ch™√ls] * 
Ad≠tC€ff2
 [bpred]) >> 8)) ;

805 
idñè_sum
 /(4 * 
IDELTA_COUNT
) ;

807 i‡(
b¥ed
 =0 || 
idñè_sum
 < 
be°_idñè
)

808 { 
be°_b¥ed
 = 
b¥ed
 ;

809 
be°_idñè
 = 
idñè_sum
 ;

812 i‡(! 
idñè_sum
)

813 { 
be°_b¥ed
 = 
b¥ed
 ;

814 
be°_idñè
 = 16 ;

819 i‡(
be°_idñè
 < 16)

820 
be°_idñè
 = 16 ;

822 
block_¥ed
 [
ch™
] = 
be°_b¥ed
 ;

823 
idñè
 [
ch™
] = 
be°_idñè
 ;

827 
	}
}

	@libsndfile-1.0.17/src/nist.c

26 
	~"sfc⁄fig.h
"

28 
	~<°dio.h
>

29 
	~<f˙é.h
>

30 
	~<°rög.h
>

31 
	~<˘y≥.h
>

33 
	~"¢dfûe.h
"

34 
	~"s„ndün.h
"

35 
	~"comm⁄.h
"

40 
	#NIST_HEADER_LENGTH
 1024

	)

46 
ni°_˛o£
 (
SF_PRIVATE
 *
psf
) ;

47 
ni°_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
) ;

48 
ni°_ªad_hódî
 (
SF_PRIVATE
 *
psf
) ;

54 
	$ni°_›í
 (
SF_PRIVATE
 *
psf
)

55 { 
îr‹
 ;

57 i‡(
psf
->
mode
 =
SFM_READ
 || (psf->modê=
SFM_RDWR
 &&Ösf->
fûñígth
 > 0))

58 { i‡((
îr‹
 = 
	`ni°_ªad_hódî
 (
psf
)))

59  
îr‹
 ;

62 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

63 { i‡(
psf
->
is_pùe
)

64  
SFE_NO_PIPE_WRITE
 ;

66 i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_NIST
)

67  
SFE_BAD_OPEN_FORMAT
 ;

69 
psf
->
ídün
 =Ösf->
sf
.
f‹m©
 & 
SF_FORMAT_ENDMASK
 ;

70 i‡(
psf
->
ídün
 =0 ||Ösf->ídü¿=
SF_ENDIAN_CPU
)

71 
psf
->
ídün
 = (
CPU_IS_BIG_ENDIAN
Ë? 
SF_ENDIAN_BIG
 : 
SF_ENDIAN_LITTLE
 ;

73 
psf
->
blockwidth
 =Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

74 
psf
->
sf
.
‰ames
 = 0 ;

76 i‡((
îr‹
 = 
	`ni°_wrôe_hódî
 (
psf
, 
SF_FALSE
)))

77  
îr‹
 ;

79 
psf
->
wrôe_hódî
 = 
ni°_wrôe_hódî
 ;

82 
psf
->
c⁄èöî_˛o£
 = 
ni°_˛o£
 ;

84 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
)

85 { 
SF_FORMAT_PCM_S8
 :

86 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

89 
SF_FORMAT_PCM_16
 :

90 
SF_FORMAT_PCM_24
 :

91 
SF_FORMAT_PCM_32
 :

92 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

95 
SF_FORMAT_ULAW
 :

96 
îr‹
 = 
	`uœw_öô
 (
psf
) ;

99 
SF_FORMAT_ALAW
 :

100 
îr‹
 = 
	`Æaw_öô
 (
psf
) ;

103  : 
îr‹
 = 
SFE_UNIMPLEMENTED
 ;

107  
îr‹
 ;

108 
	}
}

113 
	gbad_hódî
 [] =

120 
	$ni°_ªad_hódî
 (
SF_PRIVATE
 *
psf
)

121 { *
psf_hódî
 ;

122 
bôwidth
 = 0, 
byãs
 = 0, 
cou¡
, 
ícodög
 ;

123 
°r
 [64], *
˝å
 ;

124 
ßm∂es
 ;

126 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_NIST
 ;

128 
psf_hódî
 = 
psf
->
u
.
cbuf
 ;

130 i‡( (
psf
->
hódî
Ë<
NIST_HEADER_LENGTH
)

131  
SFE_INTERNAL
 ;

134 
	`psf_böhódî_ªadf
 (
psf
, "pb", 0, 
psf_hódî
, 
NIST_HEADER_LENGTH
) ;

137 
psf_hódî
 [
NIST_HEADER_LENGTH
] = 0 ;

140 i‡((
˝å
 = 
	`°r°r
 (
psf_hódî
, "end_head")))

141 { 
˝å
 +
	`°æí
 ("end_head") + 1 ;

142 
˝å
 [0] = 0 ;

145 i‡(
	`°r°r
 (
psf_hódî
, 
bad_hódî
) ==Ösf_header)

146  
SFE_NIST_CRLF_CONVERISON
 ;

149 i‡(
	`°r°r
 (
psf_hódî
, "NIST_1A\n") !=Ösf_header)

150 { 
	`psf_log_¥ötf
 (
psf
, "Notá NIST file.\n") ;

151  
SFE_NIST_BAD_HEADER
 ;

154 i‡(
	`ssˇnf
 (
psf_hódî
, "NIST_1A\n%d\n", &
cou¡
) == 1)

155 
psf
->
d©aoff£t
 = 
cou¡
 ;

157 { 
	`psf_log_¥ötf
 (
psf
, "*** Suspicious headerÜength.\n") ;

158 
psf
->
d©aoff£t
 = 
NIST_HEADER_LENGTH
 ;

162 
ícodög
 = 
SF_FORMAT_PCM_U8
 ;

163 i‡((
˝å
 = 
	`°r°r
 (
psf_hódî
, "sample_coding -s")))

164 { 
	`ssˇnf
 (
˝å
, "ßm∂e_codög -s%d %63s", &
cou¡
, 
°r
) ;

166 i‡(
	`°rcmp
 (
°r
, "pcm") == 0)

167 
ícodög
 = 
SF_FORMAT_PCM_U8
 ;

168 i‡(
	`°rcmp
 (
°r
, "alaw") == 0)

169 
ícodög
 = 
SF_FORMAT_ALAW
 ;

170 i‡((
	`°rcmp
 (
°r
, "ulaw") == 0) || (strcmp (str, "mu-law") == 0))

171 
ícodög
 = 
SF_FORMAT_ULAW
 ;

173 { 
	`psf_log_¥ötf
 (
psf
, "*** Unknow¿ícodög : %s\n", 
°r
) ;

174 
ícodög
 = 0 ;

178 i‡((
˝å
 = 
	`°r°r
 (
psf_hódî
, "channel_count -i ")))

179 
	`ssˇnf
 (
˝å
, "ch™√l_cou¡ -ò%d", &(
psf
->
sf
.
ch™√ls
)) ;

181 i‡((
˝å
 = 
	`°r°r
 (
psf_hódî
, "sample_rate -i ")))

182 
	`ssˇnf
 (
˝å
, "ßm∂e_øã -ò%d", &(
psf
->
sf
.
ßm∂î©e
)) ;

184 i‡((
˝å
 = 
	`°r°r
 (
psf_hódî
, "sample_count -i ")))

185 { 
	`ssˇnf
 (
psf_hódî
, "ßm∂e_cou¡ -ò%ld", &
ßm∂es
) ;

186 
psf
->
sf
.
‰ames
 = 
ßm∂es
 ;

189 i‡((
˝å
 = 
	`°r°r
 (
psf_hódî
, "sample_n_bytes -i ")))

190 
	`ssˇnf
 (
˝å
, "ßm∂e_n_byã†-ò%d", &(
psf
->
byãwidth
)) ;

193 
psf
->
ídün
 = (
CPU_IS_BIG_ENDIAN
Ë? 
SF_ENDIAN_BIG
 : 
SF_ENDIAN_LITTLE
 ;

196 i‡((
˝å
 = 
	`°r°r
 (
psf_hódî
, "sample_byte_format -s")))

197 { 
	`ssˇnf
 (
˝å
, "ßm∂e_byã_f‹m© -s%d %8s", &
byãs
, 
°r
) ;

198 i‡(
byãs
 > 1)

199 { i‡(
psf
->
byãwidth
 == 0)

200 
psf
->
byãwidth
 = 
byãs
 ;

201 i‡(
psf
->
byãwidth
 !
byãs
)

202 { 
	`psf_log_¥ötf
 (
psf
, "psf->byãwidth (%dË!byã†(%d)\n",Ösf->
byãwidth
, 
byãs
) ;

203  
SFE_NIST_BAD_ENCODING
 ;

206 i‡(
	`°r°r
 (
°r
, "01") == str)

207 
psf
->
ídün
 = 
SF_ENDIAN_LITTLE
 ;

208 i‡(
	`°r°r
 (
°r
, "10"))

209 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

211 { 
	`psf_log_¥ötf
 (
psf
, "WeúdÉndün-√s†: %s\n", 
°r
) ;

212  
SFE_NIST_BAD_ENCODING
 ;

216 
psf
->
sf
.
f‹m©
 |psf->
ídün
 ;

219 i‡((
˝å
 = 
	`°r°r
 (
psf_hódî
, "sample_sig_bits -i ")))

220 
	`ssˇnf
 (
˝å
, "ßm∂e_sig_bô†-ò%d", &
bôwidth
) ;

222 i‡(
	`°r°r
 (
psf_hódî
, "channels_interleaved -s5 FALSE"))

223 { 
	`psf_log_¥ötf
 (
psf
, "N⁄-öãæóved d©®unsuµ‹ãd.\n", 
°r
) ;

224  
SFE_NIST_BAD_ENCODING
 ;

227 
psf
->
blockwidth
 =Ösf->
sf
.
ch™√ls
 *Ösf->
byãwidth
 ;

228 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

230 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
, 
SEEK_SET
) ;

232 i‡(
ícodög
 =
SF_FORMAT_PCM_U8
)

233 { 
psf
->
byãwidth
)

235 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_PCM_S8
 ;

239 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_PCM_16
 ;

243 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_PCM_24
 ;

247 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_PCM_32
 ;

253 i‡(
ícodög
 != 0)

254 
psf
->
sf
.
f‹m©
 |
ícodög
 ;

256  
SFE_UNIMPLEMENTED
 ;

259 
	}
}

262 
	$ni°_˛o£
 (
SF_PRIVATE
 *
psf
)

264 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

265 
	`ni°_wrôe_hódî
 (
psf
, 
SF_TRUE
) ;

268 
	}
}

274 
	$ni°_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
)

275 { c⁄° *
íd_°r
 ;

276 
ßm∂es
 ;

277 
sf_cou¡_t
 
cuºít
 ;

279 
cuºít
 = 
	`psf_·ñl
 (
psf
) ;

281 i‡(
ˇlc_Àngth
)

282 { 
psf
->
fûñígth
 = 
	`psf_gë_fûñí
 (psf) ;

284 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

286 i‡(
psf
->
d©´nd
)

287 
psf
->
d©Æígth
 -psf->
fûñígth
 -Ösf->
d©´nd
 ;

289 i‡(
psf
->
byãwidth
 > 0)

290 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 / (psf->
byãwidth
 *Ösf->sf.
ch™√ls
) ;

293 i‡(
psf
->
ídün
 =
SF_ENDIAN_BIG
)

294 
íd_°r
 = "10" ;

295 i‡(
psf
->
ídün
 =
SF_ENDIAN_LITTLE
)

296 
íd_°r
 = "01" ;

298 
íd_°r
 = "error" ;

301 
	`mem£t
 (
psf
->
hódî
, 0,  (psf->header)) ;

302 
psf
->
hódödex
 = 0 ;

304 
	`psf_f£ek
 (
psf
, 0, 
SEEK_SET
) ;

306 
	`psf_asciihódî_¥ötf
 (
psf
, "NIST_1A\n 1024\n") ;

307 
	`psf_asciihódî_¥ötf
 (
psf
, "ch™√l_cou¡ -ò%d\n",Ösf->
sf
.
ch™√ls
) ;

308 
	`psf_asciihódî_¥ötf
 (
psf
, "ßm∂e_øã -ò%d\n",Ösf->
sf
.
ßm∂î©e
) ;

310 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
)

311 { 
SF_FORMAT_PCM_S8
 :

312 
	`psf_asciihódî_¥ötf
 (
psf
, "sample_coding -s3Öcm\n") ;

313 
	`psf_asciihódî_¥ötf
 (
psf
, "sample_n_bytes -i 1\n"

317 
SF_FORMAT_PCM_16
 :

318 
SF_FORMAT_PCM_24
 :

319 
SF_FORMAT_PCM_32
 :

320 
	`psf_asciihódî_¥ötf
 (
psf
, "ßm∂e_n_byã†-ò%d\n",Ösf->
byãwidth
) ;

321 
	`psf_asciihódî_¥ötf
 (
psf
, "ßm∂e_sig_bô†-ò%d\n",Ösf->
byãwidth
 * 8) ;

322 
	`psf_asciihódî_¥ötf
 (
psf
, "sample_coding -s3Öcm\n"

323 "ßm∂e_byã_f‹m© -s%d %s\n", 
psf
->
byãwidth
, 
íd_°r
) ;

326 
SF_FORMAT_ALAW
 :

327 
	`psf_asciihódî_¥ötf
 (
psf
, "sample_coding -s4álaw\n") ;

328 
	`psf_asciihódî_¥ötf
 (
psf
, "sample_n_bytes -s1 1\n") ;

331 
SF_FORMAT_ULAW
 :

332 
	`psf_asciihódî_¥ötf
 (
psf
, "sample_coding -s4 ulaw\n") ;

333 
	`psf_asciihódî_¥ötf
 (
psf
, "sample_n_bytes -s1 1\n") ;

336  :  
SFE_UNIMPLEMENTED
 ;

339 
psf
->
d©aoff£t
 = 
NIST_HEADER_LENGTH
 ;

342 
ßm∂es
 = 
psf
->
sf
.
‰ames
 ;

343 
	`psf_asciihódî_¥ötf
 (
psf
, "ßm∂e_cou¡ -ò%ld\n", 
ßm∂es
) ;

344 
	`psf_asciihódî_¥ötf
 (
psf
, "end_head\n") ;

347 
	`psf_böhódî_wrôef
 (
psf
, "z", (
size_t
Ë(
NIST_HEADER_LENGTH
 -Ösf->
hódödex
)) ;

349 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

351 i‡(
psf
->
îr‹
)

352  
psf
->
îr‹
 ;

354 i‡(
cuºít
 > 0)

355 
	`psf_f£ek
 (
psf
, 
cuºít
, 
SEEK_SET
) ;

357  
psf
->
îr‹
 ;

358 
	}
}

	@libsndfile-1.0.17/src/ogg.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<f˙é.h
>

23 
	~<°rög.h
>

24 
	~<˘y≥.h
>

26 
	~"¢dfûe.h
"

27 
	~"s„ndün.h
"

28 
	~"comm⁄.h
"

31 
	$ogg_›í
 (
SF_PRIVATE
 *
psf
)

32 { i‡(
psf
)

33  
SFE_UNIMPLEMENTED
 ;

34  (
psf
 && 0) ;

35 
	}
}

	@libsndfile-1.0.17/src/paf.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<f˙é.h
>

24 
	~<°rög.h
>

25 
	~<˘y≥.h
>

27 
	~"¢dfûe.h
"

28 
	~"s„ndün.h
"

29 
	~"Êﬂt_ˇ°.h
"

30 
	~"comm⁄.h
"

36 
	#FAP_MARKER
 (
	`MAKE_MARKER
 ('f', 'a', 'p', ' '))

	)

37 
	#PAF_MARKER
 (
	`MAKE_MARKER
 (' ', 'p', 'a', 'f'))

	)

43 
	#PAF_HEADER_LENGTH
 2048

	)

45 
	#PAF24_SAMPLES_PER_BLOCK
 10

	)

46 
	#PAF24_BLOCK_SIZE
 32

	)

53 { 
	mvîsi⁄
 ;

54 
	mídü¬ess
 ;

55 
	mßm∂î©e
 ;

56 
	mf‹m©
 ;

57 
	mch™√ls
 ;

58 
	msour˚
 ;

59 } 
	tPAF_FMT
 ;

62 { 
	mmax_blocks
, 
	mch™√ls
, 
	mßm∂e•îblock
, 
	mblocksize
 ;

63 
	mªad_block
, 
	mwrôe_block
, 
	mªad_cou¡
, 
	mwrôe_cou¡
 ;

64 
sf_cou¡_t
 
	mßm∂e_cou¡
 ;

65 *
	mßm∂es
 ;

66 *
	mblock
 ;

67 #i‡
HAVE_FLEXIBLE_ARRAY


68 
	md©a
 [] ;

70 
	md©a
 [1] ;

72 } 
	tPAF24_PRIVATE
 ;

78 
∑f24_öô
 (
SF_PRIVATE
 *
psf
) ;

80 
∑f_ªad_hódî
 (
SF_PRIVATE
 *
psf
) ;

81 
∑f_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
) ;

83 
sf_cou¡_t
 
∑f24_ªad_s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

84 
sf_cou¡_t
 
∑f24_ªad_i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

85 
sf_cou¡_t
 
∑f24_ªad_f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

86 
sf_cou¡_t
 
∑f24_ªad_d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

88 
sf_cou¡_t
 
∑f24_wrôe_s
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

89 
sf_cou¡_t
 
∑f24_wrôe_i
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

90 
sf_cou¡_t
 
∑f24_wrôe_f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

91 
sf_cou¡_t
 
∑f24_wrôe_d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

93 
sf_cou¡_t
 
∑f24_£ek
 (
SF_PRIVATE
 *
psf
, 
mode
, sf_cou¡_à
off£t
) ;

96 { 
	mPAF_PCM_16
 = 0,

97 
	mPAF_PCM_24
 = 1,

98 
	mPAF_PCM_S8
 = 2

106 
	$∑f_›í
 (
SF_PRIVATE
 *
psf
)

107 { 
subf‹m©
, 
îr‹
, 
ídün
 ;

109 
psf
->
d©aoff£t
 = 
PAF_HEADER_LENGTH
 ;

111 i‡(
psf
->
mode
 =
SFM_READ
 || (psf->modê=
SFM_RDWR
 &&Ösf->
fûñígth
 > 0))

112 { i‡((
îr‹
 = 
	`∑f_ªad_hódî
 (
psf
)))

113  
îr‹
 ;

116 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

118 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

119 { i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_PAF
)

120  
SFE_BAD_OPEN_FORMAT
 ;

122 
ídün
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_ENDMASK
 ;

125 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

127 i‡(
ídün
 =
SF_ENDIAN_LITTLE
 || (
CPU_IS_LITTLE_ENDIAN
 && (ídü¿=
SF_ENDIAN_CPU
)))

128 
psf
->
ídün
 = 
SF_ENDIAN_LITTLE
 ;

130 i‡((
îr‹
 = 
	`∑f_wrôe_hódî
 (
psf
, 
SF_FALSE
)))

131  
îr‹
 ;

133 
psf
->
wrôe_hódî
 = 
∑f_wrôe_hódî
 ;

136 
subf‹m©
)

137 { 
SF_FORMAT_PCM_S8
 :

138 
psf
->
byãwidth
 = 1 ;

139 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

142 
SF_FORMAT_PCM_16
 :

143 
psf
->
byãwidth
 = 2 ;

144 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

147 
SF_FORMAT_PCM_24
 :

149 
îr‹
 = 
	`∑f24_öô
 (
psf
) ;

152  :  
SFE_PAF_UNKNOWN_FORMAT
 ;

155  
îr‹
 ;

156 
	}
}

162 
	$∑f_ªad_hódî
 (
SF_PRIVATE
 *
psf
)

163 { 
PAF_FMT
 
∑f_fmt
 ;

164 
m¨kî
 ;

166 
	`mem£t
 (&
∑f_fmt
, 0,  (paf_fmt)) ;

167 
	`psf_böhódî_ªadf
 (
psf
, "pm", 0, &
m¨kî
) ;

169 
	`psf_log_¥ötf
 (
psf
, "Sig«tuª : '%M'\n", 
m¨kî
) ;

171 i‡(
m¨kî
 =
PAF_MARKER
)

172 { 
	`psf_böhódî_ªadf
 (
psf
, "E444444", &(
∑f_fmt
.
vîsi⁄
), &’af_fmt.
ídü¬ess
),

173 &(
∑f_fmt
.
ßm∂î©e
), &’af_fmt.
f‹m©
), &’af_fmt.
ch™√ls
), &’af_fmt.
sour˚
)) ;

175 i‡(
m¨kî
 =
FAP_MARKER
)

176 { 
	`psf_böhódî_ªadf
 (
psf
, "e444444", &(
∑f_fmt
.
vîsi⁄
), &’af_fmt.
ídü¬ess
),

177 &(
∑f_fmt
.
ßm∂î©e
), &’af_fmt.
f‹m©
), &’af_fmt.
ch™√ls
), &’af_fmt.
sour˚
)) ;

180  
SFE_PAF_NO_MARKER
 ;

182 
	`psf_log_¥ötf
 (
psf
, "Vîsi⁄ : %d\n", 
∑f_fmt
.
vîsi⁄
) ;

184 i‡(
∑f_fmt
.
vîsi⁄
 != 0)

185 { 
	`psf_log_¥ötf
 (
psf
, "*** Bad versionÇumber. should be zero.\n") ;

186  
SFE_PAF_VERSION
 ;

189 
	`psf_log_¥ötf
 (
psf
, "Sam∂êR©ê: %d\n", 
∑f_fmt
.
ßm∂î©e
) ;

190 
	`psf_log_¥ötf
 (
psf
, "Ch™√l† : %d\n", 
∑f_fmt
.
ch™√ls
) ;

192 
	`psf_log_¥ötf
 (
psf
, "Endü¬es† : %d => ", 
∑f_fmt
.
ídü¬ess
) ;

193 i‡(
∑f_fmt
.
ídü¬ess
)

194 { 
	`psf_log_¥ötf
 (
psf
, "Lôée\n", 
∑f_fmt
.
ídü¬ess
) ;

195 
psf
->
ídün
 = 
SF_ENDIAN_LITTLE
 ;

198 { 
	`psf_log_¥ötf
 (
psf
, "Big\n", 
∑f_fmt
.
ídü¬ess
) ;

199 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

202 i‡(
psf
->
fûñígth
 < 
PAF_HEADER_LENGTH
)

203  
SFE_PAF_SHORT_HEADER
 ;

205 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

207 
	`psf_böhódî_ªadf
 (
psf
, "p", (Ëpsf->
d©aoff£t
) ;

209 
psf
->
sf
.
ßm∂î©e
 = 
∑f_fmt
.samplerate ;

210 
psf
->
sf
.
ch™√ls
 = 
∑f_fmt
.channels ;

213 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_PAF
 ;

215 
	`psf_log_¥ötf
 (
psf
, "F‹m© : %d => ", 
∑f_fmt
.
f‹m©
) ;

218 
psf
->
sf
.
f‹m©
 |
∑f_fmt
.
ídü¬ess
 ? 
SF_ENDIAN_LITTLE
 : 
SF_ENDIAN_BIG
 ;

220 
∑f_fmt
.
f‹m©
)

221 { 
PAF_PCM_S8
 :

222 
	`psf_log_¥ötf
 (
psf
, "8 bitÜinear PCM\n") ;

223 
psf
->
byãwidth
 = 1 ;

225 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_PCM_S8
 ;

227 
psf
->
blockwidth
 =Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

228 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 /Ösf->
blockwidth
 ;

231 
PAF_PCM_16
 :

232 
	`psf_log_¥ötf
 (
psf
, "16 bitÜinear PCM\n") ;

233 
psf
->
byãwidth
 = 2 ;

235 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_PCM_16
 ;

237 
psf
->
blockwidth
 =Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

238 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 /Ösf->
blockwidth
 ;

241 
PAF_PCM_24
 :

242 
	`psf_log_¥ötf
 (
psf
, "24 bitÜinear PCM\n") ;

243 
psf
->
byãwidth
 = 3 ;

245 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_PCM_24
 ;

247 
psf
->
blockwidth
 = 0 ;

248 
psf
->
sf
.
‰ames
 = 
PAF24_SAMPLES_PER_BLOCK
 *Ösf->
d©Æígth
 /

249 (
PAF24_BLOCK_SIZE
 * 
psf
->
sf
.
ch™√ls
) ;

252  : 
	`psf_log_¥ötf
 (
psf
, "Unknown\n") ;

253  
SFE_PAF_UNKNOWN_FORMAT
 ;

257 
	`psf_log_¥ötf
 (
psf
, "Sour˚ : %d => ", 
∑f_fmt
.
sour˚
) ;

259 
∑f_fmt
.
sour˚
)

260 { 1 : 
	`psf_log_¥ötf
 (
psf
, "Analog Recording\n") ;

262 2 : 
	`psf_log_¥ötf
 (
psf
, "Digital Transfer\n") ;

264 3 : 
	`psf_log_¥ötf
 (
psf
, "Multi-track Mixdown\n") ;

266 5 : 
	`psf_log_¥ötf
 (
psf
, "Audio Resulting From DSP Processing\n") ;

268  : 
	`psf_log_¥ötf
 (
psf
, "Unknown\n") ;

273 
	}
}

276 
	$∑f_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
)

277 { 
∑f_f‹m©
 ;

280 i‡(
	`psf_·ñl
 (
psf
Ë>
PAF_HEADER_LENGTH
)

283 
psf
->
d©aoff£t
 = 
PAF_HEADER_LENGTH
 ;

285 
psf
->
d©aoff£t
 = 
PAF_HEADER_LENGTH
 ;

288 
ˇlc_Àngth
 = calc_length ;

290 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
)

291 { 
SF_FORMAT_PCM_S8
 :

292 
∑f_f‹m©
 = 
PAF_PCM_S8
 ;

295 
SF_FORMAT_PCM_16
 :

296 
∑f_f‹m©
 = 
PAF_PCM_16
 ;

299 
SF_FORMAT_PCM_24
 :

300 
∑f_f‹m©
 = 
PAF_PCM_24
 ;

303  :  
SFE_PAF_UNKNOWN_FORMAT
 ;

307 
psf
->
hódî
 [0] = 0 ;

308 
psf
->
hódödex
 = 0 ;

310 i‡(
psf
->
ídün
 =
SF_ENDIAN_BIG
)

312 
	`psf_böhódî_wrôef
 (
psf
, "Em444", 
PAF_MARKER
, 0, 0,Ösf->
sf
.
ßm∂î©e
) ;

314 
	`psf_böhódî_wrôef
 (
psf
, "E444", 
∑f_f‹m©
,Ösf->
sf
.
ch™√ls
, 0) ;

316 i‡(
psf
->
ídün
 =
SF_ENDIAN_LITTLE
)

318 
	`psf_böhódî_wrôef
 (
psf
, "em444", 
FAP_MARKER
, 0, 1,Ösf->
sf
.
ßm∂î©e
) ;

320 
	`psf_böhódî_wrôef
 (
psf
, "e444", 
∑f_f‹m©
,Ösf->
sf
.
ch™√ls
, 0) ;

324 
	`psf_böhódî_wrôef
 (
psf
, "z", (
size_t
Ë’sf->
d©aoff£t
 -Ösf->
hódödex
)) ;

326 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

328  
psf
->
îr‹
 ;

329 
	}
}

345 
∑f24_ªad_block
 (
SF_PRIVATE
 *
psf
, 
PAF24_PRIVATE
 *
µaf24
) ;

346 
∑f24_wrôe_block
 (
SF_PRIVATE
 *
psf
, 
PAF24_PRIVATE
 *
µaf24
) ;

347 
∑f24_˛o£
 (
SF_PRIVATE
 *
psf
) ;

351 
	$∑f24_öô
 (
SF_PRIVATE
 *
psf
)

352 { 
PAF24_PRIVATE
 *
µaf24
 ;

353 
∑f24size
 ;

355 
∑f24size
 =  (
PAF24_PRIVATE
Ë+ 
psf
->
sf
.
ch™√ls
 *

356 (
PAF24_BLOCK_SIZE
 + 
PAF24_SAMPLES_PER_BLOCK
 *  ()) ;

362 
psf
->
œ°_›
 = 0 ;

364 i‡(! (
psf
->
codec_d©a
 = 
	`mÆloc
 (
∑f24size
)))

365  
SFE_MALLOC_FAILED
 ;

367 
µaf24
 = (
PAF24_PRIVATE
*Ë
psf
->
codec_d©a
 ;

368 
	`mem£t
 (
µaf24
, 0, 
∑f24size
) ;

370 
µaf24
->
ch™√ls
 = 
psf
->
sf
.channels ;

371 
µaf24
->
ßm∂es
 =Ö∑f24->
d©a
 ;

372 
µaf24
->
block
 = (*Ë’∑f24->
d©a
 + 
PAF24_SAMPLES_PER_BLOCK
 *Ö∑f24->
ch™√ls
) ;

374 
µaf24
->
blocksize
 = 
PAF24_BLOCK_SIZE
 *Ö∑f24->
ch™√ls
 ;

375 
µaf24
->
ßm∂e•îblock
 = 
PAF24_SAMPLES_PER_BLOCK
 ;

377 i‡(
psf
->
mode
 =
SFM_READ
 ||Ösf->modê=
SFM_RDWR
)

378 { 
	`∑f24_ªad_block
 (
psf
, 
µaf24
) ;

380 
psf
->
ªad_sh‹t
 = 
∑f24_ªad_s
 ;

381 
psf
->
ªad_öt
 = 
∑f24_ªad_i
 ;

382 
psf
->
ªad_Êﬂt
 = 
∑f24_ªad_f
 ;

383 
psf
->
ªad_doubÀ
 = 
∑f24_ªad_d
 ;

386 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

387 { 
psf
->
wrôe_sh‹t
 = 
∑f24_wrôe_s
 ;

388 
psf
->
wrôe_öt
 = 
∑f24_wrôe_i
 ;

389 
psf
->
wrôe_Êﬂt
 = 
∑f24_wrôe_f
 ;

390 
psf
->
wrôe_doubÀ
 = 
∑f24_wrôe_d
 ;

393 
psf
->
£ek
 = 
∑f24_£ek
 ;

394 
psf
->
c⁄èöî_˛o£
 = 
∑f24_˛o£
 ;

396 
psf
->
fûñígth
 = 
	`psf_gë_fûñí
 (psf) ;

397 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

399 i‡(
psf
->
d©Æígth
 % 
PAF24_BLOCK_SIZE
)

400 { i‡(
psf
->
mode
 =
SFM_READ
)

401 
	`psf_log_¥ötf
 (
psf
, "*** Warning : file seemsÅo beÅruncated.\n") ;

402 
µaf24
->
max_blocks
 = 
psf
->
d©Æígth
 /Ö∑f24->
blocksize
 + 1 ;

405 
µaf24
->
max_blocks
 = 
psf
->
d©Æígth
 /Ö∑f24->
blocksize
 ;

407 
µaf24
->
ªad_block
 = 0 ;

408 i‡(
psf
->
mode
 =
SFM_RDWR
)

409 
µaf24
->
wrôe_block
 =Ö∑f24->
max_blocks
 ;

411 
µaf24
->
wrôe_block
 = 0 ;

413 
psf
->
sf
.
‰ames
 = 
µaf24
->
ßm∂e•îblock
 *Ö∑f24->
max_blocks
 ;

414 
µaf24
->
ßm∂e_cou¡
 = 
psf
->
sf
.
‰ames
 ;

417 
	}
}

419 
sf_cou¡_t


420 
	$∑f24_£ek
 (
SF_PRIVATE
 *
psf
, 
mode
, 
sf_cou¡_t
 
off£t
)

421 { 
PAF24_PRIVATE
 *
µaf24
 ;

422 
√wblock
, 
√wßm∂e
 ;

424 i‡(
psf
->
codec_d©a
 =
NULL
)

425 { 
psf
->
îr‹
 = 
SFE_INTERNAL
 ;

426  
PSF_SEEK_ERROR
 ;

429 
µaf24
 = (
PAF24_PRIVATE
*Ë
psf
->
codec_d©a
 ;

431 i‡(
mode
 =
SFM_READ
 && 
µaf24
->
wrôe_cou¡
 > 0)

432 
	`∑f24_wrôe_block
 (
psf
, 
µaf24
) ;

434 
√wblock
 = 
off£t
 / 
µaf24
->
ßm∂e•îblock
 ;

435 
√wßm∂e
 = 
off£t
 % 
µaf24
->
ßm∂e•îblock
 ;

437 
mode
)

438 { 
SFM_READ
 :

439 i‡(
psf
->
œ°_›
 =
SFM_WRITE
 && 
µaf24
->
wrôe_cou¡
)

440 
	`∑f24_wrôe_block
 (
psf
, 
µaf24
) ;

442 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
 + 
√wblock
 * 
µaf24
->
blocksize
, 
SEEK_SET
) ;

443 
µaf24
->
ªad_block
 = 
√wblock
 ;

444 
	`∑f24_ªad_block
 (
psf
, 
µaf24
) ;

445 
µaf24
->
ªad_cou¡
 = 
√wßm∂e
 ;

448 
SFM_WRITE
 :

449 i‡(
off£t
 > 
µaf24
->
ßm∂e_cou¡
)

450 { 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

451  
PSF_SEEK_ERROR
 ;

454 i‡(
psf
->
œ°_›
 =
SFM_WRITE
 && 
µaf24
->
wrôe_cou¡
)

455 
	`∑f24_wrôe_block
 (
psf
, 
µaf24
) ;

457 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
 + 
√wblock
 * 
µaf24
->
blocksize
, 
SEEK_SET
) ;

458 
µaf24
->
wrôe_block
 = 
√wblock
 ;

459 
	`∑f24_ªad_block
 (
psf
, 
µaf24
) ;

460 
µaf24
->
wrôe_cou¡
 = 
√wßm∂e
 ;

464 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

465  
PSF_SEEK_ERROR
 ;

468  
√wblock
 * 
µaf24
->
ßm∂e•îblock
 + 
√wßm∂e
 ;

469 
	}
}

472 
	$∑f24_˛o£
 (
SF_PRIVATE
 *
psf
)

473 { 
PAF24_PRIVATE
 *
µaf24
 ;

475 i‡(
psf
->
codec_d©a
 =
NULL
)

478 
µaf24
 = (
PAF24_PRIVATE
*Ë
psf
->
codec_d©a
 ;

480 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

481 { i‡(
µaf24
->
wrôe_cou¡
 > 0)

482 
	`∑f24_wrôe_block
 (
psf
, 
µaf24
) ;

486 
	}
}

491 
	$∑f24_ªad_block
 (
SF_PRIVATE
 *
psf
, 
PAF24_PRIVATE
 *
µaf24
)

492 { 
k
, 
ch™√l
 ;

493 *
˝å
 ;

495 
µaf24
->
ªad_block
 ++ ;

496 
µaf24
->
ªad_cou¡
 = 0 ;

498 i‡(
µaf24
->
ªad_block
 *Ö∑f24->
ßm∂e•îblock
 >Ö∑f24->
ßm∂e_cou¡
)

499 { 
	`mem£t
 (
µaf24
->
ßm∂es
, 0,Ö∑f24->
ßm∂e•îblock
 *Ö∑f24->
ch™√ls
) ;

504 i‡((
k
 = 
	`psf_‰ód
 (
µaf24
->
block
, 1,Ö∑f24->
blocksize
, 
psf
)) !=Öpaf24->blocksize)

505 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög : sh‹àªad (%d !%d).\n", 
k
, 
µaf24
->
blocksize
) ;

508 i‡(
CPU_IS_LITTLE_ENDIAN
)

510 i‡(
psf
->
ídün
 =
SF_ENDIAN_BIG
)

511 
	`ídsw≠_öt_¨øy
 (
µaf24
->
d©a
, 8 *Ö∑f24->
ch™√ls
) ;

514 
k
 = 0 ; k < 
PAF24_SAMPLES_PER_BLOCK
 * 
µaf24
->
ch™√ls
 ; k++)

515 { 
ch™√l
 = 
k
 % 
µaf24
->
ch™√ls
 ;

516 
˝å
 = 
µaf24
->
block
 + 
PAF24_BLOCK_SIZE
 * 
ch™√l
 + 3 * (
k
 /Ö∑f24->
ch™√ls
) ;

517 
µaf24
->
ßm∂es
 [
k
] = (
˝å
 [0] << 8) | (cptr [1] << 16) | (cptr [2] << 24) ;

522 i‡(
psf
->
ídün
 =
SF_ENDIAN_BIG
)

523 
	`ídsw≠_öt_¨øy
 (
µaf24
->
d©a
, 8 *Ö∑f24->
ch™√ls
) ;

526 
k
 = 0 ; k < 
PAF24_SAMPLES_PER_BLOCK
 * 
µaf24
->
ch™√ls
 ; k++)

527 { 
ch™√l
 = 
k
 % 
µaf24
->
ch™√ls
 ;

528 
˝å
 = 
µaf24
->
block
 + 
PAF24_BLOCK_SIZE
 * 
ch™√l
 + 3 * (
k
 /Ö∑f24->
ch™√ls
) ;

529 
µaf24
->
ßm∂es
 [
k
] = (
˝å
 [0] << 8) | (cptr [1] << 16) | (cptr [2] << 24) ;

534 
	}
}

537 
	$∑f24_ªad
 (
SF_PRIVATE
 *
psf
, 
PAF24_PRIVATE
 *
µaf24
, *
±r
, 
Àn
)

538 { 
cou¡
, 
tŸÆ
 = 0 ;

540 
tŸÆ
 < 
Àn
)

541 { i‡(
µaf24
->
ªad_block
 *Ö∑f24->
ßm∂e•îblock
 >µaf24->
ßm∂e_cou¡
)

542 { 
	`mem£t
 (&(
±r
 [
tŸÆ
]), 0, (
Àn
 -Åotal) *  ()) ;

543  
tŸÆ
 ;

546 i‡(
µaf24
->
ªad_cou¡
 >µaf24->
ßm∂e•îblock
)

547 
	`∑f24_ªad_block
 (
psf
, 
µaf24
) ;

549 
cou¡
 = (
µaf24
->
ßm∂e•îblock
 -Ö∑f24->
ªad_cou¡
Ë*Ö∑f24->
ch™√ls
 ;

550 
cou¡
 = (
Àn
 - 
tŸÆ
 > count) ? count :Üen -Åotal ;

552 
	`mem˝y
 (&(
±r
 [
tŸÆ
]), &(
µaf24
->
ßm∂es
 [µaf24->
ªad_cou¡
 *Ö∑f24->
ch™√ls
]), 
cou¡
 *  ()) ;

553 
tŸÆ
 +
cou¡
 ;

554 
µaf24
->
ªad_cou¡
 +
cou¡
 /Ö∑f24->
ch™√ls
 ;

557  
tŸÆ
 ;

558 
	}
}

560 
sf_cou¡_t


561 
	$∑f24_ªad_s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

562 { 
PAF24_PRIVATE
 *
µaf24
 ;

563 *
ùå
 ;

564 
k
, 
buf„æí
, 
ªadcou¡
, 
cou¡
 ;

565 
sf_cou¡_t
 
tŸÆ
 = 0 ;

567 i‡(
psf
->
codec_d©a
 =
NULL
)

569 
µaf24
 = (
PAF24_PRIVATE
*Ë
psf
->
codec_d©a
 ;

571 
ùå
 = 
psf
->
u
.
ibuf
 ;

572 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

573 
Àn
 > 0)

574 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

575 
cou¡
 = 
	`∑f24_ªad
 (
psf
, 
µaf24
, 
ùå
, 
ªadcou¡
) ;

576 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

577 
±r
 [
tŸÆ
 + 
k
] = 
ùå
 [k] >> 16 ;

578 
tŸÆ
 +
cou¡
 ;

579 
Àn
 -
ªadcou¡
 ;

581  
tŸÆ
 ;

582 
	}
}

584 
sf_cou¡_t


585 
	$∑f24_ªad_i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

586 { 
PAF24_PRIVATE
 *
µaf24
 ;

587 
tŸÆ
 ;

589 i‡(
psf
->
codec_d©a
 =
NULL
)

591 
µaf24
 = (
PAF24_PRIVATE
*Ë
psf
->
codec_d©a
 ;

593 
tŸÆ
 = 
	`∑f24_ªad
 (
psf
, 
µaf24
, 
±r
, 
Àn
) ;

595  
tŸÆ
 ;

596 
	}
}

598 
sf_cou¡_t


599 
	$∑f24_ªad_f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

600 { 
PAF24_PRIVATE
 *
µaf24
 ;

601 *
ùå
 ;

602 
k
, 
buf„æí
, 
ªadcou¡
, 
cou¡
 ;

603 
sf_cou¡_t
 
tŸÆ
 = 0 ;

604 
n‹mÁ˘
 ;

606 i‡(
psf
->
codec_d©a
 =
NULL
)

608 
µaf24
 = (
PAF24_PRIVATE
*Ë
psf
->
codec_d©a
 ;

610 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? (1.0 / 0x80000000) : (1.0 / 0x100) ;

612 
ùå
 = 
psf
->
u
.
ibuf
 ;

613 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

614 
Àn
 > 0)

615 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

616 
cou¡
 = 
	`∑f24_ªad
 (
psf
, 
µaf24
, 
ùå
, 
ªadcou¡
) ;

617 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

618 
±r
 [
tŸÆ
 + 
k
] = 
n‹mÁ˘
 * 
ùå
 [k] ;

619 
tŸÆ
 +
cou¡
 ;

620 
Àn
 -
ªadcou¡
 ;

622  
tŸÆ
 ;

623 
	}
}

625 
sf_cou¡_t


626 
	$∑f24_ªad_d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

627 { 
PAF24_PRIVATE
 *
µaf24
 ;

628 *
ùå
 ;

629 
k
, 
buf„æí
, 
ªadcou¡
, 
cou¡
 ;

630 
sf_cou¡_t
 
tŸÆ
 = 0 ;

631 
n‹mÁ˘
 ;

633 i‡(
psf
->
codec_d©a
 =
NULL
)

635 
µaf24
 = (
PAF24_PRIVATE
*Ë
psf
->
codec_d©a
 ;

637 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? (1.0 / 0x80000000) : (1.0 / 0x100) ;

639 
ùå
 = 
psf
->
u
.
ibuf
 ;

640 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

641 
Àn
 > 0)

642 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

643 
cou¡
 = 
	`∑f24_ªad
 (
psf
, 
µaf24
, 
ùå
, 
ªadcou¡
) ;

644 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

645 
±r
 [
tŸÆ
 + 
k
] = 
n‹mÁ˘
 * 
ùå
 [k] ;

646 
tŸÆ
 +
cou¡
 ;

647 
Àn
 -
ªadcou¡
 ;

649  
tŸÆ
 ;

650 
	}
}

656 
	$∑f24_wrôe_block
 (
SF_PRIVATE
 *
psf
, 
PAF24_PRIVATE
 *
µaf24
)

657 { 
k
, 
√xtßm∂e
, 
ch™√l
 ;

658 *
˝å
 ;

662 i‡(
CPU_IS_LITTLE_ENDIAN
)

663 { 
k
 = 0 ; k < 
PAF24_SAMPLES_PER_BLOCK
 * 
µaf24
->
ch™√ls
 ; k++)

664 { 
ch™√l
 = 
k
 % 
µaf24
->
ch™√ls
 ;

665 
˝å
 = 
µaf24
->
block
 + 
PAF24_BLOCK_SIZE
 * 
ch™√l
 + 3 * (
k
 /Ö∑f24->
ch™√ls
) ;

666 
√xtßm∂e
 = 
µaf24
->
ßm∂es
 [
k
] >> 8 ;

667 
˝å
 [0] = 
√xtßm∂e
 ;

668 
˝å
 [1] = 
√xtßm∂e
 >> 8 ;

669 
˝å
 [2] = 
√xtßm∂e
 >> 16 ;

673 i‡(
psf
->
ídün
 =
SF_ENDIAN_BIG
)

674 
	`ídsw≠_öt_¨øy
 (
µaf24
->
d©a
, 8 *Ö∑f24->
ch™√ls
) ;

676 i‡(
CPU_IS_BIG_ENDIAN
)

678 
k
 = 0 ; k < 
PAF24_SAMPLES_PER_BLOCK
 * 
µaf24
->
ch™√ls
 ; k++)

679 { 
ch™√l
 = 
k
 % 
µaf24
->
ch™√ls
 ;

680 
˝å
 = 
µaf24
->
block
 + 
PAF24_BLOCK_SIZE
 * 
ch™√l
 + 3 * (
k
 /Ö∑f24->
ch™√ls
) ;

681 
√xtßm∂e
 = 
µaf24
->
ßm∂es
 [
k
] >> 8 ;

682 
˝å
 [0] = 
√xtßm∂e
 ;

683 
˝å
 [1] = 
√xtßm∂e
 >> 8 ;

684 
˝å
 [2] = 
√xtßm∂e
 >> 16 ;

686 i‡(
psf
->
ídün
 =
SF_ENDIAN_BIG
)

687 
	`ídsw≠_öt_¨øy
 (
µaf24
->
d©a
, 8 *Ö∑f24->
ch™√ls
) ;

691 i‡((
k
 = 
	`psf_fwrôe
 (
µaf24
->
block
, 1,Ö∑f24->
blocksize
, 
psf
)) !=Öpaf24->blocksize)

692 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög : sh‹àwrôê(%d !%d).\n", 
k
, 
µaf24
->
blocksize
) ;

694 i‡(
µaf24
->
ßm∂e_cou¡
 <Ö∑f24->
wrôe_block
 *Ö∑f24->
ßm∂e•îblock
 +Ö∑f24->
wrôe_cou¡
)

695 
µaf24
->
ßm∂e_cou¡
 =Ö∑f24->
wrôe_block
 *Ö∑f24->
ßm∂e•îblock
 +Ö∑f24->
wrôe_cou¡
 ;

697 i‡(
µaf24
->
wrôe_cou¡
 =µaf24->
ßm∂e•îblock
)

698 { 
µaf24
->
wrôe_block
 ++ ;

699 
µaf24
->
wrôe_cou¡
 = 0 ;

703 
	}
}

706 
	$∑f24_wrôe
 (
SF_PRIVATE
 *
psf
, 
PAF24_PRIVATE
 *
µaf24
, c⁄° *
±r
, 
Àn
)

707 { 
cou¡
, 
tŸÆ
 = 0 ;

709 
tŸÆ
 < 
Àn
)

710 { 
cou¡
 = (
µaf24
->
ßm∂e•îblock
 -Ö∑f24->
wrôe_cou¡
Ë*Ö∑f24->
ch™√ls
 ;

712 i‡(
cou¡
 > 
Àn
 - 
tŸÆ
)

713 
cou¡
 = 
Àn
 - 
tŸÆ
 ;

715 
	`mem˝y
 (&(
µaf24
->
ßm∂es
 [µaf24->
wrôe_cou¡
 *Ö∑f24->
ch™√ls
]), &(
±r
 [
tŸÆ
]), 
cou¡
 *  ()) ;

716 
tŸÆ
 +
cou¡
 ;

717 
µaf24
->
wrôe_cou¡
 +
cou¡
 /Ö∑f24->
ch™√ls
 ;

719 i‡(
µaf24
->
wrôe_cou¡
 >µaf24->
ßm∂e•îblock
)

720 
	`∑f24_wrôe_block
 (
psf
, 
µaf24
) ;

723  
tŸÆ
 ;

724 
	}
}

726 
sf_cou¡_t


727 
	$∑f24_wrôe_s
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

728 { 
PAF24_PRIVATE
 *
µaf24
 ;

729 *
ùå
 ;

730 
k
, 
buf„æí
, 
wrôecou¡
 = 0, 
cou¡
 ;

731 
sf_cou¡_t
 
tŸÆ
 = 0 ;

733 i‡(
psf
->
codec_d©a
 =
NULL
)

735 
µaf24
 = (
PAF24_PRIVATE
*Ë
psf
->
codec_d©a
 ;

737 
ùå
 = 
psf
->
u
.
ibuf
 ;

738 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

739 
Àn
 > 0)

740 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

741 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

742 
ùå
 [
k
] = 
±r
 [
tŸÆ
 + k] << 16 ;

743 
cou¡
 = 
	`∑f24_wrôe
 (
psf
, 
µaf24
, 
ùå
, 
wrôecou¡
) ;

744 
tŸÆ
 +
cou¡
 ;

745 
Àn
 -
wrôecou¡
 ;

746 i‡(
cou¡
 !
wrôecou¡
)

749  
tŸÆ
 ;

750 
	}
}

752 
sf_cou¡_t


753 
	$∑f24_wrôe_i
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

754 { 
PAF24_PRIVATE
 *
µaf24
 ;

755 
wrôecou¡
, 
cou¡
 ;

756 
sf_cou¡_t
 
tŸÆ
 = 0 ;

758 i‡(
psf
->
codec_d©a
 =
NULL
)

760 
µaf24
 = (
PAF24_PRIVATE
*Ë
psf
->
codec_d©a
 ;

762 
Àn
 > 0)

763 { 
wrôecou¡
 = (
Àn
 > 0x10000000) ? 0x10000000 : ()Üen ;

765 
cou¡
 = 
	`∑f24_wrôe
 (
psf
, 
µaf24
, 
±r
, 
wrôecou¡
) ;

767 
tŸÆ
 +
cou¡
 ;

768 
Àn
 -
cou¡
 ;

769 i‡(
cou¡
 !
wrôecou¡
)

773  
tŸÆ
 ;

774 
	}
}

776 
sf_cou¡_t


777 
	$∑f24_wrôe_f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

778 { 
PAF24_PRIVATE
 *
µaf24
 ;

779 *
ùå
 ;

780 
k
, 
buf„æí
, 
wrôecou¡
 = 0, 
cou¡
 ;

781 
sf_cou¡_t
 
tŸÆ
 = 0 ;

782 
n‹mÁ˘
 ;

784 i‡(
psf
->
codec_d©a
 =
NULL
)

786 
µaf24
 = (
PAF24_PRIVATE
*Ë
psf
->
codec_d©a
 ;

788 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? (1.0 * 0x7FFFFFFF) : (1.0 / 0x100) ;

790 
ùå
 = 
psf
->
u
.
ibuf
 ;

791 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

792 
Àn
 > 0)

793 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

794 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

795 
ùå
 [
k
] = 
	`Ãötf
 (
n‹mÁ˘
 * 
±r
 [
tŸÆ
 + k]) ;

796 
cou¡
 = 
	`∑f24_wrôe
 (
psf
, 
µaf24
, 
ùå
, 
wrôecou¡
) ;

797 
tŸÆ
 +
cou¡
 ;

798 
Àn
 -
wrôecou¡
 ;

799 i‡(
cou¡
 !
wrôecou¡
)

803  
tŸÆ
 ;

804 
	}
}

806 
sf_cou¡_t


807 
	$∑f24_wrôe_d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

808 { 
PAF24_PRIVATE
 *
µaf24
 ;

809 *
ùå
 ;

810 
k
, 
buf„æí
, 
wrôecou¡
 = 0, 
cou¡
 ;

811 
sf_cou¡_t
 
tŸÆ
 = 0 ;

812 
n‹mÁ˘
 ;

814 i‡(
psf
->
codec_d©a
 =
NULL
)

816 
µaf24
 = (
PAF24_PRIVATE
*Ë
psf
->
codec_d©a
 ;

818 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? (1.0 * 0x7FFFFFFF) : (1.0 / 0x100) ;

820 
ùå
 = 
psf
->
u
.
ibuf
 ;

821 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

822 
Àn
 > 0)

823 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

824 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

825 
ùå
 [
k
] = 
	`Ãöt
 (
n‹mÁ˘
 * 
±r
 [
tŸÆ
+k]) ;

826 
cou¡
 = 
	`∑f24_wrôe
 (
psf
, 
µaf24
, 
ùå
, 
wrôecou¡
) ;

827 
tŸÆ
 +
cou¡
 ;

828 
Àn
 -
wrôecou¡
 ;

829 i‡(
cou¡
 !
wrôecou¡
)

833  
tŸÆ
 ;

834 
	}
}

	@libsndfile-1.0.17/src/pcm.c

19 
	~"sfc⁄fig.h
"

21 
	~"¢dfûe.h
"

22 
	~"s„ndün.h
"

23 
	~"Êﬂt_ˇ°.h
"

24 
	~"comm⁄.h
"

30 
	tåibyã
 ;

32 
	#SIZEOF_TRIBYTE
 3

	)

34 
sf_cou¡_t
 
pcm_ªad_sc2s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

35 
sf_cou¡_t
 
pcm_ªad_uc2s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

36 
sf_cou¡_t
 
pcm_ªad_bes2s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

37 
sf_cou¡_t
 
pcm_ªad_Às2s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

38 
sf_cou¡_t
 
pcm_ªad_bë2s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

39 
sf_cou¡_t
 
pcm_ªad_Àt2s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

40 
sf_cou¡_t
 
pcm_ªad_bei2s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

41 
sf_cou¡_t
 
pcm_ªad_Ài2s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

43 
sf_cou¡_t
 
pcm_ªad_sc2i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

44 
sf_cou¡_t
 
pcm_ªad_uc2i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

45 
sf_cou¡_t
 
pcm_ªad_bes2i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

46 
sf_cou¡_t
 
pcm_ªad_Às2i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

47 
sf_cou¡_t
 
pcm_ªad_bë2i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

48 
sf_cou¡_t
 
pcm_ªad_Àt2i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

49 
sf_cou¡_t
 
pcm_ªad_bei2i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

50 
sf_cou¡_t
 
pcm_ªad_Ài2i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

52 
sf_cou¡_t
 
pcm_ªad_sc2f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

53 
sf_cou¡_t
 
pcm_ªad_uc2f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

54 
sf_cou¡_t
 
pcm_ªad_bes2f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

55 
sf_cou¡_t
 
pcm_ªad_Às2f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

56 
sf_cou¡_t
 
pcm_ªad_bë2f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

57 
sf_cou¡_t
 
pcm_ªad_Àt2f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

58 
sf_cou¡_t
 
pcm_ªad_bei2f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

59 
sf_cou¡_t
 
pcm_ªad_Ài2f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

61 
sf_cou¡_t
 
pcm_ªad_sc2d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

62 
sf_cou¡_t
 
pcm_ªad_uc2d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

63 
sf_cou¡_t
 
pcm_ªad_bes2d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

64 
sf_cou¡_t
 
pcm_ªad_Às2d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

65 
sf_cou¡_t
 
pcm_ªad_bë2d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

66 
sf_cou¡_t
 
pcm_ªad_Àt2d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

67 
sf_cou¡_t
 
pcm_ªad_bei2d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

68 
sf_cou¡_t
 
pcm_ªad_Ài2d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

70 
sf_cou¡_t
 
pcm_wrôe_s2sc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

71 
sf_cou¡_t
 
pcm_wrôe_s2uc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

72 
sf_cou¡_t
 
pcm_wrôe_s2bes
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

73 
sf_cou¡_t
 
pcm_wrôe_s2Às
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

74 
sf_cou¡_t
 
pcm_wrôe_s2bë
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

75 
sf_cou¡_t
 
pcm_wrôe_s2Àt
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

76 
sf_cou¡_t
 
pcm_wrôe_s2bei
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

77 
sf_cou¡_t
 
pcm_wrôe_s2Ài
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

79 
sf_cou¡_t
 
pcm_wrôe_i2sc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

80 
sf_cou¡_t
 
pcm_wrôe_i2uc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

81 
sf_cou¡_t
 
pcm_wrôe_i2bes
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

82 
sf_cou¡_t
 
pcm_wrôe_i2Às
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

83 
sf_cou¡_t
 
pcm_wrôe_i2bë
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

84 
sf_cou¡_t
 
pcm_wrôe_i2Àt
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

85 
sf_cou¡_t
 
pcm_wrôe_i2bei
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

86 
sf_cou¡_t
 
pcm_wrôe_i2Ài
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

88 
sf_cou¡_t
 
pcm_wrôe_f2sc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

89 
sf_cou¡_t
 
pcm_wrôe_f2uc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

90 
sf_cou¡_t
 
pcm_wrôe_f2bes
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

91 
sf_cou¡_t
 
pcm_wrôe_f2Às
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

92 
sf_cou¡_t
 
pcm_wrôe_f2bë
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

93 
sf_cou¡_t
 
pcm_wrôe_f2Àt
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

94 
sf_cou¡_t
 
pcm_wrôe_f2bei
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

95 
sf_cou¡_t
 
pcm_wrôe_f2Ài
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

97 
sf_cou¡_t
 
pcm_wrôe_d2sc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

98 
sf_cou¡_t
 
pcm_wrôe_d2uc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

99 
sf_cou¡_t
 
pcm_wrôe_d2bes
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

100 
sf_cou¡_t
 
pcm_wrôe_d2Às
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

101 
sf_cou¡_t
 
pcm_wrôe_d2bë
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

102 
sf_cou¡_t
 
pcm_wrôe_d2Àt
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

103 
sf_cou¡_t
 
pcm_wrôe_d2bei
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

104 
sf_cou¡_t
 
pcm_wrôe_d2Ài
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

111 
	mSF_CHARS_SIGNED
 = 200,

112 
	mSF_CHARS_UNSIGNED
 = 201

119 
	$pcm_öô
 (
SF_PRIVATE
 *
psf
)

120 { 
ch¨s
 = 0 ;

122 i‡(
psf
->
byãwidth
 =0 ||Ösf->
sf
.
ch™√ls
 == 0)

123  
SFE_INTERNAL
 ;

125 
psf
->
blockwidth
 =Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

127 i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_PCM_S8
)

128 
ch¨s
 = 
SF_CHARS_SIGNED
 ;

129 i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_PCM_U8
)

130 
ch¨s
 = 
SF_CHARS_UNSIGNED
 ;

132 i‡(
psf
->
mode
 =
SFM_READ
 ||Ösf->modê=
SFM_RDWR
)

133 { 
psf
->
byãwidth
 * 0x10000 +Ösf->
ídün
 + 
ch¨s
)

134 { (0x10000 + 
SF_ENDIAN_BIG
 + 
SF_CHARS_SIGNED
) :

135 (0x10000 + 
SF_ENDIAN_LITTLE
 + 
SF_CHARS_SIGNED
) :

136 
psf
->
ªad_sh‹t
 = 
pcm_ªad_sc2s
 ;

137 
psf
->
ªad_öt
 = 
pcm_ªad_sc2i
 ;

138 
psf
->
ªad_Êﬂt
 = 
pcm_ªad_sc2f
 ;

139 
psf
->
ªad_doubÀ
 = 
pcm_ªad_sc2d
 ;

141 (0x10000 + 
SF_ENDIAN_BIG
 + 
SF_CHARS_UNSIGNED
) :

142 (0x10000 + 
SF_ENDIAN_LITTLE
 + 
SF_CHARS_UNSIGNED
) :

143 
psf
->
ªad_sh‹t
 = 
pcm_ªad_uc2s
 ;

144 
psf
->
ªad_öt
 = 
pcm_ªad_uc2i
 ;

145 
psf
->
ªad_Êﬂt
 = 
pcm_ªad_uc2f
 ;

146 
psf
->
ªad_doubÀ
 = 
pcm_ªad_uc2d
 ;

149 (2 * 0x10000 + 
SF_ENDIAN_BIG
) :

150 
psf
->
ªad_sh‹t
 = 
pcm_ªad_bes2s
 ;

151 
psf
->
ªad_öt
 = 
pcm_ªad_bes2i
 ;

152 
psf
->
ªad_Êﬂt
 = 
pcm_ªad_bes2f
 ;

153 
psf
->
ªad_doubÀ
 = 
pcm_ªad_bes2d
 ;

155 (3 * 0x10000 + 
SF_ENDIAN_BIG
) :

156 
psf
->
ªad_sh‹t
 = 
pcm_ªad_bë2s
 ;

157 
psf
->
ªad_öt
 = 
pcm_ªad_bë2i
 ;

158 
psf
->
ªad_Êﬂt
 = 
pcm_ªad_bë2f
 ;

159 
psf
->
ªad_doubÀ
 = 
pcm_ªad_bë2d
 ;

161 (4 * 0x10000 + 
SF_ENDIAN_BIG
) :

162 
psf
->
ªad_sh‹t
 = 
pcm_ªad_bei2s
 ;

163 
psf
->
ªad_öt
 = 
pcm_ªad_bei2i
 ;

164 
psf
->
ªad_Êﬂt
 = 
pcm_ªad_bei2f
 ;

165 
psf
->
ªad_doubÀ
 = 
pcm_ªad_bei2d
 ;

168 (2 * 0x10000 + 
SF_ENDIAN_LITTLE
) :

169 
psf
->
ªad_sh‹t
 = 
pcm_ªad_Às2s
 ;

170 
psf
->
ªad_öt
 = 
pcm_ªad_Às2i
 ;

171 
psf
->
ªad_Êﬂt
 = 
pcm_ªad_Às2f
 ;

172 
psf
->
ªad_doubÀ
 = 
pcm_ªad_Às2d
 ;

174 (3 * 0x10000 + 
SF_ENDIAN_LITTLE
) :

175 
psf
->
ªad_sh‹t
 = 
pcm_ªad_Àt2s
 ;

176 
psf
->
ªad_öt
 = 
pcm_ªad_Àt2i
 ;

177 
psf
->
ªad_Êﬂt
 = 
pcm_ªad_Àt2f
 ;

178 
psf
->
ªad_doubÀ
 = 
pcm_ªad_Àt2d
 ;

180 (4 * 0x10000 + 
SF_ENDIAN_LITTLE
) :

181 
psf
->
ªad_sh‹t
 = 
pcm_ªad_Ài2s
 ;

182 
psf
->
ªad_öt
 = 
pcm_ªad_Ài2i
 ;

183 
psf
->
ªad_Êﬂt
 = 
pcm_ªad_Ài2f
 ;

184 
psf
->
ªad_doubÀ
 = 
pcm_ªad_Ài2d
 ;

187 
	`psf_log_¥ötf
 (
psf
, "pcm.cÑeturning SFE_UNIMPLEMENTED\n") ;

188  
SFE_UNIMPLEMENTED
 ;

192 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

193 { 
psf
->
byãwidth
 * 0x10000 +Ösf->
ídün
 + 
ch¨s
)

194 { (0x10000 + 
SF_ENDIAN_BIG
 + 
SF_CHARS_SIGNED
) :

195 (0x10000 + 
SF_ENDIAN_LITTLE
 + 
SF_CHARS_SIGNED
) :

196 
psf
->
wrôe_sh‹t
 = 
pcm_wrôe_s2sc
 ;

197 
psf
->
wrôe_öt
 = 
pcm_wrôe_i2sc
 ;

198 
psf
->
wrôe_Êﬂt
 = 
pcm_wrôe_f2sc
 ;

199 
psf
->
wrôe_doubÀ
 = 
pcm_wrôe_d2sc
 ;

201 (0x10000 + 
SF_ENDIAN_BIG
 + 
SF_CHARS_UNSIGNED
) :

202 (0x10000 + 
SF_ENDIAN_LITTLE
 + 
SF_CHARS_UNSIGNED
) :

203 
psf
->
wrôe_sh‹t
 = 
pcm_wrôe_s2uc
 ;

204 
psf
->
wrôe_öt
 = 
pcm_wrôe_i2uc
 ;

205 
psf
->
wrôe_Êﬂt
 = 
pcm_wrôe_f2uc
 ;

206 
psf
->
wrôe_doubÀ
 = 
pcm_wrôe_d2uc
 ;

209 (2 * 0x10000 + 
SF_ENDIAN_BIG
) :

210 
psf
->
wrôe_sh‹t
 = 
pcm_wrôe_s2bes
 ;

211 
psf
->
wrôe_öt
 = 
pcm_wrôe_i2bes
 ;

212 
psf
->
wrôe_Êﬂt
 = 
pcm_wrôe_f2bes
 ;

213 
psf
->
wrôe_doubÀ
 = 
pcm_wrôe_d2bes
 ;

216 (3 * 0x10000 + 
SF_ENDIAN_BIG
) :

217 
psf
->
wrôe_sh‹t
 = 
pcm_wrôe_s2bë
 ;

218 
psf
->
wrôe_öt
 = 
pcm_wrôe_i2bë
 ;

219 
psf
->
wrôe_Êﬂt
 = 
pcm_wrôe_f2bë
 ;

220 
psf
->
wrôe_doubÀ
 = 
pcm_wrôe_d2bë
 ;

223 (4 * 0x10000 + 
SF_ENDIAN_BIG
) :

224 
psf
->
wrôe_sh‹t
 = 
pcm_wrôe_s2bei
 ;

225 
psf
->
wrôe_öt
 = 
pcm_wrôe_i2bei
 ;

226 
psf
->
wrôe_Êﬂt
 = 
pcm_wrôe_f2bei
 ;

227 
psf
->
wrôe_doubÀ
 = 
pcm_wrôe_d2bei
 ;

230 (2 * 0x10000 + 
SF_ENDIAN_LITTLE
) :

231 
psf
->
wrôe_sh‹t
 = 
pcm_wrôe_s2Às
 ;

232 
psf
->
wrôe_öt
 = 
pcm_wrôe_i2Às
 ;

233 
psf
->
wrôe_Êﬂt
 = 
pcm_wrôe_f2Às
 ;

234 
psf
->
wrôe_doubÀ
 = 
pcm_wrôe_d2Às
 ;

237 (3 * 0x10000 + 
SF_ENDIAN_LITTLE
) :

238 
psf
->
wrôe_sh‹t
 = 
pcm_wrôe_s2Àt
 ;

239 
psf
->
wrôe_öt
 = 
pcm_wrôe_i2Àt
 ;

240 
psf
->
wrôe_Êﬂt
 = 
pcm_wrôe_f2Àt
 ;

241 
psf
->
wrôe_doubÀ
 = 
pcm_wrôe_d2Àt
 ;

244 (4 * 0x10000 + 
SF_ENDIAN_LITTLE
) :

245 
psf
->
wrôe_sh‹t
 = 
pcm_wrôe_s2Ài
 ;

246 
psf
->
wrôe_öt
 = 
pcm_wrôe_i2Ài
 ;

247 
psf
->
wrôe_Êﬂt
 = 
pcm_wrôe_f2Ài
 ;

248 
psf
->
wrôe_doubÀ
 = 
pcm_wrôe_d2Ài
 ;

252 
	`psf_log_¥ötf
 (
psf
, "pcm.cÑeturning SFE_UNIMPLEMENTED\n") ;

253  
SFE_UNIMPLEMENTED
 ;

258 i‡(
psf
->
fûñígth
 >Ösf->
d©aoff£t
)

259 { 
psf
->
d©Æígth
 = (psf->
d©´nd
 > 0Ë?Ösf->d©´nd -Ösf->
d©aoff£t
 :

260 
psf
->
fûñígth
 -Ösf->
d©aoff£t
 ;

263 
psf
->
d©Æígth
 = 0 ;

265 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 /Ösf->
blockwidth
 ;

268 
	}
}

273 
ölöe
 

274 
	$sc2s_¨øy
 (sig√d *
§c
, 
cou¡
, *
de°
)

275 { --
cou¡
 >= 0)

276 { 
de°
 [
cou¡
] = 
§c
 [count] << 8 ;

278 
	}
}

280 
ölöe
 

281 
	$uc2s_¨øy
 (*
§c
, 
cou¡
, *
de°
)

282 { --
cou¡
 >= 0)

283 { 
de°
 [
cou¡
] = (((Ë
§c
 [count]) - 0x80) << 8 ;

285 
	}
}

287 
ölöe
 

288 
	$Àt2s_¨øy
 (
åibyã
 *
§c
, 
cou¡
, *
de°
)

289 { *
u˝å
 ;

291 
u˝å
 = ((*Ë
§c
Ë+ 3 * 
cou¡
 ;

292 --
cou¡
 >= 0)

293 { 
u˝å
 -= 3 ;

294 
de°
 [
cou¡
] = 
	`LET2H_SHORT_PTR
 (
u˝å
) ;

296 
	}
}

298 
ölöe
 

299 
	$bë2s_¨øy
 (
åibyã
 *
§c
, 
cou¡
, *
de°
)

300 { *
u˝å
 ;

302 
u˝å
 = ((*Ë
§c
Ë+ 3 * 
cou¡
 ;

303 --
cou¡
 >= 0)

304 { 
u˝å
 -= 3 ;

305 
de°
 [
cou¡
] = 
	`BET2H_SHORT_PTR
 (
u˝å
) ;

307 
	}
}

309 
ölöe
 

310 
	$Ài2s_¨øy
 (*
§c
, 
cou¡
, *
de°
)

311 { 
vÆue
 ;

313 --
cou¡
 >= 0)

314 { 
vÆue
 = 
	`LEI2H_INT
 (
§c
 [
cou¡
]) ;

315 
de°
 [
cou¡
] = 
vÆue
 >> 16 ;

317 
	}
}

319 
ölöe
 

320 
	$bei2s_¨øy
 (*
§c
, 
cou¡
, *
de°
)

321 { 
vÆue
 ;

323 --
cou¡
 >= 0)

324 { 
vÆue
 = 
	`BEI2H_INT
 (
§c
 [
cou¡
]) ;

325 
de°
 [
cou¡
] = 
vÆue
 >> 16 ;

327 
	}
}

332 
ölöe
 

333 
	$sc2i_¨øy
 (sig√d *
§c
, 
cou¡
, *
de°
)

334 { --
cou¡
 >= 0)

335 { 
de°
 [
cou¡
] = ((Ë
§c
 [count]) << 24 ;

337 
	}
}

339 
ölöe
 

340 
	$uc2i_¨øy
 (*
§c
, 
cou¡
, *
de°
)

341 { --
cou¡
 >= 0)

342 { 
de°
 [
cou¡
] = (((Ë
§c
 [count]) - 128) << 24 ;

344 
	}
}

346 
ölöe
 

347 
	$bes2i_¨øy
 (*
§c
, 
cou¡
, *
de°
)

348 { 
vÆue
 ;

350 --
cou¡
 >= 0)

351 { 
vÆue
 = 
	`BES2H_SHORT
 (
§c
 [
cou¡
]) ;

352 
de°
 [
cou¡
] = 
vÆue
 << 16 ;

354 
	}
}

356 
ölöe
 

357 
	$Às2i_¨øy
 (*
§c
, 
cou¡
, *
de°
)

358 { 
vÆue
 ;

360 --
cou¡
 >= 0)

361 { 
vÆue
 = 
	`LES2H_SHORT
 (
§c
 [
cou¡
]) ;

362 
de°
 [
cou¡
] = 
vÆue
 << 16 ;

364 
	}
}

366 
ölöe
 

367 
	$bë2i_¨øy
 (
åibyã
 *
§c
, 
cou¡
, *
de°
)

368 { *
u˝å
 ;

370 
u˝å
 = ((*Ë
§c
Ë+ 3 * 
cou¡
 ;

371 --
cou¡
 >= 0)

372 { 
u˝å
 -= 3 ;

373 
de°
 [
cou¡
] = 
	`BET2H_INT_PTR
 (
u˝å
) ;

375 
	}
}

377 
ölöe
 

378 
	$Àt2i_¨øy
 (
åibyã
 *
§c
, 
cou¡
, *
de°
)

379 { *
u˝å
 ;

381 
u˝å
 = ((*Ë
§c
Ë+ 3 * 
cou¡
 ;

382 --
cou¡
 >= 0)

383 { 
u˝å
 -= 3 ;

384 
de°
 [
cou¡
] = 
	`LET2H_INT_PTR
 (
u˝å
) ;

386 
	}
}

391 
ölöe
 

392 
	$sc2f_¨øy
 (sig√d *
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
)

393 { --
cou¡
 >= 0)

394 
de°
 [
cou¡
] = ((Ë
§c
 [cou¡]Ë* 
n‹mÁ˘
 ;

395 
	}
}

397 
ölöe
 

398 
	$uc2f_¨øy
 (*
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
)

399 { --
cou¡
 >= 0)

400 
de°
 [
cou¡
] = (((Ë
§c
 [cou¡]Ë- 128Ë* 
n‹mÁ˘
 ;

401 
	}
}

403 
ölöe
 

404 
	$Às2f_¨øy
 (*
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
)

405 { 
vÆue
 ;

407 --
cou¡
 >= 0)

408 { 
vÆue
 = 
§c
 [
cou¡
] ;

409 
vÆue
 = 
	`LES2H_SHORT
 (value) ;

410 
de°
 [
cou¡
] = ((Ë
vÆue
Ë* 
n‹mÁ˘
 ;

412 
	}
}

414 
ölöe
 

415 
	$bes2f_¨øy
 (*
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
)

416 { 
vÆue
 ;

418 --
cou¡
 >= 0)

419 { 
vÆue
 = 
§c
 [
cou¡
] ;

420 
vÆue
 = 
	`BES2H_SHORT
 (value) ;

421 
de°
 [
cou¡
] = ((Ë
vÆue
Ë* 
n‹mÁ˘
 ;

423 
	}
}

425 
ölöe
 

426 
	$Àt2f_¨øy
 (
åibyã
 *
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
)

427 { *
u˝å
 ;

428 
vÆue
 ;

430 
u˝å
 = ((*Ë
§c
Ë+ 3 * 
cou¡
 ;

431 --
cou¡
 >= 0)

432 { 
u˝å
 -= 3 ;

433 
vÆue
 = 
	`LET2H_INT_PTR
 (
u˝å
) ;

434 
de°
 [
cou¡
] = ((Ë
vÆue
Ë* 
n‹mÁ˘
 ;

436 
	}
}

438 
ölöe
 

439 
	$bë2f_¨øy
 (
åibyã
 *
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
)

440 { *
u˝å
 ;

441 
vÆue
 ;

443 
u˝å
 = ((*Ë
§c
Ë+ 3 * 
cou¡
 ;

444 --
cou¡
 >= 0)

445 { 
u˝å
 -= 3 ;

446 
vÆue
 = 
	`BET2H_INT_PTR
 (
u˝å
) ;

447 
de°
 [
cou¡
] = ((Ë
vÆue
Ë* 
n‹mÁ˘
 ;

449 
	}
}

451 
ölöe
 

452 
	$Ài2f_¨øy
 (*
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
)

453 { 
vÆue
 ;

455 --
cou¡
 >= 0)

456 { 
vÆue
 = 
§c
 [
cou¡
] ;

457 
vÆue
 = 
	`LEI2H_INT
 (value) ;

458 
de°
 [
cou¡
] = ((Ë
vÆue
Ë* 
n‹mÁ˘
 ;

460 
	}
}

462 
ölöe
 

463 
	$bei2f_¨øy
 (*
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
)

464 { 
vÆue
 ;

466 --
cou¡
 >= 0)

467 { 
vÆue
 = 
§c
 [
cou¡
] ;

468 
vÆue
 = 
	`BEI2H_INT
 (value) ;

469 
de°
 [
cou¡
] = ((Ë
vÆue
Ë* 
n‹mÁ˘
 ;

471 
	}
}

476 
ölöe
 

477 
	$sc2d_¨øy
 (sig√d *
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
)

478 { --
cou¡
 >= 0)

479 
de°
 [
cou¡
] = ((Ë
§c
 [cou¡]Ë* 
n‹mÁ˘
 ;

480 
	}
}

482 
ölöe
 

483 
	$uc2d_¨øy
 (*
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
)

484 { --
cou¡
 >= 0)

485 
de°
 [
cou¡
] = (((Ë
§c
 [cou¡]Ë- 128Ë* 
n‹mÁ˘
 ;

486 
	}
}

488 
ölöe
 

489 
	$Às2d_¨øy
 (*
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
)

490 { 
vÆue
 ;

492 --
cou¡
 >= 0)

493 { 
vÆue
 = 
§c
 [
cou¡
] ;

494 
vÆue
 = 
	`LES2H_SHORT
 (value) ;

495 
de°
 [
cou¡
] = ((Ë
vÆue
Ë* 
n‹mÁ˘
 ;

497 
	}
}

499 
ölöe
 

500 
	$bes2d_¨øy
 (*
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
)

501 { 
vÆue
 ;

503 --
cou¡
 >= 0)

504 { 
vÆue
 = 
§c
 [
cou¡
] ;

505 
vÆue
 = 
	`BES2H_SHORT
 (value) ;

506 
de°
 [
cou¡
] = ((Ë
vÆue
Ë* 
n‹mÁ˘
 ;

508 
	}
}

510 
ölöe
 

511 
	$Àt2d_¨øy
 (
åibyã
 *
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
)

512 { *
u˝å
 ;

513 
vÆue
 ;

515 
u˝å
 = ((*Ë
§c
Ë+ 3 * 
cou¡
 ;

516 --
cou¡
 >= 0)

517 { 
u˝å
 -= 3 ;

518 
vÆue
 = 
	`LET2H_INT_PTR
 (
u˝å
) ;

519 
de°
 [
cou¡
] = ((Ë
vÆue
Ë* 
n‹mÁ˘
 ;

521 
	}
}

523 
ölöe
 

524 
	$bë2d_¨øy
 (
åibyã
 *
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
)

525 { *
u˝å
 ;

526 
vÆue
 ;

528 
u˝å
 = ((*Ë
§c
Ë+ 3 * 
cou¡
 ;

529 --
cou¡
 >= 0)

530 { 
u˝å
 -= 3 ;

531 
vÆue
 = (
u˝å
 [0] << 24) | (ucptr [1] << 16) | (ucptr [2] << 8) ;

532 
de°
 [
cou¡
] = ((Ë
vÆue
Ë* 
n‹mÁ˘
 ;

534 
	}
}

536 
ölöe
 

537 
	$Ài2d_¨øy
 (*
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
)

538 { 
vÆue
 ;

540 --
cou¡
 >= 0)

541 { 
vÆue
 = 
§c
 [
cou¡
] ;

542 
vÆue
 = 
	`LEI2H_INT
 (value) ;

543 
de°
 [
cou¡
] = ((Ë
vÆue
Ë* 
n‹mÁ˘
 ;

545 
	}
}

547 
ölöe
 

548 
	$bei2d_¨øy
 (*
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
)

549 { 
vÆue
 ;

551 --
cou¡
 >= 0)

552 { 
vÆue
 = 
§c
 [
cou¡
] ;

553 
vÆue
 = 
	`BEI2H_INT
 (value) ;

554 
de°
 [
cou¡
] = ((Ë
vÆue
Ë* 
n‹mÁ˘
 ;

556 
	}
}

561 
ölöe
 

562 
	$s2sc_¨øy
 (c⁄° *
§c
, sig√d *
de°
, 
cou¡
)

563 { --
cou¡
 >= 0)

564 
de°
 [
cou¡
] = 
§c
 [count] >> 8 ;

565 
	}
}

567 
ölöe
 

568 
	$s2uc_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
)

569 { --
cou¡
 >= 0)

570 
de°
 [
cou¡
] = (
§c
 [count] >> 8) + 0x80 ;

571 
	}
}

573 
ölöe
 

574 
	$s2Àt_¨øy
 (c⁄° *
§c
, 
åibyã
 *
de°
, 
cou¡
)

575 { *
u˝å
 ;

577 
u˝å
 = ((*Ë
de°
Ë+ 3 * 
cou¡
 ;

578 --
cou¡
 >= 0)

579 { 
u˝å
 -= 3 ;

580 
u˝å
 [0] = 0 ;

581 
u˝å
 [1] = 
§c
 [
cou¡
] ;

582 
u˝å
 [2] = 
§c
 [
cou¡
] >> 8 ;

584 
	}
}

586 
ölöe
 

587 
	$s2bë_¨øy
 (c⁄° *
§c
, 
åibyã
 *
de°
, 
cou¡
)

588 { *
u˝å
 ;

590 
u˝å
 = ((*Ë
de°
Ë+ 3 * 
cou¡
 ;

591 --
cou¡
 >= 0)

592 { 
u˝å
 -= 3 ;

593 
u˝å
 [2] = 0 ;

594 
u˝å
 [1] = 
§c
 [
cou¡
] ;

595 
u˝å
 [0] = 
§c
 [
cou¡
] >> 8 ;

597 
	}
}

599 
ölöe
 

600 
	$s2Ài_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
)

601 { *
u˝å
 ;

603 
u˝å
 = ((*Ë
de°
Ë+ 4 * 
cou¡
 ;

604 --
cou¡
 >= 0)

605 { 
u˝å
 -= 4 ;

606 
u˝å
 [0] = 0 ;

607 
u˝å
 [1] = 0 ;

608 
u˝å
 [2] = 
§c
 [
cou¡
] ;

609 
u˝å
 [3] = 
§c
 [
cou¡
] >> 8 ;

611 
	}
}

613 
ölöe
 

614 
	$s2bei_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
)

615 { *
u˝å
 ;

617 
u˝å
 = ((*Ë
de°
Ë+ 4 * 
cou¡
 ;

618 --
cou¡
 >= 0)

619 { 
u˝å
 -= 4 ;

620 
u˝å
 [0] = 
§c
 [
cou¡
] >> 8 ;

621 
u˝å
 [1] = 
§c
 [
cou¡
] ;

622 
u˝å
 [2] = 0 ;

623 
u˝å
 [3] = 0 ;

625 
	}
}

630 
ölöe
 

631 
	$i2sc_¨øy
 (c⁄° *
§c
, sig√d *
de°
, 
cou¡
)

632 { --
cou¡
 >= 0)

633 
de°
 [
cou¡
] = (
§c
 [count] >> 24) ;

634 
	}
}

636 
ölöe
 

637 
	$i2uc_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
)

638 { --
cou¡
 >= 0)

639 
de°
 [
cou¡
] = ((
§c
 [count] >> 24) + 128) ;

640 
	}
}

642 
ölöe
 

643 
	$i2bes_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
)

644 { *
u˝å
 ;

646 
u˝å
 = ((*Ë
de°
Ë+ 2 * 
cou¡
 ;

647 --
cou¡
 >= 0)

648 { 
u˝å
 -= 2 ;

649 
u˝å
 [0] = 
§c
 [
cou¡
] >> 24 ;

650 
u˝å
 [1] = 
§c
 [
cou¡
] >> 16 ;

652 
	}
}

654 
ölöe
 

655 
	$i2Às_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
)

656 { *
u˝å
 ;

658 
u˝å
 = ((*Ë
de°
Ë+ 2 * 
cou¡
 ;

659 --
cou¡
 >= 0)

660 { 
u˝å
 -= 2 ;

661 
u˝å
 [0] = 
§c
 [
cou¡
] >> 16 ;

662 
u˝å
 [1] = 
§c
 [
cou¡
] >> 24 ;

664 
	}
}

666 
ölöe
 

667 
	$i2Àt_¨øy
 (c⁄° *
§c
, 
åibyã
 *
de°
, 
cou¡
)

668 { *
u˝å
 ;

669 
vÆue
 ;

671 
u˝å
 = ((*Ë
de°
Ë+ 3 * 
cou¡
 ;

672 --
cou¡
 >= 0)

673 { 
u˝å
 -= 3 ;

674 
vÆue
 = 
§c
 [
cou¡
] >> 8 ;

675 
u˝å
 [0] = 
vÆue
 ;

676 
u˝å
 [1] = 
vÆue
 >> 8 ;

677 
u˝å
 [2] = 
vÆue
 >> 16 ;

679 
	}
}

681 
ölöe
 

682 
	$i2bë_¨øy
 (c⁄° *
§c
, 
åibyã
 *
de°
, 
cou¡
)

683 { *
u˝å
 ;

684 
vÆue
 ;

686 
u˝å
 = ((*Ë
de°
Ë+ 3 * 
cou¡
 ;

687 --
cou¡
 >= 0)

688 { 
u˝å
 -= 3 ;

689 
vÆue
 = 
§c
 [
cou¡
] >> 8 ;

690 
u˝å
 [2] = 
vÆue
 ;

691 
u˝å
 [1] = 
vÆue
 >> 8 ;

692 
u˝å
 [0] = 
vÆue
 >> 16 ;

694 
	}
}

699 
sf_cou¡_t


700 
	$pcm_ªad_sc2s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

701 { 
buf„æí
, 
ªadcou¡
 ;

702 
sf_cou¡_t
 
tŸÆ
 = 0 ;

704 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
scbuf
) ;

706 
Àn
 > 0)

707 { i‡(
Àn
 < 
buf„æí
)

708 
buf„æí
 = (Ë
Àn
 ;

709 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
scbuf
,  (sig√d ), 
buf„æí
,Ösf) ;

710 
	`sc2s_¨øy
 (
psf
->
u
.
scbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

711 
tŸÆ
 +
ªadcou¡
 ;

712 i‡(
ªadcou¡
 < 
buf„æí
)

714 
Àn
 -
ªadcou¡
 ;

717  
tŸÆ
 ;

718 
	}
}

720 
sf_cou¡_t


721 
	$pcm_ªad_uc2s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

722 { 
buf„æí
, 
ªadcou¡
 ;

723 
sf_cou¡_t
 
tŸÆ
 = 0 ;

725 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

727 
Àn
 > 0)

728 { i‡(
Àn
 < 
buf„æí
)

729 
buf„æí
 = (Ë
Àn
 ;

730 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ucbuf
,  (), 
buf„æí
,Ösf) ;

731 
	`uc2s_¨øy
 (
psf
->
u
.
ucbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

732 
tŸÆ
 +
ªadcou¡
 ;

733 i‡(
ªadcou¡
 < 
buf„æí
)

735 
Àn
 -
ªadcou¡
 ;

738  
tŸÆ
 ;

739 
	}
}

741 
sf_cou¡_t


742 
	$pcm_ªad_bes2s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

743 { 
tŸÆ
 ;

745 
tŸÆ
 = 
	`psf_‰ód
 (
±r
,  (), 
Àn
, 
psf
) ;

746 i‡(
CPU_IS_LITTLE_ENDIAN
)

747 
	`ídsw≠_sh‹t_¨øy
 (
±r
, 
Àn
) ;

749  
tŸÆ
 ;

750 
	}
}

752 
sf_cou¡_t


753 
	$pcm_ªad_Às2s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

754 { 
tŸÆ
 ;

756 
tŸÆ
 = 
	`psf_‰ód
 (
±r
,  (), 
Àn
, 
psf
) ;

757 i‡(
CPU_IS_BIG_ENDIAN
)

758 
	`ídsw≠_sh‹t_¨øy
 (
±r
, 
Àn
) ;

760  
tŸÆ
 ;

761 
	}
}

763 
sf_cou¡_t


764 
	$pcm_ªad_bë2s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

765 { 
buf„æí
, 
ªadcou¡
 ;

766 
sf_cou¡_t
 
tŸÆ
 = 0 ;

768 
buf„æí
 =  (
psf
->
u
.
ucbuf
Ë/ 
SIZEOF_TRIBYTE
 ;

770 
Àn
 > 0)

771 { i‡(
Àn
 < 
buf„æí
)

772 
buf„æí
 = (Ë
Àn
 ;

773 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ucbuf
, 
SIZEOF_TRIBYTE
, 
buf„æí
,Ösf) ;

774 
	`bë2s_¨øy
 ((
åibyã
*Ë(
psf
->
u
.
ucbuf
), 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

775 
tŸÆ
 +
ªadcou¡
 ;

776 i‡(
ªadcou¡
 < 
buf„æí
)

778 
Àn
 -
ªadcou¡
 ;

781  
tŸÆ
 ;

782 
	}
}

784 
sf_cou¡_t


785 
	$pcm_ªad_Àt2s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

786 { 
buf„æí
, 
ªadcou¡
 ;

787 
sf_cou¡_t
 
tŸÆ
 = 0 ;

789 
buf„æí
 =  (
psf
->
u
.
ucbuf
Ë/ 
SIZEOF_TRIBYTE
 ;

791 
Àn
 > 0)

792 { i‡(
Àn
 < 
buf„æí
)

793 
buf„æí
 = (Ë
Àn
 ;

794 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ucbuf
, 
SIZEOF_TRIBYTE
, 
buf„æí
,Ösf) ;

795 
	`Àt2s_¨øy
 ((
åibyã
*Ë(
psf
->
u
.
ucbuf
), 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

796 
tŸÆ
 +
ªadcou¡
 ;

797 i‡(
ªadcou¡
 < 
buf„æí
)

799 
Àn
 -
ªadcou¡
 ;

802  
tŸÆ
 ;

803 
	}
}

805 
sf_cou¡_t


806 
	$pcm_ªad_bei2s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

807 { 
buf„æí
, 
ªadcou¡
 ;

808 
sf_cou¡_t
 
tŸÆ
 = 0 ;

810 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

812 
Àn
 > 0)

813 { i‡(
Àn
 < 
buf„æí
)

814 
buf„æí
 = (Ë
Àn
 ;

815 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ibuf
,  (), 
buf„æí
,Ösf) ;

816 
	`bei2s_¨øy
 (
psf
->
u
.
ibuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

817 
tŸÆ
 +
ªadcou¡
 ;

818 i‡(
ªadcou¡
 < 
buf„æí
)

820 
Àn
 -
ªadcou¡
 ;

823  
tŸÆ
 ;

824 
	}
}

826 
sf_cou¡_t


827 
	$pcm_ªad_Ài2s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

828 { 
buf„æí
, 
ªadcou¡
 ;

829 
sf_cou¡_t
 
tŸÆ
 = 0 ;

831 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

833 
Àn
 > 0)

834 { i‡(
Àn
 < 
buf„æí
)

835 
buf„æí
 = (Ë
Àn
 ;

836 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ibuf
,  (), 
buf„æí
,Ösf) ;

837 
	`Ài2s_¨øy
 (
psf
->
u
.
ibuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

838 
tŸÆ
 +
ªadcou¡
 ;

839 i‡(
ªadcou¡
 < 
buf„æí
)

841 
Àn
 -
ªadcou¡
 ;

844  
tŸÆ
 ;

845 
	}
}

850 
sf_cou¡_t


851 
	$pcm_ªad_sc2i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

852 { 
buf„æí
, 
ªadcou¡
 ;

853 
sf_cou¡_t
 
tŸÆ
 = 0 ;

855 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
scbuf
) ;

857 
Àn
 > 0)

858 { i‡(
Àn
 < 
buf„æí
)

859 
buf„æí
 = (Ë
Àn
 ;

860 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
scbuf
,  (sig√d ), 
buf„æí
,Ösf) ;

861 
	`sc2i_¨øy
 (
psf
->
u
.
scbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

862 
tŸÆ
 +
ªadcou¡
 ;

863 i‡(
ªadcou¡
 < 
buf„æí
)

865 
Àn
 -
ªadcou¡
 ;

868  
tŸÆ
 ;

869 
	}
}

871 
sf_cou¡_t


872 
	$pcm_ªad_uc2i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

873 { 
buf„æí
, 
ªadcou¡
 ;

874 
sf_cou¡_t
 
tŸÆ
 = 0 ;

876 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

878 
Àn
 > 0)

879 { i‡(
Àn
 < 
buf„æí
)

880 
buf„æí
 = (Ë
Àn
 ;

881 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ucbuf
,  (), 
buf„æí
,Ösf) ;

882 
	`uc2i_¨øy
 (
psf
->
u
.
ucbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

883 
tŸÆ
 +
ªadcou¡
 ;

884 i‡(
ªadcou¡
 < 
buf„æí
)

886 
Àn
 -
ªadcou¡
 ;

889  
tŸÆ
 ;

890 
	}
}

892 
sf_cou¡_t


893 
	$pcm_ªad_bes2i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

894 { 
buf„æí
, 
ªadcou¡
 ;

895 
sf_cou¡_t
 
tŸÆ
 = 0 ;

897 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

899 
Àn
 > 0)

900 { i‡(
Àn
 < 
buf„æí
)

901 
buf„æí
 = (Ë
Àn
 ;

902 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
sbuf
,  (), 
buf„æí
,Ösf) ;

903 
	`bes2i_¨øy
 (
psf
->
u
.
sbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

904 
tŸÆ
 +
ªadcou¡
 ;

905 i‡(
ªadcou¡
 < 
buf„æí
)

907 
Àn
 -
ªadcou¡
 ;

910  
tŸÆ
 ;

911 
	}
}

913 
sf_cou¡_t


914 
	$pcm_ªad_Às2i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

915 { 
buf„æí
, 
ªadcou¡
 ;

916 
sf_cou¡_t
 
tŸÆ
 = 0 ;

918 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

920 
Àn
 > 0)

921 { i‡(
Àn
 < 
buf„æí
)

922 
buf„æí
 = (Ë
Àn
 ;

923 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
sbuf
,  (), 
buf„æí
,Ösf) ;

924 
	`Às2i_¨øy
 (
psf
->
u
.
sbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

925 
tŸÆ
 +
ªadcou¡
 ;

926 i‡(
ªadcou¡
 < 
buf„æí
)

928 
Àn
 -
ªadcou¡
 ;

931  
tŸÆ
 ;

932 
	}
}

934 
sf_cou¡_t


935 
	$pcm_ªad_bë2i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

936 { 
buf„æí
, 
ªadcou¡
 ;

937 
sf_cou¡_t
 
tŸÆ
 = 0 ;

939 
buf„æí
 =  (
psf
->
u
.
ucbuf
Ë/ 
SIZEOF_TRIBYTE
 ;

941 
Àn
 > 0)

942 { i‡(
Àn
 < 
buf„æí
)

943 
buf„æí
 = (Ë
Àn
 ;

944 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ucbuf
, 
SIZEOF_TRIBYTE
, 
buf„æí
,Ösf) ;

945 
	`bë2i_¨øy
 ((
åibyã
*Ë(
psf
->
u
.
ucbuf
), 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

946 
tŸÆ
 +
ªadcou¡
 ;

947 i‡(
ªadcou¡
 < 
buf„æí
)

949 
Àn
 -
ªadcou¡
 ;

952  
tŸÆ
 ;

953 
	}
}

955 
sf_cou¡_t


956 
	$pcm_ªad_Àt2i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

957 { 
buf„æí
, 
ªadcou¡
 ;

958 
sf_cou¡_t
 
tŸÆ
 = 0 ;

960 
buf„æí
 =  (
psf
->
u
.
ucbuf
Ë/ 
SIZEOF_TRIBYTE
 ;

962 
Àn
 > 0)

963 { i‡(
Àn
 < 
buf„æí
)

964 
buf„æí
 = (Ë
Àn
 ;

965 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ucbuf
, 
SIZEOF_TRIBYTE
, 
buf„æí
,Ösf) ;

966 
	`Àt2i_¨øy
 ((
åibyã
*Ë(
psf
->
u
.
ucbuf
), 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

967 
tŸÆ
 +
ªadcou¡
 ;

968 i‡(
ªadcou¡
 < 
buf„æí
)

970 
Àn
 -
ªadcou¡
 ;

973  
tŸÆ
 ;

974 
	}
}

976 
sf_cou¡_t


977 
	$pcm_ªad_bei2i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

978 { 
tŸÆ
 ;

980 
tŸÆ
 = 
	`psf_‰ód
 (
±r
,  (), 
Àn
, 
psf
) ;

981 i‡(
CPU_IS_LITTLE_ENDIAN
)

982 
	`ídsw≠_öt_¨øy
 (
±r
, 
Àn
) ;

984  
tŸÆ
 ;

985 
	}
}

987 
sf_cou¡_t


988 
	$pcm_ªad_Ài2i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

989 { 
tŸÆ
 ;

991 
tŸÆ
 = 
	`psf_‰ód
 (
±r
,  (), 
Àn
, 
psf
) ;

992 i‡(
CPU_IS_BIG_ENDIAN
)

993 
	`ídsw≠_öt_¨øy
 (
±r
, 
Àn
) ;

995  
tŸÆ
 ;

996 
	}
}

1001 
sf_cou¡_t


1002 
	$pcm_ªad_sc2f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

1003 { 
buf„æí
, 
ªadcou¡
 ;

1004 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1005 
n‹mÁ˘
 ;

1007 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? 1.0 / (() 0x80) : 1.0 ;

1009 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
scbuf
) ;

1011 
Àn
 > 0)

1012 { i‡(
Àn
 < 
buf„æí
)

1013 
buf„æí
 = (Ë
Àn
 ;

1014 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
scbuf
,  (sig√d ), 
buf„æí
,Ösf) ;

1015 
	`sc2f_¨øy
 (
psf
->
u
.
scbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

1016 
tŸÆ
 +
ªadcou¡
 ;

1017 i‡(
ªadcou¡
 < 
buf„æí
)

1019 
Àn
 -
ªadcou¡
 ;

1022  
tŸÆ
 ;

1023 
	}
}

1025 
sf_cou¡_t


1026 
	$pcm_ªad_uc2f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

1027 { 
buf„æí
, 
ªadcou¡
 ;

1028 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1029 
n‹mÁ˘
 ;

1031 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? 1.0 / (() 0x80) : 1.0 ;

1033 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

1035 
Àn
 > 0)

1036 { i‡(
Àn
 < 
buf„æí
)

1037 
buf„æí
 = (Ë
Àn
 ;

1038 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ucbuf
,  (), 
buf„æí
,Ösf) ;

1039 
	`uc2f_¨øy
 (
psf
->
u
.
ucbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

1040 
tŸÆ
 +
ªadcou¡
 ;

1041 i‡(
ªadcou¡
 < 
buf„æí
)

1043 
Àn
 -
ªadcou¡
 ;

1046  
tŸÆ
 ;

1047 
	}
}

1049 
sf_cou¡_t


1050 
	$pcm_ªad_bes2f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

1051 { 
buf„æí
, 
ªadcou¡
 ;

1052 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1053 
n‹mÁ˘
 ;

1055 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? 1.0 / (() 0x8000) : 1.0 ;

1057 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

1059 
Àn
 > 0)

1060 { i‡(
Àn
 < 
buf„æí
)

1061 
buf„æí
 = (Ë
Àn
 ;

1062 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
sbuf
,  (), 
buf„æí
,Ösf) ;

1063 
	`bes2f_¨øy
 (
psf
->
u
.
sbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

1064 
tŸÆ
 +
ªadcou¡
 ;

1065 i‡(
ªadcou¡
 < 
buf„æí
)

1067 
Àn
 -
ªadcou¡
 ;

1070  
tŸÆ
 ;

1071 
	}
}

1073 
sf_cou¡_t


1074 
	$pcm_ªad_Às2f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

1075 { 
buf„æí
, 
ªadcou¡
 ;

1076 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1077 
n‹mÁ˘
 ;

1079 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? 1.0 / (() 0x8000) : 1.0 ;

1081 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

1083 
Àn
 > 0)

1084 { i‡(
Àn
 < 
buf„æí
)

1085 
buf„æí
 = (Ë
Àn
 ;

1086 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
sbuf
,  (), 
buf„æí
,Ösf) ;

1087 
	`Às2f_¨øy
 (
psf
->
u
.
sbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

1088 
tŸÆ
 +
ªadcou¡
 ;

1089 i‡(
ªadcou¡
 < 
buf„æí
)

1091 
Àn
 -
ªadcou¡
 ;

1094  
tŸÆ
 ;

1095 
	}
}

1097 
sf_cou¡_t


1098 
	$pcm_ªad_bë2f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

1099 { 
buf„æí
, 
ªadcou¡
 ;

1100 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1101 
n‹mÁ˘
 ;

1104 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? 1.0 / (() 0x80000000) : 1.0 / 256.0 ;

1106 
buf„æí
 =  (
psf
->
u
.
ucbuf
Ë/ 
SIZEOF_TRIBYTE
 ;

1108 
Àn
 > 0)

1109 { i‡(
Àn
 < 
buf„æí
)

1110 
buf„æí
 = (Ë
Àn
 ;

1111 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ucbuf
, 
SIZEOF_TRIBYTE
, 
buf„æí
,Ösf) ;

1112 
	`bë2f_¨øy
 ((
åibyã
*Ë(
psf
->
u
.
ucbuf
), 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

1113 
tŸÆ
 +
ªadcou¡
 ;

1114 i‡(
ªadcou¡
 < 
buf„æí
)

1116 
Àn
 -
ªadcou¡
 ;

1119  
tŸÆ
 ;

1120 
	}
}

1122 
sf_cou¡_t


1123 
	$pcm_ªad_Àt2f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

1124 { 
buf„æí
, 
ªadcou¡
 ;

1125 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1126 
n‹mÁ˘
 ;

1129 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? 1.0 / (() 0x80000000) : 1.0 / 256.0 ;

1131 
buf„æí
 =  (
psf
->
u
.
ucbuf
Ë/ 
SIZEOF_TRIBYTE
 ;

1133 
Àn
 > 0)

1134 { i‡(
Àn
 < 
buf„æí
)

1135 
buf„æí
 = (Ë
Àn
 ;

1136 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ucbuf
, 
SIZEOF_TRIBYTE
, 
buf„æí
,Ösf) ;

1137 
	`Àt2f_¨øy
 ((
åibyã
*Ë(
psf
->
u
.
ucbuf
), 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

1138 
tŸÆ
 +
ªadcou¡
 ;

1139 i‡(
ªadcou¡
 < 
buf„æí
)

1141 
Àn
 -
ªadcou¡
 ;

1144  
tŸÆ
 ;

1145 
	}
}

1147 
sf_cou¡_t


1148 
	$pcm_ªad_bei2f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

1149 { 
buf„æí
, 
ªadcou¡
 ;

1150 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1151 
n‹mÁ˘
 ;

1153 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? 1.0 / (() 0x80000000) : 1.0 ;

1155 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

1157 
Àn
 > 0)

1158 { i‡(
Àn
 < 
buf„æí
)

1159 
buf„æí
 = (Ë
Àn
 ;

1160 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ibuf
,  (), 
buf„æí
,Ösf) ;

1161 
	`bei2f_¨øy
 (
psf
->
u
.
ibuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

1162 
tŸÆ
 +
ªadcou¡
 ;

1163 i‡(
ªadcou¡
 < 
buf„æí
)

1165 
Àn
 -
ªadcou¡
 ;

1168  
tŸÆ
 ;

1169 
	}
}

1171 
sf_cou¡_t


1172 
	$pcm_ªad_Ài2f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

1173 { 
buf„æí
, 
ªadcou¡
 ;

1174 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1175 
n‹mÁ˘
 ;

1177 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? 1.0 / (() 0x80000000) : 1.0 ;

1179 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

1181 
Àn
 > 0)

1182 { i‡(
Àn
 < 
buf„æí
)

1183 
buf„æí
 = (Ë
Àn
 ;

1184 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ibuf
,  (), 
buf„æí
,Ösf) ;

1185 
	`Ài2f_¨øy
 (
psf
->
u
.
ibuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

1186 
tŸÆ
 +
ªadcou¡
 ;

1187 i‡(
ªadcou¡
 < 
buf„æí
)

1189 
Àn
 -
ªadcou¡
 ;

1192  
tŸÆ
 ;

1193 
	}
}

1198 
sf_cou¡_t


1199 
	$pcm_ªad_sc2d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

1200 { 
buf„æí
, 
ªadcou¡
 ;

1201 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1202 
n‹mÁ˘
 ;

1204 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? 1.0 / (() 0x80) : 1.0 ;

1206 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
scbuf
) ;

1208 
Àn
 > 0)

1209 { i‡(
Àn
 < 
buf„æí
)

1210 
buf„æí
 = (Ë
Àn
 ;

1211 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
scbuf
,  (sig√d ), 
buf„æí
,Ösf) ;

1212 
	`sc2d_¨øy
 (
psf
->
u
.
scbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

1213 
tŸÆ
 +
ªadcou¡
 ;

1214 i‡(
ªadcou¡
 < 
buf„æí
)

1216 
Àn
 -
ªadcou¡
 ;

1219  
tŸÆ
 ;

1220 
	}
}

1222 
sf_cou¡_t


1223 
	$pcm_ªad_uc2d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

1224 { 
buf„æí
, 
ªadcou¡
 ;

1225 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1226 
n‹mÁ˘
 ;

1228 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? 1.0 / (() 0x80) : 1.0 ;

1230 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

1232 
Àn
 > 0)

1233 { i‡(
Àn
 < 
buf„æí
)

1234 
buf„æí
 = (Ë
Àn
 ;

1235 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ucbuf
,  (), 
buf„æí
,Ösf) ;

1236 
	`uc2d_¨øy
 (
psf
->
u
.
ucbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

1237 
tŸÆ
 +
ªadcou¡
 ;

1238 i‡(
ªadcou¡
 < 
buf„æí
)

1240 
Àn
 -
ªadcou¡
 ;

1243  
tŸÆ
 ;

1244 
	}
}

1246 
sf_cou¡_t


1247 
	$pcm_ªad_bes2d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

1248 { 
buf„æí
, 
ªadcou¡
 ;

1249 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1250 
n‹mÁ˘
 ;

1252 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? 1.0 / (() 0x8000) : 1.0 ;

1254 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

1256 
Àn
 > 0)

1257 { i‡(
Àn
 < 
buf„æí
)

1258 
buf„æí
 = (Ë
Àn
 ;

1259 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
sbuf
,  (), 
buf„æí
,Ösf) ;

1260 
	`bes2d_¨øy
 (
psf
->
u
.
sbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

1261 
tŸÆ
 +
ªadcou¡
 ;

1262 i‡(
ªadcou¡
 < 
buf„æí
)

1264 
Àn
 -
ªadcou¡
 ;

1267  
tŸÆ
 ;

1268 
	}
}

1270 
sf_cou¡_t


1271 
	$pcm_ªad_Às2d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

1272 { 
buf„æí
, 
ªadcou¡
 ;

1273 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1274 
n‹mÁ˘
 ;

1276 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? 1.0 / (() 0x8000) : 1.0 ;

1278 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

1280 
Àn
 > 0)

1281 { i‡(
Àn
 < 
buf„æí
)

1282 
buf„æí
 = (Ë
Àn
 ;

1283 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
sbuf
,  (), 
buf„æí
,Ösf) ;

1284 
	`Às2d_¨øy
 (
psf
->
u
.
sbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

1285 
tŸÆ
 +
ªadcou¡
 ;

1286 i‡(
ªadcou¡
 < 
buf„æí
)

1288 
Àn
 -
ªadcou¡
 ;

1291  
tŸÆ
 ;

1292 
	}
}

1294 
sf_cou¡_t


1295 
	$pcm_ªad_bë2d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

1296 { 
buf„æí
, 
ªadcou¡
 ;

1297 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1298 
n‹mÁ˘
 ;

1300 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? 1.0 / (() 0x80000000) : 1.0 / 256.0 ;

1302 
buf„æí
 =  (
psf
->
u
.
ucbuf
Ë/ 
SIZEOF_TRIBYTE
 ;

1304 
Àn
 > 0)

1305 { i‡(
Àn
 < 
buf„æí
)

1306 
buf„æí
 = (Ë
Àn
 ;

1307 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ucbuf
, 
SIZEOF_TRIBYTE
, 
buf„æí
,Ösf) ;

1308 
	`bë2d_¨øy
 ((
åibyã
*Ë(
psf
->
u
.
ucbuf
), 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

1309 
tŸÆ
 +
ªadcou¡
 ;

1310 i‡(
ªadcou¡
 < 
buf„æí
)

1312 
Àn
 -
ªadcou¡
 ;

1315  
tŸÆ
 ;

1316 
	}
}

1318 
sf_cou¡_t


1319 
	$pcm_ªad_Àt2d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

1320 { 
buf„æí
, 
ªadcou¡
 ;

1321 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1322 
n‹mÁ˘
 ;

1325 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? 1.0 / (() 0x80000000) : 1.0 / 256.0 ;

1327 
buf„æí
 =  (
psf
->
u
.
ucbuf
Ë/ 
SIZEOF_TRIBYTE
 ;

1329 
Àn
 > 0)

1330 { i‡(
Àn
 < 
buf„æí
)

1331 
buf„æí
 = (Ë
Àn
 ;

1332 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ucbuf
, 
SIZEOF_TRIBYTE
, 
buf„æí
,Ösf) ;

1333 
	`Àt2d_¨øy
 ((
åibyã
*Ë(
psf
->
u
.
ucbuf
), 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

1334 
tŸÆ
 +
ªadcou¡
 ;

1335 i‡(
ªadcou¡
 < 
buf„æí
)

1337 
Àn
 -
ªadcou¡
 ;

1340  
tŸÆ
 ;

1341 
	}
}

1343 
sf_cou¡_t


1344 
	$pcm_ªad_bei2d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

1345 { 
buf„æí
, 
ªadcou¡
 ;

1346 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1347 
n‹mÁ˘
 ;

1349 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? 1.0 / (() 0x80000000) : 1.0 ;

1351 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

1353 
Àn
 > 0)

1354 { i‡(
Àn
 < 
buf„æí
)

1355 
buf„æí
 = (Ë
Àn
 ;

1356 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ibuf
,  (), 
buf„æí
,Ösf) ;

1357 
	`bei2d_¨øy
 (
psf
->
u
.
ibuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

1358 
tŸÆ
 +
ªadcou¡
 ;

1359 i‡(
ªadcou¡
 < 
buf„æí
)

1361 
Àn
 -
ªadcou¡
 ;

1364  
tŸÆ
 ;

1365 
	}
}

1367 
sf_cou¡_t


1368 
	$pcm_ªad_Ài2d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

1369 { 
buf„æí
, 
ªadcou¡
 ;

1370 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1371 
n‹mÁ˘
 ;

1373 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? 1.0 / (() 0x80000000) : 1.0 ;

1375 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

1377 
Àn
 > 0)

1378 { i‡(
Àn
 < 
buf„æí
)

1379 
buf„æí
 = (Ë
Àn
 ;

1380 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ibuf
,  (), 
buf„æí
,Ösf) ;

1381 
	`Ài2d_¨øy
 (
psf
->
u
.
ibuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

1382 
tŸÆ
 +
ªadcou¡
 ;

1383 i‡(
ªadcou¡
 < 
buf„æí
)

1385 
Àn
 -
ªadcou¡
 ;

1388  
tŸÆ
 ;

1389 
	}
}

1396 
sf_cou¡_t


1397 
	$pcm_wrôe_s2sc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1398 { 
buf„æí
, 
wrôecou¡
 ;

1399 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1401 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
scbuf
) ;

1403 
Àn
 > 0)

1404 { i‡(
Àn
 < 
buf„æí
)

1405 
buf„æí
 = (Ë
Àn
 ;

1406 
	`s2sc_¨øy
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
scbuf
, 
buf„æí
) ;

1407 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
scbuf
,  (sig√d ), 
buf„æí
,Ösf) ;

1408 
tŸÆ
 +
wrôecou¡
 ;

1409 i‡(
wrôecou¡
 < 
buf„æí
)

1411 
Àn
 -
wrôecou¡
 ;

1414  
tŸÆ
 ;

1415 
	}
}

1417 
sf_cou¡_t


1418 
	$pcm_wrôe_s2uc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1419 { 
buf„æí
, 
wrôecou¡
 ;

1420 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1422 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

1424 
Àn
 > 0)

1425 { i‡(
Àn
 < 
buf„æí
)

1426 
buf„æí
 = (Ë
Àn
 ;

1427 
	`s2uc_¨øy
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
ucbuf
, 
buf„æí
) ;

1428 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ucbuf
,  (), 
buf„æí
,Ösf) ;

1429 
tŸÆ
 +
wrôecou¡
 ;

1430 i‡(
wrôecou¡
 < 
buf„æí
)

1432 
Àn
 -
wrôecou¡
 ;

1435  
tŸÆ
 ;

1436 
	}
}

1438 
sf_cou¡_t


1439 
	$pcm_wrôe_s2bes
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1440 { 
buf„æí
, 
wrôecou¡
 ;

1441 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1443 i‡(
CPU_IS_BIG_ENDIAN
)

1444  
	`psf_fwrôe
 (
±r
,  (), 
Àn
, 
psf
) ;

1447 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

1449 
Àn
 > 0)

1450 { i‡(
Àn
 < 
buf„æí
)

1451 
buf„æí
 = (Ë
Àn
 ;

1452 
	`ídsw≠_sh‹t_c›y
 (
psf
->
u
.
sbuf
, 
±r
 + 
tŸÆ
, 
buf„æí
) ;

1453 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
sbuf
,  (), 
buf„æí
,Ösf) ;

1454 
tŸÆ
 +
wrôecou¡
 ;

1455 i‡(
wrôecou¡
 < 
buf„æí
)

1457 
Àn
 -
wrôecou¡
 ;

1460  
tŸÆ
 ;

1461 
	}
}

1463 
sf_cou¡_t


1464 
	$pcm_wrôe_s2Às
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1465 { 
buf„æí
, 
wrôecou¡
 ;

1466 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1468 i‡(
CPU_IS_LITTLE_ENDIAN
)

1469  
	`psf_fwrôe
 (
±r
,  (), 
Àn
, 
psf
) ;

1471 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

1473 
Àn
 > 0)

1474 { i‡(
Àn
 < 
buf„æí
)

1475 
buf„æí
 = (Ë
Àn
 ;

1476 
	`ídsw≠_sh‹t_c›y
 (
psf
->
u
.
sbuf
, 
±r
 + 
tŸÆ
, 
buf„æí
) ;

1477 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
sbuf
,  (), 
buf„æí
,Ösf) ;

1478 
tŸÆ
 +
wrôecou¡
 ;

1479 i‡(
wrôecou¡
 < 
buf„æí
)

1481 
Àn
 -
wrôecou¡
 ;

1484  
tŸÆ
 ;

1485 
	}
}

1487 
sf_cou¡_t


1488 
	$pcm_wrôe_s2bë
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1489 { 
buf„æí
, 
wrôecou¡
 ;

1490 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1492 
buf„æí
 =  (
psf
->
u
.
ucbuf
Ë/ 
SIZEOF_TRIBYTE
 ;

1494 
Àn
 > 0)

1495 { i‡(
Àn
 < 
buf„æí
)

1496 
buf„æí
 = (Ë
Àn
 ;

1497 
	`s2bë_¨øy
 (
±r
 + 
tŸÆ
, (
åibyã
*Ë(
psf
->
u
.
ucbuf
), 
buf„æí
) ;

1498 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ucbuf
, 
SIZEOF_TRIBYTE
, 
buf„æí
,Ösf) ;

1499 
tŸÆ
 +
wrôecou¡
 ;

1500 i‡(
wrôecou¡
 < 
buf„æí
)

1502 
Àn
 -
wrôecou¡
 ;

1505  
tŸÆ
 ;

1506 
	}
}

1508 
sf_cou¡_t


1509 
	$pcm_wrôe_s2Àt
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1510 { 
buf„æí
, 
wrôecou¡
 ;

1511 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1513 
buf„æí
 =  (
psf
->
u
.
ucbuf
Ë/ 
SIZEOF_TRIBYTE
 ;

1515 
Àn
 > 0)

1516 { i‡(
Àn
 < 
buf„æí
)

1517 
buf„æí
 = (Ë
Àn
 ;

1518 
	`s2Àt_¨øy
 (
±r
 + 
tŸÆ
, (
åibyã
*Ë(
psf
->
u
.
ucbuf
), 
buf„æí
) ;

1519 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ucbuf
, 
SIZEOF_TRIBYTE
, 
buf„æí
,Ösf) ;

1520 
tŸÆ
 +
wrôecou¡
 ;

1521 i‡(
wrôecou¡
 < 
buf„æí
)

1523 
Àn
 -
wrôecou¡
 ;

1526  
tŸÆ
 ;

1527 
	}
}

1529 
sf_cou¡_t


1530 
	$pcm_wrôe_s2bei
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1531 { 
buf„æí
, 
wrôecou¡
 ;

1532 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1534 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

1536 
Àn
 > 0)

1537 { i‡(
Àn
 < 
buf„æí
)

1538 
buf„æí
 = (Ë
Àn
 ;

1539 
	`s2bei_¨øy
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
ibuf
, 
buf„æí
) ;

1540 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ibuf
,  (), 
buf„æí
,Ösf) ;

1541 
tŸÆ
 +
wrôecou¡
 ;

1542 i‡(
wrôecou¡
 < 
buf„æí
)

1544 
Àn
 -
wrôecou¡
 ;

1547  
tŸÆ
 ;

1548 
	}
}

1550 
sf_cou¡_t


1551 
	$pcm_wrôe_s2Ài
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1552 { 
buf„æí
, 
wrôecou¡
 ;

1553 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1555 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

1557 
Àn
 > 0)

1558 { i‡(
Àn
 < 
buf„æí
)

1559 
buf„æí
 = (Ë
Àn
 ;

1560 
	`s2Ài_¨øy
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
ibuf
, 
buf„æí
) ;

1561 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ibuf
,  (), 
buf„æí
,Ösf) ;

1562 
tŸÆ
 +
wrôecou¡
 ;

1563 i‡(
wrôecou¡
 < 
buf„æí
)

1565 
Àn
 -
wrôecou¡
 ;

1568  
tŸÆ
 ;

1569 
	}
}

1574 
sf_cou¡_t


1575 
	$pcm_wrôe_i2sc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1576 { 
buf„æí
, 
wrôecou¡
 ;

1577 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1579 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
scbuf
) ;

1581 
Àn
 > 0)

1582 { i‡(
Àn
 < 
buf„æí
)

1583 
buf„æí
 = (Ë
Àn
 ;

1584 
	`i2sc_¨øy
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
scbuf
, 
buf„æí
) ;

1585 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
scbuf
,  (sig√d ), 
buf„æí
,Ösf) ;

1586 
tŸÆ
 +
wrôecou¡
 ;

1587 i‡(
wrôecou¡
 < 
buf„æí
)

1589 
Àn
 -
wrôecou¡
 ;

1592  
tŸÆ
 ;

1593 
	}
}

1595 
sf_cou¡_t


1596 
	$pcm_wrôe_i2uc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1597 { 
buf„æí
, 
wrôecou¡
 ;

1598 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1600 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

1602 
Àn
 > 0)

1603 { i‡(
Àn
 < 
buf„æí
)

1604 
buf„æí
 = (Ë
Àn
 ;

1605 
	`i2uc_¨øy
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
ucbuf
, 
buf„æí
) ;

1606 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ucbuf
,  (sig√d ), 
buf„æí
,Ösf) ;

1607 
tŸÆ
 +
wrôecou¡
 ;

1608 i‡(
wrôecou¡
 < 
buf„æí
)

1610 
Àn
 -
wrôecou¡
 ;

1613  
tŸÆ
 ;

1614 
	}
}

1616 
sf_cou¡_t


1617 
	$pcm_wrôe_i2bes
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1618 { 
buf„æí
, 
wrôecou¡
 ;

1619 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1621 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

1623 
Àn
 > 0)

1624 { i‡(
Àn
 < 
buf„æí
)

1625 
buf„æí
 = (Ë
Àn
 ;

1626 
	`i2bes_¨øy
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
sbuf
, 
buf„æí
) ;

1627 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
sbuf
,  (), 
buf„æí
,Ösf) ;

1628 
tŸÆ
 +
wrôecou¡
 ;

1629 i‡(
wrôecou¡
 < 
buf„æí
)

1631 
Àn
 -
wrôecou¡
 ;

1634  
tŸÆ
 ;

1635 
	}
}

1637 
sf_cou¡_t


1638 
	$pcm_wrôe_i2Às
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1639 { 
buf„æí
, 
wrôecou¡
 ;

1640 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1642 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

1644 
Àn
 > 0)

1645 { i‡(
Àn
 < 
buf„æí
)

1646 
buf„æí
 = (Ë
Àn
 ;

1647 
	`i2Às_¨øy
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
sbuf
, 
buf„æí
) ;

1648 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
sbuf
,  (), 
buf„æí
,Ösf) ;

1649 
tŸÆ
 +
wrôecou¡
 ;

1650 i‡(
wrôecou¡
 < 
buf„æí
)

1652 
Àn
 -
wrôecou¡
 ;

1655  
tŸÆ
 ;

1656 
	}
}

1658 
sf_cou¡_t


1659 
	$pcm_wrôe_i2bë
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1660 { 
buf„æí
, 
wrôecou¡
 ;

1661 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1663 
buf„æí
 =  (
psf
->
u
.
ucbuf
Ë/ 
SIZEOF_TRIBYTE
 ;

1665 
Àn
 > 0)

1666 { i‡(
Àn
 < 
buf„æí
)

1667 
buf„æí
 = (Ë
Àn
 ;

1668 
	`i2bë_¨øy
 (
±r
 + 
tŸÆ
, (
åibyã
*Ë(
psf
->
u
.
ucbuf
), 
buf„æí
) ;

1669 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ucbuf
, 
SIZEOF_TRIBYTE
, 
buf„æí
,Ösf) ;

1670 
tŸÆ
 +
wrôecou¡
 ;

1671 i‡(
wrôecou¡
 < 
buf„æí
)

1673 
Àn
 -
wrôecou¡
 ;

1676  
tŸÆ
 ;

1677 
	}
}

1679 
sf_cou¡_t


1680 
	$pcm_wrôe_i2Àt
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1681 { 
buf„æí
, 
wrôecou¡
 ;

1682 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1684 
buf„æí
 =  (
psf
->
u
.
ucbuf
Ë/ 
SIZEOF_TRIBYTE
 ;

1686 
Àn
 > 0)

1687 { i‡(
Àn
 < 
buf„æí
)

1688 
buf„æí
 = (Ë
Àn
 ;

1689 
	`i2Àt_¨øy
 (
±r
 + 
tŸÆ
, (
åibyã
*Ë(
psf
->
u
.
ucbuf
), 
buf„æí
) ;

1690 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ucbuf
, 
SIZEOF_TRIBYTE
, 
buf„æí
,Ösf) ;

1691 
tŸÆ
 +
wrôecou¡
 ;

1692 i‡(
wrôecou¡
 < 
buf„æí
)

1694 
Àn
 -
wrôecou¡
 ;

1697  
tŸÆ
 ;

1698 
	}
}

1700 
sf_cou¡_t


1701 
	$pcm_wrôe_i2bei
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1702 { 
buf„æí
, 
wrôecou¡
 ;

1703 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1705 i‡(
CPU_IS_BIG_ENDIAN
)

1706  
	`psf_fwrôe
 (
±r
,  (), 
Àn
, 
psf
) ;

1708 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

1710 
Àn
 > 0)

1711 { i‡(
Àn
 < 
buf„æí
)

1712 
buf„æí
 = (Ë
Àn
 ;

1713 
	`ídsw≠_öt_c›y
 (
psf
->
u
.
ibuf
, 
±r
 + 
tŸÆ
, 
buf„æí
) ;

1714 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ibuf
,  (), 
buf„æí
,Ösf) ;

1715 
tŸÆ
 +
wrôecou¡
 ;

1716 i‡(
wrôecou¡
 < 
buf„æí
)

1718 
Àn
 -
wrôecou¡
 ;

1721  
tŸÆ
 ;

1722 
	}
}

1724 
sf_cou¡_t


1725 
	$pcm_wrôe_i2Ài
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1726 { 
buf„æí
, 
wrôecou¡
 ;

1727 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1729 i‡(
CPU_IS_LITTLE_ENDIAN
)

1730  
	`psf_fwrôe
 (
±r
,  (), 
Àn
, 
psf
) ;

1732 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

1734 
Àn
 > 0)

1735 { i‡(
Àn
 < 
buf„æí
)

1736 
buf„æí
 = (Ë
Àn
 ;

1737 
	`ídsw≠_öt_c›y
 (
psf
->
u
.
ibuf
, 
±r
 + 
tŸÆ
, 
buf„æí
) ;

1738 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ibuf
,  (), 
buf„æí
,Ösf) ;

1739 
tŸÆ
 +
wrôecou¡
 ;

1740 i‡(
wrôecou¡
 < 
buf„æí
)

1742 
Àn
 -
wrôecou¡
 ;

1745  
tŸÆ
 ;

1746 
	}
}

1754 
	$f2sc_¨øy
 (c⁄° *
§c
, sig√d *
de°
, 
cou¡
, 
n‹mÆize
)

1755 { 
n‹mÁ˘
 ;

1757 
n‹mÁ˘
 = 
n‹mÆize
 ? (1.0 * 0x7F) : 1.0 ;

1759 --
cou¡
 >= 0)

1760 { 
de°
 [
cou¡
] = 
	`Ãötf
 (
§c
 [cou¡] * 
n‹mÁ˘
) ;

1762 
	}
}

1765 
	$f2sc_˛ù_¨øy
 (c⁄° *
§c
, sig√d *
de°
, 
cou¡
, 
n‹mÆize
)

1766 { 
n‹mÁ˘
, 
sˇÀd_vÆue
 ;

1768 
n‹mÁ˘
 = 
n‹mÆize
 ? (8.0 * 0x10000000) : (1.0 * 0x1000000) ;

1770 --
cou¡
 >= 0)

1771 { 
sˇÀd_vÆue
 = 
§c
 [
cou¡
] * 
n‹mÁ˘
 ;

1772 i‡(
CPU_CLIPS_POSITIVE
 =0 && 
sˇÀd_vÆue
 >= (1.0 * 0x7FFFFFFF))

1773 { 
de°
 [
cou¡
] = 127 ;

1776 i‡(
CPU_CLIPS_NEGATIVE
 =0 && 
sˇÀd_vÆue
 <= (-8.0 * 0x10000000))

1777 { 
de°
 [
cou¡
] = -128 ;

1781 
de°
 [
cou¡
] = 
	`Ãötf
 (
sˇÀd_vÆue
) >> 24 ;

1783 
	}
}

1785 
sf_cou¡_t


1786 
	$pcm_wrôe_f2sc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1787 { (*
c⁄vît
) (const *, signed *, , ) ;

1788 
buf„æí
, 
wrôecou¡
 ;

1789 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1791 
c⁄vît
 = (
psf
->
add_˛ùpög
Ë? 
f2sc_˛ù_¨øy
 : 
f2sc_¨øy
 ;

1792 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
scbuf
) ;

1794 
Àn
 > 0)

1795 { i‡(
Àn
 < 
buf„æí
)

1796 
buf„æí
 = (Ë
Àn
 ;

1797 
	`c⁄vît
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
scbuf
, 
buf„æí
,Ösf->
n‹m_Êﬂt
) ;

1798 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
scbuf
,  (sig√d ), 
buf„æí
,Ösf) ;

1799 
tŸÆ
 +
wrôecou¡
 ;

1800 i‡(
wrôecou¡
 < 
buf„æí
)

1802 
Àn
 -
wrôecou¡
 ;

1805  
tŸÆ
 ;

1806 
	}
}

1812 
	$f2uc_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÆize
)

1813 { 
n‹mÁ˘
 ;

1815 
n‹mÁ˘
 = 
n‹mÆize
 ? (1.0 * 0x7F) : 1.0 ;

1817 --
cou¡
 >= 0)

1818 { 
de°
 [
cou¡
] = 
	`Ãötf
 (
§c
 [cou¡] * 
n‹mÁ˘
) + 128 ;

1820 
	}
}

1823 
	$f2uc_˛ù_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÆize
)

1824 { 
n‹mÁ˘
, 
sˇÀd_vÆue
 ;

1826 
n‹mÁ˘
 = 
n‹mÆize
 ? (8.0 * 0x10000000) : (1.0 * 0x1000000) ;

1828 --
cou¡
 >= 0)

1829 { 
sˇÀd_vÆue
 = 
§c
 [
cou¡
] * 
n‹mÁ˘
 ;

1830 i‡(
CPU_CLIPS_POSITIVE
 =0 && 
sˇÀd_vÆue
 >= (1.0 * 0x7FFFFFFF))

1831 { 
de°
 [
cou¡
] = 0xFF ;

1834 i‡(
CPU_CLIPS_NEGATIVE
 =0 && 
sˇÀd_vÆue
 <= (-8.0 * 0x10000000))

1835 { 
de°
 [
cou¡
] = 0 ;

1839 
de°
 [
cou¡
] = (
	`Ãötf
 (
sˇÀd_vÆue
) >> 24) + 128 ;

1841 
	}
}

1843 
sf_cou¡_t


1844 
	$pcm_wrôe_f2uc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1845 { (*
c⁄vît
) (const *, *, , ) ;

1846 
buf„æí
, 
wrôecou¡
 ;

1847 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1849 
c⁄vît
 = (
psf
->
add_˛ùpög
Ë? 
f2uc_˛ù_¨øy
 : 
f2uc_¨øy
 ;

1850 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

1852 
Àn
 > 0)

1853 { i‡(
Àn
 < 
buf„æí
)

1854 
buf„æí
 = (Ë
Àn
 ;

1855 
	`c⁄vît
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
ucbuf
, 
buf„æí
,Ösf->
n‹m_Êﬂt
) ;

1856 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ucbuf
,  (), 
buf„æí
,Ösf) ;

1857 
tŸÆ
 +
wrôecou¡
 ;

1858 i‡(
wrôecou¡
 < 
buf„æí
)

1860 
Àn
 -
wrôecou¡
 ;

1863  
tŸÆ
 ;

1864 
	}
}

1870 
	$f2bes_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÆize
)

1871 { *
u˝å
 ;

1872 
n‹mÁ˘
 ;

1873 
vÆue
 ;

1875 
n‹mÁ˘
 = 
n‹mÆize
 ? (1.0 * 0x7FFF) : 1.0 ;

1876 
u˝å
 = ((*Ë
de°
Ë+ 2 * 
cou¡
 ;

1878 --
cou¡
 >= 0)

1879 { 
u˝å
 -= 2 ;

1880 
vÆue
 = 
	`Ãötf
 (
§c
 [
cou¡
] * 
n‹mÁ˘
) ;

1881 
u˝å
 [1] = 
vÆue
 ;

1882 
u˝å
 [0] = 
vÆue
 >> 8 ;

1884 
	}
}

1887 
	$f2bes_˛ù_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÆize
)

1888 { *
u˝å
 ;

1889 
n‹mÁ˘
, 
sˇÀd_vÆue
 ;

1890 
vÆue
 ;

1892 
n‹mÁ˘
 = 
n‹mÆize
 ? (8.0 * 0x10000000) : (1.0 * 0x10000) ;

1893 
u˝å
 = ((*Ë
de°
Ë+ 2 * 
cou¡
 ;

1895 --
cou¡
 >= 0)

1896 { 
u˝å
 -= 2 ;

1897 
sˇÀd_vÆue
 = 
§c
 [
cou¡
] * 
n‹mÁ˘
 ;

1898 i‡(
CPU_CLIPS_POSITIVE
 =0 && 
sˇÀd_vÆue
 >= (1.0 * 0x7FFFFFFF))

1899 { 
u˝å
 [1] = 0xFF ;

1900 
u˝å
 [0] = 0x7F ;

1903 i‡(
CPU_CLIPS_NEGATIVE
 =0 && 
sˇÀd_vÆue
 <= (-8.0 * 0x10000000))

1904 { 
u˝å
 [1] = 0x00 ;

1905 
u˝å
 [0] = 0x80 ;

1909 
vÆue
 = 
	`Ãötf
 (
sˇÀd_vÆue
) ;

1910 
u˝å
 [1] = 
vÆue
 >> 16 ;

1911 
u˝å
 [0] = 
vÆue
 >> 24 ;

1913 
	}
}

1915 
sf_cou¡_t


1916 
	$pcm_wrôe_f2bes
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1917 { (*
c⁄vît
Ë(c⁄° *, *
t
, , ) ;

1918 
buf„æí
, 
wrôecou¡
 ;

1919 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1921 
c⁄vît
 = (
psf
->
add_˛ùpög
Ë? 
f2bes_˛ù_¨øy
 : 
f2bes_¨øy
 ;

1922 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

1924 
Àn
 > 0)

1925 { i‡(
Àn
 < 
buf„æí
)

1926 
buf„æí
 = (Ë
Àn
 ;

1927 
	`c⁄vît
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
sbuf
, 
buf„æí
,Ösf->
n‹m_Êﬂt
) ;

1928 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
sbuf
,  (), 
buf„æí
,Ösf) ;

1929 
tŸÆ
 +
wrôecou¡
 ;

1930 i‡(
wrôecou¡
 < 
buf„æí
)

1932 
Àn
 -
wrôecou¡
 ;

1935  
tŸÆ
 ;

1936 
	}
}

1942 
	$f2Às_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÆize
)

1943 { *
u˝å
 ;

1944 
n‹mÁ˘
 ;

1945 
vÆue
 ;

1947 
n‹mÁ˘
 = 
n‹mÆize
 ? (1.0 * 0x7FFF) : 1.0 ;

1948 
u˝å
 = ((*Ë
de°
Ë+ 2 * 
cou¡
 ;

1950 --
cou¡
 >= 0)

1951 { 
u˝å
 -= 2 ;

1952 
vÆue
 = 
	`Ãötf
 (
§c
 [
cou¡
] * 
n‹mÁ˘
) ;

1953 
u˝å
 [0] = 
vÆue
 ;

1954 
u˝å
 [1] = 
vÆue
 >> 8 ;

1956 
	}
}

1959 
	$f2Às_˛ù_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÆize
)

1960 { *
u˝å
 ;

1961 
n‹mÁ˘
, 
sˇÀd_vÆue
 ;

1962 
vÆue
 ;

1964 
n‹mÁ˘
 = 
n‹mÆize
 ? (8.0 * 0x10000000) : (1.0 * 0x10000) ;

1965 
u˝å
 = ((*Ë
de°
Ë+ 2 * 
cou¡
 ;

1967 --
cou¡
 >= 0)

1968 { 
u˝å
 -= 2 ;

1969 
sˇÀd_vÆue
 = 
§c
 [
cou¡
] * 
n‹mÁ˘
 ;

1970 i‡(
CPU_CLIPS_POSITIVE
 =0 && 
sˇÀd_vÆue
 >= (1.0 * 0x7FFFFFFF))

1971 { 
u˝å
 [0] = 0xFF ;

1972 
u˝å
 [1] = 0x7F ;

1975 i‡(
CPU_CLIPS_NEGATIVE
 =0 && 
sˇÀd_vÆue
 <= (-8.0 * 0x10000000))

1976 { 
u˝å
 [0] = 0x00 ;

1977 
u˝å
 [1] = 0x80 ;

1981 
vÆue
 = 
	`Ãötf
 (
sˇÀd_vÆue
) ;

1982 
u˝å
 [0] = 
vÆue
 >> 16 ;

1983 
u˝å
 [1] = 
vÆue
 >> 24 ;

1985 
	}
}

1987 
sf_cou¡_t


1988 
	$pcm_wrôe_f2Às
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1989 { (*
c⁄vît
Ë(c⁄° *, *
t
, , ) ;

1990 
buf„æí
, 
wrôecou¡
 ;

1991 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1993 
c⁄vît
 = (
psf
->
add_˛ùpög
Ë? 
f2Às_˛ù_¨øy
 : 
f2Às_¨øy
 ;

1994 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

1996 
Àn
 > 0)

1997 { i‡(
Àn
 < 
buf„æí
)

1998 
buf„æí
 = (Ë
Àn
 ;

1999 
	`c⁄vît
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
sbuf
, 
buf„æí
,Ösf->
n‹m_Êﬂt
) ;

2000 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
sbuf
,  (), 
buf„æí
,Ösf) ;

2001 
tŸÆ
 +
wrôecou¡
 ;

2002 i‡(
wrôecou¡
 < 
buf„æí
)

2004 
Àn
 -
wrôecou¡
 ;

2007  
tŸÆ
 ;

2008 
	}
}

2014 
	$f2Àt_¨øy
 (c⁄° *
§c
, 
åibyã
 *
de°
, 
cou¡
, 
n‹mÆize
)

2015 { *
u˝å
 ;

2016 
n‹mÁ˘
 ;

2017 
vÆue
 ;

2019 
n‹mÁ˘
 = 
n‹mÆize
 ? (1.0 * 0x7FFFFF) : 1.0 ;

2020 
u˝å
 = ((*Ë
de°
Ë+ 3 * 
cou¡
 ;

2022 --
cou¡
 >= 0)

2023 { 
u˝å
 -= 3 ;

2024 
vÆue
 = 
	`Ãötf
 (
§c
 [
cou¡
] * 
n‹mÁ˘
) ;

2025 
u˝å
 [0] = 
vÆue
 ;

2026 
u˝å
 [1] = 
vÆue
 >> 8 ;

2027 
u˝å
 [2] = 
vÆue
 >> 16 ;

2029 
	}
}

2032 
	$f2Àt_˛ù_¨øy
 (c⁄° *
§c
, 
åibyã
 *
de°
, 
cou¡
, 
n‹mÆize
)

2033 { *
u˝å
 ;

2034 
n‹mÁ˘
, 
sˇÀd_vÆue
 ;

2035 
vÆue
 ;

2037 
n‹mÁ˘
 = 
n‹mÆize
 ? (8.0 * 0x10000000) : (1.0 * 0x100) ;

2038 
u˝å
 = ((*Ë
de°
Ë+ 3 * 
cou¡
 ;

2040 --
cou¡
 >= 0)

2041 { 
u˝å
 -= 3 ;

2042 
sˇÀd_vÆue
 = 
§c
 [
cou¡
] * 
n‹mÁ˘
 ;

2043 i‡(
CPU_CLIPS_POSITIVE
 =0 && 
sˇÀd_vÆue
 >= (1.0 * 0x7FFFFFFF))

2044 { 
u˝å
 [0] = 0xFF ;

2045 
u˝å
 [1] = 0xFF ;

2046 
u˝å
 [2] = 0x7F ;

2049 i‡(
CPU_CLIPS_NEGATIVE
 =0 && 
sˇÀd_vÆue
 <= (-8.0 * 0x10000000))

2050 { 
u˝å
 [0] = 0x00 ;

2051 
u˝å
 [1] = 0x00 ;

2052 
u˝å
 [2] = 0x80 ;

2056 
vÆue
 = 
	`Ãötf
 (
sˇÀd_vÆue
) ;

2057 
u˝å
 [0] = 
vÆue
 >> 8 ;

2058 
u˝å
 [1] = 
vÆue
 >> 16 ;

2059 
u˝å
 [2] = 
vÆue
 >> 24 ;

2061 
	}
}

2063 
sf_cou¡_t


2064 
	$pcm_wrôe_f2Àt
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

2065 { (*
c⁄vît
Ë(c⁄° *, 
åibyã
 *, , ) ;

2066 
buf„æí
, 
wrôecou¡
 ;

2067 
sf_cou¡_t
 
tŸÆ
 = 0 ;

2069 
c⁄vît
 = (
psf
->
add_˛ùpög
Ë? 
f2Àt_˛ù_¨øy
 : 
f2Àt_¨øy
 ;

2070 
buf„æí
 =  (
psf
->
u
.
ucbuf
Ë/ 
SIZEOF_TRIBYTE
 ;

2072 
Àn
 > 0)

2073 { i‡(
Àn
 < 
buf„æí
)

2074 
buf„æí
 = (Ë
Àn
 ;

2075 
	`c⁄vît
 (
±r
 + 
tŸÆ
, (
åibyã
*Ë(
psf
->
u
.
ucbuf
), 
buf„æí
,Ösf->
n‹m_Êﬂt
) ;

2076 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ucbuf
, 
SIZEOF_TRIBYTE
, 
buf„æí
,Ösf) ;

2077 
tŸÆ
 +
wrôecou¡
 ;

2078 i‡(
wrôecou¡
 < 
buf„æí
)

2080 
Àn
 -
wrôecou¡
 ;

2083  
tŸÆ
 ;

2084 
	}
}

2090 
	$f2bë_¨øy
 (c⁄° *
§c
, 
åibyã
 *
de°
, 
cou¡
, 
n‹mÆize
)

2091 { *
u˝å
 ;

2092 
n‹mÁ˘
 ;

2093 
vÆue
 ;

2095 
n‹mÁ˘
 = 
n‹mÆize
 ? (1.0 * 0x7FFFFF) : 1.0 ;

2096 
u˝å
 = ((*Ë
de°
Ë+ 3 * 
cou¡
 ;

2098 --
cou¡
 >= 0)

2099 { 
u˝å
 -= 3 ;

2100 
vÆue
 = 
	`Ãötf
 (
§c
 [
cou¡
] * 
n‹mÁ˘
) ;

2101 
u˝å
 [0] = 
vÆue
 >> 16 ;

2102 
u˝å
 [1] = 
vÆue
 >> 8 ;

2103 
u˝å
 [2] = 
vÆue
 ;

2105 
	}
}

2108 
	$f2bë_˛ù_¨øy
 (c⁄° *
§c
, 
åibyã
 *
de°
, 
cou¡
, 
n‹mÆize
)

2109 { *
u˝å
 ;

2110 
n‹mÁ˘
, 
sˇÀd_vÆue
 ;

2111 
vÆue
 ;

2113 
n‹mÁ˘
 = 
n‹mÆize
 ? (8.0 * 0x10000000) : (1.0 * 0x100) ;

2114 
u˝å
 = ((*Ë
de°
Ë+ 3 * 
cou¡
 ;

2116 --
cou¡
 >= 0)

2117 { 
u˝å
 -= 3 ;

2118 
sˇÀd_vÆue
 = 
§c
 [
cou¡
] * 
n‹mÁ˘
 ;

2119 i‡(
CPU_CLIPS_POSITIVE
 =0 && 
sˇÀd_vÆue
 >= (1.0 * 0x7FFFFFFF))

2120 { 
u˝å
 [0] = 0x7F ;

2121 
u˝å
 [1] = 0xFF ;

2122 
u˝å
 [2] = 0xFF ;

2125 i‡(
CPU_CLIPS_NEGATIVE
 =0 && 
sˇÀd_vÆue
 <= (-8.0 * 0x10000000))

2126 { 
u˝å
 [0] = 0x80 ;

2127 
u˝å
 [1] = 0x00 ;

2128 
u˝å
 [2] = 0x00 ;

2132 
vÆue
 = 
	`Ãöt
 (
sˇÀd_vÆue
) ;

2133 
u˝å
 [0] = 
vÆue
 >> 24 ;

2134 
u˝å
 [1] = 
vÆue
 >> 16 ;

2135 
u˝å
 [2] = 
vÆue
 >> 8 ;

2137 
	}
}

2139 
sf_cou¡_t


2140 
	$pcm_wrôe_f2bë
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

2141 { (*
c⁄vît
Ë(c⁄° *, 
åibyã
 *, , ) ;

2142 
buf„æí
, 
wrôecou¡
 ;

2143 
sf_cou¡_t
 
tŸÆ
 = 0 ;

2145 
c⁄vît
 = (
psf
->
add_˛ùpög
Ë? 
f2bë_˛ù_¨øy
 : 
f2bë_¨øy
 ;

2146 
buf„æí
 =  (
psf
->
u
.
ucbuf
Ë/ 
SIZEOF_TRIBYTE
 ;

2148 
Àn
 > 0)

2149 { i‡(
Àn
 < 
buf„æí
)

2150 
buf„æí
 = (Ë
Àn
 ;

2151 
	`c⁄vît
 (
±r
 + 
tŸÆ
, (
åibyã
*Ë(
psf
->
u
.
ucbuf
), 
buf„æí
,Ösf->
n‹m_Êﬂt
) ;

2152 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ucbuf
, 
SIZEOF_TRIBYTE
, 
buf„æí
,Ösf) ;

2153 
tŸÆ
 +
wrôecou¡
 ;

2154 i‡(
wrôecou¡
 < 
buf„æí
)

2156 
Àn
 -
wrôecou¡
 ;

2159  
tŸÆ
 ;

2160 
	}
}

2166 
	$f2bei_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÆize
)

2167 { *
u˝å
 ;

2168 
n‹mÁ˘
 ;

2169 
vÆue
 ;

2171 
n‹mÁ˘
 = 
n‹mÆize
 ? (1.0 * 0x7FFFFFFF) : 1.0 ;

2172 
u˝å
 = ((*Ë
de°
Ë+ 4 * 
cou¡
 ;

2173 --
cou¡
 >= 0)

2174 { 
u˝å
 -= 4 ;

2175 
vÆue
 = 
	`Ãötf
 (
§c
 [
cou¡
] * 
n‹mÁ˘
) ;

2176 
u˝å
 [0] = 
vÆue
 >> 24 ;

2177 
u˝å
 [1] = 
vÆue
 >> 16 ;

2178 
u˝å
 [2] = 
vÆue
 >> 8 ;

2179 
u˝å
 [3] = 
vÆue
 ;

2181 
	}
}

2184 
	$f2bei_˛ù_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÆize
)

2185 { *
u˝å
 ;

2186 
n‹mÁ˘
, 
sˇÀd_vÆue
 ;

2187 
vÆue
 ;

2189 
n‹mÁ˘
 = 
n‹mÆize
 ? (8.0 * 0x10000000) : 1.0 ;

2190 
u˝å
 = ((*Ë
de°
Ë+ 4 * 
cou¡
 ;

2192 --
cou¡
 >= 0)

2193 { 
u˝å
 -= 4 ;

2194 
sˇÀd_vÆue
 = 
§c
 [
cou¡
] * 
n‹mÁ˘
 ;

2195 i‡(
CPU_CLIPS_POSITIVE
 =0 && 
sˇÀd_vÆue
 >= 1.0 * 0x7FFFFFFF)

2196 { 
u˝å
 [0] = 0x7F ;

2197 
u˝å
 [1] = 0xFF ;

2198 
u˝å
 [2] = 0xFF ;

2199 
u˝å
 [3] = 0xFF ;

2202 i‡(
CPU_CLIPS_NEGATIVE
 =0 && 
sˇÀd_vÆue
 <= (-8.0 * 0x10000000))

2203 { 
u˝å
 [0] = 0x80 ;

2204 
u˝å
 [1] = 0x00 ;

2205 
u˝å
 [2] = 0x00 ;

2206 
u˝å
 [3] = 0x00 ;

2210 
vÆue
 = 
	`Ãötf
 (
sˇÀd_vÆue
) ;

2211 
u˝å
 [0] = 
vÆue
 >> 24 ;

2212 
u˝å
 [1] = 
vÆue
 >> 16 ;

2213 
u˝å
 [2] = 
vÆue
 >> 8 ;

2214 
u˝å
 [3] = 
vÆue
 ;

2216 
	}
}

2218 
sf_cou¡_t


2219 
	$pcm_wrôe_f2bei
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

2220 { (*
c⁄vît
) (const *, *, , ) ;

2221 
buf„æí
, 
wrôecou¡
 ;

2222 
sf_cou¡_t
 
tŸÆ
 = 0 ;

2224 
c⁄vît
 = (
psf
->
add_˛ùpög
Ë? 
f2bei_˛ù_¨øy
 : 
f2bei_¨øy
 ;

2225 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

2227 
Àn
 > 0)

2228 { i‡(
Àn
 < 
buf„æí
)

2229 
buf„æí
 = (Ë
Àn
 ;

2230 
	`c⁄vît
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
ibuf
, 
buf„æí
,Ösf->
n‹m_Êﬂt
) ;

2231 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ibuf
,  (), 
buf„æí
,Ösf) ;

2232 
tŸÆ
 +
wrôecou¡
 ;

2233 i‡(
wrôecou¡
 < 
buf„æí
)

2235 
Àn
 -
wrôecou¡
 ;

2238  
tŸÆ
 ;

2239 
	}
}

2245 
	$f2Ài_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÆize
)

2246 { *
u˝å
 ;

2247 
n‹mÁ˘
 ;

2248 
vÆue
 ;

2250 
n‹mÁ˘
 = 
n‹mÆize
 ? (1.0 * 0x7FFFFFFF) : 1.0 ;

2251 
u˝å
 = ((*Ë
de°
Ë+ 4 * 
cou¡
 ;

2253 --
cou¡
 >= 0)

2254 { 
u˝å
 -= 4 ;

2255 
vÆue
 = 
	`Ãötf
 (
§c
 [
cou¡
] * 
n‹mÁ˘
) ;

2256 
u˝å
 [0] = 
vÆue
 ;

2257 
u˝å
 [1] = 
vÆue
 >> 8 ;

2258 
u˝å
 [2] = 
vÆue
 >> 16 ;

2259 
u˝å
 [3] = 
vÆue
 >> 24 ;

2261 
	}
}

2264 
	$f2Ài_˛ù_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÆize
)

2265 { *
u˝å
 ;

2266 
n‹mÁ˘
, 
sˇÀd_vÆue
 ;

2267 
vÆue
 ;

2269 
n‹mÁ˘
 = 
n‹mÆize
 ? (8.0 * 0x10000000) : 1.0 ;

2270 
u˝å
 = ((*Ë
de°
Ë+ 4 * 
cou¡
 ;

2272 --
cou¡
 >= 0)

2273 { 
u˝å
 -= 4 ;

2274 
sˇÀd_vÆue
 = 
§c
 [
cou¡
] * 
n‹mÁ˘
 ;

2275 i‡(
CPU_CLIPS_POSITIVE
 =0 && 
sˇÀd_vÆue
 >= (1.0 * 0x7FFFFFFF))

2276 { 
u˝å
 [0] = 0xFF ;

2277 
u˝å
 [1] = 0xFF ;

2278 
u˝å
 [2] = 0xFF ;

2279 
u˝å
 [3] = 0x7F ;

2282 i‡(
CPU_CLIPS_NEGATIVE
 =0 && 
sˇÀd_vÆue
 <= (-8.0 * 0x10000000))

2283 { 
u˝å
 [0] = 0x00 ;

2284 
u˝å
 [1] = 0x00 ;

2285 
u˝å
 [2] = 0x00 ;

2286 
u˝å
 [3] = 0x80 ;

2290 
vÆue
 = 
	`Ãötf
 (
sˇÀd_vÆue
) ;

2291 
u˝å
 [0] = 
vÆue
 ;

2292 
u˝å
 [1] = 
vÆue
 >> 8 ;

2293 
u˝å
 [2] = 
vÆue
 >> 16 ;

2294 
u˝å
 [3] = 
vÆue
 >> 24 ;

2296 
	}
}

2298 
sf_cou¡_t


2299 
	$pcm_wrôe_f2Ài
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

2300 { (*
c⁄vît
) (const *, *, , ) ;

2301 
buf„æí
, 
wrôecou¡
 ;

2302 
sf_cou¡_t
 
tŸÆ
 = 0 ;

2304 
c⁄vît
 = (
psf
->
add_˛ùpög
Ë? 
f2Ài_˛ù_¨øy
 : 
f2Ài_¨øy
 ;

2305 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

2307 
Àn
 > 0)

2308 { i‡(
Àn
 < 
buf„æí
)

2309 
buf„æí
 = (Ë
Àn
 ;

2310 
	`c⁄vît
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
ibuf
, 
buf„æí
,Ösf->
n‹m_Êﬂt
) ;

2311 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ibuf
,  (), 
buf„æí
,Ösf) ;

2312 
tŸÆ
 +
wrôecou¡
 ;

2313 i‡(
wrôecou¡
 < 
buf„æí
)

2315 
Àn
 -
wrôecou¡
 ;

2318  
tŸÆ
 ;

2319 
	}
}

2325 
	$d2sc_¨øy
 (c⁄° *
§c
, sig√d *
de°
, 
cou¡
, 
n‹mÆize
)

2326 { 
n‹mÁ˘
 ;

2328 
n‹mÁ˘
 = 
n‹mÆize
 ? (1.0 * 0x7F) : 1.0 ;

2330 --
cou¡
 >= 0)

2331 { 
de°
 [
cou¡
] = 
	`Ãöt
 (
§c
 [cou¡] * 
n‹mÁ˘
) ;

2333 
	}
}

2336 
	$d2sc_˛ù_¨øy
 (c⁄° *
§c
, sig√d *
de°
, 
cou¡
, 
n‹mÆize
)

2337 { 
n‹mÁ˘
, 
sˇÀd_vÆue
 ;

2339 
n‹mÁ˘
 = 
n‹mÆize
 ? (8.0 * 0x10000000) : (1.0 * 0x1000000) ;

2341 --
cou¡
 >= 0)

2342 { 
sˇÀd_vÆue
 = 
§c
 [
cou¡
] * 
n‹mÁ˘
 ;

2343 i‡(
CPU_CLIPS_POSITIVE
 =0 && 
sˇÀd_vÆue
 >= (1.0 * 0x7FFFFFFF))

2344 { 
de°
 [
cou¡
] = 127 ;

2347 i‡(
CPU_CLIPS_NEGATIVE
 =0 && 
sˇÀd_vÆue
 <= (-8.0 * 0x10000000))

2348 { 
de°
 [
cou¡
] = -128 ;

2352 
de°
 [
cou¡
] = 
	`Ãötf
 (
sˇÀd_vÆue
) >> 24 ;

2354 
	}
}

2356 
sf_cou¡_t


2357 
	$pcm_wrôe_d2sc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

2358 { (*
c⁄vît
) (const *, signed *, , ) ;

2359 
buf„æí
, 
wrôecou¡
 ;

2360 
sf_cou¡_t
 
tŸÆ
 = 0 ;

2362 
c⁄vît
 = (
psf
->
add_˛ùpög
Ë? 
d2sc_˛ù_¨øy
 : 
d2sc_¨øy
 ;

2363 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
scbuf
) ;

2365 
Àn
 > 0)

2366 { i‡(
Àn
 < 
buf„æí
)

2367 
buf„æí
 = (Ë
Àn
 ;

2368 
	`c⁄vît
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
scbuf
, 
buf„æí
,Ösf->
n‹m_doubÀ
) ;

2369 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
scbuf
,  (sig√d ), 
buf„æí
,Ösf) ;

2370 
tŸÆ
 +
wrôecou¡
 ;

2371 i‡(
wrôecou¡
 < 
buf„æí
)

2373 
Àn
 -
wrôecou¡
 ;

2376  
tŸÆ
 ;

2377 
	}
}

2383 
	$d2uc_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÆize
)

2384 { 
n‹mÁ˘
 ;

2386 
n‹mÁ˘
 = 
n‹mÆize
 ? (1.0 * 0x7F) : 1.0 ;

2388 --
cou¡
 >= 0)

2389 { 
de°
 [
cou¡
] = 
	`Ãöt
 (
§c
 [cou¡] * 
n‹mÁ˘
) + 128 ;

2391 
	}
}

2394 
	$d2uc_˛ù_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÆize
)

2395 { 
n‹mÁ˘
, 
sˇÀd_vÆue
 ;

2397 
n‹mÁ˘
 = 
n‹mÆize
 ? (8.0 * 0x10000000) : (1.0 * 0x1000000) ;

2399 --
cou¡
 >= 0)

2400 { 
sˇÀd_vÆue
 = 
§c
 [
cou¡
] * 
n‹mÁ˘
 ;

2401 i‡(
CPU_CLIPS_POSITIVE
 =0 && 
sˇÀd_vÆue
 >= (1.0 * 0x7FFFFFFF))

2402 { 
de°
 [
cou¡
] = 255 ;

2405 i‡(
CPU_CLIPS_NEGATIVE
 =0 && 
sˇÀd_vÆue
 <= (-8.0 * 0x10000000))

2406 { 
de°
 [
cou¡
] = 0 ;

2410 
de°
 [
cou¡
] = (
	`Ãöt
 (
§c
 [cou¡] * 
n‹mÁ˘
) >> 24) + 128 ;

2412 
	}
}

2414 
sf_cou¡_t


2415 
	$pcm_wrôe_d2uc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

2416 { (*
c⁄vît
) (const *, *, , ) ;

2417 
buf„æí
, 
wrôecou¡
 ;

2418 
sf_cou¡_t
 
tŸÆ
 = 0 ;

2420 
c⁄vît
 = (
psf
->
add_˛ùpög
Ë? 
d2uc_˛ù_¨øy
 : 
d2uc_¨øy
 ;

2421 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

2423 
Àn
 > 0)

2424 { i‡(
Àn
 < 
buf„æí
)

2425 
buf„æí
 = (Ë
Àn
 ;

2426 
	`c⁄vît
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
ucbuf
, 
buf„æí
,Ösf->
n‹m_doubÀ
) ;

2427 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ucbuf
,  (), 
buf„æí
,Ösf) ;

2428 
tŸÆ
 +
wrôecou¡
 ;

2429 i‡(
wrôecou¡
 < 
buf„æí
)

2431 
Àn
 -
wrôecou¡
 ;

2434  
tŸÆ
 ;

2435 
	}
}

2441 
	$d2bes_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÆize
)

2442 { *
u˝å
 ;

2443 
vÆue
 ;

2444 
n‹mÁ˘
 ;

2446 
n‹mÁ˘
 = 
n‹mÆize
 ? (1.0 * 0x7FFF) : 1.0 ;

2447 
u˝å
 = ((*Ë
de°
Ë+ 2 * 
cou¡
 ;

2449 --
cou¡
 >= 0)

2450 { 
u˝å
 -= 2 ;

2451 
vÆue
 = 
	`Ãöt
 (
§c
 [
cou¡
] * 
n‹mÁ˘
) ;

2452 
u˝å
 [1] = 
vÆue
 ;

2453 
u˝å
 [0] = 
vÆue
 >> 8 ;

2455 
	}
}

2458 
	$d2bes_˛ù_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÆize
)

2459 { *
u˝å
 ;

2460 
n‹mÁ˘
, 
sˇÀd_vÆue
 ;

2461 
vÆue
 ;

2463 
n‹mÁ˘
 = 
n‹mÆize
 ? (8.0 * 0x10000000) : (1.0 * 0x10000) ;

2464 
u˝å
 = ((*Ë
de°
Ë+ 2 * 
cou¡
 ;

2466 --
cou¡
 >= 0)

2467 { 
u˝å
 -= 2 ;

2468 
sˇÀd_vÆue
 = 
§c
 [
cou¡
] * 
n‹mÁ˘
 ;

2469 i‡(
CPU_CLIPS_POSITIVE
 =0 && 
sˇÀd_vÆue
 >= (1.0 * 0x7FFFFFFF))

2470 { 
u˝å
 [1] = 0xFF ;

2471 
u˝å
 [0] = 0x7F ;

2474 i‡(
CPU_CLIPS_NEGATIVE
 =0 && 
sˇÀd_vÆue
 <= (-8.0 * 0x10000000))

2475 { 
u˝å
 [1] = 0x00 ;

2476 
u˝å
 [0] = 0x80 ;

2480 
vÆue
 = 
	`Ãöt
 (
sˇÀd_vÆue
) ;

2481 
u˝å
 [1] = 
vÆue
 >> 16 ;

2482 
u˝å
 [0] = 
vÆue
 >> 24 ;

2484 
	}
}

2486 
sf_cou¡_t


2487 
	$pcm_wrôe_d2bes
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

2488 { (*
c⁄vît
) (const *, *, , ) ;

2489 
buf„æí
, 
wrôecou¡
 ;

2490 
sf_cou¡_t
 
tŸÆ
 = 0 ;

2492 
c⁄vît
 = (
psf
->
add_˛ùpög
Ë? 
d2bes_˛ù_¨øy
 : 
d2bes_¨øy
 ;

2493 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

2495 
Àn
 > 0)

2496 { i‡(
Àn
 < 
buf„æí
)

2497 
buf„æí
 = (Ë
Àn
 ;

2498 
	`c⁄vît
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
sbuf
, 
buf„æí
,Ösf->
n‹m_doubÀ
) ;

2499 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
sbuf
,  (), 
buf„æí
,Ösf) ;

2500 
tŸÆ
 +
wrôecou¡
 ;

2501 i‡(
wrôecou¡
 < 
buf„æí
)

2503 
Àn
 -
wrôecou¡
 ;

2506  
tŸÆ
 ;

2507 
	}
}

2513 
	$d2Às_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÆize
)

2514 { *
u˝å
 ;

2515 
vÆue
 ;

2516 
n‹mÁ˘
 ;

2518 
n‹mÁ˘
 = 
n‹mÆize
 ? (1.0 * 0x7FFF) : 1.0 ;

2519 
u˝å
 = ((*Ë
de°
Ë+ 2 * 
cou¡
 ;

2521 --
cou¡
 >= 0)

2522 { 
u˝å
 -= 2 ;

2523 
vÆue
 = 
	`Ãöt
 (
§c
 [
cou¡
] * 
n‹mÁ˘
) ;

2524 
u˝å
 [0] = 
vÆue
 ;

2525 
u˝å
 [1] = 
vÆue
 >> 8 ;

2527 
	}
}

2530 
	$d2Às_˛ù_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÆize
)

2531 { *
u˝å
 ;

2532 
vÆue
 ;

2533 
n‹mÁ˘
, 
sˇÀd_vÆue
 ;

2535 
n‹mÁ˘
 = 
n‹mÆize
 ? (8.0 * 0x10000000) : (1.0 * 0x10000) ;

2536 
u˝å
 = ((*Ë
de°
Ë+ 2 * 
cou¡
 ;

2538 --
cou¡
 >= 0)

2539 { 
u˝å
 -= 2 ;

2540 
sˇÀd_vÆue
 = 
§c
 [
cou¡
] * 
n‹mÁ˘
 ;

2541 i‡(
CPU_CLIPS_POSITIVE
 =0 && 
sˇÀd_vÆue
 >= (1.0 * 0x7FFFFFFF))

2542 { 
u˝å
 [0] = 0xFF ;

2543 
u˝å
 [1] = 0x7F ;

2546 i‡(
CPU_CLIPS_NEGATIVE
 =0 && 
sˇÀd_vÆue
 <= (-8.0 * 0x10000000))

2547 { 
u˝å
 [0] = 0x00 ;

2548 
u˝å
 [1] = 0x80 ;

2552 
vÆue
 = 
	`Ãöt
 (
sˇÀd_vÆue
) ;

2553 
u˝å
 [0] = 
vÆue
 >> 16 ;

2554 
u˝å
 [1] = 
vÆue
 >> 24 ;

2556 
	}
}

2558 
sf_cou¡_t


2559 
	$pcm_wrôe_d2Às
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

2560 { (*
c⁄vît
) (const *, *, , ) ;

2561 
buf„æí
, 
wrôecou¡
 ;

2562 
sf_cou¡_t
 
tŸÆ
 = 0 ;

2564 
c⁄vît
 = (
psf
->
add_˛ùpög
Ë? 
d2Às_˛ù_¨øy
 : 
d2Às_¨øy
 ;

2565 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

2567 
Àn
 > 0)

2568 { i‡(
Àn
 < 
buf„æí
)

2569 
buf„æí
 = (Ë
Àn
 ;

2570 
	`c⁄vît
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
sbuf
, 
buf„æí
,Ösf->
n‹m_doubÀ
) ;

2571 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
sbuf
,  (), 
buf„æí
,Ösf) ;

2572 
tŸÆ
 +
wrôecou¡
 ;

2573 i‡(
wrôecou¡
 < 
buf„æí
)

2575 
Àn
 -
wrôecou¡
 ;

2578  
tŸÆ
 ;

2579 
	}
}

2585 
	$d2Àt_¨øy
 (c⁄° *
§c
, 
åibyã
 *
de°
, 
cou¡
, 
n‹mÆize
)

2586 { *
u˝å
 ;

2587 
vÆue
 ;

2588 
n‹mÁ˘
 ;

2590 
n‹mÁ˘
 = 
n‹mÆize
 ? (1.0 * 0x7FFFFF) : 1.0 ;

2591 
u˝å
 = ((*Ë
de°
Ë+ 3 * 
cou¡
 ;

2593 --
cou¡
 >= 0)

2594 { 
u˝å
 -= 3 ;

2595 
vÆue
 = 
	`Ãöt
 (
§c
 [
cou¡
] * 
n‹mÁ˘
) ;

2596 
u˝å
 [0] = 
vÆue
 ;

2597 
u˝å
 [1] = 
vÆue
 >> 8 ;

2598 
u˝å
 [2] = 
vÆue
 >> 16 ;

2600 
	}
}

2603 
	$d2Àt_˛ù_¨øy
 (c⁄° *
§c
, 
åibyã
 *
de°
, 
cou¡
, 
n‹mÆize
)

2604 { *
u˝å
 ;

2605 
vÆue
 ;

2606 
n‹mÁ˘
, 
sˇÀd_vÆue
 ;

2608 
n‹mÁ˘
 = 
n‹mÆize
 ? (8.0 * 0x10000000) : (1.0 * 0x100) ;

2609 
u˝å
 = ((*Ë
de°
Ë+ 3 * 
cou¡
 ;

2611 --
cou¡
 >= 0)

2612 { 
u˝å
 -= 3 ;

2613 
sˇÀd_vÆue
 = 
§c
 [
cou¡
] * 
n‹mÁ˘
 ;

2614 i‡(
CPU_CLIPS_POSITIVE
 =0 && 
sˇÀd_vÆue
 >= (1.0 * 0x7FFFFFFF))

2615 { 
u˝å
 [0] = 0xFF ;

2616 
u˝å
 [1] = 0xFF ;

2617 
u˝å
 [2] = 0x7F ;

2620 i‡(
CPU_CLIPS_NEGATIVE
 =0 && 
sˇÀd_vÆue
 <= (-8.0 * 0x10000000))

2621 { 
u˝å
 [0] = 0x00 ;

2622 
u˝å
 [1] = 0x00 ;

2623 
u˝å
 [2] = 0x80 ;

2627 
vÆue
 = 
	`Ãöt
 (
sˇÀd_vÆue
) ;

2628 
u˝å
 [0] = 
vÆue
 >> 8 ;

2629 
u˝å
 [1] = 
vÆue
 >> 16 ;

2630 
u˝å
 [2] = 
vÆue
 >> 24 ;

2632 
	}
}

2634 
sf_cou¡_t


2635 
	$pcm_wrôe_d2Àt
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

2636 { (*
c⁄vît
Ë(c⁄° *, 
åibyã
 *, , ) ;

2637 
buf„æí
, 
wrôecou¡
 ;

2638 
sf_cou¡_t
 
tŸÆ
 = 0 ;

2640 
c⁄vît
 = (
psf
->
add_˛ùpög
Ë? 
d2Àt_˛ù_¨øy
 : 
d2Àt_¨øy
 ;

2641 
buf„æí
 =  (
psf
->
u
.
ucbuf
Ë/ 
SIZEOF_TRIBYTE
 ;

2643 
Àn
 > 0)

2644 { i‡(
Àn
 < 
buf„æí
)

2645 
buf„æí
 = (Ë
Àn
 ;

2646 
	`c⁄vît
 (
±r
 + 
tŸÆ
, (
åibyã
*Ë(
psf
->
u
.
ucbuf
), 
buf„æí
,Ösf->
n‹m_doubÀ
) ;

2647 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ucbuf
, 
SIZEOF_TRIBYTE
, 
buf„æí
,Ösf) ;

2648 
tŸÆ
 +
wrôecou¡
 ;

2649 i‡(
wrôecou¡
 < 
buf„æí
)

2651 
Àn
 -
wrôecou¡
 ;

2654  
tŸÆ
 ;

2655 
	}
}

2661 
	$d2bë_¨øy
 (c⁄° *
§c
, 
åibyã
 *
de°
, 
cou¡
, 
n‹mÆize
)

2662 { *
u˝å
 ;

2663 
vÆue
 ;

2664 
n‹mÁ˘
 ;

2666 
n‹mÁ˘
 = 
n‹mÆize
 ? (1.0 * 0x7FFFFF) : 1.0 ;

2667 
u˝å
 = ((*Ë
de°
Ë+ 3 * 
cou¡
 ;

2669 --
cou¡
 >= 0)

2670 { 
u˝å
 -= 3 ;

2671 
vÆue
 = 
	`Ãöt
 (
§c
 [
cou¡
] * 
n‹mÁ˘
) ;

2672 
u˝å
 [2] = 
vÆue
 ;

2673 
u˝å
 [1] = 
vÆue
 >> 8 ;

2674 
u˝å
 [0] = 
vÆue
 >> 16 ;

2676 
	}
}

2679 
	$d2bë_˛ù_¨øy
 (c⁄° *
§c
, 
åibyã
 *
de°
, 
cou¡
, 
n‹mÆize
)

2680 { *
u˝å
 ;

2681 
vÆue
 ;

2682 
n‹mÁ˘
, 
sˇÀd_vÆue
 ;

2684 
n‹mÁ˘
 = 
n‹mÆize
 ? (8.0 * 0x10000000) : (1.0 * 0x100) ;

2685 
u˝å
 = ((*Ë
de°
Ë+ 3 * 
cou¡
 ;

2687 --
cou¡
 >= 0)

2688 { 
u˝å
 -= 3 ;

2689 
sˇÀd_vÆue
 = 
§c
 [
cou¡
] * 
n‹mÁ˘
 ;

2690 i‡(
CPU_CLIPS_POSITIVE
 =0 && 
sˇÀd_vÆue
 >= (1.0 * 0x7FFFFFFF))

2691 { 
u˝å
 [2] = 0xFF ;

2692 
u˝å
 [1] = 0xFF ;

2693 
u˝å
 [0] = 0x7F ;

2696 i‡(
CPU_CLIPS_NEGATIVE
 =0 && 
sˇÀd_vÆue
 <= (-8.0 * 0x10000000))

2697 { 
u˝å
 [2] = 0x00 ;

2698 
u˝å
 [1] = 0x00 ;

2699 
u˝å
 [0] = 0x80 ;

2703 
vÆue
 = 
	`Ãöt
 (
sˇÀd_vÆue
) ;

2704 
u˝å
 [2] = 
vÆue
 >> 8 ;

2705 
u˝å
 [1] = 
vÆue
 >> 16 ;

2706 
u˝å
 [0] = 
vÆue
 >> 24 ;

2708 
	}
}

2710 
sf_cou¡_t


2711 
	$pcm_wrôe_d2bë
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

2712 { (*
c⁄vît
Ë(c⁄° *, 
åibyã
 *, , ) ;

2713 
buf„æí
, 
wrôecou¡
 ;

2714 
sf_cou¡_t
 
tŸÆ
 = 0 ;

2716 
c⁄vît
 = (
psf
->
add_˛ùpög
Ë? 
d2bë_˛ù_¨øy
 : 
d2bë_¨øy
 ;

2717 
buf„æí
 =  (
psf
->
u
.
ucbuf
Ë/ 
SIZEOF_TRIBYTE
 ;

2719 
Àn
 > 0)

2720 { i‡(
Àn
 < 
buf„æí
)

2721 
buf„æí
 = (Ë
Àn
 ;

2722 
	`c⁄vît
 (
±r
 + 
tŸÆ
, (
åibyã
*Ë(
psf
->
u
.
ucbuf
), 
buf„æí
,Ösf->
n‹m_doubÀ
) ;

2723 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ucbuf
, 
SIZEOF_TRIBYTE
, 
buf„æí
,Ösf) ;

2724 
tŸÆ
 +
wrôecou¡
 ;

2725 i‡(
wrôecou¡
 < 
buf„æí
)

2727 
Àn
 -
wrôecou¡
 ;

2730  
tŸÆ
 ;

2731 
	}
}

2737 
	$d2bei_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÆize
)

2738 { *
u˝å
 ;

2739 
vÆue
 ;

2740 
n‹mÁ˘
 ;

2742 
n‹mÁ˘
 = 
n‹mÆize
 ? (1.0 * 0x7FFFFFFF) : 1.0 ;

2743 
u˝å
 = ((*Ë
de°
Ë+ 4 * 
cou¡
 ;

2745 --
cou¡
 >= 0)

2746 { 
u˝å
 -= 4 ;

2747 
vÆue
 = 
	`Ãöt
 (
§c
 [
cou¡
] * 
n‹mÁ˘
) ;

2748 
u˝å
 [0] = 
vÆue
 >> 24 ;

2749 
u˝å
 [1] = 
vÆue
 >> 16 ;

2750 
u˝å
 [2] = 
vÆue
 >> 8 ;

2751 
u˝å
 [3] = 
vÆue
 ;

2753 
	}
}

2756 
	$d2bei_˛ù_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÆize
)

2757 { *
u˝å
 ;

2758 
vÆue
 ;

2759 
n‹mÁ˘
, 
sˇÀd_vÆue
 ;

2761 
n‹mÁ˘
 = 
n‹mÆize
 ? (8.0 * 0x10000000) : 1.0 ;

2762 
u˝å
 = ((*Ë
de°
Ë+ 4 * 
cou¡
 ;

2764 --
cou¡
 >= 0)

2765 { 
u˝å
 -= 4 ;

2766 
sˇÀd_vÆue
 = 
§c
 [
cou¡
] * 
n‹mÁ˘
 ;

2767 i‡(
CPU_CLIPS_POSITIVE
 =0 && 
sˇÀd_vÆue
 >= (1.0 * 0x7FFFFFFF))

2768 { 
u˝å
 [3] = 0xFF ;

2769 
u˝å
 [2] = 0xFF ;

2770 
u˝å
 [1] = 0xFF ;

2771 
u˝å
 [0] = 0x7F ;

2774 i‡(
CPU_CLIPS_NEGATIVE
 =0 && 
sˇÀd_vÆue
 <= (-8.0 * 0x10000000))

2775 { 
u˝å
 [3] = 0x00 ;

2776 
u˝å
 [2] = 0x00 ;

2777 
u˝å
 [1] = 0x00 ;

2778 
u˝å
 [0] = 0x80 ;

2782 
vÆue
 = 
	`Ãöt
 (
sˇÀd_vÆue
) ;

2783 
u˝å
 [0] = 
vÆue
 >> 24 ;

2784 
u˝å
 [1] = 
vÆue
 >> 16 ;

2785 
u˝å
 [2] = 
vÆue
 >> 8 ;

2786 
u˝å
 [3] = 
vÆue
 ;

2788 
	}
}

2790 
sf_cou¡_t


2791 
	$pcm_wrôe_d2bei
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

2792 { (*
c⁄vît
) (const *, *, , ) ;

2793 
buf„æí
, 
wrôecou¡
 ;

2794 
sf_cou¡_t
 
tŸÆ
 = 0 ;

2796 
c⁄vît
 = (
psf
->
add_˛ùpög
Ë? 
d2bei_˛ù_¨øy
 : 
d2bei_¨øy
 ;

2797 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

2799 
Àn
 > 0)

2800 { i‡(
Àn
 < 
buf„æí
)

2801 
buf„æí
 = (Ë
Àn
 ;

2802 
	`c⁄vît
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
ibuf
, 
buf„æí
,Ösf->
n‹m_doubÀ
) ;

2803 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ibuf
,  (), 
buf„æí
,Ösf) ;

2804 
tŸÆ
 +
wrôecou¡
 ;

2805 i‡(
wrôecou¡
 < 
buf„æí
)

2807 
Àn
 -
wrôecou¡
 ;

2810  
tŸÆ
 ;

2811 
	}
}

2817 
	$d2Ài_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÆize
)

2818 { *
u˝å
 ;

2819 
vÆue
 ;

2820 
n‹mÁ˘
 ;

2822 
n‹mÁ˘
 = 
n‹mÆize
 ? (1.0 * 0x7FFFFFFF) : 1.0 ;

2823 
u˝å
 = ((*Ë
de°
Ë+ 4 * 
cou¡
 ;

2825 --
cou¡
 >= 0)

2826 { 
u˝å
 -= 4 ;

2827 
vÆue
 = 
	`Ãöt
 (
§c
 [
cou¡
] * 
n‹mÁ˘
) ;

2828 
u˝å
 [0] = 
vÆue
 ;

2829 
u˝å
 [1] = 
vÆue
 >> 8 ;

2830 
u˝å
 [2] = 
vÆue
 >> 16 ;

2831 
u˝å
 [3] = 
vÆue
 >> 24 ;

2833 
	}
}

2836 
	$d2Ài_˛ù_¨øy
 (c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÆize
)

2837 { *
u˝å
 ;

2838 
vÆue
 ;

2839 
n‹mÁ˘
, 
sˇÀd_vÆue
 ;

2841 
n‹mÁ˘
 = 
n‹mÆize
 ? (8.0 * 0x10000000) : 1.0 ;

2842 
u˝å
 = ((*Ë
de°
Ë+ 4 * 
cou¡
 ;

2844 --
cou¡
 >= 0)

2845 { 
u˝å
 -= 4 ;

2846 
sˇÀd_vÆue
 = 
§c
 [
cou¡
] * 
n‹mÁ˘
 ;

2847 i‡(
CPU_CLIPS_POSITIVE
 =0 && 
sˇÀd_vÆue
 >= (1.0 * 0x7FFFFFFF))

2848 { 
u˝å
 [0] = 0xFF ;

2849 
u˝å
 [1] = 0xFF ;

2850 
u˝å
 [2] = 0xFF ;

2851 
u˝å
 [3] = 0x7F ;

2854 i‡(
CPU_CLIPS_NEGATIVE
 =0 && 
sˇÀd_vÆue
 <= (-8.0 * 0x10000000))

2855 { 
u˝å
 [0] = 0x00 ;

2856 
u˝å
 [1] = 0x00 ;

2857 
u˝å
 [2] = 0x00 ;

2858 
u˝å
 [3] = 0x80 ;

2862 
vÆue
 = 
	`Ãöt
 (
sˇÀd_vÆue
) ;

2863 
u˝å
 [0] = 
vÆue
 ;

2864 
u˝å
 [1] = 
vÆue
 >> 8 ;

2865 
u˝å
 [2] = 
vÆue
 >> 16 ;

2866 
u˝å
 [3] = 
vÆue
 >> 24 ;

2868 
	}
}

2870 
sf_cou¡_t


2871 
	$pcm_wrôe_d2Ài
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

2872 { (*
c⁄vît
) (const *, *, , ) ;

2873 
buf„æí
, 
wrôecou¡
 ;

2874 
sf_cou¡_t
 
tŸÆ
 = 0 ;

2876 
c⁄vît
 = (
psf
->
add_˛ùpög
Ë? 
d2Ài_˛ù_¨øy
 : 
d2Ài_¨øy
 ;

2877 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

2879 
Àn
 > 0)

2880 { i‡(
Àn
 < 
buf„æí
)

2881 
buf„æí
 = (Ë
Àn
 ;

2882 
	`c⁄vît
 (
±r
 + 
tŸÆ
, 
psf
->
u
.
ibuf
, 
buf„æí
,Ösf->
n‹m_doubÀ
) ;

2883 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ibuf
,  (), 
buf„æí
,Ösf) ;

2884 
tŸÆ
 +
wrôecou¡
 ;

2885 i‡(
wrôecou¡
 < 
buf„æí
)

2887 
Àn
 -
wrôecou¡
 ;

2890  
tŸÆ
 ;

2891 
	}
}

	@libsndfile-1.0.17/src/pvf.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<f˙é.h
>

23 
	~<°rög.h
>

24 
	~<˘y≥.h
>

26 
	~"¢dfûe.h
"

27 
	~"s„ndün.h
"

28 
	~"comm⁄.h
"

34 
	#PVF1_MARKER
 (
	`MAKE_MARKER
 ('P', 'V', 'F', '1'))

	)

40 
pvf_˛o£
 (
SF_PRIVATE
 *
psf
) ;

42 
pvf_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
) ;

43 
pvf_ªad_hódî
 (
SF_PRIVATE
 *
psf
) ;

50 
	$pvf_›í
 (
SF_PRIVATE
 *
psf
)

51 { 
subf‹m©
 ;

52 
îr‹
 = 0 ;

54 i‡(
psf
->
mode
 =
SFM_READ
 || (psf->modê=
SFM_RDWR
 &&Ösf->
fûñígth
 > 0))

55 { i‡((
îr‹
 = 
	`pvf_ªad_hódî
 (
psf
)))

56  
îr‹
 ;

59 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

61 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

62 { i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_PVF
)

63  
SFE_BAD_OPEN_FORMAT
 ;

65 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

67 i‡(
	`pvf_wrôe_hódî
 (
psf
, 
SF_FALSE
))

68  
psf
->
îr‹
 ;

70 
psf
->
wrôe_hódî
 = 
pvf_wrôe_hódî
 ;

73 
psf
->
c⁄èöî_˛o£
 = 
pvf_˛o£
 ;

75 
psf
->
blockwidth
 =Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

77 
subf‹m©
)

78 { 
SF_FORMAT_PCM_S8
 :

79 
SF_FORMAT_PCM_16
 :

80 
SF_FORMAT_PCM_32
 :

81 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

87  
îr‹
 ;

88 
	}
}

94 
	$pvf_˛o£
 (
SF_PRIVATE
 *
psf
)

96 
psf
 =Ösf ;

99 
	}
}

102 
	$pvf_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
)

103 { 
sf_cou¡_t
 
cuºít
 ;

105 i‡(
psf
->
pùeoff£t
 > 0)

108 
ˇlc_Àngth
 = calc_length ;

110 
cuºít
 = 
	`psf_·ñl
 (
psf
) ;

113 
psf
->
hódî
 [0] = 0 ;

114 
psf
->
hódödex
 = 0 ;

116 i‡(
psf
->
is_pùe
 =
SF_FALSE
)

117 
	`psf_f£ek
 (
psf
, 0, 
SEEK_SET
) ;

119 
	`LSF_SNPRINTF
 ((*Ë
psf
->
hódî
,  (psf->header), "PVF1\n%d %d %d\n",

120 
psf
->
sf
.
ch™√ls
,Ösf->sf.
ßm∂î©e
,Ösf->
byãwidth
 * 8) ;

122 
psf
->
hódödex
 = 
	`°æí
 ((*Ëpsf->
hódî
) ;

125 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

127 i‡(
psf
->
îr‹
)

128  
psf
->
îr‹
 ;

130 
psf
->
d©aoff£t
 =Ösf->
hódödex
 ;

132 i‡(
cuºít
 > 0)

133 
	`psf_f£ek
 (
psf
, 
cuºít
, 
SEEK_SET
) ;

135  
psf
->
îr‹
 ;

136 
	}
}

139 
	$pvf_ªad_hódî
 (
SF_PRIVATE
 *
psf
)

140 { 
buf„r
 [32] ;

141 
m¨kî
, 
ch™√ls
, 
ßm∂î©e
, 
bôwidth
 ;

143 
	`psf_böhódî_ªadf
 (
psf
, "pmj", 0, &
m¨kî
, 1) ;

144 
	`psf_log_¥ötf
 (
psf
, "%M\n", 
m¨kî
) ;

146 i‡(
m¨kî
 !
PVF1_MARKER
)

147  
SFE_PVF_NO_PVF1
 ;

150 
	`psf_böhódî_ªadf
 (
psf
, "G", 
buf„r
,  (buffer)) ;

152 i‡(
	`ssˇnf
 (
buf„r
, "%d %d %d", &
ch™√ls
, &
ßm∂î©e
, &
bôwidth
) != 3)

153  
SFE_PVF_BAD_HEADER
 ;

155 
	`psf_log_¥ötf
 (
psf
, " Channels : %d\n SampleÑate : %d\n Bit width : %d\n",

156 
ch™√ls
, 
ßm∂î©e
, 
bôwidth
) ;

158 
psf
->
sf
.
ch™√ls
 = channels ;

159 
psf
->
sf
.
ßm∂î©e
 = samplerate ;

161 
bôwidth
)

163 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_PVF
 | 
SF_FORMAT_PCM_S8
 ;

164 
psf
->
byãwidth
 = 1 ;

168 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_PVF
 | 
SF_FORMAT_PCM_16
 ;

169 
psf
->
byãwidth
 = 2 ;

172 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_PVF
 | 
SF_FORMAT_PCM_32
 ;

173 
psf
->
byãwidth
 = 4 ;

177  
SFE_PVF_BAD_BITWIDTH
 ;

180 
psf
->
d©aoff£t
 = 
	`psf_·ñl
 (psf) ;

181 
	`psf_log_¥ötf
 (
psf
, " D©®Off£à: %D\n",Ösf->
d©aoff£t
) ;

183 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

185 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

186 
psf
->
blockwidth
 =Ösf->
sf
.
ch™√ls
 *Ösf->
byãwidth
 ;

188 i‡(! 
psf
->
sf
.
‰ames
 &&Ösf->
blockwidth
)

189 
psf
->
sf
.
‰ames
 = (psf->
fûñígth
 -Ösf->
d©aoff£t
Ë/Ösf->
blockwidth
 ;

192 
	}
}

	@libsndfile-1.0.17/src/raw.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

23 
	~"¢dfûe.h
"

24 
	~"comm⁄.h
"

31 
	$øw_›í
 (
SF_PRIVATE
 *
psf
)

32 { 
subf‹m©
, 
îr‹
 = 
SFE_NO_ERROR
 ;

34 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

36 
psf
->
ídün
 =Ösf->
sf
.
f‹m©
 & 
SF_FORMAT_ENDMASK
 ;

38 i‡(
CPU_IS_BIG_ENDIAN
 && (
psf
->
ídün
 =0 ||Ösf->ídü¿=
SF_ENDIAN_CPU
))

39 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

40 i‡(
CPU_IS_LITTLE_ENDIAN
 && (
psf
->
ídün
 =0 ||Ösf->ídü¿=
SF_ENDIAN_CPU
))

41 
psf
->
ídün
 = 
SF_ENDIAN_LITTLE
 ;

43 
psf
->
blockwidth
 =Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

44 
psf
->
d©aoff£t
 = 0 ;

45 
psf
->
d©Æígth
 =Ösf->
fûñígth
 ;

47 
subf‹m©
)

48 { 
SF_FORMAT_PCM_S8
 :

49 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

52 
SF_FORMAT_PCM_U8
 :

53 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

56 
SF_FORMAT_PCM_16
 :

57 
SF_FORMAT_PCM_24
 :

58 
SF_FORMAT_PCM_32
 :

59 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

62 
SF_FORMAT_ULAW
 :

63 
îr‹
 = 
	`uœw_öô
 (
psf
) ;

66 
SF_FORMAT_ALAW
 :

67 
îr‹
 = 
	`Æaw_öô
 (
psf
) ;

70 
SF_FORMAT_GSM610
 :

71 
îr‹
 = 
	`gsm610_öô
 (
psf
) ;

75 
SF_FORMAT_FLOAT
 :

76 
îr‹
 = 
	`Êﬂt32_öô
 (
psf
) ;

79 
SF_FORMAT_DOUBLE
 :

80 
îr‹
 = 
	`doubÀ64_öô
 (
psf
) ;

83 
SF_FORMAT_DWVW_12
 :

84 
îr‹
 = 
	`dwvw_öô
 (
psf
, 12) ;

87 
SF_FORMAT_DWVW_16
 :

88 
îr‹
 = 
	`dwvw_öô
 (
psf
, 16) ;

91 
SF_FORMAT_DWVW_24
 :

92 
îr‹
 = 
	`dwvw_öô
 (
psf
, 24) ;

95 
SF_FORMAT_VOX_ADPCM
 :

96 
îr‹
 = 
	`vox_adpcm_öô
 (
psf
) ;

100  :  
SFE_BAD_OPEN_FORMAT
 ;

103  
îr‹
 ;

104 
	}
}

	@libsndfile-1.0.17/src/rx2.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°rög.h
>

23 
	~<˘y≥.h
>

24 
	~<°d¨g.h
>

26 
	~"¢dfûe.h
"

27 
	~"s„ndün.h
"

28 
	~"comm⁄.h
"

30 #i‡(
ENABLE_EXPERIMENTAL_CODE
 == 0)

33 
	$rx2_›í
 (
SF_PRIVATE
 *
psf
)

34 { i‡(
psf
)

35  
SFE_UNIMPLEMENTED
 ;

36  (
psf
 && 0) ;

37 
	}
}

45 
	#CAT_MARKER
 (
	`MAKE_MARKER
 ('C', 'A', 'T', ' '))

	)

46 
	#GLOB_MARKER
 (
	`MAKE_MARKER
 ('G', 'L', 'O', 'B'))

	)

48 
	#RECY_MARKER
 (
	`MAKE_MARKER
 ('R', 'E', 'C', 'Y'))

	)

50 
	#SLCL_MARKER
 (
	`MAKE_MARKER
 ('S', 'L', 'C', 'L'))

	)

51 
	#SLCE_MARKER
 (
	`MAKE_MARKER
 ('S', 'L', 'C', 'E'))

	)

53 
	#DEVL_MARKER
 (
	`MAKE_MARKER
 ('D', 'E', 'V', 'L'))

	)

54 
	#TRSH_MARKER
 (
	`MAKE_MARKER
 ('T', 'R', 'S', 'H'))

	)

56 
	#EQ_MARKER
 (
	`MAKE_MARKER
 ('E', 'Q', ' ', ' '))

	)

57 
	#COMP_MARKER
 (
	`MAKE_MARKER
 ('C', 'O', 'M', 'P'))

	)

59 
	#SINF_MARKER
 (
	`MAKE_MARKER
 ('S', 'I', 'N', 'F'))

	)

60 
	#SDAT_MARKER
 (
	`MAKE_MARKER
 ('S', 'D', 'A', 'T'))

	)

70 
rx2_˛o£
 (
SF_PRIVATE
 *
psf
) ;

77 
	$rx2_›í
 (
SF_PRIVATE
 *
psf
)

78 { c⁄° *
m¨kî_ty≥
 [4] =

83 
îr‹
, 
m¨kî
, 
Àngth
, 
glob_off£t
, 
¶˚_cou¡
, 
‰ames
 ;

85 
sd©_Àngth
 = 0, 
¶˚_tŸÆ
 = 0 ;

87 
n_ch™√ls
 ;

92 
	`psf_böhódî_ªadf
 (
psf
, "Epm4", 0, &
m¨kî
, &
Àngth
) ;

94 i‡(
m¨kî
 !
CAT_MARKER
)

95 { 
	`psf_log_¥ötf
 (
psf
, "Àngth : %d\n", 
Àngth
) ;

99 i‡(
Àngth
 !
psf
->
fûñígth
 - 8)

100 
	`psf_log_¥ötf
 (
psf
, "%M : %d (should bê%d)\n", 
m¨kî
, 
Àngth
,Ösf->
fûñígth
 - 8) ;

102 
	`psf_log_¥ötf
 (
psf
, "%M : %d\n", 
m¨kî
, 
Àngth
) ;

105 
	`psf_böhódî_ªadf
 (
psf
, "m", &
m¨kî
) ;

106 
	`psf_log_¥ötf
 (
psf
, "%M", 
m¨kî
) ;

109 
	`psf_böhódî_ªadf
 (
psf
, "m", &
m¨kî
) ;

110 
	`psf_log_¥ötf
 (
psf
, "%M\n", 
m¨kî
) ;

113 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
glob_off£t
) ;

114 
glob_off£t
 += 0x14 ;

117 
	`psf_böhódî_ªadf
 (
psf
, "p", 0x30) ;

120 
Àngth
 = 0 ;

121 
	`psf_böhódî_ªadf
 (
psf
, "1", &
Àngth
) ;

122 i‡(
Àngth
 >
	`SIGNED_SIZEOF
 (
psf
->
u
.
cbuf
))

123 { 
	`psf_log_¥ötf
 (
psf
, " Text : %d *** Error : Too sf_count_t!\n") ;

127 
	`mem£t
 (
psf
->
u
.
cbuf
, 0,  (psf->u.cbuf)) ;

128 
	`psf_böhódî_ªadf
 (
psf
, "b",Ösf->
u
.
cbuf
, 
Àngth
) ;

129 
	`psf_log_¥ötf
 (
psf
, " Texà: \"%s\"\n",Ösf->
u
.
cbuf
) ;

132 i‡(
glob_off£t
 & 1)

133 
glob_off£t
 ++ ;

135 
	`psf_böhódî_ªadf
 (
psf
, "p", 
glob_off£t
) ;

137 
¶˚_cou¡
 = 0 ;

140 { 
	`psf_böhódî_ªadf
 (
psf
, "m", &
m¨kî
) ;

142 i‡(
m¨kî
 !
SLCE_MARKER
 && 
¶˚_cou¡
 > 0)

143 { 
	`psf_log_¥ötf
 (
psf
, " SLCE cou¡ : %d\n", 
¶˚_cou¡
) ;

144 
¶˚_cou¡
 = 0 ;

146 
m¨kî
)

147 { 
GLOB_MARKER
:

148 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
Àngth
) ;

149 
	`psf_log_¥ötf
 (
psf
, " %M : %d\n", 
m¨kî
, 
Àngth
) ;

150 
	`psf_böhódî_ªadf
 (
psf
, "j", 
Àngth
) ;

153 
RECY_MARKER
:

154 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
Àngth
) ;

155 
	`psf_log_¥ötf
 (
psf
, " %M : %d\n", 
m¨kî
, 
Àngth
) ;

156 
	`psf_böhódî_ªadf
 (
psf
, "j", (
Àngth
+1) & 0xFFFFFFFE) ;

159 
CAT_MARKER
:

160 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
Àngth
) ;

161 
	`psf_log_¥ötf
 (
psf
, " %M : %d\n", 
m¨kî
, 
Àngth
) ;

165 
DEVL_MARKER
:

166 
	`psf_böhódî_ªadf
 (
psf
, "mE4", &
m¨kî
, &
Àngth
) ;

167 
	`psf_log_¥ötf
 (
psf
, " DEVL%M : %d\n", 
m¨kî
, 
Àngth
) ;

168 i‡(
Àngth
 & 1)

169 
Àngth
 ++ ;

170 
	`psf_böhódî_ªadf
 (
psf
, "j", 
Àngth
) ;

173 
EQ_MARKER
:

174 
COMP_MARKER
:

175 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
Àngth
) ;

176 
	`psf_log_¥ötf
 (
psf
, " %M : %d\n", 
m¨kî
, 
Àngth
) ;

178 i‡(
Àngth
 & 1)

179 
Àngth
 ++ ;

180 
	`psf_böhódî_ªadf
 (
psf
, "j", 
Àngth
) ;

183 
SLCL_MARKER
:

184 
	`psf_log_¥ötf
 (
psf
, " %M\¿ (Off£t, NexàOff£t, Ty≥)\n", 
m¨kî
) ;

185 
¶˚_cou¡
 = 0 ;

188 
SLCE_MARKER
:

189 { 
Àn
 [4], 
ödx
 ;

191 
	`psf_böhódî_ªadf
 (
psf
, "E4444", &
Àn
 [0], &len [1], &len [2], &len [3]) ;

193 
ödx
 = ((
Àn
 [3] & 0x0000FFFF) >> 8) & 3 ;

195 i‡(
Àn
 [2] == 1)

196 { i‡(
ödx
 != 1)

197 
ödx
 = 3 ;

199 
	`psf_log_¥ötf
 (
psf
, " %M : (%6d, ?: 0x%X, %s)\n", 
m¨kî
, 
Àn
 [1], (À¿[3] & 0xFFFF0000Ë>> 16, 
m¨kî_ty≥
 [
ödx
]) ;

202 { 
¶˚_tŸÆ
 +
Àn
 [2] ;

204 
	`psf_log_¥ötf
 (
psf
, " %M : (%6d, SLCE_√xt_ofs:%d, ?: 0x%X, %s)\n", 
m¨kî
, 
Àn
 [1],Üí [2], (À¿[3] & 0xFFFF0000Ë>> 16, 
m¨kî_ty≥
 [
ödx
]) ;

207 
¶˚_cou¡
 ++ ;

211 
SINF_MARKER
:

212 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
Àngth
) ;

213 
	`psf_log_¥ötf
 (
psf
, " %M : %d\n", 
m¨kî
, 
Àngth
) ;

215 
	`psf_böhódî_ªadf
 (
psf
, "E2", &
n_ch™√ls
) ;

216 
n_ch™√ls
 = (n_channels & 0x0000FF00) >> 8 ;

217 
	`psf_log_¥ötf
 (
psf
, " Ch™√l† : %d\n", 
n_ch™√ls
) ;

219 
	`psf_böhódî_ªadf
 (
psf
, "E44", &psf->
sf
.
ßm∂î©e
, &
‰ames
) ;

220 
psf
->
sf
.
‰ames
 = frames ;

221 
	`psf_log_¥ötf
 (
psf
, " Sam∂êR©ê: %d\n",Ösf->
sf
.
ßm∂î©e
) ;

222 
	`psf_log_¥ötf
 (
psf
, " Føme† : %D\n",Ösf->
sf
.
‰ames
) ;

224 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
Àngth
) ;

225 
	`psf_log_¥ötf
 (
psf
, " ??????????? : %d\n", 
Àngth
) ;

227 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
Àngth
) ;

228 
	`psf_log_¥ötf
 (
psf
, " ??????????? : %d\n", 
Àngth
) ;

231 
SDAT_MARKER
:

232 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
Àngth
) ;

234 
sd©_Àngth
 = 
Àngth
 ;

237 
psf
->
d©aoff£t
 = 
	`psf_böhódî_ªadf
 (psf, 
NULL
) ;

239 i‡(
psf
->
d©aoff£t
 + 
Àngth
 !psf->
fûñígth
)

240 
	`psf_log_¥ötf
 (
psf
, " %M : %d (should bê%d)\n", 
m¨kî
, 
Àngth
,Ösf->
d©aoff£t
 +Ösf->
fûñígth
) ;

242 
	`psf_log_¥ötf
 (
psf
, " %M : %d\n", 
m¨kî
, 
Àngth
) ;

246 
	`psf_log_¥ötf
 (
psf
, "Unknow¿m¨kî : 0x%X %M", 
m¨kî
, marker) ;

252 i‡(
m¨kî
 =
SDAT_MARKER
)

256 
	`puts
 (
psf
->
logbuf„r
) ;

257 
	`puts
 ("-----------------------------------") ;

259 
	`¥ötf
 ("SDATÜígth : %d\n", 
sd©_Àngth
) ;

260 
	`¥ötf
 ("SLCE cou¡ : %d\n", 
¶˚_cou¡
) ;

263 i‡(
¶˚_cou¡
 =0 && 
¶˚_tŸÆ
 == 1)

264 
¶˚_tŸÆ
 = 
‰ames
 ;

266 
	`¥ötf
 ("SLCE sam∂e†: %d\n", 
¶˚_tŸÆ
) ;

269 
	`¥ötf
 ("Com∞R©iÿ : %f:1\n", (2.0 * 
¶˚_tŸÆ
 * 
n_ch™√ls
Ë/ 
sd©_Àngth
) ;

271 
	`puts
 (" ") ;

273 
psf
->
logbuf„r
 [0] = 0 ;

277 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

279 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

281 i‡(
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
, 
SEEK_SET
))

282  
SFE_BAD_SEEK
 ;

284 
psf
->
sf
.
f‹m©
 = (
SF_FORMAT_REX2
 | 
SF_FORMAT_DWVW_12
) ;

286 
psf
->
sf
.
ch™√ls
 = 1 ;

287 
psf
->
byãwidth
 = 2 ;

288 
psf
->
blockwidth
 =Ösf->
sf
.
ch™√ls
 *Ösf->
byãwidth
 ;

290 i‡((
îr‹
 = 
	`dwvw_öô
 (
psf
, 16)))

291  
îr‹
 ;

293 
psf
->
c⁄èöî_˛o£
 = 
rx2_˛o£
 ;

295 i‡(! 
psf
->
sf
.
‰ames
 &&Ösf->
blockwidth
)

296 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 /Ösf->
blockwidth
 ;

301 
	}
}

307 
	$rx2_˛o£
 (
SF_PRIVATE
 *
psf
)

309 i‡(
psf
->
mode
 =
SFM_WRITE
)

317 
	}
}

	@libsndfile-1.0.17/src/sd2.c

30 
	~"sfc⁄fig.h
"

32 
	~<°dio.h
>

33 
	~<°dlib.h
>

34 
	~<°rög.h
>

35 
	~<˘y≥.h
>

37 
	~"¢dfûe.h
"

38 
	~"s„ndün.h
"

39 
	~"comm⁄.h
"

45 
	#Sd2f_MARKER
 
	`MAKE_MARKER
 ('S', 'd', '2', 'f')

	)

46 
	#Sd2a_MARKER
 
	`MAKE_MARKER
 ('S', 'd', '2', 'a')

	)

47 
	#ALCH_MARKER
 
	`MAKE_MARKER
 ('A', 'L', 'C', 'H')

	)

48 
	#lsf1_MARKER
 
	`MAKE_MARKER
 ('l', 's', 'f', '1')

	)

50 
	#STR_MARKER
 
	`MAKE_MARKER
 ('S', 'T', 'R', ' ')

	)

51 
	#sdML_MARKER
 
	`MAKE_MARKER
 ('s', 'd', 'M', 'L')

	)

54 { 
	mRSRC_STR
 = 111,

55 
	mRSRC_BIN


59 { * 
	mr§c_d©a
 ;

60 
	mr§c_Àn
 ;

62 
	md©a_off£t
, 
	md©a_Àngth
 ;

63 
	mm≠_off£t
, 
	mm≠_Àngth
 ;

65 
	mty≥_cou¡
, 
	mty≥_off£t
 ;

66 
	môem_off£t
 ;

68 
	m°r_ödex
, 
	m°r_cou¡
 ;

70 
	m°rög_off£t
 ;

73 
	mßm∂e_size
, 
	mßm∂e_øã
, 
	mch™√ls
 ;

74 } 
	tSD2_RSRC
 ;

77 { 
	mty≥
 ;

78 
	mid
 ;

79 
	m«me
 [32] ;

80 
	mvÆue
 [32] ;

81 
	mvÆue_Àn
 ;

82 } 
	tSTR_RSRC
 ;

88 
sd2_˛o£
 (
SF_PRIVATE
 *
psf
) ;

90 
sd2_∑r£_r§c_f‹k
 (
SF_PRIVATE
 *
psf
) ;

91 
∑r£_°r_r§c
 (
SF_PRIVATE
 *
psf
, 
SD2_RSRC
 * 
r§c
) ;

93 
sd2_wrôe_r§c_f‹k
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
) ;

100 
	$sd2_›í
 (
SF_PRIVATE
 *
psf
)

101 { 
subf‹m©
, 
îr‹
 = 0, 
vÆid
 ;

104 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

106 i‡(
psf
->
mode
 =
SFM_READ
 || (psf->modê=
SFM_RDWR
 &&Ösf->
r§˛ígth
 > 0))

107 { 
	`psf_u£_r§c
 (
psf
, 
SF_TRUE
) ;

108 
vÆid
 = 
	`psf_fûe_vÆid
 (
psf
) ;

109 
	`psf_u£_r§c
 (
psf
, 
SF_FALSE
) ;

110 i‡(! 
vÆid
)

111 { 
	`psf_log_¥ötf
 (
psf
, "sd2_open :Ösf->rsrcdes < 0\n") ;

112  
SFE_SD2_BAD_RSRC
 ;

115 
îr‹
 = 
	`sd2_∑r£_r§c_f‹k
 (
psf
) ;

117 i‡(
îr‹
)

118 
îr‹_˛ónup
 ;

121 i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_SD2
)

122 { 
îr‹
 = 
SFE_BAD_OPEN_FORMAT
 ;

123 
îr‹_˛ónup
 ;

126 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

127 
psf
->
d©aoff£t
 = 0 ;

130 i‡(
psf
->
mode
 =
SFM_WRITE
 || (psf->modê=
SFM_RDWR
 &&Ösf->
r§˛ígth
 == 0))

131 { 
	`psf_›í_r§c
 (
psf
,Ösf->
mode
) ;

133 
îr‹
 = 
	`sd2_wrôe_r§c_f‹k
 (
psf
, 
SF_FALSE
) ;

135 i‡(
îr‹
)

136 
îr‹_˛ónup
 ;

139 
psf
->
wrôe_hódî
 = 
NULL
 ;

142 
psf
->
c⁄èöî_˛o£
 = 
sd2_˛o£
 ;

144 
psf
->
blockwidth
 =Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

146 
subf‹m©
)

147 { 
SF_FORMAT_PCM_S8
 :

148 
SF_FORMAT_PCM_16
 :

149 
SF_FORMAT_PCM_24
 :

150 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

154 
îr‹
 = 
SFE_UNIMPLEMENTED
 ;

158 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
, 
SEEK_SET
) ;

160 
îr‹_˛ónup
:

163 
	`psf_˛o£_r§c
 (
psf
) ;

165  
îr‹
 ;

166 
	}
}

172 
	$sd2_˛o£
 (
SF_PRIVATE
 *
psf
)

174 i‡(
psf
->
mode
 =
SFM_WRITE
)

182 
	}
}

187 
ölöe
 

188 
	$wrôe_ch¨
 (* 
d©a
, 
off£t
, 
vÆue
)

189 { 
d©a
 [
off£t
] = 
vÆue
 ;

190 
	}
}

192 
ölöe
 

193 
	$wrôe_sh‹t
 (* 
d©a
, 
off£t
, 
vÆue
)

194 { 
d©a
 [
off£t
] = 
vÆue
 >> 8 ;

195 
d©a
 [
off£t
 + 1] = 
vÆue
 ;

196 
	}
}

198 
ölöe
 

199 
	$wrôe_öt
 (* 
d©a
, 
off£t
, 
vÆue
)

200 { 
d©a
 [
off£t
] = 
vÆue
 >> 24 ;

201 
d©a
 [
off£t
 + 1] = 
vÆue
 >> 16 ;

202 
d©a
 [
off£t
 + 2] = 
vÆue
 >> 8 ;

203 
d©a
 [
off£t
 + 3] = 
vÆue
 ;

204 
	}
}

206 
ölöe
 

207 
	$wrôe_m¨kî
 (* 
d©a
, 
off£t
, 
vÆue
)

209 i‡(
CPU_IS_BIG_ENDIAN
)

210 { 
d©a
 [
off£t
] = 
vÆue
 >> 24 ;

211 
d©a
 [
off£t
 + 1] = 
vÆue
 >> 16 ;

212 
d©a
 [
off£t
 + 2] = 
vÆue
 >> 8 ;

213 
d©a
 [
off£t
 + 3] = 
vÆue
 ;

216 { 
d©a
 [
off£t
] = 
vÆue
 ;

217 
d©a
 [
off£t
 + 1] = 
vÆue
 >> 8 ;

218 
d©a
 [
off£t
 + 2] = 
vÆue
 >> 16 ;

219 
d©a
 [
off£t
 + 3] = 
vÆue
 >> 24 ;

221 
	}
}

224 
	$wrôe_°r
 (* 
d©a
, 
off£t
, * 
buf„r
, 
buf„r_Àn
)

225 { 
	`mem˝y
 (
d©a
 + 
off£t
, 
buf„r
, 
buf„r_Àn
) ;

226 
	}
}

229 
sd2_wrôe_r§c_f‹k
 (
SF_PRIVATE
 *
psf
, 
	$UNUSED
 (
ˇlc_Àngth
))

230 { 
SD2_RSRC
 
r§c
 ;

231 
STR_RSRC
 
°r_r§c
 [] =

232 { { 
RSRC_STR
, 1000, "_sample-size", "", 0 },

233 { 
RSRC_STR
, 1001, "_sample-rate", "", 0 },

234 { 
RSRC_STR
, 1002, "_channels", "", 0 },

235 { 
RSRC_BIN
, 1000, "_Markers", "", 8 }

238 
k
, 
°r_off£t
, 
d©a_off£t
, 
√xt_°r
 ;

240 
	`psf_u£_r§c
 (
psf
, 
SF_TRUE
) ;

242 
	`mem£t
 (&
r§c
, 0,  (rsrc)) ;

244 
r§c
.
ßm∂e_øã
 = 
psf
->
sf
.
ßm∂î©e
 ;

245 
r§c
.
ßm∂e_size
 = 
psf
->
byãwidth
 ;

246 
r§c
.
ch™√ls
 = 
psf
->
sf
.channels ;

248 
r§c
.
r§c_d©a
 = 
psf
->
hódî
 ;

249 
r§c
.
r§c_Àn
 =  (
psf
->
hódî
) ;

250 
	`mem£t
 (
r§c
.
r§c_d©a
, 0xó,Ñ§c.
r§c_Àn
) ;

252 
	`LSF_SNPRINTF
 (
°r_r§c
 [0].
vÆue
,  (°r_r§¯[0].vÆue), "_%d", 
r§c
.
ßm∂e_size
) ;

253 
	`LSF_SNPRINTF
 (
°r_r§c
 [1].
vÆue
,  (°r_r§¯[1].vÆue), "_%d.000000", 
r§c
.
ßm∂e_øã
) ;

254 
	`LSF_SNPRINTF
 (
°r_r§c
 [2].
vÆue
,  (°r_r§¯[2].vÆue), "_%d", 
r§c
.
ch™√ls
) ;

256 
k
 = 0 ; k < 
	`ARRAY_LEN
 (
°r_r§c
) ; k++)

257 { i‡(
°r_r§c
 [
k
].
vÆue_Àn
 == 0)

258 { 
°r_r§c
 [
k
].
vÆue_Àn
 = 
	`°æí
 (°r_r§¯[k].
vÆue
) ;

259 
°r_r§c
 [
k
].
vÆue
 [0] = så_r§¯[k].
vÆue_Àn
 - 1 ;

263 
°r_r§c
 [
k
].
«me
 [0] = 
	`°æí
 (str_rsrc [k].name) - 1 ;

266 
r§c
.
d©a_off£t
 = 0x100 ;

272 
r§c
.
d©a_Àngth
 = 0 ;

273 
k
 = 0 ; k < 
	`ARRAY_LEN
 (
°r_r§c
) ; k++)

274 
r§c
.
d©a_Àngth
 +
°r_r§c
 [
k
].
vÆue_Àn
 + 4 ;

276 
r§c
.
m≠_off£t
 =Ñ§c.
d©a_off£t
 +Ñ§c.
d©a_Àngth
 ;

279 
	`wrôe_öt
 (
r§c
.
r§c_d©a
, 0,Ñ§c.
d©a_off£t
) ;

280 
	`wrôe_öt
 (
r§c
.
r§c_d©a
, 4,Ñ§c.
m≠_off£t
) ;

281 
	`wrôe_öt
 (
r§c
.
r§c_d©a
, 8,Ñ§c.
d©a_Àngth
) ;

283 
	`wrôe_ch¨
 (
r§c
.
r§c_d©a
, 0x30, 
	`°æí
 (
psf
->
fûíame
)) ;

284 
	`wrôe_°r
 (
r§c
.
r§c_d©a
, 0x31, 
psf
->
fûíame
, 
	`°æí
 (psf->filename)) ;

286 
	`wrôe_sh‹t
 (
r§c
.
r§c_d©a
, 0x50, 0) ;

287 
	`wrôe_m¨kî
 (
r§c
.
r§c_d©a
, 0x52, 
Sd2f_MARKER
) ;

288 
	`wrôe_m¨kî
 (
r§c
.
r§c_d©a
, 0x56, 
lsf1_MARKER
) ;

291 
	`wrôe_öt
 (
r§c
.
r§c_d©a
,Ñ§c.
m≠_off£t
 + 0,Ñ§c.
d©a_off£t
) ;

292 
	`wrôe_öt
 (
r§c
.
r§c_d©a
,Ñ§c.
m≠_off£t
 + 4,Ñsrc.map_offset) ;

293 
	`wrôe_öt
 (
r§c
.
r§c_d©a
,Ñ§c.
m≠_off£t
 + 8,Ñ§c.
d©a_Àngth
) ;

297 { 
	`wrôe_ch¨
 (
r§c
.
r§c_d©a
,Ñ§c.
m≠_off£t
+ 16, 1) ;

299 
	`wrôe_öt
 (
r§c
.
r§c_d©a
,Ñ§c.
m≠_off£t
 + 17, 0x12345678) ;

301 
	`wrôe_sh‹t
 (
r§c
.
r§c_d©a
,Ñ§c.
m≠_off£t
 + 21, 0xabcd) ;

303 
	`wrôe_sh‹t
 (
r§c
.
r§c_d©a
,Ñ§c.
m≠_off£t
 + 23, 0) ;

307 
r§c
.
ty≥_off£t
 =Ñ§c.
m≠_off£t
 + 30 ;

308 
	`wrôe_sh‹t
 (
r§c
.
r§c_d©a
,Ñ§c.
m≠_off£t
 + 24,Ñ§c.
ty≥_off£t
 -Ñsrc.map_offset - 2) ;

311 
r§c
.
ty≥_cou¡
 = 2 ;

312 
	`wrôe_sh‹t
 (
r§c
.
r§c_d©a
,Ñ§c.
m≠_off£t
 + 28,Ñ§c.
ty≥_cou¡
 - 1) ;

314 
r§c
.
ôem_off£t
 =Ñ§c.
ty≥_off£t
 +Ñ§c.
ty≥_cou¡
 * 8 ;

316 
r§c
.
°r_cou¡
 = 
	`ARRAY_LEN
 (
°r_r§c
) ;

317 
r§c
.
°rög_off£t
 =Ñ§c.
ôem_off£t
 + (r§c.
°r_cou¡
 + 1Ë* 12 -Ñ§c.
m≠_off£t
 ;

318 
	`wrôe_sh‹t
 (
r§c
.
r§c_d©a
,Ñ§c.
m≠_off£t
 + 26,Ñ§c.
°rög_off£t
) ;

321 
r§c
.
°r_cou¡
 = 3 ;

322 
	`wrôe_m¨kî
 (
r§c
.
r§c_d©a
,Ñ§c.
ty≥_off£t
, 
STR_MARKER
) ;

323 
	`wrôe_sh‹t
 (
r§c
.
r§c_d©a
,Ñ§c.
ty≥_off£t
 + 4,Ñ§c.
°r_cou¡
 - 1) ;

324 
	`wrôe_sh‹t
 (
r§c
.
r§c_d©a
,Ñ§c.
ty≥_off£t
 + 6, 0x12) ;

327 
	`wrôe_m¨kî
 (
r§c
.
r§c_d©a
,Ñ§c.
ty≥_off£t
 + 8, 
sdML_MARKER
) ;

328 
	`wrôe_sh‹t
 (
r§c
.
r§c_d©a
,Ñ§c.
ty≥_off£t
 + 12, 0) ;

329 
	`wrôe_sh‹t
 (
r§c
.
r§c_d©a
,Ñ§c.
ty≥_off£t
 + 14, 0x36) ;

331 
°r_off£t
 = 
r§c
.
m≠_off£t
 +Ñ§c.
°rög_off£t
 ;

332 
√xt_°r
 = 0 ;

333 
d©a_off£t
 = 
r§c
.data_offset ;

334 
k
 = 0 ; k < 
	`ARRAY_LEN
 (
°r_r§c
) ; k++)

335 { 
	`wrôe_°r
 (
r§c
.
r§c_d©a
, 
°r_off£t
, 
°r_r§c
 [
k
].
«me
, 
	`°æí
 (str_rsrc [k].name)) ;

337 
	`wrôe_sh‹t
 (
r§c
.
r§c_d©a
,Ñ§c.
ôem_off£t
 + 
k
 * 12, 
°r_r§c
 [k].
id
) ;

338 
	`wrôe_sh‹t
 (
r§c
.
r§c_d©a
,Ñ§c.
ôem_off£t
 + 
k
 * 12 + 2, 
√xt_°r
) ;

340 
°r_off£t
 +
	`°æí
 (
°r_r§c
 [
k
].
«me
) ;

341 
√xt_°r
 +
	`°æí
 (
°r_r§c
 [
k
].
«me
) ;

343 
	`wrôe_öt
 (
r§c
.
r§c_d©a
,Ñ§c.
ôem_off£t
 + 
k
 * 12 + 4, 
d©a_off£t
 -Ñsrc.data_offset) ;

345 
	`wrôe_öt
 (
r§c
.
r§c_d©a
, 
d©a_off£t
, 
°r_r§c
 [
k
].
vÆue_Àn
) ;

346 
	`wrôe_°r
 (
r§c
.
r§c_d©a
, 
d©a_off£t
 + 4, 
°r_r§c
 [
k
].
vÆue
, så_r§¯[k].
vÆue_Àn
) ;

347 
d©a_off£t
 +4 + 
°r_r§c
 [
k
].
vÆue_Àn
 ;

351 
r§c
.
m≠_Àngth
 = 
°r_off£t
 -Ñ§c.
m≠_off£t
 ;

352 
	`wrôe_öt
 (
r§c
.
r§c_d©a
, 12,Ñ§c.
m≠_Àngth
) ;

353 
	`wrôe_öt
 (
r§c
.
r§c_d©a
,Ñ§c.
m≠_off£t
 + 12,Ñ§c.
m≠_Àngth
) ;

355 
r§c
.
r§c_Àn
 =Ñ§c.
m≠_off£t
 +Ñ§c.
m≠_Àngth
 ;

357 
	`psf_fwrôe
 (
r§c
.
r§c_d©a
,Ñ§c.
r§c_Àn
, 1, 
psf
) ;

359 
	`psf_u£_r§c
 (
psf
, 
SF_FALSE
) ;

361 i‡(
psf
->
îr‹
)

362  
psf
->
îr‹
 ;

365 
	}
}

370 
ölöe
 

371 
	$ªad_ch¨
 (c⁄° * 
d©a
, 
off£t
)

372 {  
d©a
 [
off£t
] ;

373 
	}
}

375 
ölöe
 

376 
	$ªad_sh‹t
 (c⁄° * 
d©a
, 
off£t
)

377 {  (
d©a
 [
off£t
] << 8) + data [offset + 1] ;

378 
	}
}

380 
ölöe
 

381 
	$ªad_öt
 (c⁄° * 
d©a
, 
off£t
)

382 {  (
d©a
 [
off£t
] << 24) + (data [offset + 1] << 16) + (data [offset + 2] << 8) + data [offset + 3] ;

383 
	}
}

385 
ölöe
 

386 
	$ªad_m¨kî
 (c⁄° * 
d©a
, 
off£t
)

388 i‡(
CPU_IS_BIG_ENDIAN
)

389  (
d©a
 [
off£t
] << 24) + (data [offset + 1] << 16) + (data [offset + 2] << 8) + data [offset + 3] ;

390 i‡(
CPU_IS_LITTLE_ENDIAN
)

391  
d©a
 [
off£t
] + (data [offset + 1] << 8) + (data [offset + 2] << 16) + (data [offset + 3] << 24) ;

394 
	}
}

397 
	$ªad_°r
 (c⁄° * 
d©a
, 
off£t
, * 
buf„r
, 
buf„r_Àn
)

398 { 
k
 ;

400 
	`mem£t
 (
buf„r
, 0, 
buf„r_Àn
) ;

402 
k
 = 0 ; k < 
buf„r_Àn
 - 1 ; k++)

403 { i‡(
	`i•röt
 (
d©a
 [
off£t
 + 
k
]) == 0)

405 
buf„r
 [
k
] = 
d©a
 [
off£t
 + k] ;

408 
	}
}

411 
	$sd2_∑r£_r§c_f‹k
 (
SF_PRIVATE
 *
psf
)

412 { 
SD2_RSRC
 
r§c
 ;

413 
k
, 
m¨kî
, 
îr‹
 = 0 ;

415 
	`psf_u£_r§c
 (
psf
, 
SF_TRUE
) ;

417 
	`mem£t
 (&
r§c
, 0,  (rsrc)) ;

419 
r§c
.
r§c_Àn
 = 
	`psf_gë_fûñí
 (
psf
) ;

420 
	`psf_log_¥ötf
 (
psf
, "Resour˚Üígth : %d (0x%04X)\n", 
r§c
.
r§c_Àn
,Ñsrc.rsrc_len) ;

422 i‡(
r§c
.
r§c_Àn
 > 
	`SIGNED_SIZEOF
 (
psf
->
hódî
))

423 
r§c
.
r§c_d©a
 = 
	`ˇŒoc
 (1,Ñ§c.
r§c_Àn
) ;

425 
r§c
.
r§c_d©a
 = 
psf
->
hódî
 ;

428 
	`psf_‰ód
 (
r§c
.
r§c_d©a
,Ñ§c.
r§c_Àn
, 1, 
psf
) ;

431 
psf
->
hódödex
 =Ösf->
hódíd
 = 
r§c
.
r§c_Àn
 ;

433 
r§c
.
d©a_off£t
 = 
	`ªad_öt
 (r§c.
r§c_d©a
, 0) ;

434 
r§c
.
m≠_off£t
 = 
	`ªad_öt
 (r§c.
r§c_d©a
, 4) ;

435 
r§c
.
d©a_Àngth
 = 
	`ªad_öt
 (r§c.
r§c_d©a
, 8) ;

436 
r§c
.
m≠_Àngth
 = 
	`ªad_öt
 (r§c.
r§c_d©a
, 12) ;

438 i‡(
r§c
.
d©a_off£t
 =0x51607 &&Ñ§c.
m≠_off£t
 == 0x20000)

439 { 
	`psf_log_¥ötf
 (
psf
, "Trying offset of 0x52 bytes.\n") ;

440 
r§c
.
d©a_off£t
 = 
	`ªad_öt
 (r§c.
r§c_d©a
, 0x52 + 0) + 0x52 ;

441 
r§c
.
m≠_off£t
 = 
	`ªad_öt
 (r§c.
r§c_d©a
, 0x52 + 4) + 0x52 ;

442 
r§c
.
d©a_Àngth
 = 
	`ªad_öt
 (r§c.
r§c_d©a
, 0x52 + 8) ;

443 
r§c
.
m≠_Àngth
 = 
	`ªad_öt
 (r§c.
r§c_d©a
, 0x52 + 12) ;

446 
	`psf_log_¥ötf
 (
psf
, " data offset : 0x%04X\n map offset : 0x%04X\n"

448 
r§c
.
d©a_off£t
,Ñ§c.
m≠_off£t
,Ñ§c.
d©a_Àngth
,Ñ§c.
m≠_Àngth
) ;

450 i‡(
r§c
.
d©a_off£t
 >Ñ§c.
r§c_Àn
)

451 { 
	`psf_log_¥ötf
 (
psf
, "Eº‹ :Ñ§c.d©a_off£à(%d, 0x%xË>Üí\n", 
r§c
.
d©a_off£t
,Ñsrc.data_offset) ;

452 
îr‹
 = 
SFE_SD2_BAD_DATA_OFFSET
 ;

453 
∑r£_r§c_f‹k_˛ónup
 ;

456 i‡(
r§c
.
m≠_off£t
 >Ñ§c.
r§c_Àn
)

457 { 
	`psf_log_¥ötf
 (
psf
, "Error :Ñsrc.map_offset >Üen\n") ;

458 
îr‹
 = 
SFE_SD2_BAD_MAP_OFFSET
 ;

459 
∑r£_r§c_f‹k_˛ónup
 ;

462 i‡(
r§c
.
d©a_Àngth
 >Ñ§c.
r§c_Àn
)

463 { 
	`psf_log_¥ötf
 (
psf
, "Error :Ñsrc.data_length >Üen\n") ;

464 
îr‹
 = 
SFE_SD2_BAD_DATA_LENGTH
 ;

465 
∑r£_r§c_f‹k_˛ónup
 ;

468 i‡(
r§c
.
m≠_Àngth
 >Ñ§c.
r§c_Àn
)

469 { 
	`psf_log_¥ötf
 (
psf
, "Error :Ñsrc.map_length >Üen\n") ;

470 
îr‹
 = 
SFE_SD2_BAD_MAP_LENGTH
 ;

471 
∑r£_r§c_f‹k_˛ónup
 ;

474 i‡(
r§c
.
d©a_off£t
 +Ñ§c.
d©a_Àngth
 !r§c.
m≠_off£t
 ||Ñ§c.m≠_off£à+Ñ§c.
m≠_Àngth
 !r§c.
r§c_Àn
)

475 { 
	`psf_log_¥ötf
 (
psf
, "Error : This doesÇotÜookÜikeá MacOSXÑesource fork.\n") ;

476 
îr‹
 = 
SFE_SD2_BAD_RSRC
 ;

477 
∑r£_r§c_f‹k_˛ónup
 ;

480 
r§c
.
°rög_off£t
 =Ñ§c.
m≠_off£t
 + 
	`ªad_sh‹t
 (r§c.
r§c_d©a
,Ñsrc.map_offset + 26) ;

481 i‡(
r§c
.
°rög_off£t
 >Ñ§c.
r§c_Àn
)

482 { 
	`psf_log_¥ötf
 (
psf
, "Bad såög off£à(%d).\n", 
r§c
.
°rög_off£t
) ;

483 
îr‹
 = 
SFE_SD2_BAD_RSRC
 ;

484 
∑r£_r§c_f‹k_˛ónup
 ;

487 
r§c
.
ty≥_off£t
 =Ñ§c.
m≠_off£t
 + 30 ;

489 
r§c
.
ty≥_cou¡
 = 
	`ªad_sh‹t
 (r§c.
r§c_d©a
,Ñ§c.
m≠_off£t
 + 28) + 1 ;

490 i‡(
r§c
.
ty≥_cou¡
 < 1)

491 { 
	`psf_log_¥ötf
 (
psf
, "BadÅype count.\n") ;

492 
îr‹
 = 
SFE_SD2_BAD_RSRC
 ;

493 
∑r£_r§c_f‹k_˛ónup
 ;

496 
r§c
.
ôem_off£t
 =Ñ§c.
ty≥_off£t
 +Ñ§c.
ty≥_cou¡
 * 8 ;

497 i‡(
r§c
.
ôem_off£t
 < 0 ||Ñ§c.ôem_off£à>Ñ§c.
r§c_Àn
)

498 { 
	`psf_log_¥ötf
 (
psf
, "Bad iãm off£à(%d).\n", 
r§c
.
ôem_off£t
) ;

499 
îr‹
 = 
SFE_SD2_BAD_RSRC
 ;

500 
∑r£_r§c_f‹k_˛ónup
 ;

503 
r§c
.
°r_ödex
 = -1 ;

504 
k
 = 0 ; k < 
r§c
.
ty≥_cou¡
 ; k ++)

505 { 
m¨kî
 = 
	`ªad_m¨kî
 (
r§c
.
r§c_d©a
,Ñ§c.
ty≥_off£t
 + 
k
 * 8) ;

507 i‡(
m¨kî
 =
STR_MARKER
)

508 { 
r§c
.
°r_ödex
 = 
k
 ;

509 
r§c
.
°r_cou¡
 = 
	`ªad_sh‹t
 (r§c.
r§c_d©a
,Ñ§c.
ty≥_off£t
 + 
k
 * 8 + 4) + 1 ;

510 
îr‹
 = 
	`∑r£_°r_r§c
 (
psf
, &
r§c
) ;

511 
∑r£_r§c_f‹k_˛ónup
 ;

515 
	`psf_log_¥ötf
 (
psf
, "No 'STR 'Ñesource.\n") ;

516 
îr‹
 = 
SFE_SD2_BAD_RSRC
 ;

518 
∑r£_r§c_f‹k_˛ónup
 :

520 
	`psf_u£_r§c
 (
psf
, 
SF_FALSE
) ;

522 i‡((*Ë
r§c
.
r§c_d©a
 < (*Ë
psf
 || (*)Ñsrc.rsrc_data > (*) (psf + 1))

523 
	`‰ì
 (
r§c
.
r§c_d©a
) ;

525  
îr‹
 ;

526 
	}
}

529 
	$∑r£_°r_r§c
 (
SF_PRIVATE
 *
psf
, 
SD2_RSRC
 * 
r§c
)

530 { 
«me
 [32], 
vÆue
 [32] ;

531 
k
, 
°r_off£t
, 
d©a_off£t
, 
d©a_Àn
, 
r§c_id
 ;

533 
	`psf_log_¥ötf
 (
psf
, "FindingÖarameters :\n") ;

535 
°r_off£t
 = 
r§c
->
°rög_off£t
 ;

536 
k
 = 0 ; k < 
r§c
->
°r_cou¡
 ; k++)

537 { 
¶í
 ;

539 
¶í
 = 
	`ªad_ch¨
 (
r§c
->
r§c_d©a
, 
°r_off£t
) ;

540 
	`ªad_°r
 (
r§c
->
r§c_d©a
, 
°r_off£t
 + 1, 
«me
, 
	`SF_MIN
 (
	`SIGNED_SIZEOF
 («me), 
¶í
 + 1)) ;

541 
°r_off£t
 +
¶í
 + 1 ;

543 
r§c_id
 = 
	`ªad_sh‹t
 (
r§c
->
r§c_d©a
,Ñ§c->
ôem_off£t
 + 
k
 * 12) ;

545 
d©a_off£t
 = 
r§c
->d©a_off£à+ 
	`ªad_öt
 (r§c->
r§c_d©a
,Ñ§c->
ôem_off£t
 + 
k
 * 12 + 4) ;

546 i‡(
d©a_off£t
 < 0 || d©a_off£à> 
r§c
->
r§c_Àn
)

547 { 
	`psf_log_¥ötf
 (
psf
, "Bad d©®off£à(%d)\n", 
d©a_off£t
) ;

548  
SFE_SD2_BAD_DATA_OFFSET
 ;

551 
d©a_Àn
 = 
	`ªad_öt
 (
r§c
->
r§c_d©a
, 
d©a_off£t
) ;

552 i‡(
d©a_Àn
 < 0 || d©a_À¿> 
r§c
->
r§c_Àn
)

553 { 
	`psf_log_¥ötf
 (
psf
, "Bad d©®Àngth (%d).\n", 
d©a_Àn
) ;

554  
SFE_SD2_BAD_RSRC
 ;

557 
¶í
 = 
	`ªad_ch¨
 (
r§c
->
r§c_d©a
, 
d©a_off£t
 + 4) ;

558 
	`ªad_°r
 (
r§c
->
r§c_d©a
, 
d©a_off£t
 + 5, 
vÆue
, 
	`SF_MIN
 (
	`SIGNED_SIZEOF
 (vÆue), 
¶í
 + 1)) ;

560 
	`psf_log_¥ötf
 (
psf
, " %-12† 0x%04x %4d %2d %2d '%s'\n", 
«me
, 
d©a_off£t
, 
r§c_id
, 
d©a_Àn
, 
¶í
, 
vÆue
) ;

562 i‡(
	`°rcmp
 (
«me
, "ßm∂e-size"Ë=0 && 
r§c
->
ßm∂e_size
 == 0)

563 
r§c
->
ßm∂e_size
 = 
	`°πﬁ
 (
vÆue
, 
NULL
, 10) ;

564 i‡(
	`°rcmp
 (
«me
, "ßm∂e-øã"Ë=0 && 
r§c
->
ßm∂e_øã
 == 0)

565 
r§c
->
ßm∂e_øã
 = 
	`°πﬁ
 (
vÆue
, 
NULL
, 10) ;

566 i‡(
	`°rcmp
 (
«me
, "ch™√ls"Ë=0 && 
r§c
->
ch™√ls
 == 0)

567 
r§c
->
ch™√ls
 = 
	`°πﬁ
 (
vÆue
, 
NULL
, 10) ;

570 i‡(
r§c
->
ßm∂e_øã
 < 0)

571 { 
	`psf_log_¥ötf
 (
psf
, "Bad sam∂êøã (%d)\n", 
r§c
->
ßm∂e_øã
) ;

572  
SFE_SD2_BAD_RSRC
 ;

575 i‡(
r§c
->
ch™√ls
 < 0)

576 { 
	`psf_log_¥ötf
 (
psf
, "Bad ch™√»cou¡ (%d)\n", 
r§c
->
ch™√ls
) ;

577  
SFE_SD2_BAD_RSRC
 ;

580 
psf
->
sf
.
ßm∂î©e
 = 
r§c
->
ßm∂e_øã
 ;

581 
psf
->
sf
.
ch™√ls
 = 
r§c
->channels ;

582 
psf
->
byãwidth
 = 
r§c
->
ßm∂e_size
 ;

584 
r§c
->
ßm∂e_size
)

586 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_SD2
 | 
SF_FORMAT_PCM_S8
 ;

590 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_SD2
 | 
SF_FORMAT_PCM_16
 ;

594 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_SD2
 | 
SF_FORMAT_PCM_24
 ;

598 
	`psf_log_¥ötf
 (
psf
, "Bad sam∂êsizê(%d)\n", 
r§c
->
ßm∂e_size
) ;

599  
SFE_SD2_BAD_SAMPLE_SIZE
 ;

602 
	`psf_log_¥ötf
 (
psf
, "ok\n") ;

605 
	}
}

	@libsndfile-1.0.17/src/sds.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<f˙é.h
>

24 
	~<°rög.h
>

25 
	~<˘y≥.h
>

27 
	~"¢dfûe.h
"

28 
	~"s„ndün.h
"

29 
	~"comm⁄.h
"

30 
	~"Êﬂt_ˇ°.h
"

35 
	#SDS_DATA_OFFSET
 0x15

	)

36 
	#SDS_BLOCK_SIZE
 127

	)

38 
	#SDS_AUDIO_BYTES_PER_BLOCK
 120

	)

40 
	#SDS_3BYTE_TO_INT_DECODE
(
x
Ë(((xË& 0x7FË| (((xË& 0x7F00Ë>> 1Ë| (((xË& 0x7F0000Ë>> 2))

	)

41 
	#SDS_INT_TO_3BYTE_ENCODE
(
x
Ë(((xË& 0x7FË| (((xË<< 1Ë& 0x7F00Ë| (((xË<< 2Ë& 0x7F0000))

	)

47 
	sèg_SDS_PRIVATE


48 { 
	mbôwidth
, 
	m‰ames
 ;

49 
	mßm∂e•îblock
, 
	mtŸÆ_blocks
 ;

51 (*
	mªadî
Ë(
SF_PRIVATE
 *
	mpsf
, 
èg_SDS_PRIVATE
 *
	mpsds
) ;

52 (*
	mwrôî
Ë(
SF_PRIVATE
 *
	mpsf
, 
èg_SDS_PRIVATE
 *
	mpsds
) ;

54 
	mªad_block
, 
	mªad_cou¡
 ;

55 
	mªad_d©a
 [
SDS_BLOCK_SIZE
] ;

56 
	mªad_ßm∂es
 [
SDS_BLOCK_SIZE
 / 2] ;

58 
	mwrôe_block
, 
	mwrôe_cou¡
 ;

59 
	mwrôe_d©a
 [
SDS_BLOCK_SIZE
] ;

60 
	mwrôe_ßm∂es
 [
SDS_BLOCK_SIZE
 / 2] ;

61 } 
	tSDS_PRIVATE
 ;

67 
sds_˛o£
 (
SF_PRIVATE
 *
psf
) ;

69 
sds_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
) ;

70 
sds_ªad_hódî
 (
SF_PRIVATE
 *
psf
, 
SDS_PRIVATE
 *
psds
) ;

72 
sds_öô
 (
SF_PRIVATE
 *
psf
, 
SDS_PRIVATE
 *
psds
) ;

74 
sf_cou¡_t
 
sds_ªad_s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

75 
sf_cou¡_t
 
sds_ªad_i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

76 
sf_cou¡_t
 
sds_ªad_f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

77 
sf_cou¡_t
 
sds_ªad_d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

79 
sf_cou¡_t
 
sds_wrôe_s
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

80 
sf_cou¡_t
 
sds_wrôe_i
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

81 
sf_cou¡_t
 
sds_wrôe_f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

82 
sf_cou¡_t
 
sds_wrôe_d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

84 
sf_cou¡_t
 
sds_£ek
 (
SF_PRIVATE
 *
psf
, 
mode
, sf_cou¡_à
off£t
) ;

86 
sds_2byã_ªad
 (
SF_PRIVATE
 *
psf
, 
SDS_PRIVATE
 *
psds
) ;

87 
sds_3byã_ªad
 (
SF_PRIVATE
 *
psf
, 
SDS_PRIVATE
 *
psds
) ;

88 
sds_4byã_ªad
 (
SF_PRIVATE
 *
psf
, 
SDS_PRIVATE
 *
psds
) ;

90 
sds_ªad
 (
SF_PRIVATE
 *
psf
, 
SDS_PRIVATE
 *
psds
, *
ùå
, 
ªadcou¡
) ;

92 
sds_2byã_wrôe
 (
SF_PRIVATE
 *
psf
, 
SDS_PRIVATE
 *
psds
) ;

93 
sds_3byã_wrôe
 (
SF_PRIVATE
 *
psf
, 
SDS_PRIVATE
 *
psds
) ;

94 
sds_4byã_wrôe
 (
SF_PRIVATE
 *
psf
, 
SDS_PRIVATE
 *
psds
) ;

96 
sds_wrôe
 (
SF_PRIVATE
 *
psf
, 
SDS_PRIVATE
 *
psds
, c⁄° *
ùå
, 
wrôecou¡
) ;

103 
	$sds_›í
 (
SF_PRIVATE
 *
psf
)

104 { 
SDS_PRIVATE
 *
psds
 ;

105 
îr‹
 = 0 ;

108 
psf
->
sf
.
‰ames
 = 0 ;

110 i‡(! (
psds
 = 
	`ˇŒoc
 (1,  (
SDS_PRIVATE
))))

111  
SFE_MALLOC_FAILED
 ;

112 
psf
->
codec_d©a
 = 
psds
 ;

114 i‡(
psf
->
mode
 =
SFM_READ
 || (psf->modê=
SFM_RDWR
 &&Ösf->
fûñígth
 > 0))

115 { i‡((
îr‹
 = 
	`sds_ªad_hódî
 (
psf
, 
psds
)))

116  
îr‹
 ;

119 i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_SDS
)

120  
SFE_BAD_OPEN_FORMAT
 ;

122 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

123 { i‡(
	`sds_wrôe_hódî
 (
psf
, 
SF_FALSE
))

124  
psf
->
îr‹
 ;

126 
psf
->
wrôe_hódî
 = 
sds_wrôe_hódî
 ;

128 
	`psf_f£ek
 (
psf
, 
SDS_DATA_OFFSET
, 
SEEK_SET
) ;

131 i‡((
îr‹
 = 
	`sds_öô
 (
psf
, 
psds
)) != 0)

132  
îr‹
 ;

134 
psf
->
£ek
 = 
sds_£ek
 ;

135 
psf
->
c⁄èöî_˛o£
 = 
sds_˛o£
 ;

137 
psf
->
blockwidth
 = 0 ;

139  
îr‹
 ;

140 
	}
}

146 
	$sds_˛o£
 (
SF_PRIVATE
 *
psf
)

148 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

149 { 
SDS_PRIVATE
 *
psds
 ;

151 i‡((
psds
 = (
SDS_PRIVATE
 *Ë
psf
->
codec_d©a
Ë=
NULL
)

152 { 
	`psf_log_¥ötf
 (
psf
, "*** BadÖsf->codec_dataÖtr.\n") ;

153  
SFE_INTERNAL
 ;

156 i‡(
psds
->
wrôe_cou¡
 > 0)

157 { 
	`mem£t
 (&(
psds
->
wrôe_d©a
 [psds->
wrôe_cou¡
]), 0, (psds->
ßm∂e•îblock
 -Ösds->write_count) *  ()) ;

158 
psds
->
	`wrôî
 (
psf
,Ösds) ;

161 
	`sds_wrôe_hódî
 (
psf
, 
SF_TRUE
) ;

165 
	}
}

168 
	$sds_öô
 (
SF_PRIVATE
 *
psf
, 
SDS_PRIVATE
 *
psds
)

170 i‡(
psds
->
bôwidth
 < 8 ||Ösds->bitwidth > 28)

171  (
psf
->
îr‹
 = 
SFE_SDS_BAD_BIT_WIDTH
) ;

173 i‡(
psds
->
bôwidth
 < 14)

174 { 
psds
->
ªadî
 = 
sds_2byã_ªad
 ;

175 
psds
->
wrôî
 = 
sds_2byã_wrôe
 ;

176 
psds
->
ßm∂e•îblock
 = 
SDS_AUDIO_BYTES_PER_BLOCK
 / 2 ;

178 i‡(
psds
->
bôwidth
 < 21)

179 { 
psds
->
ªadî
 = 
sds_3byã_ªad
 ;

180 
psds
->
wrôî
 = 
sds_3byã_wrôe
 ;

181 
psds
->
ßm∂e•îblock
 = 
SDS_AUDIO_BYTES_PER_BLOCK
 / 3 ;

184 { 
psds
->
ªadî
 = 
sds_4byã_ªad
 ;

185 
psds
->
wrôî
 = 
sds_4byã_wrôe
 ;

186 
psds
->
ßm∂e•îblock
 = 
SDS_AUDIO_BYTES_PER_BLOCK
 / 4 ;

189 i‡(
psf
->
mode
 =
SFM_READ
 ||Ösf->modê=
SFM_RDWR
)

190 { 
psf
->
ªad_sh‹t
 = 
sds_ªad_s
 ;

191 
psf
->
ªad_öt
 = 
sds_ªad_i
 ;

192 
psf
->
ªad_Êﬂt
 = 
sds_ªad_f
 ;

193 
psf
->
ªad_doubÀ
 = 
sds_ªad_d
 ;

196 
psds
->
	`ªadî
 (
psf
,Ösds) ;

199 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

200 { 
psf
->
wrôe_sh‹t
 = 
sds_wrôe_s
 ;

201 
psf
->
wrôe_öt
 = 
sds_wrôe_i
 ;

202 
psf
->
wrôe_Êﬂt
 = 
sds_wrôe_f
 ;

203 
psf
->
wrôe_doubÀ
 = 
sds_wrôe_d
 ;

207 
	}
}

210 
	$sds_ªad_hódî
 (
SF_PRIVATE
 *
psf
, 
SDS_PRIVATE
 *
psds
)

211 { 
ch™√l
, 
bôwidth
, 
lo›_ty≥
, 
byã
 ;

212 
ßm∂e_no
, 
m¨kî
 ;

213 
ßmp_≥riod
, 
d©a_Àngth
, 
su°aö_lo›_°¨t
, 
su°aö_lo›_íd
 ;

214 
byã§ód
, 
blockcou¡
 ;

217 
byã§ód
 = 
	`psf_böhódî_ªadf
 (
psf
, "pE211", 0, &
m¨kî
, &
ch™√l
, &
byã
) ;

219 i‡(
m¨kî
 !0xF07E || 
byã
 != 0x01)

220  
SFE_SDS_NOT_SDS
 ;

222 
	`psf_log_¥ötf
 (
psf
, "MidòSam∂êDum∞Sènd¨d (.sds)\nF07E\¿MidòCh™√» : %d\n", 
ch™√l
) ;

224 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "e213", &
ßm∂e_no
, &
bôwidth
, &
ßmp_≥riod
) ;

226 
ßm∂e_no
 = 
	`SDS_3BYTE_TO_INT_DECODE
 (sample_no) ;

227 
ßmp_≥riod
 = 
	`SDS_3BYTE_TO_INT_DECODE
 (samp_period) ;

229 
psds
->
bôwidth
 = bitwidth ;

231 
psf
->
sf
.
ßm∂î©e
 = 1000000000 / 
ßmp_≥riod
 ;

233 
	`psf_log_¥ötf
 (
psf
, " Sample Number : %d\n"

236 
ßm∂e_no
, 
psds
->
bôwidth
, 
psf
->
sf
.
ßm∂î©e
) ;

238 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "e3331", &
d©a_Àngth
, &
su°aö_lo›_°¨t
, &
su°aö_lo›_íd
, &
lo›_ty≥
) ;

240 
d©a_Àngth
 = 
	`SDS_3BYTE_TO_INT_DECODE
 (data_length) ;

242 
su°aö_lo›_°¨t
 = 
	`SDS_3BYTE_TO_INT_DECODE
 (sustain_loop_start) ;

243 
su°aö_lo›_íd
 = 
	`SDS_3BYTE_TO_INT_DECODE
 (sustain_loop_end) ;

245 
	`psf_log_¥ötf
 (
psf
, " Sustain Loop\n"

249 
su°aö_lo›_°¨t
, 
su°aö_lo›_íd
, 
lo›_ty≥
) ;

251 
psf
->
d©aoff£t
 = 
SDS_DATA_OFFSET
 ;

252 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

254 i‡(
d©a_Àngth
 !
psf
->
fûñígth
 -Ösf->
d©aoff£t
)

255 { 
	`psf_log_¥ötf
 (
psf
, " D©Æígth : %d (åunˇãd d©a??? %d)\n", 
d©a_Àngth
,Ösf->
fûñígth
 -Ösf->
d©aoff£t
) ;

256 
d©a_Àngth
 = 
psf
->
fûñígth
 -Ösf->
d©aoff£t
 ;

259 
	`psf_log_¥ötf
 (
psf
, " D©Æígth : %d\n", 
d©a_Àngth
) ;

261 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "1", &
byã
) ;

262 i‡(
byã
 != 0xF7)

263 
	`psf_log_¥ötf
 (
psf
, "badÉnd : %X\n", 
byã
 & 0xFF) ;

265 
blockcou¡
 = 0 ; 
byã§ód
 < 
psf
->
fûñígth
 ; blockcount++)

267 
byã§ód
 +
	`psf_‰ód
 (&
m¨kî
, 1, 2, 
psf
) ;

269 i‡(
m¨kî
 == 0)

272 
	`psf_f£ek
 (
psf
, 
SDS_BLOCK_SIZE
 - 2, 
SEEK_CUR
) ;

273 
byã§ód
 +
SDS_BLOCK_SIZE
 - 2 ;

276 
	`psf_log_¥ötf
 (
psf
, "\nBlock† : %d\n", 
blockcou¡
) ;

277 
psds
->
tŸÆ_blocks
 = 
blockcou¡
 ;

279 
psds
->
ßm∂e•îblock
 = 
SDS_AUDIO_BYTES_PER_BLOCK
 / (’sds->
bôwidth
 + 6) / 7) ;

280 
	`psf_log_¥ötf
 (
psf
, "Sam∂es/Block : %d\n", 
psds
->
ßm∂e•îblock
) ;

282 
	`psf_log_¥ötf
 (
psf
, "Føme† : %d\n", 
blockcou¡
 * 
psds
->
ßm∂e•îblock
) ;

284 
psf
->
sf
.
‰ames
 = 
blockcou¡
 * 
psds
->
ßm∂e•îblock
 ;

285 
psds
->
‰ames
 = 
blockcou¡
 *Ösds->
ßm∂e•îblock
 ;

288 
psf
->
sf
.
ch™√ls
 = 1 ;

289 
psf
->
sf
.
£˘i⁄s
 = 1 ;

295 (
psds
->
bôwidth
 + 7) / 8)

297 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_SDS
 | 
SF_FORMAT_PCM_S8
 ;

301 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_SDS
 | 
SF_FORMAT_PCM_16
 ;

305 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_SDS
 | 
SF_FORMAT_PCM_24
 ;

309 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_SDS
 | 
SF_FORMAT_PCM_32
 ;

313 
	`psf_log_¥ötf
 (
psf
, "*** Weúd byã width (%d)\n", (
psds
->
bôwidth
 + 7) / 8) ;

314  
SFE_SDS_BAD_BIT_WIDTH
 ;

317 
	`psf_f£ek
 (
psf
, 
SDS_DATA_OFFSET
, 
SEEK_SET
) ;

320 
	}
}

323 
	$sds_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
)

324 { 
SDS_PRIVATE
 *
psds
 ;

325 
sf_cou¡_t
 
cuºít
 ;

326 
ßmp_≥riod
, 
d©a_Àngth
, 
su°aö_lo›_°¨t
, 
su°aö_lo›_íd
 ;

327 
lo›_ty≥
 = 0 ;

329 i‡((
psds
 = (
SDS_PRIVATE
 *Ë
psf
->
codec_d©a
Ë=
NULL
)

330 { 
	`psf_log_¥ötf
 (
psf
, "*** BadÖsf->codec_dataÖtr.\n") ;

331  
SFE_INTERNAL
 ;

334 i‡(
psf
->
pùeoff£t
 > 0)

337 
cuºít
 = 
	`psf_·ñl
 (
psf
) ;

339 i‡(
ˇlc_Àngth
)

340 
psf
->
sf
.
‰ames
 = 
psds
->
tŸÆ_blocks
 *Ösds->
ßm∂e•îblock
 +Ösds->
wrôe_cou¡
 ;

342 i‡(
psds
->
wrôe_cou¡
 > 0)

343 { 
cuºít_cou¡
 = 
psds
->
wrôe_cou¡
 ;

344 
cuºít_block
 = 
psds
->
wrôe_block
 ;

346 
psds
->
	`wrôî
 (
psf
,Ösds) ;

348 
	`psf_f£ek
 (
psf
, -1 * 
SDS_BLOCK_SIZE
, 
SEEK_CUR
) ;

350 
psds
->
wrôe_cou¡
 = 
cuºít_cou¡
 ;

351 
psds
->
wrôe_block
 = 
cuºít_block
 ;

355 
psf
->
hódî
 [0] = 0 ;

356 
psf
->
hódödex
 = 0 ;

358 i‡(
psf
->
is_pùe
 =
SF_FALSE
)

359 
	`psf_f£ek
 (
psf
, 0, 
SEEK_SET
) ;

361 
	`psf_böhódî_wrôef
 (
psf
, "E211", 0xF07E, 0, 1) ;

363 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
)

364 { 
SF_FORMAT_PCM_S8
 :

365 
psds
->
bôwidth
 = 8 ;

367 
SF_FORMAT_PCM_16
 :

368 
psds
->
bôwidth
 = 16 ;

370 
SF_FORMAT_PCM_24
 :

371 
psds
->
bôwidth
 = 24 ;

374  
SFE_SDS_BAD_BIT_WIDTH
 ;

377 
ßmp_≥riod
 = 
	`SDS_INT_TO_3BYTE_ENCODE
 (1000000000 / 
psf
->
sf
.
ßm∂î©e
) ;

379 
	`psf_böhódî_wrôef
 (
psf
, "e213", 0, 
psds
->
bôwidth
, 
ßmp_≥riod
) ;

381 
d©a_Àngth
 = 
	`SDS_INT_TO_3BYTE_ENCODE
 (
psds
->
tŸÆ_blocks
 * 
SDS_BLOCK_SIZE
) ;

382 
su°aö_lo›_°¨t
 = 
	`SDS_INT_TO_3BYTE_ENCODE
 (0) ;

383 
su°aö_lo›_íd
 = 
	`SDS_INT_TO_3BYTE_ENCODE
 (
psf
->
sf
.
‰ames
) ;

385 
	`psf_böhódî_wrôef
 (
psf
, "e33311", 
d©a_Àngth
, 
su°aö_lo›_°¨t
, 
su°aö_lo›_íd
, 
lo›_ty≥
, 0xF7) ;

388 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

390 i‡(
psf
->
îr‹
)

391  
psf
->
îr‹
 ;

393 
psf
->
d©aoff£t
 =Ösf->
hódödex
 ;

394 
psf
->
d©Æígth
 = 
psds
->
wrôe_block
 * 
SDS_BLOCK_SIZE
 ;

396 i‡(
cuºít
 > 0)

397 
	`psf_f£ek
 (
psf
, 
cuºít
, 
SEEK_SET
) ;

399  
psf
->
îr‹
 ;

400 
	}
}

407 
	$sds_2byã_ªad
 (
SF_PRIVATE
 *
psf
, 
SDS_PRIVATE
 *
psds
)

408 { *
u˝å
, 
checksum
 ;

409 
ßm∂e
 ;

410 
k
 ;

412 
psds
->
ªad_block
 ++ ;

413 
psds
->
ªad_cou¡
 = 0 ;

415 i‡(
psds
->
ªad_block
 *Ösds->
ßm∂e•îblock
 >Ösds->
‰ames
)

416 { 
	`mem£t
 (
psds
->
ªad_ßm∂es
, 0,Ösds->
ßm∂e•îblock
 *  ()) ;

420 i‡((
k
 = 
	`psf_‰ód
 (
psds
->
ªad_d©a
, 1, 
SDS_BLOCK_SIZE
, 
psf
)) != SDS_BLOCK_SIZE)

421 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög : sh‹àªad (%d !%d).\n", 
k
, 
SDS_BLOCK_SIZE
) ;

423 i‡(
psds
->
ªad_d©a
 [0] != 0xF0)

424 { 
	`¥ötf
 ("Eº‹ A : %02X\n", 
psds
->
ªad_d©a
 [0] & 0xFF) ;

427 
checksum
 = 
psds
->
ªad_d©a
 [1] ;

428 i‡(
checksum
 != 0x7E)

429 { 
	`¥ötf
 ("Eº‹ 1 : %02X\n", 
checksum
 & 0xFF) ;

432 
k
 = 2 ; k < 
SDS_BLOCK_SIZE
 - 3 ; k ++)

433 
checksum
 ^
psds
->
ªad_d©a
 [
k
] ;

435 
checksum
 &= 0x7F ;

437 i‡(
checksum
 !
psds
->
ªad_d©a
 [
SDS_BLOCK_SIZE
 - 2])

438 { 
	`psf_log_¥ötf
 (
psf
, "Block %d : checksum i†%02X should bê%02X\n", 
psds
->
ªad_d©a
 [4], 
checksum
,Ösds->ªad_d©®[
SDS_BLOCK_SIZE
 - 2]) ;

441 
u˝å
 = 
psds
->
ªad_d©a
 + 5 ;

442 
k
 = 0 ; k < 120 ; k += 2)

443 { 
ßm∂e
 = (
u˝å
 [
k
] << 25) + (ucptr [k + 1] << 18) ;

444 
psds
->
ªad_ßm∂es
 [
k
 / 2] = (Ë(
ßm∂e
 - 0x80000000) ;

448 
	}
}

451 
	$sds_3byã_ªad
 (
SF_PRIVATE
 *
psf
, 
SDS_PRIVATE
 *
psds
)

452 { *
u˝å
, 
checksum
 ;

453 
ßm∂e
 ;

454 
k
 ;

456 
psds
->
ªad_block
 ++ ;

457 
psds
->
ªad_cou¡
 = 0 ;

459 i‡(
psds
->
ªad_block
 *Ösds->
ßm∂e•îblock
 >Ösds->
‰ames
)

460 { 
	`mem£t
 (
psds
->
ªad_ßm∂es
, 0,Ösds->
ßm∂e•îblock
 *  ()) ;

464 i‡((
k
 = 
	`psf_‰ód
 (
psds
->
ªad_d©a
, 1, 
SDS_BLOCK_SIZE
, 
psf
)) != SDS_BLOCK_SIZE)

465 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög : sh‹àªad (%d !%d).\n", 
k
, 
SDS_BLOCK_SIZE
) ;

467 i‡(
psds
->
ªad_d©a
 [0] != 0xF0)

468 { 
	`¥ötf
 ("Eº‹ A : %02X\n", 
psds
->
ªad_d©a
 [0] & 0xFF) ;

471 
checksum
 = 
psds
->
ªad_d©a
 [1] ;

472 i‡(
checksum
 != 0x7E)

473 { 
	`¥ötf
 ("Eº‹ 1 : %02X\n", 
checksum
 & 0xFF) ;

476 
k
 = 2 ; k < 
SDS_BLOCK_SIZE
 - 3 ; k ++)

477 
checksum
 ^
psds
->
ªad_d©a
 [
k
] ;

479 
checksum
 &= 0x7F ;

481 i‡(
checksum
 !
psds
->
ªad_d©a
 [
SDS_BLOCK_SIZE
 - 2])

482 { 
	`psf_log_¥ötf
 (
psf
, "Block %d : checksum i†%02X should bê%02X\n", 
psds
->
ªad_d©a
 [4], 
checksum
,Ösds->ªad_d©®[
SDS_BLOCK_SIZE
 - 2]) ;

485 
u˝å
 = 
psds
->
ªad_d©a
 + 5 ;

486 
k
 = 0 ; k < 120 ; k += 3)

487 { 
ßm∂e
 = (
u˝å
 [
k
] << 25) + (ucptr [k + 1] << 18) + (ucptr [k + 2] << 11) ;

488 
psds
->
ªad_ßm∂es
 [
k
 / 3] = (Ë(
ßm∂e
 - 0x80000000) ;

492 
	}
}

495 
	$sds_4byã_ªad
 (
SF_PRIVATE
 *
psf
, 
SDS_PRIVATE
 *
psds
)

496 { *
u˝å
, 
checksum
 ;

497 
ßm∂e
 ;

498 
k
 ;

500 
psds
->
ªad_block
 ++ ;

501 
psds
->
ªad_cou¡
 = 0 ;

503 i‡(
psds
->
ªad_block
 *Ösds->
ßm∂e•îblock
 >Ösds->
‰ames
)

504 { 
	`mem£t
 (
psds
->
ªad_ßm∂es
, 0,Ösds->
ßm∂e•îblock
 *  ()) ;

508 i‡((
k
 = 
	`psf_‰ód
 (
psds
->
ªad_d©a
, 1, 
SDS_BLOCK_SIZE
, 
psf
)) != SDS_BLOCK_SIZE)

509 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög : sh‹àªad (%d !%d).\n", 
k
, 
SDS_BLOCK_SIZE
) ;

511 i‡(
psds
->
ªad_d©a
 [0] != 0xF0)

512 { 
	`¥ötf
 ("Eº‹ A : %02X\n", 
psds
->
ªad_d©a
 [0] & 0xFF) ;

515 
checksum
 = 
psds
->
ªad_d©a
 [1] ;

516 i‡(
checksum
 != 0x7E)

517 { 
	`¥ötf
 ("Eº‹ 1 : %02X\n", 
checksum
 & 0xFF) ;

520 
k
 = 2 ; k < 
SDS_BLOCK_SIZE
 - 3 ; k ++)

521 
checksum
 ^
psds
->
ªad_d©a
 [
k
] ;

523 
checksum
 &= 0x7F ;

525 i‡(
checksum
 !
psds
->
ªad_d©a
 [
SDS_BLOCK_SIZE
 - 2])

526 { 
	`psf_log_¥ötf
 (
psf
, "Block %d : checksum i†%02X should bê%02X\n", 
psds
->
ªad_d©a
 [4], 
checksum
,Ösds->ªad_d©®[
SDS_BLOCK_SIZE
 - 2]) ;

529 
u˝å
 = 
psds
->
ªad_d©a
 + 5 ;

530 
k
 = 0 ; k < 120 ; k += 4)

531 { 
ßm∂e
 = (
u˝å
 [
k
] << 25) + (ucptr [k + 1] << 18) + (ucptr [k + 2] << 11) + (ucptr [k + 3] << 4) ;

532 
psds
->
ªad_ßm∂es
 [
k
 / 4] = (Ë(
ßm∂e
 - 0x80000000) ;

536 
	}
}

539 
sf_cou¡_t


540 
	$sds_ªad_s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

541 { 
SDS_PRIVATE
 *
psds
 ;

542 *
ùå
 ;

543 
k
, 
buf„æí
, 
ªadcou¡
, 
cou¡
 ;

544 
sf_cou¡_t
 
tŸÆ
 = 0 ;

546 i‡(
psf
->
codec_d©a
 =
NULL
)

548 
psds
 = (
SDS_PRIVATE
*Ë
psf
->
codec_d©a
 ;

550 
ùå
 = 
psf
->
u
.
ibuf
 ;

551 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

552 
Àn
 > 0)

553 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

554 
cou¡
 = 
	`sds_ªad
 (
psf
, 
psds
, 
ùå
, 
ªadcou¡
) ;

555 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

556 
±r
 [
tŸÆ
 + 
k
] = 
ùå
 [k] >> 16 ;

557 
tŸÆ
 +
cou¡
 ;

558 
Àn
 -
ªadcou¡
 ;

561  
tŸÆ
 ;

562 
	}
}

564 
sf_cou¡_t


565 
	$sds_ªad_i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

566 { 
SDS_PRIVATE
 *
psds
 ;

567 
tŸÆ
 ;

569 i‡(
psf
->
codec_d©a
 =
NULL
)

571 
psds
 = (
SDS_PRIVATE
*Ë
psf
->
codec_d©a
 ;

573 
tŸÆ
 = 
	`sds_ªad
 (
psf
, 
psds
, 
±r
, 
Àn
) ;

575  
tŸÆ
 ;

576 
	}
}

578 
sf_cou¡_t


579 
	$sds_ªad_f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

580 { 
SDS_PRIVATE
 *
psds
 ;

581 *
ùå
 ;

582 
k
, 
buf„æí
, 
ªadcou¡
, 
cou¡
 ;

583 
sf_cou¡_t
 
tŸÆ
 = 0 ;

584 
n‹mÁ˘
 ;

586 i‡(
psf
->
codec_d©a
 =
NULL
)

588 
psds
 = (
SDS_PRIVATE
*Ë
psf
->
codec_d©a
 ;

590 i‡(
psf
->
n‹m_Êﬂt
 =
SF_TRUE
)

591 
n‹mÁ˘
 = 1.0 / 0x80000000 ;

593 
n‹mÁ˘
 = 1.0 / (1 << 
psds
->
bôwidth
) ;

595 
ùå
 = 
psf
->
u
.
ibuf
 ;

596 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

597 
Àn
 > 0)

598 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

599 
cou¡
 = 
	`sds_ªad
 (
psf
, 
psds
, 
ùå
, 
ªadcou¡
) ;

600 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

601 
±r
 [
tŸÆ
 + 
k
] = 
n‹mÁ˘
 * 
ùå
 [k] ;

602 
tŸÆ
 +
cou¡
 ;

603 
Àn
 -
ªadcou¡
 ;

606  
tŸÆ
 ;

607 
	}
}

609 
sf_cou¡_t


610 
	$sds_ªad_d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

611 { 
SDS_PRIVATE
 *
psds
 ;

612 *
ùå
 ;

613 
k
, 
buf„æí
, 
ªadcou¡
, 
cou¡
 ;

614 
sf_cou¡_t
 
tŸÆ
 = 0 ;

615 
n‹mÁ˘
 ;

617 i‡(
psf
->
codec_d©a
 =
NULL
)

619 
psds
 = (
SDS_PRIVATE
*Ë
psf
->
codec_d©a
 ;

621 i‡(
psf
->
n‹m_doubÀ
 =
SF_TRUE
)

622 
n‹mÁ˘
 = 1.0 / 0x80000000 ;

624 
n‹mÁ˘
 = 1.0 / (1 << 
psds
->
bôwidth
) ;

626 
ùå
 = 
psf
->
u
.
ibuf
 ;

627 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

628 
Àn
 > 0)

629 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

630 
cou¡
 = 
	`sds_ªad
 (
psf
, 
psds
, 
ùå
, 
ªadcou¡
) ;

631 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

632 
±r
 [
tŸÆ
 + 
k
] = 
n‹mÁ˘
 * 
ùå
 [k] ;

633 
tŸÆ
 +
cou¡
 ;

634 
Àn
 -
ªadcou¡
 ;

637  
tŸÆ
 ;

638 
	}
}

641 
	$sds_ªad
 (
SF_PRIVATE
 *
psf
, 
SDS_PRIVATE
 *
psds
, *
±r
, 
Àn
)

642 { 
cou¡
, 
tŸÆ
 = 0 ;

644 
tŸÆ
 < 
Àn
)

645 { i‡(
psds
->
ªad_block
 *Ösds->
ßm∂e•îblock
 >psds->
‰ames
)

646 { 
	`mem£t
 (&(
±r
 [
tŸÆ
]), 0, (
Àn
 -Åotal) *  ()) ;

647  
tŸÆ
 ;

650 i‡(
psds
->
ªad_cou¡
 >psds->
ßm∂e•îblock
)

651 
psds
->
	`ªadî
 (
psf
,Ösds) ;

653 
cou¡
 = (
psds
->
ßm∂e•îblock
 -Ösds->
ªad_cou¡
) ;

654 
cou¡
 = (
Àn
 - 
tŸÆ
 > count) ? count :Üen -Åotal ;

656 
	`mem˝y
 (&(
±r
 [
tŸÆ
]), &(
psds
->
ªad_ßm∂es
 [psds->
ªad_cou¡
]), 
cou¡
 *  ()) ;

657 
tŸÆ
 +
cou¡
 ;

658 
psds
->
ªad_cou¡
 +
cou¡
 ;

661  
tŸÆ
 ;

662 
	}
}

667 
sf_cou¡_t


668 
	$sds_£ek
 (
SF_PRIVATE
 *
psf
, 
mode
, 
sf_cou¡_t
 
£ek_‰om_°¨t
)

669 { 
SDS_PRIVATE
 *
psds
 ;

670 
sf_cou¡_t
 
fûe_off£t
 ;

671 
√wblock
, 
√wßm∂e
 ;

673 i‡((
psds
 = 
psf
->
codec_d©a
Ë=
NULL
)

674 { 
psf
->
îr‹
 = 
SFE_INTERNAL
 ;

675  
PSF_SEEK_ERROR
 ;

678 i‡(
psf
->
d©Æígth
 < 0 ||Ösf->
d©aoff£t
 < 0)

679 { 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

680  
PSF_SEEK_ERROR
 ;

683 i‡(
£ek_‰om_°¨t
 < 0 || sìk_‰om_°¨à> 
psf
->
sf
.
‰ames
)

684 { 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

685  
PSF_SEEK_ERROR
 ;

688 i‡(
mode
 =
SFM_READ
 && 
psds
->
wrôe_cou¡
 > 0)

689 
psds
->
	`wrôî
 (
psf
,Ösds) ;

691 
√wblock
 = 
£ek_‰om_°¨t
 / 
psds
->
ßm∂e•îblock
 ;

692 
√wßm∂e
 = 
£ek_‰om_°¨t
 % 
psds
->
ßm∂e•îblock
 ;

694 
mode
)

695 { 
SFM_READ
 :

696 i‡(
√wblock
 > 
psds
->
tŸÆ_blocks
)

697 { 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

698  
PSF_SEEK_ERROR
 ;

701 
fûe_off£t
 = 
psf
->
d©aoff£t
 + 
√wblock
 * 
SDS_BLOCK_SIZE
 ;

703 i‡(
	`psf_f£ek
 (
psf
, 
fûe_off£t
, 
SEEK_SET
) != file_offset)

704 { 
psf
->
îr‹
 = 
SFE_SEEK_FAILED
 ;

705  
PSF_SEEK_ERROR
 ;

708 
psds
->
ªad_block
 = 
√wblock
 ;

709 
psds
->
	`ªadî
 (
psf
,Ösds) ;

710 
psds
->
ªad_cou¡
 = 
√wßm∂e
 ;

713 
SFM_WRITE
 :

714 i‡(
√wblock
 > 
psds
->
tŸÆ_blocks
)

715 { 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

716  
PSF_SEEK_ERROR
 ;

719 
fûe_off£t
 = 
psf
->
d©aoff£t
 + 
√wblock
 * 
SDS_BLOCK_SIZE
 ;

721 i‡(
	`psf_f£ek
 (
psf
, 
fûe_off£t
, 
SEEK_SET
) != file_offset)

722 { 
psf
->
îr‹
 = 
SFE_SEEK_FAILED
 ;

723  
PSF_SEEK_ERROR
 ;

726 
psds
->
wrôe_block
 = 
√wblock
 ;

727 
psds
->
	`ªadî
 (
psf
,Ösds) ;

728 
psds
->
wrôe_cou¡
 = 
√wßm∂e
 ;

732 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

733  
PSF_SEEK_ERROR
 ;

737  
£ek_‰om_°¨t
 ;

738 
	}
}

744 
	$sds_2byã_wrôe
 (
SF_PRIVATE
 *
psf
, 
SDS_PRIVATE
 *
psds
)

745 { *
u˝å
, 
checksum
 ;

746 
ßm∂e
 ;

747 
k
 ;

749 
psds
->
wrôe_d©a
 [0] = 0xF0 ;

750 
psds
->
wrôe_d©a
 [1] = 0x7E ;

751 
psds
->
wrôe_d©a
 [2] = 0 ;

752 
psds
->
wrôe_d©a
 [3] =Ösds->
wrôe_block
 & 0x7F ;

754 
u˝å
 = 
psds
->
wrôe_d©a
 + 5 ;

755 
k
 = 0 ; k < 120 ; k += 2)

756 { 
ßm∂e
 = 
psds
->
wrôe_ßm∂es
 [
k
 / 2] ;

757 
ßm∂e
 += 0x80000000 ;

758 
u˝å
 [
k
] = (
ßm∂e
 >> 25) & 0x7F ;

759 
u˝å
 [
k
 + 1] = (
ßm∂e
 >> 18) & 0x7F ;

762 
checksum
 = 
psds
->
wrôe_d©a
 [1] ;

763 
k
 = 2 ; k < 
SDS_BLOCK_SIZE
 - 3 ; k ++)

764 
checksum
 ^
psds
->
wrôe_d©a
 [
k
] ;

765 
checksum
 &= 0x7F ;

767 
psds
->
wrôe_d©a
 [
SDS_BLOCK_SIZE
 - 2] = 
checksum
 ;

768 
psds
->
wrôe_d©a
 [
SDS_BLOCK_SIZE
 - 1] = 0xF7 ;

770 i‡((
k
 = 
	`psf_fwrôe
 (
psds
->
wrôe_d©a
, 1, 
SDS_BLOCK_SIZE
, 
psf
)) != SDS_BLOCK_SIZE)

771 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög :Ösf_fwrôê(%d !%d).\n", 
k
, 
SDS_BLOCK_SIZE
) ;

773 
psds
->
wrôe_block
 ++ ;

774 
psds
->
wrôe_cou¡
 = 0 ;

776 i‡(
psds
->
wrôe_block
 >Ösds->
tŸÆ_blocks
)

777 
psds
->
tŸÆ_blocks
 =Ösds->
wrôe_block
 ;

778 
psds
->
‰ames
 =Ösds->
tŸÆ_blocks
 *Ösds->
ßm∂e•îblock
 ;

781 
	}
}

784 
	$sds_3byã_wrôe
 (
SF_PRIVATE
 *
psf
, 
SDS_PRIVATE
 *
psds
)

785 { *
u˝å
, 
checksum
 ;

786 
ßm∂e
 ;

787 
k
 ;

789 
psds
->
wrôe_d©a
 [0] = 0xF0 ;

790 
psds
->
wrôe_d©a
 [1] = 0x7E ;

791 
psds
->
wrôe_d©a
 [2] = 0 ;

792 
psds
->
wrôe_d©a
 [3] =Ösds->
wrôe_block
 & 0x7F ;

794 
u˝å
 = 
psds
->
wrôe_d©a
 + 5 ;

795 
k
 = 0 ; k < 120 ; k += 3)

796 { 
ßm∂e
 = 
psds
->
wrôe_ßm∂es
 [
k
 / 3] ;

797 
ßm∂e
 += 0x80000000 ;

798 
u˝å
 [
k
] = (
ßm∂e
 >> 25) & 0x7F ;

799 
u˝å
 [
k
 + 1] = (
ßm∂e
 >> 18) & 0x7F ;

800 
u˝å
 [
k
 + 2] = (
ßm∂e
 >> 11) & 0x7F ;

803 
checksum
 = 
psds
->
wrôe_d©a
 [1] ;

804 
k
 = 2 ; k < 
SDS_BLOCK_SIZE
 - 3 ; k ++)

805 
checksum
 ^
psds
->
wrôe_d©a
 [
k
] ;

806 
checksum
 &= 0x7F ;

808 
psds
->
wrôe_d©a
 [
SDS_BLOCK_SIZE
 - 2] = 
checksum
 ;

809 
psds
->
wrôe_d©a
 [
SDS_BLOCK_SIZE
 - 1] = 0xF7 ;

811 i‡((
k
 = 
	`psf_fwrôe
 (
psds
->
wrôe_d©a
, 1, 
SDS_BLOCK_SIZE
, 
psf
)) != SDS_BLOCK_SIZE)

812 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög :Ösf_fwrôê(%d !%d).\n", 
k
, 
SDS_BLOCK_SIZE
) ;

814 
psds
->
wrôe_block
 ++ ;

815 
psds
->
wrôe_cou¡
 = 0 ;

817 i‡(
psds
->
wrôe_block
 >Ösds->
tŸÆ_blocks
)

818 
psds
->
tŸÆ_blocks
 =Ösds->
wrôe_block
 ;

819 
psds
->
‰ames
 =Ösds->
tŸÆ_blocks
 *Ösds->
ßm∂e•îblock
 ;

822 
	}
}

825 
	$sds_4byã_wrôe
 (
SF_PRIVATE
 *
psf
, 
SDS_PRIVATE
 *
psds
)

826 { *
u˝å
, 
checksum
 ;

827 
ßm∂e
 ;

828 
k
 ;

830 
psds
->
wrôe_d©a
 [0] = 0xF0 ;

831 
psds
->
wrôe_d©a
 [1] = 0x7E ;

832 
psds
->
wrôe_d©a
 [2] = 0 ;

833 
psds
->
wrôe_d©a
 [3] =Ösds->
wrôe_block
 & 0x7F ;

835 
u˝å
 = 
psds
->
wrôe_d©a
 + 5 ;

836 
k
 = 0 ; k < 120 ; k += 4)

837 { 
ßm∂e
 = 
psds
->
wrôe_ßm∂es
 [
k
 / 4] ;

838 
ßm∂e
 += 0x80000000 ;

839 
u˝å
 [
k
] = (
ßm∂e
 >> 25) & 0x7F ;

840 
u˝å
 [
k
 + 1] = (
ßm∂e
 >> 18) & 0x7F ;

841 
u˝å
 [
k
 + 2] = (
ßm∂e
 >> 11) & 0x7F ;

842 
u˝å
 [
k
 + 3] = (
ßm∂e
 >> 4) & 0x7F ;

845 
checksum
 = 
psds
->
wrôe_d©a
 [1] ;

846 
k
 = 2 ; k < 
SDS_BLOCK_SIZE
 - 3 ; k ++)

847 
checksum
 ^
psds
->
wrôe_d©a
 [
k
] ;

848 
checksum
 &= 0x7F ;

850 
psds
->
wrôe_d©a
 [
SDS_BLOCK_SIZE
 - 2] = 
checksum
 ;

851 
psds
->
wrôe_d©a
 [
SDS_BLOCK_SIZE
 - 1] = 0xF7 ;

853 i‡((
k
 = 
	`psf_fwrôe
 (
psds
->
wrôe_d©a
, 1, 
SDS_BLOCK_SIZE
, 
psf
)) != SDS_BLOCK_SIZE)

854 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög :Ösf_fwrôê(%d !%d).\n", 
k
, 
SDS_BLOCK_SIZE
) ;

856 
psds
->
wrôe_block
 ++ ;

857 
psds
->
wrôe_cou¡
 = 0 ;

859 i‡(
psds
->
wrôe_block
 >Ösds->
tŸÆ_blocks
)

860 
psds
->
tŸÆ_blocks
 =Ösds->
wrôe_block
 ;

861 
psds
->
‰ames
 =Ösds->
tŸÆ_blocks
 *Ösds->
ßm∂e•îblock
 ;

864 
	}
}

866 
sf_cou¡_t


867 
	$sds_wrôe_s
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

868 { 
SDS_PRIVATE
 *
psds
 ;

869 *
ùå
 ;

870 
k
, 
buf„æí
, 
wrôecou¡
, 
cou¡
 ;

871 
sf_cou¡_t
 
tŸÆ
 = 0 ;

873 i‡(
psf
->
codec_d©a
 =
NULL
)

875 
psds
 = (
SDS_PRIVATE
*Ë
psf
->
codec_d©a
 ;

877 
ùå
 = 
psf
->
u
.
ibuf
 ;

878 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

879 
Àn
 > 0)

880 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

881 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

882 
ùå
 [
k
] = 
±r
 [
tŸÆ
 + k] << 16 ;

883 
cou¡
 = 
	`sds_wrôe
 (
psf
, 
psds
, 
ùå
, 
wrôecou¡
) ;

884 
tŸÆ
 +
cou¡
 ;

885 
Àn
 -
wrôecou¡
 ;

888  
tŸÆ
 ;

889 
	}
}

891 
sf_cou¡_t


892 
	$sds_wrôe_i
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

893 { 
SDS_PRIVATE
 *
psds
 ;

894 
tŸÆ
 ;

896 i‡(
psf
->
codec_d©a
 =
NULL
)

898 
psds
 = (
SDS_PRIVATE
*Ë
psf
->
codec_d©a
 ;

900 
tŸÆ
 = 
	`sds_wrôe
 (
psf
, 
psds
, 
±r
, 
Àn
) ;

902  
tŸÆ
 ;

903 
	}
}

905 
sf_cou¡_t


906 
	$sds_wrôe_f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

907 { 
SDS_PRIVATE
 *
psds
 ;

908 *
ùå
 ;

909 
k
, 
buf„æí
, 
wrôecou¡
, 
cou¡
 ;

910 
sf_cou¡_t
 
tŸÆ
 = 0 ;

911 
n‹mÁ˘
 ;

913 i‡(
psf
->
codec_d©a
 =
NULL
)

915 
psds
 = (
SDS_PRIVATE
*Ë
psf
->
codec_d©a
 ;

917 i‡(
psf
->
n‹m_Êﬂt
 =
SF_TRUE
)

918 
n‹mÁ˘
 = 1.0 * 0x80000000 ;

920 
n‹mÁ˘
 = 1.0 * (1 << 
psds
->
bôwidth
) ;

922 
ùå
 = 
psf
->
u
.
ibuf
 ;

923 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

924 
Àn
 > 0)

925 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

926 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

927 
ùå
 [
k
] = 
n‹mÁ˘
 * 
±r
 [
tŸÆ
 + k] ;

928 
cou¡
 = 
	`sds_wrôe
 (
psf
, 
psds
, 
ùå
, 
wrôecou¡
) ;

929 
tŸÆ
 +
cou¡
 ;

930 
Àn
 -
wrôecou¡
 ;

933  
tŸÆ
 ;

934 
	}
}

936 
sf_cou¡_t


937 
	$sds_wrôe_d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

938 { 
SDS_PRIVATE
 *
psds
 ;

939 *
ùå
 ;

940 
k
, 
buf„æí
, 
wrôecou¡
, 
cou¡
 ;

941 
sf_cou¡_t
 
tŸÆ
 = 0 ;

942 
n‹mÁ˘
 ;

944 i‡(
psf
->
codec_d©a
 =
NULL
)

946 
psds
 = (
SDS_PRIVATE
*Ë
psf
->
codec_d©a
 ;

948 i‡(
psf
->
n‹m_doubÀ
 =
SF_TRUE
)

949 
n‹mÁ˘
 = 1.0 * 0x80000000 ;

951 
n‹mÁ˘
 = 1.0 * (1 << 
psds
->
bôwidth
) ;

953 
ùå
 = 
psf
->
u
.
ibuf
 ;

954 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ibuf
) ;

955 
Àn
 > 0)

956 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

957 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

958 
ùå
 [
k
] = 
n‹mÁ˘
 * 
±r
 [
tŸÆ
 + k] ;

959 
cou¡
 = 
	`sds_wrôe
 (
psf
, 
psds
, 
ùå
, 
wrôecou¡
) ;

960 
tŸÆ
 +
cou¡
 ;

961 
Àn
 -
wrôecou¡
 ;

964  
tŸÆ
 ;

965 
	}
}

968 
	$sds_wrôe
 (
SF_PRIVATE
 *
psf
, 
SDS_PRIVATE
 *
psds
, c⁄° *
±r
, 
Àn
)

969 { 
cou¡
, 
tŸÆ
 = 0 ;

971 
tŸÆ
 < 
Àn
)

972 { 
cou¡
 = 
psds
->
ßm∂e•îblock
 -Ösds->
wrôe_cou¡
 ;

973 i‡(
cou¡
 > 
Àn
 - 
tŸÆ
)

974 
cou¡
 = 
Àn
 - 
tŸÆ
 ;

976 
	`mem˝y
 (&(
psds
->
wrôe_ßm∂es
 [psds->
wrôe_cou¡
]), &(
±r
 [
tŸÆ
]), 
cou¡
 *  ()) ;

977 
tŸÆ
 +
cou¡
 ;

978 
psds
->
wrôe_cou¡
 +
cou¡
 ;

980 i‡(
psds
->
wrôe_cou¡
 >psds->
ßm∂e•îblock
)

981 
psds
->
	`wrôî
 (
psf
,Ösds) ;

984  
tŸÆ
 ;

985 
	}
}

	@libsndfile-1.0.17/src/sf_unistd.h

21 #i‚de‡
S_IRWXU


22 
	#S_IRWXU
 0000700

	)

25 #i‚def 
S_IRUSR


26 
	#S_IRUSR
 0000400

	)

29 #i‚def 
S_IWUSR


30 
	#S_IWUSR
 0000200

	)

33 #i‚def 
S_IXUSR


34 
	#S_IXUSR
 0000100

	)

37 
	#S_IRWXG
 0000070

	)

38 
	#S_IRGRP
 0000040

	)

39 
	#S_IWGRP
 0000020

	)

40 
	#S_IXGRP
 0000010

	)

42 
	#S_IRWXO
 0000007

	)

43 
	#S_IROTH
 0000004

	)

44 
	#S_IWOTH
 0000002

	)

45 
	#S_IXOTH
 0000001

	)

47 #i‚de‡
S_ISFIFO


48 
	#S_ISFIFO
(
mode
Ë(((modeË& 
_S_IFMT
Ë=
_S_IFIFO
)

	)

51 #i‚de‡
S_ISREG


52 
	#S_ISREG
(
mode
Ë(((modeË& 
_S_IFREG
Ë=_S_IFREG)

	)

	@libsndfile-1.0.17/src/sfconfig.h

32 #i‚de‡
SFCONFIG_H


33 
	#SFCONFIG_H


	)

36 
	~"c⁄fig.h
"

40 #i‚de‡
HAVE_ALSA_ASOUNDLIB_H


41 
	#HAVE_ALSA_ASOUNDLIB_H
 0

	)

44 #i‚de‡
HAVE_BYTESWAP_H


45 
	#HAVE_BYTESWAP_H
 0

	)

48 #i‚de‡
HAVE_DECL_S_IRGRP


49 
	#HAVE_DECL_S_IRGRP
 0

	)

52 #i‚de‡
HAVE_ENDIAN_H


53 
	#HAVE_ENDIAN_H
 0

	)

56 #i‚de‡
HAVE_FSYNC


57 
	#HAVE_FSYNC
 0

	)

60 #i‚de‡
HAVE_LOCALE_H


61 
	#HAVE_LOCALE_H
 0

	)

64 #i‚de‡
HAVE_LRINT


65 
	#HAVE_LRINT
 0

	)

68 #i‚de‡
HAVE_LRINTF


69 
	#HAVE_LRINTF
 0

	)

72 #i‚de‡
HAVE_MMAP


73 
	#HAVE_MMAP
 0

	)

76 #i‚de‡
HAVE_PREAD


77 
	#HAVE_PREAD
 0

	)

80 #i‚de‡
HAVE_PWRITE


81 
	#HAVE_PWRITE
 0

	)

84 #i‚de‡
HAVE_SETLOCALE


85 
	#HAVE_SETLOCALE
 0

	)

88 #i‚de‡
HAVE_SQLITE3


89 
	#HAVE_SQLITE3
 0

	)

92 #i‚de‡
HAVE_STDINT_H


93 
	#HAVE_STDINT_H
 0

	)

96 #i‚de‡
HAVE_UNISTD_H


97 
	#HAVE_UNISTD_H
 0

	)

	@libsndfile-1.0.17/src/sfendian.h

19 
	~"sfc⁄fig.h
"

21 #i‡
HAVE_STDINT_H


22 
	~<°döt.h
>

23 #ñi‡
HAVE_INTTYPES_H


24 
	~<öây≥s.h
>

27 #i‡(
deföed
 (
SIZEOF_INT64_T
) && (SIZEOF_INT64_T == 8))

29 #ñi‡(
deföed
 (
SIZEOF_LONG_LONG
) && (SIZEOF_LONG_LONG == 8))

30 
	töt64_t
 ;

31 #ñi‡(
deföed
 (
SIZEOF_LONG
) && (SIZEOF_LONG == 8))

32 
	töt64_t
 ;

33 #ñi‡(
deföed
 (
WIN32
Ë|| deföed (
_WIN32
))

34 
__öt64
 
	töt64_t
 ;

39 #i‡
HAVE_BYTESWAP_H


41 
	~<byãsw≠.h
>

43 
	#ENDSWAP_SHORT
(
x
Ë((Ë
	`bsw≠_16
 (x))

	)

44 
	#ENDSWAP_INT
(
x
Ë((Ë
	`bsw≠_32
 (x))

	)

48 
	#ENDSWAP_SHORT
(
x
Ë((((xË>> 8Ë& 0xFFË+ (((xË& 0xFFË<< 8))

	)

49 
	#ENDSWAP_INT
(
x
Ë((((xË>> 24Ë& 0xFFË+ (((xË>> 8Ë& 0xFF00Ë+ (((xË& 0xFF00Ë<< 8Ë+ (((xË& 0xFFË<< 24))

	)

60 #i‡(
CPU_IS_LITTLE_ENDIAN
 == 1)

61 
	#MAKE_MARKER
(
a
,
b
,
c
,
d
Ë(◊Ë| ((bË<< 8Ë| ((cË<< 16Ë| ((dË<< 24))

	)

62 #ñi‡(
CPU_IS_BIG_ENDIAN
 == 1)

63 
	#MAKE_MARKER
(
a
,
b
,
c
,
d
Ë((◊Ë<< 24Ë| ((bË<< 16Ë| ((cË<< 8Ë| (d))

	)

75 #i‡(
CPU_IS_LITTLE_ENDIAN
 == 1)

76 
	#LES2H_SHORT
(
x
Ë(x)

	)

77 
	#LEI2H_INT
(
x
Ë(x)

	)

79 
	#BES2H_SHORT
(
x
Ë
	`ENDSWAP_SHORT
 (x)

	)

80 
	#BEI2H_INT
(
x
Ë
	`ENDSWAP_INT
 (x)

	)

82 
	#H2BE_SHORT
(
x
Ë
	`ENDSWAP_SHORT
 (x)

	)

83 
	#H2BE_INT
(
x
Ë
	`ENDSWAP_INT
 (x)

	)

85 #ñi‡(
CPU_IS_BIG_ENDIAN
 == 1)

86 
	#LES2H_SHORT
(
x
Ë
	`ENDSWAP_SHORT
 (x)

	)

87 
	#LEI2H_INT
(
x
Ë
	`ENDSWAP_INT
 (x)

	)

89 
	#BES2H_SHORT
(
x
Ë(x)

	)

90 
	#BEI2H_INT
(
x
Ë(x)

	)

92 
	#H2LE_SHORT
(
x
Ë
	`ENDSWAP_SHORT
 (x)

	)

93 
	#H2LE_INT
(
x
Ë
	`ENDSWAP_INT
 (x)

	)

99 
	#LET2H_SHORT_PTR
(
x
Ë((xË[1] + ((xË[2] << 8))

	)

100 
	#LET2H_INT_PTR
(
x
Ë(((xË[0] << 8Ë+ ((xË[1] << 16Ë+ ((xË[2] << 24))

	)

102 
	#BET2H_SHORT_PTR
(
x
Ë(((xË[0] << 8Ë+ (xË[1])

	)

103 
	#BET2H_INT_PTR
(
x
Ë(((xË[0] << 24Ë+ ((xË[1] << 16Ë+ ((xË[2] << 8))

	)

109 
ölöe
 

110 
	$ídsw≠_sh‹t_¨øy
 (*
±r
, 
Àn
)

111 { 
ãmp
 ;

113 --
Àn
 >= 0)

114 { 
ãmp
 = 
±r
 [
Àn
] ;

115 
±r
 [
Àn
] = 
	`ENDSWAP_SHORT
 (
ãmp
) ;

117 
	}
}

119 
ölöe
 

120 
	$ídsw≠_sh‹t_c›y
 (*
de°
, c⁄° *
§c
, 
Àn
)

122 --
Àn
 >= 0)

123 { 
de°
 [
Àn
] = 
	`ENDSWAP_SHORT
 (
§c
 [len]) ;

125 
	}
}

127 
ölöe
 

128 
	$ídsw≠_öt_¨øy
 (*
±r
, 
Àn
)

129 { 
ãmp
 ;

131 --
Àn
 >= 0)

132 { 
ãmp
 = 
±r
 [
Àn
] ;

133 
±r
 [
Àn
] = 
	`ENDSWAP_INT
 (
ãmp
) ;

135 
	}
}

137 
ölöe
 

138 
	$ídsw≠_öt_c›y
 (*
de°
, c⁄° *
§c
, 
Àn
)

140 --
Àn
 >= 0)

141 { 
de°
 [
Àn
] = 
	`ENDSWAP_INT
 (
§c
 [len]) ;

143 
	}
}

148 #if (
HAVE_BYTESWAP_H
 && 
deföed
 (
SIZEOF_INT64_T
) && (SIZEOF_INT64_T == 8))

150 
ölöe
 

151 
	$ídsw≠_öt64_t_¨øy
 (
öt64_t
 *
±r
, 
Àn
)

152 { 
öt64_t
 
vÆue
 ;

154 --
Àn
 >= 0)

155 { 
vÆue
 = 
±r
 [
Àn
] ;

156 
±r
 [
Àn
] = 
	`bsw≠_64
 (
vÆue
) ;

158 
	}
}

160 
ölöe
 

161 
	$ídsw≠_öt64_t_c›y
 (
öt64_t
 *
de°
, c⁄° i¡64_à*
§c
, 
Àn
)

162 { 
öt64_t
 
vÆue
 ;

164 --
Àn
 >= 0)

165 { 
vÆue
 = 
§c
 [
Àn
] ;

166 
de°
 [
Àn
] = 
	`bsw≠_64
 (
vÆue
) ;

168 
	}
}

172 
ölöe
 

173 
	$ídsw≠_öt64_t_¨øy
 (
öt64_t
 *
±r
, 
Àn
)

174 { *
u˝å
, 
ãmp
 ;

176 
u˝å
 = (*Ë
±r
 ;

177 
u˝å
 +8 * 
Àn
 ;

178 --
Àn
 >= 0)

179 { 
u˝å
 -= 8 ;

181 
ãmp
 = 
u˝å
 [0] ;

182 
u˝å
 [0] = ucptr [7] ;

183 
u˝å
 [7] = 
ãmp
 ;

185 
ãmp
 = 
u˝å
 [1] ;

186 
u˝å
 [1] = ucptr [6] ;

187 
u˝å
 [6] = 
ãmp
 ;

189 
ãmp
 = 
u˝å
 [2] ;

190 
u˝å
 [2] = ucptr [5] ;

191 
u˝å
 [5] = 
ãmp
 ;

193 
ãmp
 = 
u˝å
 [3] ;

194 
u˝å
 [3] = ucptr [4] ;

195 
u˝å
 [4] = 
ãmp
 ;

197 
	}
}

199 
ölöe
 

200 
	$ídsw≠_öt64_t_c›y
 (
öt64_t
 *
de°
, c⁄° i¡64_à*
§c
, 
Àn
)

201 { c⁄° *
p§c
 ;

202 *
pde°
 ;

204 i‡(
de°
 =
§c
)

205 { 
	`ídsw≠_öt64_t_¨øy
 (
de°
, 
Àn
) ;

209 
p§c
 = ((c⁄° *Ë
§c
Ë+ 8 * 
Àn
 ;

210 
pde°
 = ((*Ë
de°
Ë+ 8 * 
Àn
 ;

211 --
Àn
 >= 0)

212 { 
p§c
 -= 8 ;

213 
pde°
 -= 8 ;

215 
pde°
 [0] = 
p§c
 [7] ;

216 
pde°
 [2] = 
p§c
 [5] ;

217 
pde°
 [4] = 
p§c
 [3] ;

218 
pde°
 [6] = 
p§c
 [1] ;

219 
pde°
 [7] = 
p§c
 [0] ;

220 
pde°
 [1] = 
p§c
 [6] ;

221 
pde°
 [3] = 
p§c
 [4] ;

222 
pde°
 [5] = 
p§c
 [2] ;

224 
	}
}

230 
ölöe
 

231 
	$ídsw≠_Êﬂt_¨øy
 (*
±r
, 
Àn
)

232 { 
	`ídsw≠_öt_¨øy
 ((*Ë
±r
, 
Àn
) ;

233 
	}
}

235 
ölöe
 

236 
	$ídsw≠_doubÀ_¨øy
 (*
±r
, 
Àn
)

237 { 
	`ídsw≠_öt64_t_¨øy
 ((*Ë
±r
, 
Àn
) ;

238 
	}
}

240 
ölöe
 

241 
	$ídsw≠_Êﬂt_c›y
 (*
de°
, c⁄° *
§c
, 
Àn
)

242 { 
	`ídsw≠_öt_c›y
 ((*Ë
de°
, (c⁄° *Ë
§c
, 
Àn
) ;

243 
	}
}

245 
ölöe
 

246 
	$ídsw≠_doubÀ_c›y
 (*
de°
, c⁄° *
§c
, 
Àn
)

247 { 
	`ídsw≠_öt64_t_c›y
 ((
öt64_t
 *Ë
de°
, (c⁄° i¡64_à*Ë
§c
, 
Àn
) ;

248 
	}
}

	@libsndfile-1.0.17/src/sndfile.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dlib.h
>

22 
	~<°rög.h
>

23 
	~<˘y≥.h
>

25 
	~"¢dfûe.h
"

26 
	~"s„ndün.h
"

27 
	~"comm⁄.h
"

29 
	#SNDFILE_MAGICK
 0x1234C0DE

	)

32 { 
	mîr‹
 ;

33 c⁄° *
	m°r
 ;

34 } 
	tEº‹Såu˘
 ;

37 
Eº‹Såu˘
 
	gSndfûeEº‹s
 [] =

40 { 
SF_ERR_NO_ERROR
 , "No Error." },

41 { 
SF_ERR_UNRECOGNISED_FORMAT
 , "File opened forÑead. FormatÇotÑecognised." },

42 { 
SF_ERR_SYSTEM
 , "SystemÉrror." },

43 { 
SF_ERR_MALFORMED_FILE
 , "Supported file format but file is malformed." },

44 { 
SF_ERR_UNSUPPORTED_ENCODING
 , "Supported file format but unsupportedÉncoding." },

47 { 
SFE_BAD_FILE
 , "File doesÇotÉxist or isÇotáÑegular file (possiblyáÖipe?)." },

48 { 
SFE_BAD_FILE_READ
 , "FileÉxists butÇo data could beÑead." },

49 { 
SFE_OPEN_FAILED
 , "CouldÇot open file." },

50 { 
SFE_BAD_SNDFILE_PTR
 , "Notá valid SNDFILE*Öointer." },

51 { 
SFE_BAD_SF_INFO_PTR
 , "NULL SF_INFOÖointerÖassedÅoÜibsndfile." },

52 { 
SFE_BAD_SF_INCOMPLETE
 , "SF_PRIVATE struct incompleteándÉnd of headerÖarsing." },

53 { 
SFE_BAD_FILE_PTR
 , "Bad FILEÖointer." },

54 { 
SFE_BAD_INT_PTR
 , "InternalÉrror, BadÖointer." },

55 { 
SFE_BAD_STAT_SIZE
 , "Error : software was misconfiguredát compileÅime (sizeof statbuf.st_size)." },

57 { 
SFE_MALLOC_FAILED
 , "Internal malloc () failed." },

58 { 
SFE_UNIMPLEMENTED
 , "File contains data inán unimplemented format." },

59 { 
SFE_BAD_READ_ALIGN
 , "AttemptÅoÑeadáÇon-integerÇumber of channels." },

60 { 
SFE_BAD_WRITE_ALIGN
 , "AttemptÅo writeáÇon-integerÇumber of channels." },

61 { 
SFE_UNKNOWN_FORMAT
 , "File contains data inán unknown format." },

62 { 
SFE_NOT_READMODE
 , "Readáttempted on file currently open for write." },

63 { 
SFE_NOT_WRITEMODE
 , "Writeáttempted on file currently open forÑead." },

64 { 
SFE_BAD_MODE_RW
 , "This file format doesÇot supportÑead/write mode." },

65 { 
SFE_BAD_SF_INFO
 , "InternalÉrror : SF_INFO struct incomplete." },

66 { 
SFE_BAD_OFFSET
 , "Error : supplied offset beyondÉnd of file." },

67 { 
SFE_NO_EMBED_SUPPORT
 , "Error :ÉmbeddingÇot supported forÅhis file format." },

68 { 
SFE_NO_EMBEDDED_RDWR
 , "Error : cannot openÉmbedded fileÑead/write." },

69 { 
SFE_NO_PIPE_WRITE
 , "Error :Åhis file format doesÇot supportÖipe write." },

70 { 
SFE_BAD_RDWR_FORMAT
 , "AttemptedÅo openÑead only format for RDWR." },

71 { 
SFE_BAD_VIRTUAL_IO
 , "Error : badÖointer on SF_VIRTUAL_IO struct." },

73 { 
SFE_INTERLEAVE_MODE
 , "AttemptÅo writeÅo file withÇon-interleaved data." },

74 { 
SFE_INTERLEAVE_SEEK
 , "Bad karma in seek during interleaveÑead operation." },

75 { 
SFE_INTERLEAVE_READ
 , "Bad karma inÑead during interleaveÑead operation." },

77 { 
SFE_INTERNAL
 , "Unspecified internalÉrror." },

78 { 
SFE_BAD_CONTROL_CMD
 , "Bad commandÖassedÅo function sf_command()." },

79 { 
SFE_BAD_ENDIAN
 , "BadÉndian-ness. Try defaultÉndian-ness" },

80 { 
SFE_CHANNEL_COUNT
 , "Too many channels specified." },

82 { 
SFE_BAD_SEEK
 , "InternalÖsf_fseek() failed." },

83 { 
SFE_NOT_SEEKABLE
 , "Seekáttempted on unseekable fileÅype." },

84 { 
SFE_AMBIGUOUS_SEEK
 , "Error : combination of file open modeánd seek command isámbiguous." },

85 { 
SFE_WRONG_SEEK
 , "Error : invalid seekÖarameters." },

86 { 
SFE_SEEK_FAILED
 , "Error :Öarameters OK, butÖsf_seek() failed." },

88 { 
SFE_BAD_OPEN_MODE
 , "Error : bad modeÖarameter for file open." },

89 { 
SFE_OPEN_PIPE_RDWR
 , "Error :áttemptÅoopenáÖipe inÑead/write mode." },

90 { 
SFE_RDWR_POSITION
 , "Error on RDWRÖosition (cryptic)." },

91 { 
SFE_RDWR_BAD_HEADER
 , "Error : Cannot open file inÑead/write mode dueÅo string data in header." },

93 { 
SFE_STR_NO_SUPPORT
 , "Error : FileÅype doesÇot support string data." },

94 { 
SFE_STR_NOT_WRITE
 , "Error : TryingÅo setá string when file isÇot in write mode." },

95 { 
SFE_STR_MAX_DATA
 , "Error : Maximum string data storageÑeached." },

96 { 
SFE_STR_MAX_COUNT
 , "Error : Maximum string data countÑeached." },

97 { 
SFE_STR_BAD_TYPE
 , "Error : Bad string dataÅype." },

98 { 
SFE_STR_NO_ADD_END
 , "Error : fileÅype doesÇot support stringsáddedátÉnd of file." },

99 { 
SFE_STR_BAD_STRING
 , "Error : bad string." },

100 { 
SFE_STR_WEIRD
 , "Error : Weird stringÉrror." },

102 { 
SFE_WAV_NO_RIFF
 , "Error in WAV file. No 'RIFF' chunk marker." },

103 { 
SFE_WAV_NO_WAVE
 , "Error in WAV file. No 'WAVE' chunk marker." },

104 { 
SFE_WAV_NO_FMT
 , "Error in WAV file. No 'fmt ' chunk marker." },

105 { 
SFE_WAV_FMT_SHORT
 , "Error in WAV file. Short 'fmt ' chunk." },

107 { 
SFE_WAV_BAD_FACT
 , "Error in WAV file. 'fact' chunk out ofÖlace." },

108 { 
SFE_WAV_BAD_PEAK
 , "Error in WAV file. Bad 'PEAK' chunk." },

109 { 
SFE_WAV_PEAK_B4_FMT
 , "Error in WAV file. 'PEAK' chunk found before 'fmt ' chunk." },

111 { 
SFE_WAV_BAD_FORMAT
 , "Error in WAV file. Errors in 'fmt ' chunk." },

112 { 
SFE_WAV_BAD_BLOCKALIGN
 , "Error in WAV file. Blockálignment in 'fmt ' chunk is incorrect." },

113 { 
SFE_WAV_NO_DATA
 , "Error in WAV file. No 'data' chunk marker." },

114 { 
SFE_WAV_BAD_LIST
 , "Error in WAV file. Malformed LIST chunk." },

115 { 
SFE_WAV_UNKNOWN_CHUNK
 , "Error in WAV file. File containsán unknown chunk marker." },

116 { 
SFE_WAV_WVPK_DATA
 , "Error in WAV file. Data is in WAVPACK format." },

118 { 
SFE_WAV_ADPCM_NOT4BIT
 , "Error in ADPCM WAV file. Invalid bit width." },

119 { 
SFE_WAV_ADPCM_CHANNELS
 , "Error in ADPCM WAV file. InvalidÇumber of channels." },

120 { 
SFE_WAV_GSM610_FORMAT
 , "Error in GSM610 WAV file. Invalid format chunk." },

122 { 
SFE_AIFF_NO_FORM
 , "Error in AIFF file, bad 'FORM' marker." },

123 { 
SFE_AIFF_AIFF_NO_FORM
 , "Error in AIFF file, 'AIFF' marker without 'FORM'." },

124 { 
SFE_AIFF_COMM_NO_FORM
 , "Error in AIFF file, 'COMM' marker without 'FORM'." },

125 { 
SFE_AIFF_SSND_NO_COMM
 , "Error in AIFF file, 'SSND' marker without 'COMM'." },

126 { 
SFE_AIFF_UNKNOWN_CHUNK
 , "Error in AIFF file, unknown chunk." },

127 { 
SFE_AIFF_COMM_CHUNK_SIZE
, "Error in AIFF file, bad 'COMM' chunk size." },

128 { 
SFE_AIFF_BAD_COMM_CHUNK
 , "Error in AIFF file, bad 'COMM' chunk." },

129 { 
SFE_AIFF_PEAK_B4_COMM
 , "Error in AIFF file. 'PEAK' chunk found before 'COMM' chunk." },

130 { 
SFE_AIFF_BAD_PEAK
 , "Error in AIFF file. Bad 'PEAK' chunk." },

131 { 
SFE_AIFF_NO_SSND
 , "Error in AIFF file, bad 'SSND' chunk." },

132 { 
SFE_AIFF_NO_DATA
 , "Error in AIFF file,Ço sound data." },

133 { 
SFE_AIFF_RW_SSND_NOT_LAST
, "Error in AIFF file, RDWR onlyÖossible if SSND chunkátÉnd of file." },

135 { 
SFE_AU_UNKNOWN_FORMAT
 , "Error in AU file, unknown format." },

136 { 
SFE_AU_NO_DOTSND
 , "Error in AU file, missing '.snd' or 'dns.' marker." },

137 { 
SFE_AU_EMBED_BAD_LEN
 , "Embedded AU file with unknownÜength." },

139 { 
SFE_RAW_READ_BAD_SPEC
 , "Error while opening RAW file forÑead. Must specify formatánd channels.\n"

142 { 
SFE_RAW_BAD_BITWIDTH
 , "Error. RAW file bitwidth must beá multiple of 8." },

143 { 
SFE_RAW_BAD_FORMAT
 , "Error. Bad format field in SF_INFO struct when openningá RAW file forÑead." },

145 { 
SFE_PAF_NO_MARKER
 , "Error in PAF file,Ço marker." },

146 { 
SFE_PAF_VERSION
 , "Error in PAF file, bad version." },

147 { 
SFE_PAF_UNKNOWN_FORMAT
 , "Error in PAF file, unknown format." },

148 { 
SFE_PAF_SHORT_HEADER
 , "Error in PAF file. File shorterÅhan minimal header." },

150 { 
SFE_SVX_NO_FORM
 , "Error in 8SVX / 16SV file,Ço 'FORM' marker." },

151 { 
SFE_SVX_NO_BODY
 , "Error in 8SVX / 16SV file,Ço 'BODY' marker." },

152 { 
SFE_SVX_NO_DATA
 , "Error in 8SVX / 16SV file,Ço sound data." },

153 { 
SFE_SVX_BAD_COMP
 , "Error in 8SVX / 16SV file, unsupported compression format." },

154 { 
SFE_SVX_BAD_NAME_LENGTH
 , "Error in 8SVX / 16SV file, NAME chunkÅooÜong." },

156 { 
SFE_NIST_BAD_HEADER
 , "Error in NIST file, bad header." },

157 { 
SFE_NIST_CRLF_CONVERISON
, "Error : NIST file damaged by Windows CR -> CRLF conversionÖrocess." },

158 { 
SFE_NIST_BAD_ENCODING
 , "Error in NIST file, unsupported compression format." },

160 { 
SFE_VOC_NO_CREATIVE
 , "Error in VOC file,Ço 'Creative Voice File' marker." },

161 { 
SFE_VOC_BAD_FORMAT
 , "Error in VOC file, bad format." },

162 { 
SFE_VOC_BAD_VERSION
 , "Error in VOC file, bad versionÇumber." },

163 { 
SFE_VOC_BAD_MARKER
 , "Error in VOC file, bad marker in file." },

164 { 
SFE_VOC_BAD_SECTIONS
 , "Error in VOC file, incompatible VOC sections." },

165 { 
SFE_VOC_MULTI_SAMPLERATE
, "Error in VOC file, moreÅhan one sampleÑate defined." },

166 { 
SFE_VOC_MULTI_SECTION
 , "Unimplemented VOC file feature, file contains multiple sound sections." },

167 { 
SFE_VOC_MULTI_PARAM
 , "Error in VOC file, file contains multiple bit or channel widths." },

168 { 
SFE_VOC_SECTION_COUNT
 , "Error in VOC file,Åoo many sections." },

169 { 
SFE_VOC_NO_PIPE
 , "Error :ÇotábleÅo operate on VOC files overáÖipe." },

171 { 
SFE_IRCAM_NO_MARKER
 , "Error in IRCAM file, bad IRCAM marker." },

172 { 
SFE_IRCAM_BAD_CHANNELS
 , "Error in IRCAM file, bad channel count." },

173 { 
SFE_IRCAM_UNKNOWN_FORMAT
, "Error in IRCAM file, unknowÉncoding format." },

175 { 
SFE_W64_64_BIT
 , "Error in W64 file, file contains 64 bit offset." },

177 { 
SFE_W64_NO_RIFF
 , "Error in W64 file. No 'riff' chunk marker." },

178 { 
SFE_W64_NO_WAVE
 , "Error in W64 file. No 'wave' chunk marker." },

179 { 
SFE_W64_NO_FMT
 , "Error in W64 file. No 'fmt ' chunk marker." },

180 { 
SFE_W64_NO_DATA
 , "Error in W64 file. No 'data' chunk marker." },

182 { 
SFE_W64_FMT_SHORT
 , "Error in W64 file. Short 'fmt ' chunk." },

183 { 
SFE_W64_FMT_TOO_BIG
 , "Error in W64 file. 'fmt ' chunkÅooÜarge." },

185 { 
SFE_W64_ADPCM_NOT4BIT
 , "Error in ADPCM W64 file. Invalid bit width." },

186 { 
SFE_W64_ADPCM_CHANNELS
 , "Error in ADPCM W64 file. InvalidÇumber of channels." },

187 { 
SFE_W64_GSM610_FORMAT
 , "Error in GSM610 W64 file. Invalid format chunk." },

189 { 
SFE_MAT4_BAD_NAME
 , "Error in MAT4 file. No variableÇame." },

190 { 
SFE_MAT4_NO_SAMPLERATE
 , "Error in MAT4 file. No sampleÑate." },

191 { 
SFE_MAT4_ZERO_CHANNELS
 , "Error in MAT4 file. Channel count is zero." },

193 { 
SFE_MAT5_BAD_ENDIAN
 , "Error in MAT5 file. NotábleÅo determineÉndian-ness." },

194 { 
SFE_MAT5_NO_BLOCK
 , "Error in MAT5 file. Bad block structure." },

195 { 
SFE_MAT5_SAMPLE_RATE
 , "Error in MAT5 file. NotábleÅo determine sampleÑate." },

196 { 
SFE_MAT5_ZERO_CHANNELS
 , "Error in MAT5 file. Channel count is zero." },

198 { 
SFE_PVF_NO_PVF1
 , "Error in PVF file. No PVF1 marker." },

199 { 
SFE_PVF_BAD_HEADER
 , "Error in PVF file. Bad header." },

200 { 
SFE_PVF_BAD_BITWIDTH
 , "Error in PVF file. Bad bit width." },

202 { 
SFE_XI_BAD_HEADER
 , "Error in XI file. Bad header." },

203 { 
SFE_XI_EXCESS_SAMPLES
 , "Error in XI file. Excess samples in file." },

204 { 
SFE_XI_NO_PIPE
 , "Error :ÇotábleÅo operate on XI files overáÖipe." },

206 { 
SFE_HTK_NO_PIPE
 , "Error :ÇotábleÅo operate on HTK files overáÖipe." },

208 { 
SFE_SDS_NOT_SDS
 , "Error :Çotán SDS file." },

209 { 
SFE_SDS_BAD_BIT_WIDTH
 , "Error : bad bit width for SDS file." },

211 { 
SFE_SD2_FD_DISALLOWED
 , "Error : cannot open SD2 file withoutá fileÇame." },

212 { 
SFE_SD2_BAD_DATA_OFFSET
 , "Error : bad data offset." },

213 { 
SFE_SD2_BAD_MAP_OFFSET
 , "Error : bad map offset." },

214 { 
SFE_SD2_BAD_DATA_LENGTH
 , "Error : bad dataÜength." },

215 { 
SFE_SD2_BAD_MAP_LENGTH
 , "Error : bad mapÜength." },

216 { 
SFE_SD2_BAD_RSRC
 , "Error : badÑesource fork." },

217 { 
SFE_SD2_BAD_SAMPLE_SIZE
 , "Error : bad sample size." },

219 { 
SFE_FLAC_BAD_HEADER
 , "Error : bad flac header." },

220 { 
SFE_FLAC_NEW_DECODER
 , "Error :Öroblem while creating flac decoder." },

221 { 
SFE_FLAC_INIT_DECODER
 , "Error :Öroblem while initialization ofÅhe flac decoder." },

222 { 
SFE_FLAC_LOST_SYNC
 , "Error : flac decoderÜost sync." },

223 { 
SFE_FLAC_BAD_SAMPLE_RATE
, "Error : flac doesÇot supportÅhis sampleÑate." },

224 { 
SFE_FLAC_UNKOWN_ERROR
 , "Error : unkownÉrror in flac decoder." },

226 { 
SFE_DWVW_BAD_BITWIDTH
 , "Error : Bad bit width for DWVWÉncoding. Must be 12, 16 or 24." },

227 { 
SFE_G72X_NOT_MONO
 , "Error : G72xÉncoding doesÇot support moreÅhan 1 channel." },

229 { 
SFE_MAX_ERROR
 , "MaximumÉrrorÇumber." },

230 { 
SFE_MAX_ERROR
 + 1 , 
NULL
 }

236 
f‹m©_‰om_exãnsi⁄
 (
SF_PRIVATE
 *
psf
) ;

237 
guess_fûe_ty≥
 (
SF_PRIVATE
 *
psf
) ;

238 
vÆid©e_sföfo
 (
SF_INFO
 *
sföfo
) ;

239 
vÆid©e_psf
 (
SF_PRIVATE
 *
psf
) ;

240 
ßve_hódî_öfo
 (
SF_PRIVATE
 *
psf
) ;

241 
c›y_fûíame
 (
SF_PRIVATE
 *
psf
, c⁄° *
∑th
) ;

242 
psf_˛o£
 (
SF_PRIVATE
 *
psf
) ;

243 
psf_›í_fûe
 (
SF_PRIVATE
 *
psf
, 
mode
, 
SF_INFO
 *
sföfo
) ;

245 
åy_ªsour˚_f‹k
 (
SF_PRIVATE
 * 
psf
, 
mode
) ;

251 
	gsf_î∫o
 = 0 ;

252 
	gsf_logbuf„r
 [
SF_BUFFER_LEN
] = { 0 } ;

253 
	gsf_sy£º
 [
SF_SYSERR_LEN
] = { 0 } ;

258 
	#VALIDATE_SNDFILE_AND_ASSIGN_PSF
(
a
,
b
,
c
) \

259 { i‡((
a
Ë=
NULL
) \

260 { 
sf_î∫o
 = 
SFE_BAD_SNDFILE_PTR
 ; \

263 (
b
Ë(
SF_PRIVATE
*Ë(
a
) ; \

264 i‡((
b
)->
vútuÆ_io
 =
SF_FALSE
 && \

265 
	`psf_fûe_vÆid
 (
b
) == 0) \

266 { (
b
)->
îr‹
 = 
SFE_BAD_FILE_PTR
 ; \

269 i‡((
b
)->
Magick
 !
SNDFILE_MAGICK
) \

270 { (
b
)->
îr‹
 = 
SFE_BAD_SNDFILE_PTR
 ; \

273 i‡(
c
Ë(
b
)->
îr‹
 = 0 ; \

274 }

	)

280 
SNDFILE
*

281 
	$sf_›í
 (c⁄° *
∑th
, 
mode
, 
SF_INFO
 *
sföfo
)

282 { 
SF_PRIVATE
 *
psf
 ;

283 
îr‹
 = 0 ;

285 i‡((
psf
 = 
	`ˇŒoc
 (1,  (
SF_PRIVATE
))Ë=
NULL
)

286 { 
sf_î∫o
 = 
SFE_MALLOC_FAILED
 ;

287  
NULL
 ;

290 
	`mem£t
 (
psf
, 0,  (
SF_PRIVATE
)) ;

291 
	`psf_öô_fûes
 (
psf
) ;

293 
	`psf_log_¥ötf
 (
psf
, "Fûê: %s\n", 
∑th
) ;

295 
	`c›y_fûíame
 (
psf
, 
∑th
) ;

297 i‡(
	`°rcmp
 (
∑th
, "-") == 0)

298 
îr‹
 = 
	`psf_£t_°dio
 (
psf
, 
mode
) ;

300 
îr‹
 = 
	`psf_f›í
 (
psf
, 
∑th
, 
mode
) ;

302 i‡(
îr‹
 == 0)

303 
îr‹
 = 
	`psf_›í_fûe
 (
psf
, 
mode
, 
sföfo
) ;

305 i‡(
îr‹
)

306 { 
sf_î∫o
 = 
îr‹
 ;

307 i‡(
îr‹
 =
SFE_SYSTEM
)

308 
	`LSF_SNPRINTF
 (
sf_sy£º
,  (sf_sy£º), "%s", 
psf
->
sy£º
) ;

309 
	`LSF_SNPRINTF
 (
sf_logbuf„r
,  (sf_logbuf„r), "%s", 
psf
->
logbuf„r
) ;

310 
	`psf_˛o£
 (
psf
) ;

311  
NULL
 ;

314 
	`mem˝y
 (
sföfo
, &(
psf
->
sf
),  (
SF_INFO
)) ;

316  (
SNDFILE
*Ë
psf
 ;

317 
	}
}

319 
SNDFILE
*

320 
	$sf_›í_fd
 (
fd
, 
mode
, 
SF_INFO
 *
sföfo
, 
˛o£_desc
)

321 { 
SF_PRIVATE
 *
psf
 ;

322 
îr‹
 ;

324 i‡((
sföfo
->
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_SD2
)

325 { 
sf_î∫o
 = 
SFE_SD2_FD_DISALLOWED
 ;

326  
NULL
 ;

329 i‡((
psf
 = 
	`ˇŒoc
 (1,  (
SF_PRIVATE
))Ë=
NULL
)

330 { 
sf_î∫o
 = 
SFE_MALLOC_FAILED
 ;

331  
NULL
 ;

334 
	`psf_öô_fûes
 (
psf
) ;

336 
	`psf_£t_fûe
 (
psf
, 
fd
) ;

337 
psf
->
is_pùe
 = 
	`psf_is_pùe
 (psf) ;

338 
psf
->
fûeoff£t
 = 
	`psf_·ñl
 (psf) ;

340 i‡(! 
˛o£_desc
)

341 
psf
->
do_nŸ_˛o£_des¸ùt‹
 = 
SF_TRUE
 ;

343 
îr‹
 = 
	`psf_›í_fûe
 (
psf
, 
mode
, 
sföfo
) ;

345 i‡(
îr‹
)

346 { 
sf_î∫o
 = 
îr‹
 ;

347 i‡(
îr‹
 =
SFE_SYSTEM
)

348 
	`LSF_SNPRINTF
 (
sf_sy£º
,  (sf_sy£º), "%s", 
psf
->
sy£º
) ;

349 
	`LSF_SNPRINTF
 (
sf_logbuf„r
,  (sf_logbuf„r), "%s", 
psf
->
logbuf„r
) ;

350 
	`psf_˛o£
 (
psf
) ;

351  
NULL
 ;

354 
	`mem˝y
 (
sföfo
, &(
psf
->
sf
),  (
SF_INFO
)) ;

356  (
SNDFILE
*Ë
psf
 ;

357 
	}
}

359 
SNDFILE
*

360 
	$sf_›í_vútuÆ
 (
SF_VIRTUAL_IO
 *
sfvútuÆ
, 
mode
, 
SF_INFO
 *
sföfo
, *
u£r_d©a
)

361 { 
SF_PRIVATE
 *
psf
 ;

362 
îr‹
 = 0 ;

365 i‡(
sfvútuÆ
->
gë_fûñí
 =
NULL
 || sfvútuÆ->
£ek
 =NULL || sfvútuÆ->
ãŒ
 == NULL)

366 { 
sf_î∫o
 = 
SFE_BAD_VIRTUAL_IO
 ;

367 
	`LSF_SNPRINTF
 (
sf_logbuf„r
,  (sf_logbuffer), "Bad vio_get_filelen / vio_seek / vio_tell in SF_VIRTUAL_IO struct.\n") ;

368  
NULL
 ;

371 i‡((
mode
 =
SFM_READ
 || modê=
SFM_RDWR
Ë&& 
sfvútuÆ
->
ªad
 =
NULL
)

372 { 
sf_î∫o
 = 
SFE_BAD_VIRTUAL_IO
 ;

373 
	`LSF_SNPRINTF
 (
sf_logbuf„r
,  (sf_logbuffer), "Bad vio_read in SF_VIRTUAL_IO struct.\n") ;

374  
NULL
 ;

377 i‡((
mode
 =
SFM_WRITE
 || modê=
SFM_RDWR
Ë&& 
sfvútuÆ
->
wrôe
 =
NULL
)

378 { 
sf_î∫o
 = 
SFE_BAD_VIRTUAL_IO
 ;

379 
	`LSF_SNPRINTF
 (
sf_logbuf„r
,  (sf_logbuffer), "Bad vio_write in SF_VIRTUAL_IO struct.\n") ;

380  
NULL
 ;

383 i‡((
psf
 = 
	`ˇŒoc
 (1,  (
SF_PRIVATE
))Ë=
NULL
)

384 { 
sf_î∫o
 = 
SFE_MALLOC_FAILED
 ;

385  
NULL
 ;

388 
	`psf_öô_fûes
 (
psf
) ;

390 
psf
->
vútuÆ_io
 = 
SF_TRUE
 ;

391 
psf
->
vio
 = *
sfvútuÆ
 ;

392 
psf
->
vio_u£r_d©a
 = 
u£r_d©a
 ;

394 
psf
->
mode
 = mode ;

396 
îr‹
 = 
	`psf_›í_fûe
 (
psf
, 
mode
, 
sföfo
) ;

398 i‡(
îr‹
)

399 { 
sf_î∫o
 = 
îr‹
 ;

400 i‡(
îr‹
 =
SFE_SYSTEM
)

401 
	`LSF_SNPRINTF
 (
sf_sy£º
,  (sf_sy£º), "%s", 
psf
->
sy£º
) ;

402 
	`LSF_SNPRINTF
 (
sf_logbuf„r
,  (sf_logbuf„r), "%s", 
psf
->
logbuf„r
) ;

403 
	`psf_˛o£
 (
psf
) ;

404  
NULL
 ;

407 
	`mem˝y
 (
sföfo
, &(
psf
->
sf
),  (
SF_INFO
)) ;

409  (
SNDFILE
*Ë
psf
 ;

410 
	}
}

413 
	$sf_˛o£
 (
SNDFILE
 *
¢dfûe
)

414 { 
SF_PRIVATE
 *
psf
 ;

416 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 1) ;

418  
	`psf_˛o£
 (
psf
) ;

419 
	}
}

422 
	$sf_wrôe_sync
 (
SNDFILE
 *
¢dfûe
)

423 { 
SF_PRIVATE
 *
psf
 ;

425 i‡((
psf
 = (
SF_PRIVATE
 *Ë
¢dfûe
Ë=
NULL
)

428 
	`psf_fsync
 (
psf
) ;

431 
	}
}

437 
	$sf_îr‹_numbî
 (
î∫um
)

438 { c⁄° *
bad_î∫um
 =

440 
k
 ;

442 i‡(
î∫um
 =
SFE_MAX_ERROR
)

443  
SndfûeEº‹s
 [0].
°r
 ;

445 i‡(
î∫um
 < 0 ||Éºnum > 
SFE_MAX_ERROR
)

447 
	`¥ötf
 ("NŸá vÆidÉº‹Çumbî (%d).\n", 
î∫um
) ;

448  
bad_î∫um
 ;

451 
k
 = 0 ; 
SndfûeEº‹s
 [k].
°r
 ; k++)

452 i‡(
î∫um
 =
SndfûeEº‹s
 [
k
].
îr‹
)

453  
SndfûeEº‹s
 [
k
].
°r
 ;

455  
bad_î∫um
 ;

456 
	}
}

459 
	$sf_°ªº‹
 (
SNDFILE
 *
¢dfûe
)

460 { 
SF_PRIVATE
 *
psf
 = 
NULL
 ;

461 
î∫um
 ;

463 i‡(
¢dfûe
 =
NULL
)

464 { 
î∫um
 = 
sf_î∫o
 ;

465 i‡(
î∫um
 =
SFE_SYSTEM
 && 
sf_sy£º
 [0])

466  
sf_sy£º
 ;

469 { 
psf
 = (
SF_PRIVATE
 *Ë
¢dfûe
 ;

471 i‡(
psf
->
Magick
 !
SNDFILE_MAGICK
)

474 
î∫um
 = 
psf
->
îr‹
 ;

476 i‡(
î∫um
 =
SFE_SYSTEM
 && 
psf
->
sy£º
 [0])

477  
psf
->
sy£º
 ;

480  
	`sf_îr‹_numbî
 (
î∫um
) ;

481 
	}
}

487 
	$sf_îr‹
 (
SNDFILE
 *
¢dfûe
)

488 { 
SF_PRIVATE
 *
psf
 ;

490 i‡(
¢dfûe
 =
NULL
)

491 { i‡(
sf_îr‹
 != 0)

492  
sf_î∫o
 ;

496 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 0) ;

498 i‡(
psf
->
îr‹
)

499  
psf
->
îr‹
 ;

502 
	}
}

508 
	$sf_≥º‹
 (
SNDFILE
 *
¢dfûe
)

509 { 
SF_PRIVATE
 *
psf
 ;

510 
î∫um
 ;

512 i‡(
¢dfûe
 =
NULL
)

513 { 
î∫um
 = 
sf_î∫o
 ;

516 { 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 0) ;

517 
î∫um
 = 
psf
->
îr‹
 ;

520 
	`Ârötf
 (
°dîr
, "%s\n", 
	`sf_îr‹_numbî
 (
î∫um
)) ;

521  
SFE_NO_ERROR
 ;

522 
	}
}

529 
	$sf_îr‹_°r
 (
SNDFILE
 *
¢dfûe
, *
°r
, 
size_t
 
maxÀn
)

530 { 
SF_PRIVATE
 *
psf
 ;

531 
î∫um
 ;

533 i‡(
°r
 =
NULL
)

534  
SFE_INTERNAL
 ;

536 i‡(
¢dfûe
 =
NULL
)

537 
î∫um
 = 
sf_î∫o
 ;

539 { 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 0) ;

540 
î∫um
 = 
psf
->
îr‹
 ;

543 
	`LSF_SNPRINTF
 (
°r
, 
maxÀn
, "%s", 
	`sf_îr‹_numbî
 (
î∫um
)) ;

545  
SFE_NO_ERROR
 ;

546 
	}
}

552 
	$sf_f‹m©_check
 (c⁄° 
SF_INFO
 *
öfo
)

553 { 
subf‹m©
, 
ídün
 ;

555 
subf‹m©
 = 
öfo
->
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

556 
ídün
 = 
öfo
->
f‹m©
 & 
SF_FORMAT_ENDMASK
 ;

563 i‡(
öfo
->
ch™√ls
 < 1 || info->channels > 256)

566 i‡(
öfo
->
ßm∂î©e
 < 0)

569 
öfo
->
f‹m©
 & 
SF_FORMAT_TYPEMASK
)

570 { 
SF_FORMAT_WAV
 :

571 
SF_FORMAT_WAVEX
 :

573 i‡(
subf‹m©
 =
SF_FORMAT_PCM_U8
 || subf‹m© =
SF_FORMAT_PCM_16
)

575 i‡(
subf‹m©
 =
SF_FORMAT_PCM_24
 || subf‹m© =
SF_FORMAT_PCM_32
)

577 i‡((
subf‹m©
 =
SF_FORMAT_IMA_ADPCM
 || subf‹m© =
SF_FORMAT_MS_ADPCM
Ë&& 
öfo
->
ch™√ls
 <= 2)

579 i‡(
subf‹m©
 =
SF_FORMAT_GSM610
 && 
öfo
->
ch™√ls
 == 1)

581 i‡(
subf‹m©
 =
SF_FORMAT_G721_32
 && 
öfo
->
ch™√ls
 == 1)

583 i‡(
subf‹m©
 =
SF_FORMAT_ULAW
 || subf‹m© =
SF_FORMAT_ALAW
)

585 i‡(
subf‹m©
 =
SF_FORMAT_FLOAT
 || subf‹m© =
SF_FORMAT_DOUBLE
)

589 
SF_FORMAT_AIFF
 :

591 i‡(
subf‹m©
 =
SF_FORMAT_PCM_16
 || subf‹m© =
SF_FORMAT_PCM_24
 || subf‹m© =
SF_FORMAT_PCM_32
)

594 i‡(
ídün
 =
SF_ENDIAN_LITTLE
 ||Éndü¿=
SF_ENDIAN_CPU
)

596 i‡(
subf‹m©
 =
SF_FORMAT_PCM_U8
 || subf‹m© =
SF_FORMAT_PCM_S8
)

598 i‡(
subf‹m©
 =
SF_FORMAT_FLOAT
 || subf‹m© =
SF_FORMAT_DOUBLE
)

600 i‡(
subf‹m©
 =
SF_FORMAT_ULAW
 || subf‹m© =
SF_FORMAT_ALAW
)

602 i‡((
subf‹m©
 =
SF_FORMAT_DWVW_12
 || subf‹m© =
SF_FORMAT_DWVW_16
 ||

603 
subf‹m©
 =
SF_FORMAT_DWVW_24
Ë&& 
öfo
-> 
ch™√ls
 == 1)

605 i‡(
subf‹m©
 =
SF_FORMAT_GSM610
 && 
öfo
->
ch™√ls
 == 1)

607 i‡(
subf‹m©
 =
SF_FORMAT_IMA_ADPCM
 && (
öfo
->
ch™√ls
 == 1 || info->channels == 2))

611 
SF_FORMAT_AU
 :

612 i‡(
subf‹m©
 =
SF_FORMAT_PCM_S8
 || subf‹m© =
SF_FORMAT_PCM_16
)

614 i‡(
subf‹m©
 =
SF_FORMAT_PCM_24
 || subf‹m© =
SF_FORMAT_PCM_32
)

616 i‡(
subf‹m©
 =
SF_FORMAT_ULAW
 || subf‹m© =
SF_FORMAT_ALAW
)

618 i‡(
subf‹m©
 =
SF_FORMAT_FLOAT
 || subf‹m© =
SF_FORMAT_DOUBLE
)

620 i‡(
subf‹m©
 =
SF_FORMAT_G721_32
 && 
öfo
->
ch™√ls
 == 1)

622 i‡(
subf‹m©
 =
SF_FORMAT_G723_24
 && 
öfo
->
ch™√ls
 == 1)

624 i‡(
subf‹m©
 =
SF_FORMAT_G723_40
 && 
öfo
->
ch™√ls
 == 1)

628 
SF_FORMAT_CAF
 :

629 i‡(
subf‹m©
 =
SF_FORMAT_PCM_S8
 || subf‹m© =
SF_FORMAT_PCM_16
)

631 i‡(
subf‹m©
 =
SF_FORMAT_PCM_24
 || subf‹m© =
SF_FORMAT_PCM_32
)

633 i‡(
subf‹m©
 =
SF_FORMAT_ULAW
 || subf‹m© =
SF_FORMAT_ALAW
)

635 i‡(
subf‹m©
 =
SF_FORMAT_FLOAT
 || subf‹m© =
SF_FORMAT_DOUBLE
)

639 
SF_FORMAT_RAW
 :

640 i‡(
subf‹m©
 =
SF_FORMAT_PCM_U8
 || subf‹m© =
SF_FORMAT_PCM_S8
 || subf‹m© =
SF_FORMAT_PCM_16
)

642 i‡(
subf‹m©
 =
SF_FORMAT_PCM_24
 || subf‹m© =
SF_FORMAT_PCM_32
)

644 i‡(
subf‹m©
 =
SF_FORMAT_FLOAT
 || subf‹m© =
SF_FORMAT_DOUBLE
)

646 i‡(
subf‹m©
 =
SF_FORMAT_ALAW
 || subf‹m© =
SF_FORMAT_ULAW
)

648 i‡((
subf‹m©
 =
SF_FORMAT_DWVW_12
 || subf‹m© =
SF_FORMAT_DWVW_16
 ||

649 
subf‹m©
 =
SF_FORMAT_DWVW_24
Ë&& 
öfo
-> 
ch™√ls
 == 1)

651 i‡(
subf‹m©
 =
SF_FORMAT_GSM610
 && 
öfo
->
ch™√ls
 == 1)

653 i‡(
subf‹m©
 =
SF_FORMAT_VOX_ADPCM
 && 
öfo
->
ch™√ls
 == 1)

657 
SF_FORMAT_PAF
 :

658 i‡(
subf‹m©
 =
SF_FORMAT_PCM_S8
 || subf‹m© =
SF_FORMAT_PCM_16
)

660 i‡(
subf‹m©
 =
SF_FORMAT_PCM_24
 || subf‹m© =
SF_FORMAT_PCM_32
)

664 
SF_FORMAT_SVX
 :

668 i‡(
öfo
->
ch™√ls
 != 1)

671 i‡(
ídün
 =
SF_ENDIAN_LITTLE
 ||Éndü¿=
SF_ENDIAN_CPU
)

674 i‡((
subf‹m©
 =
SF_FORMAT_PCM_S8
 || subf‹m© =
SF_FORMAT_PCM_16
Ë&& 
öfo
->
ch™√ls
 == 1)

678 
SF_FORMAT_NIST
 :

679 i‡(
subf‹m©
 =
SF_FORMAT_PCM_S8
 || subf‹m© =
SF_FORMAT_PCM_16
)

681 i‡(
subf‹m©
 =
SF_FORMAT_PCM_24
 || subf‹m© =
SF_FORMAT_PCM_32
)

683 i‡(
subf‹m©
 =
SF_FORMAT_ULAW
 || subf‹m© =
SF_FORMAT_ALAW
)

687 
SF_FORMAT_IRCAM
 :

688 i‡(
subf‹m©
 =
SF_FORMAT_PCM_16
 || subf‹m© =
SF_FORMAT_PCM_24
 || subf‹m© =
SF_FORMAT_PCM_32
)

690 i‡(
subf‹m©
 =
SF_FORMAT_ULAW
 || subf‹m© =
SF_FORMAT_ALAW
 || subf‹m© =
SF_FORMAT_FLOAT
)

694 
SF_FORMAT_VOC
 :

696 i‡(
ídün
 =
SF_ENDIAN_BIG
 ||Éndü¿=
SF_ENDIAN_CPU
)

698 i‡(
subf‹m©
 =
SF_FORMAT_PCM_U8
 || subf‹m© =
SF_FORMAT_PCM_16
)

700 i‡(
subf‹m©
 =
SF_FORMAT_ULAW
 || subf‹m© =
SF_FORMAT_ALAW
)

704 
SF_FORMAT_W64
 :

706 i‡(
ídün
 =
SF_ENDIAN_BIG
 ||Éndü¿=
SF_ENDIAN_CPU
)

708 i‡(
subf‹m©
 =
SF_FORMAT_PCM_U8
 || subf‹m© =
SF_FORMAT_PCM_16
)

710 i‡(
subf‹m©
 =
SF_FORMAT_PCM_24
 || subf‹m© =
SF_FORMAT_PCM_32
)

712 i‡((
subf‹m©
 =
SF_FORMAT_IMA_ADPCM
 || subf‹m© =
SF_FORMAT_MS_ADPCM
Ë&& 
öfo
->
ch™√ls
 <= 2)

714 i‡(
subf‹m©
 =
SF_FORMAT_GSM610
 && 
öfo
->
ch™√ls
 == 1)

716 i‡(
subf‹m©
 =
SF_FORMAT_ULAW
 || subf‹m© =
SF_FORMAT_ALAW
)

718 i‡(
subf‹m©
 =
SF_FORMAT_FLOAT
 || subf‹m© =
SF_FORMAT_DOUBLE
)

722 
SF_FORMAT_MAT4
 :

723 i‡(
subf‹m©
 =
SF_FORMAT_PCM_16
 || subf‹m© =
SF_FORMAT_PCM_32
)

725 i‡(
subf‹m©
 =
SF_FORMAT_FLOAT
 || subf‹m© =
SF_FORMAT_DOUBLE
)

729 
SF_FORMAT_MAT5
 :

730 i‡(
subf‹m©
 =
SF_FORMAT_PCM_U8
 || subf‹m© =
SF_FORMAT_PCM_16
 || subf‹m© =
SF_FORMAT_PCM_32
)

732 i‡(
subf‹m©
 =
SF_FORMAT_FLOAT
 || subf‹m© =
SF_FORMAT_DOUBLE
)

736 
SF_FORMAT_PVF
 :

737 i‡(
subf‹m©
 =
SF_FORMAT_PCM_S8
 || subf‹m© =
SF_FORMAT_PCM_16
 || subf‹m© =
SF_FORMAT_PCM_32
)

741 
SF_FORMAT_XI
 :

742 i‡(
öfo
->
ch™√ls
 != 1)

744 i‡(
subf‹m©
 =
SF_FORMAT_DPCM_8
 || subf‹m© =
SF_FORMAT_DPCM_16
)

748 
SF_FORMAT_HTK
 :

750 i‡(
ídün
 =
SF_ENDIAN_LITTLE
 ||Éndü¿=
SF_ENDIAN_CPU
)

752 i‡(
öfo
->
ch™√ls
 != 1)

754 i‡(
subf‹m©
 =
SF_FORMAT_PCM_16
)

758 
SF_FORMAT_SDS
 :

760 i‡(
ídün
 =
SF_ENDIAN_LITTLE
 ||Éndü¿=
SF_ENDIAN_CPU
)

762 i‡(
öfo
->
ch™√ls
 != 1)

764 i‡(
subf‹m©
 =
SF_FORMAT_PCM_S8
 || subf‹m© =
SF_FORMAT_PCM_16
 || subf‹m© =
SF_FORMAT_PCM_24
)

768 
SF_FORMAT_AVR
 :

770 i‡(
ídün
 =
SF_ENDIAN_LITTLE
 ||Éndü¿=
SF_ENDIAN_CPU
)

772 i‡(
öfo
->
ch™√ls
 > 2)

774 i‡(
subf‹m©
 =
SF_FORMAT_PCM_U8
 || subf‹m© =
SF_FORMAT_PCM_S8
 || subf‹m© =
SF_FORMAT_PCM_16
)

778 
SF_FORMAT_FLAC
 :

780 i‡(
öfo
->
ch™√ls
 > 8)

782 i‡(
subf‹m©
 =
SF_FORMAT_PCM_S8
 || subf‹m© =
SF_FORMAT_PCM_16
 || subf‹m© =
SF_FORMAT_PCM_24
)

786 
SF_FORMAT_SD2
 :

788 i‡(
ídün
 =
SF_ENDIAN_LITTLE
 ||Éndü¿=
SF_ENDIAN_CPU
)

790 i‡(
subf‹m©
 =
SF_FORMAT_PCM_S8
 || subf‹m© =
SF_FORMAT_PCM_16
 || subf‹m© =
SF_FORMAT_PCM_24
)

798 
	}
}

804 
	$sf_comm™d
 (
SNDFILE
 *
¢dfûe
, 
comm™d
, *
d©a
, 
d©asize
)

805 { 
SF_PRIVATE
 *
psf
 = 
NULL
 ;

806 
ﬁd_vÆue
 ;

809 
comm™d
)

810 { 
SFC_GET_LIB_VERSION
 :

811 i‡(
d©a
 =
NULL
)

812  (
psf
->
îr‹
 = 
SFE_BAD_CONTROL_CMD
) ;

813 i‡(
ENABLE_EXPERIMENTAL_CODE
)

814 
	`LSF_SNPRINTF
 (
d©a
, 
d©asize
, "%s-%s-exp", 
PACKAGE_NAME
, 
PACKAGE_VERSION
) ;

816 
	`LSF_SNPRINTF
 (
d©a
, 
d©asize
, "%s-%s", 
PACKAGE_NAME
, 
PACKAGE_VERSION
) ;

817  
	`°æí
 (
d©a
) ;

819 
SFC_GET_SIMPLE_FORMAT_COUNT
 :

820 i‡(
d©a
 =
NULL
 || 
d©asize
 !
	`SIGNED_SIZEOF
 ())

821  (
sf_î∫o
 = 
SFE_BAD_CONTROL_CMD
) ;

822 *((*Ë
d©a
Ë
	`psf_gë_f‹m©_sim∂e_cou¡
 () ;

825 
SFC_GET_SIMPLE_FORMAT
 :

826 i‡(
d©a
 =
NULL
 || 
d©asize
 !
	`SIGNED_SIZEOF
 (
SF_FORMAT_INFO
))

827  (
sf_î∫o
 = 
SFE_BAD_CONTROL_CMD
) ;

828  
	`psf_gë_f‹m©_sim∂e
 (
d©a
) ;

830 
SFC_GET_FORMAT_MAJOR_COUNT
 :

831 i‡(
d©a
 =
NULL
 || 
d©asize
 !
	`SIGNED_SIZEOF
 ())

832  (
sf_î∫o
 = 
SFE_BAD_CONTROL_CMD
) ;

833 *((*Ë
d©a
Ë
	`psf_gë_f‹m©_maj‹_cou¡
 () ;

836 
SFC_GET_FORMAT_MAJOR
 :

837 i‡(
d©a
 =
NULL
 || 
d©asize
 !
	`SIGNED_SIZEOF
 (
SF_FORMAT_INFO
))

838  (
sf_î∫o
 = 
SFE_BAD_CONTROL_CMD
) ;

839  
	`psf_gë_f‹m©_maj‹
 (
d©a
) ;

841 
SFC_GET_FORMAT_SUBTYPE_COUNT
 :

842 i‡(
d©a
 =
NULL
 || 
d©asize
 !
	`SIGNED_SIZEOF
 ())

843  (
sf_î∫o
 = 
SFE_BAD_CONTROL_CMD
) ;

844 *((*Ë
d©a
Ë
	`psf_gë_f‹m©_subty≥_cou¡
 () ;

847 
SFC_GET_FORMAT_SUBTYPE
 :

848 i‡(
d©a
 =
NULL
 || 
d©asize
 !
	`SIGNED_SIZEOF
 (
SF_FORMAT_INFO
))

849  (
sf_î∫o
 = 
SFE_BAD_CONTROL_CMD
) ;

850  
	`psf_gë_f‹m©_subty≥
 (
d©a
) ;

852 
SFC_GET_FORMAT_INFO
 :

853 i‡(
d©a
 =
NULL
 || 
d©asize
 !
	`SIGNED_SIZEOF
 (
SF_FORMAT_INFO
))

854  (
sf_î∫o
 = 
SFE_BAD_CONTROL_CMD
) ;

855  
	`psf_gë_f‹m©_öfo
 (
d©a
) ;

858 i‡(
¢dfûe
 =
NULL
 && 
comm™d
 =
SFC_GET_LOG_INFO
)

859 { i‡(
d©a
 =
NULL
)

860  (
psf
->
îr‹
 = 
SFE_BAD_CONTROL_CMD
) ;

861 
	`LSF_SNPRINTF
 (
d©a
, 
d©asize
, "%s", 
sf_logbuf„r
) ;

862  
	`°æí
 (
d©a
) ;

865 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 1) ;

867 
comm™d
)

868 { 
SFC_SET_NORM_FLOAT
 :

869 
ﬁd_vÆue
 = 
psf
->
n‹m_Êﬂt
 ;

870 
psf
->
n‹m_Êﬂt
 = (
d©asize
Ë? 
SF_TRUE
 : 
SF_FALSE
 ;

871  
ﬁd_vÆue
 ;

873 
SFC_SET_NORM_DOUBLE
 :

874 
ﬁd_vÆue
 = 
psf
->
n‹m_doubÀ
 ;

875 
psf
->
n‹m_doubÀ
 = (
d©asize
Ë? 
SF_TRUE
 : 
SF_FALSE
 ;

876  
ﬁd_vÆue
 ;

878 
SFC_GET_NORM_FLOAT
 :

879  
psf
->
n‹m_Êﬂt
 ;

881 
SFC_GET_NORM_DOUBLE
 :

882  
psf
->
n‹m_doubÀ
 ;

884 
SFC_SET_SCALE_FLOAT_INT_READ
 :

885 
ﬁd_vÆue
 = 
psf
->
Êﬂt_öt_mu…
 ;

887 
psf
->
Êﬂt_öt_mu…
 = (
d©asize
 !0Ë? 
SF_TRUE
 : 
SF_FALSE
 ;

888 i‡(
psf
->
Êﬂt_öt_mu…
 &&Ösf->
Êﬂt_max
 < 0.0)

889 
psf
->
Êﬂt_max
 = 
	`psf_ˇlc_sig«l_max
 (psf, 
SF_FALSE
) ;

890  
ﬁd_vÆue
 ;

892 
SFC_SET_ADD_PEAK_CHUNK
 :

893 { 
f‹m©
 = 
psf
->
sf
.f‹m© & 
SF_FORMAT_TYPEMASK
 ;

896 i‡(
f‹m©
 !
SF_FORMAT_WAV
 && f‹m© !
SF_FORMAT_WAVEX
 && f‹m© !
SF_FORMAT_AIFF
)

897  
SF_FALSE
 ;

899 
f‹m©
 = 
psf
->
sf
.f‹m© & 
SF_FORMAT_SUBMASK
 ;

902 i‡(
f‹m©
 !
SF_FORMAT_FLOAT
 && f‹m© !
SF_FORMAT_DOUBLE
)

903  
SF_FALSE
 ;

907 i‡(
psf
->
mode
 !
SFM_WRITE
)

908  
SF_FALSE
 ;

910 i‡(
psf
->
have_wrôãn
)

911  
SF_FALSE
 ;

913 i‡(
d©asize
 =
SF_FALSE
 && 
psf
->
≥ak_öfo
 !
NULL
)

914 { 
	`‰ì
 (
psf
->
≥ak_öfo
) ;

915 
psf
->
≥ak_öfo
 = 
NULL
 ;

917 i‡(
psf
->
≥ak_öfo
 =
NULL
)

918 { 
psf
->
≥ak_öfo
 = 
	`≥ak_öfo_ˇŒoc
 (psf->
sf
.
ch™√ls
) ;

919 
psf
->
≥ak_öfo
->
≥ak_loc
 = 
SF_PEAK_START
 ;

922 i‡(
psf
->
wrôe_hódî
)

923 
psf
->
	`wrôe_hódî
 (psf, 
SF_TRUE
) ;

924  
d©asize
 ;

926 
SFC_GET_LOG_INFO
 :

927 i‡(
d©a
 =
NULL
)

928  (
psf
->
îr‹
 = 
SFE_BAD_CONTROL_CMD
) ;

929 
	`LSF_SNPRINTF
 (
d©a
, 
d©asize
, "%s", 
psf
->
logbuf„r
) ;

932 
SFC_CALC_SIGNAL_MAX
 :

933 i‡(
d©a
 =
NULL
 || 
d©asize
 !=  ())

934  (
psf
->
îr‹
 = 
SFE_BAD_CONTROL_CMD
) ;

935 *((*Ë
d©a
Ë
	`psf_ˇlc_sig«l_max
 (
psf
, 
SF_FALSE
) ;

938 
SFC_CALC_NORM_SIGNAL_MAX
 :

939 i‡(
d©a
 =
NULL
 || 
d©asize
 !=  ())

940  (
psf
->
îr‹
 = 
SFE_BAD_CONTROL_CMD
) ;

941 *((*Ë
d©a
Ë
	`psf_ˇlc_sig«l_max
 (
psf
, 
SF_TRUE
) ;

944 
SFC_CALC_MAX_ALL_CHANNELS
 :

945 i‡(
d©a
 =
NULL
 || 
d©asize
 !
	`SIGNED_SIZEOF
 (Ë* 
psf
->
sf
.
ch™√ls
)

946  (
psf
->
îr‹
 = 
SFE_BAD_CONTROL_CMD
) ;

947  
	`psf_ˇlc_max_Æl_ch™√ls
 (
psf
, (*Ë
d©a
, 
SF_FALSE
) ;

949 
SFC_CALC_NORM_MAX_ALL_CHANNELS
 :

950 i‡(
d©a
 =
NULL
 || 
d©asize
 !
	`SIGNED_SIZEOF
 (Ë* 
psf
->
sf
.
ch™√ls
)

951  (
psf
->
îr‹
 = 
SFE_BAD_CONTROL_CMD
) ;

952  
	`psf_ˇlc_max_Æl_ch™√ls
 (
psf
, (*Ë
d©a
, 
SF_TRUE
) ;

954 
SFC_GET_SIGNAL_MAX
 :

955 i‡(
d©a
 =
NULL
 || 
d©asize
 !=  ())

956 { 
psf
->
îr‹
 = 
SFE_BAD_CONTROL_CMD
 ;

957  
SF_FALSE
 ;

959  
	`psf_gë_sig«l_max
 (
psf
, (*Ë
d©a
) ;

961 
SFC_GET_MAX_ALL_CHANNELS
 :

962 i‡(
d©a
 =
NULL
 || 
d©asize
 !
	`SIGNED_SIZEOF
 (Ë* 
psf
->
sf
.
ch™√ls
)

963 { 
psf
->
îr‹
 = 
SFE_BAD_CONTROL_CMD
 ;

964  
SF_FALSE
 ;

966  
	`psf_gë_max_Æl_ch™√ls
 (
psf
, (*Ë
d©a
) ;

968 
SFC_UPDATE_HEADER_NOW
 :

969 i‡(
psf
->
wrôe_hódî
)

970 
psf
->
	`wrôe_hódî
 (psf, 
SF_TRUE
) ;

973 
SFC_SET_UPDATE_HEADER_AUTO
 :

974 
psf
->
auto_hódî
 = 
d©asize
 ? 
SF_TRUE
 : 
SF_FALSE
 ;

975  
psf
->
auto_hódî
 ;

978 
SFC_SET_ADD_DITHER_ON_WRITE
 :

979 
SFC_SET_ADD_DITHER_ON_READ
 :

987 
SFC_SET_DITHER_ON_WRITE
 :

988 i‡(
d©a
 =
NULL
 || 
d©asize
 !
	`SIGNED_SIZEOF
 (
SF_DITHER_INFO
))

989  (
psf
->
îr‹
 = 
SFE_BAD_CONTROL_CMD
) ;

990 
	`mem˝y
 (&
psf
->
wrôe_dôhî
, 
d©a
,  (psf->write_dither)) ;

991 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

992 
	`dôhî_öô
 (
psf
, 
SFM_WRITE
) ;

995 
SFC_SET_DITHER_ON_READ
 :

996 i‡(
d©a
 =
NULL
 || 
d©asize
 !
	`SIGNED_SIZEOF
 (
SF_DITHER_INFO
))

997  (
psf
->
îr‹
 = 
SFE_BAD_CONTROL_CMD
) ;

998 
	`mem˝y
 (&
psf
->
ªad_dôhî
, 
d©a
,  (psf->read_dither)) ;

999 i‡(
psf
->
mode
 =
SFM_READ
 ||Ösf->modê=
SFM_RDWR
)

1000 
	`dôhî_öô
 (
psf
, 
SFM_READ
) ;

1003 
SFC_FILE_TRUNCATE
 :

1004 i‡(
psf
->
mode
 !
SFM_WRITE
 &&Ösf->modê!
SFM_RDWR
)

1005  
SF_TRUE
 ;

1006 i‡(
d©asize
 ! (
sf_cou¡_t
))

1007  
SF_TRUE
 ;

1008 { 
sf_cou¡_t
 
posôi⁄
 ;

1010 
posôi⁄
 = *((
sf_cou¡_t
*Ë
d©a
) ;

1012 i‡(
	`sf_£ek
 (
¢dfûe
, 
posôi⁄
, 
SEEK_SET
) !=Öosition)

1013  
SF_TRUE
 ;

1015 
psf
->
sf
.
‰ames
 = 
posôi⁄
 ;

1017 
posôi⁄
 = 
	`psf_f£ek
 (
psf
, 0, 
SEEK_CUR
) ;

1019  
	`psf_·runˇã
 (
psf
, 
posôi⁄
) ;

1023 
SFC_SET_RAW_START_OFFSET
 :

1024 i‡(
d©a
 =
NULL
 || 
d©asize
 ! (
sf_cou¡_t
))

1025  (
psf
->
îr‹
 = 
SFE_BAD_CONTROL_CMD
) ;

1026 i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

1027  (
psf
->
îr‹
 = 
SFE_BAD_CONTROL_CMD
) ;

1029 
psf
->
d©aoff£t
 = *((
sf_cou¡_t
*Ë
d©a
) ;

1030 
	`sf_£ek
 (
¢dfûe
, 0, 
SEEK_CUR
) ;

1033 
SFC_GET_EMBED_FILE_INFO
 :

1034 i‡(
d©a
 =
NULL
 || 
d©asize
 ! (
SF_EMBED_FILE_INFO
))

1035  (
psf
->
îr‹
 = 
SFE_BAD_CONTROL_CMD
) ;

1037 ((
SF_EMBED_FILE_INFO
*Ë
d©a
)->
off£t
 = 
psf
->
fûeoff£t
 ;

1038 ((
SF_EMBED_FILE_INFO
*Ë
d©a
)->
Àngth
 = 
psf
->
fûñígth
 ;

1042 
SFC_TEST_IEEE_FLOAT_REPLACE
 :

1043 
psf
->
õì_ª∂a˚
 = (
d©asize
Ë? 
SF_TRUE
 : 
SF_FALSE
 ;

1044 i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_FLOAT
)

1045 
	`Êﬂt32_öô
 (
psf
) ;

1046 i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DOUBLE
)

1047 
	`doubÀ64_öô
 (
psf
) ;

1049  (
psf
->
îr‹
 = 
SFE_BAD_CONTROL_CMD
) ;

1053 
SFC_SET_CLIPPING
 :

1054 
psf
->
add_˛ùpög
 = (
d©asize
Ë? 
SF_TRUE
 : 
SF_FALSE
 ;

1055  
psf
->
add_˛ùpög
 ;

1057 
SFC_GET_CLIPPING
 :

1058  
psf
->
add_˛ùpög
 ;

1060 
SFC_GET_LOOP_INFO
 :

1061 i‡(
d©asize
 ! (
SF_LOOP_INFO
Ë|| 
d©a
 =
NULL
)

1062  
SF_FALSE
 ;

1063 i‡(
psf
->
lo›_öfo
 =
NULL
)

1064  
SF_FALSE
 ;

1065 
	`mem˝y
 (
d©a
, 
psf
->
lo›_öfo
,  (
SF_LOOP_INFO
)) ;

1066  
SF_TRUE
 ;

1068 
SFC_SET_BROADCAST_INFO
 :

1069 { 
f‹m©
 = 
psf
->
sf
.f‹m© & 
SF_FORMAT_TYPEMASK
 ;

1072 i‡(
f‹m©
 !
SF_FORMAT_WAV
 && f‹m© !
SF_FORMAT_WAVEX
)

1073  
SF_FALSE
 ;

1077 i‡(
psf
->
mode
 !
SFM_WRITE
)

1078  
SF_FALSE
 ;

1080 i‡(
psf
->
have_wrôãn
)

1081  
SF_FALSE
 ;

1083 i‡(
psf
->
brﬂdˇ°_öfo
 =
NULL
)

1084 
psf
->
brﬂdˇ°_öfo
 = 
	`brﬂdˇ°_öfo_Æloc
 () ;

1086 
	`brﬂdˇ°_öfo_c›y
 (
psf
->
brﬂdˇ°_öfo
, 
d©a
) ;

1087 
	`brﬂdˇ°_add_codög_hi°‹y
 (
psf
->
brﬂdˇ°_öfo
,Ösf->
sf
.
ch™√ls
,Ösf->sf.
ßm∂î©e
) ;

1089 i‡(
psf
->
wrôe_hódî
)

1090 
psf
->
	`wrôe_hódî
 (psf, 
SF_TRUE
) ;

1091  
SF_TRUE
 ;

1093 
SFC_GET_BROADCAST_INFO
 :

1094 i‡(
d©asize
 ! (
SF_BROADCAST_INFO
Ë|| 
d©a
 =
NULL
)

1095  
SF_FALSE
 ;

1096 i‡(
psf
->
brﬂdˇ°_öfo
 =
NULL
)

1097  
SF_FALSE
 ;

1098  
	`brﬂdˇ°_öfo_c›y
 (
d©a
, 
psf
->
brﬂdˇ°_öfo
) ;

1100 
SFC_GET_INSTRUMENT
 :

1101 i‡(
d©asize
 ! (
SF_INSTRUMENT
Ë|| 
d©a
 =
NULL
)

1102  
SF_FALSE
 ;

1103 i‡(
psf
->
ö°rumít
 =
NULL
)

1104  
SF_FALSE
 ;

1105 
	`mem˝y
 (
d©a
, 
psf
->
ö°rumít
,  (
SF_INSTRUMENT
)) ;

1106  
SF_TRUE
 ;

1108 
SFC_SET_INSTRUMENT
 :

1110 i‡(
psf
->
have_wrôãn
)

1111  
SF_FALSE
 ;

1112 i‡(
d©asize
 ! (
SF_INSTRUMENT
Ë|| 
d©a
 =
NULL
)

1113  
SF_FALSE
 ;

1114 i‡(
psf
->
ö°rumít
 =
NULL
 && (psf->ö°rumíà
	`psf_ö°rumít_Æloc
 ()) == NULL)

1115 { 
psf
->
îr‹
 = 
SFE_MALLOC_FAILED
 ;

1116  
SF_FALSE
 ;

1118 
	`mem˝y
 (
psf
->
ö°rumít
, 
d©a
,  (
SF_INSTRUMENT
)) ;

1119  
SF_TRUE
 ;

1123 i‡(
psf
->
comm™d
)

1124  
psf
->
	`comm™d
 (psf, 
comm™d
, 
d©a
, 
d©asize
) ;

1126 
	`psf_log_¥ötf
 (
psf
, "*** sf_comm™d : cmd = 0x%X\n", 
comm™d
) ;

1127  (
psf
->
îr‹
 = 
SFE_BAD_CONTROL_CMD
) ;

1131 
	}
}

1136 
sf_cou¡_t


1137 
	$sf_£ek
 (
SNDFILE
 *
¢dfûe
, 
sf_cou¡_t
 
off£t
, 
whí˚
)

1138 { 
SF_PRIVATE
 *
psf
 ;

1139 
sf_cou¡_t
 
£ek_‰om_°¨t
 = 0, 
ªtvÆ
 ;

1141 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 1) ;

1143 i‡(! 
psf
->
sf
.
£ekabÀ
)

1144 { 
psf
->
îr‹
 = 
SFE_NOT_SEEKABLE
 ;

1145  
PSF_SEEK_ERROR
 ;

1151 i‡(((
whí˚
 & 
SFM_MASK
Ë=
SFM_WRITE
 && 
psf
->
mode
 =
SFM_READ
) ||

1152 ((
whí˚
 & 
SFM_MASK
Ë=
SFM_READ
 && 
psf
->
mode
 =
SFM_WRITE
))

1153 { 
psf
->
îr‹
 = 
SFE_WRONG_SEEK
 ;

1154  
PSF_SEEK_ERROR
 ;

1160 
whí˚
)

1162 
SEEK_SET
 :

1163 
SEEK_SET
 | 
SFM_READ
 :

1164 
SEEK_SET
 | 
SFM_WRITE
 :

1165 
SEEK_SET
 | 
SFM_RDWR
 :

1166 
£ek_‰om_°¨t
 = 
off£t
 ;

1170 
SEEK_CUR
 :

1171 i‡(
off£t
 == 0)

1172 { i‡(
psf
->
mode
 =
SFM_READ
)

1173  
psf
->
ªad_cuºít
 ;

1174 i‡(
psf
->
mode
 =
SFM_WRITE
)

1175  
psf
->
wrôe_cuºít
 ;

1177 i‡(
psf
->
mode
 =
SFM_READ
)

1178 
£ek_‰om_°¨t
 = 
psf
->
ªad_cuºít
 + 
off£t
 ;

1179 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

1180 
£ek_‰om_°¨t
 = 
psf
->
wrôe_cuºít
 + 
off£t
 ;

1182 
psf
->
îr‹
 = 
SFE_AMBIGUOUS_SEEK
 ;

1185 
SEEK_CUR
 | 
SFM_READ
 :

1186 i‡(
off£t
 == 0)

1187  
psf
->
ªad_cuºít
 ;

1188 
£ek_‰om_°¨t
 = 
psf
->
ªad_cuºít
 + 
off£t
 ;

1191 
SEEK_CUR
 | 
SFM_WRITE
 :

1192 i‡(
off£t
 == 0)

1193  
psf
->
wrôe_cuºít
 ;

1194 
£ek_‰om_°¨t
 = 
psf
->
wrôe_cuºít
 + 
off£t
 ;

1198 
SEEK_END
 :

1199 
SEEK_END
 | 
SFM_READ
 :

1200 
SEEK_END
 | 
SFM_WRITE
 :

1201 
£ek_‰om_°¨t
 = 
psf
->
sf
.
‰ames
 + 
off£t
 ;

1205 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

1209 i‡(
psf
->
îr‹
)

1210  
PSF_SEEK_ERROR
 ;

1212 i‡(
£ek_‰om_°¨t
 < 0 || sìk_‰om_°¨à> 
psf
->
sf
.
‰ames
)

1213 { 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

1214  
PSF_SEEK_ERROR
 ;

1217 i‡(
psf
->
£ek
)

1218 { 
√w_mode
 = (
whí˚
 & 
SFM_MASK
Ë? (whí˚ & SFM_MASKË: 
psf
->
mode
 ;

1220 
ªtvÆ
 = 
psf
->
	`£ek
 (psf, 
√w_mode
, 
£ek_‰om_°¨t
) ;

1222 
√w_mode
)

1223 { 
SFM_READ
 :

1224 
psf
->
ªad_cuºít
 = 
ªtvÆ
 ;

1226 
SFM_WRITE
 :

1227 
psf
->
wrôe_cuºít
 = 
ªtvÆ
 ;

1229 
SFM_RDWR
 :

1230 
psf
->
ªad_cuºít
 = 
ªtvÆ
 ;

1231 
psf
->
wrôe_cuºít
 = 
ªtvÆ
 ;

1232 
√w_mode
 = 
SFM_READ
 ;

1236 
psf
->
œ°_›
 = 
√w_mode
 ;

1238  
ªtvÆ
 ;

1241 
psf
->
îr‹
 = 
SFE_AMBIGUOUS_SEEK
 ;

1242  
PSF_SEEK_ERROR
 ;

1243 
	}
}

1249 
	$sf_gë_°rög
 (
SNDFILE
 *
¢dfûe
, 
°r_ty≥
)

1250 { 
SF_PRIVATE
 *
psf
 ;

1252 i‡((
psf
 = (
SF_PRIVATE
*Ë
¢dfûe
Ë=
NULL
)

1253  
NULL
 ;

1254 i‡(
psf
->
Magick
 !
SNDFILE_MAGICK
)

1255  
NULL
 ;

1257  
	`psf_gë_°rög
 (
psf
, 
°r_ty≥
) ;

1258 
	}
}

1261 
	$sf_£t_°rög
 (
SNDFILE
 *
¢dfûe
, 
°r_ty≥
, c⁄° * 
°r
)

1262 { 
SF_PRIVATE
 *
psf
 ;

1264 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 1) ;

1266  
	`psf_£t_°rög
 (
psf
, 
°r_ty≥
, 
°r
) ;

1267 
	}
}

1272 
sf_cou¡_t


1273 
	$sf_ªad_øw
 (
SNDFILE
 *
¢dfûe
, *
±r
, 
sf_cou¡_t
 
byãs
)

1274 { 
SF_PRIVATE
 *
psf
 ;

1275 
sf_cou¡_t
 
cou¡
 ;

1276 
byãwidth
, 
blockwidth
 ;

1278 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 1) ;

1280 
byãwidth
 = (
psf
->bytewidth > 0) ?Ösf->bytewidth : 1 ;

1281 
blockwidth
 = (
psf
->blockwidth > 0) ?Ösf->blockwidth : 1 ;

1283 i‡(
psf
->
mode
 =
SFM_WRITE
)

1284 { 
psf
->
îr‹
 = 
SFE_NOT_READMODE
 ;

1288 i‡(
byãs
 < 0 || 
psf
->
ªad_cuºít
 >psf->
d©Æígth
)

1289 { 
	`psf_mem£t
 (
±r
, 0, 
byãs
) ;

1293 i‡(
byãs
 % (
psf
->
sf
.
ch™√ls
 * 
byãwidth
))

1294 { 
psf
->
îr‹
 = 
SFE_BAD_READ_ALIGN
 ;

1298 
cou¡
 = 
	`psf_‰ód
 (
±r
, 1, 
byãs
, 
psf
) ;

1300 i‡(
cou¡
 < 
byãs
)

1301 
	`psf_mem£t
 (((*Ë
±r
Ë+ 
cou¡
, 0, 
byãs
 - count) ;

1303 
psf
->
ªad_cuºít
 +
cou¡
 / 
blockwidth
 ;

1305 
psf
->
œ°_›
 = 
SFM_READ
 ;

1307  
cou¡
 ;

1308 
	}
}

1313 
sf_cou¡_t


1314 
	$sf_ªad_sh‹t
 (
SNDFILE
 *
¢dfûe
, *
±r
, 
sf_cou¡_t
 
Àn
)

1315 { 
SF_PRIVATE
 *
psf
 ;

1316 
sf_cou¡_t
 
cou¡
, 
exåa
 ;

1318 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 1) ;

1320 i‡(
psf
->
mode
 =
SFM_WRITE
)

1321 { 
psf
->
îr‹
 = 
SFE_NOT_READMODE
 ;

1325 i‡(
Àn
 % 
psf
->
sf
.
ch™√ls
)

1326 { 
psf
->
îr‹
 = 
SFE_BAD_READ_ALIGN
 ;

1330 i‡(
Àn
 <0 || 
psf
->
ªad_cuºít
 >psf->
sf
.
‰ames
)

1331 { 
	`psf_mem£t
 (
±r
, 0, 
Àn
 *  ()) ;

1335 i‡(
psf
->
ªad_sh‹t
 =
NULL
 ||Ösf->
£ek
 == NULL)

1336 { 
psf
->
îr‹
 = 
SFE_UNIMPLEMENTED
 ;

1340 i‡(
psf
->
œ°_›
 !
SFM_READ
)

1341 i‡(
psf
->
	`£ek
 (psf, 
SFM_READ
,Ösf->
ªad_cuºít
) < 0)

1344 
cou¡
 = 
psf
->
	`ªad_sh‹t
 (psf, 
±r
, 
Àn
) ;

1346 i‡(
psf
->
ªad_cuºít
 + 
cou¡
 /Ösf->
sf
.
ch™√ls
 >Ösf->sf.
‰ames
)

1347 { 
cou¡
 = (
psf
->
sf
.
‰ames
 -Ösf->
ªad_cuºít
Ë*Ösf->sf.
ch™√ls
 ;

1348 
exåa
 = 
Àn
 - 
cou¡
 ;

1349 
	`psf_mem£t
 (
±r
 + 
cou¡
, 0, 
exåa
 *  ()) ;

1350 
psf
->
ªad_cuºít
 =Ösf->
sf
.
‰ames
 ;

1353 
psf
->
ªad_cuºít
 +
cou¡
 /Ösf->
sf
.
ch™√ls
 ;

1355 
psf
->
œ°_›
 = 
SFM_READ
 ;

1357 i‡(
psf
->
ªad_cuºít
 >Ösf->
sf
.
‰ames
)

1358 { 
cou¡
 = 
psf
->
sf
.
ch™√ls
 * (psf->
ªad_cuºít
 -Ösf->sf.
‰ames
) ;

1359 
psf
->
ªad_cuºít
 =Ösf->
sf
.
‰ames
 ;

1362  
cou¡
 ;

1363 
	}
}

1365 
sf_cou¡_t


1366 
	$sf_ªadf_sh‹t
 (
SNDFILE
 *
¢dfûe
, *
±r
, 
sf_cou¡_t
 
‰ames
)

1367 { 
SF_PRIVATE
 *
psf
 ;

1368 
sf_cou¡_t
 
cou¡
, 
exåa
 ;

1370 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 1) ;

1372 i‡(
psf
->
mode
 =
SFM_WRITE
)

1373 { 
psf
->
îr‹
 = 
SFE_NOT_READMODE
 ;

1377 i‡(
‰ames
 <0 || 
psf
->
ªad_cuºít
 >psf->
sf
.frames)

1378 { 
	`psf_mem£t
 (
±r
, 0, 
‰ames
 * 
psf
->
sf
.
ch™√ls
 *  ()) ;

1382 i‡(
psf
->
ªad_sh‹t
 =
NULL
 ||Ösf->
£ek
 == NULL)

1383 { 
psf
->
îr‹
 = 
SFE_UNIMPLEMENTED
 ;

1387 i‡(
psf
->
œ°_›
 !
SFM_READ
)

1388 i‡(
psf
->
	`£ek
 (psf, 
SFM_READ
,Ösf->
ªad_cuºít
) < 0)

1391 
cou¡
 = 
psf
->
	`ªad_sh‹t
 (psf, 
±r
, 
‰ames
 *Ösf->
sf
.
ch™√ls
) ;

1393 i‡(
psf
->
ªad_cuºít
 + 
cou¡
 /Ösf->
sf
.
ch™√ls
 >Ösf->sf.
‰ames
)

1394 { 
cou¡
 = (
psf
->
sf
.
‰ames
 -Ösf->
ªad_cuºít
Ë*Ösf->sf.
ch™√ls
 ;

1395 
exåa
 = 
‰ames
 * 
psf
->
sf
.
ch™√ls
 - 
cou¡
 ;

1396 
	`psf_mem£t
 (
±r
 + 
cou¡
, 0, 
exåa
 *  ()) ;

1397 
psf
->
ªad_cuºít
 =Ösf->
sf
.
‰ames
 ;

1400 
psf
->
ªad_cuºít
 +
cou¡
 /Ösf->
sf
.
ch™√ls
 ;

1402 
psf
->
œ°_›
 = 
SFM_READ
 ;

1404 i‡(
psf
->
ªad_cuºít
 >Ösf->
sf
.
‰ames
)

1405 { 
cou¡
 = 
psf
->
sf
.
ch™√ls
 * (psf->
ªad_cuºít
 -Ösf->sf.
‰ames
) ;

1406 
psf
->
ªad_cuºít
 =Ösf->
sf
.
‰ames
 ;

1409  
cou¡
 / 
psf
->
sf
.
ch™√ls
 ;

1410 
	}
}

1415 
sf_cou¡_t


1416 
	$sf_ªad_öt
 (
SNDFILE
 *
¢dfûe
, *
±r
, 
sf_cou¡_t
 
Àn
)

1417 { 
SF_PRIVATE
 *
psf
 ;

1418 
sf_cou¡_t
 
cou¡
, 
exåa
 ;

1420 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 1) ;

1422 i‡(
psf
->
mode
 =
SFM_WRITE
)

1423 { 
psf
->
îr‹
 = 
SFE_NOT_READMODE
 ;

1427 i‡(
Àn
 % 
psf
->
sf
.
ch™√ls
)

1428 { 
psf
->
îr‹
 = 
SFE_BAD_READ_ALIGN
 ;

1432 i‡(
Àn
 <0 || 
psf
->
ªad_cuºít
 >psf->
sf
.
‰ames
)

1433 { 
	`psf_mem£t
 (
±r
, 0, 
Àn
 *  ()) ;

1437 i‡(
psf
->
ªad_öt
 =
NULL
 ||Ösf->
£ek
 == NULL)

1438 { 
psf
->
îr‹
 = 
SFE_UNIMPLEMENTED
 ;

1442 i‡(
psf
->
œ°_›
 !
SFM_READ
)

1443 i‡(
psf
->
	`£ek
 (psf, 
SFM_READ
,Ösf->
ªad_cuºít
) < 0)

1446 
cou¡
 = 
psf
->
	`ªad_öt
 (psf, 
±r
, 
Àn
) ;

1448 i‡(
psf
->
ªad_cuºít
 + 
cou¡
 /Ösf->
sf
.
ch™√ls
 >Ösf->sf.
‰ames
)

1449 { 
cou¡
 = (
psf
->
sf
.
‰ames
 -Ösf->
ªad_cuºít
Ë*Ösf->sf.
ch™√ls
 ;

1450 
exåa
 = 
Àn
 - 
cou¡
 ;

1451 
	`psf_mem£t
 (
±r
 + 
cou¡
, 0, 
exåa
 *  ()) ;

1452 
psf
->
ªad_cuºít
 =Ösf->
sf
.
‰ames
 ;

1455 
psf
->
ªad_cuºít
 +
cou¡
 /Ösf->
sf
.
ch™√ls
 ;

1457 
psf
->
œ°_›
 = 
SFM_READ
 ;

1459 i‡(
psf
->
ªad_cuºít
 >Ösf->
sf
.
‰ames
)

1460 { 
cou¡
 = 
psf
->
sf
.
ch™√ls
 * (psf->
ªad_cuºít
 -Ösf->sf.
‰ames
) ;

1461 
psf
->
ªad_cuºít
 =Ösf->
sf
.
‰ames
 ;

1464  
cou¡
 ;

1465 
	}
}

1467 
sf_cou¡_t


1468 
	$sf_ªadf_öt
 (
SNDFILE
 *
¢dfûe
, *
±r
, 
sf_cou¡_t
 
‰ames
)

1469 { 
SF_PRIVATE
 *
psf
 ;

1470 
sf_cou¡_t
 
cou¡
, 
exåa
 ;

1472 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 1) ;

1474 i‡(
psf
->
mode
 =
SFM_WRITE
)

1475 { 
psf
->
îr‹
 = 
SFE_NOT_READMODE
 ;

1479 i‡(
‰ames
 <0 || 
psf
->
ªad_cuºít
 >psf->
sf
.frames)

1480 { 
	`psf_mem£t
 (
±r
, 0, 
‰ames
 * 
psf
->
sf
.
ch™√ls
 *  ()) ;

1484 i‡(
psf
->
ªad_öt
 =
NULL
 ||Ösf->
£ek
 == NULL)

1485 { 
psf
->
îr‹
 = 
SFE_UNIMPLEMENTED
 ;

1489 i‡(
psf
->
œ°_›
 !
SFM_READ
)

1490 i‡(
psf
->
	`£ek
 (psf, 
SFM_READ
,Ösf->
ªad_cuºít
) < 0)

1493 
cou¡
 = 
psf
->
	`ªad_öt
 (psf, 
±r
, 
‰ames
 *Ösf->
sf
.
ch™√ls
) ;

1495 i‡(
psf
->
ªad_cuºít
 + 
cou¡
 /Ösf->
sf
.
ch™√ls
 >Ösf->sf.
‰ames
)

1496 { 
cou¡
 = (
psf
->
sf
.
‰ames
 -Ösf->
ªad_cuºít
Ë*Ösf->sf.
ch™√ls
 ;

1497 
exåa
 = 
‰ames
 * 
psf
->
sf
.
ch™√ls
 - 
cou¡
 ;

1498 
	`psf_mem£t
 (
±r
 + 
cou¡
, 0, 
exåa
 *  ()) ;

1499 
psf
->
ªad_cuºít
 =Ösf->
sf
.
‰ames
 ;

1502 
psf
->
ªad_cuºít
 +
cou¡
 /Ösf->
sf
.
ch™√ls
 ;

1504 
psf
->
œ°_›
 = 
SFM_READ
 ;

1506 i‡(
psf
->
ªad_cuºít
 >Ösf->
sf
.
‰ames
)

1507 { 
cou¡
 = 
psf
->
sf
.
ch™√ls
 * (psf->
ªad_cuºít
 -Ösf->sf.
‰ames
) ;

1508 
psf
->
ªad_cuºít
 =Ösf->
sf
.
‰ames
 ;

1511  
cou¡
 / 
psf
->
sf
.
ch™√ls
 ;

1512 
	}
}

1517 
sf_cou¡_t


1518 
	$sf_ªad_Êﬂt
 (
SNDFILE
 *
¢dfûe
, *
±r
, 
sf_cou¡_t
 
Àn
)

1519 { 
SF_PRIVATE
 *
psf
 ;

1520 
sf_cou¡_t
 
cou¡
, 
exåa
 ;

1522 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 1) ;

1524 i‡(
psf
->
mode
 =
SFM_WRITE
)

1525 { 
psf
->
îr‹
 = 
SFE_NOT_READMODE
 ;

1529 i‡(
Àn
 % 
psf
->
sf
.
ch™√ls
)

1530 { 
psf
->
îr‹
 = 
SFE_BAD_READ_ALIGN
 ;

1534 i‡(
Àn
 <0 || 
psf
->
ªad_cuºít
 >psf->
sf
.
‰ames
)

1535 { 
	`psf_mem£t
 (
±r
, 0, 
Àn
 *  ()) ;

1539 i‡(
psf
->
ªad_Êﬂt
 =
NULL
 ||Ösf->
£ek
 == NULL)

1540 { 
psf
->
îr‹
 = 
SFE_UNIMPLEMENTED
 ;

1544 i‡(
psf
->
œ°_›
 !
SFM_READ
)

1545 i‡(
psf
->
	`£ek
 (psf, 
SFM_READ
,Ösf->
ªad_cuºít
) < 0)

1548 
cou¡
 = 
psf
->
	`ªad_Êﬂt
 (psf, 
±r
, 
Àn
) ;

1550 i‡(
psf
->
ªad_cuºít
 + 
cou¡
 /Ösf->
sf
.
ch™√ls
 >Ösf->sf.
‰ames
)

1551 { 
cou¡
 = (
psf
->
sf
.
‰ames
 -Ösf->
ªad_cuºít
Ë*Ösf->sf.
ch™√ls
 ;

1552 
exåa
 = 
Àn
 - 
cou¡
 ;

1553 
	`psf_mem£t
 (
±r
 + 
cou¡
, 0, 
exåa
 *  ()) ;

1554 
psf
->
ªad_cuºít
 =Ösf->
sf
.
‰ames
 ;

1557 
psf
->
ªad_cuºít
 +
cou¡
 /Ösf->
sf
.
ch™√ls
 ;

1559 
psf
->
œ°_›
 = 
SFM_READ
 ;

1561 i‡(
psf
->
ªad_cuºít
 >Ösf->
sf
.
‰ames
)

1562 { 
cou¡
 = 
psf
->
sf
.
ch™√ls
 * (psf->
ªad_cuºít
 -Ösf->sf.
‰ames
) ;

1563 
psf
->
ªad_cuºít
 =Ösf->
sf
.
‰ames
 ;

1566  
cou¡
 ;

1567 
	}
}

1569 
sf_cou¡_t


1570 
	$sf_ªadf_Êﬂt
 (
SNDFILE
 *
¢dfûe
, *
±r
, 
sf_cou¡_t
 
‰ames
)

1571 { 
SF_PRIVATE
 *
psf
 ;

1572 
sf_cou¡_t
 
cou¡
, 
exåa
 ;

1574 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 1) ;

1576 i‡(
psf
->
mode
 =
SFM_WRITE
)

1577 { 
psf
->
îr‹
 = 
SFE_NOT_READMODE
 ;

1581 i‡(
‰ames
 <0 || 
psf
->
ªad_cuºít
 >psf->
sf
.frames)

1582 { 
	`psf_mem£t
 (
±r
, 0, 
‰ames
 * 
psf
->
sf
.
ch™√ls
 *  ()) ;

1586 i‡(
psf
->
ªad_Êﬂt
 =
NULL
 ||Ösf->
£ek
 == NULL)

1587 { 
psf
->
îr‹
 = 
SFE_UNIMPLEMENTED
 ;

1591 i‡(
psf
->
œ°_›
 !
SFM_READ
)

1592 i‡(
psf
->
	`£ek
 (psf, 
SFM_READ
,Ösf->
ªad_cuºít
) < 0)

1595 
cou¡
 = 
psf
->
	`ªad_Êﬂt
 (psf, 
±r
, 
‰ames
 *Ösf->
sf
.
ch™√ls
) ;

1597 i‡(
psf
->
ªad_cuºít
 + 
cou¡
 /Ösf->
sf
.
ch™√ls
 >Ösf->sf.
‰ames
)

1598 { 
cou¡
 = (
psf
->
sf
.
‰ames
 -Ösf->
ªad_cuºít
Ë*Ösf->sf.
ch™√ls
 ;

1599 
exåa
 = 
‰ames
 * 
psf
->
sf
.
ch™√ls
 - 
cou¡
 ;

1600 
	`psf_mem£t
 (
±r
 + 
cou¡
, 0, 
exåa
 *  ()) ;

1601 
psf
->
ªad_cuºít
 =Ösf->
sf
.
‰ames
 ;

1604 
psf
->
ªad_cuºít
 +
cou¡
 /Ösf->
sf
.
ch™√ls
 ;

1606 
psf
->
œ°_›
 = 
SFM_READ
 ;

1608 i‡(
psf
->
ªad_cuºít
 >Ösf->
sf
.
‰ames
)

1609 { 
cou¡
 = 
psf
->
sf
.
ch™√ls
 * (psf->
ªad_cuºít
 -Ösf->sf.
‰ames
) ;

1610 
psf
->
ªad_cuºít
 =Ösf->
sf
.
‰ames
 ;

1613  
cou¡
 / 
psf
->
sf
.
ch™√ls
 ;

1614 
	}
}

1619 
sf_cou¡_t


1620 
	$sf_ªad_doubÀ
 (
SNDFILE
 *
¢dfûe
, *
±r
, 
sf_cou¡_t
 
Àn
)

1621 { 
SF_PRIVATE
 *
psf
 ;

1622 
sf_cou¡_t
 
cou¡
, 
exåa
 ;

1624 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 1) ;

1626 i‡(
psf
->
mode
 =
SFM_WRITE
)

1627 { 
psf
->
îr‹
 = 
SFE_NOT_READMODE
 ;

1631 i‡(
Àn
 % 
psf
->
sf
.
ch™√ls
)

1632 { 
psf
->
îr‹
 = 
SFE_BAD_READ_ALIGN
 ;

1636 i‡(
Àn
 <0 || 
psf
->
ªad_cuºít
 >psf->
sf
.
‰ames
)

1637 { 
	`psf_mem£t
 (
±r
, 0, 
Àn
 *  ()) ;

1641 i‡(
psf
->
ªad_doubÀ
 =
NULL
 ||Ösf->
£ek
 == NULL)

1642 { 
psf
->
îr‹
 = 
SFE_UNIMPLEMENTED
 ;

1646 i‡(
psf
->
œ°_›
 !
SFM_READ
)

1647 i‡(
psf
->
	`£ek
 (psf, 
SFM_READ
,Ösf->
ªad_cuºít
) < 0)

1650 
cou¡
 = 
psf
->
	`ªad_doubÀ
 (psf, 
±r
, 
Àn
) ;

1652 i‡(
psf
->
ªad_cuºít
 + 
cou¡
 /Ösf->
sf
.
ch™√ls
 >Ösf->sf.
‰ames
)

1653 { 
cou¡
 = (
psf
->
sf
.
‰ames
 -Ösf->
ªad_cuºít
Ë*Ösf->sf.
ch™√ls
 ;

1654 
exåa
 = 
Àn
 - 
cou¡
 ;

1655 
	`psf_mem£t
 (
±r
 + 
cou¡
, 0, 
exåa
 *  ()) ;

1656 
psf
->
ªad_cuºít
 =Ösf->
sf
.
‰ames
 ;

1659 
psf
->
ªad_cuºít
 +
cou¡
 /Ösf->
sf
.
ch™√ls
 ;

1661 
psf
->
œ°_›
 = 
SFM_READ
 ;

1663 i‡(
psf
->
ªad_cuºít
 >Ösf->
sf
.
‰ames
)

1664 { 
cou¡
 = 
psf
->
sf
.
ch™√ls
 * (psf->
ªad_cuºít
 -Ösf->sf.
‰ames
) ;

1665 
psf
->
ªad_cuºít
 =Ösf->
sf
.
‰ames
 ;

1668  
cou¡
 ;

1669 
	}
}

1671 
sf_cou¡_t


1672 
	$sf_ªadf_doubÀ
 (
SNDFILE
 *
¢dfûe
, *
±r
, 
sf_cou¡_t
 
‰ames
)

1673 { 
SF_PRIVATE
 *
psf
 ;

1674 
sf_cou¡_t
 
cou¡
, 
exåa
 ;

1676 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 1) ;

1678 i‡(
psf
->
mode
 =
SFM_WRITE
)

1679 { 
psf
->
îr‹
 = 
SFE_NOT_READMODE
 ;

1683 i‡(
‰ames
 <0 || 
psf
->
ªad_cuºít
 >psf->
sf
.frames)

1684 { 
	`psf_mem£t
 (
±r
, 0, 
‰ames
 * 
psf
->
sf
.
ch™√ls
 *  ()) ;

1688 i‡(
psf
->
ªad_doubÀ
 =
NULL
 ||Ösf->
£ek
 == NULL)

1689 { 
psf
->
îr‹
 = 
SFE_UNIMPLEMENTED
 ;

1693 i‡(
psf
->
œ°_›
 !
SFM_READ
)

1694 i‡(
psf
->
	`£ek
 (psf, 
SFM_READ
,Ösf->
ªad_cuºít
) < 0)

1697 
cou¡
 = 
psf
->
	`ªad_doubÀ
 (psf, 
±r
, 
‰ames
 *Ösf->
sf
.
ch™√ls
) ;

1699 i‡(
psf
->
ªad_cuºít
 + 
cou¡
 /Ösf->
sf
.
ch™√ls
 >Ösf->sf.
‰ames
)

1700 { 
cou¡
 = (
psf
->
sf
.
‰ames
 -Ösf->
ªad_cuºít
Ë*Ösf->sf.
ch™√ls
 ;

1701 
exåa
 = 
‰ames
 * 
psf
->
sf
.
ch™√ls
 - 
cou¡
 ;

1702 
	`psf_mem£t
 (
±r
 + 
cou¡
, 0, 
exåa
 *  ()) ;

1703 
psf
->
ªad_cuºít
 =Ösf->
sf
.
‰ames
 ;

1706 
psf
->
ªad_cuºít
 +
cou¡
 /Ösf->
sf
.
ch™√ls
 ;

1708 
psf
->
œ°_›
 = 
SFM_READ
 ;

1710 i‡(
psf
->
ªad_cuºít
 >Ösf->
sf
.
‰ames
)

1711 { 
cou¡
 = 
psf
->
sf
.
ch™√ls
 * (psf->
ªad_cuºít
 -Ösf->sf.
‰ames
) ;

1712 
psf
->
ªad_cuºít
 =Ösf->
sf
.
‰ames
 ;

1715  
cou¡
 / 
psf
->
sf
.
ch™√ls
 ;

1716 
	}
}

1721 
sf_cou¡_t


1722 
	$sf_wrôe_øw
 (
SNDFILE
 *
¢dfûe
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1723 { 
SF_PRIVATE
 *
psf
 ;

1724 
sf_cou¡_t
 
cou¡
 ;

1725 
byãwidth
, 
blockwidth
 ;

1727 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 1) ;

1729 
byãwidth
 = (
psf
->bytewidth > 0) ?Ösf->bytewidth : 1 ;

1730 
blockwidth
 = (
psf
->blockwidth > 0) ?Ösf->blockwidth : 1 ;

1732 i‡(
psf
->
mode
 =
SFM_READ
)

1733 { 
psf
->
îr‹
 = 
SFE_NOT_WRITEMODE
 ;

1737 i‡(
Àn
 % (
psf
->
sf
.
ch™√ls
 * 
byãwidth
))

1738 { 
psf
->
îr‹
 = 
SFE_BAD_WRITE_ALIGN
 ;

1742 i‡(
psf
->
have_wrôãn
 =
SF_FALSE
 &&Ösf->
wrôe_hódî
 !
NULL
)

1743 
psf
->
	`wrôe_hódî
 (psf, 
SF_FALSE
) ;

1744 
psf
->
have_wrôãn
 = 
SF_TRUE
 ;

1746 
cou¡
 = 
	`psf_fwrôe
 (
±r
, 1, 
Àn
, 
psf
) ;

1748 
psf
->
wrôe_cuºít
 +
cou¡
 / 
blockwidth
 ;

1750 i‡(
psf
->
wrôe_cuºít
 >Ösf->
sf
.
‰ames
)

1751 
psf
->
sf
.
‰ames
 =Ösf->
wrôe_cuºít
 ;

1753 
psf
->
œ°_›
 = 
SFM_WRITE
 ;

1755  
cou¡
 ;

1756 
	}
}

1761 
sf_cou¡_t


1762 
	$sf_wrôe_sh‹t
 (
SNDFILE
 *
¢dfûe
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1763 { 
SF_PRIVATE
 *
psf
 ;

1764 
sf_cou¡_t
 
cou¡
 ;

1766 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 1) ;

1768 i‡(
psf
->
mode
 =
SFM_READ
)

1769 { 
psf
->
îr‹
 = 
SFE_NOT_WRITEMODE
 ;

1773 i‡(
Àn
 % 
psf
->
sf
.
ch™√ls
)

1774 { 
psf
->
îr‹
 = 
SFE_BAD_WRITE_ALIGN
 ;

1778 i‡(
psf
->
wrôe_sh‹t
 =
NULL
 ||Ösf->
£ek
 == NULL)

1779 { 
psf
->
îr‹
 = 
SFE_UNIMPLEMENTED
 ;

1783 i‡(
psf
->
œ°_›
 !
SFM_WRITE
)

1784 i‡(
psf
->
	`£ek
 (psf, 
SFM_WRITE
,Ösf->
wrôe_cuºít
) < 0)

1787 i‡(
psf
->
have_wrôãn
 =
SF_FALSE
 &&Ösf->
wrôe_hódî
 !
NULL
)

1788 
psf
->
	`wrôe_hódî
 (psf, 
SF_FALSE
) ;

1789 
psf
->
have_wrôãn
 = 
SF_TRUE
 ;

1791 
cou¡
 = 
psf
->
	`wrôe_sh‹t
 (psf, 
±r
, 
Àn
) ;

1793 
psf
->
wrôe_cuºít
 +
cou¡
 /Ösf->
sf
.
ch™√ls
 ;

1795 
psf
->
œ°_›
 = 
SFM_WRITE
 ;

1797 i‡(
psf
->
auto_hódî
 &&Ösf->
wrôe_hódî
 !
NULL
)

1798 
psf
->
	`wrôe_hódî
 (psf, 
SF_TRUE
) ;

1800 i‡(
psf
->
wrôe_cuºít
 >Ösf->
sf
.
‰ames
)

1801 
psf
->
sf
.
‰ames
 =Ösf->
wrôe_cuºít
 ;

1803  
cou¡
 ;

1804 
	}
}

1806 
sf_cou¡_t


1807 
	$sf_wrôef_sh‹t
 (
SNDFILE
 *
¢dfûe
, c⁄° *
±r
, 
sf_cou¡_t
 
‰ames
)

1808 { 
SF_PRIVATE
 *
psf
 ;

1809 
sf_cou¡_t
 
cou¡
 ;

1811 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 1) ;

1813 i‡(
psf
->
mode
 =
SFM_READ
)

1814 { 
psf
->
îr‹
 = 
SFE_NOT_WRITEMODE
 ;

1818 i‡(
psf
->
wrôe_sh‹t
 =
NULL
 ||Ösf->
£ek
 == NULL)

1819 { 
psf
->
îr‹
 = 
SFE_UNIMPLEMENTED
 ;

1823 i‡(
psf
->
œ°_›
 !
SFM_WRITE
)

1824 i‡(
psf
->
	`£ek
 (psf, 
SFM_WRITE
,Ösf->
wrôe_cuºít
) < 0)

1827 i‡(
psf
->
have_wrôãn
 =
SF_FALSE
 &&Ösf->
wrôe_hódî
 !
NULL
)

1828 
psf
->
	`wrôe_hódî
 (psf, 
SF_FALSE
) ;

1829 
psf
->
have_wrôãn
 = 
SF_TRUE
 ;

1831 
cou¡
 = 
psf
->
	`wrôe_sh‹t
 (psf, 
±r
, 
‰ames
 *Ösf->
sf
.
ch™√ls
) ;

1833 
psf
->
wrôe_cuºít
 +
cou¡
 /Ösf->
sf
.
ch™√ls
 ;

1835 
psf
->
œ°_›
 = 
SFM_WRITE
 ;

1837 i‡(
psf
->
auto_hódî
 &&Ösf->
wrôe_hódî
 !
NULL
)

1838 
psf
->
	`wrôe_hódî
 (psf, 
SF_TRUE
) ;

1840 i‡(
psf
->
wrôe_cuºít
 >Ösf->
sf
.
‰ames
)

1841 
psf
->
sf
.
‰ames
 =Ösf->
wrôe_cuºít
 ;

1843  
cou¡
 / 
psf
->
sf
.
ch™√ls
 ;

1844 
	}
}

1849 
sf_cou¡_t


1850 
	$sf_wrôe_öt
 (
SNDFILE
 *
¢dfûe
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1851 { 
SF_PRIVATE
 *
psf
 ;

1852 
sf_cou¡_t
 
cou¡
 ;

1854 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 1) ;

1856 i‡(
psf
->
mode
 =
SFM_READ
)

1857 { 
psf
->
îr‹
 = 
SFE_NOT_WRITEMODE
 ;

1861 i‡(
Àn
 % 
psf
->
sf
.
ch™√ls
)

1862 { 
psf
->
îr‹
 = 
SFE_BAD_WRITE_ALIGN
 ;

1866 i‡(
psf
->
wrôe_öt
 =
NULL
 ||Ösf->
£ek
 == NULL)

1867 { 
psf
->
îr‹
 = 
SFE_UNIMPLEMENTED
 ;

1871 i‡(
psf
->
œ°_›
 !
SFM_WRITE
)

1872 i‡(
psf
->
	`£ek
 (psf, 
SFM_WRITE
,Ösf->
wrôe_cuºít
) < 0)

1875 i‡(
psf
->
have_wrôãn
 =
SF_FALSE
 &&Ösf->
wrôe_hódî
 !
NULL
)

1876 
psf
->
	`wrôe_hódî
 (psf, 
SF_FALSE
) ;

1877 
psf
->
have_wrôãn
 = 
SF_TRUE
 ;

1879 
cou¡
 = 
psf
->
	`wrôe_öt
 (psf, 
±r
, 
Àn
) ;

1881 
psf
->
wrôe_cuºít
 +
cou¡
 /Ösf->
sf
.
ch™√ls
 ;

1883 
psf
->
œ°_›
 = 
SFM_WRITE
 ;

1885 i‡(
psf
->
auto_hódî
 &&Ösf->
wrôe_hódî
 !
NULL
)

1886 
psf
->
	`wrôe_hódî
 (psf, 
SF_TRUE
) ;

1888 i‡(
psf
->
wrôe_cuºít
 >Ösf->
sf
.
‰ames
)

1889 
psf
->
sf
.
‰ames
 =Ösf->
wrôe_cuºít
 ;

1891  
cou¡
 ;

1892 
	}
}

1894 
sf_cou¡_t


1895 
	$sf_wrôef_öt
 (
SNDFILE
 *
¢dfûe
, c⁄° *
±r
, 
sf_cou¡_t
 
‰ames
)

1896 { 
SF_PRIVATE
 *
psf
 ;

1897 
sf_cou¡_t
 
cou¡
 ;

1899 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 1) ;

1901 i‡(
psf
->
mode
 =
SFM_READ
)

1902 { 
psf
->
îr‹
 = 
SFE_NOT_WRITEMODE
 ;

1906 i‡(
psf
->
wrôe_öt
 =
NULL
 ||Ösf->
£ek
 == NULL)

1907 { 
psf
->
îr‹
 = 
SFE_UNIMPLEMENTED
 ;

1911 i‡(
psf
->
œ°_›
 !
SFM_WRITE
)

1912 i‡(
psf
->
	`£ek
 (psf, 
SFM_WRITE
,Ösf->
wrôe_cuºít
) < 0)

1915 i‡(
psf
->
have_wrôãn
 =
SF_FALSE
 &&Ösf->
wrôe_hódî
 !
NULL
)

1916 
psf
->
	`wrôe_hódî
 (psf, 
SF_FALSE
) ;

1917 
psf
->
have_wrôãn
 = 
SF_TRUE
 ;

1919 
cou¡
 = 
psf
->
	`wrôe_öt
 (psf, 
±r
, 
‰ames
 *Ösf->
sf
.
ch™√ls
) ;

1921 
psf
->
wrôe_cuºít
 +
cou¡
 /Ösf->
sf
.
ch™√ls
 ;

1923 
psf
->
œ°_›
 = 
SFM_WRITE
 ;

1925 i‡(
psf
->
auto_hódî
 &&Ösf->
wrôe_hódî
 !
NULL
)

1926 
psf
->
	`wrôe_hódî
 (psf, 
SF_TRUE
) ;

1928 i‡(
psf
->
wrôe_cuºít
 >Ösf->
sf
.
‰ames
)

1929 
psf
->
sf
.
‰ames
 =Ösf->
wrôe_cuºít
 ;

1931  
cou¡
 / 
psf
->
sf
.
ch™√ls
 ;

1932 
	}
}

1937 
sf_cou¡_t


1938 
	$sf_wrôe_Êﬂt
 (
SNDFILE
 *
¢dfûe
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1939 { 
SF_PRIVATE
 *
psf
 ;

1940 
sf_cou¡_t
 
cou¡
 ;

1942 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 1) ;

1944 i‡(
psf
->
mode
 =
SFM_READ
)

1945 { 
psf
->
îr‹
 = 
SFE_NOT_WRITEMODE
 ;

1949 i‡(
Àn
 % 
psf
->
sf
.
ch™√ls
)

1950 { 
psf
->
îr‹
 = 
SFE_BAD_WRITE_ALIGN
 ;

1954 i‡(
psf
->
wrôe_Êﬂt
 =
NULL
 ||Ösf->
£ek
 == NULL)

1955 { 
psf
->
îr‹
 = 
SFE_UNIMPLEMENTED
 ;

1959 i‡(
psf
->
œ°_›
 !
SFM_WRITE
)

1960 i‡(
psf
->
	`£ek
 (psf, 
SFM_WRITE
,Ösf->
wrôe_cuºít
) < 0)

1963 i‡(
psf
->
have_wrôãn
 =
SF_FALSE
 &&Ösf->
wrôe_hódî
 !
NULL
)

1964 
psf
->
	`wrôe_hódî
 (psf, 
SF_FALSE
) ;

1965 
psf
->
have_wrôãn
 = 
SF_TRUE
 ;

1967 
cou¡
 = 
psf
->
	`wrôe_Êﬂt
 (psf, 
±r
, 
Àn
) ;

1969 
psf
->
wrôe_cuºít
 +
cou¡
 /Ösf->
sf
.
ch™√ls
 ;

1971 
psf
->
œ°_›
 = 
SFM_WRITE
 ;

1973 i‡(
psf
->
auto_hódî
 &&Ösf->
wrôe_hódî
 !
NULL
)

1974 
psf
->
	`wrôe_hódî
 (psf, 
SF_TRUE
) ;

1976 i‡(
psf
->
wrôe_cuºít
 >Ösf->
sf
.
‰ames
)

1977 
psf
->
sf
.
‰ames
 =Ösf->
wrôe_cuºít
 ;

1979  
cou¡
 ;

1980 
	}
}

1982 
sf_cou¡_t


1983 
	$sf_wrôef_Êﬂt
 (
SNDFILE
 *
¢dfûe
, c⁄° *
±r
, 
sf_cou¡_t
 
‰ames
)

1984 { 
SF_PRIVATE
 *
psf
 ;

1985 
sf_cou¡_t
 
cou¡
 ;

1987 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 1) ;

1989 i‡(
psf
->
mode
 =
SFM_READ
)

1990 { 
psf
->
îr‹
 = 
SFE_NOT_WRITEMODE
 ;

1994 i‡(
psf
->
wrôe_Êﬂt
 =
NULL
 ||Ösf->
£ek
 == NULL)

1995 { 
psf
->
îr‹
 = 
SFE_UNIMPLEMENTED
 ;

1999 i‡(
psf
->
œ°_›
 !
SFM_WRITE
)

2000 i‡(
psf
->
	`£ek
 (psf, 
SFM_WRITE
,Ösf->
wrôe_cuºít
) < 0)

2003 i‡(
psf
->
have_wrôãn
 =
SF_FALSE
 &&Ösf->
wrôe_hódî
 !
NULL
)

2004 
psf
->
	`wrôe_hódî
 (psf, 
SF_FALSE
) ;

2005 
psf
->
have_wrôãn
 = 
SF_TRUE
 ;

2007 
cou¡
 = 
psf
->
	`wrôe_Êﬂt
 (psf, 
±r
, 
‰ames
 *Ösf->
sf
.
ch™√ls
) ;

2009 
psf
->
wrôe_cuºít
 +
cou¡
 /Ösf->
sf
.
ch™√ls
 ;

2011 
psf
->
œ°_›
 = 
SFM_WRITE
 ;

2013 i‡(
psf
->
auto_hódî
 &&Ösf->
wrôe_hódî
 !
NULL
)

2014 
psf
->
	`wrôe_hódî
 (psf, 
SF_TRUE
) ;

2016 i‡(
psf
->
wrôe_cuºít
 >Ösf->
sf
.
‰ames
)

2017 
psf
->
sf
.
‰ames
 =Ösf->
wrôe_cuºít
 ;

2019  
cou¡
 / 
psf
->
sf
.
ch™√ls
 ;

2020 
	}
}

2025 
sf_cou¡_t


2026 
	$sf_wrôe_doubÀ
 (
SNDFILE
 *
¢dfûe
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

2027 { 
SF_PRIVATE
 *
psf
 ;

2028 
sf_cou¡_t
 
cou¡
 ;

2030 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 1) ;

2032 i‡(
psf
->
mode
 =
SFM_READ
)

2033 { 
psf
->
îr‹
 = 
SFE_NOT_WRITEMODE
 ;

2037 i‡(
Àn
 % 
psf
->
sf
.
ch™√ls
)

2038 { 
psf
->
îr‹
 = 
SFE_BAD_WRITE_ALIGN
 ;

2042 i‡(
psf
->
wrôe_doubÀ
 =
NULL
 ||Ösf->
£ek
 == NULL)

2043 { 
psf
->
îr‹
 = 
SFE_UNIMPLEMENTED
 ;

2047 i‡(
psf
->
œ°_›
 !
SFM_WRITE
)

2048 i‡(
psf
->
	`£ek
 (psf, 
SFM_WRITE
,Ösf->
wrôe_cuºít
) < 0)

2051 i‡(
psf
->
have_wrôãn
 =
SF_FALSE
 &&Ösf->
wrôe_hódî
 !
NULL
)

2052 
psf
->
	`wrôe_hódî
 (psf, 
SF_FALSE
) ;

2053 
psf
->
have_wrôãn
 = 
SF_TRUE
 ;

2055 
cou¡
 = 
psf
->
	`wrôe_doubÀ
 (psf, 
±r
, 
Àn
) ;

2057 
psf
->
wrôe_cuºít
 +
cou¡
 /Ösf->
sf
.
ch™√ls
 ;

2059 
psf
->
œ°_›
 = 
SFM_WRITE
 ;

2061 i‡(
psf
->
auto_hódî
 &&Ösf->
wrôe_hódî
 !
NULL
)

2062 
psf
->
	`wrôe_hódî
 (psf, 
SF_TRUE
) ;

2064 i‡(
psf
->
wrôe_cuºít
 >Ösf->
sf
.
‰ames
)

2065 
psf
->
sf
.
‰ames
 =Ösf->
wrôe_cuºít
 ;

2067  
cou¡
 ;

2068 
	}
}

2070 
sf_cou¡_t


2071 
	$sf_wrôef_doubÀ
 (
SNDFILE
 *
¢dfûe
, c⁄° *
±r
, 
sf_cou¡_t
 
‰ames
)

2072 { 
SF_PRIVATE
 *
psf
 ;

2073 
sf_cou¡_t
 
cou¡
 ;

2075 
	`VALIDATE_SNDFILE_AND_ASSIGN_PSF
 (
¢dfûe
, 
psf
, 1) ;

2077 i‡(
psf
->
mode
 =
SFM_READ
)

2078 { 
psf
->
îr‹
 = 
SFE_NOT_WRITEMODE
 ;

2082 i‡(
psf
->
wrôe_doubÀ
 =
NULL
 ||Ösf->
£ek
 == NULL)

2083 { 
psf
->
îr‹
 = 
SFE_UNIMPLEMENTED
 ;

2087 i‡(
psf
->
œ°_›
 !
SFM_WRITE
)

2088 i‡(
psf
->
	`£ek
 (psf, 
SFM_WRITE
,Ösf->
wrôe_cuºít
) < 0)

2091 i‡(
psf
->
have_wrôãn
 =
SF_FALSE
 &&Ösf->
wrôe_hódî
 !
NULL
)

2092 
psf
->
	`wrôe_hódî
 (psf, 
SF_FALSE
) ;

2093 
psf
->
have_wrôãn
 = 
SF_TRUE
 ;

2095 
cou¡
 = 
psf
->
	`wrôe_doubÀ
 (psf, 
±r
, 
‰ames
 *Ösf->
sf
.
ch™√ls
) ;

2097 
psf
->
wrôe_cuºít
 +
cou¡
 /Ösf->
sf
.
ch™√ls
 ;

2099 
psf
->
œ°_›
 = 
SFM_WRITE
 ;

2101 i‡(
psf
->
auto_hódî
 &&Ösf->
wrôe_hódî
 !
NULL
)

2102 
psf
->
	`wrôe_hódî
 (psf, 
SF_TRUE
) ;

2104 i‡(
psf
->
wrôe_cuºít
 >Ösf->
sf
.
‰ames
)

2105 
psf
->
sf
.
‰ames
 =Ösf->
wrôe_cuºít
 ;

2107  
cou¡
 / 
psf
->
sf
.
ch™√ls
 ;

2108 
	}
}

2115 
	$åy_ªsour˚_f‹k
 (
SF_PRIVATE
 * 
psf
, 
mode
)

2117 i‡(
	`psf_›í_r§c
 (
psf
, 
mode
) != 0)

2121 
	`psf_log_¥ötf
 (
psf
, "Resour˚ f‹k : %s\n",Ösf->
r§˝©h
) ;

2123  
SF_FORMAT_SD2
 ;

2124 
	}
}

2127 
	$f‹m©_‰om_exãnsi⁄
 (
SF_PRIVATE
 *
psf
)

2128 { *
˝å
 ;

2129 
buf„r
 [16] ;

2130 
f‹m©
 = 0 ;

2132 i‡(
psf
->
fûíame
 =
NULL
)

2135 i‡((
˝å
 = 
	`°ºchr
 (
psf
->
fûíame
, '.')Ë=
NULL
)

2138 
˝å
 ++ ;

2139 i‡(
	`°æí
 (
˝å
Ë>  (
buf„r
) - 1)

2142 
	`°∫˝y
 (
buf„r
, 
˝å
,  (buffer)) ;

2143 
buf„r
 [ (buffer) - 1] = 0 ;

2146 
˝å
 = 
buf„r
 ;

2147 *
˝å
)

2148 { *
˝å
 = 
	`tﬁowî
 (*cptr) ;

2149 
˝å
 ++ ;

2152 
˝å
 = 
buf„r
 ;

2154 i‡(
	`°rcmp
 (
˝å
, "au") == 0)

2155 { 
psf
->
sf
.
ch™√ls
 = 1 ;

2156 
psf
->
sf
.
ßm∂î©e
 = 8000 ;

2157 
f‹m©
 = 
SF_FORMAT_RAW
 | 
SF_FORMAT_ULAW
 ;

2159 i‡(
	`°rcmp
 (
˝å
, "snd") == 0)

2160 { 
psf
->
sf
.
ch™√ls
 = 1 ;

2161 
psf
->
sf
.
ßm∂î©e
 = 8000 ;

2162 
f‹m©
 = 
SF_FORMAT_RAW
 | 
SF_FORMAT_ULAW
 ;

2164 i‡(
	`°rcmp
 (
˝å
, "vox") == 0)

2165 { 
psf
->
sf
.
ch™√ls
 = 1 ;

2166 
psf
->
sf
.
ßm∂î©e
 = 8000 ;

2167 
f‹m©
 = 
SF_FORMAT_RAW
 | 
SF_FORMAT_VOX_ADPCM
 ;

2169 i‡(
	`°rcmp
 (
˝å
, "gsm") == 0)

2170 { 
psf
->
sf
.
ch™√ls
 = 1 ;

2171 
psf
->
sf
.
ßm∂î©e
 = 8000 ;

2172 
f‹m©
 = 
SF_FORMAT_RAW
 | 
SF_FORMAT_GSM610
 ;

2176 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_RAW
)

2177 
psf
->
d©aoff£t
 = 0 ;

2179  
f‹m©
 ;

2180 
	}
}

2183 
	$guess_fûe_ty≥
 (
SF_PRIVATE
 *
psf
)

2184 { 
buf„r
 [3], 
f‹m©
 ;

2186 i‡(
	`psf_böhódî_ªadf
 (
psf
, "b", &
buf„r
, 
	`SIGNED_SIZEOF
 (buffer)) != SIGNED_SIZEOF (buffer))

2187 { 
psf
->
îr‹
 = 
SFE_BAD_FILE_READ
 ;

2191 i‡((
buf„r
 [0] =
	`MAKE_MARKER
 ('R', 'I', 'F', 'F') || buffer [0] == MAKE_MARKER ('R', 'I', 'F', 'X'))

2192 && 
buf„r
 [2] =
	`MAKE_MARKER
 ('W', 'A', 'V', 'E'))

2193  
SF_FORMAT_WAV
 ;

2195 i‡(
buf„r
 [0] =
	`MAKE_MARKER
 ('F', 'O', 'R', 'M'))

2196 { i‡(
buf„r
 [2] =
	`MAKE_MARKER
 ('A', 'I', 'F', 'F') || buffer [2] == MAKE_MARKER ('A', 'I', 'F', 'C'))

2197  
SF_FORMAT_AIFF
 ;

2198 i‡(
buf„r
 [2] =
	`MAKE_MARKER
 ('8', 'S', 'V', 'X') || buffer [2] == MAKE_MARKER ('1', '6', 'S', 'V'))

2199  
SF_FORMAT_SVX
 ;

2203 i‡(
buf„r
 [0] =
	`MAKE_MARKER
 ('.', 's', 'n', 'd') || buffer [0] == MAKE_MARKER ('d', 'n', 's', '.'))

2204  
SF_FORMAT_AU
 ;

2206 i‡((
buf„r
 [0] =
	`MAKE_MARKER
 ('f', 'a', 'p', ' ') || buffer [0] == MAKE_MARKER (' ', 'p', 'a', 'f')))

2207  
SF_FORMAT_PAF
 ;

2209 i‡(
buf„r
 [0] =
	`MAKE_MARKER
 ('N', 'I', 'S', 'T'))

2210  
SF_FORMAT_NIST
 ;

2212 i‡(
buf„r
 [0] =
	`MAKE_MARKER
 ('C', 'r', 'e', 'a') && buffer [1] == MAKE_MARKER ('t', 'i', 'v', 'e'))

2213  
SF_FORMAT_VOC
 ;

2215 i‡((
buf„r
 [0] & 
	`MAKE_MARKER
 (0xFF, 0xFF, 0xF8, 0xFF)) == MAKE_MARKER (0x64, 0xA3, 0x00, 0x00) ||

2216 (
buf„r
 [0] & 
	`MAKE_MARKER
 (0xFF, 0xF8, 0xFF, 0xFF)) == MAKE_MARKER (0x00, 0x00, 0xA3, 0x64))

2217  
SF_FORMAT_IRCAM
 ;

2219 i‡(
buf„r
 [0] =
	`MAKE_MARKER
 ('r', 'i', 'f', 'f'))

2220  
SF_FORMAT_W64
 ;

2222 i‡(
buf„r
 [0] =
	`MAKE_MARKER
 (0, 0, 0x03, 0xE8) && buffer [1] == MAKE_MARKER (0, 0, 0, 1) &&

2223 
buf„r
 [2] =
	`MAKE_MARKER
 (0, 0, 0, 1))

2224  
SF_FORMAT_MAT4
 ;

2226 i‡(
buf„r
 [0] =
	`MAKE_MARKER
 (0, 0, 0, 0) && buffer [1] == MAKE_MARKER (1, 0, 0, 0) &&

2227 
buf„r
 [2] =
	`MAKE_MARKER
 (1, 0, 0, 0))

2228  
SF_FORMAT_MAT4
 ;

2230 i‡(
buf„r
 [0] =
	`MAKE_MARKER
 ('M', 'A', 'T', 'L') && buffer [1] == MAKE_MARKER ('A', 'B', ' ', '5'))

2231  
SF_FORMAT_MAT5
 ;

2233 i‡(
buf„r
 [0] =
	`MAKE_MARKER
 ('P', 'V', 'F', '1'))

2234  
SF_FORMAT_PVF
 ;

2236 i‡(
buf„r
 [0] =
	`MAKE_MARKER
 ('E', 'x', 't', 'e') && buffer [1] == MAKE_MARKER ('n', 'd', 'e', 'd') &&

2237 
buf„r
 [2] =
	`MAKE_MARKER
 (' ', 'I', 'n', 's'))

2238  
SF_FORMAT_XI
 ;

2240 i‡(
buf„r
 [0] =
	`MAKE_MARKER
 ('c', 'a', 'f', 'f') && buffer [2] == MAKE_MARKER ('d', 'e', 's', 'c'))

2241  
SF_FORMAT_CAF
 ;

2243 i‡(
ENABLE_EXPERIMENTAL_CODE
 && 
buf„r
 [0] =
	`MAKE_MARKER
 ('O', 'g', 'g', 'S'))

2244  
SF_FORMAT_OGG
 ;

2246 i‡(
buf„r
 [0] =
	`MAKE_MARKER
 ('A', 'L', 'a', 'w') && buffer [1] == MAKE_MARKER ('S', 'o', 'u', 'n')

2247 && 
buf„r
 [2] =
	`MAKE_MARKER
 ('d', 'F', 'i', 'l'))

2248  
SF_FORMAT_WVE
 ;

2250 i‡(
buf„r
 [0] =
	`MAKE_MARKER
 ('D', 'i', 'a', 'm') && buffer [1] == MAKE_MARKER ('o', 'n', 'd', 'W')

2251 && 
buf„r
 [2] =
	`MAKE_MARKER
 ('a', 'r', 'e', ' '))

2252  
SF_FORMAT_DWD
 ;

2254 i‡(
buf„r
 [0] =
	`MAKE_MARKER
 ('L', 'M', '8', '9') || buffer [0] == MAKE_MARKER ('5', '3', 0, 0))

2255  
SF_FORMAT_TXW
 ;

2257 i‡((
buf„r
 [0] & 
	`MAKE_MARKER
 (0xFF, 0xFF, 0x80, 0xFF)) == MAKE_MARKER (0xF0, 0x7E, 0, 0x01))

2258  
SF_FORMAT_SDS
 ;

2260 i‡(
buf„r
 [0] =
	`MAKE_MARKER
 ('C', 'A', 'T', ' ') && buffer [2] == MAKE_MARKER ('R', 'E', 'X', '2'))

2261  
SF_FORMAT_REX2
 ;

2263 i‡(
buf„r
 [0] =
	`MAKE_MARKER
 (0x30, 0x26, 0xB2, 0x75) && buffer [1] == MAKE_MARKER (0x8E, 0x66, 0xCF, 0x11))

2267 i‡(2 * 
	`BEI2H_INT
 (
buf„r
 [0]Ë+ 12 =
psf
->
fûñígth
 && buf„∏[2] =
	`MAKE_MARKER
 (0, 2, 0, 0))

2268  
SF_FORMAT_HTK
 ;

2270 i‡(
buf„r
 [0] =
	`MAKE_MARKER
 ('f', 'L', 'a', 'C'))

2271  
SF_FORMAT_FLAC
 ;

2274 i‡(
buf„r
 [0] =
	`MAKE_MARKER
 ('S', 'O', 'U', 'N') && buffer [1] == MAKE_MARKER ('D', ' ', 'S', 'A'))

2277 i‡(
buf„r
 [0] =
	`MAKE_MARKER
 ('S', 'Y', '8', '0') || buffer [0] == MAKE_MARKER ('S', 'Y', '8', '5'))

2280 i‡(
buf„r
 [0] =
	`MAKE_MARKER
 ('a', 'j', 'k', 'g'))

2283 i‡(
buf„r
 [0] =
	`MAKE_MARKER
 ('2', 'B', 'I', 'T'))

2284  
SF_FORMAT_AVR
 ;

2287 i‡(
psf
->
fûñígth
 > 0 && (
f‹m©
 = 
	`åy_ªsour˚_f‹k
 (psf, 
SFM_READ
)) != 0)

2288  
f‹m©
 ;

2291 
	}
}

2295 
	$vÆid©e_sföfo
 (
SF_INFO
 *
sföfo
)

2296 { i‡(
sföfo
->
ßm∂î©e
 < 1)

2298 i‡(
sföfo
->
‰ames
 < 0)

2300 i‡(
sföfo
->
ch™√ls
 < 1)

2302 i‡((
sföfo
->
f‹m©
 & 
SF_FORMAT_TYPEMASK
) == 0)

2304 i‡((
sföfo
->
f‹m©
 & 
SF_FORMAT_SUBMASK
) == 0)

2306 i‡(
sföfo
->
£˘i⁄s
 < 1)

2309 
	}
}

2312 
	$vÆid©e_psf
 (
SF_PRIVATE
 *
psf
)

2314 i‡(
psf
->
d©Æígth
 < 0)

2315 { 
	`psf_log_¥ötf
 (
psf
, "InvÆid SF_PRIVATE fõld : d©Æígth =%D.\n",Ösf->
d©Æígth
) ;

2318 i‡(
psf
->
d©aoff£t
 < 0)

2319 { 
	`psf_log_¥ötf
 (
psf
, "InvÆid SF_PRIVATE fõld : d©aoff£à=%D.\n",Ösf->
d©aoff£t
) ;

2322 i‡(
psf
->
blockwidth
 &&Ösf->blockwidth !psf->
sf
.
ch™√ls
 *Ösf->
byãwidth
)

2323 { 
	`psf_log_¥ötf
 (
psf
, "Invalid SF_PRIVATE field : channels * bytewidth == %d.\n",

2324 
psf
->
sf
.
ch™√ls
 *Ösf->
byãwidth
) ;

2328 
	}
}

2331 
	$ßve_hódî_öfo
 (
SF_PRIVATE
 *
psf
)

2332 { 
	`LSF_SNPRINTF
 (
sf_logbuf„r
,  (sf_logbuf„r), "%s", 
psf
->
logbuf„r
) ;

2333 
	}
}

2336 
	$c›y_fûíame
 (
SF_PRIVATE
 *
psf
, c⁄° *
∑th
)

2337 { c⁄° *
c˝å
 ;

2338 *
˝å
 ;

2340 
	`LSF_SNPRINTF
 (
psf
->
fûï©h
,  (psf->fûï©h), "%s", 
∑th
) ;

2341 i‡((
c˝å
 = 
	`°ºchr
 (
∑th
, '/')) || (ccptr = strrchr (path, '\\')))

2342 
c˝å
 ++ ;

2344 
c˝å
 = 
∑th
 ;

2346 
	`LSF_SNPRINTF
 (
psf
->
fûíame
,  (psf->fûíame), "%s", 
c˝å
) ;

2349 
	`LSF_SNPRINTF
 (
psf
->
dúe˘‹y
,  (psf->dúe˘‹y), "%s", 
∑th
) ;

2350 i‡((
˝å
 = 
	`°ºchr
 (
psf
->
dúe˘‹y
, '/')) || (cptr = strrchr (psf->directory, '\\')))

2351 
˝å
 [1] = 0 ;

2353 
psf
->
dúe˘‹y
 [0] = 0 ;

2356 
	}
}

2362 
	$psf_˛o£
 (
SF_PRIVATE
 *
psf
)

2363 { 
îr‹
 ;

2365 i‡(
psf
->
codec_˛o£
)

2366 
îr‹
 = 
psf
->
	`codec_˛o£
 (psf) ;

2367 i‡(
psf
->
c⁄èöî_˛o£
)

2368 
îr‹
 = 
psf
->
	`c⁄èöî_˛o£
 (psf) ;

2370 
	`psf_f˛o£
 (
psf
) ;

2371 
	`psf_˛o£_r§c
 (
psf
) ;

2373 i‡(
psf
->
c⁄èöî_d©a
)

2374 
	`‰ì
 (
psf
->
c⁄èöî_d©a
) ;

2376 i‡(
psf
->
codec_d©a
)

2377 
	`‰ì
 (
psf
->
codec_d©a
) ;

2379 i‡(
psf
->
öãæóve
)

2380 
	`‰ì
 (
psf
->
öãæóve
) ;

2382 i‡(
psf
->
dôhî
)

2383 
	`‰ì
 (
psf
->
dôhî
) ;

2385 i‡(
psf
->
≥ak_öfo
)

2386 
	`‰ì
 (
psf
->
≥ak_öfo
) ;

2388 i‡(
psf
->
brﬂdˇ°_öfo
)

2389 
	`‰ì
 (
psf
->
brﬂdˇ°_öfo
) ;

2391 i‡(
psf
->
lo›_öfo
)

2392 
	`‰ì
 (
psf
->
lo›_öfo
) ;

2394 i‡(
psf
->
ö°rumít
)

2395 
	`‰ì
 (
psf
->
ö°rumít
) ;

2397 i‡(
psf
->
ch™√l_m≠
)

2398 
	`‰ì
 (
psf
->
ch™√l_m≠
) ;

2400 i‡(
psf
->
f‹m©_desc
)

2401 { 
	`mem£t
 (
psf
->
f‹m©_desc
, 0, 
	`°æí
 (psf->format_desc)) ;

2402 
	`‰ì
 (
psf
->
f‹m©_desc
) ;

2405 
	`mem£t
 (
psf
, 0,  (
SF_PRIVATE
)) ;

2406 
	`‰ì
 (
psf
) ;

2409 
	}
}

2412 
	$psf_›í_fûe
 (
SF_PRIVATE
 *
psf
, 
mode
, 
SF_INFO
 *
sföfo
)

2413 { 
îr‹
, 
f‹m©
 ;

2415 i‡(
mode
 !
SFM_READ
 && modê!
SFM_WRITE
 && modê!
SFM_RDWR
)

2416  
SFE_BAD_OPEN_MODE
 ;

2418 i‡(
sföfo
 =
NULL
)

2419  
SFE_BAD_SF_INFO_PTR
 ;

2422 
sföfo
->
‰ames
 = 0 ;

2423 
sföfo
->
£˘i⁄s
 = 0 ;

2424 
sföfo
->
£ekabÀ
 = 0 ;

2426 i‡(
mode
 =
SFM_READ
)

2427 { i‡((
sföfo
->
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_RAW
)

2428 { i‡(
	`sf_f‹m©_check
 (
sföfo
) == 0)

2429  
SFE_RAW_BAD_FORMAT
 ;

2432 
	`mem£t
 (
sföfo
, 0,  (
SF_INFO
)) ;

2435 
sf_î∫o
 = 
îr‹
 = 0 ;

2436 
sf_logbuf„r
 [0] = 0 ;

2438 
	`mem˝y
 (&(
psf
->
sf
), 
sföfo
,  (
SF_INFO
)) ;

2440 
psf
->
Magick
 = 
SNDFILE_MAGICK
 ;

2441 
psf
->
n‹m_Êﬂt
 = 
SF_TRUE
 ;

2442 
psf
->
n‹m_doubÀ
 = 
SF_TRUE
 ;

2443 
psf
->
mode
 = mode ;

2444 
psf
->
d©aoff£t
 = -1 ;

2445 
psf
->
d©Æígth
 = -1 ;

2446 
psf
->
ªad_cuºít
 = -1 ;

2447 
psf
->
wrôe_cuºít
 = -1 ;

2448 
psf
->
auto_hódî
 = 
SF_FALSE
 ;

2449 
psf
->
rwf_ídün
 = 
SF_ENDIAN_LITTLE
 ;

2450 
psf
->
£ek
 = 
psf_deÁu…_£ek
 ;

2451 
psf
->
Êﬂt_öt_mu…
 = 0 ;

2452 
psf
->
Êﬂt_max
 = -1.0 ;

2454 
psf
->
sf
.
£˘i⁄s
 = 1 ;

2456 
psf
->
is_pùe
 = 
	`psf_is_pùe
 (psf) ;

2458 i‡(
psf
->
is_pùe
)

2459 { 
psf
->
sf
.
£ekabÀ
 = 
SF_FALSE
 ;

2460 
psf
->
fûñígth
 = 
SF_COUNT_MAX
 ;

2463 { 
psf
->
sf
.
£ekabÀ
 = 
SF_TRUE
 ;

2466 
psf
->
fûñígth
 = 
	`psf_gë_fûñí
 (psf) ;

2469 i‡(
psf
->
fûeoff£t
 > 0)

2470 { 
psf
->
mode
)

2471 { 
SFM_READ
 :

2472 i‡(
psf
->
fûñígth
 < 44)

2473 { 
	`psf_log_¥ötf
 (
psf
, "Sh‹àfûñígth: %D (fûeoff£t: %D)\n",Ösf->
fûñígth
,Ösf->
fûeoff£t
) ;

2474  
SFE_BAD_OFFSET
 ;

2478 
SFM_WRITE
 :

2479 
psf
->
fûeoff£t
 = 0 ;

2480 
	`psf_f£ek
 (
psf
, 0, 
SEEK_END
) ;

2481 
psf
->
fûeoff£t
 = 
	`psf_·ñl
 (psf) ;

2484 
SFM_RDWR
 :

2485  
SFE_NO_EMBEDDED_RDWR
 ;

2488 
	`psf_log_¥ötf
 (
psf
, "Embedded fûêoff£à: %D\n",Ösf->
fûeoff£t
) ;

2491 i‡(
psf
->
fûñígth
 =
SF_COUNT_MAX
)

2492 
	`psf_log_¥ötf
 (
psf
, "Length : unknown\n") ;

2494 
	`psf_log_¥ötf
 (
psf
, "Lígth : %D\n",Ösf->
fûñígth
) ;

2496 i‡(
mode
 =
SFM_WRITE
 || (modê=
SFM_RDWR
 && 
psf
->
fûñígth
 == 0))

2500 i‡(
	`sf_f‹m©_check
 (&(
psf
->
sf
)) == 0)

2501  
SFE_BAD_OPEN_FORMAT
 ;

2503 i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

2505 
psf
->
sf
.
f‹m©
 = 
	`guess_fûe_ty≥
 (psf) ;

2507 i‡(
psf
->
sf
.
f‹m©
 == 0)

2508 
psf
->
sf
.
f‹m©
 = 
	`f‹m©_‰om_exãnsi⁄
 (psf) ;

2512 
psf
->
œ°_›
 =Ösf->
mode
 ;

2515 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
)

2516 { 
SF_FORMAT_PCM_S8
 :

2517 
SF_FORMAT_PCM_U8
 :

2518 
SF_FORMAT_ULAW
 :

2519 
SF_FORMAT_ALAW
 :

2520 
SF_FORMAT_DPCM_8
 :

2521 
psf
->
byãwidth
 = 1 ;

2524 
SF_FORMAT_PCM_16
 :

2525 
SF_FORMAT_DPCM_16
 :

2526 
psf
->
byãwidth
 = 2 ;

2529 
SF_FORMAT_PCM_24
 :

2530 
psf
->
byãwidth
 = 3 ;

2533 
SF_FORMAT_PCM_32
 :

2534 
SF_FORMAT_FLOAT
 :

2535 
psf
->
byãwidth
 = 4 ;

2538 
SF_FORMAT_DOUBLE
 :

2539 
psf
->
byãwidth
 = 8 ;

2544 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
)

2545 { 
SF_FORMAT_WAV
 :

2546 
SF_FORMAT_WAVEX
 :

2547 
îr‹
 = 
	`wav_›í
 (
psf
) ;

2550 
SF_FORMAT_AIFF
 :

2551 
îr‹
 = 
	`aiff_›í
 (
psf
) ;

2554 
SF_FORMAT_AU
 :

2555 
îr‹
 = 
	`au_›í
 (
psf
) ;

2558 
SF_FORMAT_RAW
 :

2559 
îr‹
 = 
	`øw_›í
 (
psf
) ;

2562 
SF_FORMAT_W64
 :

2563 
îr‹
 = 
	`w64_›í
 (
psf
) ;

2567 
SF_FORMAT_PAF
 :

2568 
îr‹
 = 
	`∑f_›í
 (
psf
) ;

2571 
SF_FORMAT_SVX
 :

2572 
îr‹
 = 
	`svx_›í
 (
psf
) ;

2575 
SF_FORMAT_NIST
 :

2576 
îr‹
 = 
	`ni°_›í
 (
psf
) ;

2579 
SF_FORMAT_IRCAM
 :

2580 
îr‹
 = 
	`úˇm_›í
 (
psf
) ;

2583 
SF_FORMAT_VOC
 :

2584 
îr‹
 = 
	`voc_›í
 (
psf
) ;

2587 
SF_FORMAT_SDS
 :

2588 
îr‹
 = 
	`sds_›í
 (
psf
) ;

2591 
SF_FORMAT_OGG
 :

2592 
îr‹
 = 
	`ogg_›í
 (
psf
) ;

2595 
SF_FORMAT_TXW
 :

2596 
îr‹
 = 
	`txw_›í
 (
psf
) ;

2599 
SF_FORMAT_WVE
 :

2600 
îr‹
 = 
	`wve_›í
 (
psf
) ;

2603 
SF_FORMAT_DWD
 :

2604 
îr‹
 = 
	`dwd_›í
 (
psf
) ;

2607 
SF_FORMAT_MAT4
 :

2608 
îr‹
 = 
	`m©4_›í
 (
psf
) ;

2611 
SF_FORMAT_MAT5
 :

2612 
îr‹
 = 
	`m©5_›í
 (
psf
) ;

2615 
SF_FORMAT_PVF
 :

2616 
îr‹
 = 
	`pvf_›í
 (
psf
) ;

2619 
SF_FORMAT_XI
 :

2620 
îr‹
 = 
	`xi_›í
 (
psf
) ;

2623 
SF_FORMAT_HTK
 :

2624 
îr‹
 = 
	`htk_›í
 (
psf
) ;

2627 
SF_FORMAT_SD2
 :

2628 
îr‹
 = 
	`sd2_›í
 (
psf
) ;

2631 
SF_FORMAT_REX2
 :

2632 
îr‹
 = 
	`rx2_›í
 (
psf
) ;

2635 
SF_FORMAT_AVR
 :

2636 
îr‹
 = 
	`avr_›í
 (
psf
) ;

2639 
SF_FORMAT_FLAC
 :

2640 
îr‹
 = 
	`Êac_›í
 (
psf
) ;

2643 
SF_FORMAT_CAF
 :

2644 
îr‹
 = 
	`ˇf_›í
 (
psf
) ;

2650 
îr‹
 = 
SFE_UNKNOWN_FORMAT
 ;

2653 i‡(
îr‹
)

2654 { 
îr‹
)

2655 { 
SF_ERR_SYSTEM
 :

2656 
SF_ERR_UNSUPPORTED_ENCODING
 :

2657 
SFE_UNIMPLEMENTED
 :

2661 
	`psf_log_¥ötf
 (
psf
, "P¨£Éº‹ : %s\n", 
	`sf_îr‹_numbî
 (
îr‹
)) ;

2662 
îr‹
 = 
SF_ERR_MALFORMED_FILE
 ;

2665  
îr‹
 ;

2669 
f‹m©
 = 
psf
->
sf
.f‹m© & 
SF_FORMAT_TYPEMASK
 ;

2670 i‡(
psf
->
fûeoff£t
 > 0 &&

2671 (
f‹m©
 !
SF_FORMAT_WAV
Ë&& (f‹m© !
SF_FORMAT_WAVEX
) &&

2672 (
f‹m©
 !
SF_FORMAT_AIFF
Ë&& (f‹m© !
SF_FORMAT_AU
)

2674  
SFE_NO_EMBED_SUPPORT
 ;

2676 i‡(
psf
->
fûeoff£t
 > 0)

2677 
	`psf_log_¥ötf
 (
psf
, "Embedded fûêÀngth : %D\n",Ösf->
fûñígth
) ;

2679 i‡(
mode
 =
SFM_RDWR
 && 
	`sf_f‹m©_check
 (&(
psf
->
sf
)) == 0)

2680  
SFE_BAD_RDWR_FORMAT
 ;

2682 i‡(
	`vÆid©e_sföfo
 (&(
psf
->
sf
)) == 0)

2683 { 
	`psf_log_SF_INFO
 (
psf
) ;

2684 
	`ßve_hódî_öfo
 (
psf
) ;

2685  
SFE_BAD_SF_INFO
 ;

2688 i‡(
	`vÆid©e_psf
 (
psf
) == 0)

2689 { 
	`ßve_hódî_öfo
 (
psf
) ;

2690  
SFE_INTERNAL
 ;

2693 
psf
->
ªad_cuºít
 = 0 ;

2694 
psf
->
wrôe_cuºít
 = (psf->
mode
 =
SFM_RDWR
Ë?Ösf->
sf
.
‰ames
 : 0 ;

2696 
	`mem˝y
 (
sföfo
, &(
psf
->
sf
),  (
SF_INFO
)) ;

2699 
	}
}

	@libsndfile-1.0.17/src/strings.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°rög.h
>

23 
	~<m©h.h
>

25 
	~"¢dfûe.h
"

26 
	~"comm⁄.h
"

28 
	#STRINGS_DEBUG
 0

	)

29 #i‡
STRINGS_DEBUG


30 
hexdump
 (*
d©a
, 
Àn
) ;

34 
	$psf_°‹e_°rög
 (
SF_PRIVATE
 *
psf
, 
°r_ty≥
, c⁄° *
°r
)

35 { 
lsf_«me
 [] = 
PACKAGE
 "-" 
VERSION
 ;

36 
bøckë_«me
 [] = " (" 
PACKAGE
 "-" 
VERSION
 ")" ;

37 
k
, 
°r_Àn
, 
Àn_ªmaöög
, 
°r_Êags
 ;

39 i‡(
°r
 =
NULL
)

40  
SFE_STR_BAD_STRING
 ;

42 
°r_Àn
 = 
	`°æí
 (
°r
) ;

45 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

46 { i‡((
psf
->
°r_Êags
 & 
SF_STR_ALLOW_START
) == 0)

47  
SFE_STR_NO_SUPPORT
 ;

48 i‡((
psf
->
°r_Êags
 & 
SF_STR_ALLOW_END
) == 0)

49  
SFE_STR_NO_SUPPORT
 ;

51 i‡(
°r_ty≥
 !
SF_STR_SOFTWARE
 && 
°r_Àn
 == 0)

52  
SFE_STR_BAD_STRING
 ;

56 
°r_Êags
 = 
SF_STR_LOCATE_START
 ;

57 i‡(
psf
->
have_wrôãn
)

58 { i‡((
psf
->
°r_Êags
 & 
SF_STR_ALLOW_END
) == 0)

59  
SFE_STR_NO_ADD_END
 ;

60 
°r_Êags
 = 
SF_STR_LOCATE_END
 ;

64 
k
 = 0 ; k < 
SF_MAX_STRINGS
 ; k++)

65 i‡(
psf
->
°rögs
 [
k
].
ty≥
 == 0)

69 i‡(
k
 >
SF_MAX_STRINGS
)

70  
SFE_STR_MAX_COUNT
 ;

72 i‡(
k
 =0 && 
psf
->
°r_íd
 !
NULL
)

73 { 
	`psf_log_¥ötf
 (
psf
, "SFE_STR_WEIRD : k == 0 &&Ösf->str_end != NULL\n") ;

74  
SFE_STR_WEIRD
 ;

77 i‡(
k
 !0 && 
psf
->
°r_íd
 =
NULL
)

78 { 
	`psf_log_¥ötf
 (
psf
, "SFE_STR_WEIRD : k != 0 &&Ösf->str_end == NULL\n") ;

79  
SFE_STR_WEIRD
 ;

83 i‡(
k
 == 0)

84 
psf
->
°r_íd
 =Ösf->
°r_°‹age
 ;

87 #i‡
STRINGS_DEBUG


88 
	`psf_log_¥ötf
 (
psf
, "°r_°‹agê : %X\n", (Ëpsf->
°r_°‹age
) ;

89 
	`psf_log_¥ötf
 (
psf
, "°r_íd : %X\n", (Ëpsf->
°r_íd
) ;

90 
	`psf_log_¥ötf
 (
psf
, "sizeo‡(°r_°‹ageË: %d\n", 
	`SIGNED_SIZEOF
 (psf->
°r_°‹age
)) ;

93 
Àn_ªmaöög
 = 
	`SIGNED_SIZEOF
 (
psf
->
°r_°‹age
Ë- (psf->
°r_íd
 -Ösf->str_storage) ;

95 i‡(
Àn_ªmaöög
 < 
°r_Àn
 + 2)

96  
SFE_STR_MAX_DATA
 ;

98 
°r_ty≥
)

99 { 
SF_STR_SOFTWARE
 :

101 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

102 { 
psf
->
°rögs
 [
k
].
ty≥
 = 
°r_ty≥
 ;

103 
psf
->
°rögs
 [
k
].
°r
 =Ösf->
°r_íd
 ;

104 
psf
->
°rögs
 [
k
].
Êags
 = 
°r_Êags
 ;

106 
	`mem˝y
 (
psf
->
°r_íd
, 
°r
, 
°r_Àn
 + 1) ;

107 
psf
->
°r_íd
 +
°r_Àn
 ;

113 i‡(
	`°r°r
 (
°r
, 
PACKAGE
Ë=
NULL
 && 
Àn_ªmaöög
 > (Ë(
	`°æí
 (
bøckë_«me
Ë+ 
°r_Àn
 + 2))

114 { i‡(
	`°æí
 (
°r
) == 0)

115 
	`°∫ˇt
 (
psf
->
°r_íd
, 
lsf_«me
, 
Àn_ªmaöög
) ;

117 
	`°∫ˇt
 (
psf
->
°r_íd
, 
bøckë_«me
, 
Àn_ªmaöög
) ;

118 
psf
->
°r_íd
 +
	`°æí
 (psf->str_end) ;

122 
psf
->
°r_íd
 += 1 ;

128 
SF_STR_TITLE
 :

129 
SF_STR_COPYRIGHT
 :

130 
SF_STR_ARTIST
 :

131 
SF_STR_COMMENT
 :

132 
SF_STR_DATE
 :

133 
psf
->
°rögs
 [
k
].
ty≥
 = 
°r_ty≥
 ;

134 
psf
->
°rögs
 [
k
].
°r
 =Ösf->
°r_íd
 ;

135 
psf
->
°rögs
 [
k
].
Êags
 = 
°r_Êags
 ;

138 
	`mem˝y
 (
psf
->
°r_íd
, 
°r
, 
°r_Àn
 + 1) ;

139 
psf
->
°r_íd
 +
°r_Àn
 + 1 ;

143  
SFE_STR_BAD_TYPE
 ;

146 
psf
->
°r_Êags
 |’sf->
have_wrôãn
Ë? 
SF_STR_LOCATE_END
 : 
SF_STR_LOCATE_START
 ;

148 #i‡
STRINGS_DEBUG


149 
	`hexdump
 (
psf
->
°r_°‹age
, 300) ;

153 
	}
}

156 
	$psf_£t_°rög
 (
SF_PRIVATE
 *
psf
, 
°r_ty≥
, c⁄° *
°r
)

157 { i‡(
psf
->
mode
 =
SFM_READ
)

158  
SFE_STR_NOT_WRITE
 ;

160  
	`psf_°‹e_°rög
 (
psf
, 
°r_ty≥
, 
°r
) ;

161 
	}
}

164 
	$psf_gë_°rög
 (
SF_PRIVATE
 *
psf
, 
°r_ty≥
)

165 { 
k
 ;

167 
k
 = 0 ; k < 
SF_MAX_STRINGS
 ; k++)

168 i‡(
°r_ty≥
 =
psf
->
°rögs
 [
k
].
ty≥
)

169  
psf
->
°rögs
 [
k
].
°r
 ;

171  
NULL
 ;

172 
	}
}

174 #i‡
STRINGS_DEBUG


176 
	~<˘y≥.h
>

178 
	$hexdump
 (*
d©a
, 
Àn
)

179 { *
±r
 ;

180 
k
 ;

182 
±r
 = 
d©a
 ;

184 
	`puts
 ("---------------------------------------------------------") ;

185 
Àn
 >= 16)

186 { 
k
 = 0 ; k < 16 ; k++)

187 
	`¥ötf
 ("%02X ", 
±r
 [
k
] & 0xFF) ;

188 
	`¥ötf
 (" ") ;

189 
k
 = 0 ; k < 16 ; k++)

190 
	`¥ötf
 ("%c", 
	`i•röt
 (
±r
 [
k
]) ?Ötr [k] : '.') ;

191 
	`puts
 ("") ;

192 
±r
 += 16 ;

193 
Àn
 -= 16 ;

195 
	}
}

	@libsndfile-1.0.17/src/svx.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°rög.h
>

23 
	~<˘y≥.h
>

24 
	~<°d¨g.h
>

26 
	~"¢dfûe.h
"

27 
	~"s„ndün.h
"

28 
	~"comm⁄.h
"

35 
	#FORM_MARKER
 (
	`MAKE_MARKER
 ('F', 'O', 'R', 'M'))

	)

36 
	#SVX8_MARKER
 (
	`MAKE_MARKER
 ('8', 'S', 'V', 'X'))

	)

37 
	#SV16_MARKER
 (
	`MAKE_MARKER
 ('1', '6', 'S', 'V'))

	)

38 
	#VHDR_MARKER
 (
	`MAKE_MARKER
 ('V', 'H', 'D', 'R'))

	)

39 
	#BODY_MARKER
 (
	`MAKE_MARKER
 ('B', 'O', 'D', 'Y'))

	)

41 
	#ATAK_MARKER
 (
	`MAKE_MARKER
 ('A', 'T', 'A', 'K'))

	)

42 
	#RLSE_MARKER
 (
	`MAKE_MARKER
 ('R', 'L', 'S', 'E'))

	)

44 
	#c_MARKER
 (
	`MAKE_MARKER
 ('(', 'c', ')', ' '))

	)

45 
	#NAME_MARKER
 (
	`MAKE_MARKER
 ('N', 'A', 'M', 'E'))

	)

46 
	#AUTH_MARKER
 (
	`MAKE_MARKER
 ('A', 'U', 'T', 'H'))

	)

47 
	#ANNO_MARKER
 (
	`MAKE_MARKER
 ('A', 'N', 'N', 'O'))

	)

48 
	#CHAN_MARKER
 (
	`MAKE_MARKER
 ('C', 'H', 'A', 'N'))

	)

55 { 
	m⁄eShŸHiSam∂es
, 
	mª≥©HiSam∂es
, 
	mßm∂esPîHiCy˛e
 ;

56 
	mßm∂esPîSec
 ;

57 
	mo˘ave
, 
	mcom¥essi⁄
 ;

58 
	mvﬁume
 ;

59 } 
	tVHDR_CHUNK
 ;

62 
	mHAVE_FORM
 = 0x01,

64 
	mHAVE_SVX
 = 0x02,

65 
	mHAVE_VHDR
 = 0x04,

66 
	mHAVE_BODY
 = 0x08

73 
svx_˛o£
 (
SF_PRIVATE
 *
psf
) ;

74 
svx_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
) ;

75 
svx_ªad_hódî
 (
SF_PRIVATE
 *
psf
) ;

82 
	$svx_›í
 (
SF_PRIVATE
 *
psf
)

83 { 
îr‹
 ;

85 i‡(
psf
->
mode
 =
SFM_READ
 || (psf->modê=
SFM_RDWR
 &&Ösf->
fûñígth
 > 0))

86 { i‡((
îr‹
 = 
	`svx_ªad_hódî
 (
psf
)))

87  
îr‹
 ;

89 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

91 
psf
->
blockwidth
 =Ösf->
sf
.
ch™√ls
 *Ösf->
byãwidth
 ;

92 i‡(
psf
->
blockwidth
)

93 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 /Ösf->
blockwidth
 ;

95 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
, 
SEEK_SET
) ;

98 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

99 { i‡(
psf
->
is_pùe
)

100  
SFE_NO_PIPE_WRITE
 ;

102 i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_SVX
)

103  
SFE_BAD_OPEN_FORMAT
 ;

105 
psf
->
ídün
 =Ösf->
sf
.
f‹m©
 & 
SF_FORMAT_ENDMASK
 ;

107 i‡(
psf
->
ídün
 =
SF_ENDIAN_LITTLE
 || (
CPU_IS_LITTLE_ENDIAN
 &&Ösf->ídü¿=
SF_ENDIAN_CPU
))

108  
SFE_BAD_ENDIAN
 ;

110 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

112 
îr‹
 = 
	`svx_wrôe_hódî
 (
psf
, 
SF_FALSE
) ;

113 i‡(
îr‹
)

114  
îr‹
 ;

116 
psf
->
wrôe_hódî
 = 
svx_wrôe_hódî
 ;

119 
psf
->
c⁄èöî_˛o£
 = 
svx_˛o£
 ;

121 i‡((
îr‹
 = 
	`pcm_öô
 (
psf
)))

122  
îr‹
 ;

125 
	}
}

131 
	$svx_ªad_hódî
 (
SF_PRIVATE
 *
psf
)

132 { 
VHDR_CHUNK
 
vhdr
 ;

133 
FORMsize
, 
vhdrsize
, 
dw‹d
, 
m¨kî
 ;

134 
fûëy≥
 = 0, 
∑r£°age
 = 0, 
d⁄e
 = 0 ;

135 
byãcou¡
 = 0, 
ch™√ls
 ;

137 
	`mem£t
 (&
vhdr
, 0,  (vhdr)) ;

138 
	`psf_böhódî_ªadf
 (
psf
, "p", 0) ;

141 
psf
->
sf
.
ch™√ls
 = 1 ;

143 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_SVX
 ;

145 ! 
d⁄e
)

146 { 
	`psf_böhódî_ªadf
 (
psf
, "m", &
m¨kî
) ;

147 
m¨kî
)

148 { 
FORM_MARKER
 :

149 i‡(
∑r£°age
)

150  
SFE_SVX_NO_FORM
 ;

152 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
FORMsize
) ;

154 i‡(
FORMsize
 !
psf
->
fûñígth
 - 2 *  (
dw‹d
))

155 { 
dw‹d
 = 
psf
->
fûñígth
 - 2 *  (dword) ;

156 
	`psf_log_¥ötf
 (
psf
, "FORM : %d (should bê%d)\n", 
FORMsize
, 
dw‹d
) ;

157 
FORMsize
 = 
dw‹d
 ;

160 
	`psf_log_¥ötf
 (
psf
, "FORM : %d\n", 
FORMsize
) ;

161 
∑r£°age
 |
HAVE_FORM
 ;

164 
SVX8_MARKER
 :

165 
SV16_MARKER
 :

166 i‡(! (
∑r£°age
 & 
HAVE_FORM
))

167  
SFE_SVX_NO_FORM
 ;

168 
fûëy≥
 = 
m¨kî
 ;

169 
	`psf_log_¥ötf
 (
psf
, " %M\n", 
m¨kî
) ;

170 
∑r£°age
 |
HAVE_SVX
 ;

173 
VHDR_MARKER
 :

174 i‡(! (
∑r£°age
 & (
HAVE_FORM
 | 
HAVE_SVX
)))

175  
SFE_SVX_NO_FORM
 ;

177 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
vhdrsize
) ;

179 
	`psf_log_¥ötf
 (
psf
, " VHDR : %d\n", 
vhdrsize
) ;

181 
	`psf_böhódî_ªadf
 (
psf
, "E4442114", &(
vhdr
.
⁄eShŸHiSam∂es
), &(vhdr.
ª≥©HiSam∂es
),

182 &(
vhdr
.
ßm∂esPîHiCy˛e
), &(vhdr.
ßm∂esPîSec
), &(vhdr.
o˘ave
), &(vhdr.
com¥essi⁄
),

183 &(
vhdr
.
vﬁume
)) ;

185 
	`psf_log_¥ötf
 (
psf
, " O√ShŸHiSam∂e† : %d\n", 
vhdr
.
⁄eShŸHiSam∂es
) ;

186 
	`psf_log_¥ötf
 (
psf
, " RïótHiSam∂e† : %d\n", 
vhdr
.
ª≥©HiSam∂es
) ;

187 
	`psf_log_¥ötf
 (
psf
, " sam∂esPîHiCy˛ê: %d\n", 
vhdr
.
ßm∂esPîHiCy˛e
) ;

188 
	`psf_log_¥ötf
 (
psf
, " Sam∂êR©ê : %d\n", 
vhdr
.
ßm∂esPîSec
) ;

189 
	`psf_log_¥ötf
 (
psf
, " O˘avê : %d\n", 
vhdr
.
o˘ave
) ;

191 
	`psf_log_¥ötf
 (
psf
, " Com¥essi⁄ : %d => ", 
vhdr
.
com¥essi⁄
) ;

193 
vhdr
.
com¥essi⁄
)

194 { 0 : 
	`psf_log_¥ötf
 (
psf
, "None.\n") ;

196 1 : 
	`psf_log_¥ötf
 (
psf
, "Fibonacci delta\n") ;

198 2 : 
	`psf_log_¥ötf
 (
psf
, "Exponential delta\n") ;

202 
	`psf_log_¥ötf
 (
psf
, " Vﬁumê : %d\n", 
vhdr
.
vﬁume
) ;

204 
psf
->
sf
.
ßm∂î©e
 = 
vhdr
.
ßm∂esPîSec
 ;

206 i‡(
fûëy≥
 =
SVX8_MARKER
)

207 { 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_PCM_S8
 ;

208 
psf
->
byãwidth
 = 1 ;

210 i‡(
fûëy≥
 =
SV16_MARKER
)

211 { 
psf
->
sf
.
f‹m©
 |
SF_FORMAT_PCM_16
 ;

212 
psf
->
byãwidth
 = 2 ;

215 
∑r£°age
 |
HAVE_VHDR
 ;

218 
BODY_MARKER
 :

219 i‡(! (
∑r£°age
 & 
HAVE_VHDR
))

220  
SFE_SVX_NO_BODY
 ;

222 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
dw‹d
) ;

223 
psf
->
d©Æígth
 = 
dw‹d
 ;

225 
psf
->
d©aoff£t
 = 
	`psf_·ñl
 (psf) ;

227 i‡(
psf
->
d©Æígth
 >Ösf->
fûñígth
 -Ösf->
d©aoff£t
)

228 { 
	`psf_log_¥ötf
 (
psf
, " BODY : %D (should bê%D)\n",Ösf->
d©Æígth
,Ösf->
fûñígth
 -Ösf->
d©aoff£t
) ;

229 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

232 
	`psf_log_¥ötf
 (
psf
, " BODY : %D\n",Ösf->
d©Æígth
) ;

234 
∑r£°age
 |
HAVE_BODY
 ;

236 i‡(! 
psf
->
sf
.
£ekabÀ
)

239 
	`psf_f£ek
 (
psf
,Ösf->
d©Æígth
, 
SEEK_CUR
) ;

242 
NAME_MARKER
 :

243 i‡(! (
∑r£°age
 & 
HAVE_SVX
))

244  
SFE_SVX_NO_FORM
 ;

246 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
dw‹d
) ;

248 
	`psf_log_¥ötf
 (
psf
, " %M : %d\n", 
m¨kî
, 
dw‹d
) ;

250 i‡(
	`°æí
 (
psf
->
fûíame
Ë!
dw‹d
)

251 { i‡(
dw‹d
 >  (
psf
->
fûíame
) - 1)

252  
SFE_SVX_BAD_NAME_LENGTH
 ;

254 
	`psf_böhódî_ªadf
 (
psf
, "b",Ösf->
fûíame
, 
dw‹d
) ;

255 
psf
->
fûíame
 [
dw‹d
] = 0 ;

258 
	`psf_böhódî_ªadf
 (
psf
, "j", 
dw‹d
) ;

261 
ANNO_MARKER
 :

262 i‡(! (
∑r£°age
 & 
HAVE_SVX
))

263  
SFE_SVX_NO_FORM
 ;

265 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
dw‹d
) ;

267 
	`psf_log_¥ötf
 (
psf
, " %M : %d\n", 
m¨kî
, 
dw‹d
) ;

269 
	`psf_böhódî_ªadf
 (
psf
, "j", 
dw‹d
) ;

272 
CHAN_MARKER
 :

273 i‡(! (
∑r£°age
 & 
HAVE_SVX
))

274  
SFE_SVX_NO_FORM
 ;

276 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
dw‹d
) ;

278 
	`psf_log_¥ötf
 (
psf
, " %M : %d\n", 
m¨kî
, 
dw‹d
) ;

280 
byãcou¡
 +
	`psf_böhódî_ªadf
 (
psf
, "E4", &
ch™√ls
) ;

281 
psf
->
sf
.
ch™√ls
 = channels ;

283 
	`psf_log_¥ötf
 (
psf
, " Ch™√l†: %d\n", 
ch™√ls
) ;

285 
	`psf_böhódî_ªadf
 (
psf
, "j", 
dw‹d
 - 
byãcou¡
) ;

289 
AUTH_MARKER
 :

290 
c_MARKER
 :

291 i‡(! (
∑r£°age
 & 
HAVE_SVX
))

292  
SFE_SVX_NO_FORM
 ;

294 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
dw‹d
) ;

296 
	`psf_log_¥ötf
 (
psf
, " %M : %d\n", 
m¨kî
, 
dw‹d
) ;

298 
	`psf_böhódî_ªadf
 (
psf
, "j", 
dw‹d
) ;

302 i‡(
	`i•röt
 ((
m¨kî
 >> 24) & 0xFF) && isprint ((marker >> 16) & 0xFF)

303 && 
	`i•röt
 ((
m¨kî
 >> 8) & 0xFF) && isprint (marker & 0xFF))

304 { 
	`psf_böhódî_ªadf
 (
psf
, "E4", &
dw‹d
) ;

306 
	`psf_log_¥ötf
 (
psf
, "%M : %d (unknow¿m¨kî)\n", 
m¨kî
, 
dw‹d
) ;

308 
	`psf_böhódî_ªadf
 (
psf
, "j", 
dw‹d
) ;

311 i‡((
dw‹d
 = 
	`psf_·ñl
 (
psf
)) & 0x03)

312 { 
	`psf_log_¥ötf
 (
psf
, " Unknow¿chunk m¨kîáàposôi⁄ %d. Resynchög.\n", 
dw‹d
 - 4) ;

314 
	`psf_böhódî_ªadf
 (
psf
, "j", -3) ;

317 
	`psf_log_¥ötf
 (
psf
, "*** Unknow¿chunk m¨kî : %X. ExôögÖ¨£r.\n", 
m¨kî
) ;

318 
d⁄e
 = 1 ;

321 i‡(! 
psf
->
sf
.
£ekabÀ
 && (
∑r£°age
 & 
HAVE_BODY
))

324 i‡(
	`psf_·ñl
 (
psf
Ë>psf->
fûñígth
 - 
	`SIGNED_SIZEOF
 (
dw‹d
))

328 i‡(
vhdr
.
com¥essi⁄
)

329  
SFE_SVX_BAD_COMP
 ;

331 i‡(
psf
->
d©aoff£t
 <= 0)

332  
SFE_SVX_NO_DATA
 ;

335 
	}
}

338 
	$svx_˛o£
 (
SF_PRIVATE
 *
psf
)

340 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

341 
	`svx_wrôe_hódî
 (
psf
, 
SF_TRUE
) ;

344 
	}
}

347 
	$svx_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
)

348 { 
™nŸ©i⁄
 [] = "libsndfile by Erik de Castro Lopo\0\0\0" ;

349 
sf_cou¡_t
 
cuºít
 ;

351 
cuºít
 = 
	`psf_·ñl
 (
psf
) ;

353 i‡(
ˇlc_Àngth
)

354 { 
psf
->
fûñígth
 = 
	`psf_gë_fûñí
 (psf) ;

356 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

358 i‡(
psf
->
d©´nd
)

359 
psf
->
d©Æígth
 -psf->
fûñígth
 -Ösf->
d©´nd
 ;

361 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 / (psf->
byãwidth
 *Ösf->sf.
ch™√ls
) ;

364 
psf
->
hódî
 [0] = 0 ;

365 
psf
->
hódödex
 = 0 ;

366 
	`psf_f£ek
 (
psf
, 0, 
SEEK_SET
) ;

369 
	`psf_böhódî_wrôef
 (
psf
, "Etm8", 
FORM_MARKER
, (psf->
fûñígth
 < 8) ?

370 
psf
->
fûñígth
 * 0 :Ösf->filelength - 8) ;

372 
	`psf_böhódî_wrôef
 (
psf
, "m", (psf->
byãwidth
 =1Ë? 
SVX8_MARKER
 : 
SV16_MARKER
) ;

375 
	`psf_böhódî_wrôef
 (
psf
, "Em4", 
VHDR_MARKER
,  (
VHDR_CHUNK
)) ;

377 
	`psf_böhódî_wrôef
 (
psf
, "E444",Ösf->
sf
.
‰ames
, 0, 0) ;

379 
	`psf_böhódî_wrôef
 (
psf
, "E211",Ösf->
sf
.
ßm∂î©e
, 1, 0) ;

381 
	`psf_böhódî_wrôef
 (
psf
, "E4", (psf->
byãwidth
 == 1) ? 0xFF : 0xFFFF) ;

384 
	`psf_böhódî_wrôef
 (
psf
, "Emsms", 
NAME_MARKER
,Ösf->
fûíame
, 
ANNO_MARKER
, 
™nŸ©i⁄
) ;

387 
	`psf_böhódî_wrôef
 (
psf
, "Etm8", 
BODY_MARKER
, (psf->
d©Æígth
 < 0) ?

388 
psf
->
d©Æígth
 * 0 :Ösf->datalength) ;

390 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

392 i‡(
psf
->
îr‹
)

393  
psf
->
îr‹
 ;

395 
psf
->
d©aoff£t
 =Ösf->
hódödex
 ;

397 i‡(
cuºít
 > 0)

398 
	`psf_f£ek
 (
psf
, 
cuºít
, 
SEEK_SET
) ;

400  
psf
->
îr‹
 ;

401 
	}
}

	@libsndfile-1.0.17/src/test_endswap.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

24 #i‡
HAVE_UNISTD_H


25 
	~<uni°d.h
>

28 
	~<°rög.h
>

29 
	~<î∫o.h
>

31 
	~"comm⁄.h
"

32 
	~"s„ndün.h
"

34 
	#FMT_SHORT
 "0x%04x\n"

	)

35 
	#FMT_INT
 "0x%08x\n"

	)

37 #i‡
SIZEOF_INT64_T
 =
SIZEOF_LONG


38 
	#FMT_INT64
 "0x%016lx\n"

	)

40 
	#FMT_INT64
 "0x%016Œx\n"

	)

43 
ã°_ídsw≠_sh‹t
 () ;

44 
ã°_ídsw≠_öt
 () ;

45 
ã°_ídsw≠_öt64_t
 () ;

49 
	$maö
 ()

51 
	`ã°_ídsw≠_sh‹t
 () ;

52 
	`ã°_ídsw≠_öt
 () ;

53 
	`ã°_ídsw≠_öt64_t
 () ;

56 
	}
}

64 
	$dump_sh‹t_¨øy
 (c⁄° * 
«me
, * 
d©a
, 
d©Æí
)

65 { 
k
 ;

67 
	`¥ötf
 ("%-6†: ", 
«me
) ;

68 
k
 = 0 ; k < 
d©Æí
 ; k++)

69 
	`¥ötf
 (
FMT_SHORT
, 
d©a
 [
k
]) ;

70 
	`putch¨
 ('\n') ;

71 
	}
}

74 
	$ã°_ídsw≠_sh‹t
 ()

75 { 
‹ig
 [4], 
fú°
 [4], 
£c⁄d
 [4] ;

76 
k
 ;

78 
	`¥ötf
 (" %-24s : ", "test_endswap_short") ;

79 
	`fÊush
 (
°dout
) ;

81 
k
 = 0 ; k < 
	`ARRAY_LEN
 (
‹ig
) ; k++)

82 
‹ig
 [
k
] = 0x3210 + k ;

84 
	`ídsw≠_sh‹t_c›y
 (
fú°
, 
‹ig
, 
	`ARRAY_LEN
 (first)) ;

85 
	`ídsw≠_sh‹t_c›y
 (
£c⁄d
, 
fú°
, 
	`ARRAY_LEN
 (second)) ;

87 i‡(
	`memcmp
 (
‹ig
, 
fú°
,  (orig)) == 0)

88 { 
	`¥ötf
 ("\n\nLöê%d :Åe° 1 :Åhe£Åwÿ¨øy shouldÇŸ bêthêßme:\n\n", 
__LINE__
) ;

89 
	`dump_sh‹t_¨øy
 ("‹ig", 
‹ig
, 
	`ARRAY_LEN
 (orig)) ;

90 
	`dump_sh‹t_¨øy
 ("fú°", 
fú°
, 
	`ARRAY_LEN
 (first)) ;

91 
	`exô
 (1) ;

94 i‡(
	`memcmp
 (
‹ig
, 
£c⁄d
,  (orig)) != 0)

95 { 
	`¥ötf
 ("\n\nLöê%d :Åe° 2 :Åhe£Åwÿ¨øy should bêthêßme:\n\n", 
__LINE__
) ;

96 
	`dump_sh‹t_¨øy
 ("‹ig", 
‹ig
, 
	`ARRAY_LEN
 (orig)) ;

97 
	`dump_sh‹t_¨øy
 ("£c⁄d", 
£c⁄d
, 
	`ARRAY_LEN
 (second)) ;

98 
	`exô
 (1) ;

101 
	`ídsw≠_sh‹t_¨øy
 (
fú°
, 
	`ARRAY_LEN
 (first)) ;

103 i‡(
	`memcmp
 (
‹ig
, 
fú°
,  (orig)) != 0)

104 { 
	`¥ötf
 ("\n\nLöê%d :Åe° 3 :Åhe£Åwÿ¨øy should bêthêßme:\n\n", 
__LINE__
) ;

105 
	`dump_sh‹t_¨øy
 ("‹ig", 
‹ig
, 
	`ARRAY_LEN
 (orig)) ;

106 
	`dump_sh‹t_¨øy
 ("fú°", 
fú°
, 
	`ARRAY_LEN
 (first)) ;

107 
	`exô
 (1) ;

110 
	`ídsw≠_sh‹t_c›y
 (
fú°
, 
‹ig
, 
	`ARRAY_LEN
 (first)) ;

111 
	`ídsw≠_sh‹t_c›y
 (
fú°
, fú°, 
	`ARRAY_LEN
 (first)) ;

113 i‡(
	`memcmp
 (
‹ig
, 
fú°
,  (orig)) != 0)

114 { 
	`¥ötf
 ("\n\nLöê%d :Åe° 4 :Åhe£Åwÿ¨øy should bêthêßme:\n\n", 
__LINE__
) ;

115 
	`dump_sh‹t_¨øy
 ("‹ig", 
‹ig
, 
	`ARRAY_LEN
 (orig)) ;

116 
	`dump_sh‹t_¨øy
 ("fú°", 
fú°
, 
	`ARRAY_LEN
 (first)) ;

117 
	`exô
 (1) ;

120 
	`puts
 ("ok") ;

121 
	}
}

124 
	$dump_öt_¨øy
 (c⁄° * 
«me
, * 
d©a
, 
d©Æí
)

125 { 
k
 ;

127 
	`¥ötf
 ("%-6†: ", 
«me
) ;

128 
k
 = 0 ; k < 
d©Æí
 ; k++)

129 
	`¥ötf
 (
FMT_INT
, 
d©a
 [
k
]) ;

130 
	`putch¨
 ('\n') ;

131 
	}
}

134 
	$ã°_ídsw≠_öt
 ()

135 { 
‹ig
 [4], 
fú°
 [4], 
£c⁄d
 [4] ;

136 
k
 ;

138 
	`¥ötf
 (" %-24s : ", "test_endswap_int") ;

139 
	`fÊush
 (
°dout
) ;

141 
k
 = 0 ; k < 
	`ARRAY_LEN
 (
‹ig
) ; k++)

142 
‹ig
 [
k
] = 0x76543210 + k ;

144 
	`ídsw≠_öt_c›y
 (
fú°
, 
‹ig
, 
	`ARRAY_LEN
 (first)) ;

145 
	`ídsw≠_öt_c›y
 (
£c⁄d
, 
fú°
, 
	`ARRAY_LEN
 (second)) ;

147 i‡(
	`memcmp
 (
‹ig
, 
fú°
,  (orig)) == 0)

148 { 
	`¥ötf
 ("\n\nLöê%d :Åe° 1 :Åhe£Åwÿ¨øy shouldÇŸ bêthêßme:\n\n", 
__LINE__
) ;

149 
	`dump_öt_¨øy
 ("‹ig", 
‹ig
, 
	`ARRAY_LEN
 (orig)) ;

150 
	`dump_öt_¨øy
 ("fú°", 
fú°
, 
	`ARRAY_LEN
 (first)) ;

151 
	`exô
 (1) ;

154 i‡(
	`memcmp
 (
‹ig
, 
£c⁄d
,  (orig)) != 0)

155 { 
	`¥ötf
 ("\n\nLöê%d :Åe° 2 :Åhe£Åwÿ¨øy should bêthêßme:\n\n", 
__LINE__
) ;

156 
	`dump_öt_¨øy
 ("‹ig", 
‹ig
, 
	`ARRAY_LEN
 (orig)) ;

157 
	`dump_öt_¨øy
 ("£c⁄d", 
£c⁄d
, 
	`ARRAY_LEN
 (second)) ;

158 
	`exô
 (1) ;

161 
	`ídsw≠_öt_¨øy
 (
fú°
, 
	`ARRAY_LEN
 (first)) ;

163 i‡(
	`memcmp
 (
‹ig
, 
fú°
,  (orig)) != 0)

164 { 
	`¥ötf
 ("\n\nLöê%d :Åe° 3 :Åhe£Åwÿ¨øy should bêthêßme:\n\n", 
__LINE__
) ;

165 
	`dump_öt_¨øy
 ("‹ig", 
‹ig
, 
	`ARRAY_LEN
 (orig)) ;

166 
	`dump_öt_¨øy
 ("fú°", 
fú°
, 
	`ARRAY_LEN
 (first)) ;

167 
	`exô
 (1) ;

170 
	`ídsw≠_öt_c›y
 (
fú°
, 
‹ig
, 
	`ARRAY_LEN
 (first)) ;

171 
	`ídsw≠_öt_c›y
 (
fú°
, fú°, 
	`ARRAY_LEN
 (first)) ;

173 i‡(
	`memcmp
 (
‹ig
, 
fú°
,  (orig)) != 0)

174 { 
	`¥ötf
 ("\n\nLöê%d :Åe° 4 :Åhe£Åwÿ¨øy should bêthêßme:\n\n", 
__LINE__
) ;

175 
	`dump_öt_¨øy
 ("‹ig", 
‹ig
, 
	`ARRAY_LEN
 (orig)) ;

176 
	`dump_öt_¨øy
 ("fú°", 
fú°
, 
	`ARRAY_LEN
 (first)) ;

177 
	`exô
 (1) ;

180 
	`puts
 ("ok") ;

181 
	}
}

184 
	$dump_öt64_t_¨øy
 (c⁄° * 
«me
, 
öt64_t
 * 
d©a
, 
d©Æí
)

185 { 
k
 ;

187 
	`¥ötf
 ("%-6†: ", 
«me
) ;

188 
k
 = 0 ; k < 
d©Æí
 ; k++)

189 
	`¥ötf
 (
FMT_INT64
, 
d©a
 [
k
]) ;

190 
	`putch¨
 ('\n') ;

191 
	}
}

194 
	$ã°_ídsw≠_öt64_t
 ()

195 { 
öt64_t
 
‹ig
 [4], 
fú°
 [4], 
£c⁄d
 [4] ;

196 
k
 ;

198 
	`¥ötf
 (" %-24s : ", "test_endswap_int64_t") ;

199 
	`fÊush
 (
°dout
) ;

201 
k
 = 0 ; k < 
	`ARRAY_LEN
 (
‹ig
) ; k++)

202 
‹ig
 [
k
] = 0x0807050540302010LL + k ;

204 
	`ídsw≠_öt64_t_c›y
 (
fú°
, 
‹ig
, 
	`ARRAY_LEN
 (first)) ;

205 
	`ídsw≠_öt64_t_c›y
 (
£c⁄d
, 
fú°
, 
	`ARRAY_LEN
 (second)) ;

207 i‡(
	`memcmp
 (
‹ig
, 
fú°
,  (orig)) == 0)

208 { 
	`¥ötf
 ("\n\nLöê%d :Åe° 1 :Åhe£Åwÿ¨øy shouldÇŸ bêthêßme:\n\n", 
__LINE__
) ;

209 
	`dump_öt64_t_¨øy
 ("‹ig", 
‹ig
, 
	`ARRAY_LEN
 (orig)) ;

210 
	`dump_öt64_t_¨øy
 ("fú°", 
fú°
, 
	`ARRAY_LEN
 (first)) ;

211 
	`exô
 (1) ;

214 i‡(
	`memcmp
 (
‹ig
, 
£c⁄d
,  (orig)) != 0)

215 { 
	`¥ötf
 ("\n\nLöê%d :Åe° 2 :Åhe£Åwÿ¨øy should bêthêßme:\n\n", 
__LINE__
) ;

216 
	`dump_öt64_t_¨øy
 ("‹ig", 
‹ig
, 
	`ARRAY_LEN
 (orig)) ;

217 
	`dump_öt64_t_¨øy
 ("£c⁄d", 
£c⁄d
, 
	`ARRAY_LEN
 (second)) ;

218 
	`exô
 (1) ;

221 
	`ídsw≠_öt64_t_¨øy
 (
fú°
, 
	`ARRAY_LEN
 (first)) ;

223 i‡(
	`memcmp
 (
‹ig
, 
fú°
,  (orig)) != 0)

224 { 
	`¥ötf
 ("\n\nLöê%d :Åe° 3 :Åhe£Åwÿ¨øy should bêthêßme:\n\n", 
__LINE__
) ;

225 
	`dump_öt64_t_¨øy
 ("‹ig", 
‹ig
, 
	`ARRAY_LEN
 (orig)) ;

226 
	`dump_öt64_t_¨øy
 ("fú°", 
fú°
, 
	`ARRAY_LEN
 (first)) ;

227 
	`exô
 (1) ;

230 
	`ídsw≠_öt64_t_c›y
 (
fú°
, 
‹ig
, 
	`ARRAY_LEN
 (first)) ;

231 
	`ídsw≠_öt64_t_c›y
 (
fú°
, fú°, 
	`ARRAY_LEN
 (first)) ;

233 i‡(
	`memcmp
 (
‹ig
, 
fú°
,  (orig)) != 0)

234 { 
	`¥ötf
 ("\n\nLöê%d :Åe° 4 :Åhe£Åwÿ¨øy should bêthêßme:\n\n", 
__LINE__
) ;

235 
	`dump_öt64_t_¨øy
 ("‹ig", 
‹ig
, 
	`ARRAY_LEN
 (orig)) ;

236 
	`dump_öt64_t_¨øy
 ("fú°", 
fú°
, 
	`ARRAY_LEN
 (first)) ;

237 
	`exô
 (1) ;

240 
	`puts
 ("ok") ;

241 
	}
}

	@libsndfile-1.0.17/src/test_file_io.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

24 #i‡
HAVE_UNISTD_H


25 
	~<uni°d.h
>

28 
	~<°rög.h
>

29 
	~<î∫o.h
>

31 
	~"comm⁄.h
"

33 
make_d©a
 (*
d©a
, 
Àn
, 
£ed
) ;

35 
fûe_›í_ã°
 (c⁄° *
fûíame
) ;

36 
fûe_ªad_wrôe_ã°
 (c⁄° *
fûíame
) ;

37 
fûe_åunˇã_ã°
 (c⁄° *
fûíame
) ;

39 
ã°_›í_‹_dõ
 (
SF_PRIVATE
 *
psf
, 
löíum
) ;

40 
ã°_˛o£_‹_dõ
 (
SF_PRIVATE
 *
psf
, 
löíum
) ;

42 
ã°_wrôe_‹_dõ
 (
SF_PRIVATE
 *
psf
, *
d©a
, 
sf_cou¡_t
 
byãs
, sf_cou¡_à
ôems
, sf_cou¡_à
√w_posôi⁄
, 
löíum
) ;

43 
ã°_ªad_‹_dõ
 (
SF_PRIVATE
 *
psf
, *
d©a
, 
sf_cou¡_t
 
byãs
, sf_cou¡_à
ôems
, sf_cou¡_à
√w_posôi⁄
, 
löíum
) ;

44 
ã°_equÆ_‹_dõ
 (*
¨øy1
, *
¨øy2
, 
Àn
, 
löíum
) ;

45 
ã°_£ek_‹_dõ
 (
SF_PRIVATE
 *
psf
, 
sf_cou¡_t
 
off£t
, 
whí˚
, sf_cou¡_à
√w_posôi⁄
, 
löíum
) ;

50 
	$maö
 ()

51 { c⁄° *
fûíame
 = "file_io.dat" ;

53 
	`fûe_›í_ã°
 (
fûíame
) ;

54 
	`fûe_ªad_wrôe_ã°
 (
fûíame
) ;

55 
	`fûe_åunˇã_ã°
 (
fûíame
) ;

57 
	`u∆ök
 (
fûíame
) ;

60 
	}
}

67 
	$fûe_›í_ã°
 (c⁄° *
fûíame
)

68 { 
SF_PRIVATE
 
sf_d©a
, *
psf
 ;

69 
îr‹
 ;

71 
	`¥ötf
 (" %-24s : ", "file_open_test") ;

72 
	`fÊush
 (
°dout
) ;

74 
	`mem£t
 (&
sf_d©a
, 0,  (sf_data)) ;

75 
psf
 = &
sf_d©a
 ;

78 i‡(
	`u∆ök
 (
fûíame
Ë!0 && 
î∫o
 !
ENOENT
)

79 { 
	`¥ötf
 ("\n\nLöê%d: u∆ök faûed (%dË: %s\n\n", 
__LINE__
, 
î∫o
, 
	`°ªº‹
 (errno)) ;

80 
	`exô
 (1) ;

83 
	`°∫˝y
 (
psf
->
fûíame
, filename,  (psf->filename)) ;

86 
îr‹
 = 
	`psf_f›í
 (
psf
,Ösf->
fûíame
, 
SFM_READ
) ;

87 i‡(
îr‹
 == 0)

88 { 
	`¥ötf
 ("\n\nLöê%d:Ösf_f›í(Ëshould havêÁûed.\n\n", 
__LINE__
) ;

89 
	`exô
 (1) ;

93 
psf
->
îr‹
 = 
SFE_NO_ERROR
 ;

96 
psf
->
mode
 = 
SFM_WRITE
 ;

97 
	`ã°_›í_‹_dõ
 (
psf
, 
__LINE__
) ;

99 
	`ã°_˛o£_‹_dõ
 (
psf
, 
__LINE__
) ;

101 
	`u∆ök
 (
psf
->
fûíame
) ;

104 
psf
->
mode
 = 
SFM_RDWR
 ;

105 
	`ã°_›í_‹_dõ
 (
psf
, 
__LINE__
) ;

107 
	`ã°_˛o£_‹_dõ
 (
psf
, 
__LINE__
) ;

110 
psf
->
mode
 = 
SFM_RDWR
 ;

111 
	`ã°_›í_‹_dõ
 (
psf
, 
__LINE__
) ;

113 
	`ã°_˛o£_‹_dõ
 (
psf
, 
__LINE__
) ;

115 
	`u∆ök
 (
psf
->
fûíame
) ;

116 
	`puts
 ("ok") ;

117 
	}
}

120 
	$fûe_ªad_wrôe_ã°
 (c⁄° *
fûíame
)

121 { 
d©a_out
 [512] ;

122 
d©a_ö
 [512] ;

124 
SF_PRIVATE
 
sf_d©a
, *
psf
 ;

125 
sf_cou¡_t
 
ªtvÆ
 ;

132 
	`¥ötf
 (" %-24s : ", "file_write_test") ;

133 
	`fÊush
 (
°dout
) ;

135 
	`mem£t
 (&
sf_d©a
, 0,  (sf_data)) ;

136 
psf
 = &
sf_d©a
 ;

137 
	`°∫˝y
 (
psf
->
fûíame
, filename,  (psf->filename)) ;

140 
psf
->
mode
 = 
SFM_WRITE
 ;

141 
	`ã°_›í_‹_dõ
 (
psf
, 
__LINE__
) ;

143 
	`make_d©a
 (
d©a_out
, 
	`ARRAY_LEN
 (data_out), 1) ;

144 
	`ã°_wrôe_‹_dõ
 (
psf
, 
d©a_out
,  (d©a_ouà[0]), 
	`ARRAY_LEN
 (d©a_out),  (d©a_out), 
__LINE__
) ;

146 i‡((
ªtvÆ
 = 
	`psf_gë_fûñí
 (
psf
)Ë! (
d©a_out
))

147 { 
	`¥ötf
 ("\n\nLöê%d: fûêÀngthá·î wrôêi†nŸ c‹ª˘ (%ld should bê%d).\n\n", 
__LINE__
, (Ë
ªtvÆ
, (Ë (
d©a_out
)) ;

148 i‡(
ªtvÆ
 == 0)

149 
	`¥ötf
 ("An fsync() may beÇecessary before fstat() inÖsf_get_filelen().\n\n") ;

150 
	`exô
 (1) ;

153 
	`make_d©a
 (
d©a_out
, 
	`ARRAY_LEN
 (data_out), 2) ;

154 
	`ã°_wrôe_‹_dõ
 (
psf
, 
d©a_out
, 
	`ARRAY_LEN
 (d©a_out),  (d©a_ouà[0]), 2 *  (d©a_out), 
__LINE__
) ;

156 i‡((
ªtvÆ
 = 
	`psf_gë_fûñí
 (
psf
)Ë!2 *  (
d©a_out
))

157 { 
	`¥ötf
 ("\n\nLöê%d: fûêÀngthá·î wrôêi†nŸ c‹ª˘. (%ld should bê%d)\n\n", 
__LINE__
, (Ë
ªtvÆ
, 2 * ((Ë (
d©a_out
))) ;

158 
	`exô
 (1) ;

161 
	`ã°_˛o£_‹_dõ
 (
psf
, 
__LINE__
) ;

162 
	`puts
 ("ok") ;

169 
	`¥ötf
 (" %-24s : ", "file_read_test") ;

170 
	`fÊush
 (
°dout
) ;

173 
psf
->
mode
 = 
SFM_READ
 ;

174 
	`ã°_›í_‹_dõ
 (
psf
, 
__LINE__
) ;

176 
	`make_d©a
 (
d©a_out
, 
	`ARRAY_LEN
 (data_out), 1) ;

177 
	`ã°_ªad_‹_dõ
 (
psf
, 
d©a_ö
, 1,  (d©a_ö),  (d©a_ö), 
__LINE__
) ;

178 
	`ã°_equÆ_‹_dõ
 (
d©a_out
, 
d©a_ö
, 
	`ARRAY_LEN
 (d©a_out), 
__LINE__
) ;

180 
	`make_d©a
 (
d©a_out
, 
	`ARRAY_LEN
 (data_out), 2) ;

181 
	`ã°_ªad_‹_dõ
 (
psf
, 
d©a_ö
,  (d©a_ö [0]), 
	`ARRAY_LEN
 (d©a_ö), 2 *  (d©a_ö), 
__LINE__
) ;

182 
	`ã°_equÆ_‹_dõ
 (
d©a_out
, 
d©a_ö
, 
	`ARRAY_LEN
 (d©a_out), 
__LINE__
) ;

184 
	`ã°_˛o£_‹_dõ
 (
psf
, 
__LINE__
) ;

186 
	`puts
 ("ok") ;

194 
	`¥ötf
 (" %-24s : ", "file_seek_test") ;

195 
	`fÊush
 (
°dout
) ;

198 
psf
->
mode
 = 
SFM_RDWR
 ;

199 
	`ã°_›í_‹_dõ
 (
psf
, 
__LINE__
) ;

201 
	`ã°_£ek_‹_dõ
 (
psf
, 0, 
SEEK_SET
, 0, 
__LINE__
) ;

202 
	`ã°_£ek_‹_dõ
 (
psf
, 0, 
SEEK_END
, 2 * 
	`SIGNED_SIZEOF
 (
d©a_out
), 
__LINE__
) ;

203 
	`ã°_£ek_‹_dõ
 (
psf
, -1 * 
	`SIGNED_SIZEOF
 (
d©a_out
), 
SEEK_CUR
, (
sf_cou¡_t
Ë (d©a_out), 
__LINE__
) ;

205 
	`ã°_£ek_‹_dõ
 (
psf
, 
	`SIGNED_SIZEOF
 (
d©a_out
), 
SEEK_CUR
, 2 * SIGNED_SIZEOF (d©a_out), 
__LINE__
) ;

206 
	`make_d©a
 (
d©a_out
, 
	`ARRAY_LEN
 (data_out), 3) ;

207 
	`ã°_wrôe_‹_dõ
 (
psf
, 
d©a_out
,  (d©a_ouà[0]), 
	`ARRAY_LEN
 (d©a_out), 3 *  (d©a_out), 
__LINE__
) ;

209 
	`ã°_£ek_‹_dõ
 (
psf
, 0, 
SEEK_SET
, 0, 
__LINE__
) ;

210 
	`make_d©a
 (
d©a_out
, 
	`ARRAY_LEN
 (data_out), 1) ;

211 
	`ã°_ªad_‹_dõ
 (
psf
, 
d©a_ö
, 1,  (d©a_ö),  (d©a_ö), 
__LINE__
) ;

212 
	`ã°_equÆ_‹_dõ
 (
d©a_out
, 
d©a_ö
, 
	`ARRAY_LEN
 (d©a_out), 
__LINE__
) ;

214 
	`ã°_£ek_‹_dõ
 (
psf
, 2 * 
	`SIGNED_SIZEOF
 (
d©a_out
), 
SEEK_SET
, 2 * SIGNED_SIZEOF (d©a_out), 
__LINE__
) ;

215 
	`make_d©a
 (
d©a_out
, 
	`ARRAY_LEN
 (data_out), 3) ;

216 
	`ã°_ªad_‹_dõ
 (
psf
, 
d©a_ö
, 1,  (d©a_ö), 3 *  (d©a_ö), 
__LINE__
) ;

217 
	`ã°_equÆ_‹_dõ
 (
d©a_out
, 
d©a_ö
, 
	`ARRAY_LEN
 (d©a_out), 
__LINE__
) ;

219 
	`ã°_£ek_‹_dõ
 (
psf
, 
	`SIGNED_SIZEOF
 (
d©a_out
), 
SEEK_SET
, SIGNED_SIZEOF (d©a_out), 
__LINE__
) ;

220 
	`make_d©a
 (
d©a_out
, 
	`ARRAY_LEN
 (data_out), 2) ;

221 
	`ã°_ªad_‹_dõ
 (
psf
, 
d©a_ö
, 1,  (d©a_ö), 2 *  (d©a_ö), 
__LINE__
) ;

222 
	`ã°_equÆ_‹_dõ
 (
d©a_out
, 
d©a_ö
, 
	`ARRAY_LEN
 (d©a_out), 
__LINE__
) ;

224 
	`ã°_˛o£_‹_dõ
 (
psf
, 
__LINE__
) ;

225 
	`puts
 ("ok") ;

233 
	`¥ötf
 (" %-24s : ", "file_offset_test") ;

234 
	`fÊush
 (
°dout
) ;

237 
psf
->
mode
 = 
SFM_RDWR
 ;

238 
psf
->
fûeoff£t
 =  (
d©a_out
 [0]Ë* 
	`ARRAY_LEN
 (data_out) ;

239 
	`ã°_›í_‹_dõ
 (
psf
, 
__LINE__
) ;

241 i‡((
ªtvÆ
 = 
	`psf_gë_fûñí
 (
psf
)Ë!3 *  (
d©a_out
))

242 { 
	`¥ötf
 ("\n\nLöê%d: fûêÀngthá·î wrôêi†nŸ c‹ª˘. (%ld should bê%d)\n\n", 
__LINE__
, (Ë
ªtvÆ
, 3 * ((Ë (
d©a_out
))) ;

243 
	`exô
 (1) ;

246 
	`ã°_£ek_‹_dõ
 (
psf
, 
	`SIGNED_SIZEOF
 (
d©a_out
), 
SEEK_SET
, SIGNED_SIZEOF (d©a_out), 
__LINE__
) ;

247 
	`make_d©a
 (
d©a_out
, 
	`ARRAY_LEN
 (data_out), 5) ;

248 
	`ã°_wrôe_‹_dõ
 (
psf
, 
d©a_out
,  (d©a_ouà[0]), 
	`ARRAY_LEN
 (d©a_out), 2 *  (d©a_out), 
__LINE__
) ;

249 
	`ã°_˛o£_‹_dõ
 (
psf
, 
__LINE__
) ;

253 
psf
->
mode
 = 
SFM_RDWR
 ;

254 
psf
->
fûeoff£t
 = 0 ;

255 
	`ã°_›í_‹_dõ
 (
psf
, 
__LINE__
) ;

257 i‡((
ªtvÆ
 = 
	`psf_gë_fûñí
 (
psf
)Ë!3 *  (
d©a_out
))

258 { 
	`¥ötf
 ("\n\nLöê%d: fûêÀngthá·î wrôêi†nŸ c‹ª˘. (%ld should bê%d)\n\n", 
__LINE__
, (Ë
ªtvÆ
, 3 * ((Ë (
d©a_out
))) ;

259 
	`exô
 (1) ;

262 
	`make_d©a
 (
d©a_out
, 
	`ARRAY_LEN
 (data_out), 1) ;

263 
	`ã°_ªad_‹_dõ
 (
psf
, 
d©a_ö
, 1,  (d©a_ö),  (d©a_ö), 
__LINE__
) ;

264 
	`ã°_equÆ_‹_dõ
 (
d©a_out
, 
d©a_ö
, 
	`ARRAY_LEN
 (d©a_out), 
__LINE__
) ;

266 
	`make_d©a
 (
d©a_out
, 
	`ARRAY_LEN
 (data_out), 2) ;

267 
	`ã°_ªad_‹_dõ
 (
psf
, 
d©a_ö
, 1,  (d©a_ö), 2 *  (d©a_ö), 
__LINE__
) ;

268 
	`ã°_equÆ_‹_dõ
 (
d©a_out
, 
d©a_ö
, 
	`ARRAY_LEN
 (d©a_out), 
__LINE__
) ;

270 
	`make_d©a
 (
d©a_out
, 
	`ARRAY_LEN
 (data_out), 5) ;

271 
	`ã°_ªad_‹_dõ
 (
psf
, 
d©a_ö
, 1,  (d©a_ö), 3 *  (d©a_ö), 
__LINE__
) ;

272 
	`ã°_equÆ_‹_dõ
 (
d©a_out
, 
d©a_ö
, 
	`ARRAY_LEN
 (d©a_out), 
__LINE__
) ;

274 
	`ã°_˛o£_‹_dõ
 (
psf
, 
__LINE__
) ;

276 
	`puts
 ("ok") ;

277 
	}
}

280 
	$fûe_åunˇã_ã°
 (c⁄° *
fûíame
)

281 { 
SF_PRIVATE
 
sf_d©a
, *
psf
 ;

282 
buf„r
 [256] ;

283 
k
 ;

290 
	`¥ötf
 (" %-24s : ", "file_truncate_test") ;

291 
	`fÊush
 (
°dout
) ;

293 
	`mem£t
 (&
sf_d©a
, 0,  (sf_data)) ;

294 
	`mem£t
 (
buf„r
, 0xEE,  (buffer)) ;

296 
psf
 = &
sf_d©a
 ;

297 
	`°∫˝y
 (
psf
->
fûíame
, filename,  (psf->filename)) ;

303 
psf
->
mode
 = 
SFM_WRITE
 ;

304 
	`ã°_›í_‹_dõ
 (
psf
, 
__LINE__
) ;

305 
	`ã°_wrôe_‹_dõ
 (
psf
, 
buf„r
,  (buf„rË/ 2, 1,  (buf„rË/ 2, 
__LINE__
) ;

306 
	`psf_·runˇã
 (
psf
,  (
buf„r
)) ;

307 
	`ã°_˛o£_‹_dõ
 (
psf
, 
__LINE__
) ;

310 
psf
->
mode
 = 
SFM_READ
 ;

311 
	`ã°_›í_‹_dõ
 (
psf
, 
__LINE__
) ;

312 
	`ã°_ªad_‹_dõ
 (
psf
, 
buf„r
,  (buf„r), 1,  (buf„r), 
__LINE__
) ;

313 
	`ã°_˛o£_‹_dõ
 (
psf
, 
__LINE__
) ;

315 
k
 = 0 ; k < 
	`SIGNED_SIZEOF
 (
buf„r
) / 2 ; k++)

316 i‡(
buf„r
 [
k
] != 0xEE)

317 { 
	`¥ötf
 ("\n\nLöê%d : buf„∏[%d] = %d (should bê0xEE)\n\n", 
__LINE__
, 
k
, 
buf„r
 [k]) ;

318 
	`exô
 (1) ;

321 
k
 = 
	`SIGNED_SIZEOF
 (
buf„r
) / 2 ; k < SIGNED_SIZEOF (buffer) ; k++)

322 i‡(
buf„r
 [
k
] != 0)

323 { 
	`¥ötf
 ("\n\nLöê%d : buf„∏[%d] = %d (should bê0)\n\n", 
__LINE__
, 
k
, 
buf„r
 [k]) ;

324 
	`exô
 (1) ;

328 
psf
->
mode
 = 
SFM_RDWR
 ;

329 
	`ã°_›í_‹_dõ
 (
psf
, 
__LINE__
) ;

330 
	`psf_·runˇã
 (
psf
,  (
buf„r
) / 4) ;

331 
	`ã°_˛o£_‹_dõ
 (
psf
, 
__LINE__
) ;

334 
psf
->
mode
 = 
SFM_READ
 ;

335 
	`ã°_›í_‹_dõ
 (
psf
, 
__LINE__
) ;

336 
	`ã°_£ek_‹_dõ
 (
psf
, 0, 
SEEK_END
, 
	`SIGNED_SIZEOF
 (
buf„r
Ë/ 4, 
__LINE__
) ;

337 
	`ã°_˛o£_‹_dõ
 (
psf
, 
__LINE__
) ;

339 
	`puts
 ("ok") ;

340 
	}
}

347 
	$ã°_›í_‹_dõ
 (
SF_PRIVATE
 *
psf
, 
löíum
)

348 { 
îr‹
 ;

351 
îr‹
 = 
	`psf_f›í
 (
psf
,Ösf->
fûíame
,Ösf->
mode
) ;

352 i‡(
îr‹
)

353 { 
	`¥ötf
 ("\n\nLöê%d:Ösf_f›í(ËÁûed : %s\n\n", 
löíum
, 
	`°ªº‹
 (
î∫o
)) ;

354 
	`exô
 (1) ;

357 
	}
}

360 
	$ã°_˛o£_‹_dõ
 (
SF_PRIVATE
 *
psf
, 
löíum
)

362 
	`psf_f˛o£
 (
psf
) ;

363 i‡(
	`psf_fûe_vÆid
 (
psf
))

364 { 
	`¥ötf
 ("\n\nLöê%d:Ösf->fûede†shouldÇŸ bêvÆid.\n\n", 
löíum
) ;

365 
	`exô
 (1) ;

368 
	}
}

371 
	$ã°_wrôe_‹_dõ
 (
SF_PRIVATE
 *
psf
, *
d©a
, 
sf_cou¡_t
 
byãs
, sf_cou¡_à
ôems
, sf_cou¡_à
√w_posôi⁄
, 
löíum
)

372 { 
sf_cou¡_t
 
ªtvÆ
 ;

374 
ªtvÆ
 = 
	`psf_fwrôe
 (
d©a
, 
byãs
, 
ôems
, 
psf
) ;

375 i‡(
ªtvÆ
 !
ôems
)

376 { 
	`¥ötf
 ("\n\nLöê%d:Ösf_wrôe(Ëªtu∫ed %ld (should bê%ld)\n\n", 
löíum
, (Ë
ªtvÆ
, (Ë
ôems
) ;

377 
	`exô
 (1) ;

380 i‡((
ªtvÆ
 = 
	`psf_·ñl
 (
psf
)Ë!
√w_posôi⁄
)

381 { 
	`¥ötf
 ("\n\nLöê%d: fûêÀngthá·î wrôêi†nŸ c‹ª˘. (%ld should bê%ld)\n\n", 
löíum
, (Ë
ªtvÆ
, (Ë
√w_posôi⁄
) ;

382 
	`exô
 (1) ;

386 
	}
}

389 
	$ã°_ªad_‹_dõ
 (
SF_PRIVATE
 *
psf
, *
d©a
, 
sf_cou¡_t
 
byãs
, sf_cou¡_à
ôems
, sf_cou¡_à
√w_posôi⁄
, 
löíum
)

390 { 
sf_cou¡_t
 
ªtvÆ
 ;

392 
ªtvÆ
 = 
	`psf_‰ód
 (
d©a
, 
byãs
, 
ôems
, 
psf
) ;

393 i‡(
ªtvÆ
 !
ôems
)

394 { 
	`¥ötf
 ("\n\nLöê%d:Ösf_wrôe(Ëªtu∫ed %ld (should bê%ld)\n\n", 
löíum
, (Ë
ªtvÆ
, (Ë
ôems
) ;

395 
	`exô
 (1) ;

398 i‡((
ªtvÆ
 = 
	`psf_·ñl
 (
psf
)Ë!
√w_posôi⁄
)

399 { 
	`¥ötf
 ("\n\nLöê%d: fûêÀngthá·î wrôêi†nŸ c‹ª˘. (%ld should bê%ld)\n\n", 
löíum
, (Ë
ªtvÆ
, (Ë
√w_posôi⁄
) ;

400 
	`exô
 (1) ;

404 
	}
}

407 
	$ã°_£ek_‹_dõ
 (
SF_PRIVATE
 *
psf
, 
sf_cou¡_t
 
off£t
, 
whí˚
, sf_cou¡_à
√w_posôi⁄
, 
löíum
)

408 { 
sf_cou¡_t
 
ªtvÆ
 ;

410 
ªtvÆ
 = 
	`psf_f£ek
 (
psf
, 
off£t
, 
whí˚
) ;

412 i‡(
ªtvÆ
 !
√w_posôi⁄
)

413 { 
	`¥ötf
 ("\n\nLine %d:Ösf_fseek() failed. NewÖosition is %ld (should be %ld).\n\n",

414 
löíum
, (Ë
ªtvÆ
, (Ë
√w_posôi⁄
) ;

415 
	`exô
 (1) ;

418 
	}
}

421 
	$ã°_equÆ_‹_dõ
 (*
¨øy1
, *
¨øy2
, 
Àn
, 
löíum
)

422 { 
k
 ;

424 
k
 = 0 ; k < 
Àn
 ; k++)

425 i‡(
¨øy1
 [
k
] !
¨øy2
 [k])

426 
	`¥ötf
 ("\n\nLine %d:Érrorát index %d (%d != %d).\n\n",

427 
löíum
, 
k
, 
¨øy1
 [k], 
¨øy2
 [k]) ;

430 
	}
}

433 
	$make_d©a
 (*
d©a
, 
Àn
, 
£ed
)

434 { 
k
 ;

436 
	`§™d
 (
£ed
 * 3333333 + 14756123) ;

438 
k
 = 0 ; k < 
Àn
 ; k++)

439 
d©a
 [
k
] = 
	`ønd
 () ;

441 
	}
}

	@libsndfile-1.0.17/src/test_log_printf.c

19 
	~<°dio.h
>

20 
	~<°dlib.h
>

21 
	~<°rög.h
>

22 
	~<°d¨g.h
>

23 
	~<î∫o.h
>

25 
	~"sfc⁄fig.h
"

30 
	#PSF_LOG_PRINTF_ONLY


	)

31 
	~"comm⁄.c
"

34 
	#CMP_0_ARGS
(
löe
,
îr
,
fmt
) \

35 { 
psf
->
logödex
 = 0 ; \

36 
	`LSF_SNPRINTF
 (
buf„r
,  (buf„r), (
fmt
)) ; \

37 
	`psf_log_¥ötf
 (
psf
, (
fmt
)) ; \

38 
îr
 +
	`com∑ª_°rögs_‹_dõ
 (
löe
, 
fmt
, 
buf„r
, 
psf
->
logbuf„r
) ; \

39 }

	)

41 
	#CMP_2_ARGS
(
löe
,
îr
,
fmt
,
a
) \

42 { 
psf
->
logödex
 = 0 ; \

43 
	`LSF_SNPRINTF
 (
buf„r
,  (buf„r), (
fmt
), (
a
), (a)) ; \

44 
	`psf_log_¥ötf
 (
psf
, (
fmt
), (
a
), (a)) ; \

45 
îr
 +
	`com∑ª_°rögs_‹_dõ
 (
löe
, 
fmt
, 
buf„r
, 
psf
->
logbuf„r
) ; \

46 }

	)

48 
	#CMP_4_ARGS
(
löe
,
îr
,
fmt
,
a
) \

49 { 
psf
->
logödex
 = 0 ; \

50 
	`LSF_SNPRINTF
 (
buf„r
,  (buf„r), (
fmt
), (
a
), (a), (a), (a)) ; \

51 
	`psf_log_¥ötf
 (
psf
, (
fmt
), (
a
), (a), (a), (a)) ; \

52 
îr
 +
	`com∑ª_°rögs_‹_dõ
 (
löe
, 
fmt
, 
buf„r
, 
psf
->
logbuf„r
) ; \

53 }

	)

55 
	#CMP_5_ARGS
(
löe
,
îr
,
fmt
,
a
) \

56 { 
psf
->
logödex
 = 0 ; \

57 
	`LSF_SNPRINTF
 (
buf„r
,  (buf„r), (
fmt
), (
a
), (a), (a), (a), (a)) ; \

58 
	`psf_log_¥ötf
 (
psf
, (
fmt
), (
a
), (a), (a), (a), (a)) ; \

59 
îr
 +
	`com∑ª_°rögs_‹_dõ
 (
löe
, 
fmt
, 
buf„r
, 
psf
->
logbuf„r
) ; \

60 }

	)

62 
	#CMP_6_ARGS
(
löe
,
îr
,
fmt
,
a
) \

63 { 
psf
->
logödex
 = 0 ; \

64 
	`LSF_SNPRINTF
 (
buf„r
,  (buf„r), (
fmt
), (
a
), (a), (a), (a), (a), (a)) ; \

65 
	`psf_log_¥ötf
 (
psf
, (
fmt
), (
a
), (a), (a), (a), (a), (a)) ; \

66 
îr
 +
	`com∑ª_°rögs_‹_dõ
 (
löe
, 
fmt
, 
buf„r
, 
psf
->
logbuf„r
) ; \

67 }

	)

69 
com∑ª_°rögs_‹_dõ
 (
löíum
, c⁄° *
fmt
, c⁄° * 
s1
, c⁄° * 
s3
) ;

72 
	$maö
 ()

73 { 
buf„r
 [2048] ;

74 
SF_PRIVATE
 
sf_¥iv©e
, *
psf
 ;

75 
k
, 
îr‹s
 = 0 ;

76 
öt_vÆues
 [] = { 0, 1, 12, 123, 1234, 123456, -1, -12, -123, -1234, -123456 } ;

78 
	`¥ötf
 (" %-24s : ", "psf_log_printf_test") ;

79 
	`fÊush
 (
°dout
) ;

81 
psf
 = &
sf_¥iv©e
 ;

82 
	`mem£t
 (
psf
, 0,  (
sf_¥iv©e
)) ;

84 
	`CMP_0_ARGS
 (
__LINE__
, 
îr‹s
, " ->%%<- ") ;

87 
k
 = 0 ; k < 
	`ARRAY_LEN
 (
öt_vÆues
) ; k++)

88 
	`CMP_6_ARGS
 (
__LINE__
, 
îr‹s
, "öàA : %d, % d, %4d, % 4d, %04d, % 04d", 
öt_vÆues
 [
k
]) ;

90 
k
 = 0 ; k < 
	`ARRAY_LEN
 (
öt_vÆues
) ; k++)

91 
	`CMP_5_ARGS
 (
__LINE__
, 
îr‹s
, "öàB : %+d, %+4d, %+04d, %-d, %-4d", 
öt_vÆues
 [
k
]) ;

93 
k
 = 0 ; k < 
	`ARRAY_LEN
 (
öt_vÆues
) ; k++)

94 
	`CMP_2_ARGS
 (
__LINE__
, 
îr‹s
, "öàC : %- d, %- 4d", 
öt_vÆues
 [
k
]) ;

97 
k
 = 0 ; k < 
	`ARRAY_LEN
 (
öt_vÆues
) ; k++)

98 
	`CMP_4_ARGS
 (
__LINE__
, 
îr‹s
, "D : %u, %4u, %04u, %0u", 
öt_vÆues
 [
k
]) ;

101 
k
 = 0 ; k < 
	`ARRAY_LEN
 (
öt_vÆues
) ; k++)

102 
	`CMP_4_ARGS
 (
__LINE__
, 
îr‹s
, "E : %X, %4X, %04X, %0X", 
öt_vÆues
 [
k
]) ;

105 
	`CMP_4_ARGS
 (
__LINE__
, 
îr‹s
, "B %s, %3s, %8s, %-8s", "str") ;

107 i‡(
îr‹s
)

108 { 
	`puts
 ("\nExiting dueÅoÉrrors.\n") ;

109 
	`exô
 (1) ;

112 
	`puts
 ("ok") ;

115 
	}
}

118 
	$com∑ª_°rögs_‹_dõ
 (
löíum
, c⁄° *
fmt
, c⁄° * 
s1
, c⁄° * 
s2
)

119 { 
îr‹s
 = 0 ;

122 i‡(
	`°rcmp
 (
s1
, 
s2
) != 0)

123 { 
	`¥ötf
 ("\n\nLöê%d: såög com∑ª mism©ch:\n\t", 
löíum
) ;

124 
	`¥ötf
 ("\"%s\"\n", 
fmt
) ;

125 
	`¥ötf
 ("\t\"%s\"\n\t\"%s\"\n", 
s1
, 
s2
) ;

126 
îr‹s
 ++ ;

129  
îr‹s
 ;

130 
	}
}

	@libsndfile-1.0.17/src/txw.c

26 
	~"sfc⁄fig.h
"

28 
	~<°dio.h
>

29 
	~<f˙é.h
>

30 
	~<°rög.h
>

31 
	~<˘y≥.h
>

33 
	~"¢dfûe.h
"

34 
	~"s„ndün.h
"

35 
	~"comm⁄.h
"

37 #i‡(
ENABLE_EXPERIMENTAL_CODE
 == 0)

40 
	$txw_›í
 (
SF_PRIVATE
 *
psf
)

41 { i‡(
psf
)

42  
SFE_UNIMPLEMENTED
 ;

43  (
psf
 && 0) ;

44 
	}
}

52 
	#TXW_DATA_OFFSET
 32

	)

54 
	#TXW_LOOPED
 0x49

	)

55 
	#TXW_NO_LOOP
 0xC9

	)

61 
txw_ªad_hódî
 (
SF_PRIVATE
 *
psf
) ;

63 
sf_cou¡_t
 
txw_ªad_s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

64 
sf_cou¡_t
 
txw_ªad_i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

65 
sf_cou¡_t
 
txw_ªad_f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

66 
sf_cou¡_t
 
txw_ªad_d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

68 
sf_cou¡_t
 
txw_£ek
 (
SF_PRIVATE
 *
psf
, 
mode
, sf_cou¡_à
off£t
) ;

92 { 
	mf‹m©
, 
	m§©e
, 
	m§2
, 
	m§3
 ;

93 
	m§hash
 ;

94 
	m©èckÀn
, 
	mª≥©Àn
 ;

95 } 
	tTXW_HEADER
 ;

97 
	#ERROR_666
 666

	)

100 
	$txw_›í
 (
SF_PRIVATE
 *
psf
)

101 { 
îr‹
 ;

103 i‡(
psf
->
mode
 !
SFM_READ
)

104  
SFE_UNIMPLEMENTED
 ;

106 i‡((
îr‹
 = 
	`txw_ªad_hódî
 (
psf
)))

107  
îr‹
 ;

109 i‡(
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
, 
SEEK_SET
) !=Ösf->dataoffset)

110  
SFE_BAD_SEEK
 ;

112 
psf
->
ªad_sh‹t
 = 
txw_ªad_s
 ;

113 
psf
->
ªad_öt
 = 
txw_ªad_i
 ;

114 
psf
->
ªad_Êﬂt
 = 
txw_ªad_f
 ;

115 
psf
->
ªad_doubÀ
 = 
txw_ªad_d
 ;

117 
psf
->
£ek
 = 
txw_£ek
 ;

120 
	}
}

126 
	$txw_ªad_hódî
 (
SF_PRIVATE
 *
psf
)

127 { 
TXW_HEADER
 
txwh
 ;

128 *
°Ωå
 ;

130 
	`mem£t
 (&
txwh
, 0,  (txwh)) ;

131 
	`mem£t
 (
psf
->
u
.
cbuf
, 0,  (psf->u.cbuf)) ;

132 
	`psf_böhódî_ªadf
 (
psf
, "pb", 0,Ösf->
u
.
cbuf
, 16) ;

134 i‡(
	`memcmp
 (
psf
->
u
.
cbuf
, "LM8953\0\0\0\0\0\0\0\0\0\0", 16) != 0)

135  
ERROR_666
 ;

137 
	`psf_log_¥ötf
 (
psf
, "Read only : Yamaha TX-16 Sampler (.txw)\nLM8953\n") ;

140 
	`psf_böhódî_ªadf
 (
psf
, "j11", 6, &
txwh
.
f‹m©
, &txwh.
§©e
) ;

143 
	`psf_böhódî_ªadf
 (
psf
, "e33j", &
txwh
.
©èckÀn
, &txwh.
ª≥©Àn
, 2) ;

144 
txwh
.
§2
 = (txwh.
©èckÀn
 >> 16) & 0xFE ;

145 
txwh
.
§3
 = (txwh.
ª≥©Àn
 >> 16) & 0xFE ;

146 
txwh
.
©èckÀn
 &= 0x1FFFF ;

147 
txwh
.
ª≥©Àn
 &= 0x1FFFF ;

149 
txwh
.
f‹m©
)

150 { 
TXW_LOOPED
 :

151 
°Ωå
 = "looped" ;

154 
TXW_NO_LOOP
 :

155 
°Ωå
 = "non-looped" ;

159 
	`psf_log_¥ötf
 (
psf
, " F‹m© : 0x%02x => ?????\n", 
txwh
.
f‹m©
) ;

160  
ERROR_666
 ;

163 
	`psf_log_¥ötf
 (
psf
, " F‹m© : 0x%02X => %s\n", 
txwh
.
f‹m©
, 
°Ωå
) ;

165 
°Ωå
 = 
NULL
 ;

167 
txwh
.
§©e
)

169 
psf
->
sf
.
ßm∂î©e
 = 33333 ;

173 
psf
->
sf
.
ßm∂î©e
 = 50000 ;

177 
psf
->
sf
.
ßm∂î©e
 = 16667 ;

182 
txwh
.
§hash
 = (—xwh.
§2
 & 0xFEË<< 8Ë| (txwh.
§3
 & 0xFE) ;

183 
txwh
.
§hash
)

185 
psf
->
sf
.
ßm∂î©e
 = 33333 ;

189 
psf
->
sf
.
ßm∂î©e
 = 50000 ;

193 
psf
->
sf
.
ßm∂î©e
 = 166667 ;

197 
°Ωå
 = " Sample Rate : Unknown : forcingÅo 33333\n" ;

198 
psf
->
sf
.
ßm∂î©e
 = 33333 ;

204 i‡(
°Ωå
)

205 
	`psf_log_¥ötf
 (
psf
, 
°Ωå
) ;

206 i‡(
txwh
.
§hash
)

207 
	`psf_log_¥ötf
 (
psf
, " Sam∂êR©ê: %d (0x%XË=> %d\n", 
txwh
.
§©e
,Åxwh.
§hash
,Ösf->
sf
.
ßm∂î©e
) ;

209 
	`psf_log_¥ötf
 (
psf
, " Sam∂êR©ê: %d => %d\n", 
txwh
.
§©e
,Ösf->
sf
.
ßm∂î©e
) ;

211 i‡(
txwh
.
f‹m©
 =
TXW_LOOPED
)

212 { 
	`psf_log_¥ötf
 (
psf
, " Aâack Lí : %d\n", 
txwh
.
©èckÀn
) ;

213 
	`psf_log_¥ötf
 (
psf
, " RïóàLí : %d\n", 
txwh
.
ª≥©Àn
) ;

216 
psf
->
d©aoff£t
 = 
TXW_DATA_OFFSET
 ;

217 
psf
->
d©Æígth
 =Ösf->
fûñígth
 - 
TXW_DATA_OFFSET
 ;

218 
psf
->
sf
.
‰ames
 = 2 *Ösf->
d©Æígth
 / 3 ;

221 i‡(
psf
->
d©Æígth
 % 3 == 1)

222 
	`psf_log_¥ötf
 (
psf
, "*** File seemsÅo beÅruncated, %dÉxtra bytes.\n",

223 (Ë(
psf
->
d©Æígth
 % 3)) ;

225 i‡(
txwh
.
©èckÀn
 +Åxwh.
ª≥©Àn
 > 
psf
->
sf
.
‰ames
)

226 
	`psf_log_¥ötf
 (
psf
, "*** File has beenÅruncated.\n") ;

228 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_TXW
 | 
SF_FORMAT_PCM_16
 ;

229 
psf
->
sf
.
ch™√ls
 = 1 ;

230 
psf
->
sf
.
£˘i⁄s
 = 1 ;

231 
psf
->
sf
.
£ekabÀ
 = 
SF_TRUE
 ;

234 
	}
}

236 
sf_cou¡_t


237 
	$txw_ªad_s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

238 { *
u˝å
 ;

239 
ßm∂e
 ;

240 
k
, 
buf„æí
, 
ªadcou¡
, 
cou¡
 ;

241 
sf_cou¡_t
 
tŸÆ
 = 0 ;

243 
buf„æí
 =  (
psf
->
u
.
cbuf
) / 3 ;

244 
buf„æí
 -= (bufferlen & 1) ;

245 
Àn
 > 0)

246 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

247 
cou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
cbuf
, 3, 
ªadcou¡
,Ösf) ;

249 
u˝å
 = 
psf
->
u
.
ucbuf
 ;

250 
k
 = 0 ; k < 
ªadcou¡
 ; k += 2)

251 { 
ßm∂e
 = (
u˝å
 [0] << 8) | (ucptr [1] & 0xF0) ;

252 
±r
 [
tŸÆ
 + 
k
] = 
ßm∂e
 ;

253 
ßm∂e
 = (
u˝å
 [2] << 8) | ((ucptr [1] & 0xF) << 4) ;

254 
±r
 [
tŸÆ
 + 
k
 + 1] = 
ßm∂e
 ;

255 
u˝å
 += 3 ;

258 
tŸÆ
 +
cou¡
 ;

259 
Àn
 -
ªadcou¡
 ;

262  
tŸÆ
 ;

263 
	}
}

265 
sf_cou¡_t


266 
	$txw_ªad_i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

267 { *
u˝å
 ;

268 
ßm∂e
 ;

269 
k
, 
buf„æí
, 
ªadcou¡
, 
cou¡
 ;

270 
sf_cou¡_t
 
tŸÆ
 = 0 ;

272 
buf„æí
 =  (
psf
->
u
.
cbuf
) / 3 ;

273 
buf„æí
 -= (bufferlen & 1) ;

274 
Àn
 > 0)

275 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

276 
cou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
cbuf
, 3, 
ªadcou¡
,Ösf) ;

278 
u˝å
 = 
psf
->
u
.
ucbuf
 ;

279 
k
 = 0 ; k < 
ªadcou¡
 ; k += 2)

280 { 
ßm∂e
 = (
u˝å
 [0] << 8) | (ucptr [1] & 0xF0) ;

281 
±r
 [
tŸÆ
 + 
k
] = 
ßm∂e
 << 16 ;

282 
ßm∂e
 = (
u˝å
 [2] << 8) | ((ucptr [1] & 0xF) << 4) ;

283 
±r
 [
tŸÆ
 + 
k
 + 1] = 
ßm∂e
 << 16 ;

284 
u˝å
 += 3 ;

287 
tŸÆ
 +
cou¡
 ;

288 
Àn
 -
ªadcou¡
 ;

291  
tŸÆ
 ;

292 
	}
}

294 
sf_cou¡_t


295 
	$txw_ªad_f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

296 { *
u˝å
 ;

297 
ßm∂e
 ;

298 
k
, 
buf„æí
, 
ªadcou¡
, 
cou¡
 ;

299 
sf_cou¡_t
 
tŸÆ
 = 0 ;

300 
n‹mÁ˘
 ;

302 i‡(
psf
->
n‹m_Êﬂt
 =
SF_TRUE
)

303 
n‹mÁ˘
 = 1.0 / 0x8000 ;

305 
n‹mÁ˘
 = 1.0 / 0x10 ;

307 
buf„æí
 =  (
psf
->
u
.
cbuf
) / 3 ;

308 
buf„æí
 -= (bufferlen & 1) ;

309 
Àn
 > 0)

310 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

311 
cou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
cbuf
, 3, 
ªadcou¡
,Ösf) ;

313 
u˝å
 = 
psf
->
u
.
ucbuf
 ;

314 
k
 = 0 ; k < 
ªadcou¡
 ; k += 2)

315 { 
ßm∂e
 = (
u˝å
 [0] << 8) | (ucptr [1] & 0xF0) ;

316 
±r
 [
tŸÆ
 + 
k
] = 
n‹mÁ˘
 * 
ßm∂e
 ;

317 
ßm∂e
 = (
u˝å
 [2] << 8) | ((ucptr [1] & 0xF) << 4) ;

318 
±r
 [
tŸÆ
 + 
k
 + 1] = 
n‹mÁ˘
 * 
ßm∂e
 ;

319 
u˝å
 += 3 ;

322 
tŸÆ
 +
cou¡
 ;

323 
Àn
 -
ªadcou¡
 ;

326  
tŸÆ
 ;

327 
	}
}

329 
sf_cou¡_t


330 
	$txw_ªad_d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

331 { *
u˝å
 ;

332 
ßm∂e
 ;

333 
k
, 
buf„æí
, 
ªadcou¡
, 
cou¡
 ;

334 
sf_cou¡_t
 
tŸÆ
 = 0 ;

335 
n‹mÁ˘
 ;

337 i‡(
psf
->
n‹m_doubÀ
 =
SF_TRUE
)

338 
n‹mÁ˘
 = 1.0 / 0x8000 ;

340 
n‹mÁ˘
 = 1.0 / 0x10 ;

342 
buf„æí
 =  (
psf
->
u
.
cbuf
) / 3 ;

343 
buf„æí
 -= (bufferlen & 1) ;

344 
Àn
 > 0)

345 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen :Üen ;

346 
cou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
cbuf
, 3, 
ªadcou¡
,Ösf) ;

348 
u˝å
 = 
psf
->
u
.
ucbuf
 ;

349 
k
 = 0 ; k < 
ªadcou¡
 ; k += 2)

350 { 
ßm∂e
 = (
u˝å
 [0] << 8) | (ucptr [1] & 0xF0) ;

351 
±r
 [
tŸÆ
 + 
k
] = 
n‹mÁ˘
 * 
ßm∂e
 ;

352 
ßm∂e
 = (
u˝å
 [2] << 8) | ((ucptr [1] & 0xF) << 4) ;

353 
±r
 [
tŸÆ
 + 
k
 + 1] = 
n‹mÁ˘
 * 
ßm∂e
 ;

354 
u˝å
 += 3 ;

357 
tŸÆ
 +
cou¡
 ;

358 
Àn
 -
ªadcou¡
 ;

361  
tŸÆ
 ;

362 
	}
}

364 
sf_cou¡_t


365 
	$txw_£ek
 (
SF_PRIVATE
 *
psf
, 
mode
, 
sf_cou¡_t
 
off£t
)

366 { i‡(
psf
 && 
mode
)

367  
off£t
 ;

370 
	}
}

	@libsndfile-1.0.17/src/ulaw.c

19 
	~"¢dfûe.h
"

20 
	~"Êﬂt_ˇ°.h
"

21 
	~"comm⁄.h
"

23 
sf_cou¡_t
 
uœw_ªad_uœw2s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

24 
sf_cou¡_t
 
uœw_ªad_uœw2i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

25 
sf_cou¡_t
 
uœw_ªad_uœw2f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

26 
sf_cou¡_t
 
uœw_ªad_uœw2d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

28 
sf_cou¡_t
 
uœw_wrôe_s2uœw
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

29 
sf_cou¡_t
 
uœw_wrôe_i2uœw
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

30 
sf_cou¡_t
 
uœw_wrôe_f2uœw
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

31 
sf_cou¡_t
 
uœw_wrôe_d2uœw
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

34 
	$uœw_öô
 (
SF_PRIVATE
 *
psf
)

36 i‡(
psf
->
mode
 =
SFM_READ
 ||Ösf->modê=
SFM_RDWR
)

37 { 
psf
->
ªad_sh‹t
 = 
uœw_ªad_uœw2s
 ;

38 
psf
->
ªad_öt
 = 
uœw_ªad_uœw2i
 ;

39 
psf
->
ªad_Êﬂt
 = 
uœw_ªad_uœw2f
 ;

40 
psf
->
ªad_doubÀ
 = 
uœw_ªad_uœw2d
 ;

43 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

44 { 
psf
->
wrôe_sh‹t
 = 
uœw_wrôe_s2uœw
 ;

45 
psf
->
wrôe_öt
 = 
uœw_wrôe_i2uœw
 ;

46 
psf
->
wrôe_Êﬂt
 = 
uœw_wrôe_f2uœw
 ;

47 
psf
->
wrôe_doubÀ
 = 
uœw_wrôe_d2uœw
 ;

50 
psf
->
byãwidth
 = 1 ;

51 
psf
->
blockwidth
 =Ösf->
sf
.
ch™√ls
 ;

53 i‡(
psf
->
fûñígth
 >Ösf->
d©aoff£t
)

54 
psf
->
d©Æígth
 = (psf->
d©´nd
Ë?Ösf->d©´nd -Ösf->
d©aoff£t
 :

55 
psf
->
fûñígth
 -Ösf->
d©aoff£t
 ;

57 
psf
->
d©Æígth
 = 0 ;

59 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 /Ösf->
blockwidth
 ;

62 
	}
}

67 
	guœw_decode
 [256] =

104 
	guœw_ícode
 [8193] =

790 
ölöe
 

791 
	$uœw2s_¨øy
 (*
buf„r
, 
cou¡
, *
±r
)

792 { --
cou¡
 >= 0)

793 
±r
 [
cou¡
] = 
uœw_decode
 [(Ë
buf„r
 [count]] ;

794 
	}
}

796 
ölöe
 

797 
	$uœw2i_¨øy
 (*
buf„r
, 
cou¡
, *
±r
)

798 { --
cou¡
 >= 0)

799 
±r
 [
cou¡
] = 
uœw_decode
 [
buf„r
 [count]] << 16 ;

800 
	}
}

802 
ölöe
 

803 
	$uœw2f_¨øy
 (*
buf„r
, 
cou¡
, *
±r
, 
n‹mÁ˘
)

804 { --
cou¡
 >= 0)

805 
±r
 [
cou¡
] = 
n‹mÁ˘
 * 
uœw_decode
 [(Ë
buf„r
 [count]] ;

806 
	}
}

808 
ölöe
 

809 
	$uœw2d_¨øy
 (c⁄° *
buf„r
, 
cou¡
, *
±r
, 
n‹mÁ˘
)

810 { --
cou¡
 >= 0)

811 
±r
 [
cou¡
] = 
n‹mÁ˘
 * 
uœw_decode
 [(Ë
buf„r
 [count]] ;

812 
	}
}

814 
ölöe
 

815 
	$s2uœw_¨øy
 (c⁄° *
±r
, 
cou¡
, *
buf„r
)

816 { --
cou¡
 >= 0)

817 { i‡(
±r
 [
cou¡
] >= 0)

818 
buf„r
 [
cou¡
] = 
uœw_ícode
 [
±r
 [count] / 4] ;

820 
buf„r
 [
cou¡
] = 0x7F & 
uœw_ícode
 [
±r
 [count] / -4] ;

822 
	}
}

824 
ölöe
 

825 
	$i2uœw_¨øy
 (c⁄° *
±r
, 
cou¡
, *
buf„r
)

826 { --
cou¡
 >= 0)

827 { i‡(
±r
 [
cou¡
] >= 0)

828 
buf„r
 [
cou¡
] = 
uœw_ícode
 [
±r
 [count] >> (16 + 2)] ;

830 
buf„r
 [
cou¡
] = 0x7F & 
uœw_ícode
 [-
±r
 [count] >> (16 + 2)] ;

832 
	}
}

834 
ölöe
 

835 
	$f2uœw_¨øy
 (c⁄° *
±r
, 
cou¡
, *
buf„r
, 
n‹mÁ˘
)

836 { --
cou¡
 >= 0)

837 { i‡(
±r
 [
cou¡
] >= 0)

838 
buf„r
 [
cou¡
] = 
uœw_ícode
 [
	`Ãötf
 (
n‹mÁ˘
 * 
±r
 [count])] ;

840 
buf„r
 [
cou¡
] = 0x7F & 
uœw_ícode
 [- 
	`Ãötf
 (
n‹mÁ˘
 * 
±r
 [count])] ;

842 
	}
}

844 
ölöe
 

845 
	$d2uœw_¨øy
 (c⁄° *
±r
, 
cou¡
, *
buf„r
, 
n‹mÁ˘
)

846 { --
cou¡
 >= 0)

847 { i‡(
±r
 [
cou¡
] >= 0)

848 
buf„r
 [
cou¡
] = 
uœw_ícode
 [
	`Ãöt
 (
n‹mÁ˘
 * 
±r
 [count])] ;

850 
buf„r
 [
cou¡
] = 0x7F & 
uœw_ícode
 [- 
	`Ãöt
 (
n‹mÁ˘
 * 
±r
 [count])] ;

852 
	}
}

857 
sf_cou¡_t


858 
	$uœw_ªad_uœw2s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

859 { 
buf„æí
, 
ªadcou¡
 ;

860 
sf_cou¡_t
 
tŸÆ
 = 0 ;

862 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

864 
Àn
 > 0)

865 { i‡(
Àn
 < 
buf„æí
)

866 
buf„æí
 = (Ë
Àn
 ;

867 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ucbuf
, 1, 
buf„æí
,Ösf) ;

868 
	`uœw2s_¨øy
 (
psf
->
u
.
ucbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

869 
tŸÆ
 +
ªadcou¡
 ;

870 i‡(
ªadcou¡
 < 
buf„æí
)

872 
Àn
 -
ªadcou¡
 ;

875  
tŸÆ
 ;

876 
	}
}

878 
sf_cou¡_t


879 
	$uœw_ªad_uœw2i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

880 { 
buf„æí
, 
ªadcou¡
 ;

881 
sf_cou¡_t
 
tŸÆ
 = 0 ;

883 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

885 
Àn
 > 0)

886 { i‡(
Àn
 < 
buf„æí
)

887 
buf„æí
 = (Ë
Àn
 ;

888 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ucbuf
, 1, 
buf„æí
,Ösf) ;

889 
	`uœw2i_¨øy
 (
psf
->
u
.
ucbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

890 
tŸÆ
 +
ªadcou¡
 ;

891 i‡(
ªadcou¡
 < 
buf„æí
)

893 
Àn
 -
ªadcou¡
 ;

896  
tŸÆ
 ;

897 
	}
}

899 
sf_cou¡_t


900 
	$uœw_ªad_uœw2f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

901 { 
buf„æí
, 
ªadcou¡
 ;

902 
sf_cou¡_t
 
tŸÆ
 = 0 ;

903 
n‹mÁ˘
 ;

905 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? 1.0 / (() 0x8000) : 1.0 ;

907 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

909 
Àn
 > 0)

910 { i‡(
Àn
 < 
buf„æí
)

911 
buf„æí
 = (Ë
Àn
 ;

912 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ucbuf
, 1, 
buf„æí
,Ösf) ;

913 
	`uœw2f_¨øy
 (
psf
->
u
.
ucbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

914 
tŸÆ
 +
ªadcou¡
 ;

915 i‡(
ªadcou¡
 < 
buf„æí
)

917 
Àn
 -
ªadcou¡
 ;

920  
tŸÆ
 ;

921 
	}
}

923 
sf_cou¡_t


924 
	$uœw_ªad_uœw2d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

925 { 
buf„æí
, 
ªadcou¡
 ;

926 
sf_cou¡_t
 
tŸÆ
 = 0 ;

927 
n‹mÁ˘
 ;

929 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
) ? 1.0 / (() 0x8000) : 1.0 ;

930 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

932 
Àn
 > 0)

933 { i‡(
Àn
 < 
buf„æí
)

934 
buf„æí
 = (Ë
Àn
 ;

935 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
ucbuf
, 1, 
buf„æí
,Ösf) ;

936 
	`uœw2d_¨øy
 (
psf
->
u
.
ucbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

937 
tŸÆ
 +
ªadcou¡
 ;

938 i‡(
ªadcou¡
 < 
buf„æí
)

940 
Àn
 -
ªadcou¡
 ;

943  
tŸÆ
 ;

944 
	}
}

949 
sf_cou¡_t


950 
	$uœw_wrôe_s2uœw
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

951 { 
buf„æí
, 
wrôecou¡
 ;

952 
sf_cou¡_t
 
tŸÆ
 = 0 ;

954 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

956 
Àn
 > 0)

957 { i‡(
Àn
 < 
buf„æí
)

958 
buf„æí
 = (Ë
Àn
 ;

959 
	`s2uœw_¨øy
 (
±r
 + 
tŸÆ
, 
buf„æí
, 
psf
->
u
.
ucbuf
) ;

960 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ucbuf
, 1, 
buf„æí
,Ösf) ;

961 
tŸÆ
 +
wrôecou¡
 ;

962 i‡(
wrôecou¡
 < 
buf„æí
)

964 
Àn
 -
wrôecou¡
 ;

967  
tŸÆ
 ;

968 
	}
}

970 
sf_cou¡_t


971 
	$uœw_wrôe_i2uœw
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

972 { 
buf„æí
, 
wrôecou¡
 ;

973 
sf_cou¡_t
 
tŸÆ
 = 0 ;

975 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

977 
Àn
 > 0)

978 { i‡(
Àn
 < 
buf„æí
)

979 
buf„æí
 = (Ë
Àn
 ;

980 
	`i2uœw_¨øy
 (
±r
 + 
tŸÆ
, 
buf„æí
, 
psf
->
u
.
ucbuf
) ;

981 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ucbuf
, 1, 
buf„æí
,Ösf) ;

982 
tŸÆ
 +
wrôecou¡
 ;

983 i‡(
wrôecou¡
 < 
buf„æí
)

985 
Àn
 -
wrôecou¡
 ;

988  
tŸÆ
 ;

989 
	}
}

991 
sf_cou¡_t


992 
	$uœw_wrôe_f2uœw
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

993 { 
buf„æí
, 
wrôecou¡
 ;

994 
sf_cou¡_t
 
tŸÆ
 = 0 ;

995 
n‹mÁ˘
 ;

998 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? (0.25 * 0x7FFF) : 0.25 ;

1000 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

1002 
Àn
 > 0)

1003 { i‡(
Àn
 < 
buf„æí
)

1004 
buf„æí
 = (Ë
Àn
 ;

1005 
	`f2uœw_¨øy
 (
±r
 + 
tŸÆ
, 
buf„æí
, 
psf
->
u
.
ucbuf
, 
n‹mÁ˘
) ;

1006 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ucbuf
, 1, 
buf„æí
,Ösf) ;

1007 
tŸÆ
 +
wrôecou¡
 ;

1008 i‡(
wrôecou¡
 < 
buf„æí
)

1010 
Àn
 -
wrôecou¡
 ;

1013  
tŸÆ
 ;

1014 
	}
}

1016 
sf_cou¡_t


1017 
	$uœw_wrôe_d2uœw
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

1018 { 
buf„æí
, 
wrôecou¡
 ;

1019 
sf_cou¡_t
 
tŸÆ
 = 0 ;

1020 
n‹mÁ˘
 ;

1023 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
) ? (0.25 * 0x7FFF) : 0.25 ;

1025 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

1027 
Àn
 > 0)

1028 { i‡(
Àn
 < 
buf„æí
)

1029 
buf„æí
 = (Ë
Àn
 ;

1030 
	`d2uœw_¨øy
 (
±r
 + 
tŸÆ
, 
buf„æí
, 
psf
->
u
.
ucbuf
, 
n‹mÁ˘
) ;

1031 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
ucbuf
, 1, 
buf„æí
,Ösf) ;

1032 
tŸÆ
 +
wrôecou¡
 ;

1033 i‡(
wrôecou¡
 < 
buf„æí
)

1035 
Àn
 -
wrôecou¡
 ;

1038  
tŸÆ
 ;

1039 
	}
}

	@libsndfile-1.0.17/src/voc.c

27 
	~"sfc⁄fig.h
"

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

33 
	~"¢dfûe.h
"

34 
	~"s„ndün.h
"

35 
	~"comm⁄.h
"

42 
	#VOC_MAX_SECTIONS
 200

	)

45 { 
	mVOC_TERMINATOR
 = 0,

46 
	mVOC_SOUND_DATA
 = 1,

47 
	mVOC_SOUND_CONTINUE
 = 2,

48 
	mVOC_SILENCE
 = 3,

49 
	mVOC_MARKER
 = 4,

50 
	mVOC_ASCII
 = 5,

51 
	mVOC_REPEAT
 = 6,

52 
	mVOC_END_REPEAT
 = 7,

53 
	mVOC_EXTENDED
 = 8,

54 
	mVOC_EXTENDED_II
 = 9

58 { 
	mßm∂es
 ;

59 
	moff£t
 ;

60 } 
	tSND_DATA_BLOCKS
 ;

63 { 
	m£˘i⁄s
, 
	m£˘i⁄_ty≥s
 ;

64 
	mßm∂î©e
, 
	mch™√ls
, 
	mbôwidth
 ;

65 
SND_DATA_BLOCKS
 
	mblocks
 [
VOC_MAX_SECTIONS
] ;

66 } 
	tVOC_DATA
 ;

72 
voc_˛o£
 (
SF_PRIVATE
 *
psf
) ;

73 
voc_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
) ;

74 
voc_ªad_hódî
 (
SF_PRIVATE
 *
psf
) ;

76 c⁄° * 
voc_ícodög2°r
 (
ícodög
) ;

84 
voc_mu…i_öô
 (
SF_PRIVATE
 *
psf
, 
VOC_DATA
 *
pvoc
) ;

86 
voc_mu…i_ªad_uc2s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
Àn
) ;

87 
voc_mu…i_ªad_Às2s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
Àn
) ;

89 
voc_mu…i_ªad_uc2i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
Àn
) ;

90 
voc_mu…i_ªad_Às2i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
Àn
) ;

92 
voc_mu…i_ªad_uc2f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
Àn
) ;

93 
voc_mu…i_ªad_Às2f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
Àn
) ;

95 
voc_mu…i_ªad_uc2d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
Àn
) ;

96 
voc_mu…i_ªad_Às2d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
Àn
) ;

104 
	$voc_›í
 (
SF_PRIVATE
 *
psf
)

105 { 
subf‹m©
, 
îr‹
 = 0 ;

107 i‡(
psf
->
is_pùe
)

108  
SFE_VOC_NO_PIPE
 ;

110 i‡(
psf
->
mode
 =
SFM_READ
 || (psf->modê=
SFM_RDWR
 &&Ösf->
fûñígth
 > 0))

111 { i‡((
îr‹
 = 
	`voc_ªad_hódî
 (
psf
)))

112  
îr‹
 ;

115 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

117 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

118 { i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_VOC
)

119  
SFE_BAD_OPEN_FORMAT
 ;

121 
psf
->
ídün
 = 
SF_ENDIAN_LITTLE
 ;

123 i‡((
îr‹
 = 
	`voc_wrôe_hódî
 (
psf
, 
SF_FALSE
)))

124  
îr‹
 ;

126 
psf
->
wrôe_hódî
 = 
voc_wrôe_hódî
 ;

129 
psf
->
blockwidth
 =Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

131 
psf
->
c⁄èöî_˛o£
 = 
voc_˛o£
 ;

133 
subf‹m©
)

134 { 
SF_FORMAT_PCM_U8
 :

135 
SF_FORMAT_PCM_16
 :

136 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

139 
SF_FORMAT_ALAW
 :

140 
îr‹
 = 
	`Æaw_öô
 (
psf
) ;

143 
SF_FORMAT_ULAW
 :

144 
îr‹
 = 
	`uœw_öô
 (
psf
) ;

147  :  
SFE_UNIMPLEMENTED
 ;

150  
îr‹
 ;

151 
	}
}

157 
	$voc_ªad_hódî
 (
SF_PRIVATE
 *
psf
)

158 { 
VOC_DATA
 *
pvoc
 ;

159 
¸ótive
 [20] ;

160 
block_ty≥
, 
øã_byã
 ;

161 
vîsi⁄
, 
checksum
, 
ícodög
, 
d©aoff£t
 ;

162 
off£t
 ;

165 
off£t
 = 
	`psf_böhódî_ªadf
 (
psf
, "pb", 0, 
¸ótive
, 
	`SIGNED_SIZEOF
 (creative)) ;

167 i‡(
¸ótive
 [ (creative) - 1] != 0x1A)

168  
SFE_VOC_NO_CREATIVE
 ;

171 
¸ótive
 [ (creative) - 1] = 0 ;

173 i‡(
	`°rcmp
 ("Cª©ivêVoi˚ Fûe", 
¸ótive
))

174  
SFE_VOC_NO_CREATIVE
 ;

176 
	`psf_log_¥ötf
 (
psf
, "%s\n", 
¸ótive
) ;

178 
off£t
 +
	`psf_böhódî_ªadf
 (
psf
, "e222", &
d©aoff£t
, &
vîsi⁄
, &
checksum
) ;

180 
psf
->
d©aoff£t
 = dataoffset ;

182 
	`psf_log_¥ötf
 (
psf
, "dataoffset : %d\n"

184 "checksum : 0x%X\n", 
psf
->
d©aoff£t
, 
vîsi⁄
, 
checksum
) ;

186 i‡(
vîsi⁄
 != 0x010A && version != 0x0114)

187  
SFE_VOC_BAD_VERSION
 ;

189 i‡(! (
psf
->
codec_d©a
 = 
	`mÆloc
 ( (
VOC_DATA
))))

190  
SFE_MALLOC_FAILED
 ;

192 
pvoc
 = (
VOC_DATA
*Ë
psf
->
codec_d©a
 ;

194 
	`mem£t
 (
pvoc
, 0,  (
VOC_DATA
)) ;

197 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_VOC
 ;

198 
ícodög
 = 
SF_FORMAT_PCM_U8
 ;

199 
psf
->
ídün
 = 
SF_ENDIAN_LITTLE
 ;

202 { 
off£t
 +
	`psf_böhódî_ªadf
 (
psf
, "1", &
block_ty≥
) ;

204 
block_ty≥
)

205 { 
VOC_ASCII
 :

206 { 
size
 ;

208 
off£t
 +
	`psf_böhódî_ªadf
 (
psf
, "e3", &
size
) ;

210 
	`psf_log_¥ötf
 (
psf
, " ASCII : %d\n", 
size
) ;

212 
off£t
 +
	`psf_böhódî_ªadf
 (
psf
, "b",Ösf->
hódî
, 
size
) ;

213 
psf
->
hódî
 [
size
] = 0 ;

214 
	`psf_log_¥ötf
 (
psf
, "Åexà: %s\n",Ösf->
hódî
) ;

218 
VOC_SOUND_DATA
 :

219 
VOC_EXTENDED
 :

220 
VOC_EXTENDED_II
 :

223  : 
	`psf_log_¥ötf
 (
psf
, "*** Weúd block m¨kî (%d)\n", 
block_ty≥
) ;

229 i‡(
block_ty≥
 =
VOC_SOUND_DATA
)

230 { 
com¥essi⁄
 ;

231 
size
 ;

233 
off£t
 +
	`psf_böhódî_ªadf
 (
psf
, "e311", &
size
, &
øã_byã
, &
com¥essi⁄
) ;

235 
psf
->
sf
.
ßm∂î©e
 = 1000000 / (256 - (
øã_byã
 & 0xFF)) ;

237 
	`psf_log_¥ötf
 (
psf
, " Sound Data : %d\n sr : %d => %dHz\n comp : %d\n",

238 
size
, 
øã_byã
, 
psf
->
sf
.
ßm∂î©e
, 
com¥essi⁄
) ;

240 i‡(
off£t
 + 
size
 - 1 > 
psf
->
fûñígth
)

241 { 
	`psf_log_¥ötf
 (
psf
, "SeemsÅo beáÅruncated file.\n") ;

242 
	`psf_log_¥ötf
 (
psf
, "off£t: %d size: %d sum: %d fûñígth: %D\n", 
off£t
, 
size
, off£à+ size,Ösf->
fûñígth
) ;

243  
SFE_VOC_BAD_SECTIONS
 ;

245 i‡(
off£t
 + 
size
 - 1 < 
psf
->
fûñígth
)

246 { 
	`psf_log_¥ötf
 (
psf
, "SeemsÅo beá multi-segment file (#1).\n") ;

247 
	`psf_log_¥ötf
 (
psf
, "off£t: %d size: %d sum: %d fûñígth: %D\n", 
off£t
, 
size
, off£à+ size,Ösf->
fûñígth
) ;

248  
SFE_VOC_BAD_SECTIONS
 ;

251 
psf
->
d©aoff£t
 = 
off£t
 ;

252 
psf
->
d©´nd
 =Ösf->
fûñígth
 - 1 ;

254 
psf
->
sf
.
ch™√ls
 = 1 ;

255 
psf
->
byãwidth
 = 1 ;

257 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_VOC
 | 
SF_FORMAT_PCM_U8
 ;

262 i‡(
block_ty≥
 =
VOC_EXTENDED
)

263 { 
∑ck
, 
°îeo
, 
com¥essi⁄
 ;

264 
øã_sh‹t
 ;

265 
size
 ;

267 
off£t
 +
	`psf_böhódî_ªadf
 (
psf
, "e3211", &
size
, &
øã_sh‹t
, &
∑ck
, &
°îeo
) ;

269 
	`psf_log_¥ötf
 (
psf
, " Exãnded : %d\n", 
size
) ;

270 i‡(
size
 == 4)

271 
	`psf_log_¥ötf
 (
psf
, " size : 4\n") ;

273 
	`psf_log_¥ötf
 (
psf
, " sizê : %d (should bê4)\n", 
size
) ;

275 
	`psf_log_¥ötf
 (
psf
, "Öack : %d\n"

276 " sãªÿ: %s\n", 
∑ck
, (
°îeo
 ? "yes" : "no")) ;

278 i‡(
°îeo
)

279 { 
psf
->
sf
.
ch™√ls
 = 2 ;

280 
psf
->
sf
.
ßm∂î©e
 = 128000000 / (65536 - 
øã_sh‹t
) ;

283 { 
psf
->
sf
.
ch™√ls
 = 1 ;

284 
psf
->
sf
.
ßm∂î©e
 = 256000000 / (65536 - 
øã_sh‹t
) ;

287 
	`psf_log_¥ötf
 (
psf
, " s∏ : %d => %dHz\n", (
øã_sh‹t
 & 0xFFFF),Ösf->
sf
.
ßm∂î©e
) ;

289 
off£t
 +
	`psf_böhódî_ªadf
 (
psf
, "1", &
block_ty≥
) ;

291 i‡(
block_ty≥
 !
VOC_SOUND_DATA
)

292 { 
	`psf_log_¥ötf
 (
psf
, "*** Expecting VOC_SOUND_DATA section.\n") ;

293  
SFE_VOC_BAD_FORMAT
 ;

296 
off£t
 +
	`psf_böhódî_ªadf
 (
psf
, "e311", &
size
, &
øã_byã
, &
com¥essi⁄
) ;

298 
	`psf_log_¥ötf
 (
psf
, " Sound Data : %d\n"

300 " com∞ : %d\n", 
size
, 
øã_byã
, 
com¥essi⁄
) ;

303 i‡(
off£t
 + 
size
 - 1 > 
psf
->
fûñígth
)

304 { 
	`psf_log_¥ötf
 (
psf
, "SeemsÅo beáÅruncated file.\n") ;

305 
	`psf_log_¥ötf
 (
psf
, "off£t: %d size: %d sum: %d fûñígth: %D\n", 
off£t
, 
size
, off£à+ size,Ösf->
fûñígth
) ;

306  
SFE_VOC_BAD_SECTIONS
 ;

308 i‡(
off£t
 + 
size
 - 1 < 
psf
->
fûñígth
)

309 { 
	`psf_log_¥ötf
 (
psf
, "SeemsÅo beá multi-segment file (#2).\n") ;

310 
	`psf_log_¥ötf
 (
psf
, "off£t: %d size: %d sum: %d fûñígth: %D\n", 
off£t
, 
size
, off£à+ size,Ösf->
fûñígth
) ;

311  
SFE_VOC_BAD_SECTIONS
 ;

314 
psf
->
d©aoff£t
 = 
off£t
 ;

315 
psf
->
d©´nd
 =Ösf->
fûñígth
 - 1 ;

317 
psf
->
byãwidth
 = 1 ;

319 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_VOC
 | 
SF_FORMAT_PCM_U8
 ;

324 i‡(
block_ty≥
 =
VOC_EXTENDED_II
)

325 { 
bôwidth
, 
ch™√ls
 ;

326 
size
, 
fourbyãs
 ;

328 
off£t
 +
	`psf_böhódî_ªadf
 (
psf
, "e341124", &
size
, &psf->
sf
.
ßm∂î©e
,

329 &
bôwidth
, &
ch™√ls
, &
ícodög
, &
fourbyãs
) ;

331 i‡(
size
 * 2 =
psf
->
fûñígth
 - 39)

332 { 
ãmp_size
 = 
psf
->
fûñígth
 - 31 ;

334 
	`psf_log_¥ötf
 (
psf
, " Exãnded II : %d (SoX bug: should bê%d)\n", 
size
, 
ãmp_size
) ;

335 
size
 = 
ãmp_size
 ;

338 
	`psf_log_¥ötf
 (
psf
, " Exãnded II : %d\n", 
size
) ;

340 
	`psf_log_¥ötf
 (
psf
, " sampleÑate : %d\n"

342 " ch™√l† : %d\n", 
psf
->
sf
.
ßm∂î©e
, 
bôwidth
, 
ch™√ls
) ;

344 i‡(
bôwidth
 =16 && 
ícodög
 == 0)

345 { 
ícodög
 = 4 ;

346 
	`psf_log_¥ötf
 (
psf
, "Éncoding : 0 (SoX bug: should be 4 for 16 bit signed PCM)\n") ;

349 
	`psf_log_¥ötf
 (
psf
, "Éncodög : %d => %s\n", 
ícodög
, 
	`voc_ícodög2°r
 (encoding)) ;

352 
	`psf_log_¥ötf
 (
psf
, " fourbyã† : %X\n", 
fourbyãs
) ;

354 
psf
->
sf
.
ch™√ls
 = channels ;

356 
psf
->
d©aoff£t
 = 
off£t
 ;

357 
psf
->
d©´nd
 =Ösf->
fûñígth
 - 1 ;

359 i‡(
size
 + 31 =
psf
->
fûñígth
 + 1)

363 
	`psf_log_¥ötf
 (
psf
, "Missing zero byteátÉnd of file.\n") ;

364 
size
 = 
psf
->
fûñígth
 - 30 ;

365 
psf
->
d©´nd
 = 0 ;

367 i‡(
size
 + 31 > 
psf
->
fûñígth
)

368 { 
	`psf_log_¥ötf
 (
psf
, "SeemsÅo beáÅruncated file.\n") ;

369 
size
 = 
psf
->
fûñígth
 - 31 ;

371 i‡(
size
 + 31 < 
psf
->
fûñígth
)

372 
	`psf_log_¥ötf
 (
psf
, "SeemsÅo beá multi-segment file (#3).\n") ;

374 
ícodög
)

376 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_VOC
 | 
SF_FORMAT_PCM_U8
 ;

377 
psf
->
byãwidth
 = 1 ;

381 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_VOC
 | 
SF_FORMAT_PCM_16
 ;

382 
psf
->
byãwidth
 = 2 ;

386 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_VOC
 | 
SF_FORMAT_ALAW
 ;

387 
psf
->
byãwidth
 = 1 ;

391 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_VOC
 | 
SF_FORMAT_ULAW
 ;

392 
psf
->
byãwidth
 = 1 ;

396  
SFE_UNKNOWN_FORMAT
 ;

403 
	}
}

409 
	$voc_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
)

410 { 
sf_cou¡_t
 
cuºít
 ;

411 
øã_c⁄°
, 
subf‹m©
 ;

413 
cuºít
 = 
	`psf_·ñl
 (
psf
) ;

415 i‡(
ˇlc_Àngth
)

416 { 
psf
->
fûñígth
 = 
	`psf_gë_fûñí
 (psf) ;

418 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

419 i‡(
psf
->
d©´nd
)

420 
psf
->
d©Æígth
 -psf->
fûñígth
 -Ösf->
d©´nd
 ;

422 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 / (psf->
byãwidth
 *Ösf->sf.
ch™√ls
) ;

425 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

427 
psf
->
hódî
 [0] = 0 ;

428 
psf
->
hódödex
 = 0 ;

429 
	`psf_f£ek
 (
psf
, 0, 
SEEK_SET
) ;

432 
	`psf_böhódî_wrôef
 (
psf
, "eb1", "Cª©ivêVoi˚ Fûe", 
	`make_size_t
 (19), 0x1A) ;

435 
	`psf_böhódî_wrôef
 (
psf
, "e222", 26, 0x0114, 0x111F) ;

443 i‡(
subf‹m©
 =
SF_FORMAT_PCM_U8
 && 
psf
->
sf
.
ch™√ls
 == 1)

445 
øã_c⁄°
 = 256 - 1000000 / 
psf
->
sf
.
ßm∂î©e
 ;

448 
	`psf_böhódî_wrôef
 (
psf
, "e1311", 
VOC_SOUND_DATA
, (Ë’sf->
d©Æígth
 + 1), 
øã_c⁄°
, 0) ;

450 i‡(
subf‹m©
 =
SF_FORMAT_PCM_U8
 && 
psf
->
sf
.
ch™√ls
 == 2)

452 
øã_c⁄°
 = 65536 - 128000000 / 
psf
->
sf
.
ßm∂î©e
 ;

457 
	`psf_böhódî_wrôef
 (
psf
, "e13211", 
VOC_EXTENDED
, 4, 
øã_c⁄°
, 0, 1) ;

460 
øã_c⁄°
 = 256 - 1000000 / 
psf
->
sf
.
ßm∂î©e
 ;

465 
	`psf_böhódî_wrôef
 (
psf
, "e1311", 
VOC_SOUND_DATA
, (Ë’sf->
d©Æígth
 + 1), 
øã_c⁄°
, 0) ;

468 { 
Àngth
 ;

470 i‡(
psf
->
sf
.
ch™√ls
 < 1 ||Ösf->sf.channels > 2)

471  
SFE_CHANNEL_COUNT
 ;

473 
subf‹m©
)

474 { 
SF_FORMAT_PCM_U8
 :

475 
psf
->
byãwidth
 = 1 ;

476 
Àngth
 = 
psf
->
sf
.
‰ames
 *Ösf->sf.
ch™√ls
 *Ösf->
byãwidth
 + 12 ;

478 
	`psf_böhódî_wrôef
 (
psf
, "e1341124", 
VOC_EXTENDED_II
, 
Àngth
,Ösf->
sf
.
ßm∂î©e
, 16,Ösf->sf.
ch™√ls
, 4, 0) ;

481 
SF_FORMAT_PCM_16
 :

482 
psf
->
byãwidth
 = 2 ;

483 
Àngth
 = 
psf
->
sf
.
‰ames
 *Ösf->sf.
ch™√ls
 *Ösf->
byãwidth
 + 12 ;

485 
	`psf_böhódî_wrôef
 (
psf
, "e1341124", 
VOC_EXTENDED_II
, 
Àngth
,Ösf->
sf
.
ßm∂î©e
, 16,Ösf->sf.
ch™√ls
, 4, 0) ;

488 
SF_FORMAT_ALAW
 :

489 
psf
->
byãwidth
 = 1 ;

490 
Àngth
 = 
psf
->
sf
.
‰ames
 *Ösf->sf.
ch™√ls
 *Ösf->
byãwidth
 + 12 ;

491 
	`psf_böhódî_wrôef
 (
psf
, "e1341124", 
VOC_EXTENDED_II
, 
Àngth
,Ösf->
sf
.
ßm∂î©e
, 8,Ösf->sf.
ch™√ls
, 6, 0) ;

494 
SF_FORMAT_ULAW
 :

495 
psf
->
byãwidth
 = 1 ;

496 
Àngth
 = 
psf
->
sf
.
‰ames
 *Ösf->sf.
ch™√ls
 *Ösf->
byãwidth
 + 12 ;

497 
	`psf_böhódî_wrôef
 (
psf
, "e1341124", 
VOC_EXTENDED_II
, 
Àngth
,Ösf->
sf
.
ßm∂î©e
, 8,Ösf->sf.
ch™√ls
, 7, 0) ;

500  :  
SFE_UNIMPLEMENTED
 ;

504 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

506 i‡(
psf
->
îr‹
)

507  
psf
->
îr‹
 ;

509 
psf
->
d©aoff£t
 =Ösf->
hódödex
 ;

511 i‡(
cuºít
 > 0)

512 
	`psf_f£ek
 (
psf
, 
cuºít
, 
SEEK_SET
) ;

514  
psf
->
îr‹
 ;

515 
	}
}

518 
	$voc_˛o£
 (
SF_PRIVATE
 *
psf
)

520 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

524 
byã
 = 
VOC_TERMINATOR
 ;

527 
	`psf_f£ek
 (
psf
, 0, 
SEEK_END
) ;

530 
	`psf_fwrôe
 (&
byã
, 1, 1, 
psf
) ;

532 
	`voc_wrôe_hódî
 (
psf
, 
SF_TRUE
) ;

536 
	}
}

539 
	$voc_ícodög2°r
 (
ícodög
)

541 
ícodög
)

549 
	}
}

556 
	$voc_mu…i_öô
 (
SF_PRIVATE
 *
psf
, 
VOC_DATA
 *
pvoc
)

558 
psf
->
sf
.
‰ames
 = 0 ;

560 i‡(
pvoc
->
bôwidth
 == 8)

561 { 
psf
->
ªad_sh‹t
 = 
voc_mu…i_ªad_uc2s
 ;

562 
psf
->
ªad_öt
 = 
voc_mu…i_ªad_uc2i
 ;

563 
psf
->
ªad_Êﬂt
 = 
voc_mu…i_ªad_uc2f
 ;

564 
psf
->
ªad_doubÀ
 = 
voc_mu…i_ªad_uc2d
 ;

568 i‡(
pvoc
->
bôwidth
 == 16)

569 { 
psf
->
ªad_sh‹t
 = 
voc_mu…i_ªad_Às2s
 ;

570 
psf
->
ªad_öt
 = 
voc_mu…i_ªad_Às2i
 ;

571 
psf
->
ªad_Êﬂt
 = 
voc_mu…i_ªad_Às2f
 ;

572 
psf
->
ªad_doubÀ
 = 
voc_mu…i_ªad_Às2d
 ;

576 
	`psf_log_¥ötf
 (
psf
, "Error : bitwith != 8 && bitwidth != 16.\n") ;

578  
SFE_UNIMPLEMENTED
 ;

579 
	}
}

585 
	$voc_mu…i_ªad_uc2s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
Àn
)

589 
	}
}

592 
	$voc_mu…i_ªad_Às2s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
Àn
)

596 
	}
}

600 
	$voc_mu…i_ªad_uc2i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
Àn
)

604 
	}
}

607 
	$voc_mu…i_ªad_Às2i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
Àn
)

611 
	}
}

615 
	$voc_mu…i_ªad_uc2f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
Àn
)

619 
	}
}

622 
	$voc_mu…i_ªad_Às2f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
Àn
)

626 
	}
}

630 
	$voc_mu…i_ªad_uc2d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
Àn
)

634 
	}
}

637 
	$voc_mu…i_ªad_Às2d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
Àn
)

641 
	}
}

	@libsndfile-1.0.17/src/vox_adpcm.c

32 
	~"sfc⁄fig.h
"

34 
	~<°dio.h
>

35 
	~<°dlib.h
>

36 
	~<°rög.h
>

38 
	~"¢dfûe.h
"

39 
	~"s„ndün.h
"

40 
	~"Êﬂt_ˇ°.h
"

41 
	~"comm⁄.h
"

43 
	#VOX_DATA_LEN
 2048

	)

44 
	#PCM_DATA_LEN
 (
VOX_DATA_LEN
 *2)

	)

47 { 
	mœ°
 ;

48 
	m°ï_ödex
 ;

50 
	mvox_byãs
, 
	mpcm_ßm∂es
 ;

52 
	mvox_d©a
 [
VOX_DATA_LEN
] ;

53 
	mpcm_d©a
 [
PCM_DATA_LEN
] ;

54 } 
	tVOX_ADPCM_PRIVATE
 ;

56 
vox_adpcm_ícode_block
 (
VOX_ADPCM_PRIVATE
 *
pvox
) ;

57 
vox_adpcm_decode_block
 (
VOX_ADPCM_PRIVATE
 *
pvox
) ;

59 
vox_adpcm_decode
 (
code
, 
VOX_ADPCM_PRIVATE
 *
pvox
) ;

60 
vox_adpcm_ícode
 (
ßmp
, 
VOX_ADPCM_PRIVATE
 *
pvox
) ;

62 
sf_cou¡_t
 
vox_ªad_s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

63 
sf_cou¡_t
 
vox_ªad_i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

64 
sf_cou¡_t
 
vox_ªad_f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

65 
sf_cou¡_t
 
vox_ªad_d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

67 
sf_cou¡_t
 
vox_wrôe_s
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

68 
sf_cou¡_t
 
vox_wrôe_i
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

69 
sf_cou¡_t
 
vox_wrôe_f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

70 
sf_cou¡_t
 
vox_wrôe_d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

72 
vox_ªad_block
 (
SF_PRIVATE
 *
psf
, 
VOX_ADPCM_PRIVATE
 *
pvox
, *
±r
, 
Àn
) ;

78 
	g°ï_size_èbÀ
 [49] =

85 
	g°ï_adju°_èbÀ
 [8] =

93 
	$vox_adpcm_öô
 (
SF_PRIVATE
 *
psf
)

94 { 
VOX_ADPCM_PRIVATE
 *
pvox
 = 
NULL
 ;

96 i‡(
psf
->
mode
 =
SFM_RDWR
)

97  
SFE_BAD_MODE_RW
 ;

99 i‡(
psf
->
mode
 =
SFM_WRITE
 &&Ösf->
sf
.
ch™√ls
 != 1)

100  
SFE_CHANNEL_COUNT
 ;

102 i‡((
pvox
 = 
	`mÆloc
 ( (
VOX_ADPCM_PRIVATE
))Ë=
NULL
)

103  
SFE_MALLOC_FAILED
 ;

105 
psf
->
codec_d©a
 = (*Ë
pvox
 ;

106 
	`mem£t
 (
pvox
, 0,  (
VOX_ADPCM_PRIVATE
)) ;

108 i‡(
psf
->
mode
 =
SFM_WRITE
)

109 { 
psf
->
wrôe_sh‹t
 = 
vox_wrôe_s
 ;

110 
psf
->
wrôe_öt
 = 
vox_wrôe_i
 ;

111 
psf
->
wrôe_Êﬂt
 = 
vox_wrôe_f
 ;

112 
psf
->
wrôe_doubÀ
 = 
vox_wrôe_d
 ;

115 { 
	`psf_log_¥ötf
 (
psf
, "Header-less OKI Dialogic ADPCMÉncoded file.\n") ;

116 
	`psf_log_¥ötf
 (
psf
, "Setting up for 8kHz, mono, Vox ADPCM.\n") ;

118 
psf
->
ªad_sh‹t
 = 
vox_ªad_s
 ;

119 
psf
->
ªad_öt
 = 
vox_ªad_i
 ;

120 
psf
->
ªad_Êﬂt
 = 
vox_ªad_f
 ;

121 
psf
->
ªad_doubÀ
 = 
vox_ªad_d
 ;

125 i‡(
psf
->
sf
.
ßm∂î©e
 < 1)

126 
psf
->
sf
.
ßm∂î©e
 = 8000 ;

127 
psf
->
sf
.
ch™√ls
 = 1 ;

129 
psf
->
sf
.
‰ames
 =Ösf->
fûñígth
 * 2 ;

131 
psf
->
sf
.
£ekabÀ
 = 
SF_FALSE
 ;

134 i‡(
	`psf_f£ek
 (
psf
, 0 , 
SEEK_SET
) == -1)

135  
SFE_BAD_SEEK
 ;

138 
	}
}

144 
	$vox_adpcm_ícode
 (
ßmp
, 
VOX_ADPCM_PRIVATE
 *
pvox
)

145 { 
code
 ;

146 
diff
, 
îr‹
, 
°ïsize
 ;

148 
°ïsize
 = 
°ï_size_èbÀ
 [
pvox
->
°ï_ödex
] ;

149 
code
 = 0 ;

151 
diff
 = 
ßmp
 - 
pvox
->
œ°
 ;

152 i‡(
diff
 < 0)

153 { 
code
 = 0x08 ;

154 
îr‹
 = -
diff
 ;

157 
îr‹
 = 
diff
 ;

159 i‡(
îr‹
 >
°ïsize
)

160 { 
code
 = code | 0x04 ;

161 
îr‹
 -
°ïsize
 ;

164 i‡(
îr‹
 >
°ïsize
 / 2)

165 { 
code
 = code | 0x02 ;

166 
îr‹
 -
°ïsize
 / 2 ;

169 i‡(
îr‹
 >
°ïsize
 / 4)

170 
code
 = code | 0x01 ;

176 
pvox
->
œ°
 = 
	`vox_adpcm_decode
 (
code
,Övox) ;

178  
code
 ;

179 
	}
}

182 
	$vox_adpcm_decode
 (
code
, 
VOX_ADPCM_PRIVATE
 *
pvox
)

183 { 
diff
, 
îr‹
, 
°ïsize
, 
ßmp
 ;

185 
°ïsize
 = 
°ï_size_èbÀ
 [
pvox
->
°ï_ödex
] ;

187 
îr‹
 = 
°ïsize
 / 8 ;

189 i‡(
code
 & 0x01)

190 
îr‹
 +
°ïsize
 / 4 ;

192 i‡(
code
 & 0x02)

193 
îr‹
 +
°ïsize
 / 2 ;

195 i‡(
code
 & 0x04)

196 
îr‹
 +
°ïsize
 ;

198 
diff
 = (
code
 & 0x08Ë? -
îr‹
 :Érror ;

199 
ßmp
 = 
pvox
->
œ°
 + 
diff
 ;

204 i‡(
ßmp
 > 2048)

205 
ßmp
 = 2048 ;

206 i‡(
ßmp
 < -2048)

207 
ßmp
 = -2048 ;

209 
pvox
->
œ°
 = 
ßmp
 ;

210 
pvox
->
°ï_ödex
 +
°ï_adju°_èbÀ
 [
code
 & 0x7] ;

212 i‡(
pvox
->
°ï_ödex
 < 0)

213 
pvox
->
°ï_ödex
 = 0 ;

214 i‡(
pvox
->
°ï_ödex
 > 48)

215 
pvox
->
°ï_ödex
 = 48 ;

217  
ßmp
 ;

218 
	}
}

221 
	$vox_adpcm_ícode_block
 (
VOX_ADPCM_PRIVATE
 *
pvox
)

222 { 
code
 ;

223 
j
, 
k
 ;

226 i‡(
pvox
->
pcm_ßm∂es
 & 1)

227 
pvox
->
pcm_d©a
 [pvox->
pcm_ßm∂es
++] = 0 ;

229 
j
 = 
k
 = 0 ; k < 
pvox
->
pcm_ßm∂es
 ; j++)

230 { 
code
 = 
	`vox_adpcm_ícode
 (
pvox
->
pcm_d©a
 [
k
++] / 16,Övox) << 4 ;

231 
code
 |
	`vox_adpcm_ícode
 (
pvox
->
pcm_d©a
 [
k
++] / 16,Övox) ;

232 
pvox
->
vox_d©a
 [
j
] = 
code
 ;

235 
pvox
->
vox_byãs
 = 
j
 ;

238 
	}
}

241 
	$vox_adpcm_decode_block
 (
VOX_ADPCM_PRIVATE
 *
pvox
)

242 { 
code
 ;

243 
j
, 
k
 ;

245 
j
 = 
k
 = 0 ; j < 
pvox
->
vox_byãs
 ; j++)

246 { 
code
 = 
pvox
->
vox_d©a
 [
j
] ;

247 
pvox
->
pcm_d©a
 [
k
++] = 16 * 
	`vox_adpcm_decode
 ((
code
 >> 4) & 0x0f,Övox) ;

248 
pvox
->
pcm_d©a
 [
k
++] = 16 * 
	`vox_adpcm_decode
 (
code
 & 0x0f,Övox) ;

251 
pvox
->
pcm_ßm∂es
 = 
k
 ;

254 
	}
}

260 
	$vox_ªad_block
 (
SF_PRIVATE
 *
psf
, 
VOX_ADPCM_PRIVATE
 *
pvox
, *
±r
, 
Àn
)

261 { 
ödx
 = 0, 
k
 ;

263 
ödx
 < 
Àn
)

264 { 
pvox
->
vox_byãs
 = (
Àn
 - 
ödx
 > 
PCM_DATA_LEN
Ë? 
VOX_DATA_LEN
 : (len - indx + 1) / 2 ;

266 i‡((
k
 = 
	`psf_‰ód
 (
pvox
->
vox_d©a
, 1,Övox->
vox_byãs
, 
psf
)) !=Övox->vox_bytes)

267 { i‡(
	`psf_·ñl
 (
psf
Ë+ 
k
 !psf->
fûñígth
)

268 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög : sh‹àªad (%d !%d).\n", 
k
, 
pvox
->
vox_byãs
) ;

269 i‡(
k
 == 0)

273 
pvox
->
vox_byãs
 = 
k
 ;

275 
	`vox_adpcm_decode_block
 (
pvox
) ;

277 
	`mem˝y
 (&(
±r
 [
ödx
]), 
pvox
->
pcm_d©a
,Övox->
pcm_ßm∂es
 *  ()) ;

278 
ödx
 +
pvox
->
pcm_ßm∂es
 ;

281  
ödx
 ;

282 
	}
}

285 
sf_cou¡_t


286 
	$vox_ªad_s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

287 { 
VOX_ADPCM_PRIVATE
 *
pvox
 ;

288 
ªadcou¡
, 
cou¡
 ;

289 
sf_cou¡_t
 
tŸÆ
 = 0 ;

291 i‡(! 
psf
->
codec_d©a
)

293 
pvox
 = (
VOX_ADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

295 
Àn
 > 0)

296 { 
ªadcou¡
 = (
Àn
 > 0x10000000) ? 0x10000000 : ()Üen ;

298 
cou¡
 = 
	`vox_ªad_block
 (
psf
, 
pvox
, 
±r
, 
ªadcou¡
) ;

300 
tŸÆ
 +
cou¡
 ;

301 
Àn
 -
cou¡
 ;

302 i‡(
cou¡
 !
ªadcou¡
)

306  
tŸÆ
 ;

307 
	}
}

309 
sf_cou¡_t


310 
	$vox_ªad_i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

311 { 
VOX_ADPCM_PRIVATE
 *
pvox
 ;

312 *
•å
 ;

313 
k
, 
buf„æí
, 
ªadcou¡
, 
cou¡
 ;

314 
sf_cou¡_t
 
tŸÆ
 = 0 ;

316 i‡(! 
psf
->
codec_d©a
)

318 
pvox
 = (
VOX_ADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

320 
•å
 = 
psf
->
u
.
sbuf
 ;

321 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

322 
Àn
 > 0)

323 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen : ()Üen ;

324 
cou¡
 = 
	`vox_ªad_block
 (
psf
, 
pvox
, 
•å
, 
ªadcou¡
) ;

325 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

326 
±r
 [
tŸÆ
 + 
k
] = ((Ë
•å
 [k]) << 16 ;

327 
tŸÆ
 +
cou¡
 ;

328 
Àn
 -
ªadcou¡
 ;

329 i‡(
cou¡
 !
ªadcou¡
)

333  
tŸÆ
 ;

334 
	}
}

336 
sf_cou¡_t


337 
	$vox_ªad_f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

338 { 
VOX_ADPCM_PRIVATE
 *
pvox
 ;

339 *
•å
 ;

340 
k
, 
buf„æí
, 
ªadcou¡
, 
cou¡
 ;

341 
sf_cou¡_t
 
tŸÆ
 = 0 ;

342 
n‹mÁ˘
 ;

344 i‡(! 
psf
->
codec_d©a
)

346 
pvox
 = (
VOX_ADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

348 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? 1.0 / (() 0x8000) : 1.0 ;

350 
•å
 = 
psf
->
u
.
sbuf
 ;

351 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

352 
Àn
 > 0)

353 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen : ()Üen ;

354 
cou¡
 = 
	`vox_ªad_block
 (
psf
, 
pvox
, 
•å
, 
ªadcou¡
) ;

355 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

356 
±r
 [
tŸÆ
 + 
k
] = 
n‹mÁ˘
 * (Ë(
•å
 [k]) ;

357 
tŸÆ
 +
cou¡
 ;

358 
Àn
 -
ªadcou¡
 ;

359 i‡(
cou¡
 !
ªadcou¡
)

363  
tŸÆ
 ;

364 
	}
}

366 
sf_cou¡_t


367 
	$vox_ªad_d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

368 { 
VOX_ADPCM_PRIVATE
 *
pvox
 ;

369 *
•å
 ;

370 
k
, 
buf„æí
, 
ªadcou¡
, 
cou¡
 ;

371 
sf_cou¡_t
 
tŸÆ
 = 0 ;

372 
n‹mÁ˘
 ;

374 i‡(! 
psf
->
codec_d©a
)

376 
pvox
 = (
VOX_ADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

378 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? 1.0 / (() 0x8000) : 1.0 ;

380 
•å
 = 
psf
->
u
.
sbuf
 ;

381 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

382 
Àn
 > 0)

383 { 
ªadcou¡
 = (
Àn
 >
buf„æí
) ? bufferlen : ()Üen ;

384 
cou¡
 = 
	`vox_ªad_block
 (
psf
, 
pvox
, 
•å
, 
ªadcou¡
) ;

385 
k
 = 0 ; k < 
ªadcou¡
 ; k++)

386 
±r
 [
tŸÆ
 + 
k
] = 
n‹mÁ˘
 * (Ë(
•å
 [k]) ;

387 
tŸÆ
 +
cou¡
 ;

388 
Àn
 -
ªadcou¡
 ;

389 i‡(
cou¡
 !
ªadcou¡
)

393  
tŸÆ
 ;

394 
	}
}

400 
	$vox_wrôe_block
 (
SF_PRIVATE
 *
psf
, 
VOX_ADPCM_PRIVATE
 *
pvox
, c⁄° *
±r
, 
Àn
)

401 { 
ödx
 = 0, 
k
 ;

403 
ödx
 < 
Àn
)

404 { 
pvox
->
pcm_ßm∂es
 = (
Àn
 - 
ödx
 > 
PCM_DATA_LEN
) ? PCM_DATA_LEN :Üen - indx ;

406 
	`mem˝y
 (
pvox
->
pcm_d©a
, &(
±r
 [
ödx
]),Övox->
pcm_ßm∂es
 *  ()) ;

408 
	`vox_adpcm_ícode_block
 (
pvox
) ;

410 i‡((
k
 = 
	`psf_fwrôe
 (
pvox
->
vox_d©a
, 1,Övox->
vox_byãs
, 
psf
)) !=Övox->vox_bytes)

411 
	`psf_log_¥ötf
 (
psf
, "*** W¨nög : sh‹àªad (%d !%d).\n", 
k
, 
pvox
->
vox_byãs
) ;

413 
ödx
 +
pvox
->
pcm_ßm∂es
 ;

416  
ödx
 ;

417 
	}
}

419 
sf_cou¡_t


420 
	$vox_wrôe_s
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

421 { 
VOX_ADPCM_PRIVATE
 *
pvox
 ;

422 
wrôecou¡
, 
cou¡
 ;

423 
sf_cou¡_t
 
tŸÆ
 = 0 ;

425 i‡(! 
psf
->
codec_d©a
)

427 
pvox
 = (
VOX_ADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

429 
Àn
)

430 { 
wrôecou¡
 = (
Àn
 > 0x10000000) ? 0x10000000 : ()Üen ;

432 
cou¡
 = 
	`vox_wrôe_block
 (
psf
, 
pvox
, 
±r
, 
wrôecou¡
) ;

434 
tŸÆ
 +
cou¡
 ;

435 
Àn
 -
cou¡
 ;

436 i‡(
cou¡
 !
wrôecou¡
)

440  
tŸÆ
 ;

441 
	}
}

443 
sf_cou¡_t


444 
	$vox_wrôe_i
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

445 { 
VOX_ADPCM_PRIVATE
 *
pvox
 ;

446 *
•å
 ;

447 
k
, 
buf„æí
, 
wrôecou¡
, 
cou¡
 ;

448 
sf_cou¡_t
 
tŸÆ
 = 0 ;

450 i‡(! 
psf
->
codec_d©a
)

452 
pvox
 = (
VOX_ADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

454 
•å
 = 
psf
->
u
.
sbuf
 ;

455 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

456 
Àn
 > 0)

457 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen : ()Üen ;

458 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

459 
•å
 [
k
] = 
±r
 [
tŸÆ
 + k] >> 16 ;

460 
cou¡
 = 
	`vox_wrôe_block
 (
psf
, 
pvox
, 
•å
, 
wrôecou¡
) ;

461 
tŸÆ
 +
cou¡
 ;

462 
Àn
 -
wrôecou¡
 ;

463 i‡(
cou¡
 !
wrôecou¡
)

467  
tŸÆ
 ;

468 
	}
}

470 
sf_cou¡_t


471 
	$vox_wrôe_f
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

472 { 
VOX_ADPCM_PRIVATE
 *
pvox
 ;

473 *
•å
 ;

474 
k
, 
buf„æí
, 
wrôecou¡
, 
cou¡
 ;

475 
sf_cou¡_t
 
tŸÆ
 = 0 ;

476 
n‹mÁ˘
 ;

478 i‡(! 
psf
->
codec_d©a
)

480 
pvox
 = (
VOX_ADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

482 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? (1.0 * 0x7FFF) : 1.0 ;

484 
•å
 = 
psf
->
u
.
sbuf
 ;

485 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

486 
Àn
 > 0)

487 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen : ()Üen ;

488 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

489 
•å
 [
k
] = 
	`Ãötf
 (
n‹mÁ˘
 * 
±r
 [
tŸÆ
 + k]) ;

490 
cou¡
 = 
	`vox_wrôe_block
 (
psf
, 
pvox
, 
•å
, 
wrôecou¡
) ;

491 
tŸÆ
 +
cou¡
 ;

492 
Àn
 -
wrôecou¡
 ;

493 i‡(
cou¡
 !
wrôecou¡
)

497  
tŸÆ
 ;

498 
	}
}

500 
sf_cou¡_t


501 
	$vox_wrôe_d
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

502 { 
VOX_ADPCM_PRIVATE
 *
pvox
 ;

503 *
•å
 ;

504 
k
, 
buf„æí
, 
wrôecou¡
, 
cou¡
 ;

505 
sf_cou¡_t
 
tŸÆ
 = 0 ;

506 
n‹mÁ˘
 ;

508 i‡(! 
psf
->
codec_d©a
)

510 
pvox
 = (
VOX_ADPCM_PRIVATE
*Ë
psf
->
codec_d©a
 ;

512 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? (1.0 * 0x7FFF) : 1.0 ;

514 
•å
 = 
psf
->
u
.
sbuf
 ;

515 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

516 
Àn
 > 0)

517 { 
wrôecou¡
 = (
Àn
 >
buf„æí
) ? bufferlen : ()Üen ;

518 
k
 = 0 ; k < 
wrôecou¡
 ; k++)

519 
•å
 [
k
] = 
	`Ãöt
 (
n‹mÁ˘
 * 
±r
 [
tŸÆ
 + k]) ;

520 
cou¡
 = 
	`vox_wrôe_block
 (
psf
, 
pvox
, 
•å
, 
wrôecou¡
) ;

521 
tŸÆ
 +
cou¡
 ;

522 
Àn
 -
wrôecou¡
 ;

523 i‡(
cou¡
 !
wrôecou¡
)

527  
tŸÆ
 ;

528 
	}
}

	@libsndfile-1.0.17/src/w64.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°rög.h
>

23 
	~<˘y≥.h
>

24 
	~<time.h
>

26 
	~"¢dfûe.h
"

27 
	~"s„ndün.h
"

28 
	~"comm⁄.h
"

29 
	~"wav_w64.h
"

40 
	#MAKE_HASH16
(
x0
,
x1
,
x2
,
x3
,
x4
,
x5
,
x6
,
x7
,
x8
,
x9
,
xa
,
xb
,
xc
,
xd
,
xe
,
xf
) \

41 –(
x0
Ë^ ((
x1
Ë<< 1Ë^ ((
x2
Ë<< 2Ë^ ((
x3
) << 3) ^ \

42 ((
x4
Ë<< 4Ë^ ((
x5
Ë<< 5Ë^ ((
x6
Ë<< 6Ë^ ((
x7
) << 7) ^ \

43 ((
x8
Ë<< 8Ë^ ((
x9
Ë<< 9Ë^ ((
xa
Ë<< 10Ë^ ((
xb
) << 11) ^ \

44 ((
xc
Ë<< 12Ë^ ((
xd
Ë<< 13Ë^ ((
xe
Ë<< 14Ë^ ((
xf
Ë<< 15Ë)

	)

46 
	#MAKE_MARKER16
(
«me
,
x0
,
x1
,
x2
,
x3
,
x4
,
x5
,
x6
,
x7
,
x8
,
x9
,
xa
,
xb
,
xc
,
xd
,
xe
,
xf
) \

47 
«me
 [16] = { (
x0
), (
x1
), (
x2
), (
x3
), (
x4
), (
x5
), \

48 (
x6
), (
x7
), (
x8
), (
x9
), (
xa
), (
xb
), (
xc
), (
xd
), (
xe
), (
xf
Ë}

	)

50 
	#riff_HASH16
 
	`MAKE_HASH16
 ('r', 'i', 'f', 'f', 0x2E, 0x91, 0xCF, 0x11, 0xA5, \

51 0xD6, 0x28, 0xDB, 0x04, 0xC1, 0x00, 0x00)

	)

53 
	#wave_HASH16
 
	`MAKE_HASH16
 ('w', 'a', 'v', 'e', 0xF3, 0xAC, 0xD3, 0x11, \

54 0x8C, 0xD1, 0x00, 0xC0, 0x4F, 0x8E, 0xDB, 0x8A)

	)

56 
	#fmt_HASH16
 
	`MAKE_HASH16
 ('f', 'm', 't', ' ', 0xF3, 0xAC, 0xD3, 0x11, \

57 0x8C, 0xD1, 0x00, 0xC0, 0x4F, 0x8E, 0xDB, 0x8A)

	)

59 
	#Á˘_HASH16
 
	`MAKE_HASH16
 ('f', 'a', 'c', 't', 0xF3, 0xAC, 0xD3, 0x11, \

60 0x8C, 0xD1, 0x00, 0xC0, 0x4F, 0x8E, 0xDB, 0x8A)

	)

62 
	#d©a_HASH16
 
	`MAKE_HASH16
 ('d', 'a', 't', 'a', 0xF3, 0xAC, 0xD3, 0x11, \

63 0x8C, 0xD1, 0x00, 0xC0, 0x4F, 0x8E, 0xDB, 0x8A)

	)

65 
	#ACID_HASH16
 
	`MAKE_HASH16
 (0x6D, 0x07, 0x1C, 0xEA, 0xA3, 0xEF, 0x78, 0x4C, \

66 0x90, 0x57, 0x7F, 0x79, 0xEE, 0x25, 0x2A, 0xAE)

	)

68 
MAKE_MARKER16
 (
riff_MARKER16
, 'r', 'i', 'f', 'f', 0x2E, 0x91, 0xCF, 0x11,

72 
MAKE_MARKER16
 (
wave_MARKER16
, 'w', 'a', 'v', 'e', 0xF3, 0xAC, 0xD3, 0x11,

75 
MAKE_MARKER16
 (
fmt_MARKER16
, 'f', 'm', 't', ' ', 0xF3, 0xAC, 0xD3, 0x11,

78 
MAKE_MARKER16
 (
Á˘_MARKER16
, 'f', 'a', 'c', 't', 0xF3, 0xAC, 0xD3, 0x11,

81 
MAKE_MARKER16
 (
d©a_MARKER16
, 'd', 'a', 't', 'a', 0xF3, 0xAC, 0xD3, 0x11,

85 { 
	mHAVE_riff
 = 0x01,

86 
	mHAVE_wave
 = 0x02,

87 
	mHAVE_fmt
 = 0x04,

88 
	mHAVE_Á˘
 = 0x08,

89 
	mHAVE_d©a
 = 0x20

96 
w64_ªad_hódî
 (
SF_PRIVATE
 *
psf
, *
blockÆign
, *
‰ame•îblock
) ;

97 
w64_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
) ;

98 
w64_˛o£
 (
SF_PRIVATE
 *
psf
) ;

105 
	$w64_›í
 (
SF_PRIVATE
 *
psf
)

106 { 
subf‹m©
, 
îr‹
, 
blockÆign
 = 0, 
‰ame•îblock
 = 0 ;

108 i‡(
psf
->
mode
 =
SFM_READ
 || (psf->modê=
SFM_RDWR
 &&psf->
fûñígth
 > 0))

109 { i‡((
îr‹
 = 
	`w64_ªad_hódî
 (
psf
, &
blockÆign
, &
‰ame•îblock
)))

110  
îr‹
 ;

113 i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_W64
)

114  
SFE_BAD_OPEN_FORMAT
 ;

116 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

118 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

119 { i‡(
psf
->
is_pùe
)

120  
SFE_NO_PIPE_WRITE
 ;

122 
psf
->
ídün
 = 
SF_ENDIAN_LITTLE
 ;

124 
psf
->
blockwidth
 =Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

126 i‡(
subf‹m©
 =
SF_FORMAT_IMA_ADPCM
 || subf‹m© =
SF_FORMAT_MS_ADPCM
)

127 { 
blockÆign
 = 
	`wav_w64_§©e2blocksize
 (
psf
->
sf
.
ßm∂î©e
 *Ösf->sf.
ch™√ls
) ;

128 
‰ame•îblock
 = -1 ;

131 
psf
->
fûñígth
 = 
SF_COUNT_MAX
 ;

132 
psf
->
d©Æígth
 =Ösf->
fûñígth
 ;

133 i‡(
psf
->
sf
.
‰ames
 <= 0)

134 
psf
->
sf
.
‰ames
 = (psf->
blockwidth
Ë?Ösf->
fûñígth
 /Ösf->blockwidth :Ösf->filelength ;

138 i‡((
îr‹
 = 
	`w64_wrôe_hódî
 (
psf
, 
SF_FALSE
)))

139  
îr‹
 ;

141 
psf
->
wrôe_hódî
 = 
w64_wrôe_hódî
 ;

144 
psf
->
c⁄èöî_˛o£
 = 
w64_˛o£
 ;

146 
subf‹m©
)

147 { 
SF_FORMAT_PCM_U8
 :

148 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

151 
SF_FORMAT_PCM_16
 :

152 
SF_FORMAT_PCM_24
 :

153 
SF_FORMAT_PCM_32
 :

154 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

157 
SF_FORMAT_ULAW
 :

158 
îr‹
 = 
	`uœw_öô
 (
psf
) ;

161 
SF_FORMAT_ALAW
 :

162 
îr‹
 = 
	`Æaw_öô
 (
psf
) ;

166 
SF_FORMAT_FLOAT
 :

167 
îr‹
 = 
	`Êﬂt32_öô
 (
psf
) ;

170 
SF_FORMAT_DOUBLE
 :

171 
îr‹
 = 
	`doubÀ64_öô
 (
psf
) ;

174 
SF_FORMAT_IMA_ADPCM
 :

175 
îr‹
 = 
	`wav_w64_ima_öô
 (
psf
, 
blockÆign
, 
‰ame•îblock
) ;

178 
SF_FORMAT_MS_ADPCM
 :

179 
îr‹
 = 
	`wav_w64_mßdpcm_öô
 (
psf
, 
blockÆign
, 
‰ame•îblock
) ;

183 
SF_FORMAT_GSM610
 :

184 
îr‹
 = 
	`gsm610_öô
 (
psf
) ;

187  :  
SFE_UNIMPLEMENTED
 ;

190  
îr‹
 ;

191 
	}
}

198 
	$w64_ªad_hódî
 (
SF_PRIVATE
 *
psf
, *
blockÆign
, *
‰ame•îblock
)

199 { 
WAV_FMT
 
wav_fmt
 ;

200 
dw‹d
 = 0, 
m¨kî
, 
f‹m©
 = 0 ;

201 
sf_cou¡_t
 
chunk_size
, 
byã§ód
 = 0 ;

202 
∑r£°age
 = 0, 
îr‹
, 
d⁄e
 = 0 ;

205 
	`mem£t
 (&
wav_fmt
, 0,  (wav_fmt)) ;

206 
	`psf_böhódî_ªadf
 (
psf
, "p", 0) ;

208 ! 
d⁄e
)

210 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "h", &
m¨kî
) ;

211 
chunk_size
 = 0 ;

213 
m¨kî
)

214 { 
riff_HASH16
 :

215 i‡(
∑r£°age
)

216  
SFE_W64_NO_RIFF
 ;

218 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "e8", &
chunk_size
) ;

220 i‡(
psf
->
fûñígth
 < 
chunk_size
)

221 
	`psf_log_¥ötf
 (
psf
, "rif‡: %D (should bê%D)\n", 
chunk_size
,Ösf->
fûñígth
) ;

223 
	`psf_log_¥ötf
 (
psf
, "rif‡: %D\n", 
chunk_size
) ;

225 
∑r£°age
 |
HAVE_riff
 ;

228 
ACID_HASH16
:

229 
	`psf_log_¥ötf
 (
psf
, "LooksÜikeán ACID file. Exiting.\n") ;

230  
SFE_UNIMPLEMENTED
 ;

232 
wave_HASH16
 :

233 i‡((
∑r£°age
 & 
HAVE_riff
) != HAVE_riff)

234  
SFE_W64_NO_WAVE
 ;

235 
	`psf_log_¥ötf
 (
psf
, "wave\n") ;

236 
∑r£°age
 |
HAVE_wave
 ;

239 
fmt_HASH16
 :

240 i‡((
∑r£°age
 & (
HAVE_riff
 | 
HAVE_wave
)) != (HAVE_riff | HAVE_wave))

241  
SFE_W64_NO_FMT
 ;

243 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "e8", &
chunk_size
) ;

244 
	`psf_log_¥ötf
 (
psf
, " fmà: %D\n", 
chunk_size
) ;

247 
chunk_size
 -= 24 ;

249 i‡((
îr‹
 = 
	`wav_w64_ªad_fmt_chunk
 (
psf
, &
wav_fmt
, (Ë
chunk_size
)))

250  
îr‹
 ;

252 i‡(
chunk_size
 % 8)

253 
	`psf_böhódî_ªadf
 (
psf
, "j", 8 - (
chunk_size
 % 8)) ;

255 
f‹m©
 = 
wav_fmt
.format ;

256 
∑r£°age
 |
HAVE_fmt
 ;

259 
Á˘_HASH16
:

260 { 
sf_cou¡_t
 
‰ames
 ;

262 
	`psf_böhódî_ªadf
 (
psf
, "e88", &
chunk_size
, &
‰ames
) ;

263 
	`psf_log_¥ötf
 (
psf
, " fact : %D\n frames : %D\n",

264 
chunk_size
, 
‰ames
) ;

269 
d©a_HASH16
 :

270 i‡((
∑r£°age
 & (
HAVE_riff
 | 
HAVE_wave
 | 
HAVE_fmt
)) != (HAVE_riff | HAVE_wave | HAVE_fmt))

271  
SFE_W64_NO_DATA
 ;

273 
	`psf_böhódî_ªadf
 (
psf
, "e8", &
chunk_size
) ;

275 
psf
->
d©aoff£t
 = 
	`psf_·ñl
 (psf) ;

277 
psf
->
d©Æígth
 = 
chunk_size
 - 24 ;

279 i‡(
chunk_size
 % 8)

280 
chunk_size
 += 8 - (chunk_size % 8) ;

282 
	`psf_log_¥ötf
 (
psf
, "d©®: %D\n", 
chunk_size
) ;

284 
∑r£°age
 |
HAVE_d©a
 ;

286 i‡(! 
psf
->
sf
.
£ekabÀ
)

290 
	`psf_f£ek
 (
psf
, 
chunk_size
, 
SEEK_CUR
) ;

294 i‡(
	`psf_·ñl
 (
psf
) & 0x0F)

295 { 
	`psf_log_¥ötf
 (
psf
, " Unknow¿chunk m¨kîáàposôi⁄ %d. Resynchög.\n", 
dw‹d
 - 4) ;

296 
	`psf_böhódî_ªadf
 (
psf
, "j", -3) ;

299 
	`psf_log_¥ötf
 (
psf
, "*** Unknow¿chunk m¨kî : %X. ExôögÖ¨£r.\n", 
m¨kî
) ;

300 
d⁄e
 = 
SF_TRUE
 ;

304 i‡(
psf
->
sf
.
£ekabÀ
 =0 && (
∑r£°age
 & 
HAVE_d©a
))

307 i‡(
	`psf_·ñl
 (
psf
Ë>’sf->
fûñígth
 - (2 * 
	`SIGNED_SIZEOF
 (
dw‹d
))))

311 i‡(! 
psf
->
d©aoff£t
)

312  
SFE_W64_NO_DATA
 ;

314 
psf
->
ídün
 = 
SF_ENDIAN_LITTLE
 ;

316 i‡(
	`psf_·ñl
 (
psf
Ë!psf->
d©aoff£t
)

317 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
, 
SEEK_SET
) ;

319 i‡(
psf
->
blockwidth
)

320 { i‡(
psf
->
fûñígth
 -Ösf->
d©aoff£t
 <Ösf->
d©Æígth
)

321 
psf
->
sf
.
‰ames
 = (psf->
fûñígth
 -Ösf->
d©aoff£t
Ë/Ösf->
blockwidth
 ;

323 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 /Ösf->
blockwidth
 ;

326 
f‹m©
)

327 { 
WAVE_FORMAT_PCM
 :

328 
WAVE_FORMAT_EXTENSIBLE
 :

330 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_W64
 | 
	`u_bôwidth_to_subf‹m©
 (psf->
byãwidth
 * 8) ;

333 
WAVE_FORMAT_MULAW
 :

334 
psf
->
sf
.
f‹m©
 = (
SF_FORMAT_W64
 | 
SF_FORMAT_ULAW
) ;

337 
WAVE_FORMAT_ALAW
 :

338 
psf
->
sf
.
f‹m©
 = (
SF_FORMAT_W64
 | 
SF_FORMAT_ALAW
) ;

341 
WAVE_FORMAT_MS_ADPCM
 :

342 
psf
->
sf
.
f‹m©
 = (
SF_FORMAT_W64
 | 
SF_FORMAT_MS_ADPCM
) ;

343 *
blockÆign
 = 
wav_fmt
.
mßdpcm
.blockalign ;

344 *
‰ame•îblock
 = 
wav_fmt
.
mßdpcm
.
ßm∂e•îblock
 ;

347 
WAVE_FORMAT_IMA_ADPCM
 :

348 
psf
->
sf
.
f‹m©
 = (
SF_FORMAT_W64
 | 
SF_FORMAT_IMA_ADPCM
) ;

349 *
blockÆign
 = 
wav_fmt
.
ima
.blockalign ;

350 *
‰ame•îblock
 = 
wav_fmt
.
ima
.
ßm∂e•îblock
 ;

353 
WAVE_FORMAT_GSM610
 :

354 
psf
->
sf
.
f‹m©
 = (
SF_FORMAT_W64
 | 
SF_FORMAT_GSM610
) ;

357 
WAVE_FORMAT_IEEE_FLOAT
 :

358 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_W64
 ;

359 
psf
->
sf
.
f‹m©
 |’sf->
byãwidth
 =8Ë? 
SF_FORMAT_DOUBLE
 : 
SF_FORMAT_FLOAT
 ;

362  :  
SFE_UNIMPLEMENTED
 ;

366 
	}
}

369 
	$w64_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
)

370 { 
sf_cou¡_t
 
fmt_size
, 
cuºít
 ;

371 
size_t
 
fmt_∑d
 = 0 ;

372 
subf‹m©
, 
add_Á˘_chunk
 = 
SF_FALSE
 ;

374 
cuºít
 = 
	`psf_·ñl
 (
psf
) ;

376 i‡(
ˇlc_Àngth
)

377 { 
psf
->
fûñígth
 = 
	`psf_gë_fûñí
 (psf) ;

379 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

380 i‡(
psf
->
d©´nd
)

381 
psf
->
d©Æígth
 -psf->
fûñígth
 -Ösf->
d©´nd
 ;

383 i‡(
psf
->
byãwidth
)

384 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 / (psf->
byãwidth
 *Ösf->sf.
ch™√ls
) ;

388 
psf
->
hódî
 [0] = 0 ;

389 
psf
->
hódödex
 = 0 ;

390 
	`psf_f£ek
 (
psf
, 0, 
SEEK_SET
) ;

393 
	`psf_böhódî_wrôef
 (
psf
, "eh8hh", 
riff_MARKER16
,Ösf->
fûñígth
 - 8, 
wave_MARKER16
, 
fmt_MARKER16
) ;

395 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

397 
subf‹m©
)

398 { 
SF_FORMAT_PCM_U8
 :

399 
SF_FORMAT_PCM_16
 :

400 
SF_FORMAT_PCM_24
 :

401 
SF_FORMAT_PCM_32
 :

402 
fmt_size
 = 24 + 2 + 2 + 4 + 4 + 2 + 2 ;

403 
fmt_∑d
 = (
size_t
Ë(8 - (
fmt_size
 & 0x7)) ;

404 
fmt_size
 +
fmt_∑d
 ;

407 
	`psf_böhódî_wrôef
 (
psf
, "e8224", 
fmt_size
, 
WAVE_FORMAT_PCM
,Ösf->
sf
.
ch™√ls
,Ösf->sf.
ßm∂î©e
) ;

409 
	`psf_böhódî_wrôef
 (
psf
, "e4",Ösf->
sf
.
ßm∂î©e
 *Ösf->
byãwidth
 *Ösf->sf.
ch™√ls
) ;

411 
	`psf_böhódî_wrôef
 (
psf
, "e22",Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
,Ösf->bytewidth * 8) ;

414 
SF_FORMAT_FLOAT
 :

415 
SF_FORMAT_DOUBLE
 :

416 
fmt_size
 = 24 + 2 + 2 + 4 + 4 + 2 + 2 ;

417 
fmt_∑d
 = (
size_t
Ë(8 - (
fmt_size
 & 0x7)) ;

418 
fmt_size
 +
fmt_∑d
 ;

421 
	`psf_böhódî_wrôef
 (
psf
, "e8224", 
fmt_size
, 
WAVE_FORMAT_IEEE_FLOAT
,Ösf->
sf
.
ch™√ls
,Ösf->sf.
ßm∂î©e
) ;

423 
	`psf_böhódî_wrôef
 (
psf
, "e4",Ösf->
sf
.
ßm∂î©e
 *Ösf->
byãwidth
 *Ösf->sf.
ch™√ls
) ;

425 
	`psf_böhódî_wrôef
 (
psf
, "e22",Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
,Ösf->bytewidth * 8) ;

427 
add_Á˘_chunk
 = 
SF_TRUE
 ;

430 
SF_FORMAT_ULAW
 :

431 
fmt_size
 = 24 + 2 + 2 + 4 + 4 + 2 + 2 ;

432 
fmt_∑d
 = (
size_t
Ë(8 - (
fmt_size
 & 0x7)) ;

433 
fmt_size
 +
fmt_∑d
 ;

436 
	`psf_böhódî_wrôef
 (
psf
, "e8224", 
fmt_size
, 
WAVE_FORMAT_MULAW
,Ösf->
sf
.
ch™√ls
,Ösf->sf.
ßm∂î©e
) ;

438 
	`psf_böhódî_wrôef
 (
psf
, "e4",Ösf->
sf
.
ßm∂î©e
 *Ösf->
byãwidth
 *Ösf->sf.
ch™√ls
) ;

440 
	`psf_böhódî_wrôef
 (
psf
, "e22",Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
, 8) ;

442 
add_Á˘_chunk
 = 
SF_TRUE
 ;

445 
SF_FORMAT_ALAW
 :

446 
fmt_size
 = 24 + 2 + 2 + 4 + 4 + 2 + 2 ;

447 
fmt_∑d
 = (
size_t
Ë(8 - (
fmt_size
 & 0x7)) ;

448 
fmt_size
 +
fmt_∑d
 ;

451 
	`psf_böhódî_wrôef
 (
psf
, "e8224", 
fmt_size
, 
WAVE_FORMAT_ALAW
,Ösf->
sf
.
ch™√ls
,Ösf->sf.
ßm∂î©e
) ;

453 
	`psf_böhódî_wrôef
 (
psf
, "e4",Ösf->
sf
.
ßm∂î©e
 *Ösf->
byãwidth
 *Ösf->sf.
ch™√ls
) ;

455 
	`psf_böhódî_wrôef
 (
psf
, "e22",Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
, 8) ;

457 
add_Á˘_chunk
 = 
SF_TRUE
 ;

461 
SF_FORMAT_IMA_ADPCM
 :

462 { 
blockÆign
, 
‰ame•îblock
, 
byã•î£c
 ;

464 
blockÆign
 = 
	`wav_w64_§©e2blocksize
 (
psf
->
sf
.
ßm∂î©e
 *Ösf->sf.
ch™√ls
) ;

465 
‰ame•îblock
 = 2 * (
blockÆign
 - 4 * 
psf
->
sf
.
ch™√ls
) /Ösf->sf.channels + 1 ;

466 
byã•î£c
 = (
psf
->
sf
.
ßm∂î©e
 * 
blockÆign
Ë/ 
‰ame•îblock
 ;

469 
fmt_size
 = 24 + 2 + 2 + 4 + 4 + 2 + 2 + 2 + 2 ;

470 
fmt_∑d
 = (
size_t
Ë(8 - (
fmt_size
 & 0x7)) ;

471 
fmt_size
 +
fmt_∑d
 ;

474 
	`psf_böhódî_wrôef
 (
psf
, "e822", 
fmt_size
, 
WAVE_FORMAT_IMA_ADPCM
,Ösf->
sf
.
ch™√ls
) ;

477 
	`psf_böhódî_wrôef
 (
psf
, "e44",Ösf->
sf
.
ßm∂î©e
, 
byã•î£c
) ;

480 
	`psf_böhódî_wrôef
 (
psf
, "e2222", 
blockÆign
, 4, 2, 
‰ame•îblock
) ;

483 
add_Á˘_chunk
 = 
SF_TRUE
 ;

486 
SF_FORMAT_MS_ADPCM
 :

487 { 
blockÆign
, 
‰ame•îblock
, 
byã•î£c
, 
exåabyãs
 ;

489 
blockÆign
 = 
	`wav_w64_§©e2blocksize
 (
psf
->
sf
.
ßm∂î©e
 *Ösf->sf.
ch™√ls
) ;

490 
‰ame•îblock
 = 2 + 2 * (
blockÆign
 - 7 * 
psf
->
sf
.
ch™√ls
) /Ösf->sf.channels ;

491 
byã•î£c
 = (
psf
->
sf
.
ßm∂î©e
 * 
blockÆign
Ë/ 
‰ame•îblock
 ;

494 
exåabyãs
 = 2 + 2 + 
MSADPCM_ADAPT_COEFF_COUNT
 * (2 + 2) ;

495 
fmt_size
 = 24 + 2 + 2 + 4 + 4 + 2 + 2 + 2 + 
exåabyãs
 ;

496 
fmt_∑d
 = (
size_t
Ë(8 - (
fmt_size
 & 0x7)) ;

497 
fmt_size
 +
fmt_∑d
 ;

500 
	`psf_böhódî_wrôef
 (
psf
, "e822", 
fmt_size
, 
WAVE_FORMAT_MS_ADPCM
,Ösf->
sf
.
ch™√ls
) ;

503 
	`psf_böhódî_wrôef
 (
psf
, "e44",Ösf->
sf
.
ßm∂î©e
, 
byã•î£c
) ;

506 
	`psf_böhódî_wrôef
 (
psf
, "e22222", 
blockÆign
, 4, 
exåabyãs
, 
‰ame•îblock
, 7) ;

508 
	`mßdpcm_wrôe_ad≠t_c€ffs
 (
psf
) ;

511 
add_Á˘_chunk
 = 
SF_TRUE
 ;

515 
SF_FORMAT_GSM610
 :

516 { 
byã•î£c
 ;

518 
byã•î£c
 = (
psf
->
sf
.
ßm∂î©e
 * 
WAV_W64_GSM610_BLOCKSIZE
Ë/ 
WAV_W64_GSM610_SAMPLES
 ;

521 
fmt_size
 = 24 + 2 + 2 + 4 + 4 + 2 + 2 + 2 + 2 ;

522 
fmt_∑d
 = (
size_t
Ë(8 - (
fmt_size
 & 0x7)) ;

523 
fmt_size
 +
fmt_∑d
 ;

526 
	`psf_böhódî_wrôef
 (
psf
, "e822", 
fmt_size
, 
WAVE_FORMAT_GSM610
,Ösf->
sf
.
ch™√ls
) ;

529 
	`psf_böhódî_wrôef
 (
psf
, "e44",Ösf->
sf
.
ßm∂î©e
, 
byã•î£c
) ;

532 
	`psf_böhódî_wrôef
 (
psf
, "e2222", 
WAV_W64_GSM610_BLOCKSIZE
, 0, 2, 
WAV_W64_GSM610_SAMPLES
) ;

535 
add_Á˘_chunk
 = 
SF_TRUE
 ;

538  :  
SFE_UNIMPLEMENTED
 ;

542 i‡(
fmt_∑d
 > 0)

543 
	`psf_böhódî_wrôef
 (
psf
, "z", 
fmt_∑d
) ;

545 i‡(
add_Á˘_chunk
)

546 
	`psf_böhódî_wrôef
 (
psf
, "eh88", 
Á˘_MARKER16
, (
sf_cou¡_t
Ë(16 + 8 + 8),Ösf->
sf
.
‰ames
) ;

548 
	`psf_böhódî_wrôef
 (
psf
, "eh8", 
d©a_MARKER16
,Ösf->
d©Æígth
 + 24) ;

549 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

551 i‡(
psf
->
îr‹
)

552  
psf
->
îr‹
 ;

554 
psf
->
d©aoff£t
 =Ösf->
hódödex
 ;

556 i‡(
cuºít
 > 0)

557 
	`psf_f£ek
 (
psf
, 
cuºít
, 
SEEK_SET
) ;

559  
psf
->
îr‹
 ;

560 
	}
}

563 
	$w64_˛o£
 (
SF_PRIVATE
 *
psf
)

565 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

566 
	`w64_wrôe_hódî
 (
psf
, 
SF_TRUE
) ;

569 
	}
}

	@libsndfile-1.0.17/src/wav.c

20 
	~"sfc⁄fig.h
"

22 
	~<°dio.h
>

23 
	~<°dlib.h
>

24 
	~<°rög.h
>

25 
	~<˘y≥.h
>

26 
	~<time.h
>

28 
	~"¢dfûe.h
"

29 
	~"s„ndün.h
"

30 
	~"comm⁄.h
"

31 
	~"wav_w64.h
"

37 
	#RIFF_MARKER
 (
	`MAKE_MARKER
 ('R', 'I', 'F', 'F'))

	)

38 
	#RIFX_MARKER
 (
	`MAKE_MARKER
 ('R', 'I', 'F', 'X'))

	)

39 
	#WAVE_MARKER
 (
	`MAKE_MARKER
 ('W', 'A', 'V', 'E'))

	)

40 
	#fmt_MARKER
 (
	`MAKE_MARKER
 ('f', 'm', 't', ' '))

	)

41 
	#d©a_MARKER
 (
	`MAKE_MARKER
 ('d', 'a', 't', 'a'))

	)

42 
	#Á˘_MARKER
 (
	`MAKE_MARKER
 ('f', 'a', 'c', 't'))

	)

43 
	#PEAK_MARKER
 (
	`MAKE_MARKER
 ('P', 'E', 'A', 'K'))

	)

45 
	#cue_MARKER
 (
	`MAKE_MARKER
 ('c', 'u', 'e', ' '))

	)

46 
	#LIST_MARKER
 (
	`MAKE_MARKER
 ('L', 'I', 'S', 'T'))

	)

47 
	#¶¡_MARKER
 (
	`MAKE_MARKER
 ('s', 'l', 'n', 't'))

	)

48 
	#wavl_MARKER
 (
	`MAKE_MARKER
 ('w', 'a', 'v', 'l'))

	)

49 
	#INFO_MARKER
 (
	`MAKE_MARKER
 ('I', 'N', 'F', 'O'))

	)

50 
	#∂°_MARKER
 (
	`MAKE_MARKER
 ('p', 'l', 's', 't'))

	)

51 
	#adé_MARKER
 (
	`MAKE_MARKER
 ('a', 'd', 't', 'l'))

	)

52 
	#œbl_MARKER
 (
	`MAKE_MARKER
 ('l', 'a', 'b', 'l'))

	)

53 
	#…xt_MARKER
 (
	`MAKE_MARKER
 ('l', 't', 'x', 't'))

	)

54 
	#nŸe_MARKER
 (
	`MAKE_MARKER
 ('n', 'o', 't', 'e'))

	)

55 
	#sm∂_MARKER
 (
	`MAKE_MARKER
 ('s', 'm', 'p', 'l'))

	)

56 
	#bext_MARKER
 (
	`MAKE_MARKER
 ('b', 'e', 'x', 't'))

	)

57 
	#Àvl_MARKER
 (
	`MAKE_MARKER
 ('l', 'e', 'v', 'l'))

	)

58 
	#MEXT_MARKER
 (
	`MAKE_MARKER
 ('M', 'E', 'X', 'T'))

	)

59 
	#DISP_MARKER
 (
	`MAKE_MARKER
 ('D', 'I', 'S', 'P'))

	)

60 
	#acid_MARKER
 (
	`MAKE_MARKER
 ('a', 'c', 'i', 'd'))

	)

61 
	#°rc_MARKER
 (
	`MAKE_MARKER
 ('s', 't', 'r', 'c'))

	)

62 
	#PAD_MARKER
 (
	`MAKE_MARKER
 ('P', 'A', 'D', ' '))

	)

63 
	#af•_MARKER
 (
	`MAKE_MARKER
 ('a', 'f', 's', 'p'))

	)

64 
	#˛m_MARKER
 (
	`MAKE_MARKER
 ('c', 'l', 'm', ' '))

	)

65 
	#ñmo_MARKER
 (
	`MAKE_MARKER
 ('e', 'l', 'm', 'o'))

	)

67 
	#ISFT_MARKER
 (
	`MAKE_MARKER
 ('I', 'S', 'F', 'T'))

	)

68 
	#ICRD_MARKER
 (
	`MAKE_MARKER
 ('I', 'C', 'R', 'D'))

	)

69 
	#ICOP_MARKER
 (
	`MAKE_MARKER
 ('I', 'C', 'O', 'P'))

	)

70 
	#IARL_MARKER
 (
	`MAKE_MARKER
 ('I', 'A', 'R', 'L'))

	)

71 
	#IART_MARKER
 (
	`MAKE_MARKER
 ('I', 'A', 'R', 'T'))

	)

72 
	#INAM_MARKER
 (
	`MAKE_MARKER
 ('I', 'N', 'A', 'M'))

	)

73 
	#IENG_MARKER
 (
	`MAKE_MARKER
 ('I', 'E', 'N', 'G'))

	)

74 
	#IART_MARKER
 (
	`MAKE_MARKER
 ('I', 'A', 'R', 'T'))

	)

75 
	#ICOP_MARKER
 (
	`MAKE_MARKER
 ('I', 'C', 'O', 'P'))

	)

76 
	#IPRD_MARKER
 (
	`MAKE_MARKER
 ('I', 'P', 'R', 'D'))

	)

77 
	#ISRC_MARKER
 (
	`MAKE_MARKER
 ('I', 'S', 'R', 'C'))

	)

78 
	#ISBJ_MARKER
 (
	`MAKE_MARKER
 ('I', 'S', 'B', 'J'))

	)

79 
	#ICMT_MARKER
 (
	`MAKE_MARKER
 ('I', 'C', 'M', 'T'))

	)

82 
	#wvpk_MARKER
 (
	`MAKE_MARKER
 ('w', 'v', 'p', 'k'))

	)

83 
	#OggS_MARKER
 (
	`MAKE_MARKER
 ('O', 'g', 'g', 'S'))

	)

85 
	#WAV_PEAK_CHUNK_SIZE
(
ch
Ë(2 *  (Ë+ ch * ( (Ë+  ()))

	)

86 
	#WAV_BEXT_CHUNK_SIZE
 602

	)

89 { 
	mHAVE_RIFF
 = 0x01,

90 
	mHAVE_WAVE
 = 0x02,

91 
	mHAVE_fmt
 = 0x04,

92 
	mHAVE_Á˘
 = 0x08,

93 
	mHAVE_PEAK
 = 0x10,

94 
	mHAVE_d©a
 = 0x20,

95 
	mHAVE_Ÿhî
 = 0x80000000

101 c⁄° 
EXT_SUBFORMAT
 
	gMSGUID_SUBTYPE_PCM
 =

105 c⁄° 
EXT_SUBFORMAT
 
	gMSGUID_SUBTYPE_MS_ADPCM
 =

109 c⁄° 
EXT_SUBFORMAT
 
	gMSGUID_SUBTYPE_IEEE_FLOAT
 =

113 c⁄° 
EXT_SUBFORMAT
 
	gMSGUID_SUBTYPE_ALAW
 =

117 c⁄° 
EXT_SUBFORMAT
 
	gMSGUID_SUBTYPE_MULAW
 =

125 c⁄° 
EXT_SUBFORMAT
 
	gMSGUID_SUBTYPE_AMBISONIC_B_FORMAT_PCM
 =

129 c⁄° 
EXT_SUBFORMAT
 
	gMSGUID_SUBTYPE_AMBISONIC_B_FORMAT_IEEE_FLOAT
 =

137 c⁄° 
EXT_SUBFORMAT
 
	gMSGUID_SUBTYPE_PVOCEX
 =

146 
wav_ªad_hódî
 (
SF_PRIVATE
 *
psf
, *
blockÆign
, *
‰ame•îblock
) ;

147 
wav_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
) ;

149 
wavex_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
) ;

151 
wav_wrôe_èûî
 (
SF_PRIVATE
 *
psf
) ;

152 
wav_wrôe_°rögs
 (
SF_PRIVATE
 *
psf
, 
loˇti⁄
) ;

153 
wav_comm™d
 (
SF_PRIVATE
 *
psf
, 
comm™d
, *
d©a
, 
d©asize
) ;

154 
wav_˛o£
 (
SF_PRIVATE
 *
psf
) ;

156 
wav_subchunk_∑r£
 (
SF_PRIVATE
 *
psf
, 
chunk
) ;

157 
wav_ªad_sm∂_chunk
 (
SF_PRIVATE
 *
psf
, 
chunkÀn
) ;

158 
wav_ªad_acid_chunk
 (
SF_PRIVATE
 *
psf
, 
chunkÀn
) ;

159 
wav_ªad_bext_chunk
 (
SF_PRIVATE
 *
psf
, 
chunkÀn
) ;

160 
wav_wrôe_bext_chunk
 (
SF_PRIVATE
 *
psf
) ;

167 
	$wav_›í
 (
SF_PRIVATE
 *
psf
)

168 { 
f‹m©
, 
subf‹m©
, 
îr‹
, 
blockÆign
 = 0, 
‰ame•îblock
 = 0 ;

170 i‡(
psf
->
mode
 =
SFM_READ
 || (psf->modê=
SFM_RDWR
 &&Ösf->
fûñígth
 > 0))

171 { i‡((
îr‹
 = 
	`wav_ªad_hódî
 (
psf
, &
blockÆign
, &
‰ame•îblock
)))

172  
îr‹
 ;

175 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

177 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

178 { i‡(
psf
->
is_pùe
)

179  
SFE_NO_PIPE_WRITE
 ;

181 
f‹m©
 = 
psf
->
sf
.f‹m© & 
SF_FORMAT_TYPEMASK
 ;

182 i‡(
f‹m©
 !
SF_FORMAT_WAV
 && f‹m© !
SF_FORMAT_WAVEX
)

183  
SFE_BAD_OPEN_FORMAT
 ;

185 
psf
->
blockwidth
 =Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

188 
psf
->
ídün
 =Ösf->
sf
.
f‹m©
 & 
SF_FORMAT_ENDMASK
 ;

189 i‡(
CPU_IS_BIG_ENDIAN
 && 
psf
->
ídün
 =
SF_ENDIAN_CPU
)

190 
psf
->
ídün
 = 
SF_ENDIAN_BIG
 ;

191 i‡(
psf
->
ídün
 !
SF_ENDIAN_BIG
)

192 
psf
->
ídün
 = 
SF_ENDIAN_LITTLE
 ;

194 i‡(
psf
->
mode
 !
SFM_RDWR
 ||Ösf->
fûñígth
 < 44)

195 { 
psf
->
fûñígth
 = 0 ;

196 
psf
->
d©Æígth
 = 0 ;

197 
psf
->
d©aoff£t
 = 0 ;

198 
psf
->
sf
.
‰ames
 = 0 ;

201 i‡(
subf‹m©
 =
SF_FORMAT_IMA_ADPCM
 || subf‹m© =
SF_FORMAT_MS_ADPCM
)

202 { 
blockÆign
 = 
	`wav_w64_§©e2blocksize
 (
psf
->
sf
.
ßm∂î©e
 *Ösf->sf.
ch™√ls
) ;

203 
‰ame•îblock
 = -1 ;

206 
psf
->
°r_Êags
 = 
SF_STR_ALLOW_START
 | 
SF_STR_ALLOW_END
 ;

211 i‡(
psf
->
mode
 =
SFM_WRITE
 && (
subf‹m©
 =
SF_FORMAT_FLOAT
 || subf‹m© =
SF_FORMAT_DOUBLE
))

212 { i‡((
psf
->
≥ak_öfo
 = 
	`≥ak_öfo_ˇŒoc
 (psf->
sf
.
ch™√ls
)Ë=
NULL
)

213  
SFE_MALLOC_FAILED
 ;

214 
psf
->
≥ak_öfo
->
≥ak_loc
 = 
SF_PEAK_START
 ;

217 
psf
->
wrôe_hódî
 = (
f‹m©
 =
SF_FORMAT_WAV
Ë? 
wav_wrôe_hódî
 : 
wavex_wrôe_hódî
 ;

220 
psf
->
c⁄èöî_˛o£
 = 
wav_˛o£
 ;

221 
psf
->
comm™d
 = 
wav_comm™d
 ;

223 
subf‹m©
)

224 { 
SF_FORMAT_PCM_U8
 :

225 
SF_FORMAT_PCM_16
 :

226 
SF_FORMAT_PCM_24
 :

227 
SF_FORMAT_PCM_32
 :

228 
îr‹
 = 
	`pcm_öô
 (
psf
) ;

231 
SF_FORMAT_ULAW
 :

232 
îr‹
 = 
	`uœw_öô
 (
psf
) ;

235 
SF_FORMAT_ALAW
 :

236 
îr‹
 = 
	`Æaw_öô
 (
psf
) ;

240 
SF_FORMAT_FLOAT
 :

241 
îr‹
 = 
	`Êﬂt32_öô
 (
psf
) ;

244 
SF_FORMAT_DOUBLE
 :

245 
îr‹
 = 
	`doubÀ64_öô
 (
psf
) ;

248 
SF_FORMAT_IMA_ADPCM
 :

249 
îr‹
 = 
	`wav_w64_ima_öô
 (
psf
, 
blockÆign
, 
‰ame•îblock
) ;

252 
SF_FORMAT_MS_ADPCM
 :

253 
îr‹
 = 
	`wav_w64_mßdpcm_öô
 (
psf
, 
blockÆign
, 
‰ame•îblock
) ;

256 
SF_FORMAT_G721_32
 :

257 
îr‹
 = 
	`g72x_öô
 (
psf
) ;

261 
SF_FORMAT_GSM610
 :

262 
îr‹
 = 
	`gsm610_öô
 (
psf
) ;

265  :  
SFE_UNIMPLEMENTED
 ;

268 i‡(
psf
->
mode
 =
SFM_WRITE
 || (psf->modê=
SFM_RDWR
 &&Ösf->
fûñígth
 == 0))

269  
psf
->
	`wrôe_hódî
 (psf, 
SF_FALSE
) ;

271  
îr‹
 ;

272 
	}
}

279 
	$wav_ªad_hódî
 (
SF_PRIVATE
 *
psf
, *
blockÆign
, *
‰ame•îblock
)

280 { 
WAV_FMT
 
wav_fmt
 ;

281 
FACT_CHUNK
 
Á˘_chunk
 ;

282 
dw‹d
 = 0, 
m¨kî
, 
RIFFsize
, 
d⁄e
 = 0 ;

283 
∑r£°age
 = 0, 
îr‹
, 
f‹m©
 = 0 ;

284 *
˝å
 ;

286 
	`mem£t
 (&
wav_fmt
, 0,  (wav_fmt)) ;

288 
	`psf_böhódî_ªadf
 (
psf
, "p", 0) ;

290 ! 
d⁄e
)

291 { 
	`psf_böhódî_ªadf
 (
psf
, "m", &
m¨kî
) ;

293 
m¨kî
)

294 { 
RIFF_MARKER
 :

295 
RIFX_MARKER
 :

296 i‡(
∑r£°age
)

297  
SFE_WAV_NO_RIFF
 ;

299 
∑r£°age
 |
HAVE_RIFF
 ;

305 i‡(
m¨kî
 =
RIFF_MARKER
)

306 
psf
->
rwf_ídün
 = 
SF_ENDIAN_LITTLE
 ;

308 
psf
->
rwf_ídün
 = 
SF_ENDIAN_BIG
 ;

310 
	`psf_böhódî_ªadf
 (
psf
, "4", &
RIFFsize
) ;

312 i‡(
psf
->
fûeoff£t
 > 0 &&Ösf->
fûñígth
 > 
RIFFsize
 + 8)

314 
psf
->
fûñígth
 = 
RIFFsize
 + 8 ;

315 i‡(
m¨kî
 =
RIFF_MARKER
)

316 
	`psf_log_¥ötf
 (
psf
, "RIFF : %u\n", 
RIFFsize
) ;

318 
	`psf_log_¥ötf
 (
psf
, "RIFX : %u\n", 
RIFFsize
) ;

320 i‡(
psf
->
fûñígth
 < 
RIFFsize
 + 2 * 
	`SIGNED_SIZEOF
 (
dw‹d
))

321 { i‡(
m¨kî
 =
RIFF_MARKER
)

322 
	`psf_log_¥ötf
 (
psf
, "RIFF : %u (should bê%D)\n", 
RIFFsize
,Ösf->
fûñígth
 - 2 * 
	`SIGNED_SIZEOF
 (
dw‹d
)) ;

324 
	`psf_log_¥ötf
 (
psf
, "RIFX : %u (should bê%D)\n", 
RIFFsize
,Ösf->
fûñígth
 - 2 * 
	`SIGNED_SIZEOF
 (
dw‹d
)) ;

326 
RIFFsize
 = 
dw‹d
 ;

329 { i‡(
m¨kî
 =
RIFF_MARKER
)

330 
	`psf_log_¥ötf
 (
psf
, "RIFF : %u\n", 
RIFFsize
) ;

332 
	`psf_log_¥ötf
 (
psf
, "RIFX : %u\n", 
RIFFsize
) ;

336 
WAVE_MARKER
 :

337 i‡((
∑r£°age
 & 
HAVE_RIFF
) != HAVE_RIFF)

338  
SFE_WAV_NO_WAVE
 ;

339 
∑r£°age
 |
HAVE_WAVE
 ;

341 
	`psf_log_¥ötf
 (
psf
, "WAVE\n") ;

344 
fmt_MARKER
 :

345 i‡((
∑r£°age
 & (
HAVE_RIFF
 | 
HAVE_WAVE
)) != (HAVE_RIFF | HAVE_WAVE))

346  
SFE_WAV_NO_FMT
 ;

349 i‡(
∑r£°age
 & 
HAVE_fmt
)

352 
∑r£°age
 |
HAVE_fmt
 ;

354 
	`psf_böhódî_ªadf
 (
psf
, "4", &
dw‹d
) ;

355 
	`psf_log_¥ötf
 (
psf
, "fmà : %d\n", 
dw‹d
) ;

357 i‡((
îr‹
 = 
	`wav_w64_ªad_fmt_chunk
 (
psf
, &
wav_fmt
, 
dw‹d
)))

358  
îr‹
 ;

360 
f‹m©
 = 
wav_fmt
.format ;

363 
d©a_MARKER
 :

364 i‡((
∑r£°age
 & (
HAVE_RIFF
 | 
HAVE_WAVE
 | 
HAVE_fmt
)) != (HAVE_RIFF | HAVE_WAVE | HAVE_fmt))

365  
SFE_WAV_NO_DATA
 ;

367 i‡(
psf
->
mode
 =
SFM_RDWR
 && (
∑r£°age
 & 
HAVE_Ÿhî
) != 0)

368  
SFE_RDWR_BAD_HEADER
 ;

370 
∑r£°age
 |
HAVE_d©a
 ;

372 
	`psf_böhódî_ªadf
 (
psf
, "4", &
dw‹d
) ;

374 
psf
->
d©Æígth
 = 
dw‹d
 ;

375 
psf
->
d©aoff£t
 = 
	`psf_·ñl
 (psf) ;

377 i‡(
dw‹d
 =0 && 
RIFFsize
 =8 && 
psf
->
fûñígth
 > 44)

378 { 
	`psf_log_¥ötf
 (
psf
, "*** LooksÜikeá WAV file which wasn't closedÖroperly. Fixing it.\n") ;

379 
psf
->
d©Æígth
 = 
dw‹d
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

382 i‡(
psf
->
d©Æígth
 >Ösf->
fûñígth
 -Ösf->
d©aoff£t
)

383 { 
	`psf_log_¥ötf
 (
psf
, "d©®: %D (should bê%D)\n",Ösf->
d©Æígth
,Ösf->
fûñígth
 -Ösf->
d©aoff£t
) ;

384 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

387 
	`psf_log_¥ötf
 (
psf
, "d©®: %D\n",Ösf->
d©Æígth
) ;

390 i‡(
psf
->
d©Æígth
 +Ösf->
d©aoff£t
 <Ösf->
fûñígth
)

391 
psf
->
d©´nd
 =Ösf->
d©Æígth
 +Ösf->
d©aoff£t
 ;

393 i‡(
f‹m©
 =
WAVE_FORMAT_MS_ADPCM
 && 
psf
->
d©Æígth
 % 2)

394 { 
psf
->
d©Æígth
 ++ ;

395 
	`psf_log_¥ötf
 (
psf
, "*** DataÜength odd. Increasing it by 1.\n") ;

398 i‡(! 
psf
->
sf
.
£ekabÀ
)

402 
	`psf_f£ek
 (
psf
,Ösf->
d©Æígth
, 
SEEK_CUR
) ;

404 
dw‹d
 = 
	`psf_·ñl
 (
psf
) ;

405 i‡(
dw‹d
 !(
sf_cou¡_t
Ë(
psf
->
d©aoff£t
 +Ösf->
d©Æígth
))

406 
	`psf_log_¥ötf
 (
psf
, "***Ösf_f£ekÖa°ÉndÉº‹ ***\n", 
dw‹d
,Ösf->
d©aoff£t
 +Ösf->
d©Æígth
) ;

409 
Á˘_MARKER
 :

410 i‡((
∑r£°age
 & (
HAVE_RIFF
 | 
HAVE_WAVE
)) != (HAVE_RIFF | HAVE_WAVE))

411  
SFE_WAV_BAD_FACT
 ;

413 
∑r£°age
 |
HAVE_Á˘
 ;

415 i‡((
∑r£°age
 & 
HAVE_fmt
) != HAVE_fmt)

416 
	`psf_log_¥ötf
 (
psf
, "*** Should have 'fmt ' chunk before 'fact'\n") ;

418 
	`psf_böhódî_ªadf
 (
psf
, "44", &
dw‹d
, & (
Á˘_chunk
.
‰ames
)) ;

420 i‡(
dw‹d
 > 
	`SIGNED_SIZEOF
 (
Á˘_chunk
))

421 
	`psf_böhódî_ªadf
 (
psf
, "j", (Ë(
dw‹d
 - 
	`SIGNED_SIZEOF
 (
Á˘_chunk
))) ;

423 i‡(
dw‹d
)

424 
	`psf_log_¥ötf
 (
psf
, "%M : %d\n", 
m¨kî
, 
dw‹d
) ;

426 
	`psf_log_¥ötf
 (
psf
, "%M : %d (shouldÇŸ bêzîo)\n", 
m¨kî
, 
dw‹d
) ;

428 
	`psf_log_¥ötf
 (
psf
, " føme† : %d\n", 
Á˘_chunk
.
‰ames
) ;

431 
PEAK_MARKER
 :

432 i‡((
∑r£°age
 & (
HAVE_RIFF
 | 
HAVE_WAVE
 | 
HAVE_fmt
)) != (HAVE_RIFF | HAVE_WAVE | HAVE_fmt))

433  
SFE_WAV_PEAK_B4_FMT
 ;

435 
∑r£°age
 |
HAVE_PEAK
 ;

437 
	`psf_böhódî_ªadf
 (
psf
, "4", &
dw‹d
) ;

439 
	`psf_log_¥ötf
 (
psf
, "%M : %d\n", 
m¨kî
, 
dw‹d
) ;

440 i‡(
dw‹d
 !
	`WAV_PEAK_CHUNK_SIZE
 (
psf
->
sf
.
ch™√ls
))

441 { 
	`psf_böhódî_ªadf
 (
psf
, "j", 
dw‹d
) ;

442 
	`psf_log_¥ötf
 (
psf
, "*** FûêPEAK chunk sizêd€¢'àfô wôhÇumbî o‡ch™√l†(%d).\n",Ösf->
sf
.
ch™√ls
) ;

443  
SFE_WAV_BAD_PEAK
 ;

446 i‡((
psf
->
≥ak_öfo
 = 
	`≥ak_öfo_ˇŒoc
 (psf->
sf
.
ch™√ls
)Ë=
NULL
)

447  
SFE_MALLOC_FAILED
 ;

450 
	`psf_böhódî_ªadf
 (
psf
, "44", & (psf->
≥ak_öfo
->
vîsi⁄
), & (psf->≥ak_öfo->
time°amp
)) ;

452 i‡(
psf
->
≥ak_öfo
->
vîsi⁄
 != 1)

453 
	`psf_log_¥ötf
 (
psf
, " vîsi⁄ : %d *** (should bêvîsi⁄ 1)\n",Ösf->
≥ak_öfo
->
vîsi⁄
) ;

455 
	`psf_log_¥ötf
 (
psf
, " vîsi⁄ : %d\n",Ösf->
≥ak_öfo
->
vîsi⁄
) ;

457 
	`psf_log_¥ötf
 (
psf
, "Åimê°am∞: %d\n",Ösf->
≥ak_öfo
->
time°amp
) ;

458 
	`psf_log_¥ötf
 (
psf
, " Ch Position Value\n") ;

460 
˝å
 = 
psf
->
u
.
cbuf
 ;

461 
dw‹d
 = 0 ; dw‹d < (Ë
psf
->
sf
.
ch™√ls
 ; dword++)

462 { 
vÆue
 ;

463 
posôi⁄
 ;

464 
	`psf_böhódî_ªadf
 (
psf
, "f4", &
vÆue
, &
posôi⁄
) ;

465 
psf
->
≥ak_öfo
->
≥aks
 [
dw‹d
].
vÆue
 = value ;

466 
psf
->
≥ak_öfo
->
≥aks
 [
dw‹d
].
posôi⁄
 =Öosition ;

468 
	`LSF_SNPRINTF
 (
˝å
,  (
psf
->
u
.
cbuf
), " %2d %-12ld %g\n",

469 
dw‹d
, (Ë
psf
->
≥ak_öfo
->
≥aks
 [dw‹d].
posôi⁄
,Ösf->≥ak_öfo->≥ak†[dw‹d].
vÆue
) ;

470 
˝å
 [ (
psf
->
u
.
cbuf
) - 1] = 0 ;

471 
	`psf_log_¥ötf
 (
psf
, 
˝å
) ;

474 
psf
->
≥ak_öfo
->
≥ak_loc
 = ((
∑r£°age
 & 
HAVE_d©a
Ë=0Ë? 
SF_PEAK_START
 : 
SF_PEAK_END
 ;

477 
cue_MARKER
 :

478 
∑r£°age
 |
HAVE_Ÿhî
 ;

480 { 
byã§ód
, 
cue_cou¡
 ;

481 
id
, 
posôi⁄
, 
chunk_id
, 
chunk_°¨t
, 
block_°¨t
, 
off£t
 ;

483 
byã§ód
 = 
	`psf_böhódî_ªadf
 (
psf
, "44", &
dw‹d
, &
cue_cou¡
) ;

484 
byã§ód
 -= 4 ;

485 
	`psf_log_¥ötf
 (
psf
, "%M : %u\n", 
m¨kî
, 
dw‹d
) ;

487 i‡(
cue_cou¡
 > 10)

488 { 
	`psf_log_¥ötf
 (
psf
, " Cou¡ : %d (skùpög)\n", 
cue_cou¡
) ;

489 
	`psf_böhódî_ªadf
 (
psf
, "j", 
cue_cou¡
 * 24) ;

493 
	`psf_log_¥ötf
 (
psf
, " Cou¡ : %d\n", 
cue_cou¡
) ;

495 
cue_cou¡
)

496 { 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "444444", &
id
, &
posôi⁄
,

497 &
chunk_id
, &
chunk_°¨t
, &
block_°¨t
, &
off£t
) ;

498 
	`psf_log_¥ötf
 (
psf
, " Cue ID : %2d"

502 
id
, 
posôi⁄
, 
chunk_id
, 
chunk_°¨t
, 
block_°¨t
, 
off£t
) ;

503 
cue_cou¡
 -- ;

506 i‡(
byã§ód
 !
dw‹d
)

507 { 
	`psf_log_¥ötf
 (
psf
, "**** Chunk sizêweúd√s†(%d !%d)\n", 
dw‹d
, 
byã§ód
) ;

508 
	`psf_böhódî_ªadf
 (
psf
, "j", 
dw‹d
 - 
byã§ód
) ;

513 
sm∂_MARKER
 :

514 
∑r£°age
 |
HAVE_Ÿhî
 ;

516 
	`psf_böhódî_ªadf
 (
psf
, "4", &
dw‹d
) ;

517 
	`psf_log_¥ötf
 (
psf
, "sm∂ : %u\n", 
dw‹d
) ;

519 i‡((
îr‹
 = 
	`wav_ªad_sm∂_chunk
 (
psf
, 
dw‹d
)))

520  
îr‹
 ;

523 
acid_MARKER
 :

524 
∑r£°age
 |
HAVE_Ÿhî
 ;

526 
	`psf_böhódî_ªadf
 (
psf
, "4", &
dw‹d
) ;

527 
	`psf_log_¥ötf
 (
psf
, "acid : %u\n", 
dw‹d
) ;

529 i‡((
îr‹
 = 
	`wav_ªad_acid_chunk
 (
psf
, 
dw‹d
)))

530  
îr‹
 ;

533 
INFO_MARKER
 :

534 
LIST_MARKER
 :

535 
∑r£°age
 |
HAVE_Ÿhî
 ;

537 i‡((
îr‹
 = 
	`wav_subchunk_∑r£
 (
psf
, 
m¨kî
)) != 0)

538  
îr‹
 ;

541 
bext_MARKER
 :

542 
∑r£°age
 |
HAVE_Ÿhî
 ;

544 
	`psf_böhódî_ªadf
 (
psf
, "4", &
dw‹d
) ;

545 i‡(
dw‹d
 < 
WAV_BEXT_CHUNK_SIZE
)

546 
	`psf_log_¥ötf
 (
psf
, "bexà: %u (should bê>%d)\n", 
dw‹d
, 
WAV_BEXT_CHUNK_SIZE
) ;

548 
	`psf_log_¥ötf
 (
psf
, "bexà: %u\n", 
dw‹d
) ;

550 i‡((
îr‹
 = 
	`wav_ªad_bext_chunk
 (
psf
, 
dw‹d
)))

551  
îr‹
 ;

554 
°rc_MARKER
 :

556 
af•_MARKER
 :

557 
˛m_MARKER
 :

558 
ñmo_MARKER
 :

559 
Àvl_MARKER
 :

560 
∂°_MARKER
 :

561 
DISP_MARKER
 :

562 
MEXT_MARKER
 :

563 
PAD_MARKER
 :

564 
∑r£°age
 |
HAVE_Ÿhî
 ;

566 
	`psf_böhódî_ªadf
 (
psf
, "4", &
dw‹d
) ;

567 
	`psf_log_¥ötf
 (
psf
, "%M : %u\n", 
m¨kî
, 
dw‹d
) ;

568 
dw‹d
 += (dword & 1) ;

569 
	`psf_böhódî_ªadf
 (
psf
, "j", 
dw‹d
) ;

573 
∑r£°age
 |
HAVE_Ÿhî
 ;

574 i‡(
	`i•röt
 ((
m¨kî
 >> 24) & 0xFF) && isprint ((marker >> 16) & 0xFF)

575 && 
	`i•röt
 ((
m¨kî
 >> 8) & 0xFF) && isprint (marker & 0xFF))

576 { 
	`psf_böhódî_ªadf
 (
psf
, "4", &
dw‹d
) ;

577 
	`psf_log_¥ötf
 (
psf
, "*** %M : %d (unknow¿m¨kî)\n", 
m¨kî
, 
dw‹d
) ;

578 
	`psf_böhódî_ªadf
 (
psf
, "j", 
dw‹d
) ;

581 i‡(
	`psf_·ñl
 (
psf
) & 0x03)

582 { 
	`psf_log_¥ötf
 (
psf
, " Unknow¿chunk m¨kîáàposôi⁄ %d. Resynchög.\n", 
dw‹d
 - 4) ;

583 
	`psf_böhódî_ªadf
 (
psf
, "j", -3) ;

586 
	`psf_log_¥ötf
 (
psf
, "*** Unknow¿chunk m¨kî (%XË©Öosôi⁄ %D. ExôögÖ¨£r.\n", 
m¨kî
, 
	`psf_·ñl
 (psf) - 4) ;

587 
d⁄e
 = 
SF_TRUE
 ;

591 i‡(! 
psf
->
sf
.
£ekabÀ
 && (
∑r£°age
 & 
HAVE_d©a
))

594 i‡(
	`psf_·ñl
 (
psf
Ë>psf->
fûñígth
 - 
	`SIGNED_SIZEOF
 (
dw‹d
))

595 { 
	`psf_log_¥ötf
 (
psf
, "End\n") ;

600 i‡(! 
psf
->
d©aoff£t
)

601  
SFE_WAV_NO_DATA
 ;

604 
psf
->
ídün
 =Ösf->
rwf_ídün
 ;

606 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
, 
SEEK_SET
) ;

608 i‡(
psf
->
is_pùe
 == 0)

613 
	`psf_böhódî_ªadf
 (
psf
, "4", &
m¨kî
) ;

614 i‡(
m¨kî
 =
wvpk_MARKER
 || m¨kî =
OggS_MARKER
)

615  
SFE_WAV_WVPK_DATA
 ;

619 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
, 
SEEK_SET
) ;

621 i‡(
psf
->
blockwidth
)

622 { i‡(
psf
->
fûñígth
 -Ösf->
d©aoff£t
 <Ösf->
d©Æígth
)

623 
psf
->
sf
.
‰ames
 = (psf->
fûñígth
 -Ösf->
d©aoff£t
Ë/Ösf->
blockwidth
 ;

625 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 /Ösf->
blockwidth
 ;

628 
f‹m©
)

629 { 
WAVE_FORMAT_EXTENSIBLE
 :

630 i‡(
psf
->
sf
.
f‹m©
 =(
SF_FORMAT_WAVEX
 | 
SF_FORMAT_MS_ADPCM
))

631 { *
blockÆign
 = 
wav_fmt
.
mßdpcm
.blockalign ;

632 *
‰ame•îblock
 = 
wav_fmt
.
mßdpcm
.
ßm∂e•îblock
 ;

636 
WAVE_FORMAT_PCM
 :

637 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_WAV
 | 
	`u_bôwidth_to_subf‹m©
 (psf->
byãwidth
 * 8) ;

640 
WAVE_FORMAT_MULAW
 :

641 
IBM_FORMAT_MULAW
 :

642 
psf
->
sf
.
f‹m©
 = (
SF_FORMAT_WAV
 | 
SF_FORMAT_ULAW
) ;

645 
WAVE_FORMAT_ALAW
 :

646 
IBM_FORMAT_ALAW
 :

647 
psf
->
sf
.
f‹m©
 = (
SF_FORMAT_WAV
 | 
SF_FORMAT_ALAW
) ;

650 
WAVE_FORMAT_MS_ADPCM
 :

651 
psf
->
sf
.
f‹m©
 = (
SF_FORMAT_WAV
 | 
SF_FORMAT_MS_ADPCM
) ;

652 *
blockÆign
 = 
wav_fmt
.
mßdpcm
.blockalign ;

653 *
‰ame•îblock
 = 
wav_fmt
.
mßdpcm
.
ßm∂e•îblock
 ;

656 
WAVE_FORMAT_IMA_ADPCM
 :

657 
psf
->
sf
.
f‹m©
 = (
SF_FORMAT_WAV
 | 
SF_FORMAT_IMA_ADPCM
) ;

658 *
blockÆign
 = 
wav_fmt
.
ima
.blockalign ;

659 *
‰ame•îblock
 = 
wav_fmt
.
ima
.
ßm∂e•îblock
 ;

662 
WAVE_FORMAT_GSM610
 :

663 
psf
->
sf
.
f‹m©
 = (
SF_FORMAT_WAV
 | 
SF_FORMAT_GSM610
) ;

666 
WAVE_FORMAT_IEEE_FLOAT
 :

667 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_WAV
 ;

668 
psf
->
sf
.
f‹m©
 |’sf->
byãwidth
 =8Ë? 
SF_FORMAT_DOUBLE
 : 
SF_FORMAT_FLOAT
 ;

671 
WAVE_FORMAT_G721_ADPCM
 :

672 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_WAV
 | 
SF_FORMAT_G721_32
 ;

675  :  
SFE_UNIMPLEMENTED
 ;

679 i‡(
psf
->
ídün
 =
SF_ENDIAN_BIG
)

680 
psf
->
sf
.
f‹m©
 |
SF_ENDIAN_BIG
 ;

683 
	}
}

686 
	$wav_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
)

687 { 
sf_cou¡_t
 
cuºít
 ;

688 
fmt_size
, 
k
, 
subf‹m©
, 
add_Á˘_chunk
 = 
SF_FALSE
 ;

690 
cuºít
 = 
	`psf_·ñl
 (
psf
) ;

692 i‡(
ˇlc_Àngth
)

693 { 
psf
->
fûñígth
 = 
	`psf_gë_fûñí
 (psf) ;

695 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

697 i‡(
psf
->
d©´nd
)

698 
psf
->
d©Æígth
 -psf->
fûñígth
 -Ösf->
d©´nd
 ;

700 i‡(
psf
->
byãwidth
 > 0)

701 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 / (psf->
byãwidth
 *Ösf->sf.
ch™√ls
) ;

705 
psf
->
hódî
 [0] = 0 ;

706 
psf
->
hódödex
 = 0 ;

707 
	`psf_f£ek
 (
psf
, 0, 
SEEK_SET
) ;

717 i‡(
psf
->
ídün
 =
SF_ENDIAN_LITTLE
)

718 
	`psf_böhódî_wrôef
 (
psf
, "ëm8", 
RIFF_MARKER
, (psf->
fûñígth
 < 8) ? 8 :Ösf->filelength - 8) ;

720 
	`psf_böhódî_wrôef
 (
psf
, "Etm8", 
RIFX_MARKER
, (psf->
fûñígth
 < 8) ? 8 :Ösf->filelength - 8) ;

723 
	`psf_böhódî_wrôef
 (
psf
, "mm", 
WAVE_MARKER
, 
fmt_MARKER
) ;

725 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

727 
subf‹m©
)

728 { 
SF_FORMAT_PCM_U8
 :

729 
SF_FORMAT_PCM_16
 :

730 
SF_FORMAT_PCM_24
 :

731 
SF_FORMAT_PCM_32
 :

732 
fmt_size
 = 2 + 2 + 4 + 4 + 2 + 2 ;

735 
	`psf_böhódî_wrôef
 (
psf
, "4224", 
fmt_size
, 
WAVE_FORMAT_PCM
,Ösf->
sf
.
ch™√ls
,Ösf->sf.
ßm∂î©e
) ;

737 
	`psf_böhódî_wrôef
 (
psf
, "4",Ösf->
sf
.
ßm∂î©e
 *Ösf->
byãwidth
 *Ösf->sf.
ch™√ls
) ;

739 
	`psf_böhódî_wrôef
 (
psf
, "22",Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
,Ösf->bytewidth * 8) ;

742 
SF_FORMAT_FLOAT
 :

743 
SF_FORMAT_DOUBLE
 :

744 
fmt_size
 = 2 + 2 + 4 + 4 + 2 + 2 ;

747 
	`psf_böhódî_wrôef
 (
psf
, "4224", 
fmt_size
, 
WAVE_FORMAT_IEEE_FLOAT
,Ösf->
sf
.
ch™√ls
,Ösf->sf.
ßm∂î©e
) ;

749 
	`psf_böhódî_wrôef
 (
psf
, "4",Ösf->
sf
.
ßm∂î©e
 *Ösf->
byãwidth
 *Ösf->sf.
ch™√ls
) ;

751 
	`psf_böhódî_wrôef
 (
psf
, "22",Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
,Ösf->bytewidth * 8) ;

753 
add_Á˘_chunk
 = 
SF_TRUE
 ;

756 
SF_FORMAT_ULAW
 :

757 
fmt_size
 = 2 + 2 + 4 + 4 + 2 + 2 ;

760 
	`psf_böhódî_wrôef
 (
psf
, "4224", 
fmt_size
, 
WAVE_FORMAT_MULAW
,Ösf->
sf
.
ch™√ls
,Ösf->sf.
ßm∂î©e
) ;

762 
	`psf_böhódî_wrôef
 (
psf
, "4",Ösf->
sf
.
ßm∂î©e
 *Ösf->
byãwidth
 *Ösf->sf.
ch™√ls
) ;

764 
	`psf_böhódî_wrôef
 (
psf
, "22",Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
, 8) ;

766 
add_Á˘_chunk
 = 
SF_TRUE
 ;

769 
SF_FORMAT_ALAW
 :

770 
fmt_size
 = 2 + 2 + 4 + 4 + 2 + 2 ;

773 
	`psf_böhódî_wrôef
 (
psf
, "4224", 
fmt_size
, 
WAVE_FORMAT_ALAW
,Ösf->
sf
.
ch™√ls
,Ösf->sf.
ßm∂î©e
) ;

775 
	`psf_böhódî_wrôef
 (
psf
, "4",Ösf->
sf
.
ßm∂î©e
 *Ösf->
byãwidth
 *Ösf->sf.
ch™√ls
) ;

777 
	`psf_böhódî_wrôef
 (
psf
, "22",Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
, 8) ;

779 
add_Á˘_chunk
 = 
SF_TRUE
 ;

783 
SF_FORMAT_IMA_ADPCM
 :

784 { 
blockÆign
, 
‰ame•îblock
, 
byã•î£c
 ;

786 
blockÆign
 = 
	`wav_w64_§©e2blocksize
 (
psf
->
sf
.
ßm∂î©e
 *Ösf->sf.
ch™√ls
) ;

787 
‰ame•îblock
 = 2 * (
blockÆign
 - 4 * 
psf
->
sf
.
ch™√ls
) /Ösf->sf.channels + 1 ;

788 
byã•î£c
 = (
psf
->
sf
.
ßm∂î©e
 * 
blockÆign
Ë/ 
‰ame•îblock
 ;

791 
fmt_size
 = 2 + 2 + 4 + 4 + 2 + 2 + 2 + 2 ;

794 
	`psf_böhódî_wrôef
 (
psf
, "42244", 
fmt_size
, 
WAVE_FORMAT_IMA_ADPCM
,

795 
psf
->
sf
.
ch™√ls
,Ösf->sf.
ßm∂î©e
, 
byã•î£c
) ;

798 
	`psf_böhódî_wrôef
 (
psf
, "2222", 
blockÆign
, 4, 2, 
‰ame•îblock
) ;

801 
add_Á˘_chunk
 = 
SF_TRUE
 ;

804 
SF_FORMAT_MS_ADPCM
 :

805 { 
blockÆign
, 
‰ame•îblock
, 
byã•î£c
, 
exåabyãs
 ;

807 
blockÆign
 = 
	`wav_w64_§©e2blocksize
 (
psf
->
sf
.
ßm∂î©e
 *Ösf->sf.
ch™√ls
) ;

808 
‰ame•îblock
 = 2 + 2 * (
blockÆign
 - 7 * 
psf
->
sf
.
ch™√ls
) /Ösf->sf.channels ;

809 
byã•î£c
 = (
psf
->
sf
.
ßm∂î©e
 * 
blockÆign
Ë/ 
‰ame•îblock
 ;

812 
exåabyãs
 = 2 + 2 + 
MSADPCM_ADAPT_COEFF_COUNT
 * (2 + 2) ;

813 
fmt_size
 = 2 + 2 + 4 + 4 + 2 + 2 + 2 + 
exåabyãs
 ;

816 
	`psf_böhódî_wrôef
 (
psf
, "422", 
fmt_size
, 
WAVE_FORMAT_MS_ADPCM
,Ösf->
sf
.
ch™√ls
) ;

819 
	`psf_böhódî_wrôef
 (
psf
, "44",Ösf->
sf
.
ßm∂î©e
, 
byã•î£c
) ;

822 
	`psf_böhódî_wrôef
 (
psf
, "22222", 
blockÆign
, 4, 
exåabyãs
, 
‰ame•îblock
, 7) ;

824 
	`mßdpcm_wrôe_ad≠t_c€ffs
 (
psf
) ;

827 
add_Á˘_chunk
 = 
SF_TRUE
 ;

831 
SF_FORMAT_G721_32
 :

833 
fmt_size
 = 2 + 2 + 4 + 4 + 2 + 2 + 2 + 2 ;

836 
	`psf_böhódî_wrôef
 (
psf
, "42244", 
fmt_size
, 
WAVE_FORMAT_G721_ADPCM
,

837 
psf
->
sf
.
ch™√ls
,Ösf->sf.
ßm∂î©e
,Ösf->sf.samplerate *Ösf->sf.channels / 2) ;

840 
	`psf_böhódî_wrôef
 (
psf
, "2222", 64, 4, 2, 0) ;

842 
add_Á˘_chunk
 = 
SF_TRUE
 ;

847 
SF_FORMAT_GSM610
 :

848 { 
blockÆign
, 
‰ame•îblock
, 
byã•î£c
 ;

850 
blockÆign
 = 
WAV_W64_GSM610_BLOCKSIZE
 ;

851 
‰ame•îblock
 = 
WAV_W64_GSM610_SAMPLES
 ;

852 
byã•î£c
 = (
psf
->
sf
.
ßm∂î©e
 * 
blockÆign
Ë/ 
‰ame•îblock
 ;

855 
fmt_size
 = 2 + 2 + 4 + 4 + 2 + 2 + 2 + 2 ;

858 
	`psf_böhódî_wrôef
 (
psf
, "422", 
fmt_size
, 
WAVE_FORMAT_GSM610
,Ösf->
sf
.
ch™√ls
) ;

861 
	`psf_böhódî_wrôef
 (
psf
, "44",Ösf->
sf
.
ßm∂î©e
, 
byã•î£c
) ;

864 
	`psf_böhódî_wrôef
 (
psf
, "2222", 
blockÆign
, 0, 2, 
‰ame•îblock
) ;

867 
add_Á˘_chunk
 = 
SF_TRUE
 ;

870  :  
SFE_UNIMPLEMENTED
 ;

873 i‡(
add_Á˘_chunk
)

874 
	`psf_böhódî_wrôef
 (
psf
, "tm48", 
Á˘_MARKER
, 4,Ösf->
sf
.
‰ames
) ;

876 i‡(
psf
->
°r_Êags
 & 
SF_STR_LOCATE_START
)

877 
	`wav_wrôe_°rögs
 (
psf
, 
SF_STR_LOCATE_START
) ;

879 i‡(
psf
->
≥ak_öfo
 !
NULL
 &&Ösf->≥ak_öfo->
≥ak_loc
 =
SF_PEAK_START
)

880 { 
	`psf_böhódî_wrôef
 (
psf
, "m4", 
PEAK_MARKER
, 
	`WAV_PEAK_CHUNK_SIZE
 (psf->
sf
.
ch™√ls
)) ;

881 
	`psf_böhódî_wrôef
 (
psf
, "44", 1, 
	`time
 (
NULL
)) ;

882 
k
 = 0 ; k < 
psf
->
sf
.
ch™√ls
 ; k++)

883 
	`psf_böhódî_wrôef
 (
psf
, "·8", (Ëpsf->
≥ak_öfo
->
≥aks
 [
k
].
vÆue
,Ösf->≥ak_öfo->≥ak†[k].
posôi⁄
) ;

886 i‡(
psf
->
brﬂdˇ°_öfo
 !
NULL
)

887 
	`wav_wrôe_bext_chunk
 (
psf
) ;

889 i‡(
psf
->
ö°rumít
 !
NULL
)

890 { 
tmp
 ;

891 
dtu√
 = () (0x40000000) / 25.0 ;

893 
	`psf_böhódî_wrôef
 (
psf
, "m4", 
sm∂_MARKER
, 9 * 4 +Ösf->
ö°rumít
->
lo›_cou¡
 * 6 * 4) ;

894 
	`psf_böhódî_wrôef
 (
psf
, "44", 0, 0) ;

895 
tmp
 = (Ë(1.0e9 / 
psf
->
sf
.
ßm∂î©e
) ;

896 
	`psf_böhódî_wrôef
 (
psf
, "44", 
tmp
,Ösf->
ö°rumít
->
ba£nŸe
) ;

897 
tmp
 = (Ë(
psf
->
ö°rumít
->
dëu√
 * 
dtu√
 + 0.5) ;

898 
	`psf_böhódî_wrôef
 (
psf
, "4", 
tmp
) ;

899 
	`psf_böhódî_wrôef
 (
psf
, "44", 0, 0) ;

900 
	`psf_böhódî_wrôef
 (
psf
, "44",Ösf->
ö°rumít
->
lo›_cou¡
, 0) ;

902 
tmp
 = 0 ;Åm∞< 
psf
->
ö°rumít
->
lo›_cou¡
 ;Åmp++)

903 { 
ty≥
 ;

905 
ty≥
 = 
psf
->
ö°rumít
->
lo›s
 [
tmp
].
mode
 ;

906 
ty≥
 = (ty≥ =
SF_LOOP_FORWARD
 ? 0 :Åy≥==
SF_LOOP_BACKWARD
 ? 2 :Åy≥ =
SF_LOOP_ALTERNATING
 ? 1 : 32) ;

908 
	`psf_böhódî_wrôef
 (
psf
, "44", 
tmp
, 
ty≥
) ;

909 
	`psf_böhódî_wrôef
 (
psf
, "44",Ösf->
ö°rumít
->
lo›s
 [
tmp
].
°¨t
,Ösf->ö°rumít->lo›†[tmp].
íd
) ;

910 
	`psf_böhódî_wrôef
 (
psf
, "44", 0,Ösf->
ö°rumít
->
lo›s
 [
tmp
].
cou¡
) ;

914 
	`psf_böhódî_wrôef
 (
psf
, "tm8", 
d©a_MARKER
,Ösf->
d©Æígth
) ;

915 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

916 i‡(
psf
->
îr‹
)

917  
psf
->
îr‹
 ;

919 
psf
->
d©aoff£t
 =Ösf->
hódödex
 ;

921 i‡(
cuºít
 < 
psf
->
d©aoff£t
)

922 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
, 
SEEK_SET
) ;

923 i‡(
cuºít
 > 0)

924 
	`psf_f£ek
 (
psf
, 
cuºít
, 
SEEK_SET
) ;

926  
psf
->
îr‹
 ;

927 
	}
}

932 
	$wavex_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
)

933 { 
sf_cou¡_t
 
cuºít
 ;

934 
fmt_size
, 
k
, 
subf‹m©
, 
add_Á˘_chunk
 = 
SF_FALSE
 ;

936 
cuºít
 = 
	`psf_·ñl
 (
psf
) ;

938 i‡(
ˇlc_Àngth
)

939 { 
psf
->
fûñígth
 = 
	`psf_gë_fûñí
 (psf) ;

941 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

943 i‡(
psf
->
d©´nd
)

944 
psf
->
d©Æígth
 -psf->
fûñígth
 -Ösf->
d©´nd
 ;

946 i‡(
psf
->
byãwidth
 > 0)

947 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 / (psf->
byãwidth
 *Ösf->sf.
ch™√ls
) ;

952 
psf
->
hódî
 [0] = 0 ;

953 
psf
->
hódödex
 = 0 ;

954 
	`psf_f£ek
 (
psf
, 0, 
SEEK_SET
) ;

963 i‡(
psf
->
ídün
 =
SF_ENDIAN_LITTLE
)

964 { i‡(
psf
->
fûñígth
 < 8)

965 
	`psf_böhódî_wrôef
 (
psf
, "tm8", 
RIFF_MARKER
, 8) ;

967 
	`psf_böhódî_wrôef
 (
psf
, "tm8", 
RIFF_MARKER
,Ösf->
fûñígth
 - 8) ;

970 { i‡(
psf
->
fûñígth
 < 8)

971 
	`psf_böhódî_wrôef
 (
psf
, "Etm8", 
RIFX_MARKER
, 8) ;

973 
	`psf_böhódî_wrôef
 (
psf
, "Etm8", 
RIFX_MARKER
,Ösf->
fûñígth
 - 8) ;

977 
	`psf_böhódî_wrôef
 (
psf
, "mm", 
WAVE_MARKER
, 
fmt_MARKER
) ;

979 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

982 
subf‹m©
)

983 { 
SF_FORMAT_PCM_U8
 :

984 
SF_FORMAT_PCM_16
 :

985 
SF_FORMAT_PCM_24
 :

986 
SF_FORMAT_PCM_32
 :

987 
SF_FORMAT_FLOAT
 :

988 
SF_FORMAT_DOUBLE
 :

989 
SF_FORMAT_ULAW
 :

990 
SF_FORMAT_ALAW
 :

991 
fmt_size
 = 2 + 2 + 4 + 4 + 2 + 2 + 2 + 2 + 4 + 4 + 2 + 2 + 8 ;

994 
	`psf_böhódî_wrôef
 (
psf
, "4224", 
fmt_size
, 
WAVE_FORMAT_EXTENSIBLE
,Ösf->
sf
.
ch™√ls
,Ösf->sf.
ßm∂î©e
) ;

996 
	`psf_böhódî_wrôef
 (
psf
, "4",Ösf->
sf
.
ßm∂î©e
 *Ösf->
byãwidth
 *Ösf->sf.
ch™√ls
) ;

998 
	`psf_böhódî_wrôef
 (
psf
, "22",Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
,Ösf->bytewidth * 8) ;

1001 
	`psf_böhódî_wrôef
 (
psf
, "2", 22) ;

1004 
	`psf_böhódî_wrôef
 (
psf
, "2",Ösf->
byãwidth
 * 8) ;

1011 
psf
->
sf
.
ch™√ls
)

1013 
	`psf_böhódî_wrôef
 (
psf
, "4", 0x4) ;

1017 
	`psf_böhódî_wrôef
 (
psf
, "4", 0x1 | 0x2) ;

1021 
	`psf_böhódî_wrôef
 (
psf
, "4", 0x1 | 0x2 | 0x10 | 0x20) ;

1025 
	`psf_böhódî_wrôef
 (
psf
, "4", 0x1 | 0x2 | 0x4 | 0x8 | 0x10 | 0x20) ;

1029 
	`psf_böhódî_wrôef
 (
psf
, "4", 0x1 | 0x2 | 0x4 | 0x8 | 0x10 | 0x20 | 0x40 | 0x80) ;

1033 
	`psf_böhódî_wrôef
 (
psf
, "4", 0x0) ;

1039 
SF_FORMAT_MS_ADPCM
 :

1041  
SFE_UNIMPLEMENTED
 ;

1046 
subf‹m©
)

1047 { 
SF_FORMAT_PCM_U8
 :

1048 
SF_FORMAT_PCM_16
 :

1049 
SF_FORMAT_PCM_24
 :

1050 
SF_FORMAT_PCM_32
 :

1051 
	`wavex_wrôe_guid
 (
psf
, &
MSGUID_SUBTYPE_PCM
) ;

1054 
SF_FORMAT_FLOAT
 :

1055 
SF_FORMAT_DOUBLE
 :

1056 
	`wavex_wrôe_guid
 (
psf
, &
MSGUID_SUBTYPE_IEEE_FLOAT
) ;

1057 
add_Á˘_chunk
 = 
SF_TRUE
 ;

1060 
SF_FORMAT_ULAW
 :

1061 
	`wavex_wrôe_guid
 (
psf
, &
MSGUID_SUBTYPE_MULAW
) ;

1062 
add_Á˘_chunk
 = 
SF_TRUE
 ;

1065 
SF_FORMAT_ALAW
 :

1066 
	`wavex_wrôe_guid
 (
psf
, &
MSGUID_SUBTYPE_ALAW
) ;

1067 
add_Á˘_chunk
 = 
SF_TRUE
 ;

1070 
SF_FORMAT_MS_ADPCM
 :

1072  :  
SFE_UNIMPLEMENTED
 ;

1075 i‡(
add_Á˘_chunk
)

1076 
	`psf_böhódî_wrôef
 (
psf
, "tm48", 
Á˘_MARKER
, 4,Ösf->
sf
.
‰ames
) ;

1078 i‡(
psf
->
°r_Êags
 & 
SF_STR_LOCATE_START
)

1079 
	`wav_wrôe_°rögs
 (
psf
, 
SF_STR_LOCATE_START
) ;

1081 i‡(
psf
->
≥ak_öfo
 !
NULL
 &&Ösf->≥ak_öfo->
≥ak_loc
 =
SF_PEAK_START
)

1082 { 
	`psf_böhódî_wrôef
 (
psf
, "m4", 
PEAK_MARKER
, 
	`WAV_PEAK_CHUNK_SIZE
 (psf->
sf
.
ch™√ls
)) ;

1083 
	`psf_böhódî_wrôef
 (
psf
, "44", 1, 
	`time
 (
NULL
)) ;

1084 
k
 = 0 ; k < 
psf
->
sf
.
ch™√ls
 ; k++)

1085 
	`psf_böhódî_wrôef
 (
psf
, "·8", (Ëpsf->
≥ak_öfo
->
≥aks
 [
k
].
vÆue
,Ösf->≥ak_öfo->≥ak†[k].
posôi⁄
) ;

1088 
	`psf_böhódî_wrôef
 (
psf
, "tm8", 
d©a_MARKER
,Ösf->
d©Æígth
) ;

1089 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

1090 i‡(
psf
->
îr‹
)

1091  
psf
->
îr‹
 ;

1093 
psf
->
d©aoff£t
 =Ösf->
hódödex
 ;

1095 i‡(
cuºít
 < 
psf
->
d©aoff£t
)

1096 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
, 
SEEK_SET
) ;

1097 i‡(
cuºít
 > 0)

1098 
	`psf_f£ek
 (
psf
, 
cuºít
, 
SEEK_SET
) ;

1100  
psf
->
îr‹
 ;

1101 
	}
}

1106 
	$wav_wrôe_èûî
 (
SF_PRIVATE
 *
psf
)

1107 { 
k
 ;

1110 
psf
->
hódî
 [0] = 0 ;

1111 
psf
->
hódödex
 = 0 ;

1113 
psf
->
d©´nd
 = 
	`psf_f£ek
 (psf, 0, 
SEEK_END
) ;

1116 i‡(
psf
->
≥ak_öfo
 !
NULL
 &&Ösf->≥ak_öfo->
≥ak_loc
 =
SF_PEAK_END
)

1117 { 
	`psf_böhódî_wrôef
 (
psf
, "m4", 
PEAK_MARKER
, 
	`WAV_PEAK_CHUNK_SIZE
 (psf->
sf
.
ch™√ls
)) ;

1118 
	`psf_böhódî_wrôef
 (
psf
, "44", 1, 
	`time
 (
NULL
)) ;

1119 
k
 = 0 ; k < 
psf
->
sf
.
ch™√ls
 ; k++)

1120 
	`psf_böhódî_wrôef
 (
psf
, "f4",Ösf->
≥ak_öfo
->
≥aks
 [
k
].
vÆue
,Ösf->≥ak_öfo->≥ak†[k].
posôi⁄
) ;

1123 i‡(
psf
->
°r_Êags
 & 
SF_STR_LOCATE_END
)

1124 
	`wav_wrôe_°rögs
 (
psf
, 
SF_STR_LOCATE_END
) ;

1127 i‡(
psf
->
hódödex
 > 0)

1128 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

1131 
	}
}

1134 
	$wav_wrôe_°rögs
 (
SF_PRIVATE
 *
psf
, 
loˇti⁄
)

1135 { 
k
, 
¥ev_hód_ödex
, 
ßved_hód_ödex
 ;

1137 
¥ev_hód_ödex
 = 
psf
->
hódödex
 + 4 ;

1139 
	`psf_böhódî_wrôef
 (
psf
, "m4m", 
LIST_MARKER
, 0xBADBAD, 
INFO_MARKER
) ;

1141 
k
 = 0 ; k < 
SF_MAX_STRINGS
 ; k++)

1142 { i‡(
psf
->
°rögs
 [
k
].
ty≥
 == 0)

1144 i‡(
psf
->
°rögs
 [
k
].
Êags
 !
loˇti⁄
)

1147 
psf
->
°rögs
 [
k
].
ty≥
)

1148 { 
SF_STR_SOFTWARE
 :

1149 
	`psf_böhódî_wrôef
 (
psf
, "ms", 
ISFT_MARKER
,Ösf->
°rögs
 [
k
].
°r
) ;

1152 
SF_STR_TITLE
 :

1153 
	`psf_böhódî_wrôef
 (
psf
, "ms", 
INAM_MARKER
,Ösf->
°rögs
 [
k
].
°r
) ;

1156 
SF_STR_COPYRIGHT
 :

1157 
	`psf_böhódî_wrôef
 (
psf
, "ms", 
ICOP_MARKER
,Ösf->
°rögs
 [
k
].
°r
) ;

1160 
SF_STR_ARTIST
 :

1161 
	`psf_böhódî_wrôef
 (
psf
, "ms", 
IART_MARKER
,Ösf->
°rögs
 [
k
].
°r
) ;

1164 
SF_STR_COMMENT
 :

1165 
	`psf_böhódî_wrôef
 (
psf
, "ms", 
ICMT_MARKER
,Ösf->
°rögs
 [
k
].
°r
) ;

1168 
SF_STR_DATE
 :

1169 
	`psf_böhódî_wrôef
 (
psf
, "ms", 
ICRD_MARKER
,Ösf->
°rögs
 [
k
].
°r
) ;

1174 
ßved_hód_ödex
 = 
psf
->
hódödex
 ;

1175 
psf
->
hódödex
 = 
¥ev_hód_ödex
 ;

1176 
	`psf_böhódî_wrôef
 (
psf
, "4", 
ßved_hód_ödex
 - 
¥ev_hód_ödex
 - 4) ;

1177 
psf
->
hódödex
 = 
ßved_hód_ödex
 ;

1179 
	}
}

1182 
	$wav_˛o£
 (
SF_PRIVATE
 *
psf
)

1184 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

1185 { 
	`wav_wrôe_èûî
 (
psf
) ;

1187 
psf
->
	`wrôe_hódî
 (psf, 
SF_TRUE
) ;

1191 
	}
}

1194 
	$wav_comm™d
 (
SF_PRIVATE
 *
psf
, 
comm™d
, *
d©a
, 
d©asize
)

1197 
psf
 =Ösf ;

1198 
d©a
 = data ;

1199 
d©asize
 = datasize ;

1201 
comm™d
)

1206 
	}
}

1209 
	$wav_subchunk_∑r£
 (
SF_PRIVATE
 *
psf
, 
chunk
)

1210 { 
sf_cou¡_t
 
cuºít_pos
 ;

1211 *
˝å
 ;

1212 
dw‹d
, 
byã§ód
, 
Àngth
 ;

1214 
cuºít_pos
 = 
	`psf_f£ek
 (
psf
, 0, 
SEEK_CUR
) ;

1216 
byã§ód
 = 
	`psf_böhódî_ªadf
 (
psf
, "4", &
Àngth
) ;

1218 i‡(
Àngth
 <= 8)

1220 
	`psf_log_¥ötf
 (
psf
, "%M : %d (weúdÜígth)\n", 
chunk
, 
Àngth
) ;

1221 
	`psf_böhódî_ªadf
 (
psf
, "mj", &
chunk
, 
Àngth
 - 4) ;

1222 
	`psf_log_¥ötf
 (
psf
, " %M\n", 
chunk
) ;

1226 i‡(
psf
->
hódödex
 + 
Àngth
 > 
	`SIGNED_SIZEOF
 (psf->
hódî
))

1227 { 
	`psf_log_¥ötf
 (
psf
, "%M : %d (toÿl⁄g)\n", 
chunk
, 
Àngth
) ;

1228 
	`psf_böhódî_ªadf
 (
psf
, "j", 
Àngth
) ;

1232 i‡(
cuºít_pos
 + 
Àngth
 > 
psf
->
fûñígth
)

1233 { 
	`psf_log_¥ötf
 (
psf
, "%M : %d (should bê%d)\n", 
chunk
, 
Àngth
, (Ë’sf->
fûñígth
 - 
cuºít_pos
)) ;

1234 
Àngth
 = 
psf
->
fûñígth
 - 
cuºít_pos
 ;

1237 
	`psf_log_¥ötf
 (
psf
, "%M : %d\n", 
chunk
, 
Àngth
) ;

1239 
byã§ód
 < 
Àngth
)

1240 { 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "m", &
chunk
) ;

1242 
chunk
)

1243 { 
adé_MARKER
 :

1244 
INFO_MARKER
 :

1246 
	`psf_log_¥ötf
 (
psf
, " %M\n", 
chunk
) ;

1249 
d©a_MARKER
:

1250 
	`psf_log_¥ötf
 (
psf
, " %M insidê®LIST block??? Backög out.\n", 
chunk
) ;

1252 
	`psf_böhódî_ªadf
 (
psf
, "j", -4) ;

1255 
ISFT_MARKER
 :

1256 
ICOP_MARKER
 :

1257 
IARL_MARKER
 :

1258 
IART_MARKER
 :

1259 
ICMT_MARKER
 :

1260 
ICRD_MARKER
 :

1261 
IENG_MARKER
 :

1263 
INAM_MARKER
 :

1264 
IPRD_MARKER
 :

1265 
ISBJ_MARKER
 :

1266 
ISRC_MARKER
 :

1267 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "4", &
dw‹d
) ;

1268 
dw‹d
 += (dword & 1) ;

1269 i‡(
dw‹d
 < 0 || dw‹d > 
	`SIGNED_SIZEOF
 (
psf
->
u
.
cbuf
))

1270 { 
	`psf_log_¥ötf
 (
psf
, " *** %M : %d (toÿbig)\n", 
chunk
, 
dw‹d
) ;

1271 
	`psf_böhódî_ªadf
 (
psf
, "j", 
dw‹d
) ;

1275 
˝å
 = 
psf
->
u
.
cbuf
 ;

1276 
	`psf_böhódî_ªadf
 (
psf
, "b", 
˝å
, 
dw‹d
) ;

1277 
byã§ód
 +
dw‹d
 ;

1278 
˝å
 [
dw‹d
 - 1] = 0 ;

1279 
	`psf_log_¥ötf
 (
psf
, " %M : %s\n", 
chunk
, 
˝å
) ;

1282 
œbl_MARKER
 :

1283 { 
m¨k_id
 ;

1285 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "44", &
dw‹d
, &
m¨k_id
) ;

1286 
dw‹d
 -= 4 ;

1287 
dw‹d
 += (dword & 1) ;

1288 i‡(
dw‹d
 < 1 || dw‹d > 
	`SIGNED_SIZEOF
 (
psf
->
u
.
cbuf
))

1289 { 
	`psf_log_¥ötf
 (
psf
, " *** %M : %d (toÿbig)\n", 
chunk
, 
dw‹d
) ;

1290 
	`psf_böhódî_ªadf
 (
psf
, "j", 
dw‹d
) ;

1294 
˝å
 = 
psf
->
u
.
cbuf
 ;

1295 
	`psf_böhódî_ªadf
 (
psf
, "b", 
˝å
, 
dw‹d
) ;

1296 
byã§ód
 +
dw‹d
 ;

1297 
˝å
 [
dw‹d
 - 1] = 0 ;

1298 
	`psf_log_¥ötf
 (
psf
, " %M : %d : %s\n", 
chunk
, 
m¨k_id
, 
˝å
) ;

1303 
DISP_MARKER
 :

1304 
…xt_MARKER
 :

1305 
nŸe_MARKER
 :

1306 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "4", &
dw‹d
) ;

1307 
dw‹d
 += (dword & 1) ;

1308 
	`psf_böhódî_ªadf
 (
psf
, "j", 
dw‹d
) ;

1309 
byã§ód
 +
dw‹d
 ;

1310 
	`psf_log_¥ötf
 (
psf
, " %M : %d\n", 
chunk
, 
dw‹d
) ;

1314 
	`psf_böhódî_ªadf
 (
psf
, "4", &
dw‹d
) ;

1315 
byã§ód
 + (
dw‹d
) ;

1316 
dw‹d
 += (dword & 1) ;

1317 
	`psf_böhódî_ªadf
 (
psf
, "j", 
dw‹d
) ;

1318 
byã§ód
 +
dw‹d
 ;

1319 
	`psf_log_¥ötf
 (
psf
, " *** %M : %d\n", 
chunk
, 
dw‹d
) ;

1320 i‡(
dw‹d
 > 
Àngth
)

1325 
chunk
)

1326 { 
ISFT_MARKER
 :

1327 
	`psf_°‹e_°rög
 (
psf
, 
SF_STR_SOFTWARE
,Ösf->
u
.
cbuf
) ;

1329 
ICOP_MARKER
 :

1330 
	`psf_°‹e_°rög
 (
psf
, 
SF_STR_COPYRIGHT
,Ösf->
u
.
cbuf
) ;

1332 
INAM_MARKER
 :

1333 
	`psf_°‹e_°rög
 (
psf
, 
SF_STR_TITLE
,Ösf->
u
.
cbuf
) ;

1335 
IART_MARKER
 :

1336 
	`psf_°‹e_°rög
 (
psf
, 
SF_STR_ARTIST
,Ösf->
u
.
cbuf
) ;

1338 
ICMT_MARKER
 :

1339 
	`psf_°‹e_°rög
 (
psf
, 
SF_STR_COMMENT
,Ösf->
u
.
cbuf
) ;

1341 
ICRD_MARKER
 :

1342 
	`psf_°‹e_°rög
 (
psf
, 
SF_STR_DATE
,Ösf->
u
.
cbuf
) ;

1347 
cuºít_pos
 = 
	`psf_f£ek
 (
psf
, 0, 
SEEK_CUR
) - current_pos ;

1349 i‡(
cuºít_pos
 - 4 !
Àngth
)

1350 
	`psf_log_¥ötf
 (
psf
, "**** Bad chunkÜígth %d sbould bê%D\n", 
Àngth
, 
cuºít_pos
 - 4) ;

1353 
	}
}

1356 
	$wav_ªad_sm∂_chunk
 (
SF_PRIVATE
 *
psf
, 
chunkÀn
)

1357 { 
byã§ód
 = 0, 
dw‹d
, 
ßm∂î_d©a
, 
lo›_cou¡
 ;

1358 
nŸe
, 
°¨t
, 
íd
, 
ty≥
 = -1, 
cou¡
 ;

1359 
j
, 
k
 ;

1361 
chunkÀn
 += (chunklen & 1) ;

1363 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "4", &
dw‹d
) ;

1364 
	`psf_log_¥ötf
 (
psf
, " M™uÁ˘uª∏: %X\n", 
dw‹d
) ;

1366 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "4", &
dw‹d
) ;

1367 
	`psf_log_¥ötf
 (
psf
, " Produ˘ : %u\n", 
dw‹d
) ;

1369 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "4", &
dw‹d
) ;

1370 
	`psf_log_¥ötf
 (
psf
, " Pîiod : %uÇ£c\n", 
dw‹d
) ;

1372 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "4", &
nŸe
) ;

1373 
	`psf_log_¥ötf
 (
psf
, " MidòNŸê : %u\n", 
nŸe
) ;

1375 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "4", &
dw‹d
) ;

1376 i‡(
dw‹d
 != 0)

1377 { 
	`LSF_SNPRINTF
 (
psf
->
u
.
cbuf
,  (psf->u.cbuf), "%f",

1378 (1.0 * 0x80000000Ë/ ((Ë
dw‹d
)) ;

1379 
	`psf_log_¥ötf
 (
psf
, " Pôch Fø˘. : %s\n",Ösf->
u
.
cbuf
) ;

1382 
	`psf_log_¥ötf
 (
psf
, " Pitch Fract. : 0\n") ;

1384 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "4", &
dw‹d
) ;

1385 
	`psf_log_¥ötf
 (
psf
, " SMPTE F‹m© : %u\n", 
dw‹d
) ;

1387 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "4", &
dw‹d
) ;

1388 
	`LSF_SNPRINTF
 (
psf
->
u
.
cbuf
,  (psf->u.cbuf), "%02d:%02d:%02d %02d",

1389 (
dw‹d
 >> 24) & 0x7F, (dword >> 16) & 0x7F, (dword >> 8) & 0x7F, dword & 0x7F) ;

1390 
	`psf_log_¥ötf
 (
psf
, " SMPTE Off£à: %s\n",Ösf->
u
.
cbuf
) ;

1392 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "4", &
lo›_cou¡
) ;

1393 
	`psf_log_¥ötf
 (
psf
, " Lo› Cou¡ : %u\n", 
lo›_cou¡
) ;

1398 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "4", &
ßm∂î_d©a
) ;

1400 i‡((
psf
->
ö°rumít
 = 
	`psf_ö°rumít_Æloc
 ()Ë=
NULL
)

1401  
SFE_MALLOC_FAILED
 ;

1403 
psf
->
ö°rumít
->
lo›_cou¡
 =Üoop_count ;

1405 
j
 = 0 ; 
lo›_cou¡
 > 0 && 
chunkÀn
 - 
byã§ód
 >= 24 ; j ++)

1406 { 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "4", &
dw‹d
) ;

1407 
	`psf_log_¥ötf
 (
psf
, " CuêID : %2u", 
dw‹d
) ;

1409 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "4", &
ty≥
) ;

1410 
	`psf_log_¥ötf
 (
psf
, " Ty≥ : %2u", 
ty≥
) ;

1412 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "4", &
°¨t
) ;

1413 
	`psf_log_¥ötf
 (
psf
, " Sèπ : %5u", 
°¨t
) ;

1415 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "4", &
íd
) ;

1416 
	`psf_log_¥ötf
 (
psf
, " End : %5u", 
íd
) ;

1418 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "4", &
dw‹d
) ;

1419 
	`psf_log_¥ötf
 (
psf
, " Fø˘i⁄ : %5u", 
dw‹d
) ;

1421 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "4", &
cou¡
) ;

1422 
	`psf_log_¥ötf
 (
psf
, " Cou¡ : %5u\n", 
cou¡
) ;

1424 i‡(
j
 < 
	`ARRAY_LEN
 (
psf
->
ö°rumít
->
lo›s
))

1425 { 
psf
->
ö°rumít
->
lo›s
 [
j
].
°¨t
 = start ;

1426 
psf
->
ö°rumít
->
lo›s
 [
j
].
íd
 =Énd ;

1427 
psf
->
ö°rumít
->
lo›s
 [
j
].
cou¡
 = count ;

1429 
ty≥
)

1431 
psf
->
ö°rumít
->
lo›s
 [
j
].
mode
 = 
SF_LOOP_FORWARD
 ;

1434 
psf
->
ö°rumít
->
lo›s
 [
j
].
mode
 = 
SF_LOOP_ALTERNATING
 ;

1437 
psf
->
ö°rumít
->
lo›s
 [
j
].
mode
 = 
SF_LOOP_BACKWARD
 ;

1440 
psf
->
ö°rumít
->
lo›s
 [
j
].
mode
 = 
SF_LOOP_NONE
 ;

1445 
lo›_cou¡
 -- ;

1448 i‡(
chunkÀn
 - 
byã§ód
 == 0)

1449 { i‡(
ßm∂î_d©a
 != 0)

1450 
	`psf_log_¥ötf
 (
psf
, " Sam∂î D©®: %u (should bê0)\n", 
ßm∂î_d©a
) ;

1452 
	`psf_log_¥ötf
 (
psf
, " Sam∂î D©®: %u\n", 
ßm∂î_d©a
) ;

1455 { i‡(
ßm∂î_d©a
 !
chunkÀn
 - 
byã§ód
)

1456 { 
	`psf_log_¥ötf
 (
psf
, " Sam∂î D©®: %u (should havêbì¿%u)\n", 
ßm∂î_d©a
, 
chunkÀn
 - 
byã§ód
) ;

1457 
ßm∂î_d©a
 = 
chunkÀn
 - 
byã§ód
 ;

1460 
	`psf_log_¥ötf
 (
psf
, " Sam∂î D©®: %u\n", 
ßm∂î_d©a
) ;

1462 
	`psf_log_¥ötf
 (
psf
, " ") ;

1463 
k
 = 0 ; k < (Ë
ßm∂î_d©a
 ; k++)

1464 { 
ch
 ;

1466 i‡(
k
 > 0 && (k % 20) == 0)

1467 
	`psf_log_¥ötf
 (
psf
, "\n ") ;

1469 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "1", &
ch
) ;

1470 
	`psf_log_¥ötf
 (
psf
, "%02X ", 
ch
 & 0xFF) ;

1473 
	`psf_log_¥ötf
 (
psf
, "\n") ;

1476 
psf
->
ö°rumít
->
ba£nŸe
 = 
nŸe
 ;

1477 
psf
->
ö°rumít
->
gaö
 = 1 ;

1478 
psf
->
ö°rumít
->
vñocôy_lo
 =Ösf->ö°rumít->
key_lo
 = 0 ;

1479 
psf
->
ö°rumít
->
vñocôy_hi
 =Ösf->ö°rumít->
key_hi
 = 127 ;

1482 
	}
}

1516 
	$wav_ªad_acid_chunk
 (
SF_PRIVATE
 *
psf
, 
chunkÀn
)

1517 { 
byã§ód
 = 0 ;

1518 
bóts
, 
Êags
 ;

1519 
roŸnŸe
, 
q1
, 
mëî_díom
, 
mëî_numî
 ;

1520 
q2
, 
ãmpo
 ;

1522 
chunkÀn
 += (chunklen & 1) ;

1524 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "422f", &
Êags
, &
roŸnŸe
, &
q1
, &
q2
) ;

1526 
	`LSF_SNPRINTF
 (
psf
->
u
.
cbuf
,  (psf->u.cbuf), "%f", 
q2
) ;

1528 
	`psf_log_¥ötf
 (
psf
, " Fœg† : 0x%04x (%s,%s,%s,%s,%s)\n", 
Êags
,

1529 (
Êags
 & 0x01) ? "OneShot" : "Loop",

1530 (
Êags
 & 0x02) ? "RootNoteValid" : "RootNoteInvalid",

1531 (
Êags
 & 0x04) ? "StretchOn" : "StretchOff",

1532 (
Êags
 & 0x08) ? "DiskBased" : "RAMBased",

1533 (
Êags
 & 0x10) ? "??On" : "??Off") ;

1535 
	`psf_log_¥ötf
 (
psf
, " RootÇote : 0x%x\n ???? : 0x%04x\n ???? : %s\n",

1536 
roŸnŸe
, 
q1
, 
psf
->
u
.
cbuf
) ;

1538 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "422f", &
bóts
, &
mëî_díom
, &
mëî_numî
, &
ãmpo
) ;

1539 
	`LSF_SNPRINTF
 (
psf
->
u
.
cbuf
,  (psf->u.cbuf), "%f", 
ãmpo
) ;

1540 
	`psf_log_¥ötf
 (
psf
, " Beats : %d\n Meter : %d/%d\n Tempo : %s\n",

1541 
bóts
, 
mëî_numî
, 
mëî_díom
, 
psf
->
u
.
cbuf
) ;

1543 
	`psf_böhódî_ªadf
 (
psf
, "j", 
chunkÀn
 - 
byã§ód
) ;

1545 i‡((
psf
->
lo›_öfo
 = 
	`ˇŒoc
 (1,  (
SF_LOOP_INFO
))Ë=
NULL
)

1546  
SFE_MALLOC_FAILED
 ;

1548 
psf
->
lo›_öfo
->
time_sig_num
 = 
mëî_numî
 ;

1549 
psf
->
lo›_öfo
->
time_sig_dí
 = 
mëî_díom
 ;

1550 
psf
->
lo›_öfo
->
lo›_mode
 = (
Êags
 & 0x01Ë? 
SF_LOOP_NONE
 : 
SF_LOOP_FORWARD
 ;

1551 
psf
->
lo›_öfo
->
num_bóts
 = 
bóts
 ;

1552 
psf
->
lo›_öfo
->
bpm
 = 
ãmpo
 ;

1553 
psf
->
lo›_öfo
->
roŸ_key
 = (
Êags
 & 0x02Ë? 
roŸnŸe
 : -1 ;

1556 
	}
}

1559 
	$wav_ªad_bext_chunk
 (
SF_PRIVATE
 *
psf
, 
chunksize
)

1561 
SF_BROADCAST_INFO
* 
b
 ;

1563 i‡((
psf
->
brﬂdˇ°_öfo
 = 
	`ˇŒoc
 (1,  (
SF_BROADCAST_INFO
))Ë=
NULL
)

1564 { 
psf
->
îr‹
 = 
SFE_MALLOC_FAILED
 ;

1568 
b
 = 
psf
->
brﬂdˇ°_öfo
 ;

1570 
	`psf_böhódî_ªadf
 (
psf
, "b", 
b
->
des¸ùti⁄
,  (b->description)) ;

1571 
	`psf_böhódî_ªadf
 (
psf
, "b", 
b
->
‹igö©‹
,  (b->originator)) ;

1572 
	`psf_böhódî_ªadf
 (
psf
, "b", 
b
->
‹igö©‹_ª„ªn˚
,  (b->originator_reference)) ;

1573 
	`psf_böhódî_ªadf
 (
psf
, "b", 
b
->
‹igö©i⁄_d©e
,  (b->origination_date)) ;

1574 
	`psf_böhódî_ªadf
 (
psf
, "b", 
b
->
‹igö©i⁄_time
,  (b->origination_time)) ;

1575 
	`psf_böhódî_ªadf
 (
psf
, "442", &
b
->
time_ª„ªn˚_low
, &b->
time_ª„ªn˚_high
, &b->
vîsi⁄
) ;

1576 
	`psf_böhódî_ªadf
 (
psf
, "bj", &
b
->
umid
,  (b->umid), 190) ;

1578 i‡(
chunksize
 > 
WAV_BEXT_CHUNK_SIZE
)

1581 
b
->
codög_hi°‹y_size
 = 
chunksize
 - 
WAV_BEXT_CHUNK_SIZE
 ;

1583 i‡(
b
->
codög_hi°‹y_size
 > 
	`SIGNED_SIZEOF
 (b->
codög_hi°‹y
))

1584 { 
	`‰ì
 (
psf
->
brﬂdˇ°_öfo
) ;

1585 
psf
->
brﬂdˇ°_öfo
 = 
NULL
 ;

1586 
psf
->
îr‹
 = 
SFE_MALLOC_FAILED
 ;

1591 
	`psf_böhódî_ªadf
 (
psf
, "b", 
b
->
codög_hi°‹y
, b->
codög_hi°‹y_size
) ;

1592 
b
->
codög_hi°‹y
 [ (b->coding_history) - 1] = 0 ;

1596 
	}
}

1599 
	$wav_wrôe_bext_chunk
 (
SF_PRIVATE
 *
psf
)

1600 { 
SF_BROADCAST_INFO
 *
b
 ;

1602 i‡((
b
 = 
psf
->
brﬂdˇ°_öfo
Ë=
NULL
)

1605 
	`psf_böhódî_wrôef
 (
psf
, "m4", 
bext_MARKER
, 
WAV_BEXT_CHUNK_SIZE
 + 
b
->
codög_hi°‹y_size
) ;

1612 
	`psf_böhódî_wrôef
 (
psf
, "b", 
b
->
des¸ùti⁄
,  (b->description)) ;

1613 
	`psf_böhódî_wrôef
 (
psf
, "b", 
b
->
‹igö©‹
,  (b->originator)) ;

1614 
	`psf_böhódî_wrôef
 (
psf
, "b", 
b
->
‹igö©‹_ª„ªn˚
,  (b->originator_reference)) ;

1615 
	`psf_böhódî_wrôef
 (
psf
, "b", 
b
->
‹igö©i⁄_d©e
,  (b->origination_date)) ;

1616 
	`psf_böhódî_wrôef
 (
psf
, "b", 
b
->
‹igö©i⁄_time
,  (b->origination_time)) ;

1617 
	`psf_böhódî_wrôef
 (
psf
, "442", 
b
->
time_ª„ªn˚_low
, b->
time_ª„ªn˚_high
, b->
vîsi⁄
) ;

1618 
	`psf_böhódî_wrôef
 (
psf
, "b", 
b
->
umid
,  (b->umid)) ;

1619 
	`psf_böhódî_wrôef
 (
psf
, "z", 
	`make_size_t
 (190)) ;

1621 i‡(
b
->
codög_hi°‹y_size
 > 0)

1622 
	`psf_böhódî_wrôef
 (
psf
, "b", 
b
->
codög_hi°‹y
, 
	`make_size_t
 (b->
codög_hi°‹y_size
)) ;

1625 
	}
}

	@libsndfile-1.0.17/src/wav_w64.c

20 
	~"sfc⁄fig.h
"

22 
	~<°dio.h
>

23 
	~<°rög.h
>

24 
	~<˘y≥.h
>

25 
	~<time.h
>

27 
	~"¢dfûe.h
"

28 
	~"s„ndün.h
"

29 
	~"comm⁄.h
"

30 
	~"wav_w64.h
"

33 c⁄° 
EXT_SUBFORMAT
 
	gMSGUID_SUBTYPE_PCM
 =

37 c⁄° 
EXT_SUBFORMAT
 
	gMSGUID_SUBTYPE_MS_ADPCM
 =

41 c⁄° 
EXT_SUBFORMAT
 
	gMSGUID_SUBTYPE_IEEE_FLOAT
 =

45 c⁄° 
EXT_SUBFORMAT
 
	gMSGUID_SUBTYPE_ALAW
 =

49 c⁄° 
EXT_SUBFORMAT
 
	gMSGUID_SUBTYPE_MULAW
 =

58 c⁄° 
EXT_SUBFORMAT
 
	gMSGUID_SUBTYPE_AMBISONIC_B_FORMAT_PCM
 =

62 c⁄° 
EXT_SUBFORMAT
 
	gMSGUID_SUBTYPE_AMBISONIC_B_FORMAT_IEEE_FLOAT
 =

70 c⁄° 
EXT_SUBFORMAT
 
	gMSGUID_SUBTYPE_PVOCEX
 =

80 
	$wavex_wrôe_guid_equÆ
 (c⁄° 
EXT_SUBFORMAT
 * 
fú°
, c⁄° EXT_SUBFORMAT * 
£c⁄d
)

81 {  !
	`memcmp
 (
fú°
, 
£c⁄d
,  (
EXT_SUBFORMAT
)) ;

82 
	}
}

87 
	$wav_w64_ªad_fmt_chunk
 (
SF_PRIVATE
 *
psf
, 
WAV_FMT
 *
wav_fmt
, 
°ru˘size
)

88 { 
byã§ód
, 
k
, 
byã•î£c
 = 0 ;

90 
	`mem£t
 (
wav_fmt
, 0,  (
WAV_FMT
)) ;

92 i‡(
°ru˘size
 < 16)

93  
SFE_WAV_FMT_SHORT
 ;

98 
byã§ód
 = 
	`psf_böhódî_ªadf
 (
psf
, "224422",

99 &(
wav_fmt
->
f‹m©
), &(wav_fmt->
mö
.
ch™√ls
),

100 &(
wav_fmt
->
mö
.
ßm∂î©e
), &(wav_fmt->mö.
byã•î£c
),

101 &(
wav_fmt
->
mö
.
blockÆign
), &(wav_fmt->mö.
bôwidth
)) ;

103 
	`psf_log_¥ötf
 (
psf
, " F‹m© : 0x%X => %s\n", 
wav_fmt
->
f‹m©
, 
	`wav_w64_f‹m©_°r
 (wav_fmt->format)) ;

104 
	`psf_log_¥ötf
 (
psf
, " Ch™√l† : %d\n", 
wav_fmt
->
mö
.
ch™√ls
) ;

105 
	`psf_log_¥ötf
 (
psf
, " Sam∂êR©ê : %d\n", 
wav_fmt
->
mö
.
ßm∂î©e
) ;

106 
	`psf_log_¥ötf
 (
psf
, " Block Alig¿ : %d\n", 
wav_fmt
->
mö
.
blockÆign
) ;

108 i‡(
wav_fmt
->
f‹m©
 =
WAVE_FORMAT_PCM
 && wav_fmt->
mö
.
bôwidth
 == 24 &&

109 
wav_fmt
->
mö
.
blockÆign
 =4 * wav_fmt->mö.
ch™√ls
)

111 
	`psf_log_¥ötf
 (
psf
, "\nInvalid file generated by Syntrillium's Cooledit!\n"

113 
	`psf_log_¥ötf
 (
psf
, " Bit Width : 24 (should be 32)\n") ;

114 
wav_fmt
->
mö
.
bôwidth
 = 32 ;

115 
wav_fmt
->
f‹m©
 = 
WAVE_FORMAT_IEEE_FLOAT
 ;

117 i‡(
wav_fmt
->
mö
.
bôwidth
 == 0)

118 { 
wav_fmt
->
f‹m©
)

119 { 
WAVE_FORMAT_GSM610
 :

120 
WAVE_FORMAT_IPP_ITU_G_723_1
 :

121 
	`psf_log_¥ötf
 (
psf
, " Bô Width : %d\n", 
wav_fmt
->
mö
.
bôwidth
) ;

124 
	`psf_log_¥ötf
 (
psf
, " Bô Width : %d (shouldÇŸ bê0)\n", 
wav_fmt
->
mö
.
bôwidth
) ;

128 { 
wav_fmt
->
f‹m©
)

129 { 
WAVE_FORMAT_GSM610
 :

130 
WAVE_FORMAT_IPP_ITU_G_723_1
 :

131 
	`psf_log_¥ötf
 (
psf
, " Bô Width : %d (should bê0)\n", 
wav_fmt
->
mö
.
bôwidth
) ;

134 
	`psf_log_¥ötf
 (
psf
, " Bô Width : %d\n", 
wav_fmt
->
mö
.
bôwidth
) ;

138 
psf
->
sf
.
ßm∂î©e
 = 
wav_fmt
->
mö
.samplerate ;

139 
psf
->
sf
.
‰ames
 = 0 ;

140 
psf
->
sf
.
ch™√ls
 = 
wav_fmt
->
mö
.channels ;

142 
wav_fmt
->
f‹m©
)

143 { 
WAVE_FORMAT_PCM
 :

144 
WAVE_FORMAT_IEEE_FLOAT
 :

145 
byã•î£c
 = 
wav_fmt
->
mö
.
ßm∂î©e
 * wav_fmt->mö.
blockÆign
 ;

146 i‡(
wav_fmt
->
mö
.
byã•î£c
 != () bytespersec)

147 
	`psf_log_¥ötf
 (
psf
, " Byãs/£¯ : %d (should bê%d)\n", 
wav_fmt
->
mö
.
byã•î£c
, bytespersec) ;

149 
	`psf_log_¥ötf
 (
psf
, " Byãs/£¯ : %d\n", 
wav_fmt
->
mö
.
byã•î£c
) ;

151 
psf
->
byãwidth
 = 
	`BITWIDTH2BYTES
 (
wav_fmt
->
mö
.
bôwidth
) ;

154 
WAVE_FORMAT_ALAW
 :

155 
WAVE_FORMAT_MULAW
 :

156 i‡(
wav_fmt
->
mö
.
byã•î£c
 / wav_fmt->mö.
blockÆign
 !wav_fmt->mö.
ßm∂î©e
)

157 
	`psf_log_¥ötf
 (
psf
, " Byãs/£¯ : %d (should bê%d)\n", 
wav_fmt
->
mö
.
byã•î£c
, wav_fmt->mö.
ßm∂î©e
 * wav_fmt->mö.
blockÆign
) ;

159 
	`psf_log_¥ötf
 (
psf
, " Byãs/£¯ : %d\n", 
wav_fmt
->
mö
.
byã•î£c
) ;

161 
psf
->
byãwidth
 = 1 ;

162 i‡(
°ru˘size
 >= 18)

163 { 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "2", &(
wav_fmt
->
size20
.
exåabyãs
)) ;

164 
	`psf_log_¥ötf
 (
psf
, " Exå®Byã† : %d\n", 
wav_fmt
->
size20
.
exåabyãs
) ;

168 
WAVE_FORMAT_IMA_ADPCM
 :

169 i‡(
wav_fmt
->
mö
.
bôwidth
 != 4)

170  
SFE_WAV_ADPCM_NOT4BIT
 ;

171 i‡(
wav_fmt
->
mö
.
ch™√ls
 < 1 || wav_fmt->min.channels > 2)

172  
SFE_WAV_ADPCM_CHANNELS
 ;

174 
byã§ód
 +=

175 
	`psf_böhódî_ªadf
 (
psf
, "22", &(
wav_fmt
->
ima
.
exåabyãs
), &(wav_fmt->ima.
ßm∂e•îblock
)) ;

177 
byã•î£c
 = (
wav_fmt
->
ima
.
ßm∂î©e
 * wav_fmt->ima.
blockÆign
Ë/ wav_fmt->ima.
ßm∂e•îblock
 ;

178 i‡(
wav_fmt
->
ima
.
byã•î£c
 != () bytespersec)

179 
	`psf_log_¥ötf
 (
psf
, " Byãs/£¯ : %d (should bê%d)\n", 
wav_fmt
->
ima
.
byã•î£c
, bytespersec) ;

181 
	`psf_log_¥ötf
 (
psf
, " Byãs/£¯ : %d\n", 
wav_fmt
->
ima
.
byã•î£c
) ;

183 
psf
->
byãwidth
 = 2 ;

184 
	`psf_log_¥ötf
 (
psf
, " Exå®Byã† : %d\n", 
wav_fmt
->
ima
.
exåabyãs
) ;

185 
	`psf_log_¥ötf
 (
psf
, " Sam∂es/Block : %d\n", 
wav_fmt
->
ima
.
ßm∂e•îblock
) ;

188 
WAVE_FORMAT_MS_ADPCM
 :

189 i‡(
wav_fmt
->
mßdpcm
.
bôwidth
 != 4)

190  
SFE_WAV_ADPCM_NOT4BIT
 ;

191 i‡(
wav_fmt
->
mßdpcm
.
ch™√ls
 < 1 || wav_fmt->msadpcm.channels > 2)

192  
SFE_WAV_ADPCM_CHANNELS
 ;

194 
byã§ód
 +=

195 
	`psf_böhódî_ªadf
 (
psf
, "222", &(
wav_fmt
->
mßdpcm
.
exåabyãs
),

196 &(
wav_fmt
->
mßdpcm
.
ßm∂e•îblock
), &(wav_fmt->mßdpcm.
numc€ffs
)) ;

198 
byã•î£c
 = (
wav_fmt
->
mö
.
ßm∂î©e
 * wav_fmt->mö.
blockÆign
Ë/ wav_fmt->
mßdpcm
.
ßm∂e•îblock
 ;

199 i‡(
wav_fmt
->
mö
.
byã•î£c
 == () bytespersec)

200 
	`psf_log_¥ötf
 (
psf
, " Byãs/£¯ : %d\n", 
wav_fmt
->
mö
.
byã•î£c
) ;

201 i‡(
wav_fmt
->
mö
.
byã•î£c
 =(wav_fmt->mö.
ßm∂î©e
 / wav_fmt->
mßdpcm
.
ßm∂e•îblock
Ë* wav_fmt->mö.
blockÆign
)

202 
	`psf_log_¥ötf
 (
psf
, " Byãs/£¯ : %d (should bê%d (MS BUG!))\n", 
wav_fmt
->
mö
.
byã•î£c
, bytespersec) ;

204 
	`psf_log_¥ötf
 (
psf
, " Byãs/£¯ : %d (should bê%d)\n", 
wav_fmt
->
mö
.
byã•î£c
, bytespersec) ;

207 
psf
->
byãwidth
 = 2 ;

208 
	`psf_log_¥ötf
 (
psf
, " Exå®Byã† : %d\n", 
wav_fmt
->
mßdpcm
.
exåabyãs
) ;

209 
	`psf_log_¥ötf
 (
psf
, " Sam∂es/Block : %d\n", 
wav_fmt
->
mßdpcm
.
ßm∂e•îblock
) ;

210 i‡(
wav_fmt
->
mßdpcm
.
numc€ffs
 > 
	`SIGNED_SIZEOF
 (
MS_ADPCM_WAV_FMT
) / SIGNED_SIZEOF ())

211 { 
	`psf_log_¥ötf
 (
psf
, " No. o‡C€ff†: %d ****\n", 
wav_fmt
->
mßdpcm
.
numc€ffs
) ;

212 
wav_fmt
->
mßdpcm
.
numc€ffs
 = 
	`SIGNED_SIZEOF
 (
MS_ADPCM_WAV_FMT
) / SIGNED_SIZEOF () ;

215 
	`psf_log_¥ötf
 (
psf
, " No. o‡C€ff†: %d\n", 
wav_fmt
->
mßdpcm
.
numc€ffs
) ;

217 
	`psf_log_¥ötf
 (
psf
, " Index Coeffs1 Coeffs2\n") ;

218 
k
 = 0 ; k < 
wav_fmt
->
mßdpcm
.
numc€ffs
 ; k++)

219 { 
byã§ód
 +=

220 
	`psf_böhódî_ªadf
 (
psf
, "22", &(
wav_fmt
->
mßdpcm
.
c€ffs
 [
k
].
c€ff1
), &(wav_fmt->mßdpcm.c€ff†[k].
c€ff2
)) ;

221 
	`LSF_SNPRINTF
 (
psf
->
u
.
cbuf
,  (psf->u.cbuf), " %2d %7d %7d\n", 
k
, 
wav_fmt
->
mßdpcm
.
c€ffs
 [k].
c€ff1
, wav_fmt->mßdpcm.c€ff†[k].
c€ff2
) ;

222 
	`psf_log_¥ötf
 (
psf
,Ösf->
u
.
cbuf
) ;

226 
WAVE_FORMAT_GSM610
 :

227 i‡(
wav_fmt
->
gsm610
.
ch™√ls
 !1 || wav_fmt->gsm610.
blockÆign
 != 65)

228  
SFE_WAV_GSM610_FORMAT
 ;

230 
byã§ód
 +=

231 
	`psf_böhódî_ªadf
 (
psf
, "22", &(
wav_fmt
->
gsm610
.
exåabyãs
), &(wav_fmt->gsm610.
ßm∂e•îblock
)) ;

233 i‡(
wav_fmt
->
gsm610
.
ßm∂e•îblock
 != 320)

234  
SFE_WAV_GSM610_FORMAT
 ;

236 
byã•î£c
 = (
wav_fmt
->
gsm610
.
ßm∂î©e
 * wav_fmt->gsm610.
blockÆign
Ë/ wav_fmt->gsm610.
ßm∂e•îblock
 ;

237 i‡(
wav_fmt
->
gsm610
.
byã•î£c
 != () bytespersec)

238 
	`psf_log_¥ötf
 (
psf
, " Byãs/£¯ : %d (should bê%d)\n", 
wav_fmt
->
gsm610
.
byã•î£c
, bytespersec) ;

240 
	`psf_log_¥ötf
 (
psf
, " Byãs/£¯ : %d\n", 
wav_fmt
->
gsm610
.
byã•î£c
) ;

242 
psf
->
byãwidth
 = 2 ;

243 
	`psf_log_¥ötf
 (
psf
, " Exå®Byã† : %d\n", 
wav_fmt
->
gsm610
.
exåabyãs
) ;

244 
	`psf_log_¥ötf
 (
psf
, " Sam∂es/Block : %d\n", 
wav_fmt
->
gsm610
.
ßm∂e•îblock
) ;

247 
WAVE_FORMAT_EXTENSIBLE
 :

248 i‡(
wav_fmt
->
ext
.
byã•î£c
 / wav_fmt->ext.
blockÆign
 !wav_fmt->ext.
ßm∂î©e
)

249 
	`psf_log_¥ötf
 (
psf
, " Byãs/£¯ : %d (should bê%d)\n", 
wav_fmt
->
ext
.
byã•î£c
, wav_fmt->ext.
ßm∂î©e
 * wav_fmt->ext.
blockÆign
) ;

251 
	`psf_log_¥ötf
 (
psf
, " Byãs/£¯ : %d\n", 
wav_fmt
->
ext
.
byã•î£c
) ;

253 
byã§ód
 +=

254 
	`psf_böhódî_ªadf
 (
psf
, "224", &(
wav_fmt
->
ext
.
exåabyãs
), &(wav_fmt->ext.
vÆidbôs
),

255 &(
wav_fmt
->
ext
.
ch™√lmask
)) ;

257 
	`psf_log_¥ötf
 (
psf
, " VÆid Bô† : %d\n", 
wav_fmt
->
ext
.
vÆidbôs
) ;

258 
	`psf_log_¥ötf
 (
psf
, " Ch™√»Mask : 0x%X\n", 
wav_fmt
->
ext
.
ch™√lmask
) ;

260 
byã§ód
 +=

261 
	`psf_böhódî_ªadf
 (
psf
, "422", &(
wav_fmt
->
ext
.
esf
.
esf_fõld1
), &(wav_fmt->ext.esf.
esf_fõld2
),

262 &(
wav_fmt
->
ext
.
esf
.
esf_fõld3
)) ;

265 
	`psf_log_¥ötf
 (
psf
, " Subformat\n") ;

266 
	`psf_log_¥ötf
 (
psf
, "Ésf_fõld1 : 0x%X\n", 
wav_fmt
->
ext
.
esf
.
esf_fõld1
) ;

267 
	`psf_log_¥ötf
 (
psf
, "Ésf_fõld2 : 0x%X\n", 
wav_fmt
->
ext
.
esf
.
esf_fõld2
) ;

268 
	`psf_log_¥ötf
 (
psf
, "Ésf_fõld3 : 0x%X\n", 
wav_fmt
->
ext
.
esf
.
esf_fõld3
) ;

269 
	`psf_log_¥ötf
 (
psf
, "Ésf_field4 : ") ;

270 
k
 = 0 ; k < 8 ; k++)

271 { 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "1", &(
wav_fmt
->
ext
.
esf
.
esf_fõld4
 [
k
])) ;

272 
	`psf_log_¥ötf
 (
psf
, "0x%X ", 
wav_fmt
->
ext
.
esf
.
esf_fõld4
 [
k
] & 0xFF) ;

274 
	`psf_log_¥ötf
 (
psf
, "\n") ;

275 
psf
->
byãwidth
 = 
	`BITWIDTH2BYTES
 (
wav_fmt
->
ext
.
bôwidth
) ;

278 i‡(
	`wavex_wrôe_guid_equÆ
 (&
wav_fmt
->
ext
.
esf
, &
MSGUID_SUBTYPE_PCM
)

279 || 
	`wavex_wrôe_guid_equÆ
 (&
wav_fmt
->
ext
.
esf
, &
MSGUID_SUBTYPE_AMBISONIC_B_FORMAT_PCM
))

280 { 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_WAVEX
 | 
	`u_bôwidth_to_subf‹m©
 (psf->
byãwidth
 * 8) ;

281 
	`psf_log_¥ötf
 (
psf
, " format :Öcm\n") ;

283 i‡(
	`wavex_wrôe_guid_equÆ
 (&
wav_fmt
->
ext
.
esf
, &
MSGUID_SUBTYPE_MS_ADPCM
))

284 { 
psf
->
sf
.
f‹m©
 = (
SF_FORMAT_WAVEX
 | 
SF_FORMAT_MS_ADPCM
) ;

285 
	`psf_log_¥ötf
 (
psf
, " format : msádpcm\n") ;

287 i‡(
	`wavex_wrôe_guid_equÆ
 (&
wav_fmt
->
ext
.
esf
, &
MSGUID_SUBTYPE_IEEE_FLOAT
)

288 || 
	`wavex_wrôe_guid_equÆ
 (&
wav_fmt
->
ext
.
esf
, &
MSGUID_SUBTYPE_AMBISONIC_B_FORMAT_PCM
))

289 { 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_WAVEX
 | (’sf->
byãwidth
 =8Ë? 
SF_FORMAT_DOUBLE
 : 
SF_FORMAT_FLOAT
) ;

290 
	`psf_log_¥ötf
 (
psf
, " format : IEEE float\n") ;

292 i‡(
	`wavex_wrôe_guid_equÆ
 (&
wav_fmt
->
ext
.
esf
, &
MSGUID_SUBTYPE_ALAW
))

293 { 
psf
->
sf
.
f‹m©
 = (
SF_FORMAT_WAVEX
 | 
SF_FORMAT_ALAW
) ;

294 
	`psf_log_¥ötf
 (
psf
, " format : A-law\n") ;

296 i‡(
	`wavex_wrôe_guid_equÆ
 (&
wav_fmt
->
ext
.
esf
, &
MSGUID_SUBTYPE_MULAW
))

297 { 
psf
->
sf
.
f‹m©
 = (
SF_FORMAT_WAVEX
 | 
SF_FORMAT_ULAW
) ;

298 
	`psf_log_¥ötf
 (
psf
, " format : u-law\n") ;

301  
SFE_UNIMPLEMENTED
 ;

304 
WAVE_FORMAT_G721_ADPCM
 :

305 
	`psf_log_¥ötf
 (
psf
, " Byãs/£¯ : %d\n", 
wav_fmt
->
g72x
.
byã•î£c
) ;

306 i‡(
°ru˘size
 >= 20)

307 { 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "22", &(
wav_fmt
->
g72x
.
exåabyãs
), &(wav_fmt->g72x.
auxblocksize
)) ;

308 i‡(
wav_fmt
->
g72x
.
exåabyãs
 == 0)

309 
	`psf_log_¥ötf
 (
psf
, " Exå®Byã† : %d (should bê2)\n", 
wav_fmt
->
g72x
.
exåabyãs
) ;

311 
	`psf_log_¥ötf
 (
psf
, " Exå®Byã† : %d\n", 
wav_fmt
->
g72x
.
exåabyãs
) ;

312 
	`psf_log_¥ötf
 (
psf
, " Aux Blk Sizê : %d\n", 
wav_fmt
->
g72x
.
auxblocksize
) ;

314 i‡(
°ru˘size
 == 18)

315 { 
byã§ód
 +
	`psf_böhódî_ªadf
 (
psf
, "2", &(
wav_fmt
->
g72x
.
exåabyãs
)) ;

316 
	`psf_log_¥ötf
 (
psf
, " Exå®Byã† : %d%s\n", 
wav_fmt
->
g72x
.
exåabyãs
, wav_fmt->g72x.extrabytes != 0 ? " (should be 0)" : "") ;

319 
	`psf_log_¥ötf
 (
psf
, "*** 'fmt ' chunk should be biggerÅhanÅhis!\n") ;

323 
	`psf_log_¥ötf
 (
psf
, "*** No 'fmt ' chunk dumper forÅhis format!\n") ;

327 i‡(
byã§ód
 > 
°ru˘size
)

328 { 
	`psf_log_¥ötf
 (
psf
, "*** wav_w64_read_fmt_chunk (bytesread > structsize)\n") ;

329  
SFE_W64_FMT_SHORT
 ;

332 
	`psf_böhódî_ªadf
 (
psf
, "j", 
°ru˘size
 - 
byã§ód
) ;

334 
psf
->
blockwidth
 = 
wav_fmt
->
mö
.
ch™√ls
 *Ösf->
byãwidth
 ;

337 
	}
}

340 
	$wavex_wrôe_guid
 (
SF_PRIVATE
 *
psf
, c⁄° 
EXT_SUBFORMAT
 * 
subf‹m©
)

342 
	`psf_böhódî_wrôef
 (
psf
, "422b", 
subf‹m©
->
esf_fõld1
,

343 
subf‹m©
->
esf_fõld2
, subf‹m©->
esf_fõld3
,

344 
subf‹m©
->
esf_fõld4
, 
	`make_size_t
 (8)) ;

345 
	}
}

352 { 
	mID
 ;

353 c⁄° *
	m«me
 ;

354 } 
	tWAV_FORMAT_DESC
 ;

356 
	#STR
(
x
Ë#x

	)

357 
	#FORMAT_TYPE
(
x
Ë{ x, 
	`STR
 (xË}

	)

359 
WAV_FORMAT_DESC
 
	gwave_descs
 [] =

360 { 
FORMAT_TYPE
 (
WAVE_FORMAT_PCM
),

361 
FORMAT_TYPE
 (
WAVE_FORMAT_MS_ADPCM
),

362 
FORMAT_TYPE
 (
WAVE_FORMAT_IEEE_FLOAT
),

363 
FORMAT_TYPE
 (
WAVE_FORMAT_VSELP
),

364 
FORMAT_TYPE
 (
WAVE_FORMAT_IBM_CVSD
),

365 
FORMAT_TYPE
 (
WAVE_FORMAT_ALAW
),

366 
FORMAT_TYPE
 (
WAVE_FORMAT_MULAW
),

367 
FORMAT_TYPE
 (
WAVE_FORMAT_OKI_ADPCM
),

368 
FORMAT_TYPE
 (
WAVE_FORMAT_IMA_ADPCM
),

369 
FORMAT_TYPE
 (
WAVE_FORMAT_MEDIASPACE_ADPCM
),

370 
FORMAT_TYPE
 (
WAVE_FORMAT_SIERRA_ADPCM
),

371 
FORMAT_TYPE
 (
WAVE_FORMAT_G723_ADPCM
),

372 
FORMAT_TYPE
 (
WAVE_FORMAT_DIGISTD
),

373 
FORMAT_TYPE
 (
WAVE_FORMAT_DIGIFIX
),

374 
FORMAT_TYPE
 (
WAVE_FORMAT_DIALOGIC_OKI_ADPCM
),

375 
FORMAT_TYPE
 (
WAVE_FORMAT_MEDIAVISION_ADPCM
),

376 
FORMAT_TYPE
 (
WAVE_FORMAT_CU_CODEC
),

377 
FORMAT_TYPE
 (
WAVE_FORMAT_YAMAHA_ADPCM
),

378 
FORMAT_TYPE
 (
WAVE_FORMAT_SONARC
),

379 
FORMAT_TYPE
 (
WAVE_FORMAT_DSPGROUP_TRUESPEECH
),

380 
FORMAT_TYPE
 (
WAVE_FORMAT_ECHOSC1
),

381 
FORMAT_TYPE
 (
WAVE_FORMAT_AUDIOFILE_AF36
),

382 
FORMAT_TYPE
 (
WAVE_FORMAT_APTX
),

383 
FORMAT_TYPE
 (
WAVE_FORMAT_AUDIOFILE_AF10
),

384 
FORMAT_TYPE
 (
WAVE_FORMAT_PROSODY_1612
),

385 
FORMAT_TYPE
 (
WAVE_FORMAT_LRC
),

386 
FORMAT_TYPE
 (
WAVE_FORMAT_DOLBY_AC2
),

387 
FORMAT_TYPE
 (
WAVE_FORMAT_GSM610
),

388 
FORMAT_TYPE
 (
WAVE_FORMAT_MSNAUDIO
),

389 
FORMAT_TYPE
 (
WAVE_FORMAT_ANTEX_ADPCME
),

390 
FORMAT_TYPE
 (
WAVE_FORMAT_CONTROL_RES_VQLPC
),

391 
FORMAT_TYPE
 (
WAVE_FORMAT_DIGIREAL
),

392 
FORMAT_TYPE
 (
WAVE_FORMAT_DIGIADPCM
),

393 
FORMAT_TYPE
 (
WAVE_FORMAT_CONTROL_RES_CR10
),

394 
FORMAT_TYPE
 (
WAVE_FORMAT_NMS_VBXADPCM
),

395 
FORMAT_TYPE
 (
WAVE_FORMAT_ROLAND_RDAC
),

396 
FORMAT_TYPE
 (
WAVE_FORMAT_ECHOSC3
),

397 
FORMAT_TYPE
 (
WAVE_FORMAT_ROCKWELL_ADPCM
),

398 
FORMAT_TYPE
 (
WAVE_FORMAT_ROCKWELL_DIGITALK
),

399 
FORMAT_TYPE
 (
WAVE_FORMAT_XEBEC
),

400 
FORMAT_TYPE
 (
WAVE_FORMAT_G721_ADPCM
),

401 
FORMAT_TYPE
 (
WAVE_FORMAT_G728_CELP
),

402 
FORMAT_TYPE
 (
WAVE_FORMAT_MSG723
),

403 
FORMAT_TYPE
 (
WAVE_FORMAT_MPEG
),

404 
FORMAT_TYPE
 (
WAVE_FORMAT_RT24
),

405 
FORMAT_TYPE
 (
WAVE_FORMAT_PAC
),

406 
FORMAT_TYPE
 (
WAVE_FORMAT_MPEGLAYER3
),

407 
FORMAT_TYPE
 (
WAVE_FORMAT_LUCENT_G723
),

408 
FORMAT_TYPE
 (
WAVE_FORMAT_CIRRUS
),

409 
FORMAT_TYPE
 (
WAVE_FORMAT_ESPCM
),

410 
FORMAT_TYPE
 (
WAVE_FORMAT_VOXWARE
),

411 
FORMAT_TYPE
 (
WAVE_FORMAT_CANOPUS_ATRAC
),

412 
FORMAT_TYPE
 (
WAVE_FORMAT_G726_ADPCM
),

413 
FORMAT_TYPE
 (
WAVE_FORMAT_G722_ADPCM
),

414 
FORMAT_TYPE
 (
WAVE_FORMAT_DSAT
),

415 
FORMAT_TYPE
 (
WAVE_FORMAT_DSAT_DISPLAY
),

416 
FORMAT_TYPE
 (
WAVE_FORMAT_VOXWARE_BYTE_ALIGNED
),

417 
FORMAT_TYPE
 (
WAVE_FORMAT_VOXWARE_AC8
),

418 
FORMAT_TYPE
 (
WAVE_FORMAT_VOXWARE_AC10
),

419 
FORMAT_TYPE
 (
WAVE_FORMAT_VOXWARE_AC16
),

420 
FORMAT_TYPE
 (
WAVE_FORMAT_VOXWARE_AC20
),

421 
FORMAT_TYPE
 (
WAVE_FORMAT_VOXWARE_RT24
),

422 
FORMAT_TYPE
 (
WAVE_FORMAT_VOXWARE_RT29
),

423 
FORMAT_TYPE
 (
WAVE_FORMAT_VOXWARE_RT29HW
),

424 
FORMAT_TYPE
 (
WAVE_FORMAT_VOXWARE_VR12
),

425 
FORMAT_TYPE
 (
WAVE_FORMAT_VOXWARE_VR18
),

426 
FORMAT_TYPE
 (
WAVE_FORMAT_VOXWARE_TQ40
),

427 
FORMAT_TYPE
 (
WAVE_FORMAT_SOFTSOUND
),

428 
FORMAT_TYPE
 (
WAVE_FORMAT_VOXARE_TQ60
),

429 
FORMAT_TYPE
 (
WAVE_FORMAT_MSRT24
),

430 
FORMAT_TYPE
 (
WAVE_FORMAT_G729A
),

431 
FORMAT_TYPE
 (
WAVE_FORMAT_MVI_MV12
),

432 
FORMAT_TYPE
 (
WAVE_FORMAT_DF_G726
),

433 
FORMAT_TYPE
 (
WAVE_FORMAT_DF_GSM610
),

434 
FORMAT_TYPE
 (
WAVE_FORMAT_ONLIVE
),

435 
FORMAT_TYPE
 (
WAVE_FORMAT_SBC24
),

436 
FORMAT_TYPE
 (
WAVE_FORMAT_DOLBY_AC3_SPDIF
),

437 
FORMAT_TYPE
 (
WAVE_FORMAT_ZYXEL_ADPCM
),

438 
FORMAT_TYPE
 (
WAVE_FORMAT_PHILIPS_LPCBB
),

439 
FORMAT_TYPE
 (
WAVE_FORMAT_PACKED
),

440 
FORMAT_TYPE
 (
WAVE_FORMAT_RHETOREX_ADPCM
),

441 
FORMAT_TYPE
 (
IBM_FORMAT_MULAW
),

442 
FORMAT_TYPE
 (
IBM_FORMAT_ALAW
),

443 
FORMAT_TYPE
 (
IBM_FORMAT_ADPCM
),

444 
FORMAT_TYPE
 (
WAVE_FORMAT_VIVO_G723
),

445 
FORMAT_TYPE
 (
WAVE_FORMAT_VIVO_SIREN
),

446 
FORMAT_TYPE
 (
WAVE_FORMAT_DIGITAL_G723
),

447 
FORMAT_TYPE
 (
WAVE_FORMAT_CREATIVE_ADPCM
),

448 
FORMAT_TYPE
 (
WAVE_FORMAT_CREATIVE_FASTSPEECH8
),

449 
FORMAT_TYPE
 (
WAVE_FORMAT_CREATIVE_FASTSPEECH10
),

450 
FORMAT_TYPE
 (
WAVE_FORMAT_QUARTERDECK
),

451 
FORMAT_TYPE
 (
WAVE_FORMAT_FM_TOWNS_SND
),

452 
FORMAT_TYPE
 (
WAVE_FORMAT_BZV_DIGITAL
),

453 
FORMAT_TYPE
 (
WAVE_FORMAT_VME_VMPCM
),

454 
FORMAT_TYPE
 (
WAVE_FORMAT_OLIGSM
),

455 
FORMAT_TYPE
 (
WAVE_FORMAT_OLIADPCM
),

456 
FORMAT_TYPE
 (
WAVE_FORMAT_OLICELP
),

457 
FORMAT_TYPE
 (
WAVE_FORMAT_OLISBC
),

458 
FORMAT_TYPE
 (
WAVE_FORMAT_OLIOPR
),

459 
FORMAT_TYPE
 (
WAVE_FORMAT_LH_CODEC
),

460 
FORMAT_TYPE
 (
WAVE_FORMAT_NORRIS
),

461 
FORMAT_TYPE
 (
WAVE_FORMAT_SOUNDSPACE_MUSICOMPRESS
),

462 
FORMAT_TYPE
 (
WAVE_FORMAT_DVM
),

463 
FORMAT_TYPE
 (
WAVE_FORMAT_INTERWAV_VSC112
),

464 
FORMAT_TYPE
 (
WAVE_FORMAT_IPP_ITU_G_723_1
),

465 
FORMAT_TYPE
 (
WAVE_FORMAT_EXTENSIBLE
),

469 
	$wav_w64_f‹m©_°r
 (
k
)

470 { 
lowî
, 
uµî
, 
mid
 ;

472 
lowî
 = -1 ;

473 
uµî
 =  (
wave_descs
Ë/  (
WAV_FORMAT_DESC
) ;

476 i‡((
wave_descs
 [0].
ID
 <
k
Ë&& (k <wave_desc†[
uµî
 - 1].ID))

478 
lowî
 + 1 < 
uµî
)

479 { 
mid
 = (
uµî
 + 
lowî
) / 2 ;

481 i‡(
k
 =
wave_descs
 [
mid
].
ID
)

482  
wave_descs
 [
mid
].
«me
 ;

483 i‡(
k
 < 
wave_descs
 [
mid
].
ID
)

484 
uµî
 = 
mid
 ;

486 
lowî
 = 
mid
 ;

491 
	}
}

494 
	$wav_w64_§©e2blocksize
 (
§©e_ch™_¥odu˘
)

495 { i‡(
§©e_ch™_¥odu˘
 < 12000)

497 i‡(
§©e_ch™_¥odu˘
 < 23000)

499 i‡(
§©e_ch™_¥odu˘
 < 44000)

502 
	}
}

	@libsndfile-1.0.17/src/wav_w64.h

22 #i‚de‡
WAV_W64_H_INCLUDED


23 
	#WAV_W64_H_INCLUDED


	)

32 
	mWAVE_FORMAT_UNKNOWN
 = 0x0000,

33 
	mWAVE_FORMAT_PCM
 = 0x0001,

34 
	mWAVE_FORMAT_MS_ADPCM
 = 0x0002,

35 
	mWAVE_FORMAT_IEEE_FLOAT
 = 0x0003,

36 
	mWAVE_FORMAT_VSELP
 = 0x0004,

37 
	mWAVE_FORMAT_IBM_CVSD
 = 0x0005,

38 
	mWAVE_FORMAT_ALAW
 = 0x0006,

39 
	mWAVE_FORMAT_MULAW
 = 0x0007,

40 
	mWAVE_FORMAT_OKI_ADPCM
 = 0x0010,

41 
	mWAVE_FORMAT_IMA_ADPCM
 = 0x0011,

42 
	mWAVE_FORMAT_MEDIASPACE_ADPCM
 = 0x0012,

43 
	mWAVE_FORMAT_SIERRA_ADPCM
 = 0x0013,

44 
	mWAVE_FORMAT_G723_ADPCM
 = 0x0014,

45 
	mWAVE_FORMAT_DIGISTD
 = 0x0015,

46 
	mWAVE_FORMAT_DIGIFIX
 = 0x0016,

47 
	mWAVE_FORMAT_DIALOGIC_OKI_ADPCM
 = 0x0017,

48 
	mWAVE_FORMAT_MEDIAVISION_ADPCM
 = 0x0018,

49 
	mWAVE_FORMAT_CU_CODEC
 = 0x0019,

50 
	mWAVE_FORMAT_YAMAHA_ADPCM
 = 0x0020,

51 
	mWAVE_FORMAT_SONARC
 = 0x0021,

52 
	mWAVE_FORMAT_DSPGROUP_TRUESPEECH
 = 0x0022,

53 
	mWAVE_FORMAT_ECHOSC1
 = 0x0023,

54 
	mWAVE_FORMAT_AUDIOFILE_AF36
 = 0x0024,

55 
	mWAVE_FORMAT_APTX
 = 0x0025,

56 
	mWAVE_FORMAT_AUDIOFILE_AF10
 = 0x0026,

57 
	mWAVE_FORMAT_PROSODY_1612
 = 0x0027,

58 
	mWAVE_FORMAT_LRC
 = 0x0028,

59 
	mWAVE_FORMAT_DOLBY_AC2
 = 0x0030,

60 
	mWAVE_FORMAT_GSM610
 = 0x0031,

61 
	mWAVE_FORMAT_MSNAUDIO
 = 0x0032,

62 
	mWAVE_FORMAT_ANTEX_ADPCME
 = 0x0033,

63 
	mWAVE_FORMAT_CONTROL_RES_VQLPC
 = 0x0034,

64 
	mWAVE_FORMAT_DIGIREAL
 = 0x0035,

65 
	mWAVE_FORMAT_DIGIADPCM
 = 0x0036,

66 
	mWAVE_FORMAT_CONTROL_RES_CR10
 = 0x0037,

67 
	mWAVE_FORMAT_NMS_VBXADPCM
 = 0x0038,

68 
	mWAVE_FORMAT_ROLAND_RDAC
 = 0x0039,

69 
	mWAVE_FORMAT_ECHOSC3
 = 0x003A,

70 
	mWAVE_FORMAT_ROCKWELL_ADPCM
 = 0x003B,

71 
	mWAVE_FORMAT_ROCKWELL_DIGITALK
 = 0x003C,

72 
	mWAVE_FORMAT_XEBEC
 = 0x003D,

73 
	mWAVE_FORMAT_G721_ADPCM
 = 0x0040,

74 
	mWAVE_FORMAT_G728_CELP
 = 0x0041,

75 
	mWAVE_FORMAT_MSG723
 = 0x0042,

76 
	mWAVE_FORMAT_MPEG
 = 0x0050,

77 
	mWAVE_FORMAT_RT24
 = 0x0052,

78 
	mWAVE_FORMAT_PAC
 = 0x0053,

79 
	mWAVE_FORMAT_MPEGLAYER3
 = 0x0055,

80 
	mWAVE_FORMAT_LUCENT_G723
 = 0x0059,

81 
	mWAVE_FORMAT_CIRRUS
 = 0x0060,

82 
	mWAVE_FORMAT_ESPCM
 = 0x0061,

83 
	mWAVE_FORMAT_VOXWARE
 = 0x0062,

84 
	mWAVE_FORMAT_CANOPUS_ATRAC
 = 0x0063,

85 
	mWAVE_FORMAT_G726_ADPCM
 = 0x0064,

86 
	mWAVE_FORMAT_G722_ADPCM
 = 0x0065,

87 
	mWAVE_FORMAT_DSAT
 = 0x0066,

88 
	mWAVE_FORMAT_DSAT_DISPLAY
 = 0x0067,

89 
	mWAVE_FORMAT_VOXWARE_BYTE_ALIGNED
 = 0x0069,

90 
	mWAVE_FORMAT_VOXWARE_AC8
 = 0x0070,

91 
	mWAVE_FORMAT_VOXWARE_AC10
 = 0x0071,

92 
	mWAVE_FORMAT_VOXWARE_AC16
 = 0x0072,

93 
	mWAVE_FORMAT_VOXWARE_AC20
 = 0x0073,

94 
	mWAVE_FORMAT_VOXWARE_RT24
 = 0x0074,

95 
	mWAVE_FORMAT_VOXWARE_RT29
 = 0x0075,

96 
	mWAVE_FORMAT_VOXWARE_RT29HW
 = 0x0076,

97 
	mWAVE_FORMAT_VOXWARE_VR12
 = 0x0077,

98 
	mWAVE_FORMAT_VOXWARE_VR18
 = 0x0078,

99 
	mWAVE_FORMAT_VOXWARE_TQ40
 = 0x0079,

100 
	mWAVE_FORMAT_SOFTSOUND
 = 0x0080,

101 
	mWAVE_FORMAT_VOXARE_TQ60
 = 0x0081,

102 
	mWAVE_FORMAT_MSRT24
 = 0x0082,

103 
	mWAVE_FORMAT_G729A
 = 0x0083,

104 
	mWAVE_FORMAT_MVI_MV12
 = 0x0084,

105 
	mWAVE_FORMAT_DF_G726
 = 0x0085,

106 
	mWAVE_FORMAT_DF_GSM610
 = 0x0086,

109 
	mWAVE_FORMAT_ONLIVE
 = 0x0089,

110 
	mWAVE_FORMAT_SBC24
 = 0x0091,

111 
	mWAVE_FORMAT_DOLBY_AC3_SPDIF
 = 0x0092,

112 
	mWAVE_FORMAT_ZYXEL_ADPCM
 = 0x0097,

113 
	mWAVE_FORMAT_PHILIPS_LPCBB
 = 0x0098,

114 
	mWAVE_FORMAT_PACKED
 = 0x0099,

115 
	mWAVE_FORMAT_RHETOREX_ADPCM
 = 0x0100,

121 
	mIBM_FORMAT_MULAW
 = 0x0101,

122 
	mIBM_FORMAT_ALAW
 = 0x0102,

123 
	mIBM_FORMAT_ADPCM
 = 0x0103,

125 
	mWAVE_FORMAT_VIVO_G723
 = 0x0111,

126 
	mWAVE_FORMAT_VIVO_SIREN
 = 0x0112,

127 
	mWAVE_FORMAT_DIGITAL_G723
 = 0x0123,

128 
	mWAVE_FORMAT_CREATIVE_ADPCM
 = 0x0200,

129 
	mWAVE_FORMAT_CREATIVE_FASTSPEECH8
 = 0x0202,

130 
	mWAVE_FORMAT_CREATIVE_FASTSPEECH10
 = 0x0203,

131 
	mWAVE_FORMAT_QUARTERDECK
 = 0x0220,

132 
	mWAVE_FORMAT_FM_TOWNS_SND
 = 0x0300,

133 
	mWAVE_FORMAT_BZV_DIGITAL
 = 0x0400,

134 
	mWAVE_FORMAT_VME_VMPCM
 = 0x0680,

135 
	mWAVE_FORMAT_OLIGSM
 = 0x1000,

136 
	mWAVE_FORMAT_OLIADPCM
 = 0x1001,

137 
	mWAVE_FORMAT_OLICELP
 = 0x1002,

138 
	mWAVE_FORMAT_OLISBC
 = 0x1003,

139 
	mWAVE_FORMAT_OLIOPR
 = 0x1004,

140 
	mWAVE_FORMAT_LH_CODEC
 = 0x1100,

141 
	mWAVE_FORMAT_NORRIS
 = 0x1400,

144 
	mWAVE_FORMAT_SOUNDSPACE_MUSICOMPRESS
 = 0x1500,

145 
	mWAVE_FORMAT_DVM
 = 0x2000,

146 
	mWAVE_FORMAT_INTERWAV_VSC112
 = 0x7150,

148 
	mWAVE_FORMAT_IPP_ITU_G_723_1
 = 0x7230,

150 
	mWAVE_FORMAT_EXTENSIBLE
 = 0xFFFE

154 { 
	mf‹m©
 ;

155 
	mch™√ls
 ;

156 
	mßm∂î©e
 ;

157 
	mbyã•î£c
 ;

158 
	mblockÆign
 ;

159 
	mbôwidth
 ;

160 } 
	tMIN_WAV_FMT
 ;

163 { 
	mf‹m©
 ;

164 
	mch™√ls
 ;

165 
	mßm∂î©e
 ;

166 
	mbyã•î£c
 ;

167 
	mblockÆign
 ;

168 
	mbôwidth
 ;

169 
	mexåabyãs
 ;

170 
	mdummy
 ;

171 } 
	tWAV_FMT_SIZE20
 ;

174 { 
	mf‹m©
 ;

175 
	mch™√ls
 ;

176 
	mßm∂î©e
 ;

177 
	mbyã•î£c
 ;

178 
	mblockÆign
 ;

179 
	mbôwidth
 ;

180 
	mexåabyãs
 ;

181 
	mßm∂e•îblock
 ;

182 
	mnumc€ffs
 ;

184 { 
	mc€ff1
 ;

185 
	mc€ff2
 ;

186 } 
	mc€ffs
 [7] ;

187 } 
	tMS_ADPCM_WAV_FMT
 ;

190 { 
	mf‹m©
 ;

191 
	mch™√ls
 ;

192 
	mßm∂î©e
 ;

193 
	mbyã•î£c
 ;

194 
	mblockÆign
 ;

195 
	mbôwidth
 ;

196 
	mexåabyãs
 ;

197 
	mßm∂e•îblock
 ;

198 } 
	tIMA_ADPCM_WAV_FMT
 ;

201 { 
	mf‹m©
 ;

202 
	mch™√ls
 ;

203 
	mßm∂î©e
 ;

204 
	mbyã•î£c
 ;

205 
	mblockÆign
 ;

206 
	mbôwidth
 ;

207 
	mexåabyãs
 ;

208 
	mauxblocksize
 ;

209 } 
	tG72x_ADPCM_WAV_FMT
 ;

213 { 
	mf‹m©
 ;

214 
	mch™√ls
 ;

215 
	mßm∂î©e
 ;

216 
	mbyã•î£c
 ;

217 
	mblockÆign
 ;

218 
	mbôwidth
 ;

219 
	mexåabyãs
 ;

220 
	mßm∂e•îblock
 ;

221 } 
	tGSM610_WAV_FMT
 ;

224 { 
	mesf_fõld1
 ;

225 
	mesf_fõld2
 ;

226 
	mesf_fõld3
 ;

227 
	mesf_fõld4
 [8] ;

228 } 
	tEXT_SUBFORMAT
 ;

231 { 
	mf‹m©
 ;

232 
	mch™√ls
 ;

233 
	mßm∂î©e
 ;

234 
	mbyã•î£c
 ;

235 
	mblockÆign
 ;

236 
	mbôwidth
 ;

237 
	mexåabyãs
 ;

238 
	mvÆidbôs
 ;

239 
	mch™√lmask
 ;

240 
EXT_SUBFORMAT
 
	mesf
 ;

241 } 
	tEXTENSIBLE_WAV_FMT
 ;

244 { 
	mf‹m©
 ;

245 
MIN_WAV_FMT
 
	mmö
 ;

246 
IMA_ADPCM_WAV_FMT
 
	mima
 ;

247 
MS_ADPCM_WAV_FMT
 
	mmßdpcm
 ;

248 
G72x_ADPCM_WAV_FMT
 
	mg72x
 ;

249 
EXTENSIBLE_WAV_FMT
 
	mext
 ;

250 
GSM610_WAV_FMT
 
	mgsm610
 ;

251 
WAV_FMT_SIZE20
 
	msize20
 ;

252 
	m∑ddög
 [512] ;

253 } 
	tWAV_FMT
 ;

256 { 
	m‰ames
 ;

257 } 
	tFACT_CHUNK
 ;

259 
	#WAV_W64_GSM610_BLOCKSIZE
 65

	)

260 
	#WAV_W64_GSM610_SAMPLES
 320

	)

266 
	#MSADPCM_ADAPT_COEFF_COUNT
 7

	)

268 
mßdpcm_wrôe_ad≠t_c€ffs
 (
SF_PRIVATE
 *
psf
) ;

274 
wav_w64_§©e2blocksize
 (
§©e_ch™_¥odu˘
) ;

275 c⁄°* 
wav_w64_f‹m©_°r
 (
k
) ;

276 
wav_w64_ªad_fmt_chunk
 (
SF_PRIVATE
 *
psf
, 
WAV_FMT
 *
wav_fmt
, 
°ru˘size
) ;

277 
wavex_wrôe_guid
 (
SF_PRIVATE
 *
psf
, c⁄° 
EXT_SUBFORMAT
 * 
subf‹m©
) ;

	@libsndfile-1.0.17/src/wve.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<f˙é.h
>

23 
	~<°rög.h
>

24 
	~<˘y≥.h
>

26 
	~"¢dfûe.h
"

27 
	~"s„ndün.h
"

28 
	~"comm⁄.h
"

30 #i‡(
ENABLE_EXPERIMENTAL_CODE
 == 0)

33 
	$wve_›í
 (
SF_PRIVATE
 *
psf
)

34 { i‡(
psf
)

35  
SFE_UNIMPLEMENTED
 ;

36  (
psf
 && 0) ;

37 
	}
}

41 
	#SFE_WVE_NOT_WVE
 666

	)

47 
	#ALAW_MARKER
 
	`MAKE_MARKER
 ('A', 'L', 'a', 'w')

	)

48 
	#SOUN_MARKER
 
	`MAKE_MARKER
 ('S', 'o', 'u', 'n')

	)

49 
	#DFIL_MARKER
 
	`MAKE_MARKER
 ('d', 'F', 'i', 'l')

	)

55 
wve_ªad_hódî
 (
SF_PRIVATE
 *
psf
) ;

62 
	$wve_›í
 (
SF_PRIVATE
 *
psf
)

63 { 
subf‹m©
, 
îr‹
 = 0 ;

65 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

66  
SFE_UNIMPLEMENTED
 ;

68 i‡((
îr‹
 = 
	`wve_ªad_hódî
 (
psf
)))

69  
îr‹
 ;

71 i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_WVE
)

72  
SFE_BAD_OPEN_FORMAT
 ;

74 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

76  
îr‹
 ;

77 
	}
}

83 
	$wve_ªad_hódî
 (
SF_PRIVATE
 *
psf
)

84 { 
m¨kî
 ;

87 
	`psf_böhódî_ªadf
 (
psf
, "pm", 0, &
m¨kî
) ;

88 i‡(
m¨kî
 !
ALAW_MARKER
)

89  
SFE_WVE_NOT_WVE
 ;

91 
	`psf_böhódî_ªadf
 (
psf
, "m", &
m¨kî
) ;

92 i‡(
m¨kî
 !
SOUN_MARKER
)

93  
SFE_WVE_NOT_WVE
 ;

95 
	`psf_böhódî_ªadf
 (
psf
, "m", &
m¨kî
) ;

96 i‡(
m¨kî
 !
DFIL_MARKER
)

97  
SFE_WVE_NOT_WVE
 ;

99 
	`psf_log_¥ötf
 (
psf
, "Read only : Psion Palmtop Alaw (.wve)\n"

104 
psf
->
d©aoff£t
 = 0x20 ;

105 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

107 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_WVE
 | 
SF_FORMAT_ALAW
 ;

108 
psf
->
sf
.
ßm∂î©e
 = 8000 ;

109 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 ;

110 
psf
->
sf
.
ch™√ls
 = 1 ;

112  
	`Æaw_öô
 (
psf
) ;

113 
	}
}

	@libsndfile-1.0.17/src/xi.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<f˙é.h
>

24 
	~<°rög.h
>

25 
	~<˘y≥.h
>

27 
	~"¢dfûe.h
"

28 
	~"s„ndün.h
"

29 
	~"comm⁄.h
"

30 
	~"Êﬂt_ˇ°.h
"

32 
	#MAX_XI_SAMPLES
 16

	)

40 
	mfûíame
 [22] ;

41 
	mso·w¨e
 [20] ;

42 
	mßm∂e_«me
 [22] ;

44 
	mlo›_begö
, 
	mlo›_íd
 ;

45 
	mßm∂e_Êags
 ;

48 
	mœ°_16
 ;

49 } 
	tXI_PRIVATE
 ;

51 
xi_˛o£
 (
SF_PRIVATE
 *
psf
) ;

52 
xi_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
) ;

53 
xi_ªad_hódî
 (
SF_PRIVATE
 *
psf
) ;

54 
dpcm_öô
 (
SF_PRIVATE
 *
psf
) ;

57 
sf_cou¡_t
 
dpcm_£ek
 (
SF_PRIVATE
 *
psf
, 
mode
, sf_cou¡_à
off£t
) ;

64 
	$xi_›í
 (
SF_PRIVATE
 *
psf
)

65 { 
XI_PRIVATE
 *
pxi
 ;

66 
subf‹m©
, 
îr‹
 = 0 ;

68 i‡(
psf
->
is_pùe
)

69  
SFE_XI_NO_PIPE
 ;

71 i‡(
psf
->
codec_d©a
)

72 
pxi
 = 
psf
->
codec_d©a
 ;

73 i‡((
pxi
 = 
	`ˇŒoc
 (1,  (
XI_PRIVATE
))Ë=
NULL
)

74  
SFE_MALLOC_FAILED
 ;

76 
psf
->
codec_d©a
 = 
pxi
 ;

78 i‡(
psf
->
mode
 =
SFM_READ
 || (psf->modê=
SFM_RDWR
 &&Ösf->
fûñígth
 > 0))

79 { i‡((
îr‹
 = 
	`xi_ªad_hódî
 (
psf
)))

80  
îr‹
 ;

83 
subf‹m©
 = 
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
 ;

85 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

86 { i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_XI
)

87  
SFE_BAD_OPEN_FORMAT
 ;

89 
psf
->
ídün
 = 
SF_ENDIAN_LITTLE
 ;

90 
psf
->
sf
.
ch™√ls
 = 1 ;

91 
psf
->
sf
.
ßm∂î©e
 = 44100 ;

94 
	`mem˝y
 (
pxi
->
fûíame
, "Default Name ",  (pxi->filename)) ;

95 
	`mem˝y
 (
pxi
->
so·w¨e
, 
PACKAGE
 "-" 
VERSION
 " ",  (pxi->software)) ;

97 
	`mem£t
 (
pxi
->
ßm∂e_«me
, 0,  (pxi->sample_name)) ;

98 
	`LSF_SNPRINTF
 (
pxi
->
ßm∂e_«me
,  (pxi->sample_name), "%s", "Sample #1") ;

100 
pxi
->
ßm∂e_Êags
 = (
subf‹m©
 =
SF_FORMAT_DPCM_16
) ? 16 : 0 ;

102 i‡(
	`xi_wrôe_hódî
 (
psf
, 
SF_FALSE
))

103  
psf
->
îr‹
 ;

105 
psf
->
wrôe_hódî
 = 
xi_wrôe_hódî
 ;

108 
psf
->
c⁄èöî_˛o£
 = 
xi_˛o£
 ;

109 
psf
->
£ek
 = 
dpcm_£ek
 ;

111 
psf
->
sf
.
£ekabÀ
 = 
SF_FALSE
 ;

113 
psf
->
blockwidth
 =Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

115 
subf‹m©
)

116 { 
SF_FORMAT_DPCM_8
 :

117 
SF_FORMAT_DPCM_16
 :

118 
îr‹
 = 
	`dpcm_öô
 (
psf
) ;

124  
îr‹
 ;

125 
	}
}

131 
	$xi_˛o£
 (
SF_PRIVATE
 *
psf
)

133 
psf
 =Ösf ;

136 
	}
}

141 
sf_cou¡_t
 
dpcm_ªad_dsc2s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

142 
sf_cou¡_t
 
dpcm_ªad_dsc2i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

143 
sf_cou¡_t
 
dpcm_ªad_dsc2f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

144 
sf_cou¡_t
 
dpcm_ªad_dsc2d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

146 
sf_cou¡_t
 
dpcm_wrôe_s2dsc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

147 
sf_cou¡_t
 
dpcm_wrôe_i2dsc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

148 
sf_cou¡_t
 
dpcm_wrôe_f2dsc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

149 
sf_cou¡_t
 
dpcm_wrôe_d2dsc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

151 
sf_cou¡_t
 
dpcm_ªad_dÀs2s
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

152 
sf_cou¡_t
 
dpcm_ªad_dÀs2i
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

153 
sf_cou¡_t
 
dpcm_ªad_dÀs2f
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

154 
sf_cou¡_t
 
dpcm_ªad_dÀs2d
 (
SF_PRIVATE
 *
psf
, *
±r
, sf_cou¡_à
Àn
) ;

156 
sf_cou¡_t
 
dpcm_wrôe_s2dÀs
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

157 
sf_cou¡_t
 
dpcm_wrôe_i2dÀs
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

158 
sf_cou¡_t
 
dpcm_wrôe_f2dÀs
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

159 
sf_cou¡_t
 
dpcm_wrôe_d2dÀs
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, sf_cou¡_à
Àn
) ;

162 
	$dpcm_öô
 (
SF_PRIVATE
 *
psf
)

163 { i‡(
psf
->
byãwidth
 =0 ||Ösf->
sf
.
ch™√ls
 == 0)

164  
SFE_INTERNAL
 ;

166 
psf
->
blockwidth
 =Ösf->
byãwidth
 *Ösf->
sf
.
ch™√ls
 ;

168 i‡(
psf
->
mode
 =
SFM_READ
 ||Ösf->modê=
SFM_RDWR
)

169 { 
psf
->
byãwidth
)

171 
psf
->
ªad_sh‹t
 = 
dpcm_ªad_dsc2s
 ;

172 
psf
->
ªad_öt
 = 
dpcm_ªad_dsc2i
 ;

173 
psf
->
ªad_Êﬂt
 = 
dpcm_ªad_dsc2f
 ;

174 
psf
->
ªad_doubÀ
 = 
dpcm_ªad_dsc2d
 ;

177 
psf
->
ªad_sh‹t
 = 
dpcm_ªad_dÀs2s
 ;

178 
psf
->
ªad_öt
 = 
dpcm_ªad_dÀs2i
 ;

179 
psf
->
ªad_Êﬂt
 = 
dpcm_ªad_dÀs2f
 ;

180 
psf
->
ªad_doubÀ
 = 
dpcm_ªad_dÀs2d
 ;

183 
	`psf_log_¥ötf
 (
psf
, "dpcm_init()Ñeturning SFE_UNIMPLEMENTED\n") ;

184  
SFE_UNIMPLEMENTED
 ;

188 i‡(
psf
->
mode
 =
SFM_WRITE
 ||Ösf->modê=
SFM_RDWR
)

189 { 
psf
->
byãwidth
)

191 
psf
->
wrôe_sh‹t
 = 
dpcm_wrôe_s2dsc
 ;

192 
psf
->
wrôe_öt
 = 
dpcm_wrôe_i2dsc
 ;

193 
psf
->
wrôe_Êﬂt
 = 
dpcm_wrôe_f2dsc
 ;

194 
psf
->
wrôe_doubÀ
 = 
dpcm_wrôe_d2dsc
 ;

197 
psf
->
wrôe_sh‹t
 = 
dpcm_wrôe_s2dÀs
 ;

198 
psf
->
wrôe_öt
 = 
dpcm_wrôe_i2dÀs
 ;

199 
psf
->
wrôe_Êﬂt
 = 
dpcm_wrôe_f2dÀs
 ;

200 
psf
->
wrôe_doubÀ
 = 
dpcm_wrôe_d2dÀs
 ;

203 
	`psf_log_¥ötf
 (
psf
, "dpcm_init()Ñeturning SFE_UNIMPLEMENTED\n") ;

204  
SFE_UNIMPLEMENTED
 ;

208 
psf
->
fûñígth
 = 
	`psf_gë_fûñí
 (psf) ;

209 
psf
->
d©Æígth
 = (psf->
d©´nd
Ë?Ösf->d©´nd -Ösf->
d©aoff£t
 :

210 
psf
->
fûñígth
 -Ösf->
d©aoff£t
 ;

211 
psf
->
sf
.
‰ames
 =Ösf->
d©Æígth
 /Ösf->
blockwidth
 ;

214 
	}
}

219 
sf_cou¡_t


220 
	$dpcm_£ek
 (
SF_PRIVATE
 *
psf
, 
mode
, 
sf_cou¡_t
 
off£t
)

221 { 
XI_PRIVATE
 *
pxi
 ;

222 
tŸÆ
, 
buf„æí
, 
Àn
 ;

224 i‡((
pxi
 = 
psf
->
codec_d©a
Ë=
NULL
)

225  
SFE_INTERNAL
 ;

227 i‡(
psf
->
d©Æígth
 < 0 ||Ösf->
d©aoff£t
 < 0)

228 { 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

229  
PSF_SEEK_ERROR
 ;

232 i‡(
off£t
 == 0)

233 { 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
, 
SEEK_SET
) ;

234 
pxi
->
œ°_16
 = 0 ;

238 i‡(
off£t
 < 0 || off£à> 
psf
->
sf
.
‰ames
)

239 { 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

240  
PSF_SEEK_ERROR
 ;

243 i‡(
mode
 !
SFM_READ
)

245 
psf
->
îr‹
 = 
SFE_BAD_SEEK
 ;

246  
PSF_SEEK_ERROR
 ;

249 
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
, 
SEEK_SET
) ;

251 i‡((
psf
->
sf
.
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DPCM_16
)

252 { 
tŸÆ
 = 
off£t
 ;

253 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

254 
tŸÆ
 > 0)

255 { 
Àn
 = (
tŸÆ
 > 
buf„æí
) ? bufferlen :Åotal ;

256 
tŸÆ
 -
	`dpcm_ªad_dÀs2s
 (
psf
,Ösf->
u
.
sbuf
, 
Àn
) ;

260 { 
tŸÆ
 = 
off£t
 ;

261 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

262 
tŸÆ
 > 0)

263 { 
Àn
 = (
tŸÆ
 > 
buf„æí
) ? bufferlen :Åotal ;

264 
tŸÆ
 -
	`dpcm_ªad_dsc2s
 (
psf
,Ösf->
u
.
sbuf
, 
Àn
) ;

268  
off£t
 ;

269 
	}
}

273 
	$xi_wrôe_hódî
 (
SF_PRIVATE
 *
psf
, 
ˇlc_Àngth
)

274 { 
XI_PRIVATE
 *
pxi
 ;

275 
sf_cou¡_t
 
cuºít
 ;

276 c⁄° *
°rög
 ;

278 i‡((
pxi
 = 
psf
->
codec_d©a
Ë=
NULL
)

279  
SFE_INTERNAL
 ;

281 
ˇlc_Àngth
 = calc_length ;

283 
cuºít
 = 
	`psf_·ñl
 (
psf
) ;

286 
psf
->
hódî
 [0] = 0 ;

287 
psf
->
hódödex
 = 0 ;

288 
	`psf_f£ek
 (
psf
, 0, 
SEEK_SET
) ;

290 
°rög
 = "Extended Instrument: " ;

291 
	`psf_böhódî_wrôef
 (
psf
, "b", 
°rög
, 
	`°æí
 (string)) ;

292 
	`psf_böhódî_wrôef
 (
psf
, "b1", 
pxi
->
fûíame
,  (pxi->filename), 0x1A) ;

295 
	`psf_böhódî_wrôef
 (
psf
, "eb2", 
pxi
->
so·w¨e
,  (pxi->software), (1 << 8) + 2) ;

301 
	`psf_böhódî_wrôef
 (
psf
, "z", (
size_t
) (96 + 48 + 48 + 1 + 1)) ;

306 
	`psf_böhódî_wrôef
 (
psf
, "ez2z2", (
size_t
Ë(4 * 3), 0x1234, 
	`make_size_t
 (22), 1) ;

308 
pxi
->
lo›_begö
 = 0 ;

309 
pxi
->
lo›_íd
 = 0 ;

311 
	`psf_böhódî_wrôef
 (
psf
, "ë844",Ösf->
sf
.
‰ames
, 
pxi
->
lo›_begö
,Öxi->
lo›_íd
) ;

314 
	`psf_böhódî_wrôef
 (
psf
, "111111", 128, 0, 
pxi
->
ßm∂e_Êags
, 128, 0, 
	`°æí
 (pxi->
ßm∂e_«me
)) ;

316 
	`psf_böhódî_wrôef
 (
psf
, "b", 
pxi
->
ßm∂e_«me
,  (pxi->sample_name)) ;

323 
	`psf_fwrôe
 (
psf
->
hódî
,Ösf->
hódödex
, 1,Ösf) ;

325 i‡(
psf
->
îr‹
)

326  
psf
->
îr‹
 ;

328 
psf
->
d©aoff£t
 =Ösf->
hódödex
 ;

330 i‡(
cuºít
 > 0)

331 
	`psf_f£ek
 (
psf
, 
cuºít
, 
SEEK_SET
) ;

333  
psf
->
îr‹
 ;

334 
	}
}

337 
	$xi_ªad_hódî
 (
SF_PRIVATE
 *
psf
)

338 { 
buf„r
 [64], 
«me
 [32] ;

339 
vîsi⁄
, 
Áde_out
, 
ßm∂e_cou¡
 ;

340 
k
, 
lo›_begö
, 
lo›_íd
 ;

341 
ßm∂e_sizes
 [
MAX_XI_SAMPLES
] ;

343 
	`psf_böhódî_ªadf
 (
psf
, "pb", 0, 
buf„r
, 21) ;

345 
	`mem£t
 (
ßm∂e_sizes
, 0,  (sample_sizes)) ;

347 
buf„r
 [20] = 0 ;

348 i‡(
	`°rcmp
 (
buf„r
, "Extended Instrument:") != 0)

349  
SFE_XI_BAD_HEADER
 ;

351 
	`mem£t
 (
buf„r
, 0,  (buffer)) ;

352 
	`psf_böhódî_ªadf
 (
psf
, "b", 
buf„r
, 23) ;

354 i‡(
buf„r
 [22] != 0x1A)

355  
SFE_XI_BAD_HEADER
 ;

357 
buf„r
 [22] = 0 ;

358 
	`psf_log_¥ötf
 (
psf
, "Exãnded In°rumíà: %s\n", 
buf„r
) ;

360 
	`psf_böhódî_ªadf
 (
psf
, "be2", 
buf„r
, 20, &
vîsi⁄
) ;

361 
buf„r
 [19] = 0 ;

362 
	`psf_log_¥ötf
 (
psf
, "So·w¨ê: %s\nVîsi⁄ : %d.%02d\n", 
buf„r
, 
vîsi⁄
 / 256, version % 256) ;

367 
	`psf_böhódî_ªadf
 (
psf
, "j", 96 + 48 + 48 + 1 + 1) ;

369 
	`psf_böhódî_ªadf
 (
psf
, "b", 
buf„r
, 12) ;

370 
	`psf_log_¥ötf
 (
psf
, "Volume Loop\n sustain : %u\n begin : %u\nÉnd : %u\n",

371 
buf„r
 [0], buffer [1], buffer [2]) ;

372 
	`psf_log_¥ötf
 (
psf
, "Pan Loop\n sustain : %u\n begin : %u\nÉnd : %u\n",

373 
buf„r
 [3], buffer [4], buffer [5]) ;

374 
	`psf_log_¥ötf
 (
psf
, "Envelope Flags\n volume : 0x%X\nÖan : 0x%X\n",

375 
buf„r
 [6] & 0xFF, buffer [7] & 0xFF) ;

377 
	`psf_log_¥ötf
 (
psf
, "Vibrato\nÅype : %u\n sweep : %u\n depth : %u\nÑate : %u\n",

378 
buf„r
 [8], buffer [9], buffer [10], buffer [11]) ;

384 
	`psf_böhódî_ªadf
 (
psf
, "e2j2", &
Áde_out
, 2 + 20, &
ßm∂e_cou¡
) ;

385 
	`psf_log_¥ötf
 (
psf
, "Fadêouà : %d\n", 
Áde_out
) ;

388 i‡(
ßm∂e_cou¡
 > 
MAX_XI_SAMPLES
)

389  
SFE_XI_EXCESS_SAMPLES
 ;

391 i‡(
psf
->
ö°rumít
 =
NULL
 && (psf->ö°rumíà
	`psf_ö°rumít_Æloc
 ()) == NULL)

392  
SFE_MALLOC_FAILED
 ;

395 
k
 = 0 ; k < 
ßm∂e_cou¡
 ; k++)

396 { 
	`psf_böhódî_ªadf
 (
psf
, "e444", &(
ßm∂e_sizes
 [
k
]), &
lo›_begö
, &
lo›_íd
) ;

399 
	`psf_böhódî_ªadf
 (
psf
, "bb", 
buf„r
, 6, 
«me
, 22) ;

400 
«me
 [21] = 0 ;

402 
	`psf_log_¥ötf
 (
psf
, "Sam∂ê#%d\¿Çamê : %s\n", 
k
 + 1, 
«me
) ;

404 
	`psf_log_¥ötf
 (
psf
, " sizê : %d\n", 
ßm∂e_sizes
 [
k
]) ;

408 
	`psf_log_¥ötf
 (
psf
, "Üo›\¿ begö : %d\¿Énd : %d\n", 
lo›_begö
, 
lo›_íd
) ;

410 
	`psf_log_¥ötf
 (
psf
, " volume : %u\n f.Åune : %d\n flags : 0x%02X ",

411 
buf„r
 [0] & 0xFF, buffer [1] & 0xFF, buffer [2] & 0xFF) ;

413 
	`psf_log_¥ötf
 (
psf
, " (") ;

414 i‡(
buf„r
 [2] & 1)

415 
	`psf_log_¥ötf
 (
psf
, " Loop") ;

416 i‡(
buf„r
 [2] & 2)

417 
	`psf_log_¥ötf
 (
psf
, " PingPong") ;

418 
	`psf_log_¥ötf
 (
psf
, (
buf„r
 [2] & 16) ? " 16bit" : " 8bit") ;

419 
	`psf_log_¥ötf
 (
psf
, " )\n") ;

421 
	`psf_log_¥ötf
 (
psf
, "Öan : %u\nÇote : %d\nÇamelen : %d\n",

422 
buf„r
 [3] & 0xFF, buffer [4], buffer [5]) ;

424 i‡(
k
 != 0)

427 i‡(
buf„r
 [2] & 16)

428 { 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_XI
 | 
SF_FORMAT_DPCM_16
 ;

429 
psf
->
byãwidth
 = 2 ;

432 { 
psf
->
sf
.
f‹m©
 = 
SF_FORMAT_XI
 | 
SF_FORMAT_DPCM_8
 ;

433 
psf
->
byãwidth
 = 1 ;

437 
ßm∂e_cou¡
 > 1 && 
ßm∂e_sizes
 [sample_count - 1] == 0)

438 
ßm∂e_cou¡
 -- ;

442 i‡(
ßm∂e_cou¡
 > 2)

443 { 
	`psf_log_¥ötf
 (
psf
, "*** Sample count isÜessÅhan 16 but moreÅhan 1.\n") ;

444 
	`psf_log_¥ötf
 (
psf
, " sample count : %d sample_sizes [%d] : %d\n",

445 
ßm∂e_cou¡
, sam∂e_cou¡ - 1, 
ßm∂e_sizes
 [sample_count - 1]) ;

446  
SFE_XI_EXCESS_SAMPLES
 ;

449 
psf
->
d©aoff£t
 = 
	`psf_f£ek
 (psf, 0, 
SEEK_CUR
) ;

450 
	`psf_log_¥ötf
 (
psf
, "D©®Off£à: %D\n",Ösf->
d©aoff£t
) ;

452 
psf
->
d©Æígth
 = 
ßm∂e_sizes
 [0] ;

454 i‡(
psf
->
d©aoff£t
 +Ösf->
d©Æígth
 >Ösf->
fûñígth
)

455 { 
	`psf_log_¥ötf
 (
psf
, "*** File seemsÅo beÅruncated. Should beátÜeast %D bytesÜong.\n",

456 
psf
->
d©aoff£t
 + 
ßm∂e_sizes
 [0]) ;

457 
psf
->
d©Æígth
 =Ösf->
fûñígth
 -Ösf->
d©aoff£t
 ;

460 i‡(
	`psf_f£ek
 (
psf
,Ösf->
d©aoff£t
, 
SEEK_SET
) !=Ösf->dataoffset)

461  
SFE_BAD_SEEK
 ;

463 
psf
->
ídün
 = 
SF_ENDIAN_LITTLE
 ;

464 
psf
->
sf
.
ch™√ls
 = 1 ;

465 
psf
->
sf
.
ßm∂î©e
 = 44100 ;

467 
psf
->
blockwidth
 =Ösf->
sf
.
ch™√ls
 *Ösf->
byãwidth
 ;

469 i‡(! 
psf
->
sf
.
‰ames
 &&Ösf->
blockwidth
)

470 
psf
->
sf
.
‰ames
 = (psf->
fûñígth
 -Ösf->
d©aoff£t
Ë/Ösf->
blockwidth
 ;

472 
psf
->
ö°rumít
->
ba£nŸe
 = 0 ;

473 
psf
->
ö°rumít
->
gaö
 = 1 ;

474 
psf
->
ö°rumít
->
vñocôy_lo
 =Ösf->ö°rumít->
key_lo
 = 0 ;

475 
psf
->
ö°rumít
->
vñocôy_hi
 =Ösf->ö°rumít->
key_hi
 = 127 ;

478 
	}
}

483 
dsc2s_¨øy
 (
XI_PRIVATE
 *
pxi
, sig√d *
§c
, 
cou¡
, *
de°
) ;

484 
dsc2i_¨øy
 (
XI_PRIVATE
 *
pxi
, sig√d *
§c
, 
cou¡
, *
de°
) ;

485 
dsc2f_¨øy
 (
XI_PRIVATE
 *
pxi
, sig√d *
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
) ;

486 
dsc2d_¨øy
 (
XI_PRIVATE
 *
pxi
, sig√d *
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
) ;

488 
dÀs2s_¨øy
 (
XI_PRIVATE
 *
pxi
, *
§c
, 
cou¡
, *
de°
) ;

489 
dÀs2i_¨øy
 (
XI_PRIVATE
 *
pxi
, *
§c
, 
cou¡
, *
de°
) ;

490 
dÀs2f_¨øy
 (
XI_PRIVATE
 *
pxi
, *
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
) ;

491 
dÀs2d_¨øy
 (
XI_PRIVATE
 *
pxi
, *
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
) ;

493 
sf_cou¡_t


494 
	$dpcm_ªad_dsc2s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

495 { 
XI_PRIVATE
 *
pxi
 ;

496 
buf„æí
, 
ªadcou¡
 ;

497 
sf_cou¡_t
 
tŸÆ
 = 0 ;

499 i‡((
pxi
 = 
psf
->
codec_d©a
Ë=
NULL
)

502 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

504 
Àn
 > 0)

505 { i‡(
Àn
 < 
buf„æí
)

506 
buf„æí
 = (Ë
Àn
 ;

507 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
scbuf
,  (sig√d ), 
buf„æí
,Ösf) ;

508 
	`dsc2s_¨øy
 (
pxi
, 
psf
->
u
.
scbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

509 
tŸÆ
 +
ªadcou¡
 ;

510 i‡(
ªadcou¡
 < 
buf„æí
)

512 
Àn
 -
ªadcou¡
 ;

515  
tŸÆ
 ;

516 
	}
}

518 
sf_cou¡_t


519 
	$dpcm_ªad_dsc2i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

520 { 
XI_PRIVATE
 *
pxi
 ;

521 
buf„æí
, 
ªadcou¡
 ;

522 
sf_cou¡_t
 
tŸÆ
 = 0 ;

524 i‡((
pxi
 = 
psf
->
codec_d©a
Ë=
NULL
)

527 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

529 
Àn
 > 0)

530 { i‡(
Àn
 < 
buf„æí
)

531 
buf„æí
 = (Ë
Àn
 ;

532 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
scbuf
,  (sig√d ), 
buf„æí
,Ösf) ;

533 
	`dsc2i_¨øy
 (
pxi
, 
psf
->
u
.
scbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

534 
tŸÆ
 +
ªadcou¡
 ;

535 i‡(
ªadcou¡
 < 
buf„æí
)

537 
Àn
 -
ªadcou¡
 ;

540  
tŸÆ
 ;

541 
	}
}

543 
sf_cou¡_t


544 
	$dpcm_ªad_dsc2f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

545 { 
XI_PRIVATE
 *
pxi
 ;

546 
buf„æí
, 
ªadcou¡
 ;

547 
sf_cou¡_t
 
tŸÆ
 = 0 ;

548 
n‹mÁ˘
 ;

550 i‡((
pxi
 = 
psf
->
codec_d©a
Ë=
NULL
)

553 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? 1.0 / (() 0x80) : 1.0 ;

555 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

557 
Àn
 > 0)

558 { i‡(
Àn
 < 
buf„æí
)

559 
buf„æí
 = (Ë
Àn
 ;

560 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
scbuf
,  (sig√d ), 
buf„æí
,Ösf) ;

561 
	`dsc2f_¨øy
 (
pxi
, 
psf
->
u
.
scbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

562 
tŸÆ
 +
ªadcou¡
 ;

563 i‡(
ªadcou¡
 < 
buf„æí
)

565 
Àn
 -
ªadcou¡
 ;

568  
tŸÆ
 ;

569 
	}
}

571 
sf_cou¡_t


572 
	$dpcm_ªad_dsc2d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

573 { 
XI_PRIVATE
 *
pxi
 ;

574 
buf„æí
, 
ªadcou¡
 ;

575 
sf_cou¡_t
 
tŸÆ
 = 0 ;

576 
n‹mÁ˘
 ;

578 i‡((
pxi
 = 
psf
->
codec_d©a
Ë=
NULL
)

581 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? 1.0 / (() 0x80) : 1.0 ;

583 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

585 
Àn
 > 0)

586 { i‡(
Àn
 < 
buf„æí
)

587 
buf„æí
 = (Ë
Àn
 ;

588 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
scbuf
,  (sig√d ), 
buf„æí
,Ösf) ;

589 
	`dsc2d_¨øy
 (
pxi
, 
psf
->
u
.
scbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

590 
tŸÆ
 +
ªadcou¡
 ;

591 i‡(
ªadcou¡
 < 
buf„æí
)

593 
Àn
 -
ªadcou¡
 ;

596  
tŸÆ
 ;

597 
	}
}

602 
sf_cou¡_t


603 
	$dpcm_ªad_dÀs2s
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

604 { 
XI_PRIVATE
 *
pxi
 ;

605 
buf„æí
, 
ªadcou¡
 ;

606 
sf_cou¡_t
 
tŸÆ
 = 0 ;

608 i‡((
pxi
 = 
psf
->
codec_d©a
Ë=
NULL
)

611 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

613 
Àn
 > 0)

614 { i‡(
Àn
 < 
buf„æí
)

615 
buf„æí
 = (Ë
Àn
 ;

616 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
sbuf
,  (), 
buf„æí
,Ösf) ;

617 
	`dÀs2s_¨øy
 (
pxi
, 
psf
->
u
.
sbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

618 
tŸÆ
 +
ªadcou¡
 ;

619 i‡(
ªadcou¡
 < 
buf„æí
)

621 
Àn
 -
ªadcou¡
 ;

624  
tŸÆ
 ;

625 
	}
}

627 
sf_cou¡_t


628 
	$dpcm_ªad_dÀs2i
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

629 { 
XI_PRIVATE
 *
pxi
 ;

630 
buf„æí
, 
ªadcou¡
 ;

631 
sf_cou¡_t
 
tŸÆ
 = 0 ;

633 i‡((
pxi
 = 
psf
->
codec_d©a
Ë=
NULL
)

636 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

638 
Àn
 > 0)

639 { i‡(
Àn
 < 
buf„æí
)

640 
buf„æí
 = (Ë
Àn
 ;

641 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
sbuf
,  (), 
buf„æí
,Ösf) ;

642 
	`dÀs2i_¨øy
 (
pxi
, 
psf
->
u
.
sbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
) ;

643 
tŸÆ
 +
ªadcou¡
 ;

644 i‡(
ªadcou¡
 < 
buf„æí
)

646 
Àn
 -
ªadcou¡
 ;

649  
tŸÆ
 ;

650 
	}
}

652 
sf_cou¡_t


653 
	$dpcm_ªad_dÀs2f
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

654 { 
XI_PRIVATE
 *
pxi
 ;

655 
buf„æí
, 
ªadcou¡
 ;

656 
sf_cou¡_t
 
tŸÆ
 = 0 ;

657 
n‹mÁ˘
 ;

659 i‡((
pxi
 = 
psf
->
codec_d©a
Ë=
NULL
)

662 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? 1.0 / (() 0x8000) : 1.0 ;

664 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

666 
Àn
 > 0)

667 { i‡(
Àn
 < 
buf„æí
)

668 
buf„æí
 = (Ë
Àn
 ;

669 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
sbuf
,  (), 
buf„æí
,Ösf) ;

670 
	`dÀs2f_¨øy
 (
pxi
, 
psf
->
u
.
sbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

671 
tŸÆ
 +
ªadcou¡
 ;

672 i‡(
ªadcou¡
 < 
buf„æí
)

674 
Àn
 -
ªadcou¡
 ;

677  
tŸÆ
 ;

678 
	}
}

680 
sf_cou¡_t


681 
	$dpcm_ªad_dÀs2d
 (
SF_PRIVATE
 *
psf
, *
±r
, 
sf_cou¡_t
 
Àn
)

682 { 
XI_PRIVATE
 *
pxi
 ;

683 
buf„æí
, 
ªadcou¡
 ;

684 
sf_cou¡_t
 
tŸÆ
 = 0 ;

685 
n‹mÁ˘
 ;

687 i‡((
pxi
 = 
psf
->
codec_d©a
Ë=
NULL
)

690 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? 1.0 / (() 0x8000) : 1.0 ;

692 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

694 
Àn
 > 0)

695 { i‡(
Àn
 < 
buf„æí
)

696 
buf„æí
 = (Ë
Àn
 ;

697 
ªadcou¡
 = 
	`psf_‰ód
 (
psf
->
u
.
sbuf
,  (), 
buf„æí
,Ösf) ;

698 
	`dÀs2d_¨øy
 (
pxi
, 
psf
->
u
.
sbuf
, 
ªadcou¡
, 
±r
 + 
tŸÆ
, 
n‹mÁ˘
) ;

699 
tŸÆ
 +
ªadcou¡
 ;

700 i‡(
ªadcou¡
 < 
buf„æí
)

702 
Àn
 -
ªadcou¡
 ;

705  
tŸÆ
 ;

706 
	}
}

711 
s2dsc_¨øy
 (
XI_PRIVATE
 *
pxi
, c⁄° *
§c
, sig√d *
de°
, 
cou¡
) ;

712 
i2dsc_¨øy
 (
XI_PRIVATE
 *
pxi
, c⁄° *
§c
, sig√d *
de°
, 
cou¡
) ;

713 
f2dsc_¨øy
 (
XI_PRIVATE
 *
pxi
, c⁄° *
§c
, sig√d *
de°
, 
cou¡
, 
n‹mÁ˘
) ;

714 
d2dsc_¨øy
 (
XI_PRIVATE
 *
pxi
, c⁄° *
§c
, sig√d *
de°
, 
cou¡
, 
n‹mÁ˘
) ;

716 
s2dÀs_¨øy
 (
XI_PRIVATE
 *
pxi
, c⁄° *
§c
, *
de°
, 
cou¡
) ;

717 
i2dÀs_¨øy
 (
XI_PRIVATE
 *
pxi
, c⁄° *
§c
, *
de°
, 
cou¡
) ;

718 
f2dÀs_¨øy
 (
XI_PRIVATE
 *
pxi
, c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÁ˘
) ;

719 
d2dÀs_¨øy
 (
XI_PRIVATE
 *
pxi
, c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÁ˘
) ;

722 
sf_cou¡_t


723 
	$dpcm_wrôe_s2dsc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

724 { 
XI_PRIVATE
 *
pxi
 ;

725 
buf„æí
, 
wrôecou¡
 ;

726 
sf_cou¡_t
 
tŸÆ
 = 0 ;

728 i‡((
pxi
 = 
psf
->
codec_d©a
Ë=
NULL
)

731 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

733 
Àn
 > 0)

734 { i‡(
Àn
 < 
buf„æí
)

735 
buf„æí
 = (Ë
Àn
 ;

736 
	`s2dsc_¨øy
 (
pxi
, 
±r
 + 
tŸÆ
, 
psf
->
u
.
scbuf
, 
buf„æí
) ;

737 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
scbuf
,  (sig√d ), 
buf„æí
,Ösf) ;

738 
tŸÆ
 +
wrôecou¡
 ;

739 i‡(
wrôecou¡
 < 
buf„æí
)

741 
Àn
 -
wrôecou¡
 ;

744  
tŸÆ
 ;

745 
	}
}

747 
sf_cou¡_t


748 
	$dpcm_wrôe_i2dsc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

749 { 
XI_PRIVATE
 *
pxi
 ;

750 
buf„æí
, 
wrôecou¡
 ;

751 
sf_cou¡_t
 
tŸÆ
 = 0 ;

753 i‡((
pxi
 = 
psf
->
codec_d©a
Ë=
NULL
)

756 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

758 
Àn
 > 0)

759 { i‡(
Àn
 < 
buf„æí
)

760 
buf„æí
 = (Ë
Àn
 ;

761 
	`i2dsc_¨øy
 (
pxi
, 
±r
 + 
tŸÆ
, 
psf
->
u
.
scbuf
, 
buf„æí
) ;

762 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
scbuf
,  (sig√d ), 
buf„æí
,Ösf) ;

763 
tŸÆ
 +
wrôecou¡
 ;

764 i‡(
wrôecou¡
 < 
buf„æí
)

766 
Àn
 -
wrôecou¡
 ;

769  
tŸÆ
 ;

770 
	}
}

772 
sf_cou¡_t


773 
	$dpcm_wrôe_f2dsc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

774 { 
XI_PRIVATE
 *
pxi
 ;

775 
buf„æí
, 
wrôecou¡
 ;

776 
sf_cou¡_t
 
tŸÆ
 = 0 ;

777 
n‹mÁ˘
 ;

779 i‡((
pxi
 = 
psf
->
codec_d©a
Ë=
NULL
)

782 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? (1.0 * 0x7F) : 1.0 ;

784 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

786 
Àn
 > 0)

787 { i‡(
Àn
 < 
buf„æí
)

788 
buf„æí
 = (Ë
Àn
 ;

789 
	`f2dsc_¨øy
 (
pxi
, 
±r
 + 
tŸÆ
, 
psf
->
u
.
scbuf
, 
buf„æí
, 
n‹mÁ˘
) ;

790 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
scbuf
,  (sig√d ), 
buf„æí
,Ösf) ;

791 
tŸÆ
 +
wrôecou¡
 ;

792 i‡(
wrôecou¡
 < 
buf„æí
)

794 
Àn
 -
wrôecou¡
 ;

797  
tŸÆ
 ;

798 
	}
}

800 
sf_cou¡_t


801 
	$dpcm_wrôe_d2dsc
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

802 { 
XI_PRIVATE
 *
pxi
 ;

803 
buf„æí
, 
wrôecou¡
 ;

804 
sf_cou¡_t
 
tŸÆ
 = 0 ;

805 
n‹mÁ˘
 ;

807 i‡((
pxi
 = 
psf
->
codec_d©a
Ë=
NULL
)

810 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? (1.0 * 0x7F) : 1.0 ;

812 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
ucbuf
) ;

814 
Àn
 > 0)

815 { i‡(
Àn
 < 
buf„æí
)

816 
buf„æí
 = (Ë
Àn
 ;

817 
	`d2dsc_¨øy
 (
pxi
, 
±r
 + 
tŸÆ
, 
psf
->
u
.
scbuf
, 
buf„æí
, 
n‹mÁ˘
) ;

818 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
scbuf
,  (sig√d ), 
buf„æí
,Ösf) ;

819 
tŸÆ
 +
wrôecou¡
 ;

820 i‡(
wrôecou¡
 < 
buf„æí
)

822 
Àn
 -
wrôecou¡
 ;

825  
tŸÆ
 ;

826 
	}
}

829 
sf_cou¡_t


830 
	$dpcm_wrôe_s2dÀs
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

831 { 
XI_PRIVATE
 *
pxi
 ;

832 
buf„æí
, 
wrôecou¡
 ;

833 
sf_cou¡_t
 
tŸÆ
 = 0 ;

835 i‡((
pxi
 = 
psf
->
codec_d©a
Ë=
NULL
)

838 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

840 
Àn
 > 0)

841 { i‡(
Àn
 < 
buf„æí
)

842 
buf„æí
 = (Ë
Àn
 ;

843 
	`s2dÀs_¨øy
 (
pxi
, 
±r
 + 
tŸÆ
, 
psf
->
u
.
sbuf
, 
buf„æí
) ;

844 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
sbuf
,  (), 
buf„æí
,Ösf) ;

845 
tŸÆ
 +
wrôecou¡
 ;

846 i‡(
wrôecou¡
 < 
buf„æí
)

848 
Àn
 -
wrôecou¡
 ;

851  
tŸÆ
 ;

852 
	}
}

854 
sf_cou¡_t


855 
	$dpcm_wrôe_i2dÀs
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

856 { 
XI_PRIVATE
 *
pxi
 ;

857 
buf„æí
, 
wrôecou¡
 ;

858 
sf_cou¡_t
 
tŸÆ
 = 0 ;

860 i‡((
pxi
 = 
psf
->
codec_d©a
Ë=
NULL
)

863 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

865 
Àn
 > 0)

866 { i‡(
Àn
 < 
buf„æí
)

867 
buf„æí
 = (Ë
Àn
 ;

868 
	`i2dÀs_¨øy
 (
pxi
, 
±r
 + 
tŸÆ
, 
psf
->
u
.
sbuf
, 
buf„æí
) ;

869 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
sbuf
,  (), 
buf„æí
,Ösf) ;

870 
tŸÆ
 +
wrôecou¡
 ;

871 i‡(
wrôecou¡
 < 
buf„æí
)

873 
Àn
 -
wrôecou¡
 ;

876  
tŸÆ
 ;

877 
	}
}

879 
sf_cou¡_t


880 
	$dpcm_wrôe_f2dÀs
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

881 { 
XI_PRIVATE
 *
pxi
 ;

882 
buf„æí
, 
wrôecou¡
 ;

883 
sf_cou¡_t
 
tŸÆ
 = 0 ;

884 
n‹mÁ˘
 ;

886 i‡((
pxi
 = 
psf
->
codec_d©a
Ë=
NULL
)

889 
n‹mÁ˘
 = (
psf
->
n‹m_Êﬂt
 =
SF_TRUE
) ? (1.0 * 0x7FFF) : 1.0 ;

891 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

893 
Àn
 > 0)

894 { i‡(
Àn
 < 
buf„æí
)

895 
buf„æí
 = (Ë
Àn
 ;

896 
	`f2dÀs_¨øy
 (
pxi
, 
±r
 + 
tŸÆ
, 
psf
->
u
.
sbuf
, 
buf„æí
, 
n‹mÁ˘
) ;

897 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
sbuf
,  (), 
buf„æí
,Ösf) ;

898 
tŸÆ
 +
wrôecou¡
 ;

899 i‡(
wrôecou¡
 < 
buf„æí
)

901 
Àn
 -
wrôecou¡
 ;

904  
tŸÆ
 ;

905 
	}
}

907 
sf_cou¡_t


908 
	$dpcm_wrôe_d2dÀs
 (
SF_PRIVATE
 *
psf
, c⁄° *
±r
, 
sf_cou¡_t
 
Àn
)

909 { 
XI_PRIVATE
 *
pxi
 ;

910 
buf„æí
, 
wrôecou¡
 ;

911 
sf_cou¡_t
 
tŸÆ
 = 0 ;

912 
n‹mÁ˘
 ;

914 i‡((
pxi
 = 
psf
->
codec_d©a
Ë=
NULL
)

917 
n‹mÁ˘
 = (
psf
->
n‹m_doubÀ
 =
SF_TRUE
) ? (1.0 * 0x7FFF) : 1.0 ;

919 
buf„æí
 = 
	`ARRAY_LEN
 (
psf
->
u
.
sbuf
) ;

921 
Àn
 > 0)

922 { i‡(
Àn
 < 
buf„æí
)

923 
buf„æí
 = (Ë
Àn
 ;

924 
	`d2dÀs_¨øy
 (
pxi
, 
±r
 + 
tŸÆ
, 
psf
->
u
.
sbuf
, 
buf„æí
, 
n‹mÁ˘
) ;

925 
wrôecou¡
 = 
	`psf_fwrôe
 (
psf
->
u
.
sbuf
,  (), 
buf„æí
,Ösf) ;

926 
tŸÆ
 +
wrôecou¡
 ;

927 i‡(
wrôecou¡
 < 
buf„æí
)

929 
Àn
 -
wrôecou¡
 ;

932  
tŸÆ
 ;

933 
	}
}

940 
	$dsc2s_¨øy
 (
XI_PRIVATE
 *
pxi
, sig√d *
§c
, 
cou¡
, *
de°
)

941 { sig√d 
œ°_vÆ
 ;

942 
k
 ;

944 
œ°_vÆ
 = 
pxi
->
œ°_16
 >> 8 ;

946 
k
 = 0 ; k < 
cou¡
 ; k++)

947 { 
œ°_vÆ
 +
§c
 [
k
] ;

948 
de°
 [
k
] = 
œ°_vÆ
 << 8 ;

951 
pxi
->
œ°_16
 = 
œ°_vÆ
 << 8 ;

952 
	}
}

955 
	$dsc2i_¨øy
 (
XI_PRIVATE
 *
pxi
, sig√d *
§c
, 
cou¡
, *
de°
)

956 { sig√d 
œ°_vÆ
 ;

957 
k
 ;

959 
œ°_vÆ
 = 
pxi
->
œ°_16
 >> 8 ;

961 
k
 = 0 ; k < 
cou¡
 ; k++)

962 { 
œ°_vÆ
 +
§c
 [
k
] ;

963 
de°
 [
k
] = 
œ°_vÆ
 << 24 ;

966 
pxi
->
œ°_16
 = 
œ°_vÆ
 << 8 ;

967 
	}
}

970 
	$dsc2f_¨øy
 (
XI_PRIVATE
 *
pxi
, sig√d *
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
)

971 { sig√d 
œ°_vÆ
 ;

972 
k
 ;

974 
œ°_vÆ
 = 
pxi
->
œ°_16
 >> 8 ;

976 
k
 = 0 ; k < 
cou¡
 ; k++)

977 { 
œ°_vÆ
 +
§c
 [
k
] ;

978 
de°
 [
k
] = 
œ°_vÆ
 * 
n‹mÁ˘
 ;

981 
pxi
->
œ°_16
 = 
œ°_vÆ
 << 8 ;

982 
	}
}

985 
	$dsc2d_¨øy
 (
XI_PRIVATE
 *
pxi
, sig√d *
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
)

986 { sig√d 
œ°_vÆ
 ;

987 
k
 ;

989 
œ°_vÆ
 = 
pxi
->
œ°_16
 >> 8 ;

991 
k
 = 0 ; k < 
cou¡
 ; k++)

992 { 
œ°_vÆ
 +
§c
 [
k
] ;

993 
de°
 [
k
] = 
œ°_vÆ
 * 
n‹mÁ˘
 ;

996 
pxi
->
œ°_16
 = 
œ°_vÆ
 << 8 ;

997 
	}
}

1003 
	$s2dsc_¨øy
 (
XI_PRIVATE
 *
pxi
, c⁄° *
§c
, sig√d *
de°
, 
cou¡
)

1004 { sig√d 
œ°_vÆ
, 
cuºít
 ;

1005 
k
 ;

1007 
œ°_vÆ
 = 
pxi
->
œ°_16
 >> 8 ;

1009 
k
 = 0 ; k < 
cou¡
 ; k++)

1010 { 
cuºít
 = 
§c
 [
k
] >> 8 ;

1011 
de°
 [
k
] = 
cuºít
 - 
œ°_vÆ
 ;

1012 
œ°_vÆ
 = 
cuºít
 ;

1015 
pxi
->
œ°_16
 = 
œ°_vÆ
 << 8 ;

1016 
	}
}

1019 
	$i2dsc_¨øy
 (
XI_PRIVATE
 *
pxi
, c⁄° *
§c
, sig√d *
de°
, 
cou¡
)

1020 { sig√d 
œ°_vÆ
, 
cuºít
 ;

1021 
k
 ;

1023 
œ°_vÆ
 = 
pxi
->
œ°_16
 >> 8 ;

1025 
k
 = 0 ; k < 
cou¡
 ; k++)

1026 { 
cuºít
 = 
§c
 [
k
] >> 24 ;

1027 
de°
 [
k
] = 
cuºít
 - 
œ°_vÆ
 ;

1028 
œ°_vÆ
 = 
cuºít
 ;

1031 
pxi
->
œ°_16
 = 
œ°_vÆ
 << 8 ;

1032 
	}
}

1035 
	$f2dsc_¨øy
 (
XI_PRIVATE
 *
pxi
, c⁄° *
§c
, sig√d *
de°
, 
cou¡
, 
n‹mÁ˘
)

1036 { sig√d 
œ°_vÆ
, 
cuºít
 ;

1037 
k
 ;

1039 
œ°_vÆ
 = 
pxi
->
œ°_16
 >> 8 ;

1041 
k
 = 0 ; k < 
cou¡
 ; k++)

1042 { 
cuºít
 = 
	`Ãötf
 (
§c
 [
k
] * 
n‹mÁ˘
) ;

1043 
de°
 [
k
] = 
cuºít
 - 
œ°_vÆ
 ;

1044 
œ°_vÆ
 = 
cuºít
 ;

1047 
pxi
->
œ°_16
 = 
œ°_vÆ
 << 8 ;

1048 
	}
}

1051 
	$d2dsc_¨øy
 (
XI_PRIVATE
 *
pxi
, c⁄° *
§c
, sig√d *
de°
, 
cou¡
, 
n‹mÁ˘
)

1052 { sig√d 
œ°_vÆ
, 
cuºít
 ;

1053 
k
 ;

1055 
œ°_vÆ
 = 
pxi
->
œ°_16
 >> 8 ;

1057 
k
 = 0 ; k < 
cou¡
 ; k++)

1058 { 
cuºít
 = 
	`Ãöt
 (
§c
 [
k
] * 
n‹mÁ˘
) ;

1059 
de°
 [
k
] = 
cuºít
 - 
œ°_vÆ
 ;

1060 
œ°_vÆ
 = 
cuºít
 ;

1063 
pxi
->
œ°_16
 = 
œ°_vÆ
 << 8 ;

1064 
	}
}

1070 
	$dÀs2s_¨øy
 (
XI_PRIVATE
 *
pxi
, *
§c
, 
cou¡
, *
de°
)

1071 { 
œ°_vÆ
 ;

1072 
k
 ;

1074 
œ°_vÆ
 = 
pxi
->
œ°_16
 ;

1076 
k
 = 0 ; k < 
cou¡
 ; k++)

1077 { 
œ°_vÆ
 +
	`LES2H_SHORT
 (
§c
 [
k
]) ;

1078 
de°
 [
k
] = 
œ°_vÆ
 ;

1081 
pxi
->
œ°_16
 = 
œ°_vÆ
 ;

1082 
	}
}

1085 
	$dÀs2i_¨øy
 (
XI_PRIVATE
 *
pxi
, *
§c
, 
cou¡
, *
de°
)

1086 { 
œ°_vÆ
 ;

1087 
k
 ;

1089 
œ°_vÆ
 = 
pxi
->
œ°_16
 ;

1091 
k
 = 0 ; k < 
cou¡
 ; k++)

1092 { 
œ°_vÆ
 +
	`LES2H_SHORT
 (
§c
 [
k
]) ;

1093 
de°
 [
k
] = 
œ°_vÆ
 << 16 ;

1096 
pxi
->
œ°_16
 = 
œ°_vÆ
 ;

1097 
	}
}

1100 
	$dÀs2f_¨øy
 (
XI_PRIVATE
 *
pxi
, *
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
)

1101 { 
œ°_vÆ
 ;

1102 
k
 ;

1104 
œ°_vÆ
 = 
pxi
->
œ°_16
 ;

1106 
k
 = 0 ; k < 
cou¡
 ; k++)

1107 { 
œ°_vÆ
 +
	`LES2H_SHORT
 (
§c
 [
k
]) ;

1108 
de°
 [
k
] = 
œ°_vÆ
 * 
n‹mÁ˘
 ;

1111 
pxi
->
œ°_16
 = 
œ°_vÆ
 ;

1112 
	}
}

1115 
	$dÀs2d_¨øy
 (
XI_PRIVATE
 *
pxi
, *
§c
, 
cou¡
, *
de°
, 
n‹mÁ˘
)

1116 { 
œ°_vÆ
 ;

1117 
k
 ;

1119 
œ°_vÆ
 = 
pxi
->
œ°_16
 ;

1121 
k
 = 0 ; k < 
cou¡
 ; k++)

1122 { 
œ°_vÆ
 +
	`LES2H_SHORT
 (
§c
 [
k
]) ;

1123 
de°
 [
k
] = 
œ°_vÆ
 * 
n‹mÁ˘
 ;

1126 
pxi
->
œ°_16
 = 
œ°_vÆ
 ;

1127 
	}
}

1133 
	$s2dÀs_¨øy
 (
XI_PRIVATE
 *
pxi
, c⁄° *
§c
, *
de°
, 
cou¡
)

1134 { 
diff
, 
œ°_vÆ
 ;

1135 
k
 ;

1137 
œ°_vÆ
 = 
pxi
->
œ°_16
 ;

1139 
k
 = 0 ; k < 
cou¡
 ; k++)

1140 { 
diff
 = 
§c
 [
k
] - 
œ°_vÆ
 ;

1141 
de°
 [
k
] = 
	`LES2H_SHORT
 (
diff
) ;

1142 
œ°_vÆ
 = 
§c
 [
k
] ;

1145 
pxi
->
œ°_16
 = 
œ°_vÆ
 ;

1146 
	}
}

1149 
	$i2dÀs_¨øy
 (
XI_PRIVATE
 *
pxi
, c⁄° *
§c
, *
de°
, 
cou¡
)

1150 { 
diff
, 
œ°_vÆ
 ;

1151 
k
 ;

1153 
œ°_vÆ
 = 
pxi
->
œ°_16
 ;

1155 
k
 = 0 ; k < 
cou¡
 ; k++)

1156 { 
diff
 = (
§c
 [
k
] >> 16Ë- 
œ°_vÆ
 ;

1157 
de°
 [
k
] = 
	`LES2H_SHORT
 (
diff
) ;

1158 
œ°_vÆ
 = 
§c
 [
k
] >> 16 ;

1161 
pxi
->
œ°_16
 = 
œ°_vÆ
 ;

1162 
	}
}

1165 
	$f2dÀs_¨øy
 (
XI_PRIVATE
 *
pxi
, c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÁ˘
)

1166 { 
diff
, 
œ°_vÆ
, 
cuºít
 ;

1167 
k
 ;

1169 
œ°_vÆ
 = 
pxi
->
œ°_16
 ;

1171 
k
 = 0 ; k < 
cou¡
 ; k++)

1172 { 
cuºít
 = 
	`Ãötf
 (
§c
 [
k
] * 
n‹mÁ˘
) ;

1173 
diff
 = 
cuºít
 - 
œ°_vÆ
 ;

1174 
de°
 [
k
] = 
	`LES2H_SHORT
 (
diff
) ;

1175 
œ°_vÆ
 = 
cuºít
 ;

1178 
pxi
->
œ°_16
 = 
œ°_vÆ
 ;

1179 
	}
}

1182 
	$d2dÀs_¨øy
 (
XI_PRIVATE
 *
pxi
, c⁄° *
§c
, *
de°
, 
cou¡
, 
n‹mÁ˘
)

1183 { 
diff
, 
œ°_vÆ
, 
cuºít
 ;

1184 
k
 ;

1186 
œ°_vÆ
 = 
pxi
->
œ°_16
 ;

1188 
k
 = 0 ; k < 
cou¡
 ; k++)

1189 { 
cuºít
 = 
	`Ãöt
 (
§c
 [
k
] * 
n‹mÁ˘
) ;

1190 
diff
 = 
cuºít
 - 
œ°_vÆ
 ;

1191 
de°
 [
k
] = 
	`LES2H_SHORT
 (
diff
) ;

1192 
œ°_vÆ
 = 
cuºít
 ;

1195 
pxi
->
œ°_16
 = 
œ°_vÆ
 ;

1196 
	}
}

	@libsndfile-1.0.17/tests/aiff_rw_test.c

20 
	~<°dio.h
>

21 
	~<°dlib.h
>

22 
	~<°rög.h
>

23 
	~<uni°d.h
>

24 
	~<m©h.h
>

26 
	~<¢dfûe.h
>

28 
	~"utûs.h
"

31 
	gaifc_d©a
 [] =

79 
rw_ã°
 (c⁄° *
fûíame
) ;

82 
	$maö
 ()

83 { c⁄° *
fûíame
 = "rw.aifc" ;

85 
	`¥öt_ã°_«me
 ("aiff_rw_ã°", 
fûíame
) ;

87 
	`dump_d©a_to_fûe
 (
fûíame
, 
aifc_d©a
,  (aifc_data)) ;

89 
	`rw_ã°
 (
fûíame
) ;

91 
	`u∆ök
 (
fûíame
) ;

93 
	`puts
 ("ok") ;

95 
	}
}

101 
	$rw_ã°
 (c⁄° *
fûíame
)

102 { 
SNDFILE
 *
fûe
 ;

103 
SF_INFO
 
sföfo_rd
, 
sföfo_rw
 ;

105 
	`mem£t
 (&
sföfo_rd
, 0,  (sfinfo_rd)) ;

106 
	`mem£t
 (&
sföfo_rw
, 0,  (sfinfo_rw)) ;

109 i‡((
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_READ
, &
sföfo_rd
)Ë=
NULL
)

110 { 
	`¥ötf
 ("\n\nLöê%d : sf_›í SFM_READ faûed : %s\n\n", 
__LINE__
, 
	`sf_°ªº‹
 (
NULL
)) ;

111 
	`exô
 (1) ;

113 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

114 
	`sf_˛o£
 (
fûe
) ;

117 i‡((
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_RDWR
, &
sföfo_rw
)Ë=
NULL
)

118 { 
	`¥ötf
 ("\n\nLöê%d : sf_›í SFM_RDWR faûed : %s\n\n", 
__LINE__
, 
	`sf_°ªº‹
 (
NULL
)) ;

119 
	`exô
 (1) ;

121 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

122 
	`sf_˛o£
 (
fûe
) ;

125 
	`mem£t
 (&
sföfo_rw
, 0,  (sfinfo_rw)) ;

126 i‡((
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_READ
, &
sföfo_rw
)Ë=
NULL
)

127 { 
	`¥ötf
 ("\n\nLöê%d : sf_›í SFM_RDWR faûed : %s\n\n", 
__LINE__
, 
	`sf_°ªº‹
 (
NULL
)) ;

128 
	`exô
 (1) ;

130 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

131 
	`sf_˛o£
 (
fûe
) ;

134 i‡(
sföfo_rd
.
f‹m©
 !
sföfo_rw
.format)

135 { 
	`¥ötf
 ("\n\nLöê%d : ch™√»cou¡ mism©ch (0x%08X !0x%08X).\n\n", 
__LINE__
,

136 
sföfo_rd
.
f‹m©
, 
sföfo_rw
.format) ;

137 
	`exô
 (1) ;

140 i‡(
sföfo_rd
.
ch™√ls
 !
sföfo_rw
.channels)

141 { 
	`¥ötf
 ("\n\nLöê%d : ch™√»cou¡ mism©ch (%d !%d).\n\n", 
__LINE__
,

142 
sföfo_rd
.
ch™√ls
, 
sföfo_rw
.channels) ;

143 
	`exô
 (1) ;

146 i‡(
sföfo_rd
.
‰ames
 !
sföfo_rw
.frames)

147 { 
	`¥ötf
 ("\n\nLöê%d : fømêcou¡ mism©ch (%ld !%ld).\n\n", 
__LINE__
,

148 
	`SF_COUNT_TO_LONG
 (
sföfo_rd
.
‰ames
), SF_COUNT_TO_LONG (
sföfo_rw
.frames)) ;

149 
	`exô
 (1) ;

153 
	}
}

	@libsndfile-1.0.17/tests/alaw_test.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

24 #i‡
HAVE_UNISTD_H


25 
	~<uni°d.h
>

28 
	~<¢dfûe.h
>

30 
	~"utûs.h
"

32 
	#BUFFER_SIZE
 (65536)

	)

34 
Æaw_ícode
 (
ßm∂e
) ;

35 
Æaw_decode
 (
Æawbyã
) ;

37 
	gsh‹t_buf„r
 [
BUFFER_SIZE
] ;

38 
	gÆaw_buf„r
 [
BUFFER_SIZE
] ;

41 
	$maö
 ()

42 { 
SNDFILE
 *
fûe
 ;

43 
SF_INFO
 
sföfo
 ;

44 c⁄° *
fûíame
 ;

45 
k
 ;

47 
fûíame
 = "test.raw" ;

49 
sföfo
.
f‹m©
 = 
SF_FORMAT_RAW
 | 
SF_FORMAT_ALAW
 ;

50 
sföfo
.
ßm∂î©e
 = 44100 ;

51 
sföfo
.
‰ames
 = 123456789 ;

52 
sföfo
.
ch™√ls
 = 1 ;

54 i‡((
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_WRITE
, &
sföfo
)Ë=
NULL
)

55 { 
	`¥ötf
 ("sf_open_write failed withÉrror : ") ;

56 
	`fÊush
 (
°dout
) ;

57 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

58 
	`exô
 (1) ;

65 
k
 = 0 ; k < 0x10000 ; k++)

66 
sh‹t_buf„r
 [
k
] = k & 0xFFFF ;

68 
	`sf_wrôe_sh‹t
 (
fûe
, 
sh‹t_buf„r
, 
BUFFER_SIZE
) ;

69 
	`sf_˛o£
 (
fûe
) ;

75 i‡((
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_READ
, &
sföfo
)Ë=
NULL
)

76 { 
	`¥ötf
 ("sf_open_write failed withÉrror : ") ;

77 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

78 
	`exô
 (1) ;

81 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

83 i‡(
	`sf_ªad_øw
 (
fûe
, 
Æaw_buf„r
, 
BUFFER_SIZE
) != BUFFER_SIZE)

84 { 
	`¥ötf
 ("sf_read_raw : ") ;

85 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

86 
	`exô
 (1) ;

89 
k
 = 0 ; k < 0x10000 ; k++)

90 i‡(
	`Æaw_ícode
 (
sh‹t_buf„r
 [
k
]Ë!
Æaw_buf„r
 [k])

91 { 
	`¥ötf
 ("EncodîÉº‹ : sam∂ê#%d (0x%02X should bê0x%02X)\n", 
k
, 
Æaw_buf„r
 [k], 
	`Æaw_ícode
 (
sh‹t_buf„r
 [k])) ;

92 
	`exô
 (1) ;

95 
	`sf_˛o£
 (
fûe
) ;

97 
	`¥ötf
 ("álaw_test :Éncoder ... ok\n") ;

103 i‡(! (
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_WRITE
, &
sföfo
)))

104 { 
	`¥ötf
 ("sf_open_write failed withÉrror : ") ;

105 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

106 
	`exô
 (1) ;

109 
k
 = 0 ; k < 256 ; k++)

110 
Æaw_buf„r
 [
k
] = k & 0xFF ;

112 
	`sf_wrôe_øw
 (
fûe
, 
Æaw_buf„r
, 256) ;

113 
	`sf_˛o£
 (
fûe
) ;

119 i‡(! (
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_READ
, &
sföfo
)))

120 { 
	`¥ötf
 ("sf_open_write failed withÉrror : ") ;

121 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

122 
	`exô
 (1) ;

125 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

127 i‡(
	`sf_ªad_sh‹t
 (
fûe
, 
sh‹t_buf„r
, 256) != 256)

128 { 
	`¥ötf
 ("sf_read_short : ") ;

129 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

130 
	`exô
 (1) ;

134 
k
 = 0 ; k < 256 ; k++)

135 i‡(
sh‹t_buf„r
 [
k
] !
	`Æaw_decode
 (
Æaw_buf„r
 [k]))

136 { 
	`¥ötf
 ("DecodîÉº‹ : sam∂ê#%d (0x%02X should bê0x%02X)\n", 
k
, 
sh‹t_buf„r
 [k], 
	`Æaw_decode
 (
Æaw_buf„r
 [k])) ;

137 
	`exô
 (1) ;

140 
	`sf_˛o£
 (
fûe
) ;

142 
	`¥ötf
 ("álaw_test : decoder ... ok\n") ;

144 
	`u∆ök
 (
fûíame
) ;

147 
	}
}

168 
	#ACLIP
 31744

	)

171 
	$Æaw_ícode
 (
ßm∂e
)

172 { 
exp_lut
 [128] =

191 
sign
, 
exp⁄ít
, 
m™tisß
 ;

192 
Aœwbyã
 ;

195 
sign
 = ((~
ßm∂e
) >> 8) & 0x80 ;

196 i‡(
sign
 == 0)

197 
ßm∂e
 = -sample ;

198 i‡(
ßm∂e
 > 
ACLIP
)

199 
ßm∂e
 = 
ACLIP
 ;

202 i‡(
ßm∂e
 >= 256)

203 { 
exp⁄ít
 = 
exp_lut
 [(
ßm∂e
 >> 8) & 0x7F] ;

204 
m™tisß
 = ( 
ßm∂e
 >> ( 
exp⁄ít
 + 3 ) ) & 0x0F ;

205 
Aœwbyã
 = ((
exp⁄ít
 << 4Ë| 
m™tisß
) ;

208 
Aœwbyã
 = (
ßm∂e
 >> 4) ;

210 
Aœwbyã
 ^(
sign
 ^ 0x55) ;

212  
Aœwbyã
 ;

213 
	}
}

216 
	$Æaw_decode
 (
Aœwbyã
)

217 { 
exp_lut
 [8] = { 0, 264, 528, 1056, 2112, 4224, 8448, 16896 } ;

218 
sign
, 
exp⁄ít
, 
m™tisß
, 
ßm∂e
 ;

220 
Aœwbyã
 ^= 0x55 ;

221 
sign
 = (
Aœwbyã
 & 0x80) ;

222 
Aœwbyã
 &= 0x7f ;

223 i‡(
Aœwbyã
 >= 16)

224 { 
exp⁄ít
 = (
Aœwbyã
 >> 4 ) & 0x07 ;

225 
m™tisß
 = 
Aœwbyã
 & 0x0F ;

226 
ßm∂e
 = 
exp_lut
 [
exp⁄ít
] + (
m™tisß
 << (Éxponent + 3 )) ;

229 
ßm∂e
 = (
Aœwbyã
 << 4) + 8 ;

230 i‡(
sign
 == 0)

231 
ßm∂e
 = -sample ;

233  
ßm∂e
 ;

234 
	}
}

	@libsndfile-1.0.17/tests/benchmark.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

24 #i‡
HAVE_UNISTD_H


25 
	~<uni°d.h
>

28 #i‡(
HAVE_DECL_S_IRGRP
 == 0)

29 
	~<sf_uni°d.h
>

32 
	~<°rög.h
>

33 
	~<m©h.h
>

34 
	~<time.h
>

35 
	~<f˙é.h
>

36 
	~<sys/°©.h
>

38 
	~<¢dfûe.h
>

40 #i‚def 
M_PI


41 
	#M_PI
 3.14159265358979323846264338

	)

44 #i‡(
deföed
 (
WIN32
Ë|| deföed (
_WIN32
))

45 
	#WRITE_FLAGS
 (
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 | 
O_BINARY
)

	)

46 
	#READ_FLAGS
 (
O_RDONLY
 | 
O_BINARY
)

	)

47 
	#WRITE_PERMS
 0777

	)

49 
	#WRITE_FLAGS
 (
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
)

	)

50 
	#READ_FLAGS
 (
O_RDONLY
)

	)

51 
	#WRITE_PERMS
 (
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
)

	)

54 
	#BUFFER_SIZE
 (1<<18)

	)

55 
	#BLOCK_COUNT
 (30)

	)

56 
	#TEST_DURATION
 (5Ë

	)

59 { 
	mwrôe_øã
 ;

60 
	mªad_øã
 ;

61 } 
	tPERF_STATS
 ;

63 *
	gd©a
 = 
NULL
 ;

65 
ˇlc_øw_≥rf‹m™˚
 (
PERF_STATS
 *
°©s
) ;

67 
ˇlc_sh‹t_≥rf‹m™˚
 (
f‹m©
, 
ªad_øã
, 
wrôe_øã
) ;

68 
ˇlc_öt_≥rf‹m™˚
 (
f‹m©
, 
ªad_øã
, 
wrôe_øã
) ;

69 
ˇlc_Êﬂt_≥rf‹m™˚
 (
f‹m©
, 
ªad_øã
, 
wrôe_øã
) ;

72 
˝u_is_big_ídün
 () ;

74 c⁄° * 
gë_subty≥_°r
 (
subty≥
) ;

77 
	$maö
 (
¨gc
, *
¨gv
 [])

78 { 
PERF_STATS
 
°©s
 ;

79 
buf„r
 [256] = "Benchmarking " ;

80 
f‹m©_maj‹
 ;

82 i‡(! (
d©a
 = 
	`mÆloc
 (
BUFFER_SIZE
 *  ())))

83 { 
	`≥º‹
 ("Error : malloc failed") ;

84 
	`exô
 (1) ;

87 
	`sf_comm™d
 (
NULL
, 
SFC_GET_LIB_VERSION
, 
buf„r
 + 
	`°æí
 (buffer),  (buffer) - strlen (buffer)) ;

89 
	`puts
 (
buf„r
) ;

90 
	`mem£t
 (
buf„r
, '-', 
	`°æí
 (buffer)) ;

91 
	`puts
 (
buf„r
) ;

92 
	`¥ötf
 ("EachÅe°Åake†®lôéêovî %d sec⁄ds.\n\n", 
TEST_DURATION
) ;

94 
	`ˇlc_øw_≥rf‹m™˚
 (&
°©s
) ;

96 i‡(
¨gc
 < 2 || 
	`°rcmp
 ("--«tive-⁄ly", 
¨gv
 [1]) == 0)

97 { 
	`puts
 ("\nNativeÉndian I/O :") ;

98 
f‹m©_maj‹
 = 
	`˝u_is_big_ídün
 (Ë? 
SF_FORMAT_AIFF
 : 
SF_FORMAT_WAV
 ;

100 
	`ˇlc_sh‹t_≥rf‹m™˚
 (
f‹m©_maj‹
 | 
SF_FORMAT_PCM_16
, 
°©s
.
ªad_øã
, sèts.
wrôe_øã
) ;

101 
	`ˇlc_öt_≥rf‹m™˚
 (
f‹m©_maj‹
 | 
SF_FORMAT_PCM_24
, 
°©s
.
ªad_øã
, sèts.
wrôe_øã
) ;

102 
	`ˇlc_öt_≥rf‹m™˚
 (
f‹m©_maj‹
 | 
SF_FORMAT_PCM_32
, 
°©s
.
ªad_øã
, sèts.
wrôe_øã
) ;

103 
	`ˇlc_Êﬂt_≥rf‹m™˚
 (
f‹m©_maj‹
 | 
SF_FORMAT_PCM_16
, 
°©s
.
ªad_øã
, sèts.
wrôe_øã
) ;

104 
	`ˇlc_Êﬂt_≥rf‹m™˚
 (
f‹m©_maj‹
 | 
SF_FORMAT_PCM_24
, 
°©s
.
ªad_øã
, sèts.
wrôe_øã
) ;

105 
	`ˇlc_Êﬂt_≥rf‹m™˚
 (
f‹m©_maj‹
 | 
SF_FORMAT_PCM_32
, 
°©s
.
ªad_øã
, sèts.
wrôe_øã
) ;

106 
	`ˇlc_Êﬂt_≥rf‹m™˚
 (
f‹m©_maj‹
 | 
SF_FORMAT_FLOAT
 , 
°©s
.
ªad_øã
, sèts.
wrôe_øã
) ;

109 i‡(
¨gc
 < 2 || 
	`°rcmp
 ("--sw≠-⁄ly", 
¨gv
 [1]) == 0)

110 { 
	`puts
 ("\nEndian swapped I/O :") ;

111 
f‹m©_maj‹
 = 
	`˝u_is_big_ídün
 (Ë? 
SF_FORMAT_WAV
 : 
SF_FORMAT_AIFF
 ;

113 
	`ˇlc_sh‹t_≥rf‹m™˚
 (
f‹m©_maj‹
 | 
SF_FORMAT_PCM_16
, 
°©s
.
ªad_øã
, sèts.
wrôe_øã
) ;

114 
	`ˇlc_öt_≥rf‹m™˚
 (
f‹m©_maj‹
 | 
SF_FORMAT_PCM_24
, 
°©s
.
ªad_øã
, sèts.
wrôe_øã
) ;

115 
	`ˇlc_öt_≥rf‹m™˚
 (
f‹m©_maj‹
 | 
SF_FORMAT_PCM_32
, 
°©s
.
ªad_øã
, sèts.
wrôe_øã
) ;

116 
	`ˇlc_Êﬂt_≥rf‹m™˚
 (
f‹m©_maj‹
 | 
SF_FORMAT_PCM_16
, 
°©s
.
ªad_øã
, sèts.
wrôe_øã
) ;

117 
	`ˇlc_Êﬂt_≥rf‹m™˚
 (
f‹m©_maj‹
 | 
SF_FORMAT_PCM_24
, 
°©s
.
ªad_øã
, sèts.
wrôe_øã
) ;

118 
	`ˇlc_Êﬂt_≥rf‹m™˚
 (
f‹m©_maj‹
 | 
SF_FORMAT_PCM_32
, 
°©s
.
ªad_øã
, sèts.
wrôe_øã
) ;

119 
	`ˇlc_Êﬂt_≥rf‹m™˚
 (
f‹m©_maj‹
 | 
SF_FORMAT_FLOAT
 , 
°©s
.
ªad_øã
, sèts.
wrôe_øã
) ;

122 
	`puts
 ("") ;

124 
	`‰ì
 (
d©a
) ;

127 
	}
}

133 
	$ˇlc_øw_≥rf‹m™˚
 (
PERF_STATS
 *
°©s
)

134 { 
˛ock_t
 
°¨t_˛ock
, 
˛ock_time
 ;

135 
fd
, 
k
, 
byã_cou¡
, 
ªtvÆ
, 
›_cou¡
 ;

136 c⁄° *
fûíame
 ;

138 
fûíame
 = "benchmark.dat" ;

140 
byã_cou¡
 = 
BUFFER_SIZE
 *  () ;

143 
	`¥ötf
 (" Raw write PCM_16 : ") ;

144 
	`fÊush
 (
°dout
) ;

146 
˛ock_time
 = 0 ;

147 
›_cou¡
 = 0 ;

148 
°¨t_˛ock
 = 
	`˛ock
 () ;

150 
˛ock_time
 < (
CLOCKS_PER_SEC
 * 
TEST_DURATION
))

151 { i‡((
fd
 = 
	`›í
 (
fûíame
, 
WRITE_FLAGS
, 
WRITE_PERMS
)) < 0)

152 { 
	`¥ötf
 ("Eº‹ :ÇŸábÀÅÿ›í fûê: %s\n", 
fûíame
) ;

153 
	`≥º‹
 ("") ;

154 
	`exô
 (1) ;

157 
k
 = 0 ; k < 
BLOCK_COUNT
 ; k++)

158 { i‡((
ªtvÆ
 = 
	`wrôe
 (
fd
, 
d©a
, 
byã_cou¡
)) != byte_count)

159 { 
	`¥ötf
 ("Eº‹ : wrôêªtu∫ed %d (should havêbì¿%d)\n", 
ªtvÆ
, 
byã_cou¡
) ;

160 
	`exô
 (1) ;

164 
	`˛o£
 (
fd
) ;

166 
˛ock_time
 = 
	`˛ock
 (Ë- 
°¨t_˛ock
 ;

167 
›_cou¡
 ++ ;

170 
°©s
->
wrôe_øã
 = (1.0 * 
BUFFER_SIZE
Ë* 
BLOCK_COUNT
 * 
›_cou¡
 ;

171 
°©s
->
wrôe_øã
 *(1.0 * 
CLOCKS_PER_SEC
Ë/ 
˛ock_time
 ;

172 
	`¥ötf
 ("%10.0‡ßm∂e†≥∏£c\n", 
°©s
->
wrôe_øã
) ;

175 
	`¥ötf
 (" RawÑead PCM_16 : ") ;

176 
	`fÊush
 (
°dout
) ;

178 
˛ock_time
 = 0 ;

179 
›_cou¡
 = 0 ;

180 
°¨t_˛ock
 = 
	`˛ock
 () ;

182 
˛ock_time
 < (
CLOCKS_PER_SEC
 * 
TEST_DURATION
))

183 { i‡((
fd
 = 
	`›í
 (
fûíame
, 
READ_FLAGS
)) < 0)

184 { 
	`¥ötf
 ("Eº‹ :ÇŸábÀÅÿ›í fûê: %s\n", 
fûíame
) ;

185 
	`≥º‹
 ("") ;

186 
	`exô
 (1) ;

189 
k
 = 0 ; k < 
BLOCK_COUNT
 ; k++)

190 { i‡((
ªtvÆ
 = 
	`ªad
 (
fd
, 
d©a
, 
byã_cou¡
)) != byte_count)

191 { 
	`¥ötf
 ("Eº‹ : wrôêªtu∫ed %d (should havêbì¿%d)\n", 
ªtvÆ
, 
byã_cou¡
) ;

192 
	`exô
 (1) ;

196 
	`˛o£
 (
fd
) ;

198 
˛ock_time
 = 
	`˛ock
 (Ë- 
°¨t_˛ock
 ;

199 
›_cou¡
 ++ ;

202 
°©s
->
ªad_øã
 = (1.0 * 
BUFFER_SIZE
Ë* 
BLOCK_COUNT
 * 
›_cou¡
 ;

203 
°©s
->
ªad_øã
 *(1.0 * 
CLOCKS_PER_SEC
Ë/ 
˛ock_time
 ;

204 
	`¥ötf
 ("%10.0‡ßm∂e†≥∏£c\n", 
°©s
->
ªad_øã
) ;

206 
	`u∆ök
 (
fûíame
) ;

207 
	}
}

213 
	$ˇlc_sh‹t_≥rf‹m™˚
 (
f‹m©
, 
ªad_øã
, 
wrôe_øã
)

214 { 
SNDFILE
 *
fûe
 ;

215 
SF_INFO
 
sföfo
 ;

216 
˛ock_t
 
°¨t_˛ock
, 
˛ock_time
 ;

217 
≥rf‹m™˚
 ;

218 
k
, 
ôem_cou¡
, 
ªtvÆ
, 
›_cou¡
 ;

219 c⁄° * 
subty≥
 ;

220 *
sh‹t_d©a
 ;

221 c⁄° *
fûíame
 ;

223 
fûíame
 = "benchmark.dat" ;

224 
subty≥
 = 
	`gë_subty≥_°r
 (
f‹m©
 & 
SF_FORMAT_SUBMASK
) ;

226 
sh‹t_d©a
 = 
d©a
 ;

227 
ôem_cou¡
 = 
BUFFER_SIZE
 ;

228 
k
 = 0 ; k < 
ôem_cou¡
 ; k++)

229 
sh‹t_d©a
 [
k
] = 32700.0 * 
	`sö
 (2 * 
M_PI
 * k / 32000.0) ;

232 
	`¥ötf
 (" Wrôê%-5†Åÿ %†: ", "sh‹t", 
subty≥
) ;

233 
	`fÊush
 (
°dout
) ;

235 
sföfo
.
ch™√ls
 = 1 ;

236 
sföfo
.
f‹m©
 = format ;

237 
sföfo
.
‰ames
 = 1 ;

238 
sföfo
.
ßm∂î©e
 = 32000 ;

240 
˛ock_time
 = 0 ;

241 
›_cou¡
 = 0 ;

242 
°¨t_˛ock
 = 
	`˛ock
 () ;

244 
˛ock_time
 < (
CLOCKS_PER_SEC
 * 
TEST_DURATION
))

245 { i‡(! (
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_WRITE
, &
sföfo
)))

246 { 
	`¥ötf
 ("Eº‹ :ÇŸábÀÅÿ›í fûê: %s\n", 
fûíame
) ;

247 
	`≥º‹
 ("") ;

248 
	`exô
 (1) ;

252 
	`sf_comm™d
 (
fûe
, 
SFC_SET_ADD_PEAK_CHUNK
, 
NULL
, 
SF_FALSE
) ;

254 
k
 = 0 ; k < 
BLOCK_COUNT
 ; k++)

255 { i‡((
ªtvÆ
 = 
	`sf_wrôe_sh‹t
 (
fûe
, 
sh‹t_d©a
, 
ôem_cou¡
)) != item_count)

256 { 
	`¥ötf
 ("Eº‹ : sf_wrôe_sh‹àªtu∫ed %d (should havêbì¿%d)\n", 
ªtvÆ
, 
ôem_cou¡
) ;

257 
	`exô
 (1) ;

261 
	`sf_˛o£
 (
fûe
) ;

263 
˛ock_time
 = 
	`˛ock
 (Ë- 
°¨t_˛ock
 ;

264 
›_cou¡
 ++ ;

267 
≥rf‹m™˚
 = (1.0 * 
BUFFER_SIZE
Ë* 
BLOCK_COUNT
 * 
›_cou¡
 ;

268 
≥rf‹m™˚
 *(1.0 * 
CLOCKS_PER_SEC
Ë/ 
˛ock_time
 ;

269 
	`¥ötf
 ("%6.2f%% o‡øw wrôe\n", 100.0 * 
≥rf‹m™˚
 / 
wrôe_øã
) ;

272 
	`¥ötf
 (" Ród %-5† from %†: ", "sh‹t", 
subty≥
) ;

273 
	`fÊush
 (
°dout
) ;

275 
˛ock_time
 = 0 ;

276 
›_cou¡
 = 0 ;

277 
°¨t_˛ock
 = 
	`˛ock
 () ;

279 
˛ock_time
 < (
CLOCKS_PER_SEC
 * 
TEST_DURATION
))

280 { i‡(! (
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_READ
, &
sföfo
)))

281 { 
	`¥ötf
 ("Eº‹ :ÇŸábÀÅÿ›í fûê: %s\n", 
fûíame
) ;

282 
	`≥º‹
 ("") ;

283 
	`exô
 (1) ;

286 
k
 = 0 ; k < 
BLOCK_COUNT
 ; k++)

287 { i‡((
ªtvÆ
 = 
	`sf_ªad_sh‹t
 (
fûe
, 
sh‹t_d©a
, 
ôem_cou¡
)) != item_count)

288 { 
	`¥ötf
 ("Eº‹ : wrôêªtu∫ed %d (should havêbì¿%d)\n", 
ªtvÆ
, 
ôem_cou¡
) ;

289 
	`exô
 (1) ;

293 
	`sf_˛o£
 (
fûe
) ;

295 
˛ock_time
 = 
	`˛ock
 (Ë- 
°¨t_˛ock
 ;

296 
›_cou¡
 ++ ;

299 
≥rf‹m™˚
 = (1.0 * 
ôem_cou¡
Ë* 
BLOCK_COUNT
 * 
›_cou¡
 ;

300 
≥rf‹m™˚
 *(1.0 * 
CLOCKS_PER_SEC
Ë/ 
˛ock_time
 ;

301 
	`¥ötf
 ("%6.2f%% o‡øwÑód\n", 100.0 * 
≥rf‹m™˚
 / 
ªad_øã
) ;

303 
	`u∆ök
 (
fûíame
) ;

305 
	}
}

307 
	$ˇlc_öt_≥rf‹m™˚
 (
f‹m©
, 
ªad_øã
, 
wrôe_øã
)

308 { 
SNDFILE
 *
fûe
 ;

309 
SF_INFO
 
sföfo
 ;

310 
˛ock_t
 
°¨t_˛ock
, 
˛ock_time
 ;

311 
≥rf‹m™˚
 ;

312 
k
, 
ôem_cou¡
, 
ªtvÆ
, 
›_cou¡
 ;

313 c⁄° * 
subty≥
 ;

314 *
öt_d©a
 ;

315 c⁄° *
fûíame
 ;

317 
fûíame
 = "benchmark.dat" ;

318 
subty≥
 = 
	`gë_subty≥_°r
 (
f‹m©
 & 
SF_FORMAT_SUBMASK
) ;

320 
öt_d©a
 = 
d©a
 ;

321 
ôem_cou¡
 = 
BUFFER_SIZE
 ;

322 
k
 = 0 ; k < 
ôem_cou¡
 ; k++)

323 
öt_d©a
 [
k
] = 32700.0 * (1<<16Ë* 
	`sö
 (2 * 
M_PI
 * k / 32000.0) ;

326 
	`¥ötf
 (" Wrôê%-5†Åÿ %†: ", "öt", 
subty≥
) ;

327 
	`fÊush
 (
°dout
) ;

329 
sföfo
.
ch™√ls
 = 1 ;

330 
sföfo
.
f‹m©
 = format ;

331 
sföfo
.
‰ames
 = 1 ;

332 
sföfo
.
ßm∂î©e
 = 32000 ;

334 
˛ock_time
 = 0 ;

335 
›_cou¡
 = 0 ;

336 
°¨t_˛ock
 = 
	`˛ock
 () ;

338 
˛ock_time
 < (
CLOCKS_PER_SEC
 * 
TEST_DURATION
))

339 { i‡(! (
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_WRITE
, &
sföfo
)))

340 { 
	`¥ötf
 ("Eº‹ :ÇŸábÀÅÿ›í fûê: %s\n", 
fûíame
) ;

341 
	`≥º‹
 ("") ;

342 
	`exô
 (1) ;

346 
	`sf_comm™d
 (
fûe
, 
SFC_SET_ADD_PEAK_CHUNK
, 
NULL
, 
SF_FALSE
) ;

348 
k
 = 0 ; k < 
BLOCK_COUNT
 ; k++)

349 { i‡((
ªtvÆ
 = 
	`sf_wrôe_öt
 (
fûe
, 
öt_d©a
, 
ôem_cou¡
)) != item_count)

350 { 
	`¥ötf
 ("Eº‹ : sf_wrôe_sh‹àªtu∫ed %d (should havêbì¿%d)\n", 
ªtvÆ
, 
ôem_cou¡
) ;

351 
	`exô
 (1) ;

355 
	`sf_˛o£
 (
fûe
) ;

357 
˛ock_time
 = 
	`˛ock
 (Ë- 
°¨t_˛ock
 ;

358 
›_cou¡
 ++ ;

361 
≥rf‹m™˚
 = (1.0 * 
BUFFER_SIZE
Ë* 
BLOCK_COUNT
 * 
›_cou¡
 ;

362 
≥rf‹m™˚
 *(1.0 * 
CLOCKS_PER_SEC
Ë/ 
˛ock_time
 ;

363 
	`¥ötf
 ("%6.2f%% o‡øw wrôe\n", 100.0 * 
≥rf‹m™˚
 / 
wrôe_øã
) ;

366 
	`¥ötf
 (" Ród %-5† from %†: ", "öt", 
subty≥
) ;

367 
	`fÊush
 (
°dout
) ;

369 
˛ock_time
 = 0 ;

370 
›_cou¡
 = 0 ;

371 
°¨t_˛ock
 = 
	`˛ock
 () ;

373 
˛ock_time
 < (
CLOCKS_PER_SEC
 * 
TEST_DURATION
))

374 { i‡(! (
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_READ
, &
sföfo
)))

375 { 
	`¥ötf
 ("Eº‹ :ÇŸábÀÅÿ›í fûê: %s\n", 
fûíame
) ;

376 
	`≥º‹
 ("") ;

377 
	`exô
 (1) ;

380 
k
 = 0 ; k < 
BLOCK_COUNT
 ; k++)

381 { i‡((
ªtvÆ
 = 
	`sf_ªad_öt
 (
fûe
, 
öt_d©a
, 
ôem_cou¡
)) != item_count)

382 { 
	`¥ötf
 ("Eº‹ : wrôêªtu∫ed %d (should havêbì¿%d)\n", 
ªtvÆ
, 
ôem_cou¡
) ;

383 
	`exô
 (1) ;

387 
	`sf_˛o£
 (
fûe
) ;

389 
˛ock_time
 = 
	`˛ock
 (Ë- 
°¨t_˛ock
 ;

390 
›_cou¡
 ++ ;

393 
≥rf‹m™˚
 = (1.0 * 
ôem_cou¡
Ë* 
BLOCK_COUNT
 * 
›_cou¡
 ;

394 
≥rf‹m™˚
 *(1.0 * 
CLOCKS_PER_SEC
Ë/ 
˛ock_time
 ;

395 
	`¥ötf
 ("%6.2f%% o‡øwÑód\n", 100.0 * 
≥rf‹m™˚
 / 
ªad_øã
) ;

397 
	`u∆ök
 (
fûíame
) ;

399 
	}
}

401 
	$ˇlc_Êﬂt_≥rf‹m™˚
 (
f‹m©
, 
ªad_øã
, 
wrôe_øã
)

402 { 
SNDFILE
 *
fûe
 ;

403 
SF_INFO
 
sföfo
 ;

404 
˛ock_t
 
°¨t_˛ock
, 
˛ock_time
 ;

405 
≥rf‹m™˚
 ;

406 
k
, 
ôem_cou¡
, 
ªtvÆ
, 
›_cou¡
 ;

407 c⁄° * 
subty≥
 ;

408 *
Êﬂt_d©a
 ;

409 c⁄° *
fûíame
 ;

411 
fûíame
 = "benchmark.dat" ;

412 
subty≥
 = 
	`gë_subty≥_°r
 (
f‹m©
 & 
SF_FORMAT_SUBMASK
) ;

414 
Êﬂt_d©a
 = 
d©a
 ;

415 
ôem_cou¡
 = 
BUFFER_SIZE
 ;

416 
k
 = 0 ; k < 
ôem_cou¡
 ; k++)

417 
Êﬂt_d©a
 [
k
] = 1.0 * 
	`sö
 (2 * 
M_PI
 * k / 32000.0) ;

420 
	`¥ötf
 (" Wrôê%-5†Åÿ %†: ", "Êﬂt", 
subty≥
) ;

421 
	`fÊush
 (
°dout
) ;

423 
sföfo
.
ch™√ls
 = 1 ;

424 
sföfo
.
f‹m©
 = format ;

425 
sföfo
.
‰ames
 = 1 ;

426 
sföfo
.
ßm∂î©e
 = 32000 ;

428 
˛ock_time
 = 0 ;

429 
›_cou¡
 = 0 ;

430 
°¨t_˛ock
 = 
	`˛ock
 () ;

432 
˛ock_time
 < (
CLOCKS_PER_SEC
 * 
TEST_DURATION
))

433 { i‡(! (
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_WRITE
, &
sföfo
)))

434 { 
	`¥ötf
 ("Eº‹ :ÇŸábÀÅÿ›í fûê: %s\n", 
fûíame
) ;

435 
	`≥º‹
 ("") ;

436 
	`exô
 (1) ;

440 
	`sf_comm™d
 (
fûe
, 
SFC_SET_ADD_PEAK_CHUNK
, 
NULL
, 
SF_FALSE
) ;

442 
k
 = 0 ; k < 
BLOCK_COUNT
 ; k++)

443 { i‡((
ªtvÆ
 = 
	`sf_wrôe_Êﬂt
 (
fûe
, 
Êﬂt_d©a
, 
ôem_cou¡
)) != item_count)

444 { 
	`¥ötf
 ("Eº‹ : sf_wrôe_sh‹àªtu∫ed %d (should havêbì¿%d)\n", 
ªtvÆ
, 
ôem_cou¡
) ;

445 
	`exô
 (1) ;

449 
	`sf_˛o£
 (
fûe
) ;

451 
˛ock_time
 = 
	`˛ock
 (Ë- 
°¨t_˛ock
 ;

452 
›_cou¡
 ++ ;

455 
≥rf‹m™˚
 = (1.0 * 
BUFFER_SIZE
Ë* 
BLOCK_COUNT
 * 
›_cou¡
 ;

456 
≥rf‹m™˚
 *(1.0 * 
CLOCKS_PER_SEC
Ë/ 
˛ock_time
 ;

457 
	`¥ötf
 ("%6.2f%% o‡øw wrôe\n", 100.0 * 
≥rf‹m™˚
 / 
wrôe_øã
) ;

460 
	`¥ötf
 (" Ród %-5† from %†: ", "Êﬂt", 
subty≥
) ;

461 
	`fÊush
 (
°dout
) ;

463 
˛ock_time
 = 0 ;

464 
›_cou¡
 = 0 ;

465 
°¨t_˛ock
 = 
	`˛ock
 () ;

467 
˛ock_time
 < (
CLOCKS_PER_SEC
 * 
TEST_DURATION
))

468 { i‡(! (
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_READ
, &
sföfo
)))

469 { 
	`¥ötf
 ("Eº‹ :ÇŸábÀÅÿ›í fûê: %s\n", 
fûíame
) ;

470 
	`≥º‹
 ("") ;

471 
	`exô
 (1) ;

474 
k
 = 0 ; k < 
BLOCK_COUNT
 ; k++)

475 { i‡((
ªtvÆ
 = 
	`sf_ªad_Êﬂt
 (
fûe
, 
Êﬂt_d©a
, 
ôem_cou¡
)) != item_count)

476 { 
	`¥ötf
 ("Eº‹ : wrôêªtu∫ed %d (should havêbì¿%d)\n", 
ªtvÆ
, 
ôem_cou¡
) ;

477 
	`exô
 (1) ;

481 
	`sf_˛o£
 (
fûe
) ;

483 
˛ock_time
 = 
	`˛ock
 (Ë- 
°¨t_˛ock
 ;

484 
›_cou¡
 ++ ;

487 
≥rf‹m™˚
 = (1.0 * 
ôem_cou¡
Ë* 
BLOCK_COUNT
 * 
›_cou¡
 ;

488 
≥rf‹m™˚
 *(1.0 * 
CLOCKS_PER_SEC
Ë/ 
˛ock_time
 ;

489 
	`¥ötf
 ("%6.2f%% o‡øwÑód\n", 100.0 * 
≥rf‹m™˚
 / 
ªad_øã
) ;

491 
	`u∆ök
 (
fûíame
) ;

493 
	}
}

500 
	$˝u_is_big_ídün
 ()

501 { *
˝å
 ;

502 
ídã°
 ;

504 
ídã°
 = 0x12345678 ;

506 
˝å
 = (*Ë(&
ídã°
) ;

508 i‡(
˝å
 [0] == 0x12 && cptr [1] == 0x34 && cptr [3] == 0x78)

509  
SF_TRUE
 ;

511  
SF_FALSE
 ;

512 
	}
}

515 
	$gë_subty≥_°r
 (
subty≥
)

516 { 
subty≥
)

517 { 
SF_FORMAT_PCM_16
 :

520 
SF_FORMAT_PCM_24
 :

523 
SF_FORMAT_PCM_32
 :

526 
SF_FORMAT_FLOAT
 :

529 
SF_FORMAT_DOUBLE
 :

536 
	}
}

	@libsndfile-1.0.17/tests/command_test.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

24 
	~<time.h
>

26 #i‡
HAVE_UNISTD_H


27 
	~<uni°d.h
>

30 
	~<m©h.h
>

32 
	~<¢dfûe.h
>

34 
	~"utûs.h
"

36 
	#BUFFER_LEN
 (1<<10)

	)

37 
	#LOG_BUFFER_SIZE
 1024

	)

39 
Êﬂt_n‹m_ã°
 (c⁄° *
fûíame
) ;

40 
doubÀ_n‹m_ã°
 (c⁄° *
fûíame
) ;

41 
f‹m©_ã°s
 () ;

42 
ˇlc_≥ak_ã°
 (
fûëy≥
, c⁄° *
fûíame
) ;

43 
åunˇã_ã°
 (c⁄° *
fûíame
, 
fûëy≥
) ;

44 
ö°rumít_ã°
 (c⁄° *
fûíame
, 
fûëy≥
) ;

45 
ch™√l_m≠_ã°
 (c⁄° *
fûíame
, 
fûëy≥
) ;

46 
brﬂdˇ°_ã°
 (c⁄° *
fûíame
, 
fûëy≥
) ;

52 
	göt_d©a
 [
BUFFER_LEN
] ;

53 
	gÊﬂt_d©a
 [
BUFFER_LEN
] ;

54 
	gdoubÀ_d©a
 [
BUFFER_LEN
] ;

57 
	$maö
 (
¨gc
, *
¨gv
 [])

58 { 
do_Æl
 = 0 ;

59 
ã°_cou¡
 = 0 ;

61 i‡(
¨gc
 != 2)

62 { 
	`¥ötf
 ("Ußgê: %†<ã°>\n", 
¨gv
 [0]) ;

63 
	`¥ötf
 (" Where <test> is one ofÅhe following:\n") ;

64 
	`¥ötf
 (" ver -Åest sf_command (SFC_GETLIB_VERSION)\n") ;

65 
	`¥ötf
 ("Çorm -Åest floatingÖointÇormalisation\n") ;

66 
	`¥ötf
 (" format -Åest format string commands\n") ;

67 
	`¥ötf
 ("Öeak -ÅestÖeak calculation\n") ;

68 
	`¥ötf
 ("Årunc -Åest fileÅruncation\n") ;

69 
	`¥ötf
 (" inst -Åest set/get of SF_INSTRUMENT.\n") ;

70 
	`¥ötf
 (" chanmap -Åest set/get of channel map data..\n") ;

71 
	`¥ötf
 ("áll -ÖerformállÅests\n") ;

72 
	`exô
 (1) ;

75 
do_Æl
 =! 
	`°rcmp
 (
¨gv
 [1], "all") ;

77 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "ver") == 0)

78 { 
buf„r
 [128] ;

79 
buf„r
 [0] = 0 ;

80 
	`sf_comm™d
 (
NULL
, 
SFC_GET_LIB_VERSION
, 
buf„r
,  (buffer)) ;

81 i‡(
	`°æí
 (
buf„r
) < 1)

82 { 
	`¥ötf
 ("Löê%d: couldÇŸÑërõvêlib vîsi⁄.\n", 
__LINE__
) ;

83 
	`exô
 (1) ;

85 
ã°_cou¡
++ ;

88 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "norm") == 0)

92 
	`Êﬂt_n‹m_ã°
 ("float.wav") ;

93 
	`doubÀ_n‹m_ã°
 ("double.wav") ;

94 
ã°_cou¡
++ ;

97 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "peak") == 0)

98 { 
	`ˇlc_≥ak_ã°
 (
SF_ENDIAN_BIG
 | 
SF_FORMAT_RAW
, "be-peak.raw") ;

99 
	`ˇlc_≥ak_ã°
 (
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_RAW
, "le-peak.raw") ;

100 
ã°_cou¡
++ ;

103 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "format"))

104 { 
	`f‹m©_ã°s
 () ;

105 
ã°_cou¡
++ ;

108 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "trunc") == 0)

109 { 
	`åunˇã_ã°
 ("åunˇã.øw", 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_32
) ;

110 
	`åunˇã_ã°
 ("åunˇã.au" , 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_16
) ;

111 
ã°_cou¡
++ ;

114 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "inst") == 0)

115 { 
	`ö°rumít_ã°
 ("ö°rumít.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_16
) ;

116 
	`ö°rumít_ã°
 ("ö°rumít.aiff" , 
SF_FORMAT_AIFF
 | 
SF_FORMAT_PCM_24
) ;

118 
ã°_cou¡
++ ;

121 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "chanmap") == 0)

122 { 
	`ch™√l_m≠_ã°
 ("ch™m≠.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_16
) ;

123 
	`ch™√l_m≠_ã°
 ("ch™m≠.aiff" , 
SF_FORMAT_AIFF
 | 
SF_FORMAT_PCM_24
) ;

125 
ã°_cou¡
++ ;

128 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "bext") == 0)

129 { 
	`brﬂdˇ°_ã°
 ("brﬂdˇ°.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_16
) ;

130 
ã°_cou¡
++ ;

133 i‡(
ã°_cou¡
 == 0)

134 { 
	`¥ötf
 ("Mono : ************************************\n") ;

135 
	`¥ötf
 ("M⁄ÿ: * Nÿ'%s'Åe° deföed.\n", 
¨gv
 [1]) ;

136 
	`¥ötf
 ("Mono : ************************************\n") ;

141 
	}
}

148 
	$Êﬂt_n‹m_ã°
 (c⁄° *
fûíame
)

149 { 
SNDFILE
 *
fûe
 ;

150 
SF_INFO
 
sföfo
 ;

151 
k
 ;

153 
	`¥öt_ã°_«me
 ("Êﬂt_n‹m_ã°", 
fûíame
) ;

155 
sföfo
.
ßm∂î©e
 = 44100 ;

156 
sföfo
.
f‹m©
 = (
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_16
) ;

157 
sföfo
.
ch™√ls
 = 1 ;

158 
sföfo
.
‰ames
 = 
BUFFER_LEN
 ;

161 
k
 = 0 ; k < 
BUFFER_LEN
 / 2 ; k++)

162 
Êﬂt_d©a
 [
k
] = (k + 5Ë/ (2.0 * 
BUFFER_LEN
) ;

163 
k
 = 
BUFFER_LEN
 / 2 ; k < BUFFER_LEN ; k++)

164 
Êﬂt_d©a
 [
k
] = (k + 5) ;

166 i‡(! (
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_WRITE
, &
sföfo
)))

167 { 
	`¥ötf
 ("Löê%d: sf_›í_wrôêÁûed wôhÉº‹ : ", 
__LINE__
) ;

168 
	`fÊush
 (
°dout
) ;

169 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

170 
	`exô
 (1) ;

175 i‡((
k
 = 
	`sf_wrôe_Êﬂt
 (
fûe
, 
Êﬂt_d©a
, 
BUFFER_LEN
 / 2)) != BUFFER_LEN / 2)

176 { 
	`¥ötf
 ("Löê%d: sf_wrôe_ÊﬂàÁûed wôh sh‹àwrôê(%d ->%d)\n", 
__LINE__
, 
BUFFER_LEN
, 
k
) ;

177 
	`exô
 (1) ;

181 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

183 i‡((
k
 = 
	`sf_wrôe_Êﬂt
 (
fûe
, 
Êﬂt_d©a
 + 
BUFFER_LEN
 / 2, BUFFER_LEN / 2)) != BUFFER_LEN / 2)

184 { 
	`¥ötf
 ("Löê%d: sf_wrôe_ÊﬂàÁûed wôh sh‹àwrôê(%d ->%d)\n", 
__LINE__
, 
BUFFER_LEN
, 
k
) ;

185 
	`exô
 (1) ;

188 
	`sf_˛o£
 (
fûe
) ;

191 i‡(! (
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_READ
, &
sföfo
)))

192 { 
	`¥ötf
 ("Löê%d: sf_›í_ªad faûed wôhÉº‹ : ", 
__LINE__
) ;

193 
	`fÊush
 (
°dout
) ;

194 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

195 
	`exô
 (1) ;

198 i‡(
sföfo
.
f‹m©
 !(
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_16
))

199 { 
	`¥ötf
 ("Löê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, (
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_16
), 
sföfo
.
f‹m©
) ;

200 
	`exô
 (1) ;

203 i‡(
sföfo
.
‰ames
 !
BUFFER_LEN
)

204 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî of.‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
BUFFER_LEN
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

205 
	`exô
 (1) ;

208 i‡(
sföfo
.
ch™√ls
 != 1)

209 { 
	`¥ötf
 ("Löê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

210 
	`exô
 (1) ;

214 i‡((
k
 = 
	`sf_ªad_Êﬂt
 (
fûe
, 
Êﬂt_d©a
, 
BUFFER_LEN
)) != BUFFER_LEN)

215 { 
	`¥ötf
 ("\n\nLöê%d: sf_ªad_ÊﬂàÁûed wôh sh‹àªad (%d ->%d)\n", 
__LINE__
, 
BUFFER_LEN
, 
k
) ;

216 
	`exô
 (1) ;

219 
k
 = 0 ; k < 
BUFFER_LEN
 ; k++)

220 i‡(
Êﬂt_d©a
 [
k
] >= 1.0)

221 { 
	`¥ötf
 ("\n\nLöê%d: flﬂt_d©®[%d] =%‡which i†gª©îÅh™ 1.0\n", 
__LINE__
, 
k
, 
Êﬂt_d©a
 [k]) ;

222 
	`exô
 (1) ;

226 
	`sf_£ek
 (
fûe
, 0, 
SEEK_SET
) ;

227 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

229 i‡((
k
 = 
	`sf_ªad_Êﬂt
 (
fûe
, 
Êﬂt_d©a
, 
BUFFER_LEN
)) != BUFFER_LEN)

230 { 
	`¥ötf
 ("\n\nLöê%d: sf_ªad_ÊﬂàÁûed wôh sh‹àªad (%d ->%d)\n", 
__LINE__
, 
BUFFER_LEN
, 
k
) ;

231 
	`exô
 (1) ;

234 
k
 = 0 ; k < 
BUFFER_LEN
 ; k++)

235 i‡(
Êﬂt_d©a
 [
k
] < 1.0)

236 { 
	`¥ötf
 ("\n\nLöê%d: flﬂt_d©®[%d] =%‡which i†Às†th™ 1.0\n", 
__LINE__
, 
k
, 
Êﬂt_d©a
 [k]) ;

237 
	`exô
 (1) ;

241 
	`sf_£ek
 (
fûe
, 0, 
SEEK_SET
) ;

242 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_TRUE
) ;

244 i‡((
k
 = 
	`sf_ªad_Êﬂt
 (
fûe
, 
Êﬂt_d©a
, 
BUFFER_LEN
)) != BUFFER_LEN)

245 { 
	`¥ötf
 ("\n\nLöê%d: sf_ªad_ÊﬂàÁûed wôh sh‹àªad (%d ->%d)\n", 
__LINE__
, 
BUFFER_LEN
, 
k
) ;

246 
	`exô
 (1) ;

249 
k
 = 0 ; k < 
BUFFER_LEN
 ; k++)

250 i‡(
Êﬂt_d©a
 [
k
] > 1.0)

251 { 
	`¥ötf
 ("\n\nLöê%d: flﬂt_d©®[%d] =%‡which i†gª©îÅh™ 1.0\n", 
__LINE__
, 
k
, 
Êﬂt_d©a
 [k]) ;

252 
	`exô
 (1) ;

256 
	`sf_˛o£
 (
fûe
) ;

258 
	`u∆ök
 (
fûíame
) ;

260 
	`¥ötf
 ("ok\n") ;

261 
	}
}

264 
	$doubÀ_n‹m_ã°
 (c⁄° *
fûíame
)

265 { 
SNDFILE
 *
fûe
 ;

266 
SF_INFO
 
sföfo
 ;

267 
k
 ;

269 
	`¥öt_ã°_«me
 ("doubÀ_n‹m_ã°", 
fûíame
) ;

271 
sföfo
.
ßm∂î©e
 = 44100 ;

272 
sföfo
.
f‹m©
 = (
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_16
) ;

273 
sföfo
.
ch™√ls
 = 1 ;

274 
sföfo
.
‰ames
 = 
BUFFER_LEN
 ;

277 
k
 = 0 ; k < 
BUFFER_LEN
 / 2 ; k++)

278 
doubÀ_d©a
 [
k
] = (k + 5Ë/ (2.0 * 
BUFFER_LEN
) ;

279 
k
 = 
BUFFER_LEN
 / 2 ; k < BUFFER_LEN ; k++)

280 
doubÀ_d©a
 [
k
] = (k + 5) ;

282 i‡(! (
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_WRITE
, &
sföfo
)))

283 { 
	`¥ötf
 ("Löê%d: sf_›í_wrôêÁûed wôhÉº‹ : ", 
__LINE__
) ;

284 
	`fÊush
 (
°dout
) ;

285 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

286 
	`exô
 (1) ;

292 i‡((
k
 = 
	`sf_wrôe_doubÀ
 (
fûe
, 
doubÀ_d©a
, 
BUFFER_LEN
 / 2)) != BUFFER_LEN / 2)

293 { 
	`¥ötf
 ("Löê%d: sf_wrôe_doubÀ faûed wôh sh‹àwrôê(%d ->%d)\n", 
__LINE__
, 
BUFFER_LEN
, 
k
) ;

294 
	`exô
 (1) ;

298 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

300 i‡((
k
 = 
	`sf_wrôe_doubÀ
 (
fûe
, 
doubÀ_d©a
 + 
BUFFER_LEN
 / 2, BUFFER_LEN / 2)) != BUFFER_LEN / 2)

301 { 
	`¥ötf
 ("Löê%d: sf_wrôe_doubÀ faûed wôh sh‹àwrôê(%d ->%d)\n", 
__LINE__
, 
BUFFER_LEN
, 
k
) ;

302 
	`exô
 (1) ;

305 
	`sf_˛o£
 (
fûe
) ;

307 i‡(! (
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_READ
, &
sföfo
)))

308 { 
	`¥ötf
 ("Löê%d: sf_›í_ªad faûed wôhÉº‹ : ", 
__LINE__
) ;

309 
	`fÊush
 (
°dout
) ;

310 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

311 
	`exô
 (1) ;

314 i‡(
sföfo
.
f‹m©
 !(
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_16
))

315 { 
	`¥ötf
 ("Löê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, (
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_16
), 
sföfo
.
f‹m©
) ;

316 
	`exô
 (1) ;

319 i‡(
sföfo
.
‰ames
 !
BUFFER_LEN
)

320 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî of.‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
BUFFER_LEN
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

321 
	`exô
 (1) ;

324 i‡(
sföfo
.
ch™√ls
 != 1)

325 { 
	`¥ötf
 ("Löê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

326 
	`exô
 (1) ;

330 i‡((
k
 = 
	`sf_ªad_doubÀ
 (
fûe
, 
doubÀ_d©a
, 
BUFFER_LEN
)) != BUFFER_LEN)

331 { 
	`¥ötf
 ("\n\nLöê%d: sf_ªad_doubÀ faûed wôh sh‹àªad (%d ->%d)\n", 
__LINE__
, 
BUFFER_LEN
, 
k
) ;

332 
	`exô
 (1) ;

335 
k
 = 0 ; k < 
BUFFER_LEN
 ; k++)

336 i‡(
doubÀ_d©a
 [
k
] >= 1.0)

337 { 
	`¥ötf
 ("\n\nLöê%d: doubÀ_d©®[%d] =%‡which i†gª©îÅh™ 1.0\n", 
__LINE__
, 
k
, 
doubÀ_d©a
 [k]) ;

338 
	`exô
 (1) ;

342 
	`sf_£ek
 (
fûe
, 0, 
SEEK_SET
) ;

343 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

345 i‡((
k
 = 
	`sf_ªad_doubÀ
 (
fûe
, 
doubÀ_d©a
, 
BUFFER_LEN
)) != BUFFER_LEN)

346 { 
	`¥ötf
 ("\n\nLöê%d: sf_ªad_doubÀ faûed wôh sh‹àªad (%d ->%d)\n", 
__LINE__
, 
BUFFER_LEN
, 
k
) ;

347 
	`exô
 (1) ;

350 
k
 = 0 ; k < 
BUFFER_LEN
 ; k++)

351 i‡(
doubÀ_d©a
 [
k
] < 1.0)

352 { 
	`¥ötf
 ("\n\nLöê%d: doubÀ_d©®[%d] =%‡which i†Às†th™ 1.0\n", 
__LINE__
, 
k
, 
doubÀ_d©a
 [k]) ;

353 
	`exô
 (1) ;

357 
	`sf_£ek
 (
fûe
, 0, 
SEEK_SET
) ;

358 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_TRUE
) ;

360 i‡((
k
 = 
	`sf_ªad_doubÀ
 (
fûe
, 
doubÀ_d©a
, 
BUFFER_LEN
)) != BUFFER_LEN)

361 { 
	`¥ötf
 ("\n\nLöê%d: sf_ªad_doubÀ faûed wôh sh‹àªad (%d ->%d)\n", 
__LINE__
, 
BUFFER_LEN
, 
k
) ;

362 
	`exô
 (1) ;

365 
k
 = 0 ; k < 
BUFFER_LEN
 ; k++)

366 i‡(
doubÀ_d©a
 [
k
] > 1.0)

367 { 
	`¥ötf
 ("\n\nLöê%d: doubÀ_d©®[%d] =%‡which i†gª©îÅh™ 1.0\n", 
__LINE__
, 
k
, 
doubÀ_d©a
 [k]) ;

368 
	`exô
 (1) ;

372 
	`sf_˛o£
 (
fûe
) ;

374 
	`u∆ök
 (
fûíame
) ;

376 
	`¥ötf
 ("ok\n") ;

377 
	}
}

380 
	$f‹m©_ã°s
 ()

381 { 
SF_FORMAT_INFO
 
f‹m©_öfo
 ;

382 
SF_INFO
 
sföfo
 ;

383 c⁄° *
œ°_«me
 ;

384 
k
, 
cou¡
 ;

386 
	`¥öt_ã°_«me
 ("format_tests", "(null)") ;

389 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

390 
sföfo
.
ch™√ls
 = 1 ;

394 
	`sf_comm™d
 (
NULL
, 
SFC_GET_SIMPLE_FORMAT_COUNT
, &
cou¡
,  ()) ;

396 i‡(
cou¡
 < 0 || count > 30)

397 { 
	`¥ötf
 ("Löê%d: Weúd cou¡.\n", 
__LINE__
) ;

398 
	`exô
 (1) ;

401 
f‹m©_öfo
.
f‹m©
 = 0 ;

402 
	`sf_comm™d
 (
NULL
, 
SFC_GET_SIMPLE_FORMAT
, &
f‹m©_öfo
,  (format_info)) ;

404 
œ°_«me
 = 
f‹m©_öfo
.
«me
 ;

405 
k
 = 1 ; k < 
cou¡
 ; k ++)

406 { 
f‹m©_öfo
.
f‹m©
 = 
k
 ;

407 
	`sf_comm™d
 (
NULL
, 
SFC_GET_SIMPLE_FORMAT
, &
f‹m©_öfo
,  (format_info)) ;

408 i‡(
	`°rcmp
 (
œ°_«me
, 
f‹m©_öfo
.
«me
) >= 0)

409 { 
	`¥ötf
 ("\n\nLöê%d: f‹m©Çame†ouào‡£quí˚ `%s' < `%s'.\n", 
__LINE__
, 
œ°_«me
, 
f‹m©_öfo
.
«me
) ;

410 
	`exô
 (1) ;

412 
sföfo
.
f‹m©
 = 
f‹m©_öfo
.format ;

414 i‡(! 
	`sf_f‹m©_check
 (&
sföfo
))

415 { 
	`¥ötf
 ("\n\nLöê%d: sf_f‹m©_check faûed.\n", 
__LINE__
) ;

416 
	`¥ötf
 (" Namê: %s\n", 
f‹m©_öfo
.
«me
) ;

417 
	`¥ötf
 (" F‹m© : 0x%X\n", 
sföfo
.
f‹m©
) ;

418 
	`¥ötf
 (" Ch™√l† : 0x%X\n", 
sföfo
.
ch™√ls
) ;

419 
	`¥ötf
 (" Sam∂êR©ê: 0x%X\n", 
sföfo
.
ßm∂î©e
) ;

420 
	`exô
 (1) ;

422 
œ°_«me
 = 
f‹m©_öfo
.
«me
 ;

424 
f‹m©_öfo
.
f‹m©
 = 666 ;

425 
	`sf_comm™d
 (
NULL
, 
SFC_GET_SIMPLE_FORMAT
, &
f‹m©_öfo
,  (format_info)) ;

428 
	`sf_comm™d
 (
NULL
, 
SFC_GET_FORMAT_MAJOR_COUNT
, &
cou¡
,  ()) ;

430 i‡(
cou¡
 < 0 || count > 30)

431 { 
	`¥ötf
 ("Löê%d: Weúd cou¡.\n", 
__LINE__
) ;

432 
	`exô
 (1) ;

435 
f‹m©_öfo
.
f‹m©
 = 0 ;

436 
	`sf_comm™d
 (
NULL
, 
SFC_GET_FORMAT_MAJOR
, &
f‹m©_öfo
,  (format_info)) ;

438 
œ°_«me
 = 
f‹m©_öfo
.
«me
 ;

439 
k
 = 1 ; k < 
cou¡
 ; k ++)

440 { 
f‹m©_öfo
.
f‹m©
 = 
k
 ;

441 
	`sf_comm™d
 (
NULL
, 
SFC_GET_FORMAT_MAJOR
, &
f‹m©_öfo
,  (format_info)) ;

442 i‡(
	`°rcmp
 (
œ°_«me
, 
f‹m©_öfo
.
«me
) >= 0)

443 { 
	`¥ötf
 ("\n\nLöê%d: f‹m©Çame†ouào‡£quí˚ (%dË`%s' < `%s'.\n", 
__LINE__
, 
k
, 
œ°_«me
, 
f‹m©_öfo
.
«me
) ;

444 
	`exô
 (1) ;

447 
œ°_«me
 = 
f‹m©_öfo
.
«me
 ;

449 
f‹m©_öfo
.
f‹m©
 = 666 ;

450 
	`sf_comm™d
 (
NULL
, 
SFC_GET_FORMAT_MAJOR
, &
f‹m©_öfo
,  (format_info)) ;

453 
	`sf_comm™d
 (
NULL
, 
SFC_GET_FORMAT_SUBTYPE_COUNT
, &
cou¡
,  ()) ;

455 i‡(
cou¡
 < 0 || count > 30)

456 { 
	`¥ötf
 ("Löê%d: Weúd cou¡.\n", 
__LINE__
) ;

457 
	`exô
 (1) ;

460 
f‹m©_öfo
.
f‹m©
 = 0 ;

461 
	`sf_comm™d
 (
NULL
, 
SFC_GET_FORMAT_SUBTYPE
, &
f‹m©_öfo
,  (format_info)) ;

463 
œ°_«me
 = 
f‹m©_öfo
.
«me
 ;

464 
k
 = 1 ; k < 
cou¡
 ; k ++)

465 { 
f‹m©_öfo
.
f‹m©
 = 
k
 ;

466 
	`sf_comm™d
 (
NULL
, 
SFC_GET_FORMAT_SUBTYPE
, &
f‹m©_öfo
,  (format_info)) ;

468 
f‹m©_öfo
.
f‹m©
 = 666 ;

469 
	`sf_comm™d
 (
NULL
, 
SFC_GET_FORMAT_SUBTYPE
, &
f‹m©_öfo
,  (format_info)) ;

472 
	`¥ötf
 ("ok\n") ;

473 
	}
}

476 
	$ˇlc_≥ak_ã°
 (
fûëy≥
, c⁄° *
fûíame
)

477 { 
SNDFILE
 *
fûe
 ;

478 
SF_INFO
 
sföfo
 ;

479 
k
, 
f‹m©
 ;

480 
≥ak
 ;

482 
	`¥öt_ã°_«me
 ("ˇlc_≥ak_ã°", 
fûíame
) ;

484 
f‹m©
 = (
fûëy≥
 | 
SF_FORMAT_PCM_16
) ;

486 
sföfo
.
ßm∂î©e
 = 44100 ;

487 
sföfo
.
f‹m©
 = format ;

488 
sföfo
.
ch™√ls
 = 1 ;

489 
sföfo
.
‰ames
 = 
BUFFER_LEN
 ;

492 
k
 = 0 ; k < 
BUFFER_LEN
 ; k++)

493 
doubÀ_d©a
 [
k
] = (k + 1Ë/ (2.0 * 
BUFFER_LEN
) ;

495 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

497 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
doubÀ_d©a
, 
BUFFER_LEN
, 
__LINE__
) ;

499 
	`sf_˛o£
 (
fûe
) ;

501 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

503 i‡(
sföfo
.
f‹m©
 != format)

504 { 
	`¥ötf
 ("Löê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
f‹m©
, 
sföfo
.format) ;

505 
	`exô
 (1) ;

508 i‡(
sföfo
.
‰ames
 !
BUFFER_LEN
)

509 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî of.‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
BUFFER_LEN
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

510 
	`exô
 (1) ;

513 i‡(
sföfo
.
ch™√ls
 != 1)

514 { 
	`¥ötf
 ("Löê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

515 
	`exô
 (1) ;

518 
	`sf_comm™d
 (
fûe
, 
SFC_CALC_SIGNAL_MAX
, &
≥ak
,  (peak)) ;

519 i‡(
	`Ábs
 (
≥ak
 - (1 << 14)) > 1.0)

520 { 
	`¥ötf
 ("Löê%d : Pók vÆuêshould bê%d (i†%f).\n", 
__LINE__
, (1 << 14), 
≥ak
) ;

521 
	`exô
 (1) ;

524 
	`sf_comm™d
 (
fûe
, 
SFC_CALC_NORM_SIGNAL_MAX
, &
≥ak
,  (peak)) ;

525 i‡(
	`Ábs
 (
≥ak
 - 0.5) > 4e-5)

526 { 
	`¥ötf
 ("Löê%d : Pók vÆuêshould bê%‡(i†%f).\n", 
__LINE__
, 0.5, 
≥ak
) ;

527 
	`exô
 (1) ;

530 
	`sf_˛o£
 (
fûe
) ;

532 
f‹m©
 = (
fûëy≥
 | 
SF_FORMAT_FLOAT
) ;

533 
sföfo
.
ßm∂î©e
 = 44100 ;

534 
sföfo
.
f‹m©
 = format ;

535 
sföfo
.
ch™√ls
 = 1 ;

536 
sföfo
.
‰ames
 = 
BUFFER_LEN
 ;

539 
k
 = 0 ; k < 
BUFFER_LEN
 ; k++)

540 
doubÀ_d©a
 [
k
] = (k + 1Ë/ (2.0 * 
BUFFER_LEN
) ;

542 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

544 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
doubÀ_d©a
, 
BUFFER_LEN
, 
__LINE__
) ;

546 
	`sf_˛o£
 (
fûe
) ;

548 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

550 i‡(
sföfo
.
f‹m©
 != format)

551 { 
	`¥ötf
 ("Löê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
f‹m©
, 
sföfo
.format) ;

552 
	`exô
 (1) ;

555 i‡(
sföfo
.
‰ames
 !
BUFFER_LEN
)

556 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî of.‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
BUFFER_LEN
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

557 
	`exô
 (1) ;

560 i‡(
sföfo
.
ch™√ls
 != 1)

561 { 
	`¥ötf
 ("Löê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

562 
	`exô
 (1) ;

565 
	`sf_comm™d
 (
fûe
, 
SFC_CALC_SIGNAL_MAX
, &
≥ak
,  (peak)) ;

566 i‡(
	`Ábs
 (
≥ak
 - 0.5) > 1e-5)

567 { 
	`¥ötf
 ("Löê%d : Pók vÆuêshould bê%‡(i†%f).\n", 
__LINE__
, 0.5, 
≥ak
) ;

568 
	`exô
 (1) ;

571 
	`sf_comm™d
 (
fûe
, 
SFC_CALC_NORM_SIGNAL_MAX
, &
≥ak
,  (peak)) ;

572 i‡(
	`Ábs
 (
≥ak
 - 0.5) > 1e-5)

573 { 
	`¥ötf
 ("Löê%d : Pók vÆuêshould bê%‡(i†%f).\n", 
__LINE__
, 0.5, 
≥ak
) ;

574 
	`exô
 (1) ;

577 
	`sf_˛o£
 (
fûe
) ;

579 
	`u∆ök
 (
fûíame
) ;

581 
	`¥ötf
 ("ok\n") ;

582 
	}
}

585 
	$åunˇã_ã°
 (c⁄° *
fûíame
, 
fûëy≥
)

586 { 
SNDFILE
 *
fûe
 ;

587 
SF_INFO
 
sföfo
 ;

588 
sf_cou¡_t
 
Àn
 ;

590 
	`¥öt_ã°_«me
 ("åunˇã_ã°", 
fûíame
) ;

592 
sföfo
.
ßm∂î©e
 = 11025 ;

593 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

594 
sföfo
.
ch™√ls
 = 2 ;

596 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

598 
	`ã°_wrôe_öt_‹_dõ
 (
fûe
, 0, 
öt_d©a
, 
BUFFER_LEN
, 
__LINE__
) ;

600 
Àn
 = 100 ;

601 i‡(
	`sf_comm™d
 (
fûe
, 
SFC_FILE_TRUNCATE
, &
Àn
,  (len)))

602 { 
	`¥ötf
 ("Löê%d: sf_comm™d (SFC_FILE_TRUNCATEËªtu∫edÉº‹.\n", 
__LINE__
) ;

603 
	`exô
 (1) ;

606 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_CUR
, 
Àn
, 2, 
__LINE__
) ;

607 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_END
, 
Àn
, 2, 
__LINE__
) ;

609 
	`sf_˛o£
 (
fûe
) ;

611 
	`u∆ök
 (
fûíame
) ;

612 
	`puts
 ("ok") ;

613 
	}
}

616 
	$ö°rumít_ã°
 (c⁄° *
fûíame
, 
fûëy≥
)

617 { 
SF_INSTRUMENT
 
wrôe_ö°
 =

628 
SF_INSTRUMENT
 
ªad_ö°
 ;

629 
SNDFILE
 *
fûe
 ;

630 
SF_INFO
 
sföfo
 ;

632 
	`¥öt_ã°_«me
 ("ö°rumít_ã°", 
fûíame
) ;

634 
sföfo
.
ßm∂î©e
 = 11025 ;

635 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

636 
sföfo
.
ch™√ls
 = 1 ;

638 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

639 i‡(
	`sf_comm™d
 (
fûe
, 
SFC_SET_INSTRUMENT
, &
wrôe_ö°
,  (wrôe_ö°)Ë=
SF_FALSE
)

640 { 
	`¥ötf
 ("\n\nLöê%d : sf_comm™d (SFC_SET_INSTRUMENTËÁûed.\n\n", 
__LINE__
) ;

641 
	`exô
 (1) ;

643 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
doubÀ_d©a
, 
BUFFER_LEN
, 
__LINE__
) ;

644 
	`sf_˛o£
 (
fûe
) ;

646 
	`mem£t
 (&
ªad_ö°
, 0,  (read_inst)) ;

648 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

649 i‡(
	`sf_comm™d
 (
fûe
, 
SFC_GET_INSTRUMENT
, &
ªad_ö°
,  (ªad_ö°)Ë=
SF_FALSE
)

650 { 
	`¥ötf
 ("\n\nLöê%d : sf_comm™d (SFC_GET_INSTRUMENTËÁûed.\n\n", 
__LINE__
) ;

651 
	`exô
 (1) ;

654 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

655 
	`sf_˛o£
 (
fûe
) ;

657 i‡((
fûëy≥
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_WAV
)

663 
wrôe_ö°
.
dëu√
 = 0 ;

664 
wrôe_ö°
.
key_lo
 = wrôe_ö°.
vñocôy_lo
 = 0 ;

665 
wrôe_ö°
.
key_hi
 = wrôe_ö°.
vñocôy_hi
 = 127 ;

666 
wrôe_ö°
.
gaö
 = 1 ;

669 i‡((
fûëy≥
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_XI
)

675 
wrôe_ö°
.
ba£nŸe
 = 0 ;

676 
wrôe_ö°
.
dëu√
 = 0 ;

677 
wrôe_ö°
.
key_lo
 = wrôe_ö°.
vñocôy_lo
 = 0 ;

678 
wrôe_ö°
.
key_hi
 = wrôe_ö°.
vñocôy_hi
 = 127 ;

679 
wrôe_ö°
.
gaö
 = 1 ;

682 i‡(
	`memcmp
 (&
wrôe_ö°
, &
ªad_ö°
,  (write_inst)) != 0)

683 { 
	`¥ötf
 ("\n\nLöê%d : in°rumíàcom∑ris⁄ faûed.\n\n", 
__LINE__
) ;

684 
	`¥ötf
 ("W Base Note : %u\n"

693 
wrôe_ö°
.
ba£nŸe
,

694 
wrôe_ö°
.
dëu√
,

695 
wrôe_ö°
.
key_lo
, wrôe_ö°.
key_hi
,

696 
wrôe_ö°
.
vñocôy_lo
, wrôe_ö°.
vñocôy_hi
,

697 
wrôe_ö°
.
gaö
, wrôe_ö°.
lo›_cou¡
,

698 
wrôe_ö°
.
lo›s
 [0].
mode
, wrôe_ö°.lo›†[0].
°¨t
,

699 
wrôe_ö°
.
lo›s
 [0].
íd
, wrôe_ö°.lo›†[0].
cou¡
,

700 
wrôe_ö°
.
lo›s
 [1].
mode
, wrôe_ö°.lo›†[1].
°¨t
,

701 
wrôe_ö°
.
lo›s
 [1].
íd
, wrôe_ö°.lo›†[1].
cou¡
) ;

702 
	`¥ötf
 ("R Base Note : %u\n"

711 
ªad_ö°
.
ba£nŸe
,

712 
ªad_ö°
.
dëu√
,

713 
ªad_ö°
.
key_lo
,Ñód_ö°.
key_hi
,

714 
ªad_ö°
.
vñocôy_lo
,Ñód_ö°.
vñocôy_hi
,

715 
ªad_ö°
.
gaö
,Ñód_ö°.
lo›_cou¡
,

716 
ªad_ö°
.
lo›s
 [0].
mode
,Ñód_ö°.lo›†[0].
°¨t
,

717 
ªad_ö°
.
lo›s
 [0].
íd
,Ñód_ö°.lo›†[0].
cou¡
,

718 
ªad_ö°
.
lo›s
 [1].
mode
,Ñód_ö°.lo›†[1].
°¨t
,

719 
ªad_ö°
.
lo›s
 [1].
íd
,Ñód_ö°.lo›†[1].
cou¡
) ;

721 i‡((
fûëy≥
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_XI
)

722 
	`exô
 (1) ;

725 
	`u∆ök
 (
fûíame
) ;

726 
	`puts
 ("ok") ;

727 
	}
}

730 
	$brﬂdˇ°_ã°
 (c⁄° *
fûíame
, 
fûëy≥
)

731 { 
SF_BROADCAST_INFO
 
bc_wrôe
, 
bc_ªad
 ;

732 
SNDFILE
 *
fûe
 ;

733 
SF_INFO
 
sföfo
 ;

734 
îr‹s
 = 0 ;

736 
	`¥öt_ã°_«me
 ("brﬂdˇ°_ã°", 
fûíame
) ;

738 
sföfo
.
ßm∂î©e
 = 11025 ;

739 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

740 
sföfo
.
ch™√ls
 = 1 ;

742 
	`mem£t
 (&
bc_wrôe
, 0,  (bc_write)) ;

744 
	`¢¥ötf
 (
bc_wrôe
.
des¸ùti⁄
,  (bc_write.description), "Test description") ;

745 
	`¢¥ötf
 (
bc_wrôe
.
‹igö©‹
,  (bc_write.originator), "Test originator") ;

746 
	`¢¥ötf
 (
bc_wrôe
.
‹igö©‹_ª„ªn˚
,  (bc_wrôe.‹igö©‹_ª„ªn˚), "%08x-%08x", (Ë
	`time
 (
NULL
), () (~Åime (NULL))) ;

747 
	`¢¥ötf
 (
bc_wrôe
.
‹igö©i⁄_d©e
,  (bc_write.origination_date), "%d/%02d/%02d", 2006, 3, 30) ;

748 
	`¢¥ötf
 (
bc_wrôe
.
‹igö©i⁄_time
,  (bc_write.origination_time), "%02d:%02d:%02d", 20, 27, 0) ;

749 
	`¢¥ötf
 (
bc_wrôe
.
umid
,  (bc_write.umid), "Some umid") ;

750 
bc_wrôe
.
codög_hi°‹y_size
 = 0 ;

752 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

753 i‡(
	`sf_comm™d
 (
fûe
, 
SFC_SET_BROADCAST_INFO
, &
bc_wrôe
,  (bc_wrôe)Ë=
SF_FALSE
)

754 { 
	`¥ötf
 ("\n\nLöê%d : sf_comm™d (SFC_SET_BROADCAST_INFOËÁûed.\n\n", 
__LINE__
) ;

755 
	`exô
 (1) ;

757 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
doubÀ_d©a
, 
BUFFER_LEN
, 
__LINE__
) ;

758 
	`sf_˛o£
 (
fûe
) ;

760 
	`mem£t
 (&
bc_ªad
, 0,  (bc_read)) ;

762 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

763 i‡(
	`sf_comm™d
 (
fûe
, 
SFC_GET_BROADCAST_INFO
, &
bc_ªad
,  (bc_ªad)Ë=
SF_FALSE
)

764 { 
	`¥ötf
 ("\n\nLöê%d : sf_comm™d (SFC_SET_BROADCAST_INFOËÁûed.\n\n", 
__LINE__
) ;

765 
	`exô
 (1) ;

768 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

769 
	`sf_˛o£
 (
fûe
) ;

771 i‡(
bc_ªad
.
vîsi⁄
 != 1)

772 { 
	`¥ötf
 ("\n\nLöê%d : Ród bad vîsi⁄Çumbî %d.\n\n", 
__LINE__
, 
bc_ªad
.
vîsi⁄
) ;

773 
	`exô
 (1) ;

777 
bc_ªad
.
vîsi⁄
 = 
bc_wrôe
.version = 0 ;

779 i‡(
	`memcmp
 (
bc_wrôe
.
des¸ùti⁄
, 
bc_ªad
.description,  (bc_write.description)) != 0)

780 { 
	`¥ötf
 ("\n\nLöê%d : des¸ùti⁄ mism©ch :\n\twrôê: '%s'\n\åód : '%s'\n\n", 
__LINE__
, 
bc_wrôe
.
des¸ùti⁄
, 
bc_ªad
.description) ;

781 
îr‹s
 ++ ;

784 i‡(
	`memcmp
 (
bc_wrôe
.
‹igö©‹
, 
bc_ªad
.originator,  (bc_write.originator)) != 0)

785 { 
	`¥ötf
 ("\n\nLöê%d : origö©‹ mism©ch :\n\twrôê: '%s'\n\åód : '%s'\n\n", 
__LINE__
, 
bc_wrôe
.
‹igö©‹
, 
bc_ªad
.originator) ;

786 
îr‹s
 ++ ;

789 i‡(
	`memcmp
 (
bc_wrôe
.
‹igö©‹_ª„ªn˚
, 
bc_ªad
.originator_reference,  (bc_write.originator_reference)) != 0)

790 { 
	`¥ötf
 ("\n\nLöê%d : origö©‹_ª„ªn˚ mism©ch :\n\twrôê: '%s'\n\åód : '%s'\n\n", 
__LINE__
, 
bc_wrôe
.
‹igö©‹_ª„ªn˚
, 
bc_ªad
.originator_reference) ;

791 
îr‹s
 ++ ;

794 i‡(
	`memcmp
 (
bc_wrôe
.
‹igö©i⁄_d©e
, 
bc_ªad
.origination_date,  (bc_write.origination_date)) != 0)

795 { 
	`¥ötf
 ("\n\nLöê%d : origö©i⁄_d©êmism©ch :\n\twrôê: '%s'\n\åód : '%s'\n\n", 
__LINE__
, 
bc_wrôe
.
‹igö©i⁄_d©e
, 
bc_ªad
.origination_date) ;

796 
îr‹s
 ++ ;

799 i‡(
	`memcmp
 (
bc_wrôe
.
‹igö©i⁄_time
, 
bc_ªad
.origination_time,  (bc_write.origination_time)) != 0)

800 { 
	`¥ötf
 ("\n\nLöê%d : origö©i⁄_timêmism©ch :\n\twrôê: '%s'\n\åód : '%s'\n\n", 
__LINE__
, 
bc_wrôe
.
‹igö©i⁄_time
, 
bc_ªad
.origination_time) ;

801 
îr‹s
 ++ ;

804 i‡(
	`memcmp
 (
bc_wrôe
.
umid
, 
bc_ªad
.umid,  (bc_write.umid)) != 0)

805 { 
	`¥ötf
 ("\n\nLöê%d : umid mism©ch :\n\twrôê: '%s'\n\åód : '%s'\n\n", 
__LINE__
, 
bc_wrôe
.
umid
, 
bc_ªad
.umid) ;

806 
îr‹s
 ++ ;

809 i‡(
îr‹s
)

810 
	`exô
 (1) ;

812 
	`u∆ök
 (
fûíame
) ;

813 
	`puts
 ("ok") ;

814 
	}
}

817 
	$ch™√l_m≠_ã°
 (c⁄° *
fûíame
, 
fûëy≥
)

820 
fûëy≥
 = 0 ;

821 
	`¥öt_ã°_«me
 ("ch™√l_m≠_ã°", 
fûíame
) ;

822 
	`puts
 ("not working yet") ;

824 
SNDFILE
 *
fûe
 ;

825 
SF_INFO
 
sföfo
 ;

826 
ch™√l_m≠_ªad
 [4], 
ch™√l_m≠_wrôe
 [4] =

827 { 
SF_CHANNEL_MAP_FRONT_LEFT
, 
SF_CHANNEL_MAP_FRONT_CENTER
,

828 
SF_CHANNEL_MAP_REAR_LEFT
, 
SF_CHANNEL_MAP_REAR_RIGHT


831 
	`¥öt_ã°_«me
 ("ch™√l_m≠_ã°", 
fûíame
) ;

833 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

834 
sföfo
.
ßm∂î©e
 = 11025 ;

835 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

836 
sföfo
.
ch™√ls
 = 
	`ARRAY_LEN
 (
ch™√l_m≠_ªad
) ;

839 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

840 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
doubÀ_d©a
, 
BUFFER_LEN
, 
__LINE__
) ;

841 
	`sf_˛o£
 (
fûe
) ;

844 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

845 
	`exô_if_åue
 (

846 
	`sf_comm™d
 (
fûe
, 
SFC_GET_CHANNEL_MAP_INFO
, 
ch™√l_m≠_ªad
,  (ch™√l_m≠_ªad)Ë!
SF_FALSE
,

847 "\n\nLöê%d : sf_comm™d (SFC_GET_CHANNEL_MAP_INFOËshould havêÁûed.\n\n", 
__LINE__


849 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

850 
	`sf_˛o£
 (
fûe
) ;

853 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

854 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
doubÀ_d©a
, 
BUFFER_LEN
, 
__LINE__
) ;

855 
	`exô_if_åue
 (

856 
	`sf_comm™d
 (
fûe
, 
SFC_SET_CHANNEL_MAP_INFO
, 
ch™√l_m≠_wrôe
,  (ch™√l_m≠_wrôe)Ë=
SF_FALSE
,

857 "\n\nLöê%d : sf_comm™d (SFC_SET_CHANNEL_MAP_INFOËÁûed.\n\n", 
__LINE__


859 
	`sf_˛o£
 (
fûe
) ;

862 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

863 
	`exô_if_åue
 (

864 
	`sf_comm™d
 (
fûe
, 
SFC_GET_CHANNEL_MAP_INFO
, 
ch™√l_m≠_ªad
,  (ch™√l_m≠_ªad)Ë!
SF_TRUE
,

865 "\n\nLöê%d : sf_comm™d (SFC_GET_CHANNEL_MAP_INFOËÁûed.\n\n", 
__LINE__


867 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

868 
	`sf_˛o£
 (
fûe
) ;

870 
	`exô_if_åue
 (

871 
	`memcmp
 (
ch™√l_m≠_ªad
, 
ch™√l_m≠_wrôe
,  (channel_map_read)) != 0,

872 "\n\nLöê%d : Ch™√»m≠Ñód d€†nŸ m©ch ch™√»m≠ wrôãn.\n\n", 
__LINE__


875 
	`u∆ök
 (
fûíame
) ;

876 
	`puts
 ("ok") ;

878 
	}
}

	@libsndfile-1.0.17/tests/dft_cmp.c

19 
	~<°dio.h
>

20 
	~<°dlib.h
>

21 
	~<m©h.h
>

23 
	~"d·_cmp.h
"

24 
	~"utûs.h
"

26 #i‚def 
M_PI


27 
	#M_PI
 3.14159265358979323846264338

	)

30 
	#DFT_SPEC_LENGTH
 (
DFT_DATA_LENGTH
 / 2)

	)

32 
d·_magnôude
 (c⁄° *
d©a
, *
•e˘rum
) ;

33 
ˇlc_max_•e˘øl_dif„ªn˚
 (*
•ec1
, *
•ec2
) ;

40 
	$d·_cmp
 (
löíum
, *
‹ig
, *
ã°
, 
Àn
, 
èrgë_¢r
, 
Ælow_exô
)

41 { 
‹ig_•ec
 [
DFT_SPEC_LENGTH
] ;

42 
ã°_•ec
 [
DFT_SPEC_LENGTH
] ;

43 
¢r
 ;

45 i‡(! 
‹ig
 || ! 
ã°
)

46 { 
	`¥ötf
 ("Eº‹ (löê% dË: d·_cm∞: Bad i≈uà¨øys.\n", 
löíum
) ;

50 i‡(
Àn
 !
DFT_DATA_LENGTH
)

51 { 
	`¥ötf
 ("Eº‹ (löê% dË: d·_cm∞: Bad i≈uà¨øyÜígth.\n", 
löíum
) ;

55 
	`d·_magnôude
 (
‹ig
, 
‹ig_•ec
) ;

56 
	`d·_magnôude
 (
ã°
, 
ã°_•ec
) ;

58 
¢r
 = 
	`ˇlc_max_•e˘øl_dif„ªn˚
 (
‹ig_•ec
, 
ã°_•ec
) ;

60 i‡(
¢r
 > 
èrgë_¢r
)

61 { 
	`¥ötf
 ("\n\nLöê%d: A˘uÆ SNR (% 4.1fË>Å¨gë SNR (% 4.1f).\n\n", 
löíum
, 
¢r
, 
èrgë_¢r
) ;

62 
	`o˘_ßve_doubÀ
 (
‹ig
, 
ã°
, 
Àn
) ;

63 i‡(
Ælow_exô
)

64 
	`exô
 (1) ;

67 i‡(
¢r
 < -500.0)

68 
¢r
 = -500.0 ;

70  
¢r
 ;

71 
	}
}

80 
	$d·_magnôude
 (c⁄° *
d©a
, *
•e˘rum
)

81 { 
cos_™gÀ
 [
DFT_DATA_LENGTH
] = { 0.0 } ;

82 
sö_™gÀ
 [
DFT_DATA_LENGTH
] ;

84 
ªÆ_∑π
, 
imag_∑π
 ;

85 
k
, 
n
 ;

88 i‡(
cos_™gÀ
 [0] == 0.0)

89 
n
 = 0 ;Ç < 
DFT_DATA_LENGTH
 ;Ç++)

90 { 
cos_™gÀ
 [
n
] = 
	`cos
 (2.0 * 
M_PI
 *Ç / 
DFT_DATA_LENGTH
) ;

91 
sö_™gÀ
 [
n
] = -1.0 * 
	`sö
 (2.0 * 
M_PI
 *Ç / 
DFT_DATA_LENGTH
) ;

95 
k
 = 1 ; k < 
DFT_SPEC_LENGTH
 ; k++)

96 { 
ªÆ_∑π
 = 0.0 ;

97 
imag_∑π
 = 0.0 ;

99 
n
 = 0 ;Ç < 
DFT_DATA_LENGTH
 ;Ç++)

100 { 
ªÆ_∑π
 +
d©a
 [
n
] * 
cos_™gÀ
 [(
k
 *ÇË% 
DFT_DATA_LENGTH
] ;

101 
imag_∑π
 +
d©a
 [
n
] * 
sö_™gÀ
 [(
k
 *ÇË% 
DFT_DATA_LENGTH
] ;

104 
•e˘rum
 [
k
] = 
	`sqπ
 (
ªÆ_∑π
 *Ñól_∑π + 
imag_∑π
 * imag_part) ;

107 
•e˘rum
 [
k
] = 0.0 ;

109 
•e˘rum
 [0] = spectrum [1] = spectrum [2] = spectrum [3] = spectrum [4] = 0.0 ;

112 
	}
}

115 
	$ˇlc_max_•e˘øl_dif„ªn˚
 (*
‹ig
, *
ã°
)

116 { 
‹ig_max
 = 0.0, 
max_diff
 = 0.0 ;

117 
k
 ;

119 
k
 = 0 ; k < 
DFT_SPEC_LENGTH
 ; k++)

120 { i‡(
‹ig_max
 < 
‹ig
 [
k
])

121 
‹ig_max
 = 
‹ig
 [
k
] ;

122 i‡(
max_diff
 < 
	`Ábs
 (
‹ig
 [
k
] - 
ã°
 [k]))

123 
max_diff
 = 
	`Ábs
 (
‹ig
 [
k
] - 
ã°
 [k]) ;

126 i‡(
max_diff
 < 1e-25)

129  20.0 * 
	`log10
 (
max_diff
 / 
‹ig_max
) ;

130 
	}
}

	@libsndfile-1.0.17/tests/dft_cmp.h

20 
	#DFT_DATA_LENGTH
 (2048)

	)

22 
d·_cmp
 (
löíum
, *
‹ig
, *
ã°
, 
Àn
, 
tﬁî™˚
, 
Ælow_exô
) ;

	@libsndfile-1.0.17/tests/dither_test.c

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<uni°d.h
>

24 
	~<°rög.h
>

25 
	~<m©h.h
>

27 
	~<¢dfûe.h
>

29 
	~"utûs.h
"

31 
	#BUFFER_LEN
 (1<<16)

	)

32 
	#LOG_BUFFER_SIZE
 1024

	)

34 
dôhî_ã°
 (c⁄° *
fûíame
, 
fûëy≥
) ;

39 
	gd©a_out
 [
BUFFER_LEN
] ;

42 
	$maö
 (
¨gc
, *
¨gv
 [])

43 { 
do_Æl
 = 0 ;

44 
ã°_cou¡
 = 0 ;

46 i‡(
¨gc
 != 2)

47 { 
	`¥ötf
 ("Ußgê: %†<ã°>\n", 
¨gv
 [0]) ;

48 
	`¥ötf
 (" Where <test> is one ofÅhe following:\n") ;

49 
	`¥ötf
 (" wav -Åest WAV fileÖeak chunk\n") ;

50 
	`¥ötf
 ("áiff -Åest AIFF file PEAK chunk\n") ;

51 
	`¥ötf
 ("áll -ÖerformállÅests\n") ;

52 
	`exô
 (1) ;

55 
do_Æl
=!
	`°rcmp
 (
¨gv
 [1], "all") ;

57 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "wav"))

58 { 
	`dôhî_ã°
 ("dôhî.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_U8
) ;

59 
ã°_cou¡
++ ;

62 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "aiff"))

63 { 
	`dôhî_ã°
 ("dôhî.aiff", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_PCM_S8
) ;

64 
ã°_cou¡
++ ;

67 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "au"))

68 { 
	`dôhî_ã°
 ("dôhî.au", 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_S8
) ;

69 
ã°_cou¡
++ ;

72 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "svx"))

73 { 
	`dôhî_ã°
 ("dôhî.svx", 
SF_FORMAT_SVX
 | 
SF_FORMAT_PCM_S8
) ;

74 
ã°_cou¡
++ ;

77 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "nist"))

78 { 
	`dôhî_ã°
 ("dôhî.ni°", 
SF_FORMAT_NIST
 | 
SF_FORMAT_PCM_S8
) ;

79 
ã°_cou¡
++ ;

82 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "paf"))

83 { 
	`dôhî_ã°
 ("dôhî.∑f", 
SF_FORMAT_PAF
 | 
SF_FORMAT_PCM_S8
) ;

84 
ã°_cou¡
++ ;

87 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "ircam"))

88 { 
	`dôhî_ã°
 ("dôhî.úˇm", 
SF_FORMAT_IRCAM
 | 
SF_FORMAT_PCM_S8
) ;

89 
ã°_cou¡
++ ;

92 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "voc"))

93 { 
	`dôhî_ã°
 ("dôhî.voc", 
SF_FORMAT_VOC
 | 
SF_FORMAT_PCM_S8
) ;

94 
ã°_cou¡
++ ;

97 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "w64"))

98 { 
	`dôhî_ã°
 ("dôhî.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_PCM_S8
) ;

99 
ã°_cou¡
++ ;

102 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "mat4"))

103 { 
	`dôhî_ã°
 ("dôhî.m©4", 
SF_FORMAT_MAT4
 | 
SF_FORMAT_PCM_S8
) ;

104 
ã°_cou¡
++ ;

107 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "mat5"))

108 { 
	`dôhî_ã°
 ("dôhî.m©5", 
SF_FORMAT_MAT5
 | 
SF_FORMAT_PCM_S8
) ;

109 
ã°_cou¡
++ ;

112 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "pvf"))

113 { 
	`dôhî_ã°
 ("dôhî.pvf", 
SF_FORMAT_PVF
 | 
SF_FORMAT_PCM_S8
) ;

114 
ã°_cou¡
++ ;

117 i‡(
ã°_cou¡
 == 0)

118 { 
	`¥ötf
 ("Mono : ************************************\n") ;

119 
	`¥ötf
 ("M⁄ÿ: * Nÿ'%s'Åe° deföed.\n", 
¨gv
 [1]) ;

120 
	`¥ötf
 ("Mono : ************************************\n") ;

125 
	}
}

133 
	$dôhî_ã°
 (c⁄° *
fûíame
, 
fûëy≥
)

134 { 
SNDFILE
 *
fûe
 ;

135 
SF_INFO
 
sföfo
 ;

136 
SF_DITHER_INFO
 
dôhî
 ;

137 
‰ames
 ;

139 
fûëy≥
 = filetype ;

141 
	`¥öt_ã°_«me
 ("dôhî_ã°", 
fûíame
) ;

143 
sföfo
.
ßm∂î©e
 = 44100 ;

144 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

145 
sföfo
.
ch™√ls
 = 1 ;

146 
sföfo
.
‰ames
 = 0 ;

148 
‰ames
 = 
BUFFER_LEN
 / 
sföfo
.
ch™√ls
 ;

150 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

153 i‡(
	`sf_comm™d
 (
fûe
, 
SFC_SET_DITHER_ON_WRITE
, 
NULL
, 
SF_TRUE
) == 0)

154 { 
	`¥ötf
 ("\n\nLöê%d: Should havê™Éº‹ hîêbuàd⁄'t.\n\n", 
__LINE__
) ;

155 
	`exô
 (1) ;

158 
	`mem£t
 (&
dôhî
, 0,  (dither)) ;

159 
dôhî
.
ty≥
 = 
SFD_WHITE
 ;

160 
dôhî
.
Àvñ
 = 0 ;

162 i‡(
	`sf_comm™d
 (
fûe
, 
SFC_SET_DITHER_ON_WRITE
, &
dôhî
,  (dither)) != 0)

163 { 
	`¥ötf
 ("\n\nLine %d: sf_command (SFC_SET_DITHER_ON_WRITE)ÑeturnedÉrror : %s\n\n",

164 
__LINE__
, 
	`sf_°ªº‹
 (
fûe
)) ;

165 
	`exô
 (1) ;

169 
	`ã°_wrôe_sh‹t_‹_dõ
 (
fûe
, 0, 
d©a_out
, 
BUFFER_LEN
, 
__LINE__
) ;

170 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

172 
	`sf_˛o£
 (
fûe
) ;

174 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

176 i‡(
sföfo
.
‰ames
 !
BUFFER_LEN
)

177 { 
	`¥ötf
 ("\n\nLöê%d: Bad fømêcou¡ %d (should bê%d)\n\n", 
__LINE__
, (Ë
sföfo
.
‰ames
, 
BUFFER_LEN
) ;

180 
	`sf_˛o£
 (
fûe
) ;

183 
	`puts
 ("ok") ;

184 
	}
}

	@libsndfile-1.0.17/tests/dwvw_test.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

24 #i‡
HAVE_UNISTD_H


25 
	~<uni°d.h
>

28 
	~<Êﬂt_ˇ°.h
>

30 
	~<¢dfûe.h
>

32 
	~"utûs.h
"

34 
	#BUFFER_SIZE
 (10000)

	)

36 #i‚def 
M_PI


37 
	#M_PI
 3.14159265358979323846264338

	)

40 
dwvw_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
bô_width
) ;

43 
	$maö
 ()

45 
	`dwvw_ã°
 ("dwvw12.øw", 
SF_FORMAT_RAW
 | 
SF_FORMAT_DWVW_12
, 12) ;

46 
	`dwvw_ã°
 ("dwvw16.øw", 
SF_FORMAT_RAW
 | 
SF_FORMAT_DWVW_16
, 16) ;

47 
	`dwvw_ã°
 ("dwvw24.øw", 
SF_FORMAT_RAW
 | 
SF_FORMAT_DWVW_24
, 24) ;

50 
	}
}

53 
	$dwvw_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
bô_width
)

54 { 
wrôe_buf
 [
BUFFER_SIZE
] ;

55 
ªad_buf
 [
BUFFER_SIZE
] ;

57 
SNDFILE
 *
fûe
 ;

58 
SF_INFO
 
sföfo
 ;

59 
vÆue
 ;

60 
k
, 
bô_mask
 ;

62 
	`§™d
 (123456) ;

65 
bô_mask
 = (-1 << (32 - 
bô_width
)) ;

67 
	`¥öt_ã°_«me
 ("dwvw_ã°", 
fûíame
) ;

69 
sföfo
.
f‹m©
 = format ;

70 
sföfo
.
ßm∂î©e
 = 44100 ;

71 
sföfo
.
‰ames
 = -1 ;

72 
sföfo
.
ch™√ls
 = 1 ;

74 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

77 
k
 = 0 ;

78 
k
 = 0 ; k < 
BUFFER_SIZE
 / 2 ; k++)

79 { 
vÆue
 = 0x7FFFFFFF * 
	`sö
 (123.0 / 
sföfo
.
ßm∂î©e
 * 2 * 
k
 * 
M_PI
) ;

80 
wrôe_buf
 [
k
] = 
bô_mask
 & 
	`Ãöt
 (
vÆue
) ;

83  ; 
k
 < 
BUFFER_SIZE
 ; k++)

84 
wrôe_buf
 [
k
] = 
bô_mask
 & ((
	`ønd
 () << 11) ^ (rand () >> 11)) ;

86 
	`sf_wrôe_öt
 (
fûe
, 
wrôe_buf
, 
BUFFER_SIZE
) ;

87 
	`sf_˛o£
 (
fûe
) ;

89 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

91 i‡((
k
 = 
	`sf_ªad_öt
 (
fûe
, 
ªad_buf
, 
BUFFER_SIZE
)) != BUFFER_SIZE)

92 { 
	`¥ötf
 ("Eº‹ (löê%dË: O∆yÑód %d/%d.‰ames.\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
) ;

93 
	`exô
 (1) ;

96 
k
 = 0 ; k < 
BUFFER_SIZE
 ; k++)

97 { i‡(
ªad_buf
 [
k
] !
wrôe_buf
 [k])

98 { 
	`¥ötf
 ("Eº‹ (löê%dË: %d !%dáàposôi⁄ %d/%d\n", 
__LINE__
,

99 
wrôe_buf
 [
k
] >> (32 - 
bô_width
), 
ªad_buf
 [k] >> (32 - bit_width),

100 
k
, 
BUFFER_SIZE
) ;

101 
	`o˘_ßve_öt
 (
wrôe_buf
, 
ªad_buf
, 
BUFFER_SIZE
) ;

102 
	`exô
 (1) ;

106 
	`sf_˛o£
 (
fûe
) ;

108 
	`u∆ök
 (
fûíame
) ;

109 
	`¥ötf
 ("ok\n") ;

112 
	}
}

	@libsndfile-1.0.17/tests/error_test.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

25 #i‡
HAVE_UNISTD_H


26 
	~<uni°d.h
>

29 
	~<¢dfûe.h
>

31 
	~"utûs.h
"

33 
	#BUFFER_SIZE
 (1<<15)

	)

34 
	#SHORT_BUFFER
 (256)

	)

36 
îr‹_numbî_ã°
 () ;

37 
îr‹_vÆue_ã°
 () ;

40 
	$maö
 ()

41 { 
	`îr‹_numbî_ã°
 () ;

42 
	`îr‹_vÆue_ã°
 () ;

45 
	}
}

48 
	$îr‹_numbî_ã°
 ()

49 { c⁄° *
n€º‹
, *
îr°r
 ;

50 
k
 ;

52 
	`¥öt_ã°_«me
 ("error_number_test", "") ;

54 
n€º‹
 = 
	`sf_îr‹_numbî
 (0) ;

56 
k
 = 1 ; k < 300 ; k++)

57 { 
îr°r
 = 
	`sf_îr‹_numbî
 (
k
) ;

60 i‡(
îr°r
 =
n€º‹
)

64 i‡(
	`°r°r
 (
îr°r
, "This isá bug inÜibsndfile."))

65 
	`exô
 (1) ;

69 
	`puts
 ("ok") ;

71 
	}
}

74 
	$îr‹_vÆue_ã°
 ()

75 { 
aiff_d©a
 [0x1b0] =

82 c⁄° *
fûíame
 = "error.aiff" ;

83 
SNDFILE
 *
fûe
 ;

84 
SF_INFO
 
sföfo
 ;

85 
îr‹_num
 ;

87 
	`¥öt_ã°_«me
 ("îr‹_vÆue_ã°", 
fûíame
) ;

89 
	`dump_d©a_to_fûe
 (
fûíame
, 
aiff_d©a
,  (aiff_data)) ;

91 
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_READ
, &
sföfo
) ;

92 i‡(
fûe
 !
NULL
)

93 { 
	`¥ötf
 ("\n\nLöê%d : ShouldÇŸ havêbì¿abÀÅÿ›íÅhi†fûe.\n\n", 
__LINE__
) ;

94 
	`exô
 (1) ;

97 i‡((
îr‹_num
 = 
	`sf_îr‹
 (
NULL
)) <= 1 ||Érror_num > 300)

98 { 
	`¥ötf
 ("\n\nLöê%d : ShouldÇŸ havêhadá¿îr‹Çumbî o‡%d.\n\n", 
__LINE__
, 
îr‹_num
) ;

99 
	`exô
 (1) ;

102 
	`ªmove
 (
fûíame
) ;

103 
	`puts
 ("ok") ;

105 
	}
}

	@libsndfile-1.0.17/tests/fix_this.c

19 
	~<°dio.h
>

20 
	~<°dlib.h
>

21 
	~<°rög.h
>

22 
	~<uni°d.h
>

23 
	~<m©h.h
>

25 
	~<¢dfûe.h
>

27 
	~"utûs.h
"

29 
	#BUFFER_SIZE
 (1<<14Ë

	)

30 
	#SAMPLE_RATE
 (11025)

	)

32 #i‚def 
M_PI


33 
	#M_PI
 3.14159265358979323846264338

	)

36 
lcomp_ã°_öt
 (c⁄° *
°r
, c⁄° *
fûíame
, 
fûëy≥
, 
m¨gö
) ;

38 
îr‹_fun˘i⁄
 (
d©a
, 
‹ig
, 
m¨gö
) ;

39 
deˇy_ª•⁄£
 (
k
) ;

41 
gí_sig«l_doubÀ
 (*
d©a
, 
sˇÀ
, 
d©Æí
) ;

48 { 
	md
 [
BUFFER_SIZE
 + 1];

49 
	mi
 [
BUFFER_SIZE
 + 1];

50 } 
	tBUFFER
 ;

52 
BUFFER
 
	gd©a_buf„r
 ;

53 
BUFFER
 
	g‹ig_buf„r
 ;

56 
	$maö
 ()

57 { c⁄° *
fûíame
 = "test.au" ;

59 
	`lcomp_ã°_öt
 ("au_g721", 
fûíame
, 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_G721_32
, 0.06) ;

62 
	}
}

69 
	$lcomp_ã°_öt
 (c⁄° *
°r
, c⁄° *
fûíame
, 
fûëy≥
, 
m¨gö
)

70 { 
SNDFILE
 *
fûe
 ;

71 
SF_INFO
 
sföfo
 ;

72 
k
, 
m
, *
‹ig
, *
d©a
, 
sum_abs
 ;

73 
d©Æí
, 
£ekpos
 ;

74 
sˇÀ
 ;

76 
	`¥ötf
 ("\nThis isÖrogram isÇotÖart ofÅheÜibsndfileÅest suite.\n\n") ;

78 
	`¥ötf
 ("Ücomp_ã°_öà : %†... ", 
°r
) ;

79 
	`fÊush
 (
°dout
) ;

81 
d©Æí
 = 
BUFFER_SIZE
 ;

83 
sˇÀ
 = 1.0 * 0x10000 ;

85 
d©a
 = 
d©a_buf„r
.
i
 ;

86 
‹ig
 = 
‹ig_buf„r
.
i
 ;

88 
	`gí_sig«l_doubÀ
 (
‹ig_buf„r
.
d
, 32000.0 * 
sˇÀ
, 
d©Æí
) ;

89 
k
 = 0 ; k < 
d©Æí
 ; k++)

90 
‹ig
 [
k
] = 
‹ig_buf„r
.
d
 [k] ;

93 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

94 
sföfo
.
‰ames
 = 123456789 ;

95 
sföfo
.
ch™√ls
 = 1 ;

96 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

98 i‡(! (
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_WRITE
, &
sföfo
)))

99 { 
	`¥ötf
 ("sf_open_write failed withÉrror : ") ;

100 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

101 
	`exô
 (1) ;

104 i‡((
k
 = 
	`sf_wrôef_öt
 (
fûe
, 
‹ig
, 
d©Æí
)) != datalen)

105 { 
	`¥ötf
 ("sf_wrôef_öàÁûed wôh sh‹àwrôê(%ld => %d).\n", 
d©Æí
, 
k
) ;

106 
	`exô
 (1) ;

108 
	`sf_˛o£
 (
fûe
) ;

110 
	`mem£t
 (
d©a
, 0, 
d©Æí
 *  ()) ;

112 i‡((
fûëy≥
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

113 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

115 i‡(! (
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_READ
, &
sföfo
)))

116 { 
	`¥ötf
 ("sf_open_read failed withÉrror : ") ;

117 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

118 
	`exô
 (1) ;

121 i‡((
sföfo
.
f‹m©
 & (
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_SUBMASK
)Ë!(
fûëy≥
 & (SF_FORMAT_TYPEMASK | SF_FORMAT_SUBMASK)))

122 { 
	`¥ötf
 ("Löê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

123 
	`exô
 (1) ;

126 i‡(
sföfo
.
‰ames
 < 
d©Æí
)

127 { 
	`¥ötf
 ("Toÿ„w.‰ame†ö fûe. (%ld should bê®lôéêm‹êth™ %ld)\n", 
d©Æí
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

128 
	`exô
 (1) ;

131 i‡(
sföfo
.
‰ames
 > (
d©Æí
 + datalen / 2))

132 { 
	`¥ötf
 ("Toÿm™y.‰ame†ö fûe. (%ld should bê®lôéêm‹êth™ %ld)\n", 
d©Æí
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

133 
	`exô
 (1) ;

136 i‡(
sföfo
.
ch™√ls
 != 1)

137 { 
	`¥ötf
 ("IncorrectÇumber of channels in file.\n") ;

138 
	`exô
 (1) ;

141 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

143 i‡((
k
 = 
	`sf_ªadf_öt
 (
fûe
, 
d©a
, 
d©Æí
)) != datalen)

144 { 
	`¥ötf
 ("Löê%d: sh‹àªad (%d should bê%ld).\n", 
__LINE__
, 
k
, 
d©Æí
) ;

145 
	`exô
 (1) ;

148 
sum_abs
 = 0 ;

149 
k
 = 0 ; k < 
d©Æí
 ; k++)

150 { i‡(
	`îr‹_fun˘i⁄
 (
d©a
 [
k
] / 
sˇÀ
, 
‹ig
 [k] / sˇÀ, 
m¨gö
))

151 { 
	`¥ötf
 ("Löê%d: Inc‹ª˘ sam∂ê(#%d : %‡should bê%f).\n", 
__LINE__
, 
k
, 
d©a
 [k] / 
sˇÀ
, 
‹ig
 [k] / scale) ;

152 
	`o˘_ßve_öt
 (
‹ig
, 
d©a
, 
d©Æí
) ;

153 
	`exô
 (1) ;

155 
sum_abs
 = 
	`abs
 (sum_ab†+áb†(
d©a
 [
k
])) ;

158 i‡(
sum_abs
 < 1.0)

159 { 
	`¥ötf
 ("Löê%d: Sig«»i†Æ»zîos.\n", 
__LINE__
) ;

160 
	`exô
 (1) ;

163 i‡((
k
 = 
	`sf_ªadf_öt
 (
fûe
, 
d©a
, 
d©Æí
)Ë!
sföfo
.
‰ames
 - datalen)

164 { 
	`¥ötf
 ("Löê%d: Inc‹ª˘ÑódÜígth (%ld should bê%d).\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
 - 
d©Æí
), 
k
) ;

165 
	`exô
 (1) ;

171 i‡((
sföfo
.
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë!
SF_FORMAT_MS_ADPCM
)

172 
k
 = 0 ; k < 
sföfo
.
‰ames
 - 
d©Æí
 ; k++)

173 i‡(
	`abs
 (
d©a
 [
k
] / 
sˇÀ
Ë> 
	`deˇy_ª•⁄£
 (k))

174 { 
	`¥ötf
 ("Löê%d : Inc‹ª˘ sam∂êB (#%d :áb†(%dËshould bê< %d).\n", 
__LINE__
, 
k
, 
d©a
 [k], 
	`deˇy_ª•⁄£
 (k)) ;

175 
	`exô
 (1) ;

178 i‡(! 
sföfo
.
£ekabÀ
)

179 { 
	`¥ötf
 ("ok\n") ;

185 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_SET
)) != 0)

186 { 
	`¥ötf
 ("Löê%d: SìkÅÿ°¨ào‡fûêÁûed (%d).\n", 
__LINE__
, 
k
) ;

187 
	`exô
 (1) ;

190 
m
 = 0 ; m < 3 ; m++)

191 { i‡((
k
 = 
	`sf_ªadf_öt
 (
fûe
, 
d©a
, 11)) != 11)

192 { 
	`¥ötf
 ("Löê%d: Inc‹ª˘ÑódÜígth (11 => %d).\n", 
__LINE__
, 
k
) ;

193 
	`exô
 (1) ;

196 
k
 = 0 ; k < 11 ; k++)

197 i‡(
	`îr‹_fun˘i⁄
 (
d©a
 [
k
] / 
sˇÀ
, 
‹ig
 [k + 
m
 * 11] / sˇÀ, 
m¨gö
))

198 { 
	`¥ötf
 ("Löê%d: Inc‹ª˘ sam∂ê(m = %dË(#%d : %d => %d).\n", 
__LINE__
, 
m
, 
k
 + m * 11, 
‹ig
 [k + m * 11], 
d©a
 [k]) ;

199 
m
 = 0 ; m < 1 ; m++)

200 
	`¥ötf
 ("%d ", 
d©a
 [
m
]) ;

201 
	`¥ötf
 ("\n") ;

202 
	`exô
 (1) ;

206 
£ekpos
 = 
BUFFER_SIZE
 / 10 ;

209 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 
£ekpos
, 
SEEK_SET
)) != seekpos)

210 { 
	`¥ötf
 ("SìkÅÿ°¨ào‡fûê+ %ld faûed (%d).\n", 
£ekpos
, 
k
) ;

211 
	`exô
 (1) ;

214 i‡((
k
 = 
	`sf_ªadf_öt
 (
fûe
, 
d©a
, 1)) != 1)

215 { 
	`¥ötf
 ("Löê%d: sf_ªadf_öà(fûe, d©a, 1Ëªtu∫ed %d.\n", 
__LINE__
, 
k
) ;

216 
	`exô
 (1) ;

219 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
], 
m¨gö
))

220 { 
	`¥ötf
 ("Löê%d: sf_£ek (SEEK_SETËfﬁlowed by sf_ªadf_öàÁûed (%d, %d).\n", 
__LINE__
, 
‹ig
 [1], 
d©a
 [0]) ;

221 
	`exô
 (1) ;

224 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
)Ë!
£ekpos
 + 1)

225 { 
	`¥ötf
 ("Löê%d: sf_£ek (SEEK_CURËwôh 0 off£àÁûed (%d should bê%ld)\n", 
__LINE__
, 
k
, 
£ekpos
 + 1) ;

226 
	`exô
 (1) ;

229 
£ekpos
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
Ë+ 
BUFFER_SIZE
 / 5 ;

230 
k
 = 
	`sf_£ek
 (
fûe
, 
BUFFER_SIZE
 / 5, 
SEEK_CUR
) ;

231 
	`sf_ªadf_öt
 (
fûe
, 
d©a
, 1) ;

232 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
], 
m¨gö
Ë|| 
k
 != seekpos)

233 { 
	`¥ötf
 ("Löê%d: sf_£ek (f‹w¨ds, SEEK_CURËfﬁlowed by sf_ªadf_öàÁûed (%d, %dË(%d, %ld).\n", 
__LINE__
, 
d©a
 [0], 
‹ig
 [
£ekpos
], 
k
, seekpos + 1) ;

234 
	`exô
 (1) ;

237 
£ekpos
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
) - 20 ;

239 
k
 = 
	`sf_£ek
 (
fûe
, -20, 
SEEK_CUR
) ;

240 
	`sf_ªadf_öt
 (
fûe
, 
d©a
, 1) ;

241 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
], 
m¨gö
Ë|| 
k
 != seekpos)

242 { 
	`¥ötf
 ("sf_£ek (backw¨ds, SEEK_CURËfﬁlowed by sf_ªadf_öàÁûed (%d, %dË(%d, %ld).\n", 
d©a
 [0], 
‹ig
 [
£ekpos
], 
k
, seekpos) ;

243 
	`exô
 (1) ;

247 
	`sf_£ek
 (
fûe
, (Ë
sföfo
.
‰ames
, 
SEEK_SET
) ;

249 i‡((
k
 = 
	`sf_ªadf_öt
 (
fûe
, 
d©a
, 
d©Æí
)) != 0)

250 { 
	`¥ötf
 ("Löê%d: Rëu∫ vÆuê‰om sf_ªadf_öà∑°Énd o‡fûêöc‹ª˘ (%d).\n", 
__LINE__
, 
k
) ;

251 
	`exô
 (1) ;

255 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 5 - (Ë
sföfo
.
‰ames
, 
SEEK_END
)) != 5)

256 { 
	`¥ötf
 ("sf_£ek (SEEK_ENDËªtu∫ed %d in°ód o‡%d.\n", 
k
, 5) ;

257 
	`exô
 (1) ;

260 
	`sf_ªadf_öt
 (
fûe
, 
d©a
, 1) ;

261 i‡(
	`îr‹_fun˘i⁄
 (
d©a
 [0] / 
sˇÀ
, 
‹ig
 [5] / sˇÀ, 
m¨gö
))

262 { 
	`¥ötf
 ("Löê%d: sf_£ek (SEEK_ENDËfﬁlowed by sf_ªadf_sh‹àÁûed (%d should bê%d).\n", 
__LINE__
, 
d©a
 [0], 
‹ig
 [5]) ;

263 
	`exô
 (1) ;

266 
	`sf_˛o£
 (
fûe
) ;

268 
	`¥ötf
 ("ok\n") ;

269 
	}
}

275 
	#SIGNAL_MAXVAL
 30000.0

	)

276 
	#DECAY_COUNT
 800

	)

279 
	$deˇy_ª•⁄£
 (
k
)

280 { i‡(
k
 < 1)

281  (Ë(1.2 * 
SIGNAL_MAXVAL
) ;

282 i‡(
k
 > 
DECAY_COUNT
)

284  (Ë(1.2 * 
SIGNAL_MAXVAL
 * (
DECAY_COUNT
 - 
k
) / (1.0 * DECAY_COUNT)) ;

285 
	}
}

288 
	$gí_sig«l_doubÀ
 (*
d©a
, 
sˇÀ
, 
d©Æí
)

289 { 
k
, 
øm∂í
 ;

290 
amp
 = 0.0 ;

292 
øm∂í
 = 
d©Æí
 / 18 ;

294 
k
 = 0 ; k < 
d©Æí
 ; k++)

295 { i‡(
k
 <
øm∂í
)

296 
amp
 = 
sˇÀ
 * 
k
 / ((Ë
øm∂í
) ;

297 i‡(
k
 > 
d©Æí
 - 
øm∂í
)

298 
amp
 = 
sˇÀ
 * (
d©Æí
 - 
k
Ë/ ((Ë
øm∂í
) ;

300 
d©a
 [
k
] = 
amp
 * (0.4 * 
	`sö
 (33.3 * 2.0 * 
M_PI
 * ((Ë(k + 1)Ë/ ((Ë
SAMPLE_RATE
))

301 + 0.3 * 
	`cos
 (201.1 * 2.0 * 
M_PI
 * ((Ë(
k
 + 1)Ë/ ((Ë
SAMPLE_RATE
))) ;

305 
	}
}

308 
	$îr‹_fun˘i⁄
 (
d©a
, 
‹ig
, 
m¨gö
)

309 { 
îr‹
 ;

311 i‡(
	`Ábs
 (
‹ig
) <= 500.0)

312 
îr‹
 = 
	`Ábs
 (Áb†(
d©a
Ë- fab†(
‹ig
)) / 2000.0 ;

313 i‡(
	`Ábs
 (
‹ig
) <= 1000.0)

314 
îr‹
 = 
	`Ábs
 (
d©a
 - 
‹ig
) / 3000.0 ;

316 
îr‹
 = 
	`Ábs
 (
d©a
 - 
‹ig
) / fabs (orig) ;

318 i‡(
îr‹
 > 
m¨gö
)

319 { 
	`¥ötf
 ("\n\n*******************\nEº‹ : %f\n", 
îr‹
) ;

323 
	}
}

	@libsndfile-1.0.17/tests/floating_point_test.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

24 
	~<m©h.h
>

26 #i‡
HAVE_UNISTD_H


27 
	~<uni°d.h
>

30 
	~<¢dfûe.h
>

32 
	~"d·_cmp.h
"

33 
	~"utûs.h
"

35 
	~"Êﬂt_ˇ°.h
"

37 
	#SAMPLE_RATE
 16000

	)

39 
Êﬂt_sˇÀd_ã°
 (c⁄° *
fûíame
, 
Ælow_exô
, 
ª∂a˚_Êﬂt
, 
fûëy≥
, 
èrgë_¢r
) ;

40 
doubÀ_sˇÀd_ã°
 (c⁄° *
fûíame
, 
Ælow_exô
, 
ª∂a˚_Êﬂt
, 
fûëy≥
, 
èrgë_¢r
) ;

42 
Êﬂt_sh‹t_lôée_ã°
 (c⁄° * 
fûíame
) ;

43 
Êﬂt_sh‹t_big_ã°
 (c⁄° * 
fûíame
) ;

44 
Êﬂt_öt_lôée_ã°
 (c⁄° * 
fûíame
) ;

45 
Êﬂt_öt_big_ã°
 (c⁄° * 
fûíame
) ;

46 
doubÀ_sh‹t_lôée_ã°
 (c⁄° * 
fûíame
) ;

47 
doubÀ_sh‹t_big_ã°
 (c⁄° * 
fûíame
) ;

48 
doubÀ_öt_lôée_ã°
 (c⁄° * 
fûíame
) ;

49 
doubÀ_öt_big_ã°
 (c⁄° * 
fûíame
) ;

52 
	gdoubÀ_d©a
 [
DFT_DATA_LENGTH
] ;

53 
	gã°_d©a
 [
DFT_DATA_LENGTH
] ;

55 
	gÊﬂt_d©a
 [
DFT_DATA_LENGTH
] ;

56 
	gdoubÀ_d©a
 [
DFT_DATA_LENGTH
] ;

57 
	gsh‹t_d©a
 [
DFT_DATA_LENGTH
] ;

58 
	göt_d©a
 [
DFT_DATA_LENGTH
] ;

61 
	$maö
 (
¨gc
, *
¨gv
 [])

62 { 
Ælow_exô
 = 1 ;

64 i‡(
¨gc
 =2 && ! 
	`°r°r
 (
¨gv
 [1], "no-exit"))

65 
Ælow_exô
 = 0 ;

67 #i‡((
HAVE_LRINTF
 =0Ë&& (
HAVE_LRINT_REPLACEMENT
 == 0))

68 
	`puts
 ("*** CannotÑunÅhisÅest onÅhisÖlatform because itÜacksÜrintf().") ;

69 
	`exô
 (0) ;

73 
	`Êﬂt_sˇÀd_ã°
 ("Êﬂt.øw", 
Ælow_exô
, 
SF_FALSE
, 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_FLOAT
, -163.0) ;

76 
	`Êﬂt_sˇÀd_ã°
 ("pcm_s8.øw", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_S8
, -39.0) ;

77 
	`Êﬂt_sˇÀd_ã°
 ("pcm_u8.øw", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_U8
, -39.0) ;

79 
	`Êﬂt_sˇÀd_ã°
 ("pcm_16.øw", 
Ælow_exô
, 
SF_FALSE
, 
SF_ENDIAN_BIG
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_16
, -87.0) ;

80 
	`Êﬂt_sˇÀd_ã°
 ("pcm_24.øw", 
Ælow_exô
, 
SF_FALSE
, 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_24
, -138.0) ;

81 
	`Êﬂt_sˇÀd_ã°
 ("pcm_32.øw", 
Ælow_exô
, 
SF_FALSE
, 
SF_ENDIAN_BIG
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_32
, -163.0) ;

83 
	`Êﬂt_sˇÀd_ã°
 ("uœw.øw", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_ULAW
, -50.0) ;

84 
	`Êﬂt_sˇÀd_ã°
 ("Æaw.øw", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_ALAW
, -49.0) ;

86 
	`Êﬂt_sˇÀd_ã°
 ("ima_adpcm.wav", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_WAV
 | 
SF_FORMAT_IMA_ADPCM
, -47.0) ;

87 
	`Êﬂt_sˇÀd_ã°
 ("ms_adpcm.wav" , 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_WAV
 | 
SF_FORMAT_MS_ADPCM
, -40.0) ;

88 
	`Êﬂt_sˇÀd_ã°
 ("gsm610.øw" , 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_GSM610
, -33.0) ;

90 
	`Êﬂt_sˇÀd_ã°
 ("g721_32.au", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_AU
 | 
SF_FORMAT_G721_32
, -34.0) ;

91 
	`Êﬂt_sˇÀd_ã°
 ("g723_24.au", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_AU
 | 
SF_FORMAT_G723_24
, -34.0) ;

92 
	`Êﬂt_sˇÀd_ã°
 ("g723_40.au", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_AU
 | 
SF_FORMAT_G723_40
, -40.0) ;

97 
	`Êﬂt_sˇÀd_ã°
 ("À_∑f_24.∑f", 
Ælow_exô
, 
SF_FALSE
, 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_PAF
 | 
SF_FORMAT_PCM_24
, -149.0) ;

98 
	`Êﬂt_sˇÀd_ã°
 ("be_∑f_24.∑f", 
Ælow_exô
, 
SF_FALSE
, 
SF_ENDIAN_BIG
 | 
SF_FORMAT_PAF
 | 
SF_FORMAT_PCM_24
, -149.0) ;

100 
	`Êﬂt_sˇÀd_ã°
 ("dwvw_12.øw", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_DWVW_12
, -64.0) ;

101 
	`Êﬂt_sˇÀd_ã°
 ("dwvw_16.øw", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_DWVW_16
, -92.0) ;

102 
	`Êﬂt_sˇÀd_ã°
 ("dwvw_24.øw", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_DWVW_24
, -151.0) ;

104 
	`Êﬂt_sˇÀd_ã°
 ("adpcm.vox", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_VOX_ADPCM
, -40.0) ;

106 
	`Êﬂt_sˇÀd_ã°
 ("dpcm_16.xi", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_XI
 | 
SF_FORMAT_DPCM_16
, -90.0) ;

107 
	`Êﬂt_sˇÀd_ã°
 ("dpcm_8.xi" , 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_XI
 | 
SF_FORMAT_DPCM_8
 , -41.0) ;

109 
	`Êﬂt_sˇÀd_ã°
 ("pcm_s8.sds", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_SDS
 | 
SF_FORMAT_PCM_S8
, -90.0) ;

110 
	`Êﬂt_sˇÀd_ã°
 ("pcm_16.sds", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_SDS
 | 
SF_FORMAT_PCM_16
, -140.0) ;

111 
	`Êﬂt_sˇÀd_ã°
 ("pcm_24.sds", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_SDS
 | 
SF_FORMAT_PCM_24
, -170.0) ;

113 #ifde‡
HAVE_FLAC_ALL_H


114 
	`Êﬂt_sˇÀd_ã°
 ("Êac_8.Êac", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_FLAC
 | 
SF_FORMAT_PCM_S8
, -39.0) ;

115 
	`Êﬂt_sˇÀd_ã°
 ("Êac_16.Êac", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_FLAC
 | 
SF_FORMAT_PCM_16
, -87.0) ;

116 
	`Êﬂt_sˇÀd_ã°
 ("Êac_24.Êac", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_FLAC
 | 
SF_FORMAT_PCM_24
, -138.0) ;

119 
	`Êﬂt_sˇÀd_ã°
 ("ª∂a˚_Êﬂt.øw", 
Ælow_exô
, 
SF_TRUE
, 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_FLOAT
, -163.0) ;

125 
	`doubÀ_sˇÀd_ã°
 ("doubÀ.øw", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_DOUBLE
, -300.0) ;

128 
	`doubÀ_sˇÀd_ã°
 ("pcm_s8.øw", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_S8
, -39.0) ;

129 
	`doubÀ_sˇÀd_ã°
 ("pcm_u8.øw", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_U8
, -39.0) ;

131 
	`doubÀ_sˇÀd_ã°
 ("pcm_16.øw", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_16
, -87.0) ;

132 
	`doubÀ_sˇÀd_ã°
 ("pcm_24.øw", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_24
, -135.0) ;

133 
	`doubÀ_sˇÀd_ã°
 ("pcm_32.øw", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_32
, -184.0) ;

135 
	`doubÀ_sˇÀd_ã°
 ("uœw.øw", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_ULAW
, -50.0) ;

136 
	`doubÀ_sˇÀd_ã°
 ("Æaw.øw", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_ALAW
, -49.0) ;

138 
	`doubÀ_sˇÀd_ã°
 ("ima_adpcm.wav", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_WAV
 | 
SF_FORMAT_IMA_ADPCM
, -47.0) ;

139 
	`doubÀ_sˇÀd_ã°
 ("ms_adpcm.wav" , 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_WAV
 | 
SF_FORMAT_MS_ADPCM
, -40.0) ;

140 
	`doubÀ_sˇÀd_ã°
 ("gsm610.øw" , 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_GSM610
, -33.0) ;

142 
	`doubÀ_sˇÀd_ã°
 ("g721_32.au", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_AU
 | 
SF_FORMAT_G721_32
, -34.0) ;

143 
	`doubÀ_sˇÀd_ã°
 ("g723_24.au", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_AU
 | 
SF_FORMAT_G723_24
, -34.0) ;

144 
	`doubÀ_sˇÀd_ã°
 ("g723_40.au", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_AU
 | 
SF_FORMAT_G723_40
, -40.0) ;

147 
	`doubÀ_sˇÀd_ã°
 ("be_∑f_24.∑f", 
Ælow_exô
, 
SF_FALSE
, 
SF_ENDIAN_BIG
 | 
SF_FORMAT_PAF
 | 
SF_FORMAT_PCM_24
, -151.0) ;

148 
	`doubÀ_sˇÀd_ã°
 ("À_∑f_24.∑f", 
Ælow_exô
, 
SF_FALSE
, 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_PAF
 | 
SF_FORMAT_PCM_24
, -151.0) ;

150 
	`doubÀ_sˇÀd_ã°
 ("dwvw_12.øw", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_DWVW_12
, -64.0) ;

151 
	`doubÀ_sˇÀd_ã°
 ("dwvw_16.øw", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_DWVW_16
, -92.0) ;

152 
	`doubÀ_sˇÀd_ã°
 ("dwvw_24.øw", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_DWVW_24
, -151.0) ;

154 
	`doubÀ_sˇÀd_ã°
 ("adpcm.vox" , 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_VOX_ADPCM
, -40.0) ;

156 
	`doubÀ_sˇÀd_ã°
 ("dpcm_16.xi", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_XI
 | 
SF_FORMAT_DPCM_16
, -90.0) ;

157 
	`doubÀ_sˇÀd_ã°
 ("dpcm_8.xi" , 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_XI
 | 
SF_FORMAT_DPCM_8
 , -42.0) ;

159 
	`doubÀ_sˇÀd_ã°
 ("pcm_s8.sds", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_SDS
 | 
SF_FORMAT_PCM_S8
, -90.0) ;

160 
	`doubÀ_sˇÀd_ã°
 ("pcm_16.sds", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_SDS
 | 
SF_FORMAT_PCM_16
, -140.0) ;

161 
	`doubÀ_sˇÀd_ã°
 ("pcm_24.sds", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_SDS
 | 
SF_FORMAT_PCM_24
, -180.0) ;

163 #ifde‡
HAVE_FLAC_ALL_H


164 
	`doubÀ_sˇÀd_ã°
 ("Êac_8.Êac", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_FLAC
 | 
SF_FORMAT_PCM_S8
, -39.0) ;

165 
	`doubÀ_sˇÀd_ã°
 ("Êac_16.Êac", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_FLAC
 | 
SF_FORMAT_PCM_16
, -87.0) ;

166 
	`doubÀ_sˇÀd_ã°
 ("Êac_24.Êac", 
Ælow_exô
, 
SF_FALSE
, 
SF_FORMAT_FLAC
 | 
SF_FORMAT_PCM_24
, -138.0) ;

169 
	`doubÀ_sˇÀd_ã°
 ("ª∂a˚_doubÀ.øw", 
Ælow_exô
, 
SF_TRUE
, 
SF_FORMAT_RAW
 | 
SF_FORMAT_DOUBLE
, -300.0) ;

171 
	`putch¨
 ('\n') ;

173 
	`Êﬂt_sh‹t_lôée_ã°
 ("float_short_little.au") ;

174 
	`Êﬂt_sh‹t_big_ã°
 ("float_short_big.au") ;

175 
	`Êﬂt_öt_lôée_ã°
 ("float_int_little.au") ;

176 
	`Êﬂt_öt_big_ã°
 ("float_int_big.au") ;

177 
	`doubÀ_sh‹t_lôée_ã°
 ("double_short_little.au") ;

178 
	`doubÀ_sh‹t_big_ã°
 ("double_short_big.au") ;

179 
	`doubÀ_öt_lôée_ã°
 ("double_int_little.au") ;

180 
	`doubÀ_öt_big_ã°
 ("double_int_big.au") ;

184 
	}
}

191 
	$Êﬂt_sˇÀd_ã°
 (c⁄° *
fûíame
, 
Ælow_exô
, 
ª∂a˚_Êﬂt
, 
fûëy≥
, 
èrgë_¢r
)

192 { 
Êﬂt_‹ig
 [
DFT_DATA_LENGTH
] ;

193 
Êﬂt_ã°
 [
DFT_DATA_LENGTH
] ;

195 
SNDFILE
 *
fûe
 ;

196 
SF_INFO
 
sföfo
 ;

197 
k
 ;

198 
¢r
 ;

200 
	`¥öt_ã°_«me
 ("Êﬂt_sˇÀd_ã°", 
fûíame
) ;

202 
	`gí_wödowed_söe_doubÀ
 (
doubÀ_d©a
, 
DFT_DATA_LENGTH
, 1.0) ;

204 
k
 = 0 ; k < 
DFT_DATA_LENGTH
 ; k++)

205 
Êﬂt_‹ig
 [
k
] = 
doubÀ_d©a
 [k] ;

207 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

208 
sföfo
.
‰ames
 = 
DFT_DATA_LENGTH
 ;

209 
sföfo
.
ch™√ls
 = 1 ;

210 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

212 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

213 
	`sf_comm™d
 (
fûe
, 
SFC_TEST_IEEE_FLOAT_REPLACE
, 
NULL
, 
ª∂a˚_Êﬂt
) ;

215 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
fûe
, 0, 
Êﬂt_‹ig
, 
DFT_DATA_LENGTH
, 
__LINE__
) ;

217 
	`sf_˛o£
 (
fûe
) ;

219 
	`mem£t
 (
Êﬂt_ã°
, 0,  (float_test)) ;

221 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

222 
	`sf_comm™d
 (
fûe
, 
SFC_TEST_IEEE_FLOAT_REPLACE
, 
NULL
, 
ª∂a˚_Êﬂt
) ;

224 
	`exô_if_åue
 (
sföfo
.
f‹m©
 !
fûëy≥
, "\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, filetype, sfinfo.format) ;

225 
	`exô_if_åue
 (
sföfo
.
‰ames
 < 
DFT_DATA_LENGTH
, "\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûê—oÿsh‹t). (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (sfinfo.frames), DFT_DATA_LENGTH) ;

226 
	`exô_if_åue
 (
sföfo
.
ch™√ls
 !1, "\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

228 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

230 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
Êﬂt_ã°
, 
DFT_DATA_LENGTH
, 
__LINE__
) ;

232 
	`sf_˛o£
 (
fûe
) ;

234 
k
 = 0 ; k < 
DFT_DATA_LENGTH
 ; k++)

235 
ã°_d©a
 [
k
] = 
Êﬂt_ã°
 [k] ;

237 
¢r
 = 
	`d·_cmp
 (
__LINE__
, 
doubÀ_d©a
, 
ã°_d©a
, 
DFT_DATA_LENGTH
, 
èrgë_¢r
, 
Ælow_exô
) ;

239 
	`exô_if_åue
 (
¢r
 > 
èrgë_¢r
, "% 6.1fdB SNR\n\n Error : should be betterÅhan % 6.1fdB\n\n", snr,Åarget_snr) ;

241 
	`¥ötf
 ("% 6.1fdB SNR ... ok\n", 
¢r
) ;

243 
	`u∆ök
 (
fûíame
) ;

246 
	}
}

249 
	$doubÀ_sˇÀd_ã°
 (c⁄° *
fûíame
, 
Ælow_exô
, 
ª∂a˚_Êﬂt
, 
fûëy≥
, 
èrgë_¢r
)

250 { 
SNDFILE
 *
fûe
 ;

251 
SF_INFO
 
sföfo
 ;

252 
¢r
 ;

254 
	`¥öt_ã°_«me
 ("doubÀ_sˇÀd_ã°", 
fûíame
) ;

256 
	`gí_wödowed_söe_doubÀ
 (
doubÀ_d©a
, 
DFT_DATA_LENGTH
, 0.95) ;

258 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

259 
sföfo
.
‰ames
 = 
DFT_DATA_LENGTH
 ;

260 
sföfo
.
ch™√ls
 = 1 ;

261 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

263 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

264 
	`sf_comm™d
 (
fûe
, 
SFC_TEST_IEEE_FLOAT_REPLACE
, 
NULL
, 
ª∂a˚_Êﬂt
) ;

266 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
doubÀ_d©a
, 
DFT_DATA_LENGTH
, 
__LINE__
) ;

268 
	`sf_˛o£
 (
fûe
) ;

270 
	`mem£t
 (
ã°_d©a
, 0,  (test_data)) ;

272 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

273 
	`sf_comm™d
 (
fûe
, 
SFC_TEST_IEEE_FLOAT_REPLACE
, 
NULL
, 
ª∂a˚_Êﬂt
) ;

275 
	`exô_if_åue
 (
sföfo
.
f‹m©
 !
fûëy≥
, "\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, filetype, sfinfo.format) ;

276 
	`exô_if_åue
 (
sföfo
.
‰ames
 < 
DFT_DATA_LENGTH
, "\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûê—oÿsh‹t). (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (sfinfo.frames), DFT_DATA_LENGTH) ;

277 
	`exô_if_åue
 (
sföfo
.
ch™√ls
 !1, "\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

279 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

281 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
ã°_d©a
, 
DFT_DATA_LENGTH
, 
__LINE__
) ;

283 
	`sf_˛o£
 (
fûe
) ;

285 
¢r
 = 
	`d·_cmp
 (
__LINE__
, 
doubÀ_d©a
, 
ã°_d©a
, 
DFT_DATA_LENGTH
, 
èrgë_¢r
, 
Ælow_exô
) ;

287 
	`exô_if_åue
 (
¢r
 > 
èrgë_¢r
, "% 6.1fdB SNR\n\n Error : should be betterÅhan % 6.1fdB\n\n", snr,Åarget_snr) ;

289 
	`¥ötf
 ("% 6.1fdB SNR ... ok\n", 
¢r
) ;

291 
	`u∆ök
 (
fûíame
) ;

294 
	}
}

301 
	$Êﬂt_sh‹t_lôée_ã°
 (c⁄° * 
fûíame
)

302 { 
SNDFILE
 *
fûe
 ;

303 
SF_INFO
 
sföfo
 ;

304 
k
, 
max
 ;

306 
	`¥öt_ã°_«me
 ("Êﬂt_sh‹t_lôée_ã°", 
fûíame
) ;

308 
	`gí_wödowed_söe_Êﬂt
 (
Êﬂt_d©a
, 
	`ARRAY_LEN
 (float_data), 0.98) ;

310 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

311 
sföfo
.
‰ames
 = 
	`ARRAY_LEN
 (
sh‹t_d©a
) ;

312 
sföfo
.
ch™√ls
 = 1 ;

313 
sföfo
.
f‹m©
 = 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_FLOAT
 ;

315 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

316 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
fûe
, 0, 
Êﬂt_d©a
, 
	`ARRAY_LEN
 (Êﬂt_d©a), 
__LINE__
) ;

317 
	`sf_˛o£
 (
fûe
) ;

319 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

321 i‡(
sföfo
.
‰ames
 !
	`ARRAY_LEN
 (
Êﬂt_d©a
))

322 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûê—oÿsh‹t). (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
DFT_DATA_LENGTH
) ;

323 
	`exô
 (1) ;

326 i‡(
sföfo
.
ch™√ls
 != 1)

327 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

328 
	`exô
 (1) ;

331 
	`sf_comm™d
 (
fûe
, 
SFC_SET_SCALE_FLOAT_INT_READ
, 
NULL
, 
SF_TRUE
) ;

333 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 0, 
sh‹t_d©a
, 
	`ARRAY_LEN
 (sh‹t_d©a), 
__LINE__
) ;

334 
	`sf_˛o£
 (
fûe
) ;

336 
max
 = 0 ;

337 
k
 = 0 ; k < 
	`ARRAY_LEN
 (
sh‹t_d©a
) ; k++)

338 i‡(
	`abs
 (
sh‹t_d©a
 [
k
]Ë> 
max
)

339 
max
 = 
	`abs
 (
sh‹t_d©a
 [
k
]) ;

341 i‡(1.0 * 
	`abs
 (
max
 - 0x7FFF) / 0x7FFF > 0.01)

342 { 
	`¥ötf
 ("\n\nLöê%d: Bad maximum (%d should bê%d).\n\n", 
__LINE__
, 
max
, 0x7FFF) ;

343 
	`exô
 (1) ;

346 
	`u∆ök
 (
fûíame
) ;

347 
	`puts
 ("ok") ;

348 
	}
}

351 
	$Êﬂt_sh‹t_big_ã°
 (c⁄° * 
fûíame
)

352 { 
SNDFILE
 *
fûe
 ;

353 
SF_INFO
 
sföfo
 ;

354 
k
, 
max
 ;

356 
	`¥öt_ã°_«me
 ("Êﬂt_sh‹t_big_ã°", 
fûíame
) ;

358 
	`gí_wödowed_söe_Êﬂt
 (
Êﬂt_d©a
, 
	`ARRAY_LEN
 (float_data), 0.98) ;

360 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

361 
sföfo
.
‰ames
 = 
	`ARRAY_LEN
 (
sh‹t_d©a
) ;

362 
sföfo
.
ch™√ls
 = 1 ;

363 
sföfo
.
f‹m©
 = 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_FLOAT
 ;

365 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

366 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
fûe
, 0, 
Êﬂt_d©a
, 
	`ARRAY_LEN
 (Êﬂt_d©a), 
__LINE__
) ;

367 
	`sf_˛o£
 (
fûe
) ;

369 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

371 i‡(
sföfo
.
‰ames
 !
	`ARRAY_LEN
 (
Êﬂt_d©a
))

372 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûê—oÿsh‹t). (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
DFT_DATA_LENGTH
) ;

373 
	`exô
 (1) ;

376 i‡(
sföfo
.
ch™√ls
 != 1)

377 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

378 
	`exô
 (1) ;

381 
	`sf_comm™d
 (
fûe
, 
SFC_SET_SCALE_FLOAT_INT_READ
, 
NULL
, 
SF_TRUE
) ;

383 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 0, 
sh‹t_d©a
, 
	`ARRAY_LEN
 (sh‹t_d©a), 
__LINE__
) ;

384 
	`sf_˛o£
 (
fûe
) ;

386 
max
 = 0 ;

387 
k
 = 0 ; k < 
	`ARRAY_LEN
 (
sh‹t_d©a
) ; k++)

388 i‡(
	`abs
 (
sh‹t_d©a
 [
k
]Ë> 
max
)

389 
max
 = 
	`abs
 (
sh‹t_d©a
 [
k
]) ;

391 i‡(1.0 * 
	`abs
 (
max
 - 0x7FFF) / 0x7FFF > 0.01)

392 { 
	`¥ötf
 ("\n\nLöê%d: Bad maximum (%d should bê%d).\n\n", 
__LINE__
, 
max
, 0x7FFF) ;

393 
	`exô
 (1) ;

396 
	`u∆ök
 (
fûíame
) ;

397 
	`puts
 ("ok") ;

398 
	}
}

401 
	$Êﬂt_öt_lôée_ã°
 (c⁄° * 
fûíame
)

402 { 
SNDFILE
 *
fûe
 ;

403 
SF_INFO
 
sföfo
 ;

404 
k
, 
max
 ;

406 
	`¥öt_ã°_«me
 ("Êﬂt_öt_lôée_ã°", 
fûíame
) ;

408 
	`gí_wödowed_söe_Êﬂt
 (
Êﬂt_d©a
, 
	`ARRAY_LEN
 (float_data), 0.98) ;

410 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

411 
sföfo
.
‰ames
 = 
	`ARRAY_LEN
 (
öt_d©a
) ;

412 
sföfo
.
ch™√ls
 = 1 ;

413 
sföfo
.
f‹m©
 = 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_FLOAT
 ;

415 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

416 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
fûe
, 0, 
Êﬂt_d©a
, 
	`ARRAY_LEN
 (Êﬂt_d©a), 
__LINE__
) ;

417 
	`sf_˛o£
 (
fûe
) ;

419 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

421 i‡(
sföfo
.
‰ames
 !
	`ARRAY_LEN
 (
Êﬂt_d©a
))

422 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûê—oÿsh‹t). (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
DFT_DATA_LENGTH
) ;

423 
	`exô
 (1) ;

426 i‡(
sföfo
.
ch™√ls
 != 1)

427 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

428 
	`exô
 (1) ;

431 
	`sf_comm™d
 (
fûe
, 
SFC_SET_SCALE_FLOAT_INT_READ
, 
NULL
, 
SF_TRUE
) ;

433 
	`ã°_ªad_öt_‹_dõ
 (
fûe
, 0, 
öt_d©a
, 
	`ARRAY_LEN
 (öt_d©a), 
__LINE__
) ;

434 
	`sf_˛o£
 (
fûe
) ;

436 
max
 = 0 ;

437 
k
 = 0 ; k < 
	`ARRAY_LEN
 (
öt_d©a
) ; k++)

438 i‡(
	`abs
 (
öt_d©a
 [
k
]Ë> 
max
)

439 
max
 = 
	`abs
 (
öt_d©a
 [
k
]) ;

441 i‡(1.0 * 
	`abs
 (
max
 - 0x7FFFFFFF) / 0x7FFFFFFF > 0.01)

442 { 
	`¥ötf
 ("\n\nLöê%d: Bad maximum (%d should bê%d).\n\n", 
__LINE__
, 
max
, 0x7FFFFFFF) ;

443 
	`exô
 (1) ;

446 
	`u∆ök
 (
fûíame
) ;

447 
	`puts
 ("ok") ;

448 
	}
}

451 
	$Êﬂt_öt_big_ã°
 (c⁄° * 
fûíame
)

452 { 
SNDFILE
 *
fûe
 ;

453 
SF_INFO
 
sföfo
 ;

454 
k
, 
max
 ;

456 
	`¥öt_ã°_«me
 ("Êﬂt_öt_big_ã°", 
fûíame
) ;

458 
	`gí_wödowed_söe_Êﬂt
 (
Êﬂt_d©a
, 
	`ARRAY_LEN
 (float_data), 0.98) ;

460 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

461 
sföfo
.
‰ames
 = 
	`ARRAY_LEN
 (
öt_d©a
) ;

462 
sföfo
.
ch™√ls
 = 1 ;

463 
sföfo
.
f‹m©
 = 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_FLOAT
 ;

465 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

466 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
fûe
, 0, 
Êﬂt_d©a
, 
	`ARRAY_LEN
 (Êﬂt_d©a), 
__LINE__
) ;

467 
	`sf_˛o£
 (
fûe
) ;

469 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

471 i‡(
sföfo
.
‰ames
 !
	`ARRAY_LEN
 (
Êﬂt_d©a
))

472 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûê—oÿsh‹t). (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
DFT_DATA_LENGTH
) ;

473 
	`exô
 (1) ;

476 i‡(
sföfo
.
ch™√ls
 != 1)

477 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

478 
	`exô
 (1) ;

481 
	`sf_comm™d
 (
fûe
, 
SFC_SET_SCALE_FLOAT_INT_READ
, 
NULL
, 
SF_TRUE
) ;

483 
	`ã°_ªad_öt_‹_dõ
 (
fûe
, 0, 
öt_d©a
, 
	`ARRAY_LEN
 (öt_d©a), 
__LINE__
) ;

484 
	`sf_˛o£
 (
fûe
) ;

486 
max
 = 0 ;

487 
k
 = 0 ; k < 
	`ARRAY_LEN
 (
öt_d©a
) ; k++)

488 i‡(
	`abs
 (
öt_d©a
 [
k
]Ë> 
max
)

489 
max
 = 
	`abs
 (
öt_d©a
 [
k
]) ;

491 i‡(1.0 * 
	`abs
 (
max
 - 0x7FFFFFFF) / 0x7FFFFFFF > 0.01)

492 { 
	`¥ötf
 ("\n\nLöê%d: Bad maximum (%d should bê%d).\n\n", 
__LINE__
, 
max
, 0x7FFFFFFF) ;

493 
	`exô
 (1) ;

496 
	`u∆ök
 (
fûíame
) ;

497 
	`puts
 ("ok") ;

498 
	}
}

501 
	$doubÀ_sh‹t_lôée_ã°
 (c⁄° * 
fûíame
)

502 { 
SNDFILE
 *
fûe
 ;

503 
SF_INFO
 
sföfo
 ;

504 
k
, 
max
 ;

506 
	`¥öt_ã°_«me
 ("doubÀ_sh‹t_lôée_ã°", 
fûíame
) ;

508 
	`gí_wödowed_söe_doubÀ
 (
doubÀ_d©a
, 
	`ARRAY_LEN
 (double_data), 0.98) ;

510 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

511 
sföfo
.
‰ames
 = 
	`ARRAY_LEN
 (
sh‹t_d©a
) ;

512 
sföfo
.
ch™√ls
 = 1 ;

513 
sföfo
.
f‹m©
 = 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_DOUBLE
 ;

515 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

516 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
doubÀ_d©a
, 
	`ARRAY_LEN
 (doubÀ_d©a), 
__LINE__
) ;

517 
	`sf_˛o£
 (
fûe
) ;

519 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

521 i‡(
sföfo
.
‰ames
 !
	`ARRAY_LEN
 (
doubÀ_d©a
))

522 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûê—oÿsh‹t). (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
DFT_DATA_LENGTH
) ;

523 
	`exô
 (1) ;

526 i‡(
sföfo
.
ch™√ls
 != 1)

527 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

528 
	`exô
 (1) ;

531 
	`sf_comm™d
 (
fûe
, 
SFC_SET_SCALE_FLOAT_INT_READ
, 
NULL
, 
SF_TRUE
) ;

533 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 0, 
sh‹t_d©a
, 
	`ARRAY_LEN
 (sh‹t_d©a), 
__LINE__
) ;

534 
	`sf_˛o£
 (
fûe
) ;

536 
max
 = 0 ;

537 
k
 = 0 ; k < 
	`ARRAY_LEN
 (
sh‹t_d©a
) ; k++)

538 i‡(
	`abs
 (
sh‹t_d©a
 [
k
]Ë> 
max
)

539 
max
 = 
	`abs
 (
sh‹t_d©a
 [
k
]) ;

541 i‡(1.0 * 
	`abs
 (
max
 - 0x7FFF) / 0x7FFF > 0.01)

542 { 
	`¥ötf
 ("\n\nLöê%d: Bad maximum (%d should bê%d).\n\n", 
__LINE__
, 
max
, 0x7FFF) ;

543 
	`exô
 (1) ;

546 
	`u∆ök
 (
fûíame
) ;

547 
	`puts
 ("ok") ;

548 
	}
}

551 
	$doubÀ_sh‹t_big_ã°
 (c⁄° * 
fûíame
)

552 { 
SNDFILE
 *
fûe
 ;

553 
SF_INFO
 
sföfo
 ;

554 
k
, 
max
 ;

556 
	`¥öt_ã°_«me
 ("doubÀ_sh‹t_big_ã°", 
fûíame
) ;

558 
	`gí_wödowed_söe_doubÀ
 (
doubÀ_d©a
, 
	`ARRAY_LEN
 (double_data), 0.98) ;

560 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

561 
sföfo
.
‰ames
 = 
	`ARRAY_LEN
 (
sh‹t_d©a
) ;

562 
sföfo
.
ch™√ls
 = 1 ;

563 
sföfo
.
f‹m©
 = 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_DOUBLE
 ;

565 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

566 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
doubÀ_d©a
, 
	`ARRAY_LEN
 (doubÀ_d©a), 
__LINE__
) ;

567 
	`sf_˛o£
 (
fûe
) ;

569 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

571 i‡(
sföfo
.
‰ames
 !
	`ARRAY_LEN
 (
doubÀ_d©a
))

572 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûê—oÿsh‹t). (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
DFT_DATA_LENGTH
) ;

573 
	`exô
 (1) ;

576 i‡(
sföfo
.
ch™√ls
 != 1)

577 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

578 
	`exô
 (1) ;

581 
	`sf_comm™d
 (
fûe
, 
SFC_SET_SCALE_FLOAT_INT_READ
, 
NULL
, 
SF_TRUE
) ;

583 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 0, 
sh‹t_d©a
, 
	`ARRAY_LEN
 (sh‹t_d©a), 
__LINE__
) ;

584 
	`sf_˛o£
 (
fûe
) ;

586 
max
 = 0 ;

587 
k
 = 0 ; k < 
	`ARRAY_LEN
 (
sh‹t_d©a
) ; k++)

588 i‡(
	`abs
 (
sh‹t_d©a
 [
k
]Ë> 
max
)

589 
max
 = 
	`abs
 (
sh‹t_d©a
 [
k
]) ;

591 i‡(1.0 * 
	`abs
 (
max
 - 0x7FFF) / 0x7FFF > 0.01)

592 { 
	`¥ötf
 ("\n\nLöê%d: Bad maximum (%d should bê%d).\n\n", 
__LINE__
, 
max
, 0x7FFF) ;

593 
	`exô
 (1) ;

596 
	`u∆ök
 (
fûíame
) ;

597 
	`puts
 ("ok") ;

598 
	}
}

601 
	$doubÀ_öt_lôée_ã°
 (c⁄° * 
fûíame
)

602 { 
SNDFILE
 *
fûe
 ;

603 
SF_INFO
 
sföfo
 ;

604 
k
, 
max
 ;

606 
	`¥öt_ã°_«me
 ("doubÀ_öt_lôée_ã°", 
fûíame
) ;

608 
	`gí_wödowed_söe_doubÀ
 (
doubÀ_d©a
, 
	`ARRAY_LEN
 (double_data), 0.98) ;

610 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

611 
sföfo
.
‰ames
 = 
	`ARRAY_LEN
 (
öt_d©a
) ;

612 
sföfo
.
ch™√ls
 = 1 ;

613 
sföfo
.
f‹m©
 = 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_DOUBLE
 ;

615 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

616 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
doubÀ_d©a
, 
	`ARRAY_LEN
 (doubÀ_d©a), 
__LINE__
) ;

617 
	`sf_˛o£
 (
fûe
) ;

619 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

621 i‡(
sföfo
.
‰ames
 !
	`ARRAY_LEN
 (
doubÀ_d©a
))

622 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûê—oÿsh‹t). (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
DFT_DATA_LENGTH
) ;

623 
	`exô
 (1) ;

626 i‡(
sföfo
.
ch™√ls
 != 1)

627 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

628 
	`exô
 (1) ;

631 
	`sf_comm™d
 (
fûe
, 
SFC_SET_SCALE_FLOAT_INT_READ
, 
NULL
, 
SF_TRUE
) ;

633 
	`ã°_ªad_öt_‹_dõ
 (
fûe
, 0, 
öt_d©a
, 
	`ARRAY_LEN
 (öt_d©a), 
__LINE__
) ;

634 
	`sf_˛o£
 (
fûe
) ;

636 
max
 = 0 ;

637 
k
 = 0 ; k < 
	`ARRAY_LEN
 (
öt_d©a
) ; k++)

638 i‡(
	`abs
 (
öt_d©a
 [
k
]Ë> 
max
)

639 
max
 = 
	`abs
 (
öt_d©a
 [
k
]) ;

641 i‡(1.0 * 
	`abs
 (
max
 - 0x7FFFFFFF) / 0x7FFFFFFF > 0.01)

642 { 
	`¥ötf
 ("\n\nLöê%d: Bad maximum (%d should bê%d).\n\n", 
__LINE__
, 
max
, 0x7FFFFFFF) ;

643 
	`exô
 (1) ;

646 
	`u∆ök
 (
fûíame
) ;

647 
	`puts
 ("ok") ;

648 
	}
}

651 
	$doubÀ_öt_big_ã°
 (c⁄° * 
fûíame
)

652 { 
SNDFILE
 *
fûe
 ;

653 
SF_INFO
 
sföfo
 ;

654 
k
, 
max
 ;

656 
	`¥öt_ã°_«me
 ("doubÀ_öt_big_ã°", 
fûíame
) ;

658 
	`gí_wödowed_söe_doubÀ
 (
doubÀ_d©a
, 
	`ARRAY_LEN
 (double_data), 0.98) ;

660 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

661 
sföfo
.
‰ames
 = 
	`ARRAY_LEN
 (
öt_d©a
) ;

662 
sföfo
.
ch™√ls
 = 1 ;

663 
sföfo
.
f‹m©
 = 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_DOUBLE
 ;

665 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

666 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
doubÀ_d©a
, 
	`ARRAY_LEN
 (doubÀ_d©a), 
__LINE__
) ;

667 
	`sf_˛o£
 (
fûe
) ;

669 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

671 i‡(
sföfo
.
‰ames
 !
	`ARRAY_LEN
 (
doubÀ_d©a
))

672 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûê—oÿsh‹t). (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
DFT_DATA_LENGTH
) ;

673 
	`exô
 (1) ;

676 i‡(
sföfo
.
ch™√ls
 != 1)

677 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

678 
	`exô
 (1) ;

681 
	`sf_comm™d
 (
fûe
, 
SFC_SET_SCALE_FLOAT_INT_READ
, 
NULL
, 
SF_TRUE
) ;

683 
	`ã°_ªad_öt_‹_dõ
 (
fûe
, 0, 
öt_d©a
, 
	`ARRAY_LEN
 (öt_d©a), 
__LINE__
) ;

684 
	`sf_˛o£
 (
fûe
) ;

686 
max
 = 0 ;

687 
k
 = 0 ; k < 
	`ARRAY_LEN
 (
öt_d©a
) ; k++)

688 i‡(
	`abs
 (
öt_d©a
 [
k
]Ë> 
max
)

689 
max
 = 
	`abs
 (
öt_d©a
 [
k
]) ;

691 i‡(1.0 * 
	`abs
 (
max
 - 0x7FFFFFFF) / 0x7FFFFFFF > 0.01)

692 { 
	`¥ötf
 ("\n\nLöê%d: Bad maximum (%d should bê%d).\n\n", 
__LINE__
, 
max
, 0x7FFFFFFF) ;

693 
	`exô
 (1) ;

696 
	`u∆ök
 (
fûíame
) ;

697 
	`puts
 ("ok") ;

698 
	}
}

	@libsndfile-1.0.17/tests/header_test.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

25 
	~<sys/°©.h
>

26 
	~<m©h.h
>

28 #i‡
HAVE_UNISTD_H


29 
	~<uni°d.h
>

32 #i‡(
HAVE_DECL_S_IRGRP
 == 0)

33 
	~<sf_uni°d.h
>

36 #i‡(
deföed
 (
WIN32
Ë|| deföed (
_WIN32
))

37 
	~<io.h
>

38 
	~<dúe˘.h
>

41 
	~<¢dfûe.h
>

43 
	~"utûs.h
"

45 
	#BUFFER_LEN
 (1<<10)

	)

46 
	#LOG_BUFFER_SIZE
 1024

	)

48 
upd©e_hódî_ã°
 (c⁄° *
fûíame
, 
ty≥maj‹
) ;

50 
upd©e_£ek_sh‹t_ã°
 (c⁄° *
fûíame
, 
fûëy≥
) ;

51 
upd©e_£ek_öt_ã°
 (c⁄° *
fûíame
, 
fûëy≥
) ;

52 
upd©e_£ek_Êﬂt_ã°
 (c⁄° *
fûíame
, 
fûëy≥
) ;

53 
upd©e_£ek_doubÀ_ã°
 (c⁄° *
fûíame
, 
fûëy≥
) ;

56 
exåa_hódî_ã°
 (c⁄° *
fûíame
, 
fûëy≥
) ;

61 
	gd©a_out
 [
BUFFER_LEN
] ;

62 
	gd©a_ö
 [
BUFFER_LEN
] ;

65 
	$maö
 (
¨gc
, *
¨gv
 [])

66 { 
do_Æl
 = 0 ;

67 
ã°_cou¡
 = 0 ;

69 i‡(
¨gc
 != 2)

70 { 
	`¥ötf
 ("Ußgê: %†<ã°>\n", 
¨gv
 [0]) ;

71 
	`¥ötf
 (" Where <test> is one ofÅhe following:\n") ;

72 
	`¥ötf
 (" wav -Åest WAV fileÖeak chunk\n") ;

73 
	`¥ötf
 ("áiff -Åest AIFF file PEAK chunk\n") ;

74 
	`¥ötf
 ("áll -ÖerformállÅests\n") ;

75 
	`exô
 (1) ;

78 
do_Æl
=!
	`°rcmp
 (
¨gv
 [1], "all") ;

80 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "wav"))

81 { 
	`upd©e_hódî_ã°
 ("hódî.wav", 
SF_FORMAT_WAV
) ;

82 
	`upd©e_£ek_sh‹t_ã°
 ("hódî_sh‹t.wav", 
SF_FORMAT_WAV
) ;

83 
	`upd©e_£ek_öt_ã°
 ("hódî_öt.wav", 
SF_FORMAT_WAV
) ;

84 
	`upd©e_£ek_Êﬂt_ã°
 ("hódî_Êﬂt.wav", 
SF_FORMAT_WAV
) ;

85 
	`upd©e_£ek_doubÀ_ã°
 ("hódî_doubÀ.wav", 
SF_FORMAT_WAV
) ;

86 
	`exåa_hódî_ã°
 ("exåa.wav", 
SF_FORMAT_WAV
) ;

87 
ã°_cou¡
++ ;

90 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "aiff"))

91 { 
	`upd©e_hódî_ã°
 ("hódî.aiff", 
SF_FORMAT_AIFF
) ;

92 
	`upd©e_£ek_sh‹t_ã°
 ("hódî_sh‹t.aiff", 
SF_FORMAT_AIFF
) ;

93 
	`upd©e_£ek_öt_ã°
 ("hódî_öt.aiff", 
SF_FORMAT_AIFF
) ;

94 
	`upd©e_£ek_Êﬂt_ã°
 ("hódî_Êﬂt.aiff", 
SF_FORMAT_AIFF
) ;

95 
	`upd©e_£ek_doubÀ_ã°
 ("hódî_doubÀ.aiff", 
SF_FORMAT_AIFF
) ;

96 
	`exåa_hódî_ã°
 ("exåa.aiff", 
SF_FORMAT_AIFF
) ;

97 
ã°_cou¡
++ ;

100 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "au"))

101 { 
	`upd©e_hódî_ã°
 ("hódî.au", 
SF_FORMAT_AU
) ;

102 
	`upd©e_£ek_sh‹t_ã°
 ("hódî_sh‹t.au", 
SF_FORMAT_AU
) ;

103 
	`upd©e_£ek_öt_ã°
 ("hódî_öt.au", 
SF_FORMAT_AU
) ;

104 
	`upd©e_£ek_Êﬂt_ã°
 ("hódî_Êﬂt.au", 
SF_FORMAT_AU
) ;

105 
	`upd©e_£ek_doubÀ_ã°
 ("hódî_doubÀ.au", 
SF_FORMAT_AU
) ;

106 
ã°_cou¡
++ ;

109 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "caf"))

110 { 
	`upd©e_hódî_ã°
 ("hódî.ˇf", 
SF_FORMAT_CAF
) ;

111 
	`upd©e_£ek_sh‹t_ã°
 ("hódî_sh‹t.ˇf", 
SF_FORMAT_CAF
) ;

112 
	`upd©e_£ek_öt_ã°
 ("hódî_öt.ˇf", 
SF_FORMAT_CAF
) ;

113 
	`upd©e_£ek_Êﬂt_ã°
 ("hódî_Êﬂt.ˇf", 
SF_FORMAT_CAF
) ;

114 
	`upd©e_£ek_doubÀ_ã°
 ("hódî_doubÀ.ˇf", 
SF_FORMAT_CAF
) ;

116 
ã°_cou¡
++ ;

119 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "nist"))

120 { 
	`upd©e_hódî_ã°
 ("hódî.ni°", 
SF_FORMAT_NIST
) ;

121 
	`upd©e_£ek_sh‹t_ã°
 ("hódî_sh‹t.ni°", 
SF_FORMAT_NIST
) ;

122 
	`upd©e_£ek_öt_ã°
 ("hódî_öt.ni°", 
SF_FORMAT_NIST
) ;

123 
ã°_cou¡
++ ;

126 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "paf"))

127 { 
	`upd©e_hódî_ã°
 ("hódî.∑f", 
SF_FORMAT_PAF
) ;

128 
	`upd©e_£ek_sh‹t_ã°
 ("hódî_sh‹t.∑f", 
SF_FORMAT_PAF
) ;

129 
ã°_cou¡
++ ;

132 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "ircam"))

133 { 
	`upd©e_hódî_ã°
 ("hódî.úˇm", 
SF_FORMAT_IRCAM
) ;

134 
	`upd©e_£ek_sh‹t_ã°
 ("hódî_sh‹t.úˇm", 
SF_FORMAT_IRCAM
) ;

135 
ã°_cou¡
++ ;

138 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "w64"))

139 { 
	`upd©e_hódî_ã°
 ("hódî.w64", 
SF_FORMAT_W64
) ;

140 
	`upd©e_£ek_sh‹t_ã°
 ("hódî_sh‹t.w64", 
SF_FORMAT_W64
) ;

141 
	`upd©e_£ek_öt_ã°
 ("hódî_öt.w64", 
SF_FORMAT_W64
) ;

142 
	`upd©e_£ek_Êﬂt_ã°
 ("hódî_Êﬂt.w64", 
SF_FORMAT_W64
) ;

143 
	`upd©e_£ek_doubÀ_ã°
 ("hódî_doubÀ.w64", 
SF_FORMAT_W64
) ;

144 
ã°_cou¡
++ ;

147 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "mat4"))

148 { 
	`upd©e_hódî_ã°
 ("hódî.m©4", 
SF_FORMAT_MAT4
) ;

149 
	`upd©e_£ek_sh‹t_ã°
 ("hódî_sh‹t.m©4", 
SF_FORMAT_MAT4
) ;

150 
	`upd©e_£ek_öt_ã°
 ("hódî_öt.m©4", 
SF_FORMAT_MAT4
) ;

151 
	`upd©e_£ek_Êﬂt_ã°
 ("hódî_Êﬂt.m©4", 
SF_FORMAT_MAT4
) ;

152 
	`upd©e_£ek_doubÀ_ã°
 ("hódî_doubÀ.m©4", 
SF_FORMAT_MAT4
) ;

153 
ã°_cou¡
++ ;

156 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "mat5"))

157 { 
	`upd©e_hódî_ã°
 ("hódî.m©5", 
SF_FORMAT_MAT5
) ;

158 
	`upd©e_£ek_sh‹t_ã°
 ("hódî_sh‹t.m©5", 
SF_FORMAT_MAT5
) ;

159 
	`upd©e_£ek_öt_ã°
 ("hódî_öt.m©5", 
SF_FORMAT_MAT5
) ;

160 
	`upd©e_£ek_Êﬂt_ã°
 ("hódî_Êﬂt.m©5", 
SF_FORMAT_MAT5
) ;

161 
	`upd©e_£ek_doubÀ_ã°
 ("hódî_doubÀ.m©5", 
SF_FORMAT_MAT5
) ;

162 
ã°_cou¡
++ ;

165 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "pvf"))

166 { 
	`upd©e_hódî_ã°
 ("hódî.pvf", 
SF_FORMAT_PVF
) ;

167 
	`upd©e_£ek_sh‹t_ã°
 ("hódî_sh‹t.pvf", 
SF_FORMAT_PVF
) ;

168 
ã°_cou¡
++ ;

171 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "avr"))

172 { 
	`upd©e_hódî_ã°
 ("hódî.avr", 
SF_FORMAT_AVR
) ;

173 
	`upd©e_£ek_sh‹t_ã°
 ("hódî_sh‹t.avr", 
SF_FORMAT_AVR
) ;

174 
ã°_cou¡
++ ;

177 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "htk"))

178 { 
	`upd©e_hódî_ã°
 ("hódî.htk", 
SF_FORMAT_HTK
) ;

179 
	`upd©e_£ek_sh‹t_ã°
 ("hódî_sh‹t.htk", 
SF_FORMAT_HTK
) ;

180 
ã°_cou¡
++ ;

183 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "svx"))

184 { 
	`upd©e_hódî_ã°
 ("hódî.svx", 
SF_FORMAT_SVX
) ;

185 
	`upd©e_£ek_sh‹t_ã°
 ("hódî_sh‹t.svx", 
SF_FORMAT_SVX
) ;

186 
ã°_cou¡
++ ;

189 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "voc"))

190 { 
	`upd©e_hódî_ã°
 ("hódî.voc", 
SF_FORMAT_VOC
) ;

192 
ã°_cou¡
++ ;

195 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "sds"))

196 { 
	`upd©e_hódî_ã°
 ("hódî.sds", 
SF_FORMAT_SDS
) ;

198 
ã°_cou¡
++ ;

201 i‡(
ã°_cou¡
 == 0)

202 { 
	`¥ötf
 ("Mono : ************************************\n") ;

203 
	`¥ötf
 ("M⁄ÿ: * Nÿ'%s'Åe° deföed.\n", 
¨gv
 [1]) ;

204 
	`¥ötf
 ("Mono : ************************************\n") ;

209 
	}
}

217 
	$upd©e_hódî_sub
 (c⁄° *
fûíame
, 
ty≥maj‹
, 
wrôe_mode
)

218 { 
SNDFILE
 *
outfûe
, *
öfûe
 ;

219 
SF_INFO
 
sföfo
 ;

220 
k
, 
‰ames
 ;

222 
sföfo
.
ßm∂î©e
 = 44100 ;

223 
sföfo
.
f‹m©
 = (
ty≥maj‹
 | 
SF_FORMAT_PCM_16
) ;

224 
sföfo
.
ch™√ls
 = 1 ;

225 
sföfo
.
‰ames
 = 0 ;

227 
‰ames
 = 
BUFFER_LEN
 / 
sföfo
.
ch™√ls
 ;

229 
outfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
wrôe_mode
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

231 
k
 = 0 ; k < 
BUFFER_LEN
 ; k++)

232 
d©a_out
 [
k
] = k + 1 ;

233 
	`ã°_wrôe_öt_‹_dõ
 (
outfûe
, 0, 
d©a_out
, 
BUFFER_LEN
, 
__LINE__
) ;

235 i‡(
ty≥maj‹
 !
SF_FORMAT_HTK
)

237 
öfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

238 
	`sf_˛o£
 (
öfûe
) ;

241 
	`sf_comm™d
 (
outfûe
, 
SFC_UPDATE_HEADER_NOW
, 
NULL
, 0) ;

247 
öfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

248 
	`check_log_buf„r_‹_dõ
 (
öfûe
, 
__LINE__
) ;

250 i‡(
sföfo
.
‰ames
 < 
BUFFER_LEN
 || sfinfo.frames > BUFFER_LEN + 50)

251 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘ sam∂êcou¡ (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
BUFFER_LEN
) ;

252 
	`dump_log_buf„r
 (
öfûe
) ;

253 
	`exô
 (1) ;

256 
	`ã°_ªad_öt_‹_dõ
 (
öfûe
, 0, 
d©a_ö
, 
BUFFER_LEN
, 
__LINE__
) ;

257 
k
 = 0 ; k < 
BUFFER_LEN
 ; k++)

258 i‡(
d©a_out
 [
k
] != k + 1)

259 
	`¥ötf
 ("Eº‹ :Üöê%d\n", 
__LINE__
) ;

261 
	`sf_˛o£
 (
öfûe
) ;

264 
	`sf_comm™d
 (
outfûe
, 
SFC_SET_UPDATE_HEADER_AUTO
, 
NULL
, 
SF_TRUE
) ;

267 
k
 = 0 ; k < 
BUFFER_LEN
 ; k++)

268 
d©a_out
 [
k
] = k + 2 ;

269 
	`ã°_wrôe_öt_‹_dõ
 (
outfûe
, 0, 
d©a_out
, 
BUFFER_LEN
, 
__LINE__
) ;

272 
öfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

273 
	`check_log_buf„r_‹_dõ
 (
öfûe
, 
__LINE__
) ;

275 i‡(
sföfo
.
‰ames
 < 2 * 
BUFFER_LEN
 || sfinfo.frames > 2 * BUFFER_LEN + 50)

276 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘ sam∂êcou¡ (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 2 * 
BUFFER_LEN
) ;

277 
	`dump_log_buf„r
 (
öfûe
) ;

278 
	`exô
 (1) ;

281 
	`sf_˛o£
 (
öfûe
) ;

283 
	`sf_˛o£
 (
outfûe
) ;

285 
	`u∆ök
 (
fûíame
) ;

286 
	}
}

289 
	$upd©e_hódî_ã°
 (c⁄° *
fûíame
, 
ty≥maj‹
)

291 
	`¥öt_ã°_«me
 ("upd©e_hódî_ã°", 
fûíame
) ;

294 i‡(
ty≥maj‹
 =
SF_FORMAT_PAF
)

300 
	`puts
 ("doesn't work on win32") ;

305 
	`upd©e_hódî_sub
 (
fûíame
, 
ty≥maj‹
, 
SFM_WRITE
) ;

306 
	`upd©e_hódî_sub
 (
fûíame
, 
ty≥maj‹
, 
SFM_RDWR
) ;

308 
	`u∆ök
 (
fûíame
) ;

309 
	`puts
 ("ok") ;

310 
	}
}

316 
	$upd©e_£ek_sh‹t_ã°
 (c⁄° *
fûíame
, 
fûëy≥
)

317 { 
SNDFILE
 *
outfûe
, *
öfûe
 ;

318 
SF_INFO
 
sföfo
 ;

319 
sf_cou¡_t
 
‰ames
 ;

320 
buf„r
 [8] ;

321 
k
 ;

323 
	`¥öt_ã°_«me
 ("upd©e_£ek_sh‹t_ã°", 
fûíame
) ;

325 
	`mem£t
 (
buf„r
, 0,  (buffer)) ;

328 
sföfo
.
f‹m©
 = 
fûëy≥
 | 
SF_FORMAT_PCM_16
 ;

329 
sföfo
.
ßm∂î©e
 = 48000 ;

330 
sföfo
.
ch™√ls
 = 2 ;

332 i‡(
	`sf_f‹m©_check
 (&
sföfo
Ë=
SF_FALSE
)

333 
sföfo
.
ch™√ls
 = 1 ;

335 
outfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

336 
	`sf_˛o£
 (
outfûe
) ;

339 
outfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

346 i‡(
	`sf_comm™d
 (
outfûe
, 
SFC_SET_UPDATE_HEADER_AUTO
, 
NULL
, 
SF_TRUE
) == 0)

347 { 
	`¥ötf
 ("\n\nEº‹ : sf_comm™d (SFC_SET_UPDATE_HEADER_AUTOËªtu∫Éº‹ : %s\n\n", 
	`sf_°ªº‹
 (
outfûe
)) ;

348 
	`exô
 (1) ;

352 
‰ames
 = 
	`ARRAY_LEN
 (
buf„r
Ë/ 
sföfo
.
ch™√ls
 ;

354 
k
 = 0 ; k < 6 ; k++)

355 { 
	`ã°_£ek_‹_dõ
 (
outfûe
, 
k
 * 
‰ames
, 
SEEK_SET
, k * fømes, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

356 
	`ã°_£ek_‹_dõ
 (
outfûe
, 0, 
SEEK_END
, 
k
 * 
‰ames
, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

359 
öfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

360 
	`check_log_buf„r_‹_dõ
 (
öfûe
, 
__LINE__
) ;

361 
	`sf_˛o£
 (
öfûe
) ;

363 i‡(
sföfo
.
‰ames
 !
k
 * frames)

364 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘ sam∂êcou¡ (%ld should bê%ld)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), SF_COUNT_TO_LONG (
k
 + frames)) ;

365 
	`dump_log_buf„r
 (
öfûe
) ;

366 
	`exô
 (1) ;

369 i‡((
k
 & 1) == 0)

370 
	`ã°_wrôe_sh‹t_‹_dõ
 (
outfûe
, 
k
, 
buf„r
, 
sföfo
.
ch™√ls
 * 
‰ames
, 
__LINE__
) ;

372 
	`ã°_wrôef_sh‹t_‹_dõ
 (
outfûe
, 
k
, 
buf„r
, 
‰ames
, 
__LINE__
) ;

375 
	`sf_˛o£
 (
outfûe
) ;

376 
	`u∆ök
 (
fûíame
) ;

378 
	`puts
 ("ok") ;

380 
	}
}

382 
	$upd©e_£ek_öt_ã°
 (c⁄° *
fûíame
, 
fûëy≥
)

383 { 
SNDFILE
 *
outfûe
, *
öfûe
 ;

384 
SF_INFO
 
sföfo
 ;

385 
sf_cou¡_t
 
‰ames
 ;

386 
buf„r
 [8] ;

387 
k
 ;

389 
	`¥öt_ã°_«me
 ("upd©e_£ek_öt_ã°", 
fûíame
) ;

391 
	`mem£t
 (
buf„r
, 0,  (buffer)) ;

394 
sföfo
.
f‹m©
 = 
fûëy≥
 | 
SF_FORMAT_PCM_32
 ;

395 
sföfo
.
ßm∂î©e
 = 48000 ;

396 
sföfo
.
ch™√ls
 = 2 ;

398 i‡(
	`sf_f‹m©_check
 (&
sföfo
Ë=
SF_FALSE
)

399 
sföfo
.
ch™√ls
 = 1 ;

401 
outfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

402 
	`sf_˛o£
 (
outfûe
) ;

405 
outfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

412 i‡(
	`sf_comm™d
 (
outfûe
, 
SFC_SET_UPDATE_HEADER_AUTO
, 
NULL
, 
SF_TRUE
) == 0)

413 { 
	`¥ötf
 ("\n\nEº‹ : sf_comm™d (SFC_SET_UPDATE_HEADER_AUTOËªtu∫Éº‹ : %s\n\n", 
	`sf_°ªº‹
 (
outfûe
)) ;

414 
	`exô
 (1) ;

418 
‰ames
 = 
	`ARRAY_LEN
 (
buf„r
Ë/ 
sföfo
.
ch™√ls
 ;

420 
k
 = 0 ; k < 6 ; k++)

421 { 
	`ã°_£ek_‹_dõ
 (
outfûe
, 
k
 * 
‰ames
, 
SEEK_SET
, k * fømes, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

422 
	`ã°_£ek_‹_dõ
 (
outfûe
, 0, 
SEEK_END
, 
k
 * 
‰ames
, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

425 
öfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

426 
	`check_log_buf„r_‹_dõ
 (
öfûe
, 
__LINE__
) ;

427 
	`sf_˛o£
 (
öfûe
) ;

429 i‡(
sföfo
.
‰ames
 !
k
 * frames)

430 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘ sam∂êcou¡ (%ld should bê%ld)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), SF_COUNT_TO_LONG (
k
 + frames)) ;

431 
	`dump_log_buf„r
 (
öfûe
) ;

432 
	`exô
 (1) ;

435 i‡((
k
 & 1) == 0)

436 
	`ã°_wrôe_öt_‹_dõ
 (
outfûe
, 
k
, 
buf„r
, 
sföfo
.
ch™√ls
 * 
‰ames
, 
__LINE__
) ;

438 
	`ã°_wrôef_öt_‹_dõ
 (
outfûe
, 
k
, 
buf„r
, 
‰ames
, 
__LINE__
) ;

441 
	`sf_˛o£
 (
outfûe
) ;

442 
	`u∆ök
 (
fûíame
) ;

444 
	`puts
 ("ok") ;

446 
	}
}

448 
	$upd©e_£ek_Êﬂt_ã°
 (c⁄° *
fûíame
, 
fûëy≥
)

449 { 
SNDFILE
 *
outfûe
, *
öfûe
 ;

450 
SF_INFO
 
sföfo
 ;

451 
sf_cou¡_t
 
‰ames
 ;

452 
buf„r
 [8] ;

453 
k
 ;

455 
	`¥öt_ã°_«me
 ("upd©e_£ek_Êﬂt_ã°", 
fûíame
) ;

457 
	`mem£t
 (
buf„r
, 0,  (buffer)) ;

460 
sföfo
.
f‹m©
 = 
fûëy≥
 | 
SF_FORMAT_FLOAT
 ;

461 
sföfo
.
ßm∂î©e
 = 48000 ;

462 
sföfo
.
ch™√ls
 = 2 ;

464 i‡(
	`sf_f‹m©_check
 (&
sföfo
Ë=
SF_FALSE
)

465 
sföfo
.
ch™√ls
 = 1 ;

467 
outfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

468 
	`sf_˛o£
 (
outfûe
) ;

471 
outfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

478 i‡(
	`sf_comm™d
 (
outfûe
, 
SFC_SET_UPDATE_HEADER_AUTO
, 
NULL
, 
SF_TRUE
) == 0)

479 { 
	`¥ötf
 ("\n\nEº‹ : sf_comm™d (SFC_SET_UPDATE_HEADER_AUTOËªtu∫Éº‹ : %s\n\n", 
	`sf_°ªº‹
 (
outfûe
)) ;

480 
	`exô
 (1) ;

484 
‰ames
 = 
	`ARRAY_LEN
 (
buf„r
Ë/ 
sföfo
.
ch™√ls
 ;

486 
k
 = 0 ; k < 6 ; k++)

487 { 
	`ã°_£ek_‹_dõ
 (
outfûe
, 
k
 * 
‰ames
, 
SEEK_SET
, k * fømes, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

488 
	`ã°_£ek_‹_dõ
 (
outfûe
, 0, 
SEEK_END
, 
k
 * 
‰ames
, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

491 
öfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

492 
	`check_log_buf„r_‹_dõ
 (
öfûe
, 
__LINE__
) ;

493 
	`sf_˛o£
 (
öfûe
) ;

495 i‡(
sföfo
.
‰ames
 !
k
 * frames)

496 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘ sam∂êcou¡ (%ld should bê%ld)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), SF_COUNT_TO_LONG (
k
 + frames)) ;

497 
	`dump_log_buf„r
 (
öfûe
) ;

498 
	`exô
 (1) ;

501 i‡((
k
 & 1) == 0)

502 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
outfûe
, 
k
, 
buf„r
, 
sföfo
.
ch™√ls
 * 
‰ames
, 
__LINE__
) ;

504 
	`ã°_wrôef_Êﬂt_‹_dõ
 (
outfûe
, 
k
, 
buf„r
, 
‰ames
, 
__LINE__
) ;

507 
	`sf_˛o£
 (
outfûe
) ;

508 
	`u∆ök
 (
fûíame
) ;

510 
	`puts
 ("ok") ;

512 
	}
}

514 
	$upd©e_£ek_doubÀ_ã°
 (c⁄° *
fûíame
, 
fûëy≥
)

515 { 
SNDFILE
 *
outfûe
, *
öfûe
 ;

516 
SF_INFO
 
sföfo
 ;

517 
sf_cou¡_t
 
‰ames
 ;

518 
buf„r
 [8] ;

519 
k
 ;

521 
	`¥öt_ã°_«me
 ("upd©e_£ek_doubÀ_ã°", 
fûíame
) ;

523 
	`mem£t
 (
buf„r
, 0,  (buffer)) ;

526 
sföfo
.
f‹m©
 = 
fûëy≥
 | 
SF_FORMAT_DOUBLE
 ;

527 
sföfo
.
ßm∂î©e
 = 48000 ;

528 
sföfo
.
ch™√ls
 = 2 ;

530 i‡(
	`sf_f‹m©_check
 (&
sföfo
Ë=
SF_FALSE
)

531 
sföfo
.
ch™√ls
 = 1 ;

533 
outfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

534 
	`sf_˛o£
 (
outfûe
) ;

537 
outfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

544 i‡(
	`sf_comm™d
 (
outfûe
, 
SFC_SET_UPDATE_HEADER_AUTO
, 
NULL
, 
SF_TRUE
) == 0)

545 { 
	`¥ötf
 ("\n\nEº‹ : sf_comm™d (SFC_SET_UPDATE_HEADER_AUTOËªtu∫Éº‹ : %s\n\n", 
	`sf_°ªº‹
 (
outfûe
)) ;

546 
	`exô
 (1) ;

550 
‰ames
 = 
	`ARRAY_LEN
 (
buf„r
Ë/ 
sföfo
.
ch™√ls
 ;

552 
k
 = 0 ; k < 6 ; k++)

553 { 
	`ã°_£ek_‹_dõ
 (
outfûe
, 
k
 * 
‰ames
, 
SEEK_SET
, k * fømes, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

554 
	`ã°_£ek_‹_dõ
 (
outfûe
, 0, 
SEEK_END
, 
k
 * 
‰ames
, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

557 
öfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

558 
	`check_log_buf„r_‹_dõ
 (
öfûe
, 
__LINE__
) ;

559 
	`sf_˛o£
 (
öfûe
) ;

561 i‡(
sföfo
.
‰ames
 !
k
 * frames)

562 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘ sam∂êcou¡ (%ld should bê%ld)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), SF_COUNT_TO_LONG (
k
 + frames)) ;

563 
	`dump_log_buf„r
 (
öfûe
) ;

564 
	`exô
 (1) ;

567 i‡((
k
 & 1) == 0)

568 
	`ã°_wrôe_doubÀ_‹_dõ
 (
outfûe
, 
k
, 
buf„r
, 
sföfo
.
ch™√ls
 * 
‰ames
, 
__LINE__
) ;

570 
	`ã°_wrôef_doubÀ_‹_dõ
 (
outfûe
, 
k
, 
buf„r
, 
‰ames
, 
__LINE__
) ;

573 
	`sf_˛o£
 (
outfûe
) ;

574 
	`u∆ök
 (
fûíame
) ;

576 
	`puts
 ("ok") ;

578 
	}
}

586 
	$exåa_hódî_ã°
 (c⁄° *
fûíame
, 
fûëy≥
)

587 { 
SNDFILE
 *
outfûe
, *
öfûe
 ;

588 
SF_INFO
 
sföfo
 ;

589 
sf_cou¡_t
 
‰ames
 ;

590 
buf„r
 [8] ;

591 
k
 = 0 ;

593 
	`¥öt_ã°_«me
 ("exåa_hódî_ã°", 
fûíame
) ;

595 
sföfo
.
ßm∂î©e
 = 44100 ;

596 
sföfo
.
f‹m©
 = (
fûëy≥
 | 
SF_FORMAT_PCM_16
) ;

597 
sföfo
.
ch™√ls
 = 1 ;

599 
	`mem£t
 (
buf„r
, 0xA0,  (buffer)) ;

602 
‰ames
 = 
	`ARRAY_LEN
 (
buf„r
Ë/ 
sföfo
.
ch™√ls
 ;

605 
outfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 409) ;

606 
	`sf_£t_°rög
 (
outfûe
, 
SF_STR_TITLE
, 
fûíame
) ;

607 
	`ã°_wrôef_sh‹t_‹_dõ
 (
outfûe
, 
k
, 
buf„r
, 
‰ames
, 411) ;

608 
	`sf_£t_°rög
 (
outfûe
, 
SF_STR_COPYRIGHT
, "(c) 1980 Erik") ;

609 
	`sf_˛o£
 (
outfûe
) ;

621 i‡((
öfûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_RDWR
, &
sföfo
)Ë!
NULL
)

622 { 
	`¥ötf
 ("\n\nError : shouldÇot beábleÅo openÅhis file in SFM_RDWR.\n\n") ;

623 
	`exô
 (1) ;

626 
	`u∆ök
 (
fûíame
) ;

627 
	`puts
 ("ok") ;

631 
	`hexdump_fûe
 (
fûíame
, 0, 100000) ;

634 
outfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 438) ;

641 i‡(
	`sf_comm™d
 (
outfûe
, 
SFC_SET_UPDATE_HEADER_AUTO
, 
NULL
, 
SF_TRUE
) == 0)

642 { 
	`¥ötf
 ("\n\nEº‹ : sf_comm™d (SFC_SET_UPDATE_HEADER_AUTOËªtu∫Éº‹ : %s\n\n", 
	`sf_°ªº‹
 (
outfûe
)) ;

643 
	`exô
 (1) ;

647 
‰ames
 = 
	`ARRAY_LEN
 (
buf„r
Ë/ 
sföfo
.
ch™√ls
 ;

649 
k
 = 1 ; k < 6 ; k++)

651 
	`¥ötf
 ("\n***Öas†%d\n", 
k
) ;

652 
	`mem£t
 (
buf„r
, 0xA0 + 
k
,  (buffer)) ;

655 
	`ã°_£ek_‹_dõ
 (
outfûe
, 
k
 * 
‰ames
, 
SEEK_SET
, k * fømes, 
sföfo
.
ch™√ls
, 459) ;

656 
	`ã°_£ek_‹_dõ
 (
outfûe
, 0, 
SEEK_END
, 
k
 * 
‰ames
, 
sföfo
.
ch™√ls
, 460) ;

660 { 
öfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 464) ;

661 
	`check_log_buf„r_‹_dõ
 (
öfûe
, 465) ;

662 
	`sf_˛o£
 (
öfûe
) ;

665 i‡(
sföfo
.
‰ames
 !
k
 * frames)

666 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘ sam∂êcou¡ (%ld should bê%ld)\n", 470, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), SF_COUNT_TO_LONG (
k
 + frames)) ;

667 
	`dump_log_buf„r
 (
öfûe
) ;

668 
	`exô
 (1) ;

671 i‡((
k
 & 1) == 0)

672 
	`ã°_wrôe_sh‹t_‹_dõ
 (
outfûe
, 
k
, 
buf„r
, 
sföfo
.
ch™√ls
 * 
‰ames
, 476) ;

674 
	`ã°_wrôef_sh‹t_‹_dõ
 (
outfûe
, 
k
, 
buf„r
, 
‰ames
, 478) ;

675 
	`hexdump_fûe
 (
fûíame
, 0, 100000) ;

678 
	`sf_˛o£
 (
outfûe
) ;

679 
	`u∆ök
 (
fûíame
) ;

681 
	`puts
 ("ok") ;

684 
	}
}

	@libsndfile-1.0.17/tests/headerless_test.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

24 
	~<m©h.h
>

26 #i‡
HAVE_UNISTD_H


27 
	~<uni°d.h
>

30 
	~<¢dfûe.h
>

32 
	~"utûs.h
"

34 
	#BUFFER_SIZE
 (2000)

	)

36 
ﬁd_ã°
 () ;

37 
hódîÀss_ã°
 (c⁄° * 
fûíame
, 
f‹m©
, 
ex≥˘ed
) ;

40 
	$maö
 ()

42 
	`ﬁd_ã°
 () ;

44 
	`hódîÀss_ã°
 ("øw.vox", 
SF_FORMAT_VOX_ADPCM
, 
SF_FORMAT_RAW
 | SF_FORMAT_VOX_ADPCM) ;

45 
	`hódîÀss_ã°
 ("øw.gsm", 
SF_FORMAT_GSM610
, 
SF_FORMAT_RAW
 | SF_FORMAT_GSM610) ;

47 
	`hódîÀss_ã°
 ("øw.¢d", 
SF_FORMAT_ULAW
, 
SF_FORMAT_RAW
 | SF_FORMAT_ULAW) ;

48 
	`hódîÀss_ã°
 ("øw.au" , 
SF_FORMAT_ULAW
, 
SF_FORMAT_RAW
 | SF_FORMAT_ULAW) ;

51 
	}
}

54 
	$hódîÀss_ã°
 (c⁄° * 
fûíame
, 
f‹m©
, 
ex≥˘ed
)

55 { 
buf„r
 [
BUFFER_SIZE
] ;

56 
SNDFILE
 *
fûe
 ;

57 
SF_INFO
 
sföfo
 ;

58 
k
 ;

60 
f‹m©
 &
SF_FORMAT_SUBMASK
 ;

62 
	`¥öt_ã°_«me
 (
__func__
, 
fûíame
) ;

64 
k
 = 0 ; k < 
BUFFER_SIZE
 ; k++)

65 
buf„r
 [
k
] = k ;

67 
sföfo
.
ßm∂î©e
 = 8000 ;

68 
sföfo
.
‰ames
 = 0 ;

69 
sföfo
.
ch™√ls
 = 1 ;

70 
sföfo
.
f‹m©
 = 
SF_FORMAT_RAW
 | format ;

72 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

74 i‡((
k
 = 
	`sf_wrôe_sh‹t
 (
fûe
, 
buf„r
, 
BUFFER_SIZE
)) != BUFFER_SIZE)

75 { 
	`¥ötf
 ("Löê%d: sf_wrôe_sh‹àÁûed wôh sh‹àwrôê(%d => %d).\n", 
__LINE__
, 
BUFFER_SIZE
, 
k
) ;

76 
	`fÊush
 (
°dout
) ;

77 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

78 
	`exô
 (1) ;

81 
	`sf_˛o£
 (
fûe
) ;

83 
	`mem£t
 (
buf„r
, 0,  (buffer)) ;

86 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

88 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

90 i‡(
sföfo
.
f‹m©
 !
ex≥˘ed
)

91 { 
	`¥ötf
 ("Löê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
ex≥˘ed
, 
sföfo
.
f‹m©
) ;

92 
	`exô
 (1) ;

95 i‡(
sföfo
.
‰ames
 < 
BUFFER_SIZE
)

96 { 
	`¥ötf
 ("Löê%d: Inc‹ª˘Çumbî of.‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
BUFFER_SIZE
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

97 
	`exô
 (1) ;

100 i‡(
sföfo
.
ch™√ls
 != 1)

101 { 
	`¥ötf
 ("Löê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

102 
	`exô
 (1) ;

105 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

107 
	`¥ötf
 ("ok\n") ;

108 
	`u∆ök
 (
fûíame
) ;

109 
	}
}

112 
	$ﬁd_ã°
 ()

113 { 
buf„r
 [
BUFFER_SIZE
] ;

114 
SNDFILE
 *
fûe
 ;

115 
SF_INFO
 
sföfo
 ;

116 
k
, 
fûëy≥
 ;

117 c⁄° *
fûíame
 = "headerless.wav" ;

119 
	`¥öt_ã°_«me
 (
__func__
, "") ;

121 
k
 = 0 ; k < 
BUFFER_SIZE
 ; k++)

122 
buf„r
 [
k
] = k ;

124 
fûëy≥
 = 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_16
 ;

126 
sföfo
.
ßm∂î©e
 = 32000 ;

127 
sföfo
.
‰ames
 = 123456789 ;

128 
sföfo
.
ch™√ls
 = 1 ;

129 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

131 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

133 i‡((
k
 = 
	`sf_wrôe_sh‹t
 (
fûe
, 
buf„r
, 
BUFFER_SIZE
)) != BUFFER_SIZE)

134 { 
	`¥ötf
 ("Löê%d: sf_wrôe_sh‹àÁûed wôh sh‹àwrôê(%d => %d).\n", 
__LINE__
, 
BUFFER_SIZE
, 
k
) ;

135 
	`fÊush
 (
°dout
) ;

136 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

137 
	`exô
 (1) ;

140 
	`sf_˛o£
 (
fûe
) ;

142 
	`mem£t
 (
buf„r
, 0,  (buffer)) ;

145 
sföfo
.
f‹m©
 = 
fûëy≥
 = 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_16
 ;

147 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

149 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

150 { 
	`¥ötf
 ("Löê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

151 
	`exô
 (1) ;

154 i‡(
sföfo
.
‰ames
 < 
BUFFER_SIZE
)

155 { 
	`¥ötf
 ("Löê%d: Inc‹ª˘Çumbî of.‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
BUFFER_SIZE
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

156 
	`exô
 (1) ;

159 i‡(
sföfo
.
ch™√ls
 != 1)

160 { 
	`¥ötf
 ("Löê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

161 
	`exô
 (1) ;

164 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

166 i‡((
k
 = 
	`sf_ªad_sh‹t
 (
fûe
, 
buf„r
, 
BUFFER_SIZE
)) != BUFFER_SIZE)

167 { 
	`¥ötf
 ("Löê%d: sh‹àªad (%d).\n", 
__LINE__
, 
k
) ;

168 
	`exô
 (1) ;

171 
k
 = 0 ; k < 
BUFFER_SIZE
 - 22 ; k++)

172 i‡(
buf„r
 [
k
 + 22] != k)

173 { 
	`¥ötf
 ("Löê%d: Inc‹ª˘ sam∂ê(#%d : 0x%x => 0x%x).\n", 
__LINE__
, 
k
, k, 
buf„r
 [k]) ;

174 
	`exô
 (1) ;

177 
	`¥ötf
 ("ok\n") ;

178 
	`u∆ök
 (
fûíame
) ;

179 
	}
}

	@libsndfile-1.0.17/tests/largefile_test.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

25 #i‡
HAVE_UNISTD_H


26 
	~<uni°d.h
>

29 
	~<¢dfûe.h
>

31 
	~"utûs.h
"

33 
	#BUFFER_LEN
 (1024 * 1024)

	)

34 
	#BUFFER_COUNT
 (768)

	)

36 
œrgefûe_ã°
 (
fûëy≥
, c⁄° * 
fûíame
) ;

39 
	$maö
 ()

41 
	`œrgefûe_ã°
 (
SF_FORMAT_WAV
, "largefile.wav") ;

42 
	`œrgefûe_ã°
 (
SF_FORMAT_AIFF
, "largefile.aiff") ;

45 
	}
}

48 
	$œrgefûe_ã°
 (
fûëy≥
, c⁄° * 
fûíame
)

49 { 
d©a
 [
BUFFER_LEN
] ;

50 
SNDFILE
 *
fûe
 ;

51 
SF_INFO
 
sföfo
 ;

52 
k
 ;

54 
	`¥öt_ã°_«me
 ("œrgefûe_ã°", 
fûíame
) ;

56 
sföfo
.
ßm∂î©e
 = 44100 ;

57 
sföfo
.
ch™√ls
 = 2 ;

58 
sföfo
.
‰ames
 = 0 ;

59 
sföfo
.
f‹m©
 = (
fûëy≥
 | 
SF_FORMAT_PCM_32
) ;

61 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

63 
k
 = 0 ; k < 
BUFFER_COUNT
 ; k++)

64 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
fûe
, 
k
, 
d©a
, 
BUFFER_LEN
, 
__LINE__
) ;

66 
	`sf_˛o£
 (
fûe
) ;

68 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

70 i‡((
sföfo
.
‰ames
 * sföfo.
ch™√ls
Ë/ 
BUFFER_LEN
 !
BUFFER_COUNT
)

71 { 
	`¥ötf
 ("\n\nLöê%d : bad fømêcou¡.\n", 
__LINE__
) ;

72 
	`exô
 (1) ;

75 
	`sf_˛o£
 (
fûe
) ;

77 
	`u∆ök
 (
fûíame
) ;

78 
	`puts
 ("ok") ;

82 
	}
}

	@libsndfile-1.0.17/tests/locale_test.c

19 
	~"sfc⁄fig.h
"

20 
	~"¢dfûe.h
"

22 
	~<°dio.h
>

23 
	~<°dlib.h
>

24 
	~<°rög.h
>

26 #i‡
HAVE_UNISTD_H


27 
	~<uni°d.h
>

30 #i‡
HAVE_LOCALE_H


31 
	~<loˇÀ.h
>

34 
	~"utûs.h
"

37 { c⁄° *
	mloˇÀ
 ;

38 c⁄° *
	mfûíame
 ;

39 
	mwidth
 ;

40 } 
	tLOCALE_DATA
 ;

42 
loˇÀ_ã°
 (c⁄° * 
lo˙ame
, c⁄° * 
fûíame
, 
width
) ;

45 
	$maö
 ()

46 { 
LOCALE_DATA
 
ld©a
 [] =

54 { 
NULL
, NULL, 0 }

56 
k
 ;

58 
k
 = 0 ; 
ld©a
 [k].
loˇÀ
 !
NULL
 ; k++)

59 
	`loˇÀ_ã°
 (
ld©a
 [
k
].
loˇÀ
,Üd©®[k].
fûíame
,Üd©®[k].
width
) ;

62 
	}
}

65 
	$loˇÀ_ã°
 (c⁄° * 
lo˙ame
, c⁄° * 
fûíame
, 
width
)

67 #i‡(
HAVE_LOCALE_H
 =0 || 
HAVE_SETLOCALE
 == 0)

68 
lo˙ame
 = 
fûíame
 = 
NULL
 ;

69 
width
 = 0 ;

72 c⁄° 
wd©a
 [] = { 1, 2, 3, 4, 5, 6, 7, 8 } ;

73 
rd©a
 [
	`ARRAY_LEN
 (
wd©a
)] ;

74 c⁄° *
ﬁd_loˇÀ
 ;

75 
SNDFILE
 *
fûe
 ;

76 
SF_INFO
 
sföfo
 ;

79 
ﬁd_loˇÀ
 = 
	`£éoˇÀ
 (
LC_ALL
, 
NULL
) ;

81 i‡(
	`£éoˇÀ
 (
LC_ALL
, 
lo˙ame
Ë=
NULL
)

84 
	`¥ötf
 ("ÜoˇÀ_ã° : %-6† %s%*¯: ", 
lo˙ame
, 
fûíame
, 28 - 
width
, ' ') ;

85 
	`fÊush
 (
°dout
) ;

87 
sföfo
.
f‹m©
 = 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_16
 ;

88 
sföfo
.
ch™√ls
 = 1 ;

89 
sföfo
.
ßm∂î©e
 = 44100 ;

91 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 0, 
__LINE__
) ;

92 
	`ã°_wrôe_sh‹t_‹_dõ
 (
fûe
, 0, 
wd©a
, 
	`ARRAY_LEN
 (wd©a), 
__LINE__
) ;

93 
	`sf_˛o£
 (
fûe
) ;

95 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 0, 
__LINE__
) ;

96 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 0, 
rd©a
, 
	`ARRAY_LEN
 (rd©a), 
__LINE__
) ;

97 
	`sf_˛o£
 (
fûe
) ;

100 
	`£éoˇÀ
 (
LC_ALL
, 
ﬁd_loˇÀ
) ;

102 
	`u∆ök
 (
fûíame
) ;

103 
	`puts
 ("ok") ;

105 
	}
}

	@libsndfile-1.0.17/tests/lossy_comp_test.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

24 
	~<m©h.h
>

26 #i‡
HAVE_UNISTD_H


27 
	~<uni°d.h
>

30 
	~<¢dfûe.h
>

32 
	~"utûs.h
"

34 
	#BUFFER_SIZE
 (1<<14Ë

	)

35 
	#SAMPLE_RATE
 11025

	)

37 #i‚def 
M_PI


38 
	#M_PI
 3.14159265358979323846264338

	)

41 
lcomp_ã°_sh‹t
 (c⁄° *
fûíame
, 
fûëy≥
, 
ch™
, 
m¨gö
) ;

42 
lcomp_ã°_öt
 (c⁄° *
fûíame
, 
fûëy≥
, 
ch™
, 
m¨gö
) ;

43 
lcomp_ã°_Êﬂt
 (c⁄° *
fûíame
, 
fûëy≥
, 
ch™
, 
m¨gö
) ;

44 
lcomp_ã°_doubÀ
 (c⁄° *
fûíame
, 
fûëy≥
, 
ch™
, 
m¨gö
) ;

46 
sdlcomp_ã°_sh‹t
 (c⁄° *
fûíame
, 
fûëy≥
, 
ch™
, 
m¨gö
) ;

47 
sdlcomp_ã°_öt
 (c⁄° *
fûíame
, 
fûëy≥
, 
ch™
, 
m¨gö
) ;

48 
sdlcomp_ã°_Êﬂt
 (c⁄° *
fûíame
, 
fûëy≥
, 
ch™
, 
m¨gö
) ;

49 
sdlcomp_ã°_doubÀ
 (c⁄° *
fûíame
, 
fûëy≥
, 
ch™
, 
m¨gö
) ;

51 
îr‹_fun˘i⁄
 (
d©a
, 
‹ig
, 
m¨gö
) ;

52 
deˇy_ª•⁄£
 (
k
) ;

54 
gí_sig«l_doubÀ
 (*
d©a
, 
sˇÀ
, 
ch™√ls
, 
d©Æí
) ;

56 
smoŸhed_diff_sh‹t
 (*
d©a
, 
d©Æí
) ;

57 
smoŸhed_diff_öt
 (*
d©a
, 
d©Æí
) ;

58 
smoŸhed_diff_Êﬂt
 (*
d©a
, 
d©Æí
) ;

59 
smoŸhed_diff_doubÀ
 (*
d©a
, 
d©Æí
) ;

61 
check_commít
 (
SNDFILE
 * 
fûe
, 
f‹m©
, 
löío
) ;

68 { 
	md
 [
BUFFER_SIZE
 + 1] ;

69 
	mf
 [
BUFFER_SIZE
 + 1] ;

70 
	mi
 [
BUFFER_SIZE
 + 1] ;

71 
	ms
 [
BUFFER_SIZE
 + 1] ;

72 
	mc
 [
BUFFER_SIZE
 + 1] ;

73 } 
	tBUFFER
 ;

75 
BUFFER
 
	gd©a_buf„r
 ;

76 
BUFFER
 
	g‹ig_buf„r
 ;

77 
BUFFER
 
	gsmoŸh_buf„r
 ;

79 c⁄° *
	gl⁄g_commít
 =

87 
	$maö
 (
¨gc
, *
¨gv
 [])

88 { 
do_Æl
 = 0 ;

89 
ã°_cou¡
 = 0 ;

91 i‡(
¨gc
 != 2)

92 { 
	`¥ötf
 ("Ußgê: %†<ã°>\n", 
¨gv
 [0]) ;

93 
	`¥ötf
 (" Where <test> is one ofÅhe following:\n") ;

94 
	`¥ötf
 (" wav_ima -Åest IMA ADPCM WAV file functions\n") ;

95 
	`¥ötf
 (" wav_msadpcm -Åest MS ADPCM WAV file functions\n") ;

96 
	`¥ötf
 (" wav_gsm610 -Åest GSM 6.10 WAV file functions\n") ;

97 
	`¥ötf
 (" wav_ulaw -Åest u-law WAV file functions\n") ;

98 
	`¥ötf
 (" wav_alaw -Åest A-law WAV file functions\n") ;

99 
	`¥ötf
 ("áll -ÖerformállÅests\n") ;

100 
	`exô
 (1) ;

103 
do_Æl
 = ! 
	`°rcmp
 (
¨gv
 [1], "all") ;

105 i‡(
	`°rcmp
 (
¨gv
 [1], "wav_pcm") == 0)

107 
	`lcomp_ã°_sh‹t
 ("pcm.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_16
, 2, 0.00001) ;

108 
	`lcomp_ã°_öt
 ("pcm.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_16
, 2, 0.00001) ;

109 
	`lcomp_ã°_sh‹t
 ("pcm.rifx", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_16
, 2, 0.00001) ;

110 
	`lcomp_ã°_öt
 ("pcm.rifx", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_16
, 2, 0.00001) ;

112 
	`lcomp_ã°_Êﬂt
 ("pcm.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_16
, 2, 0.005) ;

113 
	`lcomp_ã°_doubÀ
 ("pcm.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_16
, 2, 0.005) ;

115 
ã°_cou¡
++ ;

120 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "wav_ima") == 0)

121 { 
	`lcomp_ã°_sh‹t
 ("ima.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

122 
	`lcomp_ã°_öt
 ("ima.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

123 
	`lcomp_ã°_Êﬂt
 ("ima.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

124 
	`lcomp_ã°_doubÀ
 ("ima.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

126 
	`lcomp_ã°_sh‹t
 ("ima.rifx", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

127 
	`lcomp_ã°_öt
 ("ima.rifx", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

128 
	`lcomp_ã°_Êﬂt
 ("ima.rifx", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

129 
	`lcomp_ã°_doubÀ
 ("ima.rifx", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

131 
	`sdlcomp_ã°_sh‹t
 ("ima.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

132 
	`sdlcomp_ã°_öt
 ("ima.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

133 
	`sdlcomp_ã°_Êﬂt
 ("ima.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

134 
	`sdlcomp_ã°_doubÀ
 ("ima.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

135 
ã°_cou¡
++ ;

138 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "wav_msadpcm") == 0)

139 { 
	`lcomp_ã°_sh‹t
 ("mßdpcm.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_MS_ADPCM
, 2, 0.36) ;

140 
	`lcomp_ã°_öt
 ("mßdpcm.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_MS_ADPCM
, 2, 0.36) ;

141 
	`lcomp_ã°_Êﬂt
 ("mßdpcm.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_MS_ADPCM
, 2, 0.36) ;

142 
	`lcomp_ã°_doubÀ
 ("mßdpcm.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_MS_ADPCM
, 2, 0.36) ;

144 
	`lcomp_ã°_sh‹t
 ("mßdpcm.rifx", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_MS_ADPCM
, 2, 0.36) ;

145 
	`lcomp_ã°_öt
 ("mßdpcm.rifx", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_MS_ADPCM
, 2, 0.36) ;

146 
	`lcomp_ã°_Êﬂt
 ("mßdpcm.rifx", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_MS_ADPCM
, 2, 0.36) ;

147 
	`lcomp_ã°_doubÀ
 ("mßdpcm.rifx", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_MS_ADPCM
, 2, 0.36) ;

149 
	`sdlcomp_ã°_sh‹t
 ("mßdpcm.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_MS_ADPCM
, 2, 0.36) ;

150 
	`sdlcomp_ã°_öt
 ("mßdpcm.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_MS_ADPCM
, 2, 0.36) ;

151 
	`sdlcomp_ã°_Êﬂt
 ("mßdpcm.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_MS_ADPCM
, 2, 0.36) ;

152 
	`sdlcomp_ã°_doubÀ
 ("mßdpcm.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_MS_ADPCM
, 2, 0.36) ;

154 
ã°_cou¡
++ ;

157 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "wav_g721") == 0)

158 { 
	`¥ötf
 ("**** FixÅhisÜater :Érror bound should be 0.06 ****\n") ;

159 
	`lcomp_ã°_sh‹t
 ("g721.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_G721_32
, 1, 0.7) ;

160 
	`lcomp_ã°_öt
 ("g721.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_G721_32
, 1, 0.7) ;

162 
	`lcomp_ã°_sh‹t
 ("g721.rifx", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_G721_32
, 1, 0.7) ;

163 
	`lcomp_ã°_öt
 ("g721.rifx", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_G721_32
, 1, 0.7) ;

165 
ã°_cou¡
++ ;

169 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "wav_ulaw") == 0)

170 { 
	`lcomp_ã°_sh‹t
 ("uœw.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

171 
	`lcomp_ã°_öt
 ("uœw.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

173 
	`lcomp_ã°_sh‹t
 ("uœw.rifx", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

174 
	`lcomp_ã°_öt
 ("uœw.rifx", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

177 
	`lcomp_ã°_Êﬂt
 ("uœw.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

178 
	`lcomp_ã°_doubÀ
 ("uœw.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

180 
ã°_cou¡
++ ;

183 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "wav_alaw") == 0)

184 { 
	`lcomp_ã°_sh‹t
 ("Æaw.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

185 
	`lcomp_ã°_öt
 ("Æaw.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

187 
	`lcomp_ã°_Êﬂt
 ("Æaw.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

188 
	`lcomp_ã°_doubÀ
 ("Æaw.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

190 
ã°_cou¡
++ ;

193 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "wav_gsm610") == 0)

195 
	`sdlcomp_ã°_sh‹t
 ("gsm610.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_GSM610
, 1, 0.24) ;

196 
	`sdlcomp_ã°_öt
 ("gsm610.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_GSM610
, 1, 0.24) ;

198 
	`sdlcomp_ã°_sh‹t
 ("gsm610.rifx", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_GSM610
, 1, 0.24) ;

199 
	`sdlcomp_ã°_öt
 ("gsm610.rifx", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_GSM610
, 1, 0.24) ;

202 
	`sdlcomp_ã°_Êﬂt
 ("gsm610.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_GSM610
, 1, 0.24) ;

203 
	`sdlcomp_ã°_doubÀ
 ("gsm610.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_GSM610
, 1, 0.24) ;

205 
ã°_cou¡
++ ;

208 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "aiff_ulaw") == 0)

209 { 
	`lcomp_ã°_sh‹t
 ("uœw.aiff", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

210 
	`lcomp_ã°_öt
 ("uœw.aiff", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

212 
	`lcomp_ã°_Êﬂt
 ("uœw.aiff", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

213 
	`lcomp_ã°_doubÀ
 ("uœw.aiff", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

215 
ã°_cou¡
++ ;

218 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "aiff_alaw") == 0)

219 { 
	`lcomp_ã°_sh‹t
 ("Æaw.aiff", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

220 
	`lcomp_ã°_öt
 ("Æaw.aiff", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

222 
	`lcomp_ã°_Êﬂt
 ("Æaw.aiff", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

223 
	`lcomp_ã°_doubÀ
 ("Æaw.aiff", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

225 
ã°_cou¡
++ ;

228 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "aiff_gsm610") == 0)

230 
	`sdlcomp_ã°_sh‹t
 ("gsm610.aiff", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_GSM610
, 1, 0.24) ;

231 
	`sdlcomp_ã°_öt
 ("gsm610.aiff", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_GSM610
, 1, 0.24) ;

233 
	`sdlcomp_ã°_Êﬂt
 ("gsm610.aiff", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_GSM610
, 1, 0.24) ;

234 
	`sdlcomp_ã°_doubÀ
 ("gsm610.aiff", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_GSM610
, 1, 0.24) ;

236 
ã°_cou¡
++ ;

239 i‡(
	`°rcmp
 (
¨gv
 [1], "aiff_ima") == 0)

240 { 
	`lcomp_ã°_sh‹t
 ("ima.aiff", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

241 
	`lcomp_ã°_öt
 ("ima.aiff", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

243 
	`lcomp_ã°_Êﬂt
 ("ima.aiff", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

244 
	`lcomp_ã°_doubÀ
 ("ima.aiff", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

248 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "au_ulaw") == 0)

249 { 
	`lcomp_ã°_sh‹t
 ("uœw.au", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

250 
	`lcomp_ã°_öt
 ("uœw.au", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

252 
	`lcomp_ã°_Êﬂt
 ("uœw.au", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

253 
	`lcomp_ã°_doubÀ
 ("uœw.au", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

255 
ã°_cou¡
++ ;

258 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "au_alaw") == 0)

259 { 
	`lcomp_ã°_sh‹t
 ("Æaw.au", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

260 
	`lcomp_ã°_öt
 ("Æaw.au", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

262 
	`lcomp_ã°_Êﬂt
 ("Æaw.au", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

263 
	`lcomp_ã°_doubÀ
 ("Æaw.au", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

265 
ã°_cou¡
++ ;

269 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "au_g721") == 0)

270 { 
	`¥ötf
 ("**** FixÅhisÜater :Érror bound should be 0.06 ****\n") ;

271 
	`lcomp_ã°_sh‹t
 ("g721.au", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_G721_32
, 1, 0.7) ;

272 
	`lcomp_ã°_öt
 ("g721.au", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_G721_32
, 1, 0.7) ;

273 
	`lcomp_ã°_Êﬂt
 ("g721.au", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_G721_32
, 1, 0.7) ;

274 
	`lcomp_ã°_doubÀ
 ("g721.au", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_G721_32
, 1, 0.7) ;

281 
ã°_cou¡
++ ;

284 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "au_g723") == 0)

285 { 
	`¥ötf
 ("**** FixÅhisÜater :Érror bound should be 0.16 ****\n") ;

286 
	`lcomp_ã°_sh‹t
 ("g723_24.au", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_G723_24
, 1, 0.7) ;

287 
	`lcomp_ã°_öt
 ("g723_24.au", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_G723_24
, 1, 0.7) ;

288 
	`lcomp_ã°_Êﬂt
 ("g723_24.au", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_G723_24
, 1, 0.7) ;

289 
	`lcomp_ã°_doubÀ
 ("g723_24.au", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_G723_24
, 1, 0.7) ;

291 
	`lcomp_ã°_sh‹t
 ("g723_40.au", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_G723_40
, 1, 0.21) ;

292 
	`lcomp_ã°_öt
 ("g723_40.au", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_G723_40
, 1, 0.21) ;

293 
	`lcomp_ã°_Êﬂt
 ("g723_40.au", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_G723_40
, 1, 0.21) ;

294 
	`lcomp_ã°_doubÀ
 ("g723_40.au", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_G723_40
, 1, 0.21) ;

301 
ã°_cou¡
++ ;

305 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "caf_ulaw") == 0)

306 { 
	`lcomp_ã°_sh‹t
 ("uœw.ˇf", 
SF_FORMAT_CAF
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

307 
	`lcomp_ã°_öt
 ("uœw.ˇf", 
SF_FORMAT_CAF
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

309 
	`lcomp_ã°_Êﬂt
 ("uœw.ˇf", 
SF_FORMAT_CAF
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

310 
	`lcomp_ã°_doubÀ
 ("uœw.ˇf", 
SF_FORMAT_CAF
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

312 
ã°_cou¡
++ ;

315 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "caf_alaw") == 0)

316 { 
	`lcomp_ã°_sh‹t
 ("Æaw.ˇf", 
SF_FORMAT_CAF
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

317 
	`lcomp_ã°_öt
 ("Æaw.ˇf", 
SF_FORMAT_CAF
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

319 
	`lcomp_ã°_Êﬂt
 ("Æaw.ˇf", 
SF_FORMAT_CAF
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

320 
	`lcomp_ã°_doubÀ
 ("Æaw.ˇf", 
SF_FORMAT_CAF
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

322 
ã°_cou¡
++ ;

326 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "raw_ulaw") == 0)

327 { 
	`lcomp_ã°_sh‹t
 ("uœw.øw", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

328 
	`lcomp_ã°_öt
 ("uœw.øw", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

330 
	`lcomp_ã°_Êﬂt
 ("uœw.øw", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

331 
	`lcomp_ã°_doubÀ
 ("uœw.øw", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

333 
ã°_cou¡
++ ;

336 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "raw_alaw") == 0)

337 { 
	`lcomp_ã°_sh‹t
 ("Æaw.øw", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

338 
	`lcomp_ã°_öt
 ("Æaw.øw", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

340 
	`lcomp_ã°_Êﬂt
 ("Æaw.øw", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

341 
	`lcomp_ã°_doubÀ
 ("Æaw.øw", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

343 
ã°_cou¡
++ ;

346 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "raw_gsm610") == 0)

348 
	`sdlcomp_ã°_sh‹t
 ("øw.gsm", 
SF_FORMAT_RAW
 | 
SF_FORMAT_GSM610
, 1, 0.24) ;

349 
	`sdlcomp_ã°_öt
 ("øw.gsm", 
SF_FORMAT_RAW
 | 
SF_FORMAT_GSM610
, 1, 0.24) ;

350 
	`sdlcomp_ã°_Êﬂt
 ("øw.gsm", 
SF_FORMAT_RAW
 | 
SF_FORMAT_GSM610
, 1, 0.24) ;

351 
	`sdlcomp_ã°_doubÀ
 ("øw.gsm", 
SF_FORMAT_RAW
 | 
SF_FORMAT_GSM610
, 1, 0.24) ;

352 
ã°_cou¡
++ ;

356 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "ircam_ulaw") == 0)

357 { 
	`lcomp_ã°_sh‹t
 ("uœw.úˇm", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_IRCAM
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

358 
	`lcomp_ã°_öt
 ("uœw.úˇm", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_IRCAM
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

359 
	`lcomp_ã°_Êﬂt
 ("uœw.úˇm", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_IRCAM
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

360 
	`lcomp_ã°_doubÀ
 ("uœw.úˇm", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_IRCAM
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

361 
ã°_cou¡
++ ;

364 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "ircam_alaw") == 0)

365 { 
	`lcomp_ã°_sh‹t
 ("Æaw.úˇm", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_IRCAM
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

366 
	`lcomp_ã°_öt
 ("Æaw.úˇm", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_IRCAM
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

367 
	`lcomp_ã°_Êﬂt
 ("Æaw.úˇm", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_IRCAM
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

368 
	`lcomp_ã°_doubÀ
 ("Æaw.úˇm", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_IRCAM
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

369 
ã°_cou¡
++ ;

372 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "nist_ulaw") == 0)

373 { 
	`lcomp_ã°_sh‹t
 ("uœw.ni°", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_NIST
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

374 
	`lcomp_ã°_öt
 ("uœw.ni°", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_NIST
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

375 
	`lcomp_ã°_Êﬂt
 ("uœw.ni°", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_NIST
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

376 
	`lcomp_ã°_doubÀ
 ("uœw.ni°", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_NIST
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

377 
ã°_cou¡
++ ;

380 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "nist_alaw") == 0)

381 { 
	`lcomp_ã°_sh‹t
 ("Æaw.ni°", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_NIST
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

382 
	`lcomp_ã°_öt
 ("Æaw.ni°", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_NIST
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

383 
	`lcomp_ã°_Êﬂt
 ("Æaw.ni°", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_NIST
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

384 
	`lcomp_ã°_doubÀ
 ("Æaw.ni°", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_NIST
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

385 
ã°_cou¡
++ ;

388 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "voc_ulaw") == 0)

389 { 
	`lcomp_ã°_sh‹t
 ("uœw.voc", 
SF_FORMAT_VOC
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

390 
	`lcomp_ã°_öt
 ("uœw.voc", 
SF_FORMAT_VOC
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

391 
	`lcomp_ã°_Êﬂt
 ("uœw.voc", 
SF_FORMAT_VOC
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

392 
	`lcomp_ã°_doubÀ
 ("uœw.voc", 
SF_FORMAT_VOC
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

393 
ã°_cou¡
++ ;

396 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "voc_alaw") == 0)

397 { 
	`lcomp_ã°_sh‹t
 ("Æaw.voc", 
SF_FORMAT_VOC
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

398 
	`lcomp_ã°_öt
 ("Æaw.voc", 
SF_FORMAT_VOC
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

399 
	`lcomp_ã°_Êﬂt
 ("Æaw.voc", 
SF_FORMAT_VOC
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

400 
	`lcomp_ã°_doubÀ
 ("Æaw.voc", 
SF_FORMAT_VOC
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

401 
ã°_cou¡
++ ;

405 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "w64_ulaw") == 0)

406 { 
	`lcomp_ã°_sh‹t
 ("uœw.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

407 
	`lcomp_ã°_öt
 ("uœw.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

409 
	`lcomp_ã°_Êﬂt
 ("uœw.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

410 
	`lcomp_ã°_doubÀ
 ("uœw.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_ULAW
, 2, 0.04) ;

412 
ã°_cou¡
++ ;

415 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "w64_alaw") == 0)

416 { 
	`lcomp_ã°_sh‹t
 ("Æaw.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

417 
	`lcomp_ã°_öt
 ("Æaw.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

419 
	`lcomp_ã°_Êﬂt
 ("Æaw.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

420 
	`lcomp_ã°_doubÀ
 ("Æaw.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_ALAW
, 2, 0.04) ;

422 
ã°_cou¡
++ ;

426 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "w64_ima") == 0)

427 { 
	`lcomp_ã°_sh‹t
 ("ima.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

428 
	`lcomp_ã°_öt
 ("ima.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

429 
	`lcomp_ã°_Êﬂt
 ("ima.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

430 
	`lcomp_ã°_doubÀ
 ("ima.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

432 
	`sdlcomp_ã°_sh‹t
 ("ima.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

433 
	`sdlcomp_ã°_öt
 ("ima.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

434 
	`sdlcomp_ã°_Êﬂt
 ("ima.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

435 
	`sdlcomp_ã°_doubÀ
 ("ima.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_IMA_ADPCM
, 2, 0.18) ;

436 
ã°_cou¡
++ ;

439 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "w64_msadpcm") == 0)

440 { 
	`lcomp_ã°_sh‹t
 ("mßdpcm.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_MS_ADPCM
, 2, 0.36) ;

441 
	`lcomp_ã°_öt
 ("mßdpcm.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_MS_ADPCM
, 2, 0.36) ;

442 
	`lcomp_ã°_Êﬂt
 ("mßdpcm.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_MS_ADPCM
, 2, 0.36) ;

443 
	`lcomp_ã°_doubÀ
 ("mßdpcm.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_MS_ADPCM
, 2, 0.36) ;

445 
	`sdlcomp_ã°_sh‹t
 ("mßdpcm.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_MS_ADPCM
, 2, 0.36) ;

446 
	`sdlcomp_ã°_öt
 ("mßdpcm.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_MS_ADPCM
, 2, 0.36) ;

447 
	`sdlcomp_ã°_Êﬂt
 ("mßdpcm.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_MS_ADPCM
, 2, 0.36) ;

448 
	`sdlcomp_ã°_doubÀ
 ("mßdpcm.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_MS_ADPCM
, 2, 0.36) ;

449 
ã°_cou¡
++ ;

453 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "w64_gsm610") == 0)

455 
	`sdlcomp_ã°_sh‹t
 ("gsm610.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_GSM610
, 1, 0.2) ;

456 
	`sdlcomp_ã°_öt
 ("gsm610.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_GSM610
, 1, 0.2) ;

458 
	`sdlcomp_ã°_Êﬂt
 ("gsm610.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_GSM610
, 1, 0.2) ;

459 
	`sdlcomp_ã°_doubÀ
 ("gsm610.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_GSM610
, 1, 0.2) ;

461 
ã°_cou¡
++ ;

465 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "vox_adpcm") == 0)

466 { 
	`lcomp_ã°_sh‹t
 ("adpcm.vox", 
SF_FORMAT_RAW
 | 
SF_FORMAT_VOX_ADPCM
, 1, 0.17) ;

467 
	`lcomp_ã°_öt
 ("adpcm.vox", 
SF_FORMAT_RAW
 | 
SF_FORMAT_VOX_ADPCM
, 1, 0.17) ;

468 
	`lcomp_ã°_Êﬂt
 ("adpcm.vox", 
SF_FORMAT_RAW
 | 
SF_FORMAT_VOX_ADPCM
, 1, 0.17) ;

469 
	`lcomp_ã°_doubÀ
 ("adpcm.vox", 
SF_FORMAT_RAW
 | 
SF_FORMAT_VOX_ADPCM
, 1, 0.17) ;

471 
	`sdlcomp_ã°_sh‹t
 ("adpcm.vox", 
SF_FORMAT_RAW
 | 
SF_FORMAT_VOX_ADPCM
, 1, 0.072) ;

472 
	`sdlcomp_ã°_öt
 ("adpcm.vox", 
SF_FORMAT_RAW
 | 
SF_FORMAT_VOX_ADPCM
, 1, 0.072) ;

473 
	`sdlcomp_ã°_Êﬂt
 ("adpcm.vox", 
SF_FORMAT_RAW
 | 
SF_FORMAT_VOX_ADPCM
, 1, 0.072) ;

474 
	`sdlcomp_ã°_doubÀ
 ("adpcm.vox", 
SF_FORMAT_RAW
 | 
SF_FORMAT_VOX_ADPCM
, 1, 0.072) ;

475 
ã°_cou¡
++ ;

478 i‡(
do_Æl
 || 
	`°rcmp
 (
¨gv
 [1], "xi_dpcm") == 0)

479 { 
	`lcomp_ã°_sh‹t
 ("8bô.xi", 
SF_FORMAT_XI
 | 
SF_FORMAT_DPCM_8
, 1, 0.25) ;

480 
	`lcomp_ã°_öt
 ("8bô.xi", 
SF_FORMAT_XI
 | 
SF_FORMAT_DPCM_8
, 1, 0.25) ;

482 
	`lcomp_ã°_sh‹t
 ("16bô.xi", 
SF_FORMAT_XI
 | 
SF_FORMAT_DPCM_16
, 1, 0.002) ;

483 
	`lcomp_ã°_öt
 ("16bô.xi", 
SF_FORMAT_XI
 | 
SF_FORMAT_DPCM_16
, 1, 0.002) ;

484 
	`lcomp_ã°_Êﬂt
 ("16bô.xi", 
SF_FORMAT_XI
 | 
SF_FORMAT_DPCM_16
, 1, 0.002) ;

485 
	`lcomp_ã°_doubÀ
 ("16bô.xi", 
SF_FORMAT_XI
 | 
SF_FORMAT_DPCM_16
, 1, 0.002) ;

486 
ã°_cou¡
++ ;

490 i‡(
ã°_cou¡
 == 0)

491 { 
	`¥ötf
 ("************************************\n") ;

492 
	`¥ötf
 ("* Nÿ'%s'Åe° deföed.\n", 
¨gv
 [1]) ;

493 
	`¥ötf
 ("************************************\n") ;

498 
	}
}

505 
	$lcomp_ã°_sh‹t
 (c⁄° *
fûíame
, 
fûëy≥
, 
ch™√ls
, 
m¨gö
)

506 { 
SNDFILE
 *
fûe
 ;

507 
SF_INFO
 
sföfo
 ;

508 
k
, 
m
, 
£ekpos
, 
sum_abs
 ;

509 
d©Æí
 ;

510 *
‹ig
, *
d©a
 ;

512 
	`¥öt_ã°_«me
 ("lcomp_ã°_sh‹t", 
fûíame
) ;

514 
d©Æí
 = 
BUFFER_SIZE
 / 
ch™√ls
 ;

516 
d©a
 = 
d©a_buf„r
.
s
 ;

517 
‹ig
 = 
‹ig_buf„r
.
s
 ;

519 
	`gí_sig«l_doubÀ
 (
‹ig_buf„r
.
d
, 32000.0, 
ch™√ls
, 
d©Æí
) ;

520 
k
 = 0 ; k < 
ch™√ls
 * 
d©Æí
 ; k++)

521 
‹ig
 [
k
] = (Ë(
‹ig_buf„r
.
d
 [k]) ;

523 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

524 
sföfo
.
‰ames
 = 123456789 ;

525 
sföfo
.
ch™√ls
 = channels ;

526 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

528 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_FALSE
, 
__LINE__
) ;

529 
	`ã°_wrôef_sh‹t_‹_dõ
 (
fûe
, 0, 
‹ig
, 
d©Æí
, 
__LINE__
) ;

530 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_COMMENT
, 
l⁄g_commít
) ;

531 
	`sf_˛o£
 (
fûe
) ;

533 
	`mem£t
 (
d©a
, 0, 
d©Æí
 *  ()) ;

535 i‡((
fûëy≥
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

536 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

538 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_FALSE
, 
__LINE__
) ;

540 i‡((
sföfo
.
f‹m©
 & (
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_SUBMASK
)Ë!(
fûëy≥
 & (SF_FORMAT_TYPEMASK | SF_FORMAT_SUBMASK)))

541 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

542 
	`exô
 (1) ;

545 i‡(
sföfo
.
‰ames
 < 
d©Æí
 / 
ch™√ls
)

546 { 
	`¥ötf
 ("Toÿ„w føme†ö fûe. (%ld should bê®lôéêm‹êth™ %ld)\n", 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
d©Æí
) ;

547 
	`exô
 (1) ;

550 i‡(
sföfo
.
‰ames
 > (
d©Æí
 + datalen / 20))

551 { 
	`¥ötf
 ("Toÿm™y føme†ö fûe. (%ld should bê®lôéêm‹êth™ %ld)\n", 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
d©Æí
) ;

552 
	`exô
 (1) ;

555 i‡(
sföfo
.
ch™√ls
 != channels)

556 { 
	`¥ötf
 ("IncorrectÇumber of channels in file.\n") ;

557 
	`exô
 (1) ;

560 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

562 
	`check_commít
 (
fûe
, 
fûëy≥
, 
__LINE__
) ;

564 
	`ã°_ªadf_sh‹t_‹_dõ
 (
fûe
, 0, 
d©a
, 
d©Æí
, 
__LINE__
) ;

566 
sum_abs
 = 0 ;

567 
k
 = 0 ; k < 
d©Æí
 ; k++)

568 { i‡(
	`îr‹_fun˘i⁄
 (
d©a
 [
k
], 
‹ig
 [k], 
m¨gö
))

569 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ sam∂êA (#%d : %d should bê%d).\n", 
__LINE__
, 
k
, 
d©a
 [k], 
‹ig
 [k]) ;

570 
	`o˘_ßve_sh‹t
 (
‹ig
, 
d©a
, 
d©Æí
) ;

571 
	`exô
 (1) ;

573 
sum_abs
 = 
	`abs
 (sum_ab†+áb†(
d©a
 [
k
])) ;

576 i‡(
sum_abs
 < 1.0)

577 { 
	`¥ötf
 ("\n\nLöê%d: Sig«»i†Æ»zîos.\n", 
__LINE__
) ;

578 
	`exô
 (1) ;

581 i‡((
k
 = 
	`sf_ªadf_sh‹t
 (
fûe
, 
d©a
, 
d©Æí
)Ë!
sföfo
.
‰ames
 - datalen)

582 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ÑódÜígth (%ld should bê%d).\n", 
__LINE__
,

583 
	`SF_COUNT_TO_LONG
 (
ch™√ls
 * 
sföfo
.
‰ames
 - 
d©Æí
), 
k
) ;

584 
	`exô
 (1) ;

590 
k
 = 0 ; k < 
sföfo
.
‰ames
 - 
d©Æí
 ; k++)

591 i‡(
	`abs
 (
d©a
 [
ch™√ls
 * 
k
]Ë> 
	`deˇy_ª•⁄£
 (channels * k))

592 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘ sam∂êB (#%d :áb†(%dËshould bê< %d).\n", 
__LINE__
, 
ch™√ls
 * 
k
, 
d©a
 [ch™√l†* k], 
	`deˇy_ª•⁄£
 (channels * k)) ;

593 
	`exô
 (1) ;

596 i‡(! 
sföfo
.
£ekabÀ
)

597 { 
	`sf_˛o£
 (
fûe
) ;

598 
	`u∆ök
 (
fûíame
) ;

599 
	`¥ötf
 ("ok\n") ;

605 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_SET
)) != 0)

606 { 
	`¥ötf
 ("\n\nLöê%d: SìkÅÿ°¨ào‡fûêÁûed (%d).\n", 
__LINE__
, 
k
) ;

607 
	`exô
 (1) ;

610 
m
 = 0 ; m < 3 ; m++)

611 { 
	`ã°_ªadf_sh‹t_‹_dõ
 (
fûe
, 
m
, 
d©a
, 11, 
__LINE__
) ;

613 
k
 = 0 ; k < 
ch™√ls
 * 11 ; k++)

614 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [
k
], (Ë
‹ig
 [k + 
ch™√ls
 * 
m
 * 11], 
m¨gö
))

615 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ sam∂ê(m = %dË(#%d : %d => %d).\n", 
__LINE__
, 
m
, 
k
 + 
ch™√ls
 * m * 11, 
‹ig
 [k + ch™√l†* m * 11], 
d©a
 [k]) ;

616 
m
 = 0 ; m < 
ch™√ls
 ; m++)

617 
	`¥ötf
 ("%d ", 
d©a
 [
m
]) ;

618 
	`¥ötf
 ("\n") ;

619 
	`exô
 (1) ;

623 
£ekpos
 = 
BUFFER_SIZE
 / 10 ;

626 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 
£ekpos
, 
SEEK_SET
)) != seekpos)

627 { 
	`¥ötf
 ("SìkÅÿ°¨ào‡fûê+ %d faûed (%d).\n", 
£ekpos
, 
k
) ;

628 
	`exô
 (1) ;

631 
	`ã°_ªadf_sh‹t_‹_dõ
 (
fûe
, 0, 
d©a
, 1, 
__LINE__
) ;

633 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
))

634 { 
	`¥ötf
 ("\n\nLöê%d: sf_£ek (SEEK_SETËfﬁlowed by sf_ªadf_sh‹àÁûed (%d, %d).\n", 
__LINE__
, 
‹ig
 [1], 
d©a
 [0]) ;

635 
	`exô
 (1) ;

638 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
)Ë!
£ekpos
 + 1)

639 { 
	`¥ötf
 ("\n\nLöê%d: sf_£ek (SEEK_CURËwôh 0 off£àÁûed (%d should bê%d)\n", 
__LINE__
, 
k
, 
£ekpos
 + 1) ;

640 
	`exô
 (1) ;

643 
£ekpos
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
Ë+ 
BUFFER_SIZE
 / 5 ;

644 
k
 = 
	`sf_£ek
 (
fûe
, 
BUFFER_SIZE
 / 5, 
SEEK_CUR
) ;

645 
	`ã°_ªadf_sh‹t_‹_dõ
 (
fûe
, 0, 
d©a
, 1, 
__LINE__
) ;

646 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
Ë|| 
k
 != seekpos)

647 { 
	`¥ötf
 ("\n\nLöê%d: sf_£ek (f‹w¨ds, SEEK_CURËfﬁlowed by sf_ªadf_sh‹àÁûed (%d, %dË(%d, %d).\n", 
__LINE__
, 
d©a
 [0], 
‹ig
 [
£ekpos
 * 
ch™√ls
], 
k
, seekpos + 1) ;

648 
	`o˘_ßve_sh‹t
 (
‹ig
, 
d©a
, 
d©Æí
) ;

649 
	`exô
 (1) ;

652 
£ekpos
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
) - 20 ;

654 
k
 = 
	`sf_£ek
 (
fûe
, -20, 
SEEK_CUR
) ;

655 
	`ã°_ªadf_sh‹t_‹_dõ
 (
fûe
, 0, 
d©a
, 1, 
__LINE__
) ;

656 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
Ë|| 
k
 != seekpos)

657 { 
	`¥ötf
 ("sf_£ek (backw¨ds, SEEK_CURËfﬁlowed by sf_ªadf_sh‹àÁûed (%d, %dË(%d, %d).\n", 
d©a
 [0], 
‹ig
 [
£ekpos
 * 
ch™√ls
], 
k
, seekpos) ;

658 
	`exô
 (1) ;

662 
	`sf_£ek
 (
fûe
, (Ë
sföfo
.
‰ames
, 
SEEK_SET
) ;

664 i‡((
k
 = 
	`sf_ªadf_sh‹t
 (
fûe
, 
d©a
, 
d©Æí
)) != 0)

665 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ vÆuê‰om sf_ªadf_sh‹à∑°Énd o‡fûêöc‹ª˘ (%d).\n", 
__LINE__
, 
k
) ;

666 
	`exô
 (1) ;

670 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 5 - (Ë
sföfo
.
‰ames
, 
SEEK_END
)) != 5)

671 { 
	`¥ötf
 ("sf_£ek (SEEK_ENDËªtu∫ed %d in°ód o‡%d.\n", 
k
, 5) ;

672 
	`exô
 (1) ;

675 
	`ã°_ªadf_sh‹t_‹_dõ
 (
fûe
, 0, 
d©a
, 
ch™√ls
, 
__LINE__
) ;

676 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [5], 
m¨gö
))

677 { 
	`¥ötf
 ("\n\nLöê%d: sf_£ek (SEEK_ENDËfﬁlowed by sf_ªadf_sh‹àÁûed (%d should bê%d).\n", 
__LINE__
, 
d©a
 [0], 
‹ig
 [5]) ;

678 
	`exô
 (1) ;

681 
	`sf_˛o£
 (
fûe
) ;

683 
	`u∆ök
 (
fûíame
) ;

684 
	`¥ötf
 ("ok\n") ;

685 
	}
}

691 
	$lcomp_ã°_öt
 (c⁄° *
fûíame
, 
fûëy≥
, 
ch™√ls
, 
m¨gö
)

692 { 
SNDFILE
 *
fûe
 ;

693 
SF_INFO
 
sföfo
 ;

694 
k
, 
m
, *
‹ig
, *
d©a
, 
sum_abs
 ;

695 
d©Æí
, 
£ekpos
 ;

696 
sˇÀ
 ;

698 
	`¥öt_ã°_«me
 ("lcomp_ã°_öt", 
fûíame
) ;

700 
d©Æí
 = 
BUFFER_SIZE
 / 
ch™√ls
 ;

702 
sˇÀ
 = 1.0 * 0x10000 ;

704 
d©a
 = 
d©a_buf„r
.
i
 ;

705 
‹ig
 = 
‹ig_buf„r
.
i
 ;

707 
	`gí_sig«l_doubÀ
 (
‹ig_buf„r
.
d
, 32000.0 * 
sˇÀ
, 
ch™√ls
, 
d©Æí
) ;

708 
k
 = 0 ; k < 
ch™√ls
 * 
d©Æí
 ; k++)

709 
‹ig
 [
k
] = 
‹ig_buf„r
.
d
 [k] ;

711 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

712 
sföfo
.
‰ames
 = 123456789 ;

713 
sföfo
.
ch™√ls
 = channels ;

714 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

716 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_FALSE
, 
__LINE__
) ;

717 
	`ã°_wrôef_öt_‹_dõ
 (
fûe
, 0, 
‹ig
, 
d©Æí
, 
__LINE__
) ;

718 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_COMMENT
, 
l⁄g_commít
) ;

719 
	`sf_˛o£
 (
fûe
) ;

721 
	`mem£t
 (
d©a
, 0, 
d©Æí
 *  ()) ;

723 i‡((
fûëy≥
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

724 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

726 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_FALSE
, 
__LINE__
) ;

728 i‡((
sföfo
.
f‹m©
 & (
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_SUBMASK
)Ë!(
fûëy≥
 & (SF_FORMAT_TYPEMASK | SF_FORMAT_SUBMASK)))

729 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

730 
	`exô
 (1) ;

733 i‡(
sföfo
.
‰ames
 < 
d©Æí
 / 
ch™√ls
)

734 { 
	`¥ötf
 ("Toÿ„w.‰ame†ö fûe. (%ld should bê®lôéêm‹êth™ %ld)\n", 
d©Æí
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

735 
	`exô
 (1) ;

738 i‡(
sföfo
.
‰ames
 > (
d©Æí
 + datalen / 20))

739 { 
	`¥ötf
 ("Toÿm™y.‰ame†ö fûe. (%ld should bê®lôéêm‹êth™ %ld)\n", 
d©Æí
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

740 
	`exô
 (1) ;

743 i‡(
sföfo
.
ch™√ls
 != channels)

744 { 
	`¥ötf
 ("IncorrectÇumber of channels in file.\n") ;

745 
	`exô
 (1) ;

748 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

750 
	`check_commít
 (
fûe
, 
fûëy≥
, 
__LINE__
) ;

752 
	`ã°_ªadf_öt_‹_dõ
 (
fûe
, 0, 
d©a
, 
d©Æí
, 
__LINE__
) ;

754 
sum_abs
 = 0 ;

755 
k
 = 0 ; k < 
d©Æí
 ; k++)

756 { i‡(
	`îr‹_fun˘i⁄
 (
d©a
 [
k
] / 
sˇÀ
, 
‹ig
 [k] / sˇÀ, 
m¨gö
))

757 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ sam∂ê(#%d : %‡should bê%f).\n", 
__LINE__
, 
k
, 
d©a
 [k] / 
sˇÀ
, 
‹ig
 [k] / scale) ;

758 
	`o˘_ßve_öt
 (
‹ig
, 
d©a
, 
d©Æí
) ;

759 
	`exô
 (1) ;

761 
sum_abs
 = 
	`abs
 (sum_ab†+áb†◊b†(
d©a
 [
k
]) - 256)) ;

764 i‡(
sum_abs
 < 1.0)

765 { 
	`¥ötf
 ("\n\nLöê%d: Sig«»i†Æ»zîo†(%d, 0x%X).\n", 
__LINE__
, 
sum_abs
, sum_abs) ;

766 
	`exô
 (1) ;

769 i‡((
k
 = 
	`sf_ªadf_öt
 (
fûe
, 
d©a
, 
d©Æí
)Ë!
sföfo
.
‰ames
 - datalen)

770 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ÑódÜígth (%ld should bê%d).\n", 
__LINE__
,

771 
	`SF_COUNT_TO_LONG
 (
ch™√ls
 * 
sföfo
.
‰ames
 - 
d©Æí
), 
k
) ;

772 
	`exô
 (1) ;

778 i‡((
sföfo
.
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë!
SF_FORMAT_MS_ADPCM
)

779 
k
 = 0 ; k < 
sföfo
.
‰ames
 - 
d©Æí
 ; k++)

780 i‡(
	`abs
 (
d©a
 [
ch™√ls
 * 
k
] / 
sˇÀ
Ë> 
	`deˇy_ª•⁄£
 (channels * k))

781 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘ sam∂êB (#%d :áb†(%dËshould bê< %d).\n", 
__LINE__
, 
ch™√ls
 * 
k
, 
d©a
 [ch™√l†* k], 
	`deˇy_ª•⁄£
 (channels * k)) ;

782 
	`exô
 (1) ;

785 i‡(! 
sföfo
.
£ekabÀ
)

786 { 
	`sf_˛o£
 (
fûe
) ;

787 
	`u∆ök
 (
fûíame
) ;

788 
	`¥ötf
 ("ok\n") ;

794 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_SET
)) != 0)

795 { 
	`¥ötf
 ("\n\nLöê%d: SìkÅÿ°¨ào‡fûêÁûed (%d).\n", 
__LINE__
, 
k
) ;

796 
	`exô
 (1) ;

799 
m
 = 0 ; m < 3 ; m++)

800 { 
	`ã°_ªadf_öt_‹_dõ
 (
fûe
, 
m
, 
d©a
, 11, 
__LINE__
) ;

802 
k
 = 0 ; k < 
ch™√ls
 * 11 ; k++)

803 i‡(
	`îr‹_fun˘i⁄
 (
d©a
 [
k
] / 
sˇÀ
, 
‹ig
 [k + 
ch™√ls
 * 
m
 * 11] / sˇÀ, 
m¨gö
))

804 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ sam∂ê(m = %dË(#%d : %d => %d).\n", 
__LINE__
, 
m
, 
k
 + 
ch™√ls
 * m * 11, 
‹ig
 [k + ch™√l†* m * 11], 
d©a
 [k]) ;

805 
m
 = 0 ; m < 
ch™√ls
 ; m++)

806 
	`¥ötf
 ("%d ", 
d©a
 [
m
]) ;

807 
	`¥ötf
 ("\n") ;

808 
	`exô
 (1) ;

812 
£ekpos
 = 
BUFFER_SIZE
 / 10 ;

815 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 
£ekpos
, 
SEEK_SET
)) != seekpos)

816 { 
	`¥ötf
 ("SìkÅÿ°¨ào‡fûê+ %ld faûed (%d).\n", 
£ekpos
, 
k
) ;

817 
	`exô
 (1) ;

820 
	`ã°_ªadf_öt_‹_dõ
 (
fûe
, 0, 
d©a
, 1, 
__LINE__
) ;

822 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
))

823 { 
	`¥ötf
 ("\n\nLöê%d: sf_£ek (SEEK_SETËfﬁlowed by sf_ªadf_öàÁûed (%d, %d).\n", 
__LINE__
, 
‹ig
 [1], 
d©a
 [0]) ;

824 
	`exô
 (1) ;

827 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
)Ë!
£ekpos
 + 1)

828 { 
	`¥ötf
 ("\n\nLöê%d: sf_£ek (SEEK_CURËwôh 0 off£àÁûed (%d should bê%ld)\n", 
__LINE__
, 
k
, 
£ekpos
 + 1) ;

829 
	`exô
 (1) ;

832 
£ekpos
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
Ë+ 
BUFFER_SIZE
 / 5 ;

833 
k
 = 
	`sf_£ek
 (
fûe
, 
BUFFER_SIZE
 / 5, 
SEEK_CUR
) ;

834 
	`ã°_ªadf_öt_‹_dõ
 (
fûe
, 0, 
d©a
, 1, 
__LINE__
) ;

835 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
Ë|| 
k
 != seekpos)

836 { 
	`¥ötf
 ("\n\nLöê%d: sf_£ek (f‹w¨ds, SEEK_CURËfﬁlowed by sf_ªadf_öàÁûed (%d, %dË(%d, %ld).\n", 
__LINE__
, 
d©a
 [0], 
‹ig
 [
£ekpos
 * 
ch™√ls
], 
k
, seekpos + 1) ;

837 
	`exô
 (1) ;

840 
£ekpos
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
) - 20 ;

842 
k
 = 
	`sf_£ek
 (
fûe
, -20, 
SEEK_CUR
) ;

843 
	`ã°_ªadf_öt_‹_dõ
 (
fûe
, 0, 
d©a
, 1, 
__LINE__
) ;

844 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
Ë|| 
k
 != seekpos)

845 { 
	`¥ötf
 ("sf_£ek (backw¨ds, SEEK_CURËfﬁlowed by sf_ªadf_öàÁûed (%d, %dË(%d, %ld).\n", 
d©a
 [0], 
‹ig
 [
£ekpos
 * 
ch™√ls
], 
k
, seekpos) ;

846 
	`exô
 (1) ;

850 
	`sf_£ek
 (
fûe
, (Ë
sföfo
.
‰ames
, 
SEEK_SET
) ;

852 i‡((
k
 = 
	`sf_ªadf_öt
 (
fûe
, 
d©a
, 
d©Æí
)) != 0)

853 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ vÆuê‰om sf_ªadf_öà∑°Énd o‡fûêöc‹ª˘ (%d).\n", 
__LINE__
, 
k
) ;

854 
	`exô
 (1) ;

858 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 5 - (Ë
sföfo
.
‰ames
, 
SEEK_END
)) != 5)

859 { 
	`¥ötf
 ("sf_£ek (SEEK_ENDËªtu∫ed %d in°ód o‡%d.\n", 
k
, 5) ;

860 
	`exô
 (1) ;

863 
	`ã°_ªadf_öt_‹_dõ
 (
fûe
, 0, 
d©a
, 
ch™√ls
, 
__LINE__
) ;

864 i‡(
	`îr‹_fun˘i⁄
 (
d©a
 [0] / 
sˇÀ
, 
‹ig
 [5] / sˇÀ, 
m¨gö
))

865 { 
	`¥ötf
 ("\n\nLöê%d: sf_£ek (SEEK_ENDËfﬁlowed by sf_ªadf_sh‹àÁûed (%d should bê%d).\n", 
__LINE__
, 
d©a
 [0], 
‹ig
 [5]) ;

866 
	`exô
 (1) ;

869 
	`sf_˛o£
 (
fûe
) ;

871 
	`u∆ök
 (
fûíame
) ;

872 
	`¥ötf
 ("ok\n") ;

873 
	}
}

879 
	$lcomp_ã°_Êﬂt
 (c⁄° *
fûíame
, 
fûëy≥
, 
ch™√ls
, 
m¨gö
)

880 { 
SNDFILE
 *
fûe
 ;

881 
SF_INFO
 
sföfo
 ;

882 
k
, 
m
, 
£ekpos
, 
sum_abs
 ;

883 
d©Æí
 ;

884 *
‹ig
, *
d©a
 ;

886 
	`¥öt_ã°_«me
 ("lcomp_ã°_Êﬂt", 
fûíame
) ;

888 
d©Æí
 = 
BUFFER_SIZE
 / 
ch™√ls
 ;

890 
d©a
 = 
d©a_buf„r
.
f
 ;

891 
‹ig
 = 
‹ig_buf„r
.
f
 ;

893 
	`gí_sig«l_doubÀ
 (
‹ig_buf„r
.
d
, 32000.0, 
ch™√ls
, 
d©Æí
) ;

894 
k
 = 0 ; k < 
ch™√ls
 * 
d©Æí
 ; k++)

895 
‹ig
 [
k
] = (Ë(
‹ig_buf„r
.
d
 [k]) ;

897 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

898 
sföfo
.
‰ames
 = 123456789 ;

899 
sföfo
.
ch™√ls
 = channels ;

900 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

902 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_FALSE
, 
__LINE__
) ;

903 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

904 
	`ã°_wrôef_Êﬂt_‹_dõ
 (
fûe
, 0, 
‹ig
, 
d©Æí
, 
__LINE__
) ;

905 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_COMMENT
, 
l⁄g_commít
) ;

906 
	`sf_˛o£
 (
fûe
) ;

908 
	`mem£t
 (
d©a
, 0, 
d©Æí
 *  ()) ;

910 i‡((
fûëy≥
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

911 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

913 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_FALSE
, 
__LINE__
) ;

915 i‡((
sföfo
.
f‹m©
 & (
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_SUBMASK
)Ë!(
fûëy≥
 & (SF_FORMAT_TYPEMASK | SF_FORMAT_SUBMASK)))

916 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

917 
	`exô
 (1) ;

920 i‡(
sföfo
.
‰ames
 < 
d©Æí
 / 
ch™√ls
)

921 { 
	`¥ötf
 ("Toÿ„w.‰ame†ö fûe. (%ld should bê®lôéêm‹êth™ %ld)\n", 
d©Æí
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

922 
	`exô
 (1) ;

925 i‡(
sföfo
.
‰ames
 > (
d©Æí
 + datalen / 20))

926 { 
	`¥ötf
 ("Toÿm™y.‰ame†ö fûe. (%ld should bê®lôéêm‹êth™ %ld)\n", 
d©Æí
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

927 
	`exô
 (1) ;

930 i‡(
sföfo
.
ch™√ls
 != channels)

931 { 
	`¥ötf
 ("IncorrectÇumber of channels in file.\n") ;

932 
	`exô
 (1) ;

935 
	`check_commít
 (
fûe
, 
fûëy≥
, 
__LINE__
) ;

937 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

939 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

941 
	`check_commít
 (
fûe
, 
fûëy≥
, 
__LINE__
) ;

943 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

945 
	`ã°_ªadf_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a
, 
d©Æí
, 
__LINE__
) ;

947 
sum_abs
 = 0.0 ;

948 
k
 = 0 ; k < 
d©Æí
 ; k++)

949 { i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [
k
], (Ë
‹ig
 [k], 
m¨gö
))

950 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ sam∂êA (#%d : %‡should bê%f).\n", 
__LINE__
, 
k
, 
d©a
 [k], 
‹ig
 [k]) ;

951 
	`o˘_ßve_Êﬂt
 (
‹ig
, 
d©a
, 
d©Æí
) ;

952 
	`exô
 (1) ;

954 
sum_abs
 +
	`Ábs
 (
d©a
 [
k
]) ;

957 i‡(
sum_abs
 < 1.0)

958 { 
	`¥ötf
 ("\n\nLöê%d: Sig«»i†Æ»zîos.\n", 
__LINE__
) ;

959 
	`exô
 (1) ;

962 i‡((
k
 = 
	`sf_ªadf_Êﬂt
 (
fûe
, 
d©a
, 
d©Æí
)Ë!
sföfo
.
‰ames
 - datalen)

963 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ÑódÜígth (%ld should bê%d).\n", 
__LINE__
,

964 
	`SF_COUNT_TO_LONG
 (
ch™√ls
 * 
sföfo
.
‰ames
 - 
d©Æí
), 
k
) ;

965 
	`exô
 (1) ;

971 i‡((
sföfo
.
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë!
SF_FORMAT_MS_ADPCM
)

972 
k
 = 0 ; k < 
sföfo
.
‰ames
 - 
d©Æí
 ; k++)

973 i‡(
	`abs
 (
d©a
 [
ch™√ls
 * 
k
]Ë> 
	`deˇy_ª•⁄£
 (channels * k))

974 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘ sam∂êB (#%d :áb†(%fËshould bê< %d).\n", 
__LINE__
, 
ch™√ls
 * 
k
, 
d©a
 [ch™√l†* k], 
	`deˇy_ª•⁄£
 (channels * k)) ;

975 
	`exô
 (1) ;

978 i‡(! 
sföfo
.
£ekabÀ
)

979 { 
	`sf_˛o£
 (
fûe
) ;

980 
	`u∆ök
 (
fûíame
) ;

981 
	`¥ötf
 ("ok\n") ;

987 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_SET
)) != 0)

988 { 
	`¥ötf
 ("\n\nLöê%d: SìkÅÿ°¨ào‡fûêÁûed (%d).\n", 
__LINE__
, 
k
) ;

989 
	`exô
 (1) ;

992 
m
 = 0 ; m < 3 ; m++)

993 { 
	`ã°_ªadf_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a
, 11, 
__LINE__
) ;

995 
k
 = 0 ; k < 
ch™√ls
 * 11 ; k++)

996 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [
k
], (Ë
‹ig
 [k + 
ch™√ls
 * 
m
 * 11], 
m¨gö
))

997 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ sam∂ê(m = %dË(#%d : %‡=> %f).\n", 
__LINE__
, 
m
, 
k
 + 
ch™√ls
 * m * 11, 
‹ig
 [k + ch™√l†* m * 11], 
d©a
 [k]) ;

998 
m
 = 0 ; m < 
ch™√ls
 ; m++)

999 
	`¥ötf
 ("%‡", 
d©a
 [
m
]) ;

1000 
	`¥ötf
 ("\n") ;

1001 
	`exô
 (1) ;

1005 
£ekpos
 = 
BUFFER_SIZE
 / 10 ;

1008 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 
£ekpos
, 
SEEK_SET
)) != seekpos)

1009 { 
	`¥ötf
 ("SìkÅÿ°¨ào‡fûê+ %d faûed (%d).\n", 
£ekpos
, 
k
) ;

1010 
	`exô
 (1) ;

1013 
	`ã°_ªadf_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a
, 1, 
__LINE__
) ;

1015 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
))

1016 { 
	`¥ötf
 ("\n\nLöê%d: sf_£ek (SEEK_SETËfﬁlowed by sf_ªadf_ÊﬂàÁûed (%f, %f).\n", 
__LINE__
, 
‹ig
 [1], 
d©a
 [0]) ;

1017 
	`exô
 (1) ;

1020 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
)Ë!
£ekpos
 + 1)

1021 { 
	`¥ötf
 ("\n\nLöê%d: sf_£ek (SEEK_CURËwôh 0 off£àÁûed (%d should bê%d)\n", 
__LINE__
, 
k
, 
£ekpos
 + 1) ;

1022 
	`exô
 (1) ;

1025 
£ekpos
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
Ë+ 
BUFFER_SIZE
 / 5 ;

1026 
k
 = 
	`sf_£ek
 (
fûe
, 
BUFFER_SIZE
 / 5, 
SEEK_CUR
) ;

1027 
	`ã°_ªadf_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a
, 1, 
__LINE__
) ;

1028 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
Ë|| 
k
 != seekpos)

1029 { 
	`¥ötf
 ("\n\nLöê%d: sf_£ek (f‹w¨ds, SEEK_CURËfﬁlowed by sf_ªadf_ÊﬂàÁûed (%f, %fË(%d, %d).\n", 
__LINE__
, 
d©a
 [0], 
‹ig
 [
£ekpos
 * 
ch™√ls
], 
k
, seekpos + 1) ;

1030 
	`exô
 (1) ;

1033 
£ekpos
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
) - 20 ;

1035 
k
 = 
	`sf_£ek
 (
fûe
, -20, 
SEEK_CUR
) ;

1036 
	`ã°_ªadf_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a
, 1, 
__LINE__
) ;

1037 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
Ë|| 
k
 != seekpos)

1038 { 
	`¥ötf
 ("sf_£ek (backw¨ds, SEEK_CURËfﬁlowed by sf_ªadf_ÊﬂàÁûed (%f, %fË(%d, %d).\n", 
d©a
 [0], 
‹ig
 [
£ekpos
 * 
ch™√ls
], 
k
, seekpos) ;

1039 
	`exô
 (1) ;

1043 
	`sf_£ek
 (
fûe
, (Ë
sföfo
.
‰ames
, 
SEEK_SET
) ;

1045 i‡((
k
 = 
	`sf_ªadf_Êﬂt
 (
fûe
, 
d©a
, 
d©Æí
)) != 0)

1046 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ vÆuê‰om sf_ªadf_Êﬂà∑°Énd o‡fûêöc‹ª˘ (%d).\n", 
__LINE__
, 
k
) ;

1047 
	`exô
 (1) ;

1051 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 5 - (Ë
sföfo
.
‰ames
, 
SEEK_END
)) != 5)

1052 { 
	`¥ötf
 ("sf_£ek (SEEK_ENDËªtu∫ed %d in°ód o‡%d.\n", 
k
, 5) ;

1053 
	`exô
 (1) ;

1056 
	`ã°_ªadf_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a
, 
ch™√ls
, 
__LINE__
) ;

1057 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [5], 
m¨gö
))

1058 { 
	`¥ötf
 ("\n\nLöê%d: sf_£ek (SEEK_ENDËfﬁlowed by sf_ªadf_sh‹àÁûed (%‡should bê%f).\n", 
__LINE__
, 
d©a
 [0], 
‹ig
 [5]) ;

1059 
	`exô
 (1) ;

1062 
	`sf_˛o£
 (
fûe
) ;

1064 
	`u∆ök
 (
fûíame
) ;

1065 
	`¥ötf
 ("ok\n") ;

1066 
	}
}

1072 
	$lcomp_ã°_doubÀ
 (c⁄° *
fûíame
, 
fûëy≥
, 
ch™√ls
, 
m¨gö
)

1073 { 
SNDFILE
 *
fûe
 ;

1074 
SF_INFO
 
sföfo
 ;

1075 
k
, 
m
, 
£ekpos
, 
sum_abs
 ;

1076 
d©Æí
 ;

1077 *
‹ig
, *
d©a
 ;

1079 
	`¥öt_ã°_«me
 ("lcomp_ã°_doubÀ", 
fûíame
) ;

1081 
d©Æí
 = 
BUFFER_SIZE
 / 
ch™√ls
 ;

1083 
d©a
 = 
d©a_buf„r
.
d
 ;

1084 
‹ig
 = 
‹ig_buf„r
.
d
 ;

1086 
	`gí_sig«l_doubÀ
 (
‹ig_buf„r
.
d
, 32000.0, 
ch™√ls
, 
d©Æí
) ;

1087 
k
 = 0 ; k < 
ch™√ls
 * 
d©Æí
 ; k++)

1088 
‹ig
 [
k
] = (Ë(
‹ig_buf„r
.
d
 [k]) ;

1090 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

1091 
sföfo
.
‰ames
 = 123456789 ;

1092 
sföfo
.
ch™√ls
 = channels ;

1093 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

1095 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_FALSE
, 
__LINE__
) ;

1096 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

1097 
	`ã°_wrôef_doubÀ_‹_dõ
 (
fûe
, 0, 
‹ig
, 
d©Æí
, 
__LINE__
) ;

1098 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_COMMENT
, 
l⁄g_commít
) ;

1099 
	`sf_˛o£
 (
fûe
) ;

1101 
	`mem£t
 (
d©a
, 0, 
d©Æí
 *  ()) ;

1103 i‡((
fûëy≥
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

1104 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

1106 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_FALSE
, 
__LINE__
) ;

1108 i‡((
sföfo
.
f‹m©
 & (
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_SUBMASK
)Ë!(
fûëy≥
 & (SF_FORMAT_TYPEMASK | SF_FORMAT_SUBMASK)))

1109 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

1110 
	`exô
 (1) ;

1113 i‡(
sföfo
.
‰ames
 < 
d©Æí
 / 
ch™√ls
)

1114 { 
	`¥ötf
 ("Toÿ„w.‰ame†ö fûe. (%ld should bê®lôéêm‹êth™ %ld)\n", 
d©Æí
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

1115 
	`exô
 (1) ;

1118 i‡(
sföfo
.
‰ames
 > (
d©Æí
 + datalen / 20))

1119 { 
	`¥ötf
 ("Toÿm™y.‰ame†ö fûe. (%ld should bê®lôéêm‹êth™ %ld)\n", 
d©Æí
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

1120 
	`exô
 (1) ;

1123 i‡(
sföfo
.
ch™√ls
 != channels)

1124 { 
	`¥ötf
 ("IncorrectÇumber of channels in file.\n") ;

1125 
	`exô
 (1) ;

1128 
	`check_commít
 (
fûe
, 
fûëy≥
, 
__LINE__
) ;

1130 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

1132 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

1134 
	`check_commít
 (
fûe
, 
fûëy≥
, 
__LINE__
) ;

1136 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

1138 
	`ã°_ªadf_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
, 
d©Æí
, 
__LINE__
) ;

1140 
sum_abs
 = 0.0 ;

1141 
k
 = 0 ; k < 
d©Æí
 ; k++)

1142 { i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [
k
], (Ë
‹ig
 [k], 
m¨gö
))

1143 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ sam∂êA (#%d : %‡should bê%f).\n", 
__LINE__
, 
k
, 
d©a
 [k], 
‹ig
 [k]) ;

1144 
	`o˘_ßve_doubÀ
 (
‹ig
, 
d©a
, 
d©Æí
) ;

1145 
	`exô
 (1) ;

1147 
sum_abs
 +
	`Ábs
 (
d©a
 [
k
]) ;

1150 i‡(
sum_abs
 < 1.0)

1151 { 
	`¥ötf
 ("\n\nLöê%d: Sig«»i†Æ»zîos.\n", 
__LINE__
) ;

1152 
	`exô
 (1) ;

1155 i‡((
k
 = 
	`sf_ªadf_doubÀ
 (
fûe
, 
d©a
, 
d©Æí
)Ë!
sföfo
.
‰ames
 - datalen)

1156 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ÑódÜígth (%ld should bê%d).\n", 
__LINE__
,

1157 
	`SF_COUNT_TO_LONG
 (
ch™√ls
 * 
sföfo
.
‰ames
 - 
d©Æí
), 
k
) ;

1158 
	`exô
 (1) ;

1164 i‡((
sföfo
.
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë!
SF_FORMAT_MS_ADPCM
)

1165 
k
 = 0 ; k < 
sföfo
.
‰ames
 - 
d©Æí
 ; k++)

1166 i‡(
	`abs
 (
d©a
 [
ch™√ls
 * 
k
]Ë> 
	`deˇy_ª•⁄£
 (channels * k))

1167 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘ sam∂êB (#%d :áb†(%fËshould bê< %d).\n", 
__LINE__
, 
ch™√ls
 * 
k
, 
d©a
 [ch™√l†* k], 
	`deˇy_ª•⁄£
 (channels * k)) ;

1168 
	`exô
 (1) ;

1171 i‡(! 
sföfo
.
£ekabÀ
)

1172 { 
	`sf_˛o£
 (
fûe
) ;

1173 
	`u∆ök
 (
fûíame
) ;

1174 
	`¥ötf
 ("ok\n") ;

1180 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_SET
)) != 0)

1181 { 
	`¥ötf
 ("\n\nLöê%d: SìkÅÿ°¨ào‡fûêÁûed (%d).\n", 
__LINE__
, 
k
) ;

1182 
	`exô
 (1) ;

1185 
m
 = 0 ; m < 3 ; m++)

1186 { 
	`ã°_ªadf_doubÀ_‹_dõ
 (
fûe
, 
m
, 
d©a
, 11, 
__LINE__
) ;

1188 
k
 = 0 ; k < 
ch™√ls
 * 11 ; k++)

1189 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [
k
], (Ë
‹ig
 [k + 
ch™√ls
 * 
m
 * 11], 
m¨gö
))

1190 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ sam∂ê(m = %dË(#%d : %‡=> %f).\n", 
__LINE__
, 
m
, 
k
 + 
ch™√ls
 * m * 11, 
‹ig
 [k + ch™√l†* m * 11], 
d©a
 [k]) ;

1191 
m
 = 0 ; m < 
ch™√ls
 ; m++)

1192 
	`¥ötf
 ("%‡", 
d©a
 [
m
]) ;

1193 
	`¥ötf
 ("\n") ;

1194 
	`exô
 (1) ;

1198 
£ekpos
 = 
BUFFER_SIZE
 / 10 ;

1201 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 
£ekpos
, 
SEEK_SET
)) != seekpos)

1202 { 
	`¥ötf
 ("SìkÅÿ°¨ào‡fûê+ %d faûed (%d).\n", 
£ekpos
, 
k
) ;

1203 
	`exô
 (1) ;

1206 
	`ã°_ªadf_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
, 1, 
__LINE__
) ;

1208 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
))

1209 { 
	`¥ötf
 ("\n\nLöê%d: sf_£ek (SEEK_SETËfﬁlowed by sf_ªadf_doubÀ faûed (%f, %f).\n", 
__LINE__
, 
‹ig
 [1], 
d©a
 [0]) ;

1210 
	`exô
 (1) ;

1213 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
)Ë!
£ekpos
 + 1)

1214 { 
	`¥ötf
 ("\n\nLöê%d: sf_£ek (SEEK_CURËwôh 0 off£àÁûed (%d should bê%d)\n", 
__LINE__
, 
k
, 
£ekpos
 + 1) ;

1215 
	`exô
 (1) ;

1218 
£ekpos
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
Ë+ 
BUFFER_SIZE
 / 5 ;

1219 
k
 = 
	`sf_£ek
 (
fûe
, 
BUFFER_SIZE
 / 5, 
SEEK_CUR
) ;

1220 
	`ã°_ªadf_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
, 1, 
__LINE__
) ;

1221 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
Ë|| 
k
 != seekpos)

1222 { 
	`¥ötf
 ("\n\nLöê%d: sf_£ek (f‹w¨ds, SEEK_CURËfﬁlowed by sf_ªadf_doubÀ faûed (%f, %fË(%d, %d).\n", 
__LINE__
, 
d©a
 [0], 
‹ig
 [
£ekpos
 * 
ch™√ls
], 
k
, seekpos + 1) ;

1223 
	`exô
 (1) ;

1226 
£ekpos
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
) - 20 ;

1228 
k
 = 
	`sf_£ek
 (
fûe
, -20, 
SEEK_CUR
) ;

1229 
	`ã°_ªadf_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
, 1, 
__LINE__
) ;

1230 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
Ë|| 
k
 != seekpos)

1231 { 
	`¥ötf
 ("sf_£ek (backw¨ds, SEEK_CURËfﬁlowed by sf_ªadf_doubÀ faûed (%f, %fË(%d, %d).\n", 
d©a
 [0], 
‹ig
 [
£ekpos
 * 
ch™√ls
], 
k
, seekpos) ;

1232 
	`exô
 (1) ;

1236 
	`sf_£ek
 (
fûe
, (Ë
sföfo
.
‰ames
, 
SEEK_SET
) ;

1238 i‡((
k
 = 
	`sf_ªadf_doubÀ
 (
fûe
, 
d©a
, 
d©Æí
)) != 0)

1239 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ vÆuê‰om sf_ªadf_doubÀÖa°Énd o‡fûêöc‹ª˘ (%d).\n", 
__LINE__
, 
k
) ;

1240 
	`exô
 (1) ;

1244 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 5 - (Ë
sföfo
.
‰ames
, 
SEEK_END
)) != 5)

1245 { 
	`¥ötf
 ("sf_£ek (SEEK_ENDËªtu∫ed %d in°ód o‡%d.\n", 
k
, 5) ;

1246 
	`exô
 (1) ;

1249 
	`ã°_ªadf_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
, 
ch™√ls
, 
__LINE__
) ;

1250 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [5], 
m¨gö
))

1251 { 
	`¥ötf
 ("\n\nLöê%d: sf_£ek (SEEK_ENDËfﬁlowed by sf_ªadf_sh‹àÁûed (%‡should bê%f).\n", 
__LINE__
, 
d©a
 [0], 
‹ig
 [5]) ;

1252 
	`exô
 (1) ;

1255 
	`sf_˛o£
 (
fûe
) ;

1257 
	`u∆ök
 (
fûíame
) ;

1258 
	`¥ötf
 ("ok\n") ;

1259 
	}
}

1266 
	$sdlcomp_ã°_sh‹t
 (c⁄° *
fûíame
, 
fûëy≥
, 
ch™√ls
, 
m¨gö
)

1267 { 
SNDFILE
 *
fûe
 ;

1268 
SF_INFO
 
sföfo
 ;

1269 
k
, 
m
, 
£ekpos
, 
sum_abs
 ;

1270 
d©Æí
 ;

1271 *
‹ig
, *
d©a
, *
smoŸh
 ;

1273 
ch™√ls
 = 1 ;

1274 
	`¥öt_ã°_«me
 ("sdlcomp_ã°_sh‹t", 
fûíame
) ;

1276 
d©Æí
 = 
BUFFER_SIZE
 ;

1278 
‹ig
 = 
‹ig_buf„r
.
s
 ;

1279 
d©a
 = 
d©a_buf„r
.
s
 ;

1280 
smoŸh
 = 
smoŸh_buf„r
.
s
 ;

1282 
	`gí_sig«l_doubÀ
 (
‹ig_buf„r
.
d
, 32000.0, 
ch™√ls
, 
d©Æí
) ;

1283 
k
 = 0 ; k < 
d©Æí
 ; k++)

1284 
‹ig
 [
k
] = (Ë(
‹ig_buf„r
.
d
 [k]) ;

1286 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

1287 
sföfo
.
‰ames
 = 123456789 ;

1288 
sföfo
.
ch™√ls
 = channels ;

1289 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

1291 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_FALSE
, 
__LINE__
) ;

1292 
	`ã°_wrôe_sh‹t_‹_dõ
 (
fûe
, 0, 
‹ig
, 
d©Æí
, 
__LINE__
) ;

1293 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_COMMENT
, 
l⁄g_commít
) ;

1294 
	`sf_˛o£
 (
fûe
) ;

1296 
	`mem£t
 (
d©a
, 0, 
d©Æí
 *  ()) ;

1298 i‡((
fûëy≥
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

1299 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

1301 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_FALSE
, 
__LINE__
) ;

1303 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

1304 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

1305 
	`exô
 (1) ;

1308 i‡(
sföfo
.
‰ames
 < 
d©Æí
 / 
ch™√ls
)

1309 { 
	`¥ötf
 ("Toÿ„w.‰ame†ö fûe. (%ld should bê®lôéêm‹êth™ %ld)\n", 
d©Æí
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

1310 
	`exô
 (1) ;

1313 i‡(
sföfo
.
‰ames
 > (
d©Æí
 + 400))

1314 { 
	`¥ötf
 ("Toÿm™y.‰ame†ö fûe. (%ld should bê®lôéêm‹êth™ %ld)\n", 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
d©Æí
) ;

1315 
	`exô
 (1) ;

1318 i‡(
sföfo
.
ch™√ls
 != channels)

1319 { 
	`¥ötf
 ("IncorrectÇumber of channels in file.\n") ;

1320 
	`exô
 (1) ;

1323 
	`check_commít
 (
fûe
, 
fûëy≥
, 
__LINE__
) ;

1325 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

1327 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

1329 
	`ã°_ªadf_sh‹t_‹_dõ
 (
fûe
, 0, 
d©a
, 
d©Æí
, 
__LINE__
) ;

1331 
	`mem˝y
 (
smoŸh
, 
‹ig
, 
d©Æí
 *  ()) ;

1332 
	`smoŸhed_diff_sh‹t
 (
d©a
, 
d©Æí
) ;

1333 
	`smoŸhed_diff_sh‹t
 (
smoŸh
, 
d©Æí
) ;

1335 
sum_abs
 = 
	`abs
 (
d©a
 [0]) ;

1336 
k
 = 1 ; k < 
d©Æí
 ; k++)

1337 { i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [
k
], (Ë
smoŸh
 [k], 
m¨gö
))

1338 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ sam∂ê(#%d : %d should bê%d).\n", 
__LINE__
, 
k
, 
d©a
 [k], 
smoŸh
 [k]) ;

1339 
	`o˘_ßve_sh‹t
 (
‹ig
, 
smoŸh
, 
d©Æí
) ;

1340 
	`exô
 (1) ;

1342 
sum_abs
 = 
	`abs
 (sum_ab†+áb†(
d©a
 [
k
])) ;

1345 i‡(
sum_abs
 < 1)

1346 { 
	`¥ötf
 ("\n\nLöê%d: Sig«»i†Æ»zîos.\n", 
__LINE__
) ;

1347 
	`exô
 (1) ;

1350 i‡((
k
 = 
	`sf_ªad_sh‹t
 (
fûe
, 
d©a
, 
d©Æí
)Ë!
sföfo
.
‰ames
 - datalen)

1351 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ÑódÜígth (%d should bê%ld).\n", 
__LINE__
, 
k
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
 - 
d©Æí
)) ;

1352 
	`exô
 (1) ;

1355 i‡((
sföfo
.
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë!
SF_FORMAT_MS_ADPCM
 &&

1356 (
sföfo
.
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë!
SF_FORMAT_GSM610
)

1357 
k
 = 0 ; k < 
sföfo
.
‰ames
 - 
d©Æí
 ; k++)

1358 i‡(
	`abs
 (
d©a
 [
k
]Ë> 
	`deˇy_ª•⁄£
 (k))

1359 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ sam∂ê(#%ld :áb†(%dËshould bê< %d).\n", 
__LINE__
, 
d©Æí
 + 
k
, 
d©a
 [k], 
	`deˇy_ª•⁄£
 (k)) ;

1360 
	`exô
 (1) ;

1364 i‡(
sföfo
.
£ekabÀ
)

1365 { i‡((
k
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_SET
)) != 0)

1366 { 
	`¥ötf
 ("\n\nLöê%d: SìkÅÿ°¨ào‡fûêÁûed (%d).\n", 
__LINE__
, 
k
) ;

1367 
	`exô
 (1) ;

1370 
m
 = 0 ; m < 3 ; m++)

1371 { 
	`ã°_ªadf_sh‹t_‹_dõ
 (
fûe
, 
m
, 
d©a
, 
d©Æí
 / 7, 
__LINE__
) ;

1373 
	`smoŸhed_diff_sh‹t
 (
d©a
, 
d©Æí
 / 7) ;

1374 
	`mem˝y
 (
smoŸh
, 
‹ig
 + 
m
 * 
d©Æí
 / 7, datalen / 7 *  ()) ;

1375 
	`smoŸhed_diff_sh‹t
 (
smoŸh
, 
d©Æí
 / 7) ;

1377 
k
 = 0 ; k < 
d©Æí
 / 7 ; k++)

1378 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [
k
], (Ë
smoŸh
 [k], 
m¨gö
))

1379 { 
	`¥ötf
 ("Inc‹ª˘ sam∂êC (#%d (%ldË: %d => %d).\n", 
k
, k + 
m
 * (
d©Æí
 / 7), 
smoŸh
 [k], 
d©a
 [k]) ;

1380 
m
 = 0 ; m < 10 ; m++)

1381 
	`¥ötf
 ("%d ", 
d©a
 [
k
]) ;

1382 
	`¥ötf
 ("\n") ;

1383 
	`exô
 (1) ;

1387 
£ekpos
 = 
BUFFER_SIZE
 / 10 ;

1390 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 
£ekpos
, 
SEEK_SET
)) != seekpos)

1391 { 
	`¥ötf
 ("SìkÅÿ°¨ào‡fûê+ %d faûed (%d).\n", 
£ekpos
, 
k
) ;

1392 
	`exô
 (1) ;

1394 
	`ã°_ªadf_sh‹t_‹_dõ
 (
fûe
, 0, 
d©a
, 1, 
__LINE__
) ;

1396 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
))

1397 { 
	`¥ötf
 ("sf_£ek (SEEK_SETËfﬁlowed by sf_ªad_sh‹àÁûed (%d, %d).\n", 
‹ig
 [1], 
d©a
 [0]) ;

1398 
	`exô
 (1) ;

1401 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
)Ë!
£ekpos
 + 1)

1402 { 
	`¥ötf
 ("sf_£ek (SEEK_CURËwôh 0 off£àÁûed (%d should bê%d)\n", 
k
, 
£ekpos
 + 1) ;

1403 
	`exô
 (1) ;

1406 
£ekpos
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
Ë+ 
BUFFER_SIZE
 / 5 ;

1407 
k
 = 
	`sf_£ek
 (
fûe
, 
BUFFER_SIZE
 / 5, 
SEEK_CUR
) ;

1408 
	`ã°_ªadf_sh‹t_‹_dõ
 (
fûe
, 0, 
d©a
, 
ch™√ls
, 
__LINE__
) ;

1409 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
Ë|| 
k
 != seekpos)

1410 { 
	`¥ötf
 ("sf_£ek (f‹w¨ds, SEEK_CURËfﬁlowed by sf_ªad_sh‹àÁûed (%d, %dË(%d, %d).\n", 
d©a
 [0], 
‹ig
 [
£ekpos
 * 
ch™√ls
], 
k
, seekpos + 1) ;

1411 
	`exô
 (1) ;

1414 
£ekpos
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
) - 20 ;

1416 
k
 = 
	`sf_£ek
 (
fûe
, -20, 
SEEK_CUR
) ;

1417 
	`ã°_ªadf_sh‹t_‹_dõ
 (
fûe
, 0, 
d©a
, 
ch™√ls
, 
__LINE__
) ;

1418 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
Ë|| 
k
 != seekpos)

1419 { 
	`¥ötf
 ("sf_£ek (backw¨ds, SEEK_CURËfﬁlowed by sf_ªad_sh‹àÁûed (%d, %dË(%d, %d).\n", 
d©a
 [0], 
‹ig
 [
£ekpos
 * 
ch™√ls
], 
k
, seekpos) ;

1420 
	`exô
 (1) ;

1424 
	`sf_£ek
 (
fûe
, (Ë
sföfo
.
‰ames
, 
SEEK_SET
) ;

1426 i‡((
k
 = 
	`sf_ªad_sh‹t
 (
fûe
, 
d©a
, 
d©Æí
)) != 0)

1427 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ vÆuê‰om sf_ªad_sh‹à∑°Énd o‡fûêöc‹ª˘ (%d).\n", 
__LINE__
, 
k
) ;

1428 
	`exô
 (1) ;

1433 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 5 - (Ë
sföfo
.
‰ames
, 
SEEK_END
)) != 5)

1434 { 
	`¥ötf
 ("sf_£ek (SEEK_ENDËªtu∫ed %d in°ód o‡%d.\n", 
k
, 5) ;

1435 
	`exô
 (1) ;

1438 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 0, 
d©a
, 
ch™√ls
, 
__LINE__
) ;

1439 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [5], 
m¨gö
))

1440 { 
	`¥ötf
 ("sf_£ek (SEEK_ENDËfﬁlowed by sf_ªad_sh‹àÁûed (%d should bê%d).\n", 
d©a
 [0], 
‹ig
 [5]) ;

1441 
	`exô
 (1) ;

1445 
	`sf_˛o£
 (
fûe
) ;

1447 
	`u∆ök
 (
fûíame
) ;

1448 
	`¥ötf
 ("ok\n") ;

1449 
	}
}

1452 
	$sdlcomp_ã°_öt
 (c⁄° *
fûíame
, 
fûëy≥
, 
ch™√ls
, 
m¨gö
)

1453 { 
SNDFILE
 *
fûe
 ;

1454 
SF_INFO
 
sföfo
 ;

1455 
k
, 
m
, 
£ekpos
, 
sum_abs
 ;

1456 
d©Æí
 ;

1457 *
‹ig
, *
d©a
, *
smoŸh
 ;

1458 
sˇÀ
 ;

1460 
ch™√ls
 = 1 ;

1462 
	`¥öt_ã°_«me
 ("sdlcomp_ã°_öt", 
fûíame
) ;

1464 
d©Æí
 = 
BUFFER_SIZE
 ;

1465 
sˇÀ
 = 1.0 * 0x10000 ;

1467 
‹ig
 = 
‹ig_buf„r
.
i
 ;

1468 
d©a
 = 
d©a_buf„r
.
i
 ;

1469 
smoŸh
 = 
smoŸh_buf„r
.
i
 ;

1471 
	`gí_sig«l_doubÀ
 (
‹ig_buf„r
.
d
, 32000.0 * 
sˇÀ
, 
ch™√ls
, 
d©Æí
) ;

1472 
k
 = 0 ; k < 
d©Æí
 ; k++)

1473 
‹ig
 [
k
] = (Ë(
‹ig_buf„r
.
d
 [k]) ;

1475 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

1476 
sföfo
.
‰ames
 = 123456789 ;

1477 
sföfo
.
ch™√ls
 = channels ;

1478 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

1480 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_FALSE
, 
__LINE__
) ;

1481 
	`ã°_wrôef_öt_‹_dõ
 (
fûe
, 0, 
‹ig
, 
d©Æí
, 
__LINE__
) ;

1482 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_COMMENT
, 
l⁄g_commít
) ;

1483 
	`sf_˛o£
 (
fûe
) ;

1485 
	`mem£t
 (
d©a
, 0, 
d©Æí
 *  ()) ;

1487 i‡((
fûëy≥
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

1488 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

1490 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_FALSE
, 
__LINE__
) ;

1492 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

1493 { 
	`¥ötf
 ("Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
fûëy≥
, 
sföfo
.
f‹m©
) ;

1494 
	`exô
 (1) ;

1497 i‡(
sföfo
.
‰ames
 < 
d©Æí
 / 
ch™√ls
)

1498 { 
	`¥ötf
 ("Toÿ„w.‰ame†ö fûe. (%ld should bê®lôéêm‹êth™ %ld)\n", 
d©Æí
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

1499 
	`exô
 (1) ;

1502 i‡(
sföfo
.
‰ames
 > (
d©Æí
 + 400))

1503 { 
	`¥ötf
 ("Toÿm™y.‰ame†ö fûe. (%ld should bê®lôéêm‹êth™ %ld)\n", 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
d©Æí
) ;

1504 
	`exô
 (1) ;

1507 i‡(
sföfo
.
ch™√ls
 != channels)

1508 { 
	`¥ötf
 ("IncorrectÇumber of channels in file.\n") ;

1509 
	`exô
 (1) ;

1512 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

1514 
	`ã°_ªadf_öt_‹_dõ
 (
fûe
, 0, 
d©a
, 
d©Æí
, 
__LINE__
) ;

1516 
	`mem˝y
 (
smoŸh
, 
‹ig
, 
d©Æí
 *  ()) ;

1517 
	`smoŸhed_diff_öt
 (
d©a
, 
d©Æí
) ;

1518 
	`smoŸhed_diff_öt
 (
smoŸh
, 
d©Æí
) ;

1520 
sum_abs
 = 
	`abs
 (
d©a
 [0] >> 16) ;

1521 
k
 = 1 ; k < 
d©Æí
 ; k++)

1522 { i‡(
	`îr‹_fun˘i⁄
 (
d©a
 [
k
] / 
sˇÀ
, 
smoŸh
 [k] / sˇÀ, 
m¨gö
))

1523 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ sam∂ê(#%d : %d should bê%d).\n", 
__LINE__
, 
k
, 
d©a
 [k], 
smoŸh
 [k]) ;

1524 
	`o˘_ßve_öt
 (
‹ig
, 
smoŸh
, 
d©Æí
) ;

1525 
	`exô
 (1) ;

1527 
sum_abs
 = 
	`abs
 (sum_ab†+áb†(
d©a
 [
k
] >> 16)) ;

1530 i‡(
sum_abs
 < 1)

1531 { 
	`¥ötf
 ("\n\nLöê%d: Sig«»i†Æ»zîos.\n", 
__LINE__
) ;

1532 
	`exô
 (1) ;

1535 i‡((
k
 = 
	`sf_ªadf_öt
 (
fûe
, 
d©a
, 
d©Æí
)Ë!
sföfo
.
‰ames
 - datalen)

1536 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ÑódÜígth (%d should bê%ld).\n", 
__LINE__
, 
k
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
 - 
d©Æí
)) ;

1537 
	`exô
 (1) ;

1540 i‡((
sföfo
.
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë!
SF_FORMAT_IMA_ADPCM
 &&

1541 (
sföfo
.
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë!
SF_FORMAT_MS_ADPCM
 &&

1542 (
sföfo
.
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë!
SF_FORMAT_GSM610
 &&

1543 (
sföfo
.
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë!
SF_FORMAT_G721_32
 &&

1544 (
sföfo
.
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë!
SF_FORMAT_G723_24
)

1545 
k
 = 0 ; k < 
sföfo
.
‰ames
 - 
d©Æí
 ; k++)

1546 i‡(
	`abs
 (
d©a
 [
k
]Ë> 
	`deˇy_ª•⁄£
 (k))

1547 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ sam∂ê(#%ld :áb†(%dËshould bê< %d).\n", 
__LINE__
, 
d©Æí
 + 
k
, 
d©a
 [k], 
	`deˇy_ª•⁄£
 (k)) ;

1548 
	`exô
 (1) ;

1552 i‡(
sföfo
.
£ekabÀ
)

1553 { i‡((
k
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_SET
)) != 0)

1554 { 
	`¥ötf
 ("\n\nLöê%d: SìkÅÿ°¨ào‡fûêÁûed (%d).\n", 
__LINE__
, 
k
) ;

1555 
	`exô
 (1) ;

1558 
m
 = 0 ; m < 3 ; m++)

1559 { 
	`ã°_ªadf_öt_‹_dõ
 (
fûe
, 
m
, 
d©a
, 
d©Æí
 / 7, 
__LINE__
) ;

1561 
	`smoŸhed_diff_öt
 (
d©a
, 
d©Æí
 / 7) ;

1562 
	`mem˝y
 (
smoŸh
, 
‹ig
 + 
m
 * 
d©Æí
 / 7, datalen / 7 *  ()) ;

1563 
	`smoŸhed_diff_öt
 (
smoŸh
, 
d©Æí
 / 7) ;

1565 
k
 = 0 ; k < 
d©Æí
 / 7 ; k++)

1566 i‡(
	`îr‹_fun˘i⁄
 (
d©a
 [
k
] / 
sˇÀ
, 
smoŸh
 [k] / sˇÀ, 
m¨gö
))

1567 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ sam∂ê(#%d (%ldË: %d => %d).\n", 
__LINE__
, 
k
, k + 
m
 * (
d©Æí
 / 7), 
smoŸh
 [k], 
d©a
 [k]) ;

1568 
m
 = 0 ; m < 10 ; m++)

1569 
	`¥ötf
 ("%d ", 
d©a
 [
k
]) ;

1570 
	`¥ötf
 ("\n") ;

1571 
	`exô
 (1) ;

1575 
£ekpos
 = 
BUFFER_SIZE
 / 10 ;

1578 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 
£ekpos
, 
SEEK_SET
)) != seekpos)

1579 { 
	`¥ötf
 ("SìkÅÿ°¨ào‡fûê+ %d faûed (%d).\n", 
£ekpos
, 
k
) ;

1580 
	`exô
 (1) ;

1582 
	`ã°_ªadf_öt_‹_dõ
 (
fûe
, 0, 
d©a
, 1, 
__LINE__
) ;

1584 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
))

1585 { 
	`¥ötf
 ("sf_£ek (SEEK_SETËfﬁlowed by sf_ªadf_öàÁûed (%d, %d).\n", 
‹ig
 [1], 
d©a
 [0]) ;

1586 
	`exô
 (1) ;

1589 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
)Ë!
£ekpos
 + 1)

1590 { 
	`¥ötf
 ("sf_£ek (SEEK_CURËwôh 0 off£àÁûed (%d should bê%d)\n", 
k
, 
£ekpos
 + 1) ;

1591 
	`exô
 (1) ;

1594 
£ekpos
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
Ë+ 
BUFFER_SIZE
 / 5 ;

1595 
k
 = 
	`sf_£ek
 (
fûe
, 
BUFFER_SIZE
 / 5, 
SEEK_CUR
) ;

1596 
	`ã°_ªadf_öt_‹_dõ
 (
fûe
, 0, 
d©a
, 1, 
__LINE__
) ;

1597 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
Ë|| 
k
 != seekpos)

1598 { 
	`¥ötf
 ("sf_£ek (f‹w¨ds, SEEK_CURËfﬁlowed by sf_ªadf_öàÁûed (%d, %dË(%d, %d).\n", 
d©a
 [0], 
‹ig
 [
£ekpos
 * 
ch™√ls
], 
k
, seekpos + 1) ;

1599 
	`exô
 (1) ;

1602 
£ekpos
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
) - 20 ;

1604 
k
 = 
	`sf_£ek
 (
fûe
, -20, 
SEEK_CUR
) ;

1605 
	`ã°_ªadf_öt_‹_dõ
 (
fûe
, 0, 
d©a
, 1, 
__LINE__
) ;

1606 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
Ë|| 
k
 != seekpos)

1607 { 
	`¥ötf
 ("sf_£ek (backw¨ds, SEEK_CURËfﬁlowed by sf_ªadf_öàÁûed (%d, %dË(%d, %d).\n", 
d©a
 [0], 
‹ig
 [
£ekpos
 * 
ch™√ls
], 
k
, seekpos) ;

1608 
	`exô
 (1) ;

1612 
	`sf_£ek
 (
fûe
, (Ë
sföfo
.
‰ames
, 
SEEK_SET
) ;

1614 i‡((
k
 = 
	`sf_ªadf_öt
 (
fûe
, 
d©a
, 
d©Æí
)) != 0)

1615 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ vÆuê‰om sf_ªadf_öà∑°Énd o‡fûêöc‹ª˘ (%d).\n", 
__LINE__
, 
k
) ;

1616 
	`exô
 (1) ;

1621 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 5 - (Ë
sföfo
.
‰ames
, 
SEEK_END
)) != 5)

1622 { 
	`¥ötf
 ("sf_£ek (SEEK_ENDËªtu∫ed %d in°ód o‡%d.\n", 
k
, 5) ;

1623 
	`exô
 (1) ;

1626 
	`ã°_ªadf_öt_‹_dõ
 (
fûe
, 0, 
d©a
, 1, 
__LINE__
) ;

1627 i‡(
	`îr‹_fun˘i⁄
 (
d©a
 [0] / 
sˇÀ
, 
‹ig
 [5] / sˇÀ, 
m¨gö
))

1628 { 
	`¥ötf
 ("\n\nLöê%d: sf_£ek (SEEK_ENDËfﬁlowed by sf_ªadf_öàÁûed (%d should bê%d).\n", 
__LINE__
, 
d©a
 [0], 
‹ig
 [5]) ;

1629 
	`exô
 (1) ;

1633 
	`sf_˛o£
 (
fûe
) ;

1635 
	`u∆ök
 (
fûíame
) ;

1636 
	`¥ötf
 ("ok\n") ;

1637 
	}
}

1640 
	$sdlcomp_ã°_Êﬂt
 (c⁄° *
fûíame
, 
fûëy≥
, 
ch™√ls
, 
m¨gö
)

1641 { 
SNDFILE
 *
fûe
 ;

1642 
SF_INFO
 
sföfo
 ;

1643 
k
, 
m
, 
£ekpos
 ;

1644 
d©Æí
 ;

1645 *
‹ig
, *
d©a
, *
smoŸh
 ;

1646 
sum_abs
 ;

1648 
ch™√ls
 = 1 ;

1650 
	`¥öt_ã°_«me
 ("sdlcomp_ã°_Êﬂt", 
fûíame
) ;

1652 
	`¥ötf
 ("** fixÅhis ** ") ;

1654 
d©Æí
 = 
BUFFER_SIZE
 ;

1656 
‹ig
 = 
‹ig_buf„r
.
f
 ;

1657 
d©a
 = 
d©a_buf„r
.
f
 ;

1658 
smoŸh
 = 
smoŸh_buf„r
.
f
 ;

1660 
	`gí_sig«l_doubÀ
 (
‹ig_buf„r
.
d
, 32000.0, 
ch™√ls
, 
d©Æí
) ;

1661 
k
 = 0 ; k < 
d©Æí
 ; k++)

1662 
‹ig
 [
k
] = (Ë(
‹ig_buf„r
.
d
 [k]) ;

1664 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

1665 
sföfo
.
‰ames
 = 123456789 ;

1666 
sföfo
.
ch™√ls
 = channels ;

1667 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

1669 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_FALSE
, 
__LINE__
) ;

1670 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

1671 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
fûe
, 0, 
‹ig
, 
d©Æí
, 
__LINE__
) ;

1672 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_COMMENT
, 
l⁄g_commít
) ;

1673 
	`sf_˛o£
 (
fûe
) ;

1675 
	`mem£t
 (
d©a
, 0, 
d©Æí
 *  ()) ;

1677 i‡((
fûëy≥
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

1678 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

1680 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_FALSE
, 
__LINE__
) ;

1682 i‡((
sföfo
.
f‹m©
 & (
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_SUBMASK
)Ë!(
fûëy≥
 & (SF_FORMAT_TYPEMASK | SF_FORMAT_SUBMASK)))

1683 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

1684 
	`exô
 (1) ;

1687 i‡(
sföfo
.
‰ames
 < 
d©Æí
 / 
ch™√ls
)

1688 { 
	`¥ötf
 ("Toÿ„w.‰ame†ö fûe. (%ld should bê®lôéêm‹êth™ %ld)\n", 
d©Æí
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

1689 
	`exô
 (1) ;

1692 i‡(
sföfo
.
‰ames
 > (
d©Æí
 + 400))

1693 { 
	`¥ötf
 ("Toÿm™y.‰ame†ö fûe. (%ld should bê®lôéêm‹êth™ %ld)\n", 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
d©Æí
) ;

1694 
	`exô
 (1) ;

1697 i‡(
sföfo
.
ch™√ls
 != channels)

1698 { 
	`¥ötf
 ("IncorrectÇumber of channels in file.\n") ;

1699 
	`exô
 (1) ;

1702 
	`check_commít
 (
fûe
, 
fûëy≥
, 
__LINE__
) ;

1704 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

1706 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

1708 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a
, 
d©Æí
, 
__LINE__
) ;

1710 
	`mem˝y
 (
smoŸh
, 
‹ig
, 
d©Æí
 *  ()) ;

1711 
	`smoŸhed_diff_Êﬂt
 (
d©a
, 
d©Æí
) ;

1712 
	`smoŸhed_diff_Êﬂt
 (
smoŸh
, 
d©Æí
) ;

1714 
sum_abs
 = 
	`Ábs
 (
d©a
 [0]) ;

1715 
k
 = 1 ; k < 
d©Æí
 ; k++)

1716 { i‡(
	`îr‹_fun˘i⁄
 (
d©a
 [
k
], 
smoŸh
 [k], 
m¨gö
))

1717 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ sam∂ê(#%d : %d should bê%d).\n", 
__LINE__
, 
k
, (Ë
d©a
 [k], (Ë
smoŸh
 [k]) ;

1718 
	`o˘_ßve_Êﬂt
 (
‹ig
, 
smoŸh
, 
d©Æí
) ;

1719 
	`exô
 (1) ;

1721 
sum_abs
 +
	`Ábs
 (
d©a
 [
k
]) ;

1724 i‡(
sum_abs
 <= 0.0)

1725 { 
	`¥ötf
 ("\n\nLöê%d: Sig«»i†Æ»zîos.\n", 
__LINE__
) ;

1726 
	`¥ötf
 ("sum_ab†: % 10.6f\n", 
sum_abs
) ;

1727 
	`exô
 (1) ;

1730 i‡((
k
 = 
	`sf_ªad_Êﬂt
 (
fûe
, 
d©a
, 
d©Æí
)Ë!
sföfo
.
‰ames
 - datalen)

1731 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ÑódÜígth (%d should bê%ld).\n", 
__LINE__
, 
k
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
 - 
d©Æí
)) ;

1732 
	`exô
 (1) ;

1735 i‡((
sföfo
.
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë!
SF_FORMAT_MS_ADPCM
 &&

1736 (
sföfo
.
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë!
SF_FORMAT_GSM610
)

1737 
k
 = 0 ; k < 
sföfo
.
‰ames
 - 
d©Æí
 ; k++)

1738 i‡(
	`abs
 (
d©a
 [
k
]Ë> 
	`deˇy_ª•⁄£
 (k))

1739 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ sam∂ê(#%ld :áb†(%dËshould bê< %d).\n", 
__LINE__
, 
d©Æí
 + 
k
, (Ë
d©a
 [k], (Ë
	`deˇy_ª•⁄£
 (k)) ;

1740 
	`exô
 (1) ;

1744 i‡(
sföfo
.
£ekabÀ
)

1745 { i‡((
k
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_SET
)) != 0)

1746 { 
	`¥ötf
 ("\n\nLöê%d: SìkÅÿ°¨ào‡fûêÁûed (%d).\n", 
__LINE__
, 
k
) ;

1747 
	`exô
 (1) ;

1750 
m
 = 0 ; m < 3 ; m++)

1751 { 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a
, 
d©Æí
 / 7, 
__LINE__
) ;

1753 
	`smoŸhed_diff_Êﬂt
 (
d©a
, 
d©Æí
 / 7) ;

1754 
	`mem˝y
 (
smoŸh
, 
‹ig
 + 
m
 * 
d©Æí
 / 7, datalen / 7 *  ()) ;

1755 
	`smoŸhed_diff_Êﬂt
 (
smoŸh
, 
d©Æí
 / 7) ;

1757 
k
 = 0 ; k < 
d©Æí
 / 7 ; k++)

1758 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [
k
], (Ë
smoŸh
 [k], 
m¨gö
))

1759 { 
	`¥ötf
 ("Inc‹ª˘ sam∂êC (#%d (%ldË: %d => %d).\n", 
k
, k + 
m
 * (
d©Æí
 / 7), (Ë
smoŸh
 [k], (Ë
d©a
 [k]) ;

1760 
m
 = 0 ; m < 10 ; m++)

1761 
	`¥ötf
 ("%d ", (Ë
d©a
 [
k
]) ;

1762 
	`¥ötf
 ("\n") ;

1763 
	`exô
 (1) ;

1767 
£ekpos
 = 
BUFFER_SIZE
 / 10 ;

1770 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 
£ekpos
, 
SEEK_SET
)) != seekpos)

1771 { 
	`¥ötf
 ("SìkÅÿ°¨ào‡fûê+ %d faûed (%d).\n", 
£ekpos
, 
k
) ;

1772 
	`exô
 (1) ;

1774 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a
, 1, 
__LINE__
) ;

1776 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
))

1777 { 
	`¥ötf
 ("sf_£ek (SEEK_SETËfﬁlowed by sf_ªad_ÊﬂàÁûed (%d, %d).\n", (Ë
‹ig
 [1], (Ë
d©a
 [0]) ;

1778 
	`exô
 (1) ;

1781 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
)Ë!
£ekpos
 + 1)

1782 { 
	`¥ötf
 ("sf_£ek (SEEK_CURËwôh 0 off£àÁûed (%d should bê%d)\n", 
k
, 
£ekpos
 + 1) ;

1783 
	`exô
 (1) ;

1786 
£ekpos
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
Ë+ 
BUFFER_SIZE
 / 5 ;

1787 
k
 = 
	`sf_£ek
 (
fûe
, 
BUFFER_SIZE
 / 5, 
SEEK_CUR
) ;

1788 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a
, 
ch™√ls
, 
__LINE__
) ;

1789 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
Ë|| 
k
 != seekpos)

1790 { 
	`¥ötf
 ("sf_£ek (f‹w¨ds, SEEK_CURËfﬁlowed by sf_ªad_ÊﬂàÁûed (%d, %dË(%d, %d).\n", (Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
k
, seekpos + 1) ;

1791 
	`exô
 (1) ;

1794 
£ekpos
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
) - 20 ;

1796 
k
 = 
	`sf_£ek
 (
fûe
, -20, 
SEEK_CUR
) ;

1797 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a
, 
ch™√ls
, 
__LINE__
) ;

1798 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
Ë|| 
k
 != seekpos)

1799 { 
	`¥ötf
 ("sf_£ek (backw¨ds, SEEK_CURËfﬁlowed by sf_ªad_ÊﬂàÁûed (%d, %dË(%d, %d).\n", (Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
k
, seekpos) ;

1800 
	`exô
 (1) ;

1804 
	`sf_£ek
 (
fûe
, (Ë
sföfo
.
‰ames
, 
SEEK_SET
) ;

1806 i‡((
k
 = 
	`sf_ªad_Êﬂt
 (
fûe
, 
d©a
, 
d©Æí
)) != 0)

1807 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ vÆuê‰om sf_ªad_Êﬂà∑°Énd o‡fûêöc‹ª˘ (%d).\n", 
__LINE__
, 
k
) ;

1808 
	`exô
 (1) ;

1813 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 5 - (Ë
sföfo
.
‰ames
, 
SEEK_END
)) != 5)

1814 { 
	`¥ötf
 ("sf_£ek (SEEK_ENDËªtu∫ed %d in°ód o‡%d.\n", 
k
, 5) ;

1815 
	`exô
 (1) ;

1818 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a
, 
ch™√ls
, 
__LINE__
) ;

1819 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [5], 
m¨gö
))

1820 { 
	`¥ötf
 ("sf_£ek (SEEK_ENDËfﬁlowed by sf_ªad_ÊﬂàÁûed (%d should bê%d).\n", (Ë
d©a
 [0], (Ë
‹ig
 [5]) ;

1821 
	`exô
 (1) ;

1825 
	`sf_˛o£
 (
fûe
) ;

1827 
	`u∆ök
 (
fûíame
) ;

1828 
	`¥ötf
 ("ok\n") ;

1829 
	}
}

1832 
	$sdlcomp_ã°_doubÀ
 (c⁄° *
fûíame
, 
fûëy≥
, 
ch™√ls
, 
m¨gö
)

1833 { 
SNDFILE
 *
fûe
 ;

1834 
SF_INFO
 
sföfo
 ;

1835 
k
, 
m
, 
£ekpos
 ;

1836 
d©Æí
 ;

1837 *
‹ig
, *
d©a
, *
smoŸh
, 
sum_abs
 ;

1839 
ch™√ls
 = 1 ;

1840 
	`¥öt_ã°_«me
 ("sdlcomp_ã°_doubÀ", 
fûíame
) ;

1842 
d©Æí
 = 
BUFFER_SIZE
 ;

1844 
‹ig
 = 
‹ig_buf„r
.
d
 ;

1845 
d©a
 = 
d©a_buf„r
.
d
 ;

1846 
smoŸh
 = 
smoŸh_buf„r
.
d
 ;

1848 
	`gí_sig«l_doubÀ
 (
‹ig_buf„r
.
d
, 32000.0, 
ch™√ls
, 
d©Æí
) ;

1850 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

1851 
sföfo
.
‰ames
 = 123456789 ;

1852 
sföfo
.
ch™√ls
 = channels ;

1853 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

1855 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_FALSE
, 
__LINE__
) ;

1856 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

1857 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
‹ig
, 
d©Æí
, 
__LINE__
) ;

1858 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_COMMENT
, 
l⁄g_commít
) ;

1859 
	`sf_˛o£
 (
fûe
) ;

1861 
	`mem£t
 (
d©a
, 0, 
d©Æí
 *  ()) ;

1863 i‡((
fûëy≥
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

1864 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

1866 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_FALSE
, 
__LINE__
) ;

1868 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

1869 { 
	`¥ötf
 ("Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
fûëy≥
, 
sföfo
.
f‹m©
) ;

1870 
	`exô
 (1) ;

1873 i‡(
sföfo
.
‰ames
 < 
d©Æí
 / 
ch™√ls
)

1874 { 
	`¥ötf
 ("Toÿ„w.‰ame†ö fûe. (%ld should bê®lôéêm‹êth™ %ld)\n", 
d©Æí
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

1875 
	`exô
 (1) ;

1878 i‡(
sföfo
.
‰ames
 > (
d©Æí
 + 400))

1879 { 
	`¥ötf
 ("Toÿm™y.‰ame†ö fûe. (%ld should bê®lôéêm‹êth™ %ld)\n", 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
d©Æí
) ;

1880 
	`exô
 (1) ;

1883 i‡(
sföfo
.
ch™√ls
 != channels)

1884 { 
	`¥ötf
 ("IncorrectÇumber of channels in file.\n") ;

1885 
	`exô
 (1) ;

1888 
	`check_commít
 (
fûe
, 
fûëy≥
, 
__LINE__
) ;

1890 
	`check_commít
 (
fûe
, 
fûëy≥
, 
__LINE__
) ;

1892 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

1894 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

1896 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
, 
d©Æí
, 
__LINE__
) ;

1898 
	`mem˝y
 (
smoŸh
, 
‹ig
, 
d©Æí
 *  ()) ;

1899 
	`smoŸhed_diff_doubÀ
 (
d©a
, 
d©Æí
) ;

1900 
	`smoŸhed_diff_doubÀ
 (
smoŸh
, 
d©Æí
) ;

1902 
sum_abs
 = 
	`Ábs
 (
d©a
 [0]) ;

1903 
k
 = 1 ; k < 
d©Æí
 ; k++)

1904 { i‡(
	`îr‹_fun˘i⁄
 (
d©a
 [
k
], 
smoŸh
 [k], 
m¨gö
))

1905 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ sam∂ê(#%d : %d should bê%d).\n", 
__LINE__
, 
k
, (Ë
d©a
 [k], (Ë
smoŸh
 [k]) ;

1906 
	`o˘_ßve_doubÀ
 (
‹ig
, 
smoŸh
, 
d©Æí
) ;

1907 
	`exô
 (1) ;

1909 
sum_abs
 +
	`Ábs
 (
d©a
 [
k
]) ;

1912 i‡(
sum_abs
 < 1.0)

1913 { 
	`¥ötf
 ("\n\nLöê%d: Sig«»i†Æ»zîos.\n", 
__LINE__
) ;

1914 
	`exô
 (1) ;

1917 i‡((
k
 = 
	`sf_ªad_doubÀ
 (
fûe
, 
d©a
, 
d©Æí
)Ë!
sföfo
.
‰ames
 - datalen)

1918 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ÑódÜígth (%d should bê%ld).\n", 
__LINE__
, 
k
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
 - 
d©Æí
)) ;

1919 
	`exô
 (1) ;

1922 i‡((
sföfo
.
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë!
SF_FORMAT_MS_ADPCM
 &&

1923 (
sföfo
.
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë!
SF_FORMAT_GSM610
)

1924 
k
 = 0 ; k < 
sföfo
.
‰ames
 - 
d©Æí
 ; k++)

1925 i‡(
	`abs
 (
d©a
 [
k
]Ë> 
	`deˇy_ª•⁄£
 (k))

1926 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ sam∂ê(#%ld :áb†(%dËshould bê< %d).\n", 
__LINE__
, 
d©Æí
 + 
k
, (Ë
d©a
 [k], (Ë
	`deˇy_ª•⁄£
 (k)) ;

1927 
	`exô
 (1) ;

1931 i‡(
sföfo
.
£ekabÀ
)

1932 { i‡((
k
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_SET
)) != 0)

1933 { 
	`¥ötf
 ("\n\nLöê%d: SìkÅÿ°¨ào‡fûêÁûed (%d).\n", 
__LINE__
, 
k
) ;

1934 
	`exô
 (1) ;

1937 
m
 = 0 ; m < 3 ; m++)

1938 { 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 
m
, 
d©a
, 
d©Æí
 / 7, 
__LINE__
) ;

1940 
	`smoŸhed_diff_doubÀ
 (
d©a
, 
d©Æí
 / 7) ;

1941 
	`mem˝y
 (
smoŸh
, 
‹ig
 + 
m
 * 
d©Æí
 / 7, datalen / 7 *  ()) ;

1942 
	`smoŸhed_diff_doubÀ
 (
smoŸh
, 
d©Æí
 / 7) ;

1944 
k
 = 0 ; k < 
d©Æí
 / 7 ; k++)

1945 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [
k
], (Ë
smoŸh
 [k], 
m¨gö
))

1946 { 
	`¥ötf
 ("Inc‹ª˘ sam∂êC (#%d (%ldË: %d => %d).\n", 
k
, k + 
m
 * (
d©Æí
 / 7), (Ë
smoŸh
 [k], (Ë
d©a
 [k]) ;

1947 
m
 = 0 ; m < 10 ; m++)

1948 
	`¥ötf
 ("%d ", (Ë
d©a
 [
k
]) ;

1949 
	`¥ötf
 ("\n") ;

1950 
	`exô
 (1) ;

1954 
£ekpos
 = 
BUFFER_SIZE
 / 10 ;

1957 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 
£ekpos
, 
SEEK_SET
)) != seekpos)

1958 { 
	`¥ötf
 ("SìkÅÿ°¨ào‡fûê+ %d faûed (%d).\n", 
£ekpos
, 
k
) ;

1959 
	`exô
 (1) ;

1961 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
, 1, 
__LINE__
) ;

1963 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
))

1964 { 
	`¥ötf
 ("sf_£ek (SEEK_SETËfﬁlowed by sf_ªad_doubÀ faûed (%d, %d).\n", (Ë
‹ig
 [1], (Ë
d©a
 [0]) ;

1965 
	`exô
 (1) ;

1968 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
)Ë!
£ekpos
 + 1)

1969 { 
	`¥ötf
 ("sf_£ek (SEEK_CURËwôh 0 off£àÁûed (%d should bê%d)\n", 
k
, 
£ekpos
 + 1) ;

1970 
	`exô
 (1) ;

1973 
£ekpos
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
Ë+ 
BUFFER_SIZE
 / 5 ;

1974 
k
 = 
	`sf_£ek
 (
fûe
, 
BUFFER_SIZE
 / 5, 
SEEK_CUR
) ;

1975 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
, 1, 
__LINE__
) ;

1976 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
Ë|| 
k
 != seekpos)

1977 { 
	`¥ötf
 ("sf_£ek (f‹w¨ds, SEEK_CURËfﬁlowed by sf_ªad_doubÀ faûed (%d, %dË(%d, %d).\n", (Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
k
, seekpos + 1) ;

1978 
	`exô
 (1) ;

1981 
£ekpos
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
) - 20 ;

1983 
k
 = 
	`sf_£ek
 (
fûe
, -20, 
SEEK_CUR
) ;

1984 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
, 1, 
__LINE__
) ;

1985 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
m¨gö
Ë|| 
k
 != seekpos)

1986 { 
	`¥ötf
 ("sf_£ek (backw¨ds, SEEK_CURËfﬁlowed by sf_ªad_doubÀ faûed (%d, %dË(%d, %d).\n", (Ë
d©a
 [0], (Ë
‹ig
 [
£ekpos
 * 
ch™√ls
], 
k
, seekpos) ;

1987 
	`exô
 (1) ;

1991 
	`sf_£ek
 (
fûe
, (Ë
sföfo
.
‰ames
, 
SEEK_SET
) ;

1993 i‡((
k
 = 
	`sf_ªad_doubÀ
 (
fûe
, 
d©a
, 
d©Æí
)) != 0)

1994 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ vÆuê‰om sf_ªad_doubÀÖa°Énd o‡fûêöc‹ª˘ (%d).\n", 
__LINE__
, 
k
) ;

1995 
	`exô
 (1) ;

2000 i‡((
k
 = 
	`sf_£ek
 (
fûe
, 5 - (Ë
sföfo
.
‰ames
, 
SEEK_END
)) != 5)

2001 { 
	`¥ötf
 ("sf_£ek (SEEK_ENDËªtu∫ed %d in°ód o‡%d.\n", 
k
, 5) ;

2002 
	`exô
 (1) ;

2005 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
, 1, 
__LINE__
) ;

2006 i‡(
	`îr‹_fun˘i⁄
 ((Ë
d©a
 [0], (Ë
‹ig
 [5], 
m¨gö
))

2007 { 
	`¥ötf
 ("sf_£ek (SEEK_ENDËfﬁlowed by sf_ªad_doubÀ faûed (%d should bê%d).\n", (Ë
d©a
 [0], (Ë
‹ig
 [5]) ;

2008 
	`exô
 (1) ;

2012 
	`sf_˛o£
 (
fûe
) ;

2014 
	`u∆ök
 (
fûíame
) ;

2015 
	`¥ötf
 ("ok\n") ;

2016 
	}
}

2022 
	#SIGNAL_MAXVAL
 30000.0

	)

2023 
	#DECAY_COUNT
 1000

	)

2026 
	$deˇy_ª•⁄£
 (
k
)

2027 { i‡(
k
 < 1)

2028  (Ë(1.2 * 
SIGNAL_MAXVAL
) ;

2029 i‡(
k
 > 
DECAY_COUNT
)

2031  (Ë(1.2 * 
SIGNAL_MAXVAL
 * (
DECAY_COUNT
 - 
k
) / (1.0 * DECAY_COUNT)) ;

2032 
	}
}

2035 
	$gí_sig«l_doubÀ
 (*
d©a
, 
sˇÀ
, 
ch™√ls
, 
d©Æí
)

2036 { 
k
, 
øm∂í
 ;

2037 
amp
 = 0.0 ;

2039 
øm∂í
 = 
DECAY_COUNT
 ;

2041 i‡(
ch™√ls
 == 1)

2042 { 
k
 = 0 ; k < 
d©Æí
 ; k++)

2043 { i‡(
k
 <
øm∂í
)

2044 
amp
 = 
sˇÀ
 * 
k
 / ((Ë
øm∂í
) ;

2045 i‡(
k
 > 
d©Æí
 - 
øm∂í
)

2046 
amp
 = 
sˇÀ
 * (
d©Æí
 - 
k
Ë/ ((Ë
øm∂í
) ;

2050 
d©a
 [
k
] = 
amp
 * (0.4 * 
	`sö
 (33.3 * 2.0 * 
M_PI
 * ((Ë(k+1)Ë/ ((Ë
SAMPLE_RATE
))

2051 + 0.3 * 
	`cos
 (201.1 * 2.0 * 
M_PI
 * ((Ë(
k
+1)Ë/ ((Ë
SAMPLE_RATE
))) ;

2055 { 
k
 = 0 ; k < 
d©Æí
 ; k ++)

2056 { i‡(
k
 <
øm∂í
)

2057 
amp
 = 
sˇÀ
 * 
k
 / ((Ë
øm∂í
) ;

2058 i‡(
k
 > 
d©Æí
 - 
øm∂í
)

2059 
amp
 = 
sˇÀ
 * (
d©Æí
 - 
k
Ë/ ((Ë
øm∂í
) ;

2061 
d©a
 [2 * 
k
] = 
amp
 * (0.4 * 
	`sö
 (33.3 * 2.0 * 
M_PI
 * ((Ë(k+1)Ë/ ((Ë
SAMPLE_RATE
))

2062 + 0.3 * 
	`cos
 (201.1 * 2.0 * 
M_PI
 * ((Ë(
k
+1)Ë/ ((Ë
SAMPLE_RATE
))) ;

2063 
d©a
 [2 * 
k
 + 1] = 
amp
 * (0.4 * 
	`sö
 (55.5 * 2.0 * 
M_PI
 * ((Ë(k+1)Ë/ ((Ë
SAMPLE_RATE
))

2064 + 0.3 * 
	`cos
 (201.1 * 2.0 * 
M_PI
 * ((Ë(
k
+1)Ë/ ((Ë
SAMPLE_RATE
))) ;

2069 
	}
}

2072 
	$îr‹_fun˘i⁄
 (
d©a
, 
‹ig
, 
m¨gö
)

2073 { 
îr‹
 ;

2075 i‡(
	`Ábs
 (
‹ig
) <= 500.0)

2076 
îr‹
 = 
	`Ábs
 (Áb†(
d©a
Ë- fab†(
‹ig
)) / 2000.0 ;

2077 i‡(
	`Ábs
 (
‹ig
) <= 1000.0)

2078 
îr‹
 = 
	`Ábs
 (
d©a
 - 
‹ig
) / 3000.0 ;

2080 
îr‹
 = 
	`Ábs
 (
d©a
 - 
‹ig
) / fabs (orig) ;

2082 i‡(
îr‹
 > 
m¨gö
)

2083 { 
	`¥ötf
 ("\n\n*******************\nEº‹ : %f\n", 
îr‹
) ;

2087 
	}
}

2090 
	$smoŸhed_diff_sh‹t
 (*
d©a
, 
d©Æí
)

2091 { 
k
 ;

2092 
mem‹y
 = 0.0 ;

2095 
k
 = 0 ; k < 
d©Æí
 - 1 ; k++)

2096 { 
mem‹y
 = 0.7 * mem‹y + (1 - 0.7Ë* (Ë(
d©a
 [
k
+1] - data [k]) ;

2097 
d©a
 [
k
] = (Ë
mem‹y
 ;

2099 
d©a
 [
d©Æí
-1] = data [datalen-2] ;

2101 
	}
}

2104 
	$smoŸhed_diff_öt
 (*
d©a
, 
d©Æí
)

2105 { 
k
 ;

2106 
mem‹y
 = 0.0 ;

2109 
k
 = 0 ; k < 
d©Æí
 - 1 ; k++)

2110 { 
mem‹y
 = 0.7 * mem‹y + (1 - 0.7Ë* (Ë(
d©a
 [
k
+1] - data [k]) ;

2111 
d©a
 [
k
] = (Ë
mem‹y
 ;

2113 
d©a
 [
d©Æí
-1] = data [datalen-2] ;

2115 
	}
}

2118 
	$smoŸhed_diff_Êﬂt
 (*
d©a
, 
d©Æí
)

2119 { 
k
 ;

2120 
mem‹y
 = 0.0 ;

2123 
k
 = 0 ; k < 
d©Æí
 - 1 ; k++)

2124 { 
mem‹y
 = 0.7 * mem‹y + (1 - 0.7Ë* (
d©a
 [
k
+1] - data [k]) ;

2125 
d©a
 [
k
] = 
mem‹y
 ;

2127 
d©a
 [
d©Æí
-1] = data [datalen-2] ;

2129 
	}
}

2132 
	$smoŸhed_diff_doubÀ
 (*
d©a
, 
d©Æí
)

2133 { 
k
 ;

2134 
mem‹y
 = 0.0 ;

2137 
k
 = 0 ; k < 
d©Æí
 - 1 ; k++)

2138 { 
mem‹y
 = 0.7 * mem‹y + (1 - 0.7Ë* (
d©a
 [
k
+1] - data [k]) ;

2139 
d©a
 [
k
] = 
mem‹y
 ;

2141 
d©a
 [
d©Æí
-1] = data [datalen-2] ;

2143 
	}
}

2146 
	$check_commít
 (
SNDFILE
 * 
fûe
, 
f‹m©
, 
löío
)

2147 { c⁄° *
commít
 ;

2149 
f‹m©
 & 
SF_FORMAT_TYPEMASK
)

2150 { 
SF_FORMAT_AIFF
 :

2151 
SF_FORMAT_WAV
 :

2152 
SF_FORMAT_WAVEX
 :

2158 
commít
 = 
	`sf_gë_°rög
 (
fûe
, 
SF_STR_COMMENT
) ;

2159 i‡(
commít
 =
NULL
)

2160 { 
	`¥ötf
 ("\n\nLöê%d : Fûêd€†nŸ c⁄èöá commíà°rög.\n\n", 
löío
) ;

2161 
	`exô
 (1) ;

2164 i‡(
	`°rcmp
 (
commít
, 
l⁄g_commít
) != 0)

2165 { 
	`¥ötf
 ("\n\nLöê%d : Fûêcommíàd€†nŸ m©ch commíàwrôãn.\n\n", 
löío
) ;

2166 
	`exô
 (1) ;

2170 
	}
}

	@libsndfile-1.0.17/tests/misc_test.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

25 
	~<sys/°©.h
>

26 
	~<m©h.h
>

28 #i‡
HAVE_UNISTD_H


29 
	~<uni°d.h
>

32 #i‡(
HAVE_DECL_S_IRGRP
 == 0)

33 
	~<sf_uni°d.h
>

36 #i‡(
deföed
 (
WIN32
Ë|| deföed (
_WIN32
))

37 
	~<io.h
>

38 
	~<dúe˘.h
>

41 
	~<¢dfûe.h
>

43 
	~"utûs.h
"

45 
	#BUFFER_LEN
 (1<<10)

	)

46 
	#LOG_BUFFER_SIZE
 1024

	)

48 
zîo_d©a_ã°
 (c⁄° *
fûíame
, 
ty≥maj‹
) ;

49 
fûesy°em_fuŒ_ã°
 (
ty≥maj‹
) ;

50 
≥rmissi⁄_ã°
 (c⁄° *
fûíame
, 
ty≥maj‹
) ;

53 
	$maö
 (
¨gc
, *
¨gv
 [])

54 { 
do_Æl
 = 0 ;

55 
ã°_cou¡
 = 0 ;

57 i‡(
¨gc
 != 2)

58 { 
	`¥ötf
 ("Ußgê: %†<ã°>\n", 
¨gv
 [0]) ;

59 
	`¥ötf
 (" Where <test> is one ofÅhe following:\n") ;

60 
	`¥ötf
 (" wav -Åest WAV fileÖeak chunk\n") ;

61 
	`¥ötf
 ("áiff -Åest AIFF file PEAK chunk\n") ;

62 
	`¥ötf
 ("áll -ÖerformállÅests\n") ;

63 
	`exô
 (1) ;

66 
do_Æl
=!
	`°rcmp
 (
¨gv
 [1], "all") ;

68 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "wav"))

69 { 
	`zîo_d©a_ã°
 ("zîﬁí.wav", 
SF_FORMAT_WAV
) ;

70 
	`fûesy°em_fuŒ_ã°
 (
SF_FORMAT_WAV
) ;

71 
	`≥rmissi⁄_ã°
 ("ªad⁄ly.wav", 
SF_FORMAT_WAV
) ;

72 
ã°_cou¡
++ ;

75 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "aiff"))

76 { 
	`zîo_d©a_ã°
 ("zîﬁí.aiff", 
SF_FORMAT_AIFF
) ;

77 
	`fûesy°em_fuŒ_ã°
 (
SF_FORMAT_AIFF
) ;

78 
	`≥rmissi⁄_ã°
 ("ªad⁄ly.aiff", 
SF_FORMAT_AIFF
) ;

79 
ã°_cou¡
++ ;

82 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "au"))

83 { 
	`zîo_d©a_ã°
 ("zîﬁí.au", 
SF_FORMAT_AU
) ;

84 
	`fûesy°em_fuŒ_ã°
 (
SF_FORMAT_AU
) ;

85 
	`≥rmissi⁄_ã°
 ("ªad⁄ly.au", 
SF_FORMAT_AU
) ;

86 
ã°_cou¡
++ ;

89 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "caf"))

90 { 
	`zîo_d©a_ã°
 ("zîﬁí.ˇf", 
SF_FORMAT_CAF
) ;

91 
	`fûesy°em_fuŒ_ã°
 (
SF_FORMAT_CAF
) ;

92 
	`≥rmissi⁄_ã°
 ("ªad⁄ly.ˇf", 
SF_FORMAT_CAF
) ;

93 
ã°_cou¡
++ ;

96 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "svx"))

97 { 
	`zîo_d©a_ã°
 ("zîﬁí.svx", 
SF_FORMAT_SVX
) ;

98 
	`fûesy°em_fuŒ_ã°
 (
SF_FORMAT_SVX
) ;

99 
	`≥rmissi⁄_ã°
 ("ªad⁄ly.svx", 
SF_FORMAT_SVX
) ;

100 
ã°_cou¡
++ ;

103 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "nist"))

104 { 
	`zîo_d©a_ã°
 ("zîﬁí.ni°", 
SF_FORMAT_NIST
) ;

105 
	`fûesy°em_fuŒ_ã°
 (
SF_FORMAT_NIST
) ;

106 
	`≥rmissi⁄_ã°
 ("ªad⁄ly.ni°", 
SF_FORMAT_NIST
) ;

107 
ã°_cou¡
++ ;

110 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "paf"))

111 { 
	`zîo_d©a_ã°
 ("zîﬁí.∑f", 
SF_FORMAT_PAF
) ;

112 
	`fûesy°em_fuŒ_ã°
 (
SF_FORMAT_PAF
) ;

113 
	`≥rmissi⁄_ã°
 ("ªad⁄ly.∑f", 
SF_FORMAT_PAF
) ;

114 
ã°_cou¡
++ ;

117 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "ircam"))

118 { 
	`zîo_d©a_ã°
 ("zîﬁí.úˇm", 
SF_FORMAT_IRCAM
) ;

119 
	`fûesy°em_fuŒ_ã°
 (
SF_FORMAT_IRCAM
) ;

120 
	`≥rmissi⁄_ã°
 ("ªad⁄ly.úˇm", 
SF_FORMAT_IRCAM
) ;

121 
ã°_cou¡
++ ;

124 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "voc"))

125 { 
	`zîo_d©a_ã°
 ("zîﬁí.voc", 
SF_FORMAT_VOC
) ;

126 
	`fûesy°em_fuŒ_ã°
 (
SF_FORMAT_VOC
) ;

127 
	`≥rmissi⁄_ã°
 ("ªad⁄ly.voc", 
SF_FORMAT_VOC
) ;

128 
ã°_cou¡
++ ;

131 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "w64"))

132 { 
	`zîo_d©a_ã°
 ("zîﬁí.w64", 
SF_FORMAT_W64
) ;

133 
	`fûesy°em_fuŒ_ã°
 (
SF_FORMAT_W64
) ;

134 
	`≥rmissi⁄_ã°
 ("ªad⁄ly.w64", 
SF_FORMAT_W64
) ;

135 
ã°_cou¡
++ ;

138 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "mat4"))

139 { 
	`zîo_d©a_ã°
 ("zîﬁí.m©4", 
SF_FORMAT_MAT4
) ;

140 
	`fûesy°em_fuŒ_ã°
 (
SF_FORMAT_MAT4
) ;

141 
	`≥rmissi⁄_ã°
 ("ªad⁄ly.m©4", 
SF_FORMAT_MAT4
) ;

142 
ã°_cou¡
++ ;

145 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "mat5"))

146 { 
	`zîo_d©a_ã°
 ("zîﬁí.m©5", 
SF_FORMAT_MAT5
) ;

147 
	`fûesy°em_fuŒ_ã°
 (
SF_FORMAT_MAT5
) ;

148 
	`≥rmissi⁄_ã°
 ("ªad⁄ly.m©5", 
SF_FORMAT_MAT5
) ;

149 
ã°_cou¡
++ ;

152 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "pvf"))

153 { 
	`zîo_d©a_ã°
 ("zîﬁí.pvf", 
SF_FORMAT_PVF
) ;

154 
	`fûesy°em_fuŒ_ã°
 (
SF_FORMAT_PVF
) ;

155 
	`≥rmissi⁄_ã°
 ("ªad⁄ly.pvf", 
SF_FORMAT_PVF
) ;

156 
ã°_cou¡
++ ;

159 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "htk"))

160 { 
	`zîo_d©a_ã°
 ("zîﬁí.htk", 
SF_FORMAT_HTK
) ;

161 
	`fûesy°em_fuŒ_ã°
 (
SF_FORMAT_HTK
) ;

162 
	`≥rmissi⁄_ã°
 ("ªad⁄ly.htk", 
SF_FORMAT_HTK
) ;

163 
ã°_cou¡
++ ;

166 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "avr"))

167 { 
	`zîo_d©a_ã°
 ("zîﬁí.avr", 
SF_FORMAT_AVR
) ;

168 
	`fûesy°em_fuŒ_ã°
 (
SF_FORMAT_AVR
) ;

169 
	`≥rmissi⁄_ã°
 ("ªad⁄ly.avr", 
SF_FORMAT_AVR
) ;

170 
ã°_cou¡
++ ;

173 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "sds"))

174 { 
	`zîo_d©a_ã°
 ("zîﬁí.sds", 
SF_FORMAT_SDS
) ;

175 
	`fûesy°em_fuŒ_ã°
 (
SF_FORMAT_SDS
) ;

176 
	`≥rmissi⁄_ã°
 ("ªad⁄ly.sds", 
SF_FORMAT_SDS
) ;

177 
ã°_cou¡
++ ;

180 i‡(
ã°_cou¡
 == 0)

181 { 
	`¥ötf
 ("Mono : ************************************\n") ;

182 
	`¥ötf
 ("M⁄ÿ: * Nÿ'%s'Åe° deföed.\n", 
¨gv
 [1]) ;

183 
	`¥ötf
 ("Mono : ************************************\n") ;

188 
	}
}

196 
	$zîo_d©a_ã°
 (c⁄° *
fûíame
, 
ty≥maj‹
)

197 { 
SNDFILE
 *
fûe
 ;

198 
SF_INFO
 
sföfo
 ;

199 
‰ames
 ;

201 
	`¥öt_ã°_«me
 ("zîo_d©a_ã°", 
fûíame
) ;

203 
sföfo
.
ßm∂î©e
 = 44100 ;

204 
sföfo
.
f‹m©
 = (
ty≥maj‹
 | 
SF_FORMAT_PCM_16
) ;

205 
sföfo
.
ch™√ls
 = 1 ;

206 
sföfo
.
‰ames
 = 0 ;

208 
‰ames
 = 
BUFFER_LEN
 / 
sföfo
.
ch™√ls
 ;

210 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

212 
	`sf_˛o£
 (
fûe
) ;

214 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

216 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

218 
	`sf_˛o£
 (
fûe
) ;

220 
	`u∆ök
 (
fûíame
) ;

221 
	`puts
 ("ok") ;

222 
	}
}

225 
	$fûesy°em_fuŒ_ã°
 (
ty≥maj‹
)

226 { 
SNDFILE
 *
fûe
 ;

227 
SF_INFO
 
sföfo
 ;

228 
°©
 
buf
 ;

230 c⁄° *
fûíame
 = "/dev/fuŒ", *
îr‹°r
 ;

231 
‰ames
 ;

233 #i‡(
	`deföed
 (
WIN32
Ë|| deföed (
_WIN32
))

238 
	`¥öt_ã°_«me
 ("fûesy°em_fuŒ_ã°", 
fûíame
) ;

240 i‡(
	`°©
 (
fûíame
, &
buf
) != 0)

241 { 
	`puts
 ("/dev/full missing") ;

245 i‡(
	`S_ISCHR
 (
buf
.
°_mode
Ë=0 && 
	`S_ISBLK
 (buf.st_mode) == 0)

246 { 
	`puts
 ("/dev/full isÇotá device file") ;

250 
sföfo
.
ßm∂î©e
 = 44100 ;

251 
sföfo
.
f‹m©
 = (
ty≥maj‹
 | 
SF_FORMAT_PCM_16
) ;

252 
sföfo
.
ch™√ls
 = 1 ;

253 
sföfo
.
‰ames
 = 0 ;

255 
‰ames
 = 
BUFFER_LEN
 / 
sföfo
.
ch™√ls
 ;

257 i‡((
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_WRITE
, &
sföfo
)Ë!
NULL
)

258 { 
	`¥ötf
 ("\n\nLöê%d : Eº‹, fûêshouldÇŸ havê›í√d.\n", 
__LINE__
 - 1) ;

259 
	`exô
 (1) ;

262 
îr‹°r
 = 
	`sf_°ªº‹
 (
fûe
) ;

264 i‡(
	`°r°r
 (
îr‹°r
, " s∑˚ "Ë=
NULL
 || strstr (errorstr, "device") == NULL)

265 { 
	`¥ötf
 ("\n\nLöê%d : Eº‹ badÉº‹ såög : %s.\n", 
__LINE__
 - 1, 
îr‹°r
) ;

266 
	`exô
 (1) ;

269 
	`puts
 ("ok") ;

270 
	}
}

273 
	$≥rmissi⁄_ã°
 (c⁄° *
fûíame
, 
ty≥maj‹
)

275 #i‡(
OS_IS_WIN32
)

277 
fûíame
 = filename ;

278 
ty≥maj‹
 =Åypemajor ;

284 
FILE
 *
ãxtfûe
 ;

285 
SNDFILE
 *
fûe
 ;

286 
SF_INFO
 
sföfo
 ;

287 c⁄° *
îr‹°r
 ;

288 
‰ames
 ;

290 i‡(
	`gëuid
 () == 0)

297 
	`¥öt_ã°_«me
 ("≥rmissi⁄_ã°", 
fûíame
) ;

299 i‡((
ãxtfûe
 = 
	`f›í
 (
fûíame
, "w")Ë=
NULL
)

300 { 
	`¥ötf
 ("\n\nLöê%d :ÇŸábÀÅÿ›íÅexàfûêf‹ wrôe.\n", 
__LINE__
) ;

301 
	`exô
 (1) ;

304 
	`Ârötf
 (
ãxtfûe
, "This isáÑead only file.\n") ;

305 
	`f˛o£
 (
ãxtfûe
) ;

307 i‡(
	`chmod
 (
fûíame
, 
S_IRUSR
 | 
S_IRGRP
))

308 { 
	`¥ötf
 ("\n\nLöê%d : chmod faûed", 
__LINE__
) ;

309 
	`fÊush
 (
°dout
) ;

310 
	`≥º‹
 ("") ;

311 
	`exô
 (1) ;

314 
sföfo
.
ßm∂î©e
 = 44100 ;

315 
sföfo
.
f‹m©
 = (
ty≥maj‹
 | 
SF_FORMAT_PCM_16
) ;

316 
sföfo
.
ch™√ls
 = 1 ;

317 
sföfo
.
‰ames
 = 0 ;

319 
‰ames
 = 
BUFFER_LEN
 / 
sföfo
.
ch™√ls
 ;

321 i‡((
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_WRITE
, &
sföfo
)Ë!
NULL
)

322 { 
	`¥ötf
 ("\n\nLöê%d : Eº‹, fûêshouldÇŸ havê›íed.\n", 
__LINE__
 - 1) ;

323 
	`exô
 (1) ;

326 
îr‹°r
 = 
	`sf_°ªº‹
 (
fûe
) ;

328 i‡(
	`°r°r
 (
îr‹°r
, "îmissi⁄ díõd"Ë=
NULL
)

329 { 
	`¥ötf
 ("\n\nLöê%d : Eº‹ badÉº‹ såög : %s.\n", 
__LINE__
 - 1, 
îr‹°r
) ;

330 
	`exô
 (1) ;

333 i‡(
	`chmod
 (
fûíame
, 
S_IWUSR
 | 
S_IWGRP
))

334 { 
	`¥ötf
 ("\n\nLöê%d : chmod faûed", 
__LINE__
) ;

335 
	`fÊush
 (
°dout
) ;

336 
	`≥º‹
 ("") ;

337 
	`exô
 (1) ;

340 
	`u∆ök
 (
fûíame
) ;

342 
	`puts
 ("ok") ;

345 
	}
}

	@libsndfile-1.0.17/tests/multi_file_test.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

24 #i‡
HAVE_UNISTD_H


25 
	~<uni°d.h
>

28 #i‡(
HAVE_DECL_S_IRGRP
 == 0)

29 
	~<sf_uni°d.h
>

32 
	~<f˙é.h
>

33 
	~<m©h.h
>

34 
	~<°rög.h
>

35 
	~<î∫o.h
>

36 
	~<sys/°©.h
>

38 
	~<¢dfûe.h
>

40 
	~"utûs.h
"

42 
	#DATA_LENGTH
 (512)

	)

44 
off_t
 
gë_fûe_Àngth
 (
fd
) ;

45 
wrôe_fûe_©_íd
 (
fd
, 
fûëy≥
, 
ch™√ls
, 
fûe_num
) ;

47 
mu…i_fûe_ã°
 (c⁄° *
fûíame
, *
f‹m©s
, 
f‹m©_cou¡
) ;

49 
	gd©a
 [
DATA_LENGTH
] ;

51 
	gwav_f‹m©s
 [] =

52 { 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_16
,

53 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_24
,

54 
SF_FORMAT_WAV
 | 
SF_FORMAT_ULAW
,

55 
SF_FORMAT_WAV
 | 
SF_FORMAT_ALAW
,

57 
SF_FORMAT_WAV
 | 
SF_FORMAT_IMA_ADPCM
,

58 
SF_FORMAT_WAV
 | 
SF_FORMAT_MS_ADPCM
,

63 
	gaiff_f‹m©s
 [] =

64 { 
SF_FORMAT_AIFF
 | 
SF_FORMAT_PCM_16
,

65 
SF_FORMAT_AIFF
 | 
SF_FORMAT_PCM_24
,

66 
SF_FORMAT_AIFF
 | 
SF_FORMAT_ULAW
,

67 
SF_FORMAT_AIFF
 | 
SF_FORMAT_ALAW


70 
	gau_f‹m©s
 [] =

71 { 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_16
,

72 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_24
,

73 
SF_FORMAT_AU
 | 
SF_FORMAT_ULAW
,

74 
SF_FORMAT_AU
 | 
SF_FORMAT_ALAW


77 
	gvîbo£
 = 
SF_FALSE
 ;

80 
	$maö
 (
¨gc
, **
¨gv
)

81 { 
do_Æl
 = 0 ;

82 
ã°_cou¡
 = 0 ;

84 i‡(
¨gc
 =3 && 
	`°rcmp
 (
¨gv
 [2], "-v") == 0)

85 { 
vîbo£
 = 
SF_TRUE
 ;

86 
¨gc
 -- ;

89 i‡(
¨gc
 != 2)

90 { 
	`¥ötf
 ("Ußgê: %†<ã°>\n", 
¨gv
 [0]) ;

91 
	`¥ötf
 (" Where <test> is one ofÅhe following:\n") ;

92 
	`¥ötf
 (" wav -Åest WAV file functions (littleÉndian)\n") ;

93 
	`¥ötf
 ("áiff -Åest AIFF file functions (bigÉndian)\n") ;

94 
	`¥ötf
 ("áu -Åest AU file functions\n") ;

96 
	`¥ötf
 (" svx -Åest 8SVX/16SV file functions\n") ;

97 
	`¥ötf
 ("Çist -Åest NIST Sphere file functions\n") ;

98 
	`¥ötf
 (" ircam -Åest IRCAM file functions\n") ;

99 
	`¥ötf
 (" voc - Create Voice file functions\n") ;

100 
	`¥ötf
 (" w64 - Sonic Foundry's W64 file functions\n") ;

102 
	`¥ötf
 ("áll -ÖerformállÅests\n") ;

103 
	`exô
 (1) ;

106 
do_Æl
 = !
	`°rcmp
 (
¨gv
 [1], "all") ;

108 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "wav"))

109 { 
	`mu…i_fûe_ã°
 ("mu…i_wav.d©", 
wav_f‹m©s
, 
	`ARRAY_LEN
 (wav_formats)) ;

110 
ã°_cou¡
++ ;

113 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "aiff"))

114 { 
	`mu…i_fûe_ã°
 ("mu…i_aiff.d©", 
aiff_f‹m©s
, 
	`ARRAY_LEN
 (aiff_formats)) ;

115 
ã°_cou¡
++ ;

118 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "au"))

119 { 
	`mu…i_fûe_ã°
 ("mu…i_au.d©", 
au_f‹m©s
, 
	`ARRAY_LEN
 (au_formats)) ;

120 
ã°_cou¡
++ ;

124 
	}
}

130 
	$mu…i_fûe_ã°
 (c⁄° *
fûíame
, *
f‹m©s
, 
f‹m©_cou¡
)

131 { 
SNDFILE
 *
¢dfûe
 ;

132 
SF_INFO
 
sföfo
 ;

133 
SF_EMBED_FILE_INFO
 
embed_öfo
 ;

134 
off_t
 
fûe_Àngth
 ;

135 
fd
, 
k
, 
fûe_cou¡
 = 0 ;

137 
	`¥öt_ã°_«me
 ("mu…i_fûe_ã°", 
fûíame
) ;

139 
	`u∆ök
 (
fûíame
) ;

141 i‡((
fd
 = 
	`›í
 (
fûíame
, 
O_RDWR
 | 
O_CREAT
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 )) < 0)

142 { 
	`¥ötf
 ("\n\nLöê%d: o≥¿Áûed : %s\n", 
__LINE__
, 
	`°ªº‹
 (
î∫o
)) ;

143 
	`exô
 (1) ;

146 
	`wrôe
 (
fd
, "1234", 4) ;

148 
k
 = 0 ; k < 
f‹m©_cou¡
 ; k++)

149 
	`wrôe_fûe_©_íd
 (
fd
, 
f‹m©s
 [
k
], 2, k) ;

151 
fûe_Àngth
 = 
	`gë_fûe_Àngth
 (
fd
) ;

153 
embed_öfo
.
off£t
 = 4 ;

154 
embed_öfo
.
Àngth
 = 0 ;

156 
fûe_cou¡
 = 0 ;

158 
embed_öfo
.
off£t
 +Émbed_öfo.
Àngth
 < 
fûe_Àngth
)

160 
fûe_cou¡
 ++ ;

162 i‡(
vîbo£
)

163 { 
	`puts
 ("\n------------------------------------") ;

164 
	`¥ötf
 ("Thi†off£à: %ld\n", 
	`SF_COUNT_TO_LONG
 (
embed_öfo
.
off£t
 +Émbed_öfo.
Àngth
)) ;

167 i‡(
	`l£ek
 (
fd
, 
embed_öfo
.
off£t
 +Émbed_öfo.
Àngth
, 
SEEK_SET
) < 0)

168 { 
	`¥ötf
 ("\n\nLöê%d:Ü£ek faûed : %s\n", 
__LINE__
, 
	`°ªº‹
 (
î∫o
)) ;

169 
	`exô
 (1) ;

172 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

173 i‡((
¢dfûe
 = 
	`sf_›í_fd
 (
fd
, 
SFM_READ
, &
sföfo
, 
SF_FALSE
)Ë=
NULL
)

174 { 
	`¥ötf
 ("\n\nLöê%d: sf_›í_fd faûed\n", 
__LINE__
) ;

175 
	`¥ötf
 ("Embedded fûênumbî : %d off£à: %ld\n", 
fûe_cou¡
, 
	`SF_COUNT_TO_LONG
 (
embed_öfo
.
off£t
)) ;

176 
	`puts
 (
	`sf_°ªº‹
 (
¢dfûe
)) ;

177 
	`dump_log_buf„r
 (
¢dfûe
) ;

178 
	`exô
 (1) ;

181 
	`sf_comm™d
 (
¢dfûe
, 
SFC_GET_EMBED_FILE_INFO
, &
embed_öfo
,  (embed_info)) ;

183 
	`sf_˛o£
 (
¢dfûe
) ;

185 i‡(
vîbo£
)

186 
	`¥ötf
 ("\nNexàoff£à: %ld\nNexàÀngth : %ld\n", 
	`SF_COUNT_TO_LONG
 (
embed_öfo
.
off£t
), SF_COUNT_TO_LONG (embed_öfo.
Àngth
)) ;

189 i‡(
fûe_cou¡
 !
f‹m©_cou¡
)

190 { 
	`¥ötf
 ("\n\nLöê%d: fûêcou¡ (%dËnŸÉquÆÅÿ%d.\n\n", 
__LINE__
, 
fûe_cou¡
, 
f‹m©_cou¡
) ;

191 
	`¥ötf
 ("Embedded fûênumbî : %d\n", 
fûe_cou¡
) ;

192 
	`exô
 (1) ;

195 
	`˛o£
 (
fd
) ;

196 
	`u∆ök
 (
fûíame
) ;

197 
	`¥ötf
 ("ok\n") ;

200 
	}
}

206 
	$wrôe_fûe_©_íd
 (
fd
, 
fûëy≥
, 
ch™√ls
, 
fûe_num
)

207 { 
SNDFILE
 *
¢dfûe
 ;

208 
SF_INFO
 
sföfo
 ;

210 
‰ames
, 
k
 ;

212 
	`l£ek
 (
fd
, 0, 
SEEK_END
) ;

214 
k
 = 0 ; k < 
DATA_LENGTH
 ; k++)

215 
d©a
 [
k
] = k ;

217 
‰ames
 = 
DATA_LENGTH
 / 
ch™√ls
 ;

219 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

220 
sföfo
.
ch™√ls
 = channels ;

221 
sföfo
.
ßm∂î©e
 = 44100 ;

223 i‡((
¢dfûe
 = 
	`sf_›í_fd
 (
fd
, 
SFM_WRITE
, &
sföfo
, 
SF_FALSE
)Ë=
NULL
)

224 { 
	`¥ötf
 ("\n\nLöê%d: sf_›í_fd faûed\n", 
__LINE__
) ;

225 
	`¥ötf
 ("Embedded fûênumbî : %d\n", 
fûe_num
) ;

226 
	`puts
 (
	`sf_°ªº‹
 (
¢dfûe
)) ;

227 
	`dump_log_buf„r
 (
¢dfûe
) ;

228 
	`exô
 (1) ;

231 i‡(
	`sf_wrôef_sh‹t
 (
¢dfûe
, 
d©a
, 
‰ames
) != frames)

232 { 
	`¥ötf
 ("\n\nLöê%d: sh‹àwrôe\n", 
__LINE__
) ;

233 
	`¥ötf
 ("Embedded fûênumbî : %d\n", 
fûe_num
) ;

234 
	`exô
 (1) ;

237 
	`sf_˛o£
 (
¢dfûe
) ;

238 
	}
}

240 
off_t


241 
	$gë_fûe_Àngth
 (
fd
)

242 { 
°©
 
°©buf
 ;

244 i‡(
	`f°©
 (
fd
, &
°©buf
) == -1)

245 { 
	`¥ötf
 ("\n\nEº‹ : f°©Éº‹ : %s\n\n", 
	`°ªº‹
 (
î∫o
)) ;

246 
	`exô
 (1) ;

249  
°©buf
.
°_size
 ;

250 
	}
}

	@libsndfile-1.0.17/tests/open_fail_test.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

25 #i‡
HAVE_UNISTD_H


26 
	~<uni°d.h
>

29 
	~<¢dfûe.h
>

31 
	~"utûs.h
"

34 
	$maö
 ()

35 { 
SNDFILE
 *
¢dfûe
 ;

36 
SF_INFO
 
sföfo
 ;

38 
FILE
 *
bad_fûe
 ;

39 c⁄° *
bad_wav
 = "bad_wav.wav" ;

40 c⁄° 
bad_d©a
 [] = "RIFF WAVEfmt " ;

42 
	`¥öt_ã°_«me
 ("›í_Áû_ã°", 
bad_wav
) ;

44 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

46 
¢dfûe
 = 
	`sf_›í
 ("Àt'†h›êthi†fûêd€¢'àexi°", 
SFM_READ
, &
sföfo
) ;

48 i‡(
¢dfûe
)

49 { 
	`¥ötf
 ("Löê%d: shouldÇŸ havêª˚ivedá vÆid SNDFILE*Öoöãr.\n", 
__LINE__
) ;

50 
	`exô
 (1) ;

53 i‡((
bad_fûe
 = 
	`f›í
 (
bad_wav
, "w")Ë=
NULL
)

54 { 
	`¥ötf
 ("Löê%d: f›íÑëu∫ed NULL.\n", 
__LINE__
) ;

55 
	`exô
 (1) ;

58 
	`fwrôe
 (
bad_d©a
,  (bad_d©a), 1, 
bad_fûe
) ;

59 
	`f˛o£
 (
bad_fûe
) ;

61 
¢dfûe
 = 
	`sf_›í
 (
bad_wav
, 
SFM_READ
, &
sföfo
) ;

63 i‡(
¢dfûe
)

64 { 
	`¥ötf
 ("Löê%d: shouldÇŸ havêª˚ivedá vÆid SNDFILE*Öoöãr.\n", 
__LINE__
) ;

65 
	`exô
 (1) ;

68 
	`u∆ök
 (
bad_wav
) ;

69 
	`puts
 ("ok") ;

72 
	}
}

	@libsndfile-1.0.17/tests/pcm_test.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

25 #i‡
HAVE_UNISTD_H


26 
	~<uni°d.h
>

29 
	~<¢dfûe.h
>

31 
	~"Êﬂt_ˇ°.h
"

32 
	~"utûs.h
"

34 
	#BUFFER_SIZE
 (1<<12)

	)

36 
Ãötf_ã°
 () ;

38 
pcm_ã°_bôs_8
 (c⁄° *
fûíame
, 
fûëy≥
, 
hash
) ;

39 
pcm_ã°_bôs_16
 (c⁄° *
fûíame
, 
fûëy≥
, 
hash
) ;

40 
pcm_ã°_bôs_24
 (c⁄° *
fûíame
, 
fûëy≥
, 
hash
) ;

41 
pcm_ã°_bôs_32
 (c⁄° *
fûíame
, 
fûëy≥
, 
hash
) ;

43 
pcm_ã°_Êﬂt
 (c⁄° *
fûíame
, 
fûëy≥
, 
hash
, 
ª∂a˚_Êﬂt
) ;

44 
pcm_ã°_doubÀ
 (c⁄° *
fûíame
, 
fûëy≥
, 
hash
, 
ª∂a˚_Êﬂt
) ;

47 { 
	md
 [
BUFFER_SIZE
 + 1];

48 
	mf
 [
BUFFER_SIZE
 + 1];

49 
	mi
 [
BUFFER_SIZE
 + 1];

50 
	ms
 [
BUFFER_SIZE
 + 1];

51 } 
	tBUFFER
 ;

54 
BUFFER
 
	gd©a_out
 ;

57 
BUFFER
 
	gd©a_ö
 ;

60 
	$maö
 ()

62 
	`Ãötf_ã°
 () ;

64 
	`pcm_ã°_bôs_8
 ("pcm-s8.øw", 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_S8
, 0x9ae33814) ;

65 
	`pcm_ã°_bôs_8
 ("pcm-u8.øw", 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_U8
, 0x651d4694) ;

67 
	`pcm_ã°_bôs_16
 ("À-pcm16.øw", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_16
, 0x16866fa0) ;

68 
	`pcm_ã°_bôs_16
 ("be-pcm16.øw", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_16
, 0xc571826c) ;

70 
	`pcm_ã°_bôs_24
 ("À-pcm24.øw", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_24
, 0x658e4bb6) ;

71 
	`pcm_ã°_bôs_24
 ("be-pcm24.øw", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_24
, 0xbf8cde4a) ;

73 
	`pcm_ã°_bôs_32
 ("À-pcm32.øw", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_32
, 0x04c84a70) ;

74 
	`pcm_ã°_bôs_32
 ("be-pcm32.øw", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_32
, 0x069c84f6) ;

77 
	`pcm_ã°_Êﬂt
 ("À-Êﬂt.øw", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_FLOAT
, 0xbb836603, 
SF_FALSE
) ;

78 
	`pcm_ã°_Êﬂt
 ("be-Êﬂt.øw", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_FLOAT
, 0x903cd8fc, 
SF_FALSE
) ;

80 
	`pcm_ã°_doubÀ
 ("À-doubÀ.øw", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_DOUBLE
, 0xbf84448e, 
SF_FALSE
) ;

81 
	`pcm_ã°_doubÀ
 ("be-doubÀ.øw", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_DOUBLE
, 0xaf3d9fb5, 
SF_FALSE
) ;

83 
	`puts
 ("Test IEEEÑeplacement code.") ;

85 
	`pcm_ã°_Êﬂt
 ("À-Êﬂt.øw", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_FLOAT
, 0xbb836603, 
SF_TRUE
) ;

86 
	`pcm_ã°_Êﬂt
 ("be-Êﬂt.øw", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_FLOAT
, 0x903cd8fc, 
SF_TRUE
) ;

88 
	`pcm_ã°_doubÀ
 ("À-doubÀ.øw", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_DOUBLE
, 0xbf84448e, 
SF_TRUE
) ;

89 
	`pcm_ã°_doubÀ
 ("be-doubÀ.øw", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_DOUBLE
, 0xaf3d9fb5, 
SF_TRUE
) ;

93 
	}
}

100 
	$Ãötf_ã°
 ()

101 { 
k
, 
ôems
 ;

102 *
Êﬂt_d©a
 ;

103 *
öt_d©a
 ;

105 
	`¥öt_ã°_«me
 ("lrintf_test", "") ;

107 
ôems
 = 1024 ;

109 
Êﬂt_d©a
 = 
d©a_out
.
f
 ;

110 
öt_d©a
 = 
d©a_ö
.
i
 ;

112 
k
 = 0 ; k < 
ôems
 ; k++)

113 
Êﬂt_d©a
 [
k
] = (k * ((k % 2) ? 333333.0 : -333333.0)) ;

115 
k
 = 0 ; k < 
ôems
 ; k++)

116 
öt_d©a
 [
k
] = 
	`Ãötf
 (
Êﬂt_d©a
 [k]) ;

118 
k
 = 0 ; k < 
ôems
 ; k++)

119 i‡(
	`Ábs
 (
öt_d©a
 [
k
] - 
Êﬂt_d©a
 [k]) > 1.0)

120 { 
	`¥ötf
 ("\n\nLöê%d: flﬂà: Inc‹ª˘ sam∂ê(#%d : %‡=> %d).\n", 
__LINE__
, 
k
, 
Êﬂt_d©a
 [k], 
öt_d©a
 [k]) ;

121 
	`exô
 (1) ;

124 
	`¥ötf
 ("ok\n") ;

125 
	}
}

128 
	$pcm_ã°_bôs_8
 (c⁄° *
fûíame
, 
fûëy≥
, 
hash
)

129 { 
SNDFILE
 *
fûe
 ;

130 
SF_INFO
 
sföfo
 ;

131 
k
, 
ôems
, 
zîo_cou¡
 ;

132 *
sh‹t_out
, *
sh‹t_ö
 ;

133 *
öt_out
, *
öt_ö
 ;

135 *
Êﬂt_out
, *
Êﬂt_ö
 ;

136 *
doubÀ_out
, *
doubÀ_ö
 ;

139 
	`¥öt_ã°_«me
 ("pcm_ã°_bôs_8", 
fûíame
) ;

141 
ôems
 = 127 ;

143 
sh‹t_out
 = 
d©a_out
.
s
 ;

144 
sh‹t_ö
 = 
d©a_ö
.
s
 ;

146 
zîo_cou¡
 = 0 ;

147 
k
 = 0 ; k < 
ôems
 ; k++)

148 { 
sh‹t_out
 [
k
] = ((k * ((k % 2) ? 1 : -1)) << 8) ;

149 
zîo_cou¡
 = 
sh‹t_out
 [
k
] ? zero_count : zero_count + 1 ;

152 i‡(
zîo_cou¡
 > 
ôems
 / 4)

153 { 
	`¥ötf
 ("\n\nLöê%d:Åoÿm™y zîos.\n", 
__LINE__
) ;

154 
	`exô
 (1) ;

157 
sföfo
.
ßm∂î©e
 = 44100 ;

158 
sföfo
.
‰ames
 = 123456789 ;

159 
sföfo
.
ch™√ls
 = 1 ;

160 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

162 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

164 
	`ã°_wrôe_sh‹t_‹_dõ
 (
fûe
, 0, 
sh‹t_out
, 
ôems
, 
__LINE__
) ;

166 
	`sf_˛o£
 (
fûe
) ;

168 
	`mem£t
 (
sh‹t_ö
, 0, 
ôems
 *  ()) ;

170 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

172 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

173 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

174 
	`exô
 (1) ;

177 i‡(
sföfo
.
‰ames
 !
ôems
)

178 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
ôems
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

179 
	`exô
 (1) ;

182 i‡(
sföfo
.
ch™√ls
 != 1)

183 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

184 
	`exô
 (1) ;

187 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

189 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 0, 
sh‹t_ö
, 
ôems
, 
__LINE__
) ;

191 
k
 = 0 ; k < 
ôems
 ; k++)

192 i‡(
sh‹t_out
 [
k
] !
sh‹t_ö
 [k])

193 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ sam∂ê(#%d : 0x%x => 0x%x).\n", 
__LINE__
, 
k
, 
sh‹t_out
 [k], 
sh‹t_ö
 [k]) ;

194 
	`exô
 (1) ;

197 
	`sf_˛o£
 (
fûe
) ;

200 
	`check_fûe_hash_‹_dõ
 (
fûíame
, 
hash
, 
__LINE__
) ;

205 
zîo_cou¡
 = 0 ;

207 
öt_out
 = 
d©a_out
.
i
 ;

208 
öt_ö
 = 
d©a_ö
.
i
 ;

209 
k
 = 0 ; k < 
ôems
 ; k++)

210 { 
öt_out
 [
k
] = ((k * ((k % 2) ? 1 : -1)) << 24) ;

211 
zîo_cou¡
 = 
öt_out
 [
k
] ? zero_count : zero_count + 1 ;

214 i‡(
zîo_cou¡
 > 
ôems
 / 4)

215 { 
	`¥ötf
 ("\n\nLöê%d:Åoÿm™y zîos.\n", 
__LINE__
) ;

216 
	`exô
 (1) ;

219 
sföfo
.
ßm∂î©e
 = 44100 ;

220 
sföfo
.
‰ames
 = 123456789 ;

221 
sföfo
.
ch™√ls
 = 1 ;

222 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

224 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

226 
	`ã°_wrôe_öt_‹_dõ
 (
fûe
, 0, 
öt_out
, 
ôems
, 
__LINE__
) ;

228 
	`sf_˛o£
 (
fûe
) ;

230 
	`mem£t
 (
öt_ö
, 0, 
ôems
 *  ()) ;

232 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

234 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

235 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

236 
	`exô
 (1) ;

239 i‡(
sföfo
.
‰ames
 !
ôems
)

240 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
ôems
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

241 
	`exô
 (1) ;

244 i‡(
sföfo
.
ch™√ls
 != 1)

245 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

246 
	`exô
 (1) ;

249 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

251 
	`ã°_ªad_öt_‹_dõ
 (
fûe
, 0, 
öt_ö
, 
ôems
, 
__LINE__
) ;

253 
k
 = 0 ; k < 
ôems
 ; k++)

254 i‡(
öt_out
 [
k
] !
öt_ö
 [k])

255 { 
	`¥ötf
 ("\n\nLöê%d: i¡ : Inc‹ª˘ sam∂ê(#%d : 0x%x => 0x%x).\n", 
__LINE__
, 
k
, 
öt_out
 [k], 
öt_ö
 [k]) ;

256 
	`exô
 (1) ;

259 
	`sf_˛o£
 (
fûe
) ;

265 
zîo_cou¡
 = 0 ;

267 
Êﬂt_out
 = 
d©a_out
.
f
 ;

268 
Êﬂt_ö
 = 
d©a_ö
.
f
 ;

269 
k
 = 0 ; k < 
ôems
 ; k++)

270 { 
Êﬂt_out
 [
k
] = (k * ((k % 2) ? 1 : -1)) ;

271 
zîo_cou¡
 = (
	`Ábs
 (
Êﬂt_out
 [
k
]) > 1e-10) ? zero_count : zero_count + 1 ;

274 i‡(
zîo_cou¡
 > 
ôems
 / 4)

275 { 
	`¥ötf
 ("\n\nLöê%d:Åoÿm™y zîo†(%d/%d).\n", 
__LINE__
, 
zîo_cou¡
, 
ôems
) ;

276 
	`exô
 (1) ;

279 
sföfo
.
ßm∂î©e
 = 44100 ;

280 
sföfo
.
‰ames
 = 123456789 ;

281 
sföfo
.
ch™√ls
 = 1 ;

282 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

284 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

286 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

288 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
fûe
, 0, 
Êﬂt_out
, 
ôems
, 
__LINE__
) ;

290 
	`sf_˛o£
 (
fûe
) ;

292 
	`mem£t
 (
Êﬂt_ö
, 0, 
ôems
 *  ()) ;

294 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

296 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

297 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

298 
	`exô
 (1) ;

301 i‡(
sföfo
.
‰ames
 !
ôems
)

302 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
ôems
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

303 
	`exô
 (1) ;

306 i‡(
sföfo
.
ch™√ls
 != 1)

307 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

308 
	`exô
 (1) ;

311 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

313 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

315 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
Êﬂt_ö
, 
ôems
, 
__LINE__
) ;

317 
k
 = 0 ; k < 
ôems
 ; k++)

318 i‡(
	`Ábs
 (
Êﬂt_out
 [
k
] - 
Êﬂt_ö
 [k]) > 1e-10)

319 { 
	`¥ötf
 ("\n\nLöê%d: flﬂà: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__LINE__
, 
k
, (Ë
Êﬂt_out
 [k], (Ë
Êﬂt_ö
 [k]) ;

320 
	`exô
 (1) ;

324 
	`sf_˛o£
 (
fûe
) ;

329 
zîo_cou¡
 = 0 ;

331 
doubÀ_out
 = 
d©a_out
.
d
 ;

332 
doubÀ_ö
 = 
d©a_ö
.
d
 ;

333 
k
 = 0 ; k < 
ôems
 ; k++)

334 { 
doubÀ_out
 [
k
] = (k * ((k % 2) ? 1 : -1)) ;

335 
zîo_cou¡
 = (
	`Ábs
 (
doubÀ_out
 [
k
]) > 1e-10) ? zero_count : zero_count + 1 ;

338 i‡(
zîo_cou¡
 > 
ôems
 / 4)

339 { 
	`¥ötf
 ("\n\nLöê%d:Åoÿm™y zîo†(%d/%d).\n", 
__LINE__
, 
zîo_cou¡
, 
ôems
) ;

340 
	`exô
 (1) ;

343 
sföfo
.
ßm∂î©e
 = 44100 ;

344 
sföfo
.
‰ames
 = 123456789 ;

345 
sföfo
.
ch™√ls
 = 1 ;

346 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

348 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

350 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

352 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
doubÀ_out
, 
ôems
, 
__LINE__
) ;

354 
	`sf_˛o£
 (
fûe
) ;

356 
	`mem£t
 (
doubÀ_ö
, 0, 
ôems
 *  ()) ;

358 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

360 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

361 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

362 
	`exô
 (1) ;

365 i‡(
sföfo
.
‰ames
 !
ôems
)

366 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
ôems
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

367 
	`exô
 (1) ;

370 i‡(
sföfo
.
ch™√ls
 != 1)

371 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

372 
	`exô
 (1) ;

375 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

377 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

379 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
doubÀ_ö
, 
ôems
, 
__LINE__
) ;

381 
k
 = 0 ; k < 
ôems
 ; k++)

382 i‡(
	`Ábs
 (
doubÀ_out
 [
k
] - 
doubÀ_ö
 [k]) > 1e-10)

383 { 
	`¥ötf
 ("\n\nLöê%d: doubÀ : Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__LINE__
, 
k
, 
doubÀ_out
 [k], 
doubÀ_ö
 [k]) ;

384 
	`exô
 (1) ;

387 
	`sf_˛o£
 (
fûe
) ;

389 
	`u∆ök
 (
fûíame
) ;

391 
	`puts
 ("ok") ;

392 
	}
}

395 
	$pcm_ã°_bôs_16
 (c⁄° *
fûíame
, 
fûëy≥
, 
hash
)

396 { 
SNDFILE
 *
fûe
 ;

397 
SF_INFO
 
sföfo
 ;

398 
k
, 
ôems
, 
zîo_cou¡
 ;

399 *
sh‹t_out
, *
sh‹t_ö
 ;

400 *
öt_out
, *
öt_ö
 ;

402 *
Êﬂt_out
, *
Êﬂt_ö
 ;

403 *
doubÀ_out
, *
doubÀ_ö
 ;

406 
	`¥öt_ã°_«me
 ("pcm_ã°_bôs_16", 
fûíame
) ;

408 
ôems
 = 1024 ;

410 
sh‹t_out
 = 
d©a_out
.
s
 ;

411 
sh‹t_ö
 = 
d©a_ö
.
s
 ;

413 
zîo_cou¡
 = 0 ;

414 
k
 = 0 ; k < 
ôems
 ; k++)

415 { 
sh‹t_out
 [
k
] = (k * ((k % 2) ? 3 : -3)) ;

416 
zîo_cou¡
 = 
sh‹t_out
 [
k
] ? zero_count : zero_count + 1 ;

419 i‡(
zîo_cou¡
 > 
ôems
 / 4)

420 { 
	`¥ötf
 ("\n\nLöê%d:Åoÿm™y zîos.\n", 
__LINE__
) ;

421 
	`exô
 (1) ;

424 
sföfo
.
ßm∂î©e
 = 44100 ;

425 
sföfo
.
‰ames
 = 123456789 ;

426 
sföfo
.
ch™√ls
 = 1 ;

427 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

429 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

431 
	`ã°_wrôe_sh‹t_‹_dõ
 (
fûe
, 0, 
sh‹t_out
, 
ôems
, 
__LINE__
) ;

433 
	`sf_˛o£
 (
fûe
) ;

435 
	`mem£t
 (
sh‹t_ö
, 0, 
ôems
 *  ()) ;

437 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

439 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

440 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

441 
	`exô
 (1) ;

444 i‡(
sföfo
.
‰ames
 !
ôems
)

445 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
ôems
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

446 
	`exô
 (1) ;

449 i‡(
sföfo
.
ch™√ls
 != 1)

450 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

451 
	`exô
 (1) ;

454 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

456 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 0, 
sh‹t_ö
, 
ôems
, 
__LINE__
) ;

458 
k
 = 0 ; k < 
ôems
 ; k++)

459 i‡(
sh‹t_out
 [
k
] !
sh‹t_ö
 [k])

460 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ sam∂ê(#%d : 0x%x => 0x%x).\n", 
__LINE__
, 
k
, 
sh‹t_out
 [k], 
sh‹t_ö
 [k]) ;

461 
	`exô
 (1) ;

464 
	`sf_˛o£
 (
fûe
) ;

467 
	`check_fûe_hash_‹_dõ
 (
fûíame
, 
hash
, 
__LINE__
) ;

472 
zîo_cou¡
 = 0 ;

474 
öt_out
 = 
d©a_out
.
i
 ;

475 
öt_ö
 = 
d©a_ö
.
i
 ;

476 
k
 = 0 ; k < 
ôems
 ; k++)

477 { 
öt_out
 [
k
] = ((k * ((k % 2) ? 3 : -3)) << 16) ;

478 
zîo_cou¡
 = 
öt_out
 [
k
] ? zero_count : zero_count + 1 ;

481 i‡(
zîo_cou¡
 > 
ôems
 / 4)

482 { 
	`¥ötf
 ("\n\nLöê%d:Åoÿm™y zîos.\n", 
__LINE__
) ;

483 
	`exô
 (1) ;

486 
sföfo
.
ßm∂î©e
 = 44100 ;

487 
sföfo
.
‰ames
 = 123456789 ;

488 
sföfo
.
ch™√ls
 = 1 ;

489 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

491 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

493 
	`ã°_wrôe_öt_‹_dõ
 (
fûe
, 0, 
öt_out
, 
ôems
, 
__LINE__
) ;

495 
	`sf_˛o£
 (
fûe
) ;

497 
	`mem£t
 (
öt_ö
, 0, 
ôems
 *  ()) ;

499 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

501 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

502 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

503 
	`exô
 (1) ;

506 i‡(
sföfo
.
‰ames
 !
ôems
)

507 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
ôems
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

508 
	`exô
 (1) ;

511 i‡(
sföfo
.
ch™√ls
 != 1)

512 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

513 
	`exô
 (1) ;

516 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

518 
	`ã°_ªad_öt_‹_dõ
 (
fûe
, 0, 
öt_ö
, 
ôems
, 
__LINE__
) ;

520 
k
 = 0 ; k < 
ôems
 ; k++)

521 i‡(
öt_out
 [
k
] !
öt_ö
 [k])

522 { 
	`¥ötf
 ("\n\nLöê%d: i¡ : Inc‹ª˘ sam∂ê(#%d : 0x%x => 0x%x).\n", 
__LINE__
, 
k
, 
öt_out
 [k], 
öt_ö
 [k]) ;

523 
	`exô
 (1) ;

526 
	`sf_˛o£
 (
fûe
) ;

532 
zîo_cou¡
 = 0 ;

534 
Êﬂt_out
 = 
d©a_out
.
f
 ;

535 
Êﬂt_ö
 = 
d©a_ö
.
f
 ;

536 
k
 = 0 ; k < 
ôems
 ; k++)

537 { 
Êﬂt_out
 [
k
] = (k * ((k % 2) ? 3 : -3)) ;

538 
zîo_cou¡
 = (
	`Ábs
 (
Êﬂt_out
 [
k
]) > 1e-10) ? zero_count : zero_count + 1 ;

541 i‡(
zîo_cou¡
 > 
ôems
 / 4)

542 { 
	`¥ötf
 ("\n\nLöê%d:Åoÿm™y zîo†(%d/%d).\n", 
__LINE__
, 
zîo_cou¡
, 
ôems
) ;

543 
	`exô
 (1) ;

546 
sföfo
.
ßm∂î©e
 = 44100 ;

547 
sföfo
.
‰ames
 = 123456789 ;

548 
sföfo
.
ch™√ls
 = 1 ;

549 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

551 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

553 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

555 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
fûe
, 0, 
Êﬂt_out
, 
ôems
, 
__LINE__
) ;

557 
	`sf_˛o£
 (
fûe
) ;

559 
	`mem£t
 (
Êﬂt_ö
, 0, 
ôems
 *  ()) ;

561 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

563 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

564 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

565 
	`exô
 (1) ;

568 i‡(
sföfo
.
‰ames
 !
ôems
)

569 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
ôems
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

570 
	`exô
 (1) ;

573 i‡(
sföfo
.
ch™√ls
 != 1)

574 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

575 
	`exô
 (1) ;

578 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

580 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

582 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
Êﬂt_ö
, 
ôems
, 
__LINE__
) ;

584 
k
 = 0 ; k < 
ôems
 ; k++)

585 i‡(
	`Ábs
 (
Êﬂt_out
 [
k
] - 
Êﬂt_ö
 [k]) > 1e-10)

586 { 
	`¥ötf
 ("\n\nLöê%d: flﬂà: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__LINE__
, 
k
, (Ë
Êﬂt_out
 [k], (Ë
Êﬂt_ö
 [k]) ;

587 
	`exô
 (1) ;

591 
	`sf_˛o£
 (
fûe
) ;

596 
zîo_cou¡
 = 0 ;

598 
doubÀ_out
 = 
d©a_out
.
d
 ;

599 
doubÀ_ö
 = 
d©a_ö
.
d
 ;

600 
k
 = 0 ; k < 
ôems
 ; k++)

601 { 
doubÀ_out
 [
k
] = (k * ((k % 2) ? 3 : -3)) ;

602 
zîo_cou¡
 = (
	`Ábs
 (
doubÀ_out
 [
k
]) > 1e-10) ? zero_count : zero_count + 1 ;

605 i‡(
zîo_cou¡
 > 
ôems
 / 4)

606 { 
	`¥ötf
 ("\n\nLöê%d:Åoÿm™y zîo†(%d/%d).\n", 
__LINE__
, 
zîo_cou¡
, 
ôems
) ;

607 
	`exô
 (1) ;

610 
sföfo
.
ßm∂î©e
 = 44100 ;

611 
sföfo
.
‰ames
 = 123456789 ;

612 
sföfo
.
ch™√ls
 = 1 ;

613 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

615 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

617 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

619 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
doubÀ_out
, 
ôems
, 
__LINE__
) ;

621 
	`sf_˛o£
 (
fûe
) ;

623 
	`mem£t
 (
doubÀ_ö
, 0, 
ôems
 *  ()) ;

625 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

627 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

628 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

629 
	`exô
 (1) ;

632 i‡(
sföfo
.
‰ames
 !
ôems
)

633 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
ôems
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

634 
	`exô
 (1) ;

637 i‡(
sföfo
.
ch™√ls
 != 1)

638 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

639 
	`exô
 (1) ;

642 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

644 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

646 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
doubÀ_ö
, 
ôems
, 
__LINE__
) ;

648 
k
 = 0 ; k < 
ôems
 ; k++)

649 i‡(
	`Ábs
 (
doubÀ_out
 [
k
] - 
doubÀ_ö
 [k]) > 1e-10)

650 { 
	`¥ötf
 ("\n\nLöê%d: doubÀ : Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__LINE__
, 
k
, 
doubÀ_out
 [k], 
doubÀ_ö
 [k]) ;

651 
	`exô
 (1) ;

654 
	`sf_˛o£
 (
fûe
) ;

656 
	`u∆ök
 (
fûíame
) ;

658 
	`puts
 ("ok") ;

659 
	}
}

662 
	$pcm_ã°_bôs_24
 (c⁄° *
fûíame
, 
fûëy≥
, 
hash
)

663 { 
SNDFILE
 *
fûe
 ;

664 
SF_INFO
 
sföfo
 ;

665 
k
, 
ôems
, 
zîo_cou¡
 ;

666 *
sh‹t_out
, *
sh‹t_ö
 ;

667 *
öt_out
, *
öt_ö
 ;

669 *
Êﬂt_out
, *
Êﬂt_ö
 ;

670 *
doubÀ_out
, *
doubÀ_ö
 ;

673 
	`¥öt_ã°_«me
 ("pcm_ã°_bôs_24", 
fûíame
) ;

675 
ôems
 = 1024 ;

677 
sh‹t_out
 = 
d©a_out
.
s
 ;

678 
sh‹t_ö
 = 
d©a_ö
.
s
 ;

680 
zîo_cou¡
 = 0 ;

681 
k
 = 0 ; k < 
ôems
 ; k++)

682 { 
sh‹t_out
 [
k
] = (k * ((k % 2) ? 3 : -3)) ;

683 
zîo_cou¡
 = 
sh‹t_out
 [
k
] ? zero_count : zero_count + 1 ;

686 i‡(
zîo_cou¡
 > 
ôems
 / 4)

687 { 
	`¥ötf
 ("\n\nLöê%d:Åoÿm™y zîos.\n", 
__LINE__
) ;

688 
	`exô
 (1) ;

691 
sföfo
.
ßm∂î©e
 = 44100 ;

692 
sföfo
.
‰ames
 = 123456789 ;

693 
sföfo
.
ch™√ls
 = 1 ;

694 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

696 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

698 
	`ã°_wrôe_sh‹t_‹_dõ
 (
fûe
, 0, 
sh‹t_out
, 
ôems
, 
__LINE__
) ;

700 
	`sf_˛o£
 (
fûe
) ;

702 
	`mem£t
 (
sh‹t_ö
, 0, 
ôems
 *  ()) ;

704 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

706 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

707 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

708 
	`exô
 (1) ;

711 i‡(
sföfo
.
‰ames
 !
ôems
)

712 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
ôems
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

713 
	`exô
 (1) ;

716 i‡(
sföfo
.
ch™√ls
 != 1)

717 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

718 
	`exô
 (1) ;

721 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

723 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 0, 
sh‹t_ö
, 
ôems
, 
__LINE__
) ;

725 
k
 = 0 ; k < 
ôems
 ; k++)

726 i‡(
sh‹t_out
 [
k
] !
sh‹t_ö
 [k])

727 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ sam∂ê(#%d : 0x%x => 0x%x).\n", 
__LINE__
, 
k
, 
sh‹t_out
 [k], 
sh‹t_ö
 [k]) ;

728 
	`exô
 (1) ;

731 
	`sf_˛o£
 (
fûe
) ;

734 
	`check_fûe_hash_‹_dõ
 (
fûíame
, 
hash
, 
__LINE__
) ;

739 
zîo_cou¡
 = 0 ;

741 
öt_out
 = 
d©a_out
.
i
 ;

742 
öt_ö
 = 
d©a_ö
.
i
 ;

743 
k
 = 0 ; k < 
ôems
 ; k++)

744 { 
öt_out
 [
k
] = ((k * ((k % 2) ? 3333 : -3333)) << 8) ;

745 
zîo_cou¡
 = 
öt_out
 [
k
] ? zero_count : zero_count + 1 ;

748 i‡(
zîo_cou¡
 > 
ôems
 / 4)

749 { 
	`¥ötf
 ("\n\nLöê%d:Åoÿm™y zîos.\n", 
__LINE__
) ;

750 
	`exô
 (1) ;

753 
sföfo
.
ßm∂î©e
 = 44100 ;

754 
sföfo
.
‰ames
 = 123456789 ;

755 
sföfo
.
ch™√ls
 = 1 ;

756 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

758 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

760 
	`ã°_wrôe_öt_‹_dõ
 (
fûe
, 0, 
öt_out
, 
ôems
, 
__LINE__
) ;

762 
	`sf_˛o£
 (
fûe
) ;

764 
	`mem£t
 (
öt_ö
, 0, 
ôems
 *  ()) ;

766 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

768 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

769 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

770 
	`exô
 (1) ;

773 i‡(
sföfo
.
‰ames
 !
ôems
)

774 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
ôems
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

775 
	`exô
 (1) ;

778 i‡(
sföfo
.
ch™√ls
 != 1)

779 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

780 
	`exô
 (1) ;

783 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

785 
	`ã°_ªad_öt_‹_dõ
 (
fûe
, 0, 
öt_ö
, 
ôems
, 
__LINE__
) ;

787 
k
 = 0 ; k < 
ôems
 ; k++)

788 i‡(
öt_out
 [
k
] !
öt_ö
 [k])

789 { 
	`¥ötf
 ("\n\nLöê%d: i¡ : Inc‹ª˘ sam∂ê(#%d : 0x%x => 0x%x).\n", 
__LINE__
, 
k
, 
öt_out
 [k], 
öt_ö
 [k]) ;

790 
	`exô
 (1) ;

793 
	`sf_˛o£
 (
fûe
) ;

799 
zîo_cou¡
 = 0 ;

801 
Êﬂt_out
 = 
d©a_out
.
f
 ;

802 
Êﬂt_ö
 = 
d©a_ö
.
f
 ;

803 
k
 = 0 ; k < 
ôems
 ; k++)

804 { 
Êﬂt_out
 [
k
] = (k * ((k % 2) ? 3333 : -3333)) ;

805 
zîo_cou¡
 = (
	`Ábs
 (
Êﬂt_out
 [
k
]) > 1e-10) ? zero_count : zero_count + 1 ;

808 i‡(
zîo_cou¡
 > 
ôems
 / 4)

809 { 
	`¥ötf
 ("\n\nLöê%d:Åoÿm™y zîo†(%d/%d).\n", 
__LINE__
, 
zîo_cou¡
, 
ôems
) ;

810 
	`exô
 (1) ;

813 
sföfo
.
ßm∂î©e
 = 44100 ;

814 
sföfo
.
‰ames
 = 123456789 ;

815 
sföfo
.
ch™√ls
 = 1 ;

816 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

818 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

820 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

822 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
fûe
, 0, 
Êﬂt_out
, 
ôems
, 
__LINE__
) ;

824 
	`sf_˛o£
 (
fûe
) ;

826 
	`mem£t
 (
Êﬂt_ö
, 0, 
ôems
 *  ()) ;

828 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

830 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

831 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

832 
	`exô
 (1) ;

835 i‡(
sföfo
.
‰ames
 !
ôems
)

836 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
ôems
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

837 
	`exô
 (1) ;

840 i‡(
sföfo
.
ch™√ls
 != 1)

841 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

842 
	`exô
 (1) ;

845 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

847 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

849 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
Êﬂt_ö
, 
ôems
, 
__LINE__
) ;

851 
k
 = 0 ; k < 
ôems
 ; k++)

852 i‡(
	`Ábs
 (
Êﬂt_out
 [
k
] - 
Êﬂt_ö
 [k]) > 1e-10)

853 { 
	`¥ötf
 ("\n\nLöê%d: flﬂà: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__LINE__
, 
k
, (Ë
Êﬂt_out
 [k], (Ë
Êﬂt_ö
 [k]) ;

854 
	`exô
 (1) ;

858 
	`sf_˛o£
 (
fûe
) ;

863 
zîo_cou¡
 = 0 ;

865 
doubÀ_out
 = 
d©a_out
.
d
 ;

866 
doubÀ_ö
 = 
d©a_ö
.
d
 ;

867 
k
 = 0 ; k < 
ôems
 ; k++)

868 { 
doubÀ_out
 [
k
] = (k * ((k % 2) ? 3333 : -3333)) ;

869 
zîo_cou¡
 = (
	`Ábs
 (
doubÀ_out
 [
k
]) > 1e-10) ? zero_count : zero_count + 1 ;

872 i‡(
zîo_cou¡
 > 
ôems
 / 4)

873 { 
	`¥ötf
 ("\n\nLöê%d:Åoÿm™y zîo†(%d/%d).\n", 
__LINE__
, 
zîo_cou¡
, 
ôems
) ;

874 
	`exô
 (1) ;

877 
sföfo
.
ßm∂î©e
 = 44100 ;

878 
sföfo
.
‰ames
 = 123456789 ;

879 
sföfo
.
ch™√ls
 = 1 ;

880 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

882 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

884 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

886 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
doubÀ_out
, 
ôems
, 
__LINE__
) ;

888 
	`sf_˛o£
 (
fûe
) ;

890 
	`mem£t
 (
doubÀ_ö
, 0, 
ôems
 *  ()) ;

892 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

894 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

895 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

896 
	`exô
 (1) ;

899 i‡(
sföfo
.
‰ames
 !
ôems
)

900 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
ôems
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

901 
	`exô
 (1) ;

904 i‡(
sföfo
.
ch™√ls
 != 1)

905 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

906 
	`exô
 (1) ;

909 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

911 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

913 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
doubÀ_ö
, 
ôems
, 
__LINE__
) ;

915 
k
 = 0 ; k < 
ôems
 ; k++)

916 i‡(
	`Ábs
 (
doubÀ_out
 [
k
] - 
doubÀ_ö
 [k]) > 1e-10)

917 { 
	`¥ötf
 ("\n\nLöê%d: doubÀ : Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__LINE__
, 
k
, 
doubÀ_out
 [k], 
doubÀ_ö
 [k]) ;

918 
	`exô
 (1) ;

921 
	`sf_˛o£
 (
fûe
) ;

923 
	`u∆ök
 (
fûíame
) ;

925 
	`puts
 ("ok") ;

926 
	}
}

929 
	$pcm_ã°_bôs_32
 (c⁄° *
fûíame
, 
fûëy≥
, 
hash
)

930 { 
SNDFILE
 *
fûe
 ;

931 
SF_INFO
 
sföfo
 ;

932 
k
, 
ôems
, 
zîo_cou¡
 ;

933 *
sh‹t_out
, *
sh‹t_ö
 ;

934 *
öt_out
, *
öt_ö
 ;

936 *
Êﬂt_out
, *
Êﬂt_ö
 ;

937 *
doubÀ_out
, *
doubÀ_ö
 ;

940 
	`¥öt_ã°_«me
 ("pcm_ã°_bôs_32", 
fûíame
) ;

942 
ôems
 = 1024 ;

944 
sh‹t_out
 = 
d©a_out
.
s
 ;

945 
sh‹t_ö
 = 
d©a_ö
.
s
 ;

947 
zîo_cou¡
 = 0 ;

948 
k
 = 0 ; k < 
ôems
 ; k++)

949 { 
sh‹t_out
 [
k
] = (k * ((k % 2) ? 3 : -3)) ;

950 
zîo_cou¡
 = 
sh‹t_out
 [
k
] ? zero_count : zero_count + 1 ;

953 i‡(
zîo_cou¡
 > 
ôems
 / 4)

954 { 
	`¥ötf
 ("\n\nLöê%d:Åoÿm™y zîos.\n", 
__LINE__
) ;

955 
	`exô
 (1) ;

958 
sföfo
.
ßm∂î©e
 = 44100 ;

959 
sföfo
.
‰ames
 = 123456789 ;

960 
sföfo
.
ch™√ls
 = 1 ;

961 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

963 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

965 
	`ã°_wrôe_sh‹t_‹_dõ
 (
fûe
, 0, 
sh‹t_out
, 
ôems
, 
__LINE__
) ;

967 
	`sf_˛o£
 (
fûe
) ;

969 
	`mem£t
 (
sh‹t_ö
, 0, 
ôems
 *  ()) ;

971 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

973 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

974 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

975 
	`exô
 (1) ;

978 i‡(
sföfo
.
‰ames
 !
ôems
)

979 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
ôems
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

980 
	`exô
 (1) ;

983 i‡(
sföfo
.
ch™√ls
 != 1)

984 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

985 
	`exô
 (1) ;

988 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

990 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 0, 
sh‹t_ö
, 
ôems
, 
__LINE__
) ;

992 
k
 = 0 ; k < 
ôems
 ; k++)

993 i‡(
sh‹t_out
 [
k
] !
sh‹t_ö
 [k])

994 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘ sam∂ê(#%d : 0x%x => 0x%x).\n", 
__LINE__
, 
k
, 
sh‹t_out
 [k], 
sh‹t_ö
 [k]) ;

995 
	`exô
 (1) ;

998 
	`sf_˛o£
 (
fûe
) ;

1001 
	`check_fûe_hash_‹_dõ
 (
fûíame
, 
hash
, 
__LINE__
) ;

1006 
zîo_cou¡
 = 0 ;

1008 
öt_out
 = 
d©a_out
.
i
 ;

1009 
öt_ö
 = 
d©a_ö
.
i
 ;

1010 
k
 = 0 ; k < 
ôems
 ; k++)

1011 { 
öt_out
 [
k
] = (k * ((k % 2) ? 333333 : -333333)) ;

1012 
zîo_cou¡
 = 
öt_out
 [
k
] ? zero_count : zero_count + 1 ;

1015 i‡(
zîo_cou¡
 > 
ôems
 / 4)

1016 { 
	`¥ötf
 ("\n\nLöê%d:Åoÿm™y zîos.\n", 
__LINE__
) ;

1017 
	`exô
 (1) ;

1020 
sföfo
.
ßm∂î©e
 = 44100 ;

1021 
sföfo
.
‰ames
 = 123456789 ;

1022 
sföfo
.
ch™√ls
 = 1 ;

1023 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

1025 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

1027 
	`ã°_wrôe_öt_‹_dõ
 (
fûe
, 0, 
öt_out
, 
ôems
, 
__LINE__
) ;

1029 
	`sf_˛o£
 (
fûe
) ;

1031 
	`mem£t
 (
öt_ö
, 0, 
ôems
 *  ()) ;

1033 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

1035 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

1036 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

1037 
	`exô
 (1) ;

1040 i‡(
sföfo
.
‰ames
 !
ôems
)

1041 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
ôems
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

1042 
	`exô
 (1) ;

1045 i‡(
sföfo
.
ch™√ls
 != 1)

1046 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

1047 
	`exô
 (1) ;

1050 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

1052 
	`ã°_ªad_öt_‹_dõ
 (
fûe
, 0, 
öt_ö
, 
ôems
, 
__LINE__
) ;

1054 
k
 = 0 ; k < 
ôems
 ; k++)

1055 i‡(
öt_out
 [
k
] !
öt_ö
 [k])

1056 { 
	`¥ötf
 ("\n\nLöê%d: i¡ : Inc‹ª˘ sam∂ê(#%d : 0x%x => 0x%x).\n", 
__LINE__
, 
k
, 
öt_out
 [k], 
öt_ö
 [k]) ;

1057 
	`exô
 (1) ;

1060 
	`sf_˛o£
 (
fûe
) ;

1066 
zîo_cou¡
 = 0 ;

1068 
Êﬂt_out
 = 
d©a_out
.
f
 ;

1069 
Êﬂt_ö
 = 
d©a_ö
.
f
 ;

1070 
k
 = 0 ; k < 
ôems
 ; k++)

1071 { 
Êﬂt_out
 [
k
] = (k * ((k % 2) ? 333333 : -333333)) ;

1072 
zîo_cou¡
 = (
	`Ábs
 (
Êﬂt_out
 [
k
]) > 1e-10) ? zero_count : zero_count + 1 ;

1075 i‡(
zîo_cou¡
 > 
ôems
 / 4)

1076 { 
	`¥ötf
 ("\n\nLöê%d:Åoÿm™y zîo†(%d/%d).\n", 
__LINE__
, 
zîo_cou¡
, 
ôems
) ;

1077 
	`exô
 (1) ;

1080 
sföfo
.
ßm∂î©e
 = 44100 ;

1081 
sföfo
.
‰ames
 = 123456789 ;

1082 
sföfo
.
ch™√ls
 = 1 ;

1083 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

1085 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

1087 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

1089 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
fûe
, 0, 
Êﬂt_out
, 
ôems
, 
__LINE__
) ;

1091 
	`sf_˛o£
 (
fûe
) ;

1093 
	`mem£t
 (
Êﬂt_ö
, 0, 
ôems
 *  ()) ;

1095 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

1097 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

1098 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

1099 
	`exô
 (1) ;

1102 i‡(
sföfo
.
‰ames
 !
ôems
)

1103 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
ôems
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

1104 
	`exô
 (1) ;

1107 i‡(
sföfo
.
ch™√ls
 != 1)

1108 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

1109 
	`exô
 (1) ;

1112 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

1114 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

1116 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
Êﬂt_ö
, 
ôems
, 
__LINE__
) ;

1118 
k
 = 0 ; k < 
ôems
 ; k++)

1119 i‡(
	`Ábs
 (
Êﬂt_out
 [
k
] - 
Êﬂt_ö
 [k]) > 1e-10)

1120 { 
	`¥ötf
 ("\n\nLöê%d: flﬂà: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__LINE__
, 
k
, (Ë
Êﬂt_out
 [k], (Ë
Êﬂt_ö
 [k]) ;

1121 
	`exô
 (1) ;

1125 
	`sf_˛o£
 (
fûe
) ;

1130 
zîo_cou¡
 = 0 ;

1132 
doubÀ_out
 = 
d©a_out
.
d
 ;

1133 
doubÀ_ö
 = 
d©a_ö
.
d
 ;

1134 
k
 = 0 ; k < 
ôems
 ; k++)

1135 { 
doubÀ_out
 [
k
] = (k * ((k % 2) ? 333333 : -333333)) ;

1136 
zîo_cou¡
 = (
	`Ábs
 (
doubÀ_out
 [
k
]) > 1e-10) ? zero_count : zero_count + 1 ;

1139 i‡(
zîo_cou¡
 > 
ôems
 / 4)

1140 { 
	`¥ötf
 ("\n\nLöê%d:Åoÿm™y zîo†(%d/%d).\n", 
__LINE__
, 
zîo_cou¡
, 
ôems
) ;

1141 
	`exô
 (1) ;

1144 
sföfo
.
ßm∂î©e
 = 44100 ;

1145 
sföfo
.
‰ames
 = 123456789 ;

1146 
sföfo
.
ch™√ls
 = 1 ;

1147 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

1149 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

1151 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

1153 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
doubÀ_out
, 
ôems
, 
__LINE__
) ;

1155 
	`sf_˛o£
 (
fûe
) ;

1157 
	`mem£t
 (
doubÀ_ö
, 0, 
ôems
 *  ()) ;

1159 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

1161 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

1162 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

1163 
	`exô
 (1) ;

1166 i‡(
sföfo
.
‰ames
 !
ôems
)

1167 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
ôems
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

1168 
	`exô
 (1) ;

1171 i‡(
sföfo
.
ch™√ls
 != 1)

1172 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

1173 
	`exô
 (1) ;

1176 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

1178 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

1180 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
doubÀ_ö
, 
ôems
, 
__LINE__
) ;

1182 
k
 = 0 ; k < 
ôems
 ; k++)

1183 i‡(
	`Ábs
 (
doubÀ_out
 [
k
] - 
doubÀ_ö
 [k]) > 1e-10)

1184 { 
	`¥ötf
 ("\n\nLöê%d: doubÀ : Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__LINE__
, 
k
, 
doubÀ_out
 [k], 
doubÀ_ö
 [k]) ;

1185 
	`exô
 (1) ;

1188 
	`sf_˛o£
 (
fûe
) ;

1190 
	`u∆ök
 (
fûíame
) ;

1192 
	`puts
 ("ok") ;

1193 
	}
}

1201 
	$pcm_ã°_Êﬂt
 (c⁄° *
fûíame
, 
fûëy≥
, 
hash
, 
ª∂a˚_Êﬂt
)

1202 { 
SNDFILE
 *
fûe
 ;

1203 
SF_INFO
 
sföfo
 ;

1204 
k
, 
ôems
, 
‰ames
 ;

1205 
sign
 ;

1206 *
d©a
, 
îr‹
 ;

1208 
	`¥öt_ã°_«me
 ("pcm_ã°_Êﬂt", 
fûíame
) ;

1210 
ôems
 = 
BUFFER_SIZE
 ;

1212 
d©a
 = 
d©a_out
.
d
 ;

1213 
sign
 = 1, 
k
 = 0 ; k < 
ôems
 ; k++)

1214 { 
d©a
 [
k
] = ((Ë(k * 
sign
)) / 100.0 ;

1215 
sign
 = (sign > 0) ? -1 : 1 ;

1218 
sföfo
.
ßm∂î©e
 = 44100 ;

1219 
sföfo
.
‰ames
 = 
ôems
 ;

1220 
sföfo
.
ch™√ls
 = 1 ;

1221 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

1223 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

1224 
	`sf_comm™d
 (
fûe
, 
SFC_TEST_IEEE_FLOAT_REPLACE
, 
NULL
, 
ª∂a˚_Êﬂt
) ;

1225 i‡(
ª∂a˚_Êﬂt
 && 
	`°rög_ö_log_buf„r
 (
fûe
, "Using IEEEÑeplacement") == 0)

1226 { 
	`¥ötf
 ("\n\nLöê%d : Flﬂàª∂a˚míàcodênŸ w‹kög.\n\n", 
__LINE__
) ;

1227 
	`dump_log_buf„r
 (
fûe
) ;

1228 
	`exô
 (1) ;

1231 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
, 
ôems
, 
__LINE__
) ;

1233 
	`sf_˛o£
 (
fûe
) ;

1235 
	`check_fûe_hash_‹_dõ
 (
fûíame
, 
hash
, 
__LINE__
) ;

1237 
	`mem£t
 (
d©a
, 0, 
ôems
 *  ()) ;

1239 i‡((
fûëy≥
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

1240 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

1242 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

1243 
	`sf_comm™d
 (
fûe
, 
SFC_TEST_IEEE_FLOAT_REPLACE
, 
NULL
, 
ª∂a˚_Êﬂt
) ;

1244 i‡(
ª∂a˚_Êﬂt
 && 
	`°rög_ö_log_buf„r
 (
fûe
, "Using IEEEÑeplacement") == 0)

1245 { 
	`¥ötf
 ("\n\nLöê%d : Flﬂàª∂a˚míàcodênŸ w‹kög.\n\n", 
__LINE__
) ;

1246 
	`dump_log_buf„r
 (
fûe
) ;

1247 
	`exô
 (1) ;

1250 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

1251 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËM⁄ÿ: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__FILE__
, 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

1252 
	`exô
 (1) ;

1255 i‡(
sföfo
.
‰ames
 !
ôems
)

1256 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËM⁄ÿ: Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%d => %ld)\n", 
__FILE__
, 
__LINE__
, 
ôems
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

1257 
	`exô
 (1) ;

1260 i‡(
sföfo
.
ch™√ls
 != 1)

1261 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËM⁄ÿ: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__FILE__
, 
__LINE__
) ;

1262 
	`exô
 (1) ;

1265 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

1267 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
, 
ôems
, 
__LINE__
) ;

1269 
sign
 = -1, 
k
 = 0 ; k < 
ôems
 ; k++)

1270 { 
îr‹
 = 
	`Ábs
 (
d©a
 [
k
] - ((ËkË/ 100.0 * (
sign
 *= -1)) ;

1271 i‡(
	`Ábs
 (
d©a
 [
k
]Ë> 1e-100 && fab†(
îr‹
 / data [k]) > 1e-5)

1272 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËM⁄ÿ: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__FILE__
, 
__LINE__
, 
k
, ((ËkË/ 100.0, 
d©a
 [k]) ;

1273 
	`exô
 (1) ;

1278 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1280 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
, 4, 
__LINE__
) ;

1281 
k
 = 0 ; k < 4 ; k++)

1282 { 
îr‹
 = 
	`Ábs
 (
d©a
 [
k
] - ((ËkË/ 100.0 * (
sign
 *= -1)) ;

1283 i‡(
	`Ábs
 (
d©a
 [
k
]Ë> 1e-100 && fab†(
îr‹
 / data [k]) > 1e-5)

1284 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËM⁄ÿ: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__FILE__
, 
__LINE__
, 
k
, ((ËkË/ 100.0, 
d©a
 [k]) ;

1285 
	`exô
 (1) ;

1290 
	`ã°_£ek_‹_dõ
 (
fûe
, 10, 
SEEK_SET
, 10, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1292 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
 + 10, 4, 
__LINE__
) ;

1293 
k
 = 10 ; k < 14 ; k++)

1294 { 
îr‹
 = 
	`Ábs
 (
d©a
 [
k
] - ((ËkË/ 100.0 * (
sign
 *= -1)) ;

1295 i‡(
	`Ábs
 (
d©a
 [
k
]Ë> 1e-100 && fab†(
îr‹
 / data [k]) > 1e-5)

1296 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËM⁄ÿ: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__FILE__
, 
__LINE__
, 
k
, ((ËkË/ 100.0, 
d©a
 [k]) ;

1297 
	`exô
 (1) ;

1302 
	`ã°_£ek_‹_dõ
 (
fûe
, 6, 
SEEK_CUR
, 20, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1304 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
 + 20, 4, 
__LINE__
) ;

1305 
k
 = 20 ; k < 24 ; k++)

1306 { 
îr‹
 = 
	`Ábs
 (
d©a
 [
k
] - ((ËkË/ 100.0 * (
sign
 *= -1)) ;

1307 i‡(
	`Ábs
 (
d©a
 [
k
]Ë> 1e-100 && fab†(
îr‹
 / data [k]) > 1e-5)

1308 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËM⁄ÿ: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__FILE__
, 
__LINE__
, 
k
, ((ËkË/ 100.0, 
d©a
 [k]) ;

1309 
	`exô
 (1) ;

1314 
	`ã°_£ek_‹_dõ
 (
fûe
, -1 * (
sföfo
.
‰ames
 - 10), 
SEEK_END
, 10, sföfo.
ch™√ls
, 
__LINE__
) ;

1316 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
 + 10, 4, 
__LINE__
) ;

1317 
k
 = 10 ; k < 14 ; k++)

1318 { 
îr‹
 = 
	`Ábs
 (
d©a
 [
k
] - ((ËkË/ 100.0 * (
sign
 *= -1)) ;

1319 i‡(
	`Ábs
 (
d©a
 [
k
]Ë> 1e-100 && fab†(
îr‹
 / data [k]) > 1e-5)

1320 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËM⁄ÿ: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__FILE__
, 
__LINE__
, 
k
, ((ËkË/ 100.0, 
d©a
 [k]) ;

1321 
	`exô
 (1) ;

1325 
	`sf_˛o£
 (
fûe
) ;

1329 i‡((
fûëy≥
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_SVX
)

1330 { 
	`¥ötf
 ("ok\n") ;

1334 
ôems
 = 
BUFFER_SIZE
 ;

1336 
d©a
 = 
d©a_out
.
d
 ;

1337 
sign
 = -1, 
k
 = 0 ; k < 
ôems
 ; k++)

1338 
d©a
 [
k
] = ((ËkË/ 100.0 * (
sign
 *= -1) ;

1340 
sföfo
.
ßm∂î©e
 = 44100 ;

1341 
sföfo
.
‰ames
 = 
ôems
 ;

1342 
sföfo
.
ch™√ls
 = 2 ;

1343 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

1345 
‰ames
 = 
ôems
 / 
sföfo
.
ch™√ls
 ;

1347 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

1348 
	`sf_comm™d
 (
fûe
, 
SFC_TEST_IEEE_FLOAT_REPLACE
, 
NULL
, 
ª∂a˚_Êﬂt
) ;

1349 i‡(
ª∂a˚_Êﬂt
 && 
	`°rög_ö_log_buf„r
 (
fûe
, "Using IEEEÑeplacement") == 0)

1350 { 
	`¥ötf
 ("\n\nLöê%d : Flﬂàª∂a˚míàcodênŸ w‹kög.\n\n", 
__LINE__
) ;

1351 
	`dump_log_buf„r
 (
fûe
) ;

1352 
	`exô
 (1) ;

1355 
	`ã°_wrôef_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
, 
‰ames
, 
__LINE__
) ;

1357 
	`sf_˛o£
 (
fûe
) ;

1359 
	`check_fûe_hash_‹_dõ
 (
fûíame
, 
hash
, 
__LINE__
) ;

1361 
	`mem£t
 (
d©a
, 0, 
ôems
 *  ()) ;

1363 i‡((
fûëy≥
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

1364 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

1366 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

1367 
	`sf_comm™d
 (
fûe
, 
SFC_TEST_IEEE_FLOAT_REPLACE
, 
NULL
, 
ª∂a˚_Êﬂt
) ;

1368 i‡(
ª∂a˚_Êﬂt
 && 
	`°rög_ö_log_buf„r
 (
fûe
, "Using IEEEÑeplacement") == 0)

1369 { 
	`¥ötf
 ("\n\nLöê%d : Flﬂàª∂a˚míàcodênŸ w‹kög.\n\n", 
__LINE__
) ;

1370 
	`dump_log_buf„r
 (
fûe
) ;

1371 
	`exô
 (1) ;

1374 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

1375 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËSãªÿ: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__FILE__
, 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

1376 
	`exô
 (1) ;

1379 i‡(
sföfo
.
‰ames
 != frames)

1380 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËSãªÿ: Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%d => %ld)\n", 
__FILE__
, 
__LINE__
, 
‰ames
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.frames)) ;

1381 
	`exô
 (1) ;

1384 i‡(
sföfo
.
ch™√ls
 != 2)

1385 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËSãªÿ: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__FILE__
, 
__LINE__
) ;

1386 
	`exô
 (1) ;

1389 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

1391 
	`ã°_ªadf_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
, 
‰ames
, 
__LINE__
) ;

1392 
sign
 = -1, 
k
 = 0 ; k < 
ôems
 ; k++)

1393 { 
îr‹
 = 
	`Ábs
 (
d©a
 [
k
] - ((ËkË/ 100.0 * (
sign
 *= -1)) ;

1394 i‡(
	`Ábs
 (
d©a
 [
k
]Ë> 1e-100 && fab†(
îr‹
 / data [k]) > 1e-5)

1395 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËSãªÿ: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__FILE__
, 
__LINE__
, 
k
, ((ËkË/ 100.0, 
d©a
 [k]) ;

1396 
	`exô
 (1) ;

1401 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1403 
	`ã°_ªadf_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
, 4, 
__LINE__
) ;

1404 
k
 = 0 ; k < 4 ; k++)

1405 { 
îr‹
 = 
	`Ábs
 (
d©a
 [
k
] - ((ËkË/ 100.0 * (
sign
 *= -1)) ;

1406 i‡(
	`Ábs
 (
d©a
 [
k
]Ë> 1e-100 && fab†(
îr‹
 / data [k]) > 1e-5)

1407 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËSãªÿ: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__FILE__
, 
__LINE__
, 
k
, ((ËkË/ 100.0, 
d©a
 [k]) ;

1408 
	`exô
 (1) ;

1413 
	`ã°_£ek_‹_dõ
 (
fûe
, 10, 
SEEK_SET
, 10, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1415 
	`ã°_ªadf_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
 + 20, 2, 
__LINE__
) ;

1416 
k
 = 20 ; k < 24 ; k++)

1417 { 
îr‹
 = 
	`Ábs
 (
d©a
 [
k
] - ((ËkË/ 100.0 * (
sign
 *= -1)) ;

1418 i‡(
	`Ábs
 (
d©a
 [
k
]Ë> 1e-100 && fab†(
îr‹
 / data [k]) > 1e-5)

1419 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËSãªÿ: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__FILE__
, 
__LINE__
, 
k
, ((ËkË/ 100.0, 
d©a
 [k]) ;

1420 
	`exô
 (1) ;

1425 
	`ã°_£ek_‹_dõ
 (
fûe
, 8, 
SEEK_CUR
, 20, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1427 
	`ã°_ªadf_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
 + 40, 2, 
__LINE__
) ;

1428 
k
 = 40 ; k < 44 ; k++)

1429 { 
îr‹
 = 
	`Ábs
 (
d©a
 [
k
] - ((ËkË/ 100.0 * (
sign
 *= -1)) ;

1430 i‡(
	`Ábs
 (
d©a
 [
k
]Ë> 1e-100 && fab†(
îr‹
 / data [k]) > 1e-5)

1431 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËSãªÿ: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__FILE__
, 
__LINE__
, 
k
, ((ËkË/ 100.0, 
d©a
 [k]) ;

1432 
	`exô
 (1) ;

1437 
	`ã°_£ek_‹_dõ
 (
fûe
, -1 * (
sföfo
.
‰ames
 - 10), 
SEEK_END
, 10, sföfo.
ch™√ls
, 
__LINE__
) ;

1439 
	`ã°_ªadf_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
 + 20, 2, 
__LINE__
) ;

1440 
k
 = 20 ; k < 24 ; k++)

1441 { 
îr‹
 = 
	`Ábs
 (
d©a
 [
k
] - ((ËkË/ 100.0 * (
sign
 *= -1)) ;

1442 i‡(
	`Ábs
 (
d©a
 [
k
]Ë> 1e-100 && fab†(
îr‹
 / data [k]) > 1e-5)

1443 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËSãªÿ: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__FILE__
, 
__LINE__
, 
k
, ((ËkË/ 100.0, 
d©a
 [k]) ;

1444 
	`exô
 (1) ;

1448 
	`sf_˛o£
 (
fûe
) ;

1450 
	`¥ötf
 ("ok\n") ;

1451 
	`u∆ök
 (
fûíame
) ;

1452 
	}
}

1455 
	$pcm_ã°_doubÀ
 (c⁄° *
fûíame
, 
fûëy≥
, 
hash
, 
ª∂a˚_Êﬂt
)

1456 { 
SNDFILE
 *
fûe
 ;

1457 
SF_INFO
 
sföfo
 ;

1458 
k
, 
ôems
, 
‰ames
 ;

1459 
sign
 ;

1460 *
d©a
, 
îr‹
 ;

1464 
	`¥öt_ã°_«me
 ("pcm_ã°_doubÀ", 
fûíame
) ;

1466 
ôems
 = 
BUFFER_SIZE
 ;

1468 
d©a
 = 
d©a_out
.
d
 ;

1469 
sign
 = 1, 
k
 = 0 ; k < 
ôems
 ; k++)

1470 { 
d©a
 [
k
] = ((Ë(k * 
sign
)) / 100.0 ;

1471 
sign
 = (sign > 0) ? -1 : 1 ;

1474 
sföfo
.
ßm∂î©e
 = 44100 ;

1475 
sföfo
.
‰ames
 = 
ôems
 ;

1476 
sföfo
.
ch™√ls
 = 1 ;

1477 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

1479 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

1480 
	`sf_comm™d
 (
fûe
, 
SFC_TEST_IEEE_FLOAT_REPLACE
, 
NULL
, 
ª∂a˚_Êﬂt
) ;

1481 i‡(
ª∂a˚_Êﬂt
 && 
	`°rög_ö_log_buf„r
 (
fûe
, "Using IEEEÑeplacement") == 0)

1482 { 
	`¥ötf
 ("\n\nLöê%d : Flﬂàª∂a˚míàcodênŸ w‹kög.\n\n", 
__LINE__
) ;

1483 
	`dump_log_buf„r
 (
fûe
) ;

1484 
	`exô
 (1) ;

1487 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
, 
ôems
, 
__LINE__
) ;

1489 
	`sf_˛o£
 (
fûe
) ;

1491 #i‡(
	`deföed
 (
WIN32
Ë|| deföed (
_WIN32
))

1495 
hash
 = hash ;

1497 
	`check_fûe_hash_‹_dõ
 (
fûíame
, 
hash
, 
__LINE__
) ;

1500 
	`mem£t
 (
d©a
, 0, 
ôems
 *  ()) ;

1502 i‡((
fûëy≥
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

1503 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

1505 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

1506 
	`sf_comm™d
 (
fûe
, 
SFC_TEST_IEEE_FLOAT_REPLACE
, 
NULL
, 
ª∂a˚_Êﬂt
) ;

1507 i‡(
ª∂a˚_Êﬂt
 && 
	`°rög_ö_log_buf„r
 (
fûe
, "Using IEEEÑeplacement") == 0)

1508 { 
	`¥ötf
 ("\n\nLöê%d : Flﬂàª∂a˚míàcodênŸ w‹kög.\n\n", 
__LINE__
) ;

1509 
	`dump_log_buf„r
 (
fûe
) ;

1510 
	`exô
 (1) ;

1513 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

1514 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËM⁄ÿ: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__FILE__
, 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

1515 
	`exô
 (1) ;

1518 i‡(
sföfo
.
‰ames
 !
ôems
)

1519 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËM⁄ÿ: Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%d => %ld)\n", 
__FILE__
, 
__LINE__
, 
ôems
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

1520 
	`exô
 (1) ;

1523 i‡(
sföfo
.
ch™√ls
 != 1)

1524 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËM⁄ÿ: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__FILE__
, 
__LINE__
) ;

1525 
	`exô
 (1) ;

1528 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

1530 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
, 
ôems
, 
__LINE__
) ;

1532 
sign
 = -1, 
k
 = 0 ; k < 
ôems
 ; k++)

1533 { 
îr‹
 = 
	`Ábs
 (
d©a
 [
k
] - ((ËkË/ 100.0 * (
sign
 *= -1)) ;

1534 i‡(
	`Ábs
 (
d©a
 [
k
]Ë> 1e-100 && fab†(
îr‹
 / data [k]) > 1e-5)

1535 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËM⁄ÿ: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__FILE__
, 
__LINE__
, 
k
, ((ËkË/ 100.0, 
d©a
 [k]) ;

1536 
	`exô
 (1) ;

1541 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1543 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
, 4, 
__LINE__
) ;

1544 
k
 = 0 ; k < 4 ; k++)

1545 { 
îr‹
 = 
	`Ábs
 (
d©a
 [
k
] - ((ËkË/ 100.0 * (
sign
 *= -1)) ;

1546 i‡(
	`Ábs
 (
d©a
 [
k
]Ë> 1e-100 && fab†(
îr‹
 / data [k]) > 1e-5)

1547 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËM⁄ÿ: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__FILE__
, 
__LINE__
, 
k
, ((ËkË/ 100.0, 
d©a
 [k]) ;

1548 
	`exô
 (1) ;

1553 
	`ã°_£ek_‹_dõ
 (
fûe
, 10, 
SEEK_SET
, 10, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1555 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
 + 10, 4, 
__LINE__
) ;

1557 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_CUR
, 14, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1559 
k
 = 10 ; k < 14 ; k++)

1560 { 
îr‹
 = 
	`Ábs
 (
d©a
 [
k
] - ((ËkË/ 100.0 * (
sign
 *= -1)) ;

1561 i‡(
	`Ábs
 (
d©a
 [
k
]Ë> 1e-100 && fab†(
îr‹
 / data [k]) > 1e-5)

1562 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËM⁄ÿ: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__FILE__
, 
__LINE__
, 
k
, ((ËkË/ 100.0, 
d©a
 [k]) ;

1563 
	`exô
 (1) ;

1568 
	`ã°_£ek_‹_dõ
 (
fûe
, 6, 
SEEK_CUR
, 20, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1570 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
 + 20, 4, 
__LINE__
) ;

1571 
k
 = 20 ; k < 24 ; k++)

1572 { 
îr‹
 = 
	`Ábs
 (
d©a
 [
k
] - ((ËkË/ 100.0 * (
sign
 *= -1)) ;

1573 i‡(
	`Ábs
 (
d©a
 [
k
]Ë> 1e-100 && fab†(
îr‹
 / data [k]) > 1e-5)

1574 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËM⁄ÿ: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__FILE__
, 
__LINE__
, 
k
, ((ËkË/ 100.0, 
d©a
 [k]) ;

1575 
	`exô
 (1) ;

1580 
	`ã°_£ek_‹_dõ
 (
fûe
, -1 * (
sföfo
.
‰ames
 - 10), 
SEEK_END
, 10, sföfo.
ch™√ls
, 
__LINE__
) ;

1582 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
 + 10, 4, 
__LINE__
) ;

1583 
k
 = 10 ; k < 14 ; k++)

1584 { 
îr‹
 = 
	`Ábs
 (
d©a
 [
k
] - ((ËkË/ 100.0 * (
sign
 *= -1)) ;

1585 i‡(
	`Ábs
 (
d©a
 [
k
]Ë> 1e-100 && fab†(
îr‹
 / data [k]) > 1e-5)

1586 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËM⁄ÿ: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__FILE__
, 
__LINE__
, 
k
, ((ËkË/ 100.0, 
d©a
 [k]) ;

1587 
	`exô
 (1) ;

1591 
	`sf_˛o£
 (
fûe
) ;

1595 i‡((
fûëy≥
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_SVX
)

1596 { 
	`¥ötf
 ("ok\n") ;

1600 
ôems
 = 
BUFFER_SIZE
 ;

1602 
d©a
 = 
d©a_out
.
d
 ;

1603 
sign
 = -1, 
k
 = 0 ; k < 
ôems
 ; k++)

1604 
d©a
 [
k
] = ((ËkË/ 100.0 * (
sign
 *= -1) ;

1606 
sföfo
.
ßm∂î©e
 = 44100 ;

1607 
sföfo
.
‰ames
 = 
ôems
 ;

1608 
sföfo
.
ch™√ls
 = 2 ;

1609 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

1611 
‰ames
 = 
ôems
 / 
sföfo
.
ch™√ls
 ;

1613 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

1614 
	`sf_comm™d
 (
fûe
, 
SFC_TEST_IEEE_FLOAT_REPLACE
, 
NULL
, 
ª∂a˚_Êﬂt
) ;

1615 i‡(
ª∂a˚_Êﬂt
 && 
	`°rög_ö_log_buf„r
 (
fûe
, "Using IEEEÑeplacement") == 0)

1616 { 
	`¥ötf
 ("\n\nLöê%d : Flﬂàª∂a˚míàcodênŸ w‹kög.\n\n", 
__LINE__
) ;

1617 
	`dump_log_buf„r
 (
fûe
) ;

1618 
	`exô
 (1) ;

1621 
	`ã°_wrôef_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
, 
‰ames
, 
__LINE__
) ;

1623 
	`sf_˛o£
 (
fûe
) ;

1625 #i‡(
	`deföed
 (
WIN32
Ë|| deföed (
_WIN32
))

1629 
hash
 = hash ;

1631 
	`check_fûe_hash_‹_dõ
 (
fûíame
, 
hash
, 
__LINE__
) ;

1634 
	`mem£t
 (
d©a
, 0, 
ôems
 *  ()) ;

1636 i‡((
fûëy≥
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

1637 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

1639 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

1640 
	`sf_comm™d
 (
fûe
, 
SFC_TEST_IEEE_FLOAT_REPLACE
, 
NULL
, 
ª∂a˚_Êﬂt
) ;

1641 i‡(
ª∂a˚_Êﬂt
 && 
	`°rög_ö_log_buf„r
 (
fûe
, "Using IEEEÑeplacement") == 0)

1642 { 
	`¥ötf
 ("\n\nLöê%d : Flﬂàª∂a˚míàcodênŸ w‹kög.\n\n", 
__LINE__
) ;

1643 
	`dump_log_buf„r
 (
fûe
) ;

1644 
	`exô
 (1) ;

1647 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

1648 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËSãªÿ: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__FILE__
, 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

1649 
	`exô
 (1) ;

1652 i‡(
sföfo
.
‰ames
 != frames)

1653 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËSãªÿ: Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%d => %ld)\n", 
__FILE__
, 
__LINE__
, 
‰ames
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.frames)) ;

1654 
	`exô
 (1) ;

1657 i‡(
sföfo
.
ch™√ls
 != 2)

1658 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËSãªÿ: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__FILE__
, 
__LINE__
) ;

1659 
	`exô
 (1) ;

1662 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

1664 
	`ã°_ªadf_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
, 
‰ames
, 
__LINE__
) ;

1666 
sign
 = -1, 
k
 = 0 ; k < 
ôems
 ; k++)

1667 { 
îr‹
 = 
	`Ábs
 (
d©a
 [
k
] - ((ËkË/ 100.0 * (
sign
 *= -1)) ;

1668 i‡(
	`Ábs
 (
d©a
 [
k
]Ë> 1e-100 && fab†(
îr‹
 / data [k]) > 1e-5)

1669 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËSãªÿ: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__FILE__
, 
__LINE__
, 
k
, ((ËkË/ 100.0, 
d©a
 [k]) ;

1670 
	`exô
 (1) ;

1675 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1677 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
, 4, 
__LINE__
) ;

1678 
k
 = 0 ; k < 4 ; k++)

1679 { 
îr‹
 = 
	`Ábs
 (
d©a
 [
k
] - ((ËkË/ 100.0 * (
sign
 *= -1)) ;

1680 i‡(
	`Ábs
 (
d©a
 [
k
]Ë> 1e-100 && fab†(
îr‹
 / data [k]) > 1e-5)

1681 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËSãªÿ: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__FILE__
, 
__LINE__
, 
k
, ((ËkË/ 100.0, 
d©a
 [k]) ;

1682 
	`exô
 (1) ;

1687 
	`ã°_£ek_‹_dõ
 (
fûe
, 10, 
SEEK_SET
, 10, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1689 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
 + 10, 4, 
__LINE__
) ;

1690 
k
 = 20 ; k < 24 ; k++)

1691 { 
îr‹
 = 
	`Ábs
 (
d©a
 [
k
] - ((ËkË/ 100.0 * (
sign
 *= -1)) ;

1692 i‡(
	`Ábs
 (
d©a
 [
k
]Ë> 1e-100 && fab†(
îr‹
 / data [k]) > 1e-5)

1693 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËSãªÿ: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__FILE__
, 
__LINE__
, 
k
, ((ËkË/ 100.0, 
d©a
 [k]) ;

1694 
	`exô
 (1) ;

1699 
	`ã°_£ek_‹_dõ
 (
fûe
, 8, 
SEEK_CUR
, 20, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1701 
	`ã°_ªadf_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
 + 40, 4, 
__LINE__
) ;

1702 
k
 = 40 ; k < 44 ; k++)

1703 { 
îr‹
 = 
	`Ábs
 (
d©a
 [
k
] - ((ËkË/ 100.0 * (
sign
 *= -1)) ;

1704 i‡(
	`Ábs
 (
d©a
 [
k
]Ë> 1e-100 && fab†(
îr‹
 / data [k]) > 1e-5)

1705 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËSãªÿ: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__FILE__
, 
__LINE__
, 
k
, ((ËkË/ 100.0, 
d©a
 [k]) ;

1706 
	`exô
 (1) ;

1711 
	`ã°_£ek_‹_dõ
 (
fûe
, -1 * (
sföfo
.
‰ames
 -10), 
SEEK_END
, 10, sföfo.
ch™√ls
, 
__LINE__
) ;

1713 
	`ã°_ªadf_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
 + 20, 4, 
__LINE__
) ;

1714 
k
 = 20 ; k < 24 ; k++)

1715 { 
îr‹
 = 
	`Ábs
 (
d©a
 [
k
] - ((ËkË/ 100.0 * (
sign
 *= -1)) ;

1716 i‡(
	`Ábs
 (
d©a
 [
k
]Ë> 1e-100 && fab†(
îr‹
 / data [k]) > 1e-5)

1717 { 
	`¥ötf
 ("\n\nEº‹ (%s:%dËSãªÿ: Inc‹ª˘ sam∂ê(#%d : %‡=> %f).\n", 
__FILE__
, 
__LINE__
, 
k
, ((ËkË/ 100.0, 
d©a
 [k]) ;

1718 
	`exô
 (1) ;

1722 
	`sf_˛o£
 (
fûe
) ;

1724 
	`¥ötf
 ("ok\n") ;

1725 
	`u∆ök
 (
fûíame
) ;

1726 
	}
}

	@libsndfile-1.0.17/tests/peak_chunk_test.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

24 
	~<m©h.h
>

26 #i‡
HAVE_UNISTD_H


27 
	~<uni°d.h
>

30 
	~<¢dfûe.h
>

32 
	~"utûs.h
"

34 
	#BUFFER_LEN
 (1<<15)

	)

35 
	#LOG_BUFFER_SIZE
 1024

	)

38 
ã°_Êﬂt_≥ak
 (c⁄° *
fûíame
, 
fûëy≥
) ;

40 
check_logged_≥aks
 (*
buf„r
) ;

45 
	gd©a
 [
BUFFER_LEN
] ;

46 
	glog_buf„r
 [
LOG_BUFFER_SIZE
] ;

49 
	$maö
 (
¨gc
, *
¨gv
 [])

50 { 
do_Æl
 = 0 ;

51 
ã°_cou¡
 = 0 ;

53 i‡(
¨gc
 != 2)

54 { 
	`¥ötf
 ("Ußgê: %†<ã°>\n", 
¨gv
 [0]) ;

55 
	`¥ötf
 (" Where <test> is one ofÅhe following:\n") ;

56 
	`¥ötf
 (" wav -Åest WAV fileÖeak chunk\n") ;

57 
	`¥ötf
 ("áiff -Åest AIFF file PEAK chunk\n") ;

58 
	`¥ötf
 ("áll -ÖerformállÅests\n") ;

59 
	`exô
 (1) ;

62 
do_Æl
=!
	`°rcmp
 (
¨gv
 [1], "all") ;

64 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "wav"))

65 { 
	`ã°_Êﬂt_≥ak
 ("≥ak_Êﬂt.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_FLOAT
) ;

66 
	`ã°_Êﬂt_≥ak
 ("≥ak_Êﬂt.wavex", 
SF_FORMAT_WAVEX
 | 
SF_FORMAT_FLOAT
) ;

67 
	`ã°_Êﬂt_≥ak
 ("≥ak_Êﬂt.rifx", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_FLOAT
) ;

68 
ã°_cou¡
++ ;

71 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "aiff"))

72 { 
	`ã°_Êﬂt_≥ak
 ("≥ak_Êﬂt.aiff", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_FLOAT
) ;

73 
ã°_cou¡
++ ;

76 i‡(
ã°_cou¡
 == 0)

77 { 
	`¥ötf
 ("Mono : ************************************\n") ;

78 
	`¥ötf
 ("M⁄ÿ: * Nÿ'%s'Åe° deföed.\n", 
¨gv
 [1]) ;

79 
	`¥ötf
 ("Mono : ************************************\n") ;

84 
	}
}

91 
	$ã°_Êﬂt_≥ak
 (c⁄° *
fûíame
, 
fûëy≥
)

92 { 
SNDFILE
 *
fûe
 ;

93 
SF_INFO
 
sföfo
 ;

94 
k
, 
‰ames
, 
cou¡
 ;

96 
	`¥öt_ã°_«me
 ("ã°_Êﬂt_≥ak", 
fûíame
) ;

98 
sföfo
.
ßm∂î©e
 = 44100 ;

99 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

100 
sföfo
.
ch™√ls
 = 4 ;

101 
sföfo
.
‰ames
 = 0 ;

103 
‰ames
 = 
BUFFER_LEN
 / 
sföfo
.
ch™√ls
 ;

106 
k
 = 0 ; k < 
BUFFER_LEN
 ; k++)

107 
d©a
 [
k
] = (
	`ønd
 () % 2000) / 3000.0 ;

110 
d©a
 [4 * (
‰ames
 / 8) + 0] = (frames / 8) * 0.01 ;

111 
d©a
 [4 * (
‰ames
 / 6) + 1] = (frames / 6) * 0.01 ;

112 
d©a
 [4 * (
‰ames
 / 4) + 2] = (frames / 4) * 0.01 ;

113 
d©a
 [4 * (
‰ames
 / 2) + 3] = (frames / 2) * 0.01 ;

116 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 0, 
__LINE__
) ;

119 
	`sf_comm™d
 (
fûe
, 
SFC_SET_ADD_PEAK_CHUNK
, 
NULL
, 
SF_TRUE
) ;

120 
	`sf_comm™d
 (
fûe
, 
SFC_SET_ADD_PEAK_CHUNK
, 
NULL
, 
SF_FALSE
) ;

121 
	`sf_comm™d
 (
fûe
, 
SFC_SET_ADD_PEAK_CHUNK
, 
NULL
, 
SF_TRUE
) ;

126 
cou¡
 = 0 ; count < 4 ; count ++)

127 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
 + 
cou¡
 * 
BUFFER_LEN
 / 4, BUFFER_LEN / 4, BUFFER_LEN / 4) ;

129 
	`sf_˛o£
 (
fûe
) ;

131 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 0, 
__LINE__
) ;

133 i‡(
sföfo
.
f‹m©
 !
fûëy≥
)

134 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

135 
	`exô
 (1) ;

138 i‡(
sföfo
.
‰ames
 != frames)

139 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%d => %ld)\n", 
__LINE__
, 
‰ames
, (Ë
sföfo
.frames) ;

140 
	`exô
 (1) ;

143 i‡(
sföfo
.
ch™√ls
 != 4)

144 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

145 
	`exô
 (1) ;

149 i‡(
	`sf_comm™d
 (
fûe
, 
SFC_GET_SIGNAL_MAX
, 
d©a
,  ()Ë=
SF_FALSE
)

150 { 
	`¥ötf
 ("\n\nLöê%d: Comm™d should havêªtu∫ed SF_TRUE.\n", 
__LINE__
) ;

151 
	`exô
 (1) ;

154 i‡(
	`Ábs
 (
d©a
 [0] - (
‰ames
 / 2) * 0.01) > 0.01)

155 { 
	`¥ötf
 ("\n\nLöê%d: BadÖók vÆuê(%‡should bê%fËf‹ comm™d SFC_GET_SIGNAL_MAX.\n", 
__LINE__
, 
d©a
 [0], (
‰ames
 / 2) * 0.01) ;

156 
	`exô
 (1) ;

159 i‡(
	`sf_comm™d
 (
fûe
, 
SFC_GET_MAX_ALL_CHANNELS
, 
d©a
,  (Ë* 
sföfo
.
ch™√ls
Ë=
SF_FALSE
)

160 { 
	`¥ötf
 ("\n\nLöê%d: Comm™d should havêªtu∫ed SF_TRUE.\n", 
__LINE__
) ;

161 
	`exô
 (1) ;

164 i‡(
	`Ábs
 (
d©a
 [3] - (
‰ames
 / 2) * 0.01) > 0.01)

165 { 
	`¥ötf
 ("\n\nLöê%d: BadÖók vÆuê(%‡should bê%fËf‹ comm™d SFC_GET_MAX_ALL_CHANNELS.\n", 
__LINE__
, 
d©a
 [0], (
‰ames
 / 2) * 0.01) ;

166 
	`exô
 (1) ;

170 
log_buf„r
 [0] = 0 ;

171 
	`sf_comm™d
 (
fûe
, 
SFC_GET_LOG_INFO
, 
log_buf„r
, 
LOG_BUFFER_SIZE
) ;

173 i‡(
	`°æí
 (
log_buf„r
) == 0)

174 { 
	`¥ötf
 ("\n\nLöê%d: Em±yÜog buf„r,\n", 
__LINE__
) ;

175 
	`exô
 (1) ;

178 
	`check_logged_≥aks
 (
log_buf„r
) ;

180 
	`sf_˛o£
 (
fûe
) ;

183 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 0, 
__LINE__
) ;

186 
	`sf_comm™d
 (
fûe
, 
SFC_SET_ADD_PEAK_CHUNK
, 
NULL
, 
SF_FALSE
) ;

187 
	`sf_comm™d
 (
fûe
, 
SFC_SET_ADD_PEAK_CHUNK
, 
NULL
, 
SF_TRUE
) ;

188 
	`sf_comm™d
 (
fûe
, 
SFC_SET_ADD_PEAK_CHUNK
, 
NULL
, 
SF_FALSE
) ;

193 
cou¡
 = 0 ; count < 4 ; count ++)

194 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a
 + 
cou¡
 * 
BUFFER_LEN
 / 4, BUFFER_LEN / 4, BUFFER_LEN / 4) ;

196 
	`sf_˛o£
 (
fûe
) ;

198 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 0, 
__LINE__
) ;

201 i‡(
	`sf_comm™d
 (
fûe
, 
SFC_GET_SIGNAL_MAX
, 
d©a
,  ()))

202 { 
	`¥ötf
 ("\n\nLöê%d: Comm™d should havêªtu∫ed SF_FALSE.\n", 
__LINE__
) ;

203 
	`exô
 (1) ;

206 i‡(
	`sf_comm™d
 (
fûe
, 
SFC_GET_MAX_ALL_CHANNELS
, 
d©a
,  (Ë* 
sföfo
.
ch™√ls
))

207 { 
	`¥ötf
 ("\n\nLöê%d: Comm™d should havêªtu∫ed SF_FALSE.\n", 
__LINE__
) ;

208 
	`exô
 (1) ;

212 
log_buf„r
 [0] = 0 ;

213 
	`sf_comm™d
 (
fûe
, 
SFC_GET_LOG_INFO
, 
log_buf„r
, 
LOG_BUFFER_SIZE
) ;

215 i‡(
	`°æí
 (
log_buf„r
) == 0)

216 { 
	`¥ötf
 ("\n\nLöê%d: Em±yÜog buf„r,\n", 
__LINE__
) ;

217 
	`exô
 (1) ;

220 i‡(
	`°r°r
 (
log_buf„r
, "PEAK :"Ë!
NULL
)

221 { 
	`¥ötf
 ("\n\nLöê%d: ShouldÇŸ havê®PEAK chunk i¿thi†fûe.\n\n", 
__LINE__
) ;

222 
	`puts
 (
log_buf„r
) ;

223 
	`exô
 (1) ;

226 
	`sf_˛o£
 (
fûe
) ;

228 
	`u∆ök
 (
fûíame
) ;

229 
	`¥ötf
 ("ok\n") ;

230 
	}
}

233 
	$check_logged_≥aks
 (*
buf„r
)

234 { *
˝å
 ;

235 
k
, 
ch™
, 
ch™√l_cou¡
, 
posôi⁄
 ;

236 
vÆue
 ;

238 i‡(
	`°r°r
 (
buf„r
, "should") || strstr (buffer, "*"))

239 { 
	`¥ötf
 ("\n\nLöê%d: Somëhög wr⁄g i¿buf„r. Dumpög.\n", 
__LINE__
) ;

240 
	`puts
 (
buf„r
) ;

241 
	`exô
 (1) ;

244 i‡(! (
˝å
 = 
	`°r°r
 (
buf„r
, "Ch™√ls")Ë|| 
	`ssˇnf
 (˝å, "Ch™√l† : %d", &
ch™√l_cou¡
) != 1)

245 { 
	`¥ötf
 ("\n\nLöê%d: Couldn'àföd ch™√»cou¡.\n", 
__LINE__
) ;

246 
	`exô
 (1) ;

249 i‡(
ch™√l_cou¡
 != 4)

250 { 
	`¥ötf
 ("\n\nLöê%d: Wr⁄g ch™√»cou¡ (4 ->%d).\n", 
__LINE__
, 
ch™√l_cou¡
) ;

251 
	`exô
 (1) ;

254 i‡(! (
˝å
 = 
	`°r°r
 (
buf„r
, "Ch Position Value")))

255 { 
	`¥ötf
 ("\n\nLöê%d: C™'àföd PEAK d©a.\n", 
__LINE__
) ;

256 
	`exô
 (1) ;

259 
k
 = 0 ; k < 
ch™√l_cou¡
 ; k++)

260 { i‡(! (
˝å
 = 
	`°rchr
 (cptr, '\n')))

261 { 
	`¥ötf
 ("\n\nLöê%d: GŸÜo°.\n", 
__LINE__
) ;

262 
	`exô
 (1) ;

264 i‡(
	`ssˇnf
 (
˝å
, "%d %d %f", &
ch™
, &
posôi⁄
, &
vÆue
) != 3)

265 { 
	`¥ötf
 ("\n\nLöê%d: ssˇn‡Áûed.\n", 
__LINE__
) ;

266 
	`exô
 (1) ;

268 i‡(
posôi⁄
 == 0)

269 { 
	`¥ötf
 ("\n\nLöê%d:ÖókÖosôi⁄ f‹ ch™√»%d shouldÇŸ bê© off£à0.\n", 
__LINE__
, 
ch™
) ;

270 
	`¥ötf
 (
buf„r
) ;

271 
	`exô
 (1) ;

273 i‡(
ch™
 !
k
 || 
	`Ábs
 ((
posôi⁄
Ë* 0.01 - 
vÆue
) > 1e-6)

274 { 
	`¥ötf
 ("\n\nLöê%d: Eº‹ :Öók vÆuêöc‹ª˘!\n", 
__LINE__
) ;

275 
	`¥ötf
 (
buf„r
) ;

276 
	`¥ötf
 ("\n\nLöê%d: %d %‡%f\n", 
__LINE__
, 
ch™
, 
posôi⁄
 * 0.01, 
vÆue
) ;

277 
	`exô
 (1) ;

279 
˝å
 ++ ;

282 
	}
}

	@libsndfile-1.0.17/tests/pipe_test.c

23 
	~"sfc⁄fig.h
"

25 
	~<°dio.h
>

26 
	~<°dlib.h
>

27 
	~<°rög.h
>

29 #i‡(
OS_IS_WIN32
)

32 
	$maö
 ()

34 
	`puts
 ("Öipe_test :ÅhisÅest doesn't work on win32.") ;

36 
	}
}

40 #i‡
HAVE_UNISTD_H


41 
	~<uni°d.h
>

44 
	~<sys/ty≥s.h
>

45 
	~<sys/°©.h
>

46 
	~<sys/waô.h
>

48 
	~<¢dfûe.h
>

50 
	~"utûs.h
"

53 { 
	mf‹m©
 ;

54 c⁄° *
	mext
 ;

55 } 
	tFILETYPE
 ;

57 
fûe_exi°s
 (c⁄° *
fûíame
) ;

58 
u£ek_pùe_rw_ã°
 (
fûëy≥
, c⁄° *
ext
) ;

59 
pùe_ªad_ã°
 (
fûëy≥
, c⁄° *
ext
) ;

60 
pùe_wrôe_ã°
 (c⁄° *
ext
) ;

61 
pùe_ã°_Ÿhîs
 (
FILETYPE
*, FILETYPE*) ;

63 
FILETYPE
 
	gªad_wrôe_ty≥s
 [] =

64 { { 
SF_FORMAT_RAW
 , "raw" },

65 { 
SF_FORMAT_AU
 , "au" },

67 { 
SF_FORMAT_PAF
 , "paf" },

68 { 
SF_FORMAT_IRCAM
 , "ircam" },

69 { 
SF_FORMAT_PVF
 , "pvf" },

71 { 0 , 
NULL
 }

74 
FILETYPE
 
	gªad_⁄ly_ty≥s
 [] =

75 { { 
SF_FORMAT_RAW
 , "raw" },

76 { 
SF_FORMAT_AU
 , "au" },

77 { 
SF_FORMAT_AIFF
 , "aiff" },

78 { 
SF_FORMAT_WAV
 , "wav" },

79 { 
SF_FORMAT_W64
 , "w64" },

81 { 
SF_FORMAT_PAF
 , "paf" },

82 { 
SF_FORMAT_NIST
 , "nist" },

83 { 
SF_FORMAT_IRCAM
 , "ircam" },

84 { 
SF_FORMAT_MAT4
 , "mat4" },

85 { 
SF_FORMAT_MAT5
 , "mat5" },

86 { 
SF_FORMAT_SVX
 , "svx" },

87 { 
SF_FORMAT_PVF
 , "pvf" },

89 { 0 , 
NULL
 }

93 
	$maö
 ()

94 { 
k
 ;

96 i‡(
	`fûe_exi°s
 ("libsndfile.spec.in"))

97 
	`chdú
 ("tests") ;

99 
k
 = 0 ; 
ªad_⁄ly_ty≥s
 [k].
f‹m©
 ; k++)

100 
	`pùe_ªad_ã°
 (
ªad_⁄ly_ty≥s
 [
k
].
f‹m©
,Ñód_⁄ly_ty≥†[k].
ext
) ;

102 
k
 = 0 ; 
ªad_wrôe_ty≥s
 [k].
f‹m©
 ; k++)

103 
	`pùe_wrôe_ã°
 (
ªad_wrôe_ty≥s
 [
k
].
ext
) ;

105 
k
 = 0 ; 
ªad_wrôe_ty≥s
 [k].
f‹m©
 ; k++)

106 
	`u£ek_pùe_rw_ã°
 (
ªad_wrôe_ty≥s
 [
k
].
f‹m©
,Ñód_wrôe_ty≥†[k].
ext
) ;

109 
	`pùe_ã°_Ÿhîs
 (
ªad_wrôe_ty≥s
, 
ªad_⁄ly_ty≥s
) ;

112 
	}
}

118 
	$pùe_ªad_ã°
 (
fûëy≥
, c⁄° *
ext
)

119 { 
d©a
 [
PIPE_TEST_LEN
] ;

120 
buf„r
 [256] ;

121 
fûíame
 [256] ;

123 
SNDFILE
 *
outfûe
 ;

124 
SF_INFO
 
sföfo
 ;

125 
k
, 
ªtvÆ
 ;

127 
	`¢¥ötf
 (
fûíame
,  (fûíame), "pùe_ö.%s", 
ext
) ;

128 
	`¥öt_ã°_«me
 ("pùe_ªad_ã°", 
fûíame
) ;

130 
sföfo
.
f‹m©
 = 
fûëy≥
 | 
SF_FORMAT_PCM_16
 ;

131 
sföfo
.
ch™√ls
 = 1 ;

132 
sföfo
.
ßm∂î©e
 = 44100 ;

134 
k
 = 0 ; k < 
PIPE_TEST_LEN
 ; k++)

135 
d©a
 [
k
] = 
	`PIPE_INDEX
 (k) ;

137 
outfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

138 
	`ã°_wrôef_sh‹t_‹_dõ
 (
outfûe
, 0, 
d©a
, 
PIPE_TEST_LEN
, 
__LINE__
) ;

139 
	`sf_˛o£
 (
outfûe
) ;

141 
	`¢¥ötf
 (
buf„r
,  (buf„r), "ˇà%†| ./°dö_ã° %†", 
fûíame
, 
ext
) ;

142 i‡((
ªtvÆ
 = 
	`sy°em
 (
buf„r
)) != 0)

143 { 
ªtvÆ
 = 
	`WEXITSTATUS
 (retval) ;

144 
	`¥ötf
 ("\n\¿ Löê%d :Öùêã°Ñëu∫edÉº‹ f‹ fûêty≥ \"%s\".\n\n", 
__LINE__
, 
ext
) ;

145 
	`exô
 (
ªtvÆ
) ;

148 
	`u∆ök
 (
fûíame
) ;

149 
	`puts
 ("ok") ;

152 
	}
}

155 
	$pùe_wrôe_ã°
 (c⁄° *
ext
)

156 { 
buf„r
 [256] ;

158 
ªtvÆ
 ;

160 
	`¥öt_ã°_«me
 ("pùe_wrôe_ã°", 
ext
) ;

162 
	`¢¥ötf
 (
buf„r
,  (buf„r), "./°dout_ã° %†| ./°dö_ã° %†", 
ext
,Éxt) ;

163 i‡((
ªtvÆ
 = 
	`sy°em
 (
buf„r
)))

164 { 
ªtvÆ
 = 
	`WEXITSTATUS
 (retval) ;

165 
	`¥ötf
 ("\n\¿ Löê%d :Öùêã°Ñëu∫edÉº‹ fûêty≥ \"%s\".\n\n", 
__LINE__
, 
ext
) ;

166 
	`exô
 (
ªtvÆ
) ;

169 
	`puts
 ("ok") ;

172 
	}
}

179 
	$u£ek_pùe_rw_sh‹t
 (c⁄° * 
ext
, 
SF_INFO
 * 
psföfo_wrôe
, SF_INFO * 
psföfo_ªad
)

180 { 
buf„r
 [
PIPE_TEST_LEN
] ;

181 
d©a
 [
PIPE_TEST_LEN
] ;

182 
SNDFILE
 *
outfûe
 ;

183 
SNDFILE
 *
öfûe_pùed
 ;

185 
k
, 
°©us
 = 0 ;

186 
pùefd
 [2] ;

187 
pid_t
 
pida
 ;

189 
k
 = 0 ; k < 
PIPE_TEST_LEN
 ; k++)

190 
d©a
 [
k
] = 
	`PIPE_INDEX
 (k) ;

195 
	`pùe
 (
pùefd
) ;

200 i‡((
outfûe
 = 
	`sf_›í_fd
 (
pùefd
 [1], 
SFM_WRITE
, 
psföfo_wrôe
, 
SF_TRUE
)Ë=
NULL
)

201 { 
	`¥ötf
 ("\n\n%†%d : u«bÀÅÿ¸óã un£ekabÀÖùêf‹ wrôêty≥ \"%s\".\n", 
__func__
, 
__LINE__
, 
ext
) ;

202 
	`¥ötf
 ("\t%s\n\n", 
	`sf_°ªº‹
 (
outfûe
)) ;

203 
	`exô
 (1) ;

206 i‡(
	`sf_îr‹
 (
outfûe
Ë!
SF_ERR_NO_ERROR
)

207 { 
	`¥ötf
 ("\n\n%†%d : u«bÀÅÿ›í un£ekabÀÖùêf‹ wrôêty≥ \"%s\".\n\n", 
__func__
, 
__LINE__
, 
ext
) ;

208 
	`exô
 (1) ;

214 i‡((
öfûe_pùed
 = 
	`sf_›í_fd
 (
pùefd
 [0], 
SFM_READ
, 
psföfo_ªad
, 
SF_TRUE
)Ë=
NULL
)

215 { 
	`¥ötf
 ("\n\n%†%d : u«bÀÅÿ¸óã un£ekabÀÖùêf‹ÑódÅy≥. \"%s\".\n\n", 
__func__
, 
__LINE__
, 
ext
) ;

216 
	`exô
 (1) ;

219 i‡(
	`sf_îr‹
 (
öfûe_pùed
Ë!
SF_ERR_NO_ERROR
)

220 { 
	`¥ötf
 ("\n\n%†%d : u«bÀÅÿ›í un£ekabÀÖùêf‹ÑódÅy≥ \"%s\".\n\n", 
__func__
, 
__LINE__
, 
ext
) ;

221 
	`exô
 (1) ;

225 i‡((
pida
 = 
	`f‹k
 ()) == 0)

226 { 
	`ã°_wrôef_sh‹t_‹_dõ
 (
outfûe
, 0, 
d©a
, 
PIPE_TEST_LEN
, 
__LINE__
) ;

227 
	`exô
 (0) ;

233 
	`ã°_ªadf_sh‹t_‹_dõ
 (
öfûe_pùed
, 0, 
buf„r
, 
PIPE_TEST_LEN
, 
__LINE__
) ;

234 i‡(
	`memcmp
 (
buf„r
, 
d©a
,  (buffer)) != 0)

235 { 
	`¥ötf
 ("\n\n%†%d : un£ekabÀÖùêã° faûed f‹ fûêty≥ \"%s\".\n\n", 
__func__
, 
__LINE__
, 
ext
) ;

236 
	`exô
 (1) ;

240 
	`waôpid
 (
pida
, &
°©us
, 0) ;

241 
°©us
 = 
	`WEXITSTATUS
 (status) ;

242 
	`sf_˛o£
 (
outfûe
) ;

243 
	`sf_˛o£
 (
öfûe_pùed
) ;

245 i‡(
°©us
 != 0)

246 { 
	`¥ötf
 ("\n\n%†%d : sètu†o‡chûdÖro˚s†i†%d f‹ fûêty≥ %s.\n\n", 
__func__
, 
__LINE__
, 
°©us
, 
ext
) ;

247 
	`exô
 (1) ;

251 
	}
}

255 
	$u£ek_pùe_rw_Êﬂt
 (c⁄° * 
ext
, 
SF_INFO
 * 
psföfo_wrôe
, SF_INFO * 
psföfo_ªad
)

256 { 
buf„r
 [
PIPE_TEST_LEN
] ;

257 
d©a
 [
PIPE_TEST_LEN
] ;

258 
SNDFILE
 *
outfûe
 ;

259 
SNDFILE
 *
öfûe_pùed
 ;

261 
k
, 
°©us
 = 0 ;

262 
pùefd
 [2] ;

263 
pid_t
 
pida
 ;

265 
k
 = 0 ; k < 
PIPE_TEST_LEN
 ; k++)

266 
d©a
 [
k
] = 
	`PIPE_INDEX
 (k) ;

271 
	`pùe
 (
pùefd
) ;

276 i‡((
outfûe
 = 
	`sf_›í_fd
 (
pùefd
 [1], 
SFM_WRITE
, 
psföfo_wrôe
, 
SF_TRUE
)Ë=
NULL
)

277 { 
	`¥ötf
 ("\n\n%†%d : u«bÀÅÿ¸óã un£ekabÀÖùêf‹ wrôêty≥ \"%s\".\n", 
__func__
, 
__LINE__
, 
ext
) ;

278 
	`¥ötf
 ("\t%s\n\n", 
	`sf_°ªº‹
 (
outfûe
)) ;

279 
	`exô
 (1) ;

282 i‡(
	`sf_îr‹
 (
outfûe
Ë!
SF_ERR_NO_ERROR
)

283 { 
	`¥ötf
 ("\n\n%†%d : u«bÀÅÿ›í un£ekabÀÖùêf‹ wrôêty≥ \"%s\".\n\n", 
__func__
, 
__LINE__
, 
ext
) ;

284 
	`exô
 (1) ;

290 i‡((
öfûe_pùed
 = 
	`sf_›í_fd
 (
pùefd
 [0], 
SFM_READ
, 
psföfo_ªad
, 
SF_TRUE
)Ë=
NULL
)

291 { 
	`¥ötf
 ("\n\n%†%d : u«bÀÅÿ¸óã un£ekabÀÖùêf‹ÑódÅy≥. \"%s\".\n\n", 
__func__
, 
__LINE__
, 
ext
) ;

292 
	`exô
 (1) ;

295 i‡(
	`sf_îr‹
 (
öfûe_pùed
Ë!
SF_ERR_NO_ERROR
)

296 { 
	`¥ötf
 ("\n\n%†%d : u«bÀÅÿ›í un£ekabÀÖùêf‹ÑódÅy≥ \"%s\".\n\n", 
__func__
, 
__LINE__
, 
ext
) ;

297 
	`exô
 (1) ;

301 i‡((
pida
 = 
	`f‹k
 ()) == 0)

302 { 
	`ã°_wrôef_Êﬂt_‹_dõ
 (
outfûe
, 0, 
d©a
, 
PIPE_TEST_LEN
, 
__LINE__
) ;

303 
	`exô
 (0) ;

309 
	`ã°_ªadf_Êﬂt_‹_dõ
 (
öfûe_pùed
, 0, 
buf„r
, 
PIPE_TEST_LEN
, 
__LINE__
) ;

310 i‡(
	`memcmp
 (
buf„r
, 
d©a
,  (buffer)) != 0)

311 { 
	`¥ötf
 ("\n\n%†%d : un£ekabÀÖùêã° faûed f‹ fûêty≥ \"%s\".\n\n", 
__func__
, 
__LINE__
, 
ext
) ;

312 
	`exô
 (1) ;

316 
	`waôpid
 (
pida
, &
°©us
, 0) ;

317 
°©us
 = 
	`WEXITSTATUS
 (status) ;

318 
	`sf_˛o£
 (
outfûe
) ;

319 
	`sf_˛o£
 (
öfûe_pùed
) ;

321 i‡(
°©us
 != 0)

322 { 
	`¥ötf
 ("\n\n%†%d : sètu†o‡chûdÖro˚s†i†%d f‹ fûêty≥ %s.\n\n", 
__func__
, 
__LINE__
, 
°©us
, 
ext
) ;

323 
	`exô
 (1) ;

327 
	}
}

331 
	$u£ek_pùe_rw_doubÀ
 (c⁄° * 
ext
, 
SF_INFO
 * 
psföfo_wrôe
, SF_INFO * 
psföfo_ªad
)

332 { 
buf„r
 [
PIPE_TEST_LEN
] ;

333 
d©a
 [
PIPE_TEST_LEN
] ;

334 
SNDFILE
 *
outfûe
 ;

335 
SNDFILE
 *
öfûe_pùed
 ;

337 
k
, 
°©us
 = 0 ;

338 
pùefd
 [2] ;

339 
pid_t
 
pida
 ;

341 
k
 = 0 ; k < 
PIPE_TEST_LEN
 ; k++)

342 
d©a
 [
k
] = 
	`PIPE_INDEX
 (k) ;

347 
	`pùe
 (
pùefd
) ;

352 i‡((
outfûe
 = 
	`sf_›í_fd
 (
pùefd
 [1], 
SFM_WRITE
, 
psföfo_wrôe
, 
SF_TRUE
)Ë=
NULL
)

353 { 
	`¥ötf
 ("\n\n%†%d : u«bÀÅÿ¸óã un£ekabÀÖùêf‹ wrôêty≥ \"%s\".\n", 
__func__
, 
__LINE__
, 
ext
) ;

354 
	`¥ötf
 ("\t%s\n\n", 
	`sf_°ªº‹
 (
outfûe
)) ;

355 
	`exô
 (1) ;

358 i‡(
	`sf_îr‹
 (
outfûe
Ë!
SF_ERR_NO_ERROR
)

359 { 
	`¥ötf
 ("\n\n%†%d : u«bÀÅÿ›í un£ekabÀÖùêf‹ wrôêty≥ \"%s\".\n\n", 
__func__
, 
__LINE__
, 
ext
) ;

360 
	`exô
 (1) ;

366 i‡((
öfûe_pùed
 = 
	`sf_›í_fd
 (
pùefd
 [0], 
SFM_READ
, 
psföfo_ªad
, 
SF_TRUE
)Ë=
NULL
)

367 { 
	`¥ötf
 ("\n\n%†%d : u«bÀÅÿ¸óã un£ekabÀÖùêf‹ÑódÅy≥. \"%s\".\n\n", 
__func__
, 
__LINE__
, 
ext
) ;

368 
	`exô
 (1) ;

371 i‡(
	`sf_îr‹
 (
öfûe_pùed
Ë!
SF_ERR_NO_ERROR
)

372 { 
	`¥ötf
 ("\n\n%†%d : u«bÀÅÿ›í un£ekabÀÖùêf‹ÑódÅy≥ \"%s\".\n\n", 
__func__
, 
__LINE__
, 
ext
) ;

373 
	`exô
 (1) ;

377 i‡((
pida
 = 
	`f‹k
 ()) == 0)

378 { 
	`ã°_wrôef_doubÀ_‹_dõ
 (
outfûe
, 0, 
d©a
, 
PIPE_TEST_LEN
, 
__LINE__
) ;

379 
	`exô
 (0) ;

385 
	`ã°_ªadf_doubÀ_‹_dõ
 (
öfûe_pùed
, 0, 
buf„r
, 
PIPE_TEST_LEN
, 
__LINE__
) ;

386 i‡(
	`memcmp
 (
buf„r
, 
d©a
,  (buffer)) != 0)

387 { 
	`¥ötf
 ("\n\n%†%d : un£ekabÀÖùêã° faûed f‹ fûêty≥ \"%s\".\n\n", 
__func__
, 
__LINE__
, 
ext
) ;

388 
	`exô
 (1) ;

392 
	`waôpid
 (
pida
, &
°©us
, 0) ;

393 
°©us
 = 
	`WEXITSTATUS
 (status) ;

394 
	`sf_˛o£
 (
outfûe
) ;

395 
	`sf_˛o£
 (
öfûe_pùed
) ;

397 i‡(
°©us
 != 0)

398 { 
	`¥ötf
 ("\n\n%†%d : sètu†o‡chûdÖro˚s†i†%d f‹ fûêty≥ %s.\n\n", 
__func__
, 
__LINE__
, 
°©us
, 
ext
) ;

399 
	`exô
 (1) ;

403 
	}
}

409 
	$u£ek_pùe_rw_ã°
 (
fûëy≥
, c⁄° *
ext
)

410 { 
SF_INFO
 
sföfo_wrôe
 ;

411 
SF_INFO
 
sföfo_ªad
 ;

413 
	`¥öt_ã°_«me
 ("u£ek_pùe_rw_ã°", 
ext
) ;

419 
sföfo_wrôe
.
f‹m©
 = 
fûëy≥
 | 
SF_FORMAT_PCM_16
 ;

420 
sföfo_wrôe
.
ch™√ls
 = 1 ;

421 
sföfo_wrôe
.
ßm∂î©e
 = 44100 ;

424 
sföfo_ªad
.
f‹m©
 = 0 ;

425 i‡(
fûëy≥
 =
SF_FORMAT_RAW
)

426 { 
sföfo_ªad
.
f‹m©
 = 
fûëy≥
 | 
SF_FORMAT_PCM_16
 ;

427 
sföfo_ªad
.
ch™√ls
 = 1 ;

428 
sföfo_ªad
.
ßm∂î©e
 = 44100 ;

431 
	`u£ek_pùe_rw_sh‹t
 (
ext
, &
sföfo_wrôe
, &
sföfo_ªad
) ;

433 
sföfo_ªad
.
f‹m©
 = 
sföfo_wrôe
.f‹m© = 
fûëy≥
 | 
SF_FORMAT_FLOAT
 ;

434 i‡(
	`sf_f‹m©_check
 (&
sföfo_ªad
) != 0)

435 
	`u£ek_pùe_rw_Êﬂt
 (
ext
, &
sföfo_wrôe
, &
sföfo_ªad
) ;

437 
sföfo_ªad
.
f‹m©
 = 
sföfo_wrôe
.f‹m© = 
fûëy≥
 | 
SF_FORMAT_DOUBLE
 ;

438 i‡(
	`sf_f‹m©_check
 (&
sföfo_ªad
) != 0)

439 
	`u£ek_pùe_rw_doubÀ
 (
ext
, &
sföfo_wrôe
, &
sföfo_ªad
) ;

441 
	`puts
 ("ok") ;

443 
	}
}

448 
	$pùe_ã°_Ÿhîs
 (
FILETYPE
* 
li°1
, FILETYPE* 
li°2
)

449 { 
SF_FORMAT_INFO
 
öfo
 ;

450 
k
, 
m
, 
maj‹_cou¡
, 
ö_li°
 ;

452 
	`¥öt_ã°_«me
 ("pipe_test_others", "") ;

454 
	`sf_comm™d
 (
NULL
, 
SFC_GET_FORMAT_MAJOR_COUNT
, &
maj‹_cou¡
,  ()) ;

456 
k
 = 0 ; k < 
maj‹_cou¡
 ; k++)

457 { 
öfo
.
f‹m©
 = 
k
 ;

459 
	`sf_comm™d
 (
NULL
, 
SFC_GET_FORMAT_MAJOR
, &
öfo
,  (info)) ;

461 
ö_li°
 = 
SF_FALSE
 ;

462 
m
 = 0 ; 
li°1
 [m].
f‹m©
 ; m++)

463 i‡(
öfo
.
f‹m©
 =
li°1
 [
m
].format)

464 
ö_li°
 = 
SF_TRUE
 ;

466 
m
 = 0 ; 
li°2
 [m].
f‹m©
 ; m++)

467 i‡(
öfo
.
f‹m©
 =
li°2
 [
m
].format)

468 
ö_li°
 = 
SF_TRUE
 ;

470 i‡(
ö_li°
)

473 
	`¥ötf
 ("%† %x\n", 
öfo
.
«me
, info.
f‹m©
) ;

476 { 
d©a
 [
PIPE_TEST_LEN
] ;

477 
buf„r
 [256] ;

478 c⁄° *
fûíame
 = "pipe_in.dat" ;

480 
SNDFILE
 *
outfûe
 ;

481 
SF_INFO
 
sföfo
 ;

482 
ªtvÆ
 ;

484 
sföfo
.
f‹m©
 = 
öfo
.f‹m© | 
SF_FORMAT_PCM_16
 ;

485 
sföfo
.
ch™√ls
 = 1 ;

486 
sföfo
.
ßm∂î©e
 = 44100 ;

488 
outfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

489 
	`ã°_wrôef_sh‹t_‹_dõ
 (
outfûe
, 0, 
d©a
, 
PIPE_TEST_LEN
, 
__LINE__
) ;

490 
	`sf_˛o£
 (
outfûe
) ;

492 
	`¢¥ötf
 (
buf„r
,  (buf„r), "ˇà%†| ./°dö_ã° %†%d ", 
fûíame
, 
öfo
.
exãnsi⁄
, 
PIPE_TEST_LEN
) ;

493 i‡((
ªtvÆ
 = 
	`sy°em
 (
buf„r
)) == 0)

494 { 
ªtvÆ
 = 
	`WEXITSTATUS
 (retval) ;

495 
	`¥ötf
 ("\n\¿ Löê%d :Öùêã° should havêªtu∫edÉº‹ fûêty≥ \"%s\" buàdidn't.\n\n", 
__LINE__
, 
öfo
.
«me
) ;

496 
	`exô
 (1) ;

499 
	`u∆ök
 (
fûíame
) ;

504 
	`puts
 ("ok") ;

507 
	}
}

514 
	$fûe_exi°s
 (c⁄° *
fûíame
)

515 { 
°©
 
buf
 ;

517 i‡(
	`°©
 (
fûíame
, &
buf
))

521 
	}
}

	@libsndfile-1.0.17/tests/raw_test.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

24 
	~<m©h.h
>

26 #i‡
HAVE_UNISTD_H


27 
	~<uni°d.h
>

30 
	~<¢dfûe.h
>

32 
	~"utûs.h
"

34 
	#BUFFER_LEN
 (1<<10)

	)

35 
	#LOG_BUFFER_SIZE
 1024

	)

37 
øw_off£t_ã°
 (c⁄° *
fûíame
, 
ty≥mö‹
) ;

38 
bad_øw_ã°
 () ;

43 
	gd©a
 [
BUFFER_LEN
] ;

46 
	$maö
 ()

48 
	`øw_off£t_ã°
 ("off£t.øw", 
SF_FORMAT_PCM_16
) ;

49 
	`bad_øw_ã°
 () ;

52 
	}
}

59 
	$øw_off£t_ã°
 (c⁄° *
fûíame
, 
ty≥mö‹
)

60 { 
SNDFILE
 *
¢dfûe
 ;

61 
SF_INFO
 
sföfo
 ;

62 
sf_cou¡_t
 
°¨t
 ;

63 
k
, 
‰ames
 ;

65 
	`¥öt_ã°_«me
 ("øw_off£t_ã°", 
fûíame
) ;

67 
sföfo
.
ßm∂î©e
 = 44100 ;

68 
sföfo
.
f‹m©
 = 
SF_FORMAT_RAW
 | 
ty≥mö‹
 ;

69 
sföfo
.
ch™√ls
 = 1 ;

70 
sföfo
.
‰ames
 = 0 ;

72 
‰ames
 = 
BUFFER_LEN
 / 
sföfo
.
ch™√ls
 ;

74 
¢dfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

76 
°¨t
 = 0 ;

77 
	`sf_comm™d
 (
¢dfûe
, 
SFC_FILE_TRUNCATE
, &
°¨t
,  (start)) ;

79 
k
 = 0 ; k < 
BUFFER_LEN
 ; k++)

80 
d©a
 [
k
] = k ;

81 
	`ã°_wrôe_sh‹t_‹_dõ
 (
¢dfûe
, 0, 
d©a
, 
BUFFER_LEN
, 
__LINE__
) ;

83 
	`sf_˛o£
 (
¢dfûe
) ;

85 
¢dfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

86 
	`check_log_buf„r_‹_dõ
 (
¢dfûe
, 
__LINE__
) ;

88 i‡(
	`abs
 (
BUFFER_LEN
 - 
sföfo
.
‰ames
) > 1)

89 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘ sam∂êcou¡ (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
BUFFER_LEN
) ;

90 
	`dump_log_buf„r
 (
¢dfûe
) ;

91 
	`exô
 (1) ;

94 
	`mem£t
 (
d©a
, 0 ,  (data)) ;

95 
	`ã°_ªad_sh‹t_‹_dõ
 (
¢dfûe
, 0, 
d©a
, 
BUFFER_LEN
, 
__LINE__
) ;

96 
k
 = 0 ; k < 
BUFFER_LEN
 ; k++)

97 i‡(
d©a
 [
k
] != k)

98 
	`¥ötf
 ("Eº‹ :Üöê%d\n", 
__LINE__
) ;

101 
°¨t
 = 2 ;

102 
	`sf_comm™d
 (
¢dfûe
, 
SFC_SET_RAW_START_OFFSET
, &
°¨t
,  (start)) ;

105 
	`ã°_£ek_‹_dõ
 (
¢dfûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

107 
	`mem£t
 (
d©a
, 0 ,  (data)) ;

108 
	`ã°_ªad_sh‹t_‹_dõ
 (
¢dfûe
, 0, 
d©a
, 
BUFFER_LEN
 - 1, 
__LINE__
) ;

109 
k
 = 0 ; k < 
BUFFER_LEN
 - 1 ; k++)

110 i‡(
d©a
 [
k
] != k + 1)

111 { 
	`¥ötf
 ("Eº‹ :Üöê%d\n", 
__LINE__
) ;

112 
	`exô
 (1) ;

116 
°¨t
 = 4 ;

117 
	`sf_comm™d
 (
¢dfûe
, 
SFC_SET_RAW_START_OFFSET
, &
°¨t
,  (start)) ;

120 
	`ã°_£ek_‹_dõ
 (
¢dfûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

122 
	`mem£t
 (
d©a
, 0 ,  (data)) ;

123 
	`ã°_ªad_sh‹t_‹_dõ
 (
¢dfûe
, 0, 
d©a
, 
BUFFER_LEN
 - 2, 
__LINE__
) ;

124 
k
 = 0 ; k < 
BUFFER_LEN
 - 2 ; k++)

125 i‡(
d©a
 [
k
] != k + 2)

126 { 
	`¥ötf
 ("Eº‹ :Üöê%d\n", 
__LINE__
) ;

127 
	`exô
 (1) ;

131 
°¨t
 = 0 ;

132 
	`sf_comm™d
 (
¢dfûe
, 
SFC_SET_RAW_START_OFFSET
, &
°¨t
,  (start)) ;

135 
	`ã°_£ek_‹_dõ
 (
¢dfûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

137 
	`mem£t
 (
d©a
, 0 ,  (data)) ;

138 
	`ã°_ªad_sh‹t_‹_dõ
 (
¢dfûe
, 0, 
d©a
, 
BUFFER_LEN
, 
__LINE__
) ;

139 
k
 = 0 ; k < 
BUFFER_LEN
 ; k++)

140 i‡(
d©a
 [
k
] != k)

141 { 
	`¥ötf
 ("Eº‹ :Üöê%d\n", 
__LINE__
) ;

142 
	`exô
 (1) ;

145 
	`sf_˛o£
 (
¢dfûe
) ;

146 
	`u∆ök
 (
fûíame
) ;

148 
	`puts
 ("ok") ;

149 
	}
}

152 
	$bad_øw_ã°
 ()

153 { 
FILE
 *
ãxtfûe
 ;

154 
SNDFILE
 *
fûe
 ;

155 
SF_INFO
 
sföfo
 ;

156 c⁄° *
îr‹°r
, *
fûíame
 = "bad.raw" ;

158 
	`¥öt_ã°_«me
 ("bad_øw_ã°", 
fûíame
) ;

160 i‡((
ãxtfûe
 = 
	`f›í
 (
fûíame
, "w")Ë=
NULL
)

161 { 
	`¥ötf
 ("\n\nLöê%d :ÇŸábÀÅÿ›íÅexàfûêf‹ wrôe.\n", 
__LINE__
) ;

162 
	`exô
 (1) ;

165 
	`Ârötf
 (
ãxtfûe
, "This isÇotá valid file.\n") ;

166 
	`f˛o£
 (
ãxtfûe
) ;

168 
sföfo
.
ßm∂î©e
 = 44100 ;

169 
sföfo
.
f‹m©
 = 
SF_FORMAT_RAW
 | 0xABCD ;

170 
sföfo
.
ch™√ls
 = 1 ;

172 i‡((
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_READ
, &
sföfo
)Ë!
NULL
)

173 { 
	`¥ötf
 ("\n\nLöê%d : Eº‹, fûêshouldÇŸ havê›íed.\n", 
__LINE__
 - 1) ;

174 
	`exô
 (1) ;

177 
îr‹°r
 = 
	`sf_°ªº‹
 (
fûe
) ;

179 i‡(
	`°r°r
 (
îr‹°r
, "Bad f‹m© fõld i¿SF_INFO såu˘"Ë=
NULL
)

180 { 
	`¥ötf
 ("\n\nLöê%d : Eº‹ badÉº‹ såög : %s.\n", 
__LINE__
 - 1, 
îr‹°r
) ;

181 
	`exô
 (1) ;

184 
	`u∆ök
 (
fûíame
) ;

186 
	`puts
 ("ok") ;

187 
	}
}

	@libsndfile-1.0.17/tests/scale_clip_test.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

25 #i‡
HAVE_UNISTD_H


26 
	~<uni°d.h
>

29 
	~<m©h.h
>

31 
	~<¢dfûe.h
>

33 
	~"utûs.h
"

35 #i‚def 
M_PI


36 
	#M_PI
 3.14159265358979323846264338

	)

39 
	#HALF_BUFFER_SIZE
 (1 << 12)

	)

40 
	#BUFFER_SIZE
 (2 * 
HALF_BUFFER_SIZE
)

	)

42 
	#SINE_AMP
 1.1

	)

43 
	#MAX_ERROR
 0.0202

	)

46 
Êt_sˇÀ_˛ù_ã°_16
 (c⁄° *
fûíame
, 
fûëy≥
, 
maxvÆ
) ;

47 
Êt_sˇÀ_˛ù_ã°_24
 (c⁄° *
fûíame
, 
fûëy≥
, 
maxvÆ
) ;

48 
Êt_sˇÀ_˛ù_ã°_32
 (c⁄° *
fûíame
, 
fûëy≥
, 
maxvÆ
) ;

49 
Êt_sˇÀ_˛ù_ã°_08
 (c⁄° *
fûíame
, 
fûëy≥
, 
maxvÆ
) ;

51 
dbl_sˇÀ_˛ù_ã°_16
 (c⁄° *
fûíame
, 
fûëy≥
, 
maxvÆ
) ;

52 
dbl_sˇÀ_˛ù_ã°_24
 (c⁄° *
fûíame
, 
fûëy≥
, 
maxvÆ
) ;

53 
dbl_sˇÀ_˛ù_ã°_32
 (c⁄° *
fûíame
, 
fûëy≥
, 
maxvÆ
) ;

54 
dbl_sˇÀ_˛ù_ã°_08
 (c⁄° *
fûíame
, 
fûëy≥
, 
maxvÆ
) ;

58 { 
	mdbl
 [
BUFFER_SIZE
] ;

59 
	mÊt
 [
BUFFER_SIZE
] ;

60 } 
	tBUFFER
 ;

63 
BUFFER
 
	gbuf„r_out
 ;

64 
BUFFER
 
	gbuf„r_ö
 ;

67 
	$maö
 ()

69 
	`Êt_sˇÀ_˛ù_ã°_08
 ("sˇÀ_˛ù_s8.au", 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_S8
, 1.0 * 0x80) ;

70 
	`Êt_sˇÀ_˛ù_ã°_08
 ("sˇÀ_˛ù_u8.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_U8
, 1.0 * 0x80) ;

72 
	`dbl_sˇÀ_˛ù_ã°_08
 ("sˇÀ_˛ù_s8.au", 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_S8
, 1.0 * 0x80) ;

73 
	`dbl_sˇÀ_˛ù_ã°_08
 ("sˇÀ_˛ù_u8.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_U8
, 1.0 * 0x80) ;

80 
	`Êt_sˇÀ_˛ù_ã°_16
 ("sˇÀ_˛ù_be16.au", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_16
, 1.0 * 0x8000) ;

81 
	`Êt_sˇÀ_˛ù_ã°_16
 ("sˇÀ_˛ù_À16.au", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_16
, 1.0 * 0x8000) ;

82 
	`Êt_sˇÀ_˛ù_ã°_24
 ("sˇÀ_˛ù_be24.au", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_24
, 1.0 * 0x800000) ;

83 
	`Êt_sˇÀ_˛ù_ã°_24
 ("sˇÀ_˛ù_À24.au", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_24
, 1.0 * 0x800000) ;

84 
	`Êt_sˇÀ_˛ù_ã°_32
 ("sˇÀ_˛ù_be32.au", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_32
, 1.0 * 0x80000000) ;

85 
	`Êt_sˇÀ_˛ù_ã°_32
 ("sˇÀ_˛ù_À32.au", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_32
, 1.0 * 0x80000000) ;

87 
	`dbl_sˇÀ_˛ù_ã°_16
 ("sˇÀ_˛ù_be16.au", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_16
, 1.0 * 0x8000) ;

88 
	`dbl_sˇÀ_˛ù_ã°_16
 ("sˇÀ_˛ù_À16.au", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_16
, 1.0 * 0x8000) ;

89 
	`dbl_sˇÀ_˛ù_ã°_24
 ("sˇÀ_˛ù_be24.au", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_24
, 1.0 * 0x800000) ;

90 
	`dbl_sˇÀ_˛ù_ã°_24
 ("sˇÀ_˛ù_À24.au", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_24
, 1.0 * 0x800000) ;

91 
	`dbl_sˇÀ_˛ù_ã°_32
 ("sˇÀ_˛ù_be32.au", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_32
, 1.0 * 0x80000000) ;

92 
	`dbl_sˇÀ_˛ù_ã°_32
 ("sˇÀ_˛ù_À32.au", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_32
, 1.0 * 0x80000000) ;

95 
	}
}

103 
	$Êt_sˇÀ_˛ù_ã°_16
 (c⁄° *
fûíame
, 
fûëy≥
, 
maxvÆ
)

104 { 
SNDFILE
 *
fûe
 ;

105 
SF_INFO
 
sföfo
 ;

106 
k
 ;

107 *
d©a_out
, *
d©a_ö
 ;

108 
diff
, 
˛ù_max_diff
 ;

110 
	`¥öt_ã°_«me
 ("Êt_sˇÀ_˛ù_ã°_16", 
fûíame
) ;

112 
d©a_out
 = 
buf„r_out
.
Êt
 ;

113 
d©a_ö
 = 
buf„r_ö
.
Êt
 ;

115 
k
 = 0 ; k < 
HALF_BUFFER_SIZE
 ; k++)

116 { 
d©a_out
 [
k
] = 
SINE_AMP
 * 
	`sö
 (2 * 
M_PI
 * k / 
HALF_BUFFER_SIZE
) ;

117 
d©a_out
 [
k
 + 
HALF_BUFFER_SIZE
] = d©a_ouà[k] * 
maxvÆ
 ;

120 
sföfo
.
ßm∂î©e
 = 44100 ;

121 
sföfo
.
‰ames
 = 123456789 ;

122 
sföfo
.
ch™√ls
 = 1 ;

123 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

131 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

132 
	`sf_comm™d
 (
fûe
, 
SFC_SET_CLIPPING
, 
NULL
, 
SF_TRUE
) ;

133 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a_out
, 
HALF_BUFFER_SIZE
, 
__LINE__
) ;

134 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

135 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a_out
 + 
HALF_BUFFER_SIZE
, HALF_BUFFER_SIZE, 
__LINE__
) ;

136 
	`sf_˛o£
 (
fûe
) ;

138 
	`mem£t
 (&
buf„r_ö
, 0,  (buffer_in)) ;

140 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

142 
sföfo
.
f‹m©
 &(
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_SUBMASK
) ;

144 i‡(
sföfo
.
f‹m©
 !(
fûëy≥
 & (
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_SUBMASK
)))

145 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

146 
	`exô
 (1) ;

149 i‡(
sföfo
.
‰ames
 !
BUFFER_SIZE
)

150 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûê(%d => %ld).\n\n", 
__LINE__
, 
BUFFER_SIZE
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

151 
	`exô
 (1) ;

154 i‡(
sföfo
.
ch™√ls
 != 1)

155 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n\n", 
__LINE__
) ;

156 
	`exô
 (1) ;

159 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

161 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a_ö
, 
HALF_BUFFER_SIZE
, 
__LINE__
) ;

162 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

163 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a_ö
 + 
HALF_BUFFER_SIZE
, HALF_BUFFER_SIZE, 
__LINE__
) ;

164 
	`sf_˛o£
 (
fûe
) ;

167 
˛ù_max_diff
 = 0.0 ;

168 
k
 = 0 ; k < 
HALF_BUFFER_SIZE
 ; k++)

169 { i‡(
	`Ábs
 (
d©a_ö
 [
k
]) > 1.0)

170 { 
	`¥ötf
 ("\n\nLöê%d: I≈uàßm∂ê%d/%d (%fËha†nŸ bì¿˛ù≥d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
, 
d©a_ö
 [k]) ;

171 
	`exô
 (1) ;

174 i‡(
d©a_out
 [
k
] * 
d©a_ö
 [k] < 0.0)

175 { 
	`¥ötf
 ("\n\nLöê%d: D©®wø∞¨oundáàödex %d/%d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
) ;

176 
	`exô
 (1) ;

179 i‡(
	`Ábs
 (
d©a_out
 [
k
]) > 1.0)

182 
diff
 = 
	`Ábs
 (
d©a_out
 [
k
] - 
d©a_ö
 [k]) ;

183 i‡(
diff
 > 
˛ù_max_diff
)

184 
˛ù_max_diff
 = 
diff
 ;

187 i‡(
˛ù_max_diff
 < 1e-20)

188 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿsmÆ»“‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

189 
	`exô
 (1) ;

192 i‡(
˛ù_max_diff
 > 1.0 / 0x8000)

193 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿœrgê“‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

194 
	`exô
 (1) ;

198 
˛ù_max_diff
 = 0.0 ;

199 
k
 = 
HALF_BUFFER_SIZE
 ; k < 
BUFFER_SIZE
 ; k++)

200 { i‡(
	`Ábs
 (
d©a_ö
 [
k
]Ë> 
maxvÆ
)

201 { 
	`¥ötf
 ("\n\nLöê%d: I≈uàßm∂ê%d/%d (%fËha†nŸ bì¿˛ù≥d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
, 
d©a_ö
 [k]) ;

202 
	`exô
 (1) ;

205 i‡(
d©a_out
 [
k
] * 
d©a_ö
 [k] < 0.0)

206 { 
	`¥ötf
 ("\n\nLöê%d: D©®wø∞¨oundáàödex %d/%d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
) ;

207 
	`exô
 (1) ;

210 i‡(
	`Ábs
 (
d©a_out
 [
k
]Ë> 
maxvÆ
)

213 
diff
 = 
	`Ábs
 (
d©a_out
 [
k
] - 
d©a_ö
 [k]) ;

214 i‡(
diff
 > 
˛ù_max_diff
)

215 
˛ù_max_diff
 = 
diff
 ;

218 i‡(
˛ù_max_diff
 < 1e-20)

219 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿsmÆ»(un-n‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

220 
	`exô
 (1) ;

223 i‡(
˛ù_max_diff
 > 1.0)

224 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿœrgê(un-n‹mÆi£d).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

225 
	`exô
 (1) ;

228 
	`¥ötf
 ("ok\n") ;

229 
	`u∆ök
 (
fûíame
) ;

230 
	}
}

233 
	$Êt_sˇÀ_˛ù_ã°_24
 (c⁄° *
fûíame
, 
fûëy≥
, 
maxvÆ
)

234 { 
SNDFILE
 *
fûe
 ;

235 
SF_INFO
 
sföfo
 ;

236 
k
 ;

237 *
d©a_out
, *
d©a_ö
 ;

238 
diff
, 
˛ù_max_diff
 ;

240 
	`¥öt_ã°_«me
 ("Êt_sˇÀ_˛ù_ã°_24", 
fûíame
) ;

242 
d©a_out
 = 
buf„r_out
.
Êt
 ;

243 
d©a_ö
 = 
buf„r_ö
.
Êt
 ;

245 
k
 = 0 ; k < 
HALF_BUFFER_SIZE
 ; k++)

246 { 
d©a_out
 [
k
] = 
SINE_AMP
 * 
	`sö
 (2 * 
M_PI
 * k / 
HALF_BUFFER_SIZE
) ;

247 
d©a_out
 [
k
 + 
HALF_BUFFER_SIZE
] = d©a_ouà[k] * 
maxvÆ
 ;

250 
sföfo
.
ßm∂î©e
 = 44100 ;

251 
sföfo
.
‰ames
 = 123456789 ;

252 
sföfo
.
ch™√ls
 = 1 ;

253 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

261 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

262 
	`sf_comm™d
 (
fûe
, 
SFC_SET_CLIPPING
, 
NULL
, 
SF_TRUE
) ;

263 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a_out
, 
HALF_BUFFER_SIZE
, 
__LINE__
) ;

264 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

265 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a_out
 + 
HALF_BUFFER_SIZE
, HALF_BUFFER_SIZE, 
__LINE__
) ;

266 
	`sf_˛o£
 (
fûe
) ;

268 
	`mem£t
 (&
buf„r_ö
, 0,  (buffer_in)) ;

270 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

272 
sföfo
.
f‹m©
 &(
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_SUBMASK
) ;

274 i‡(
sföfo
.
f‹m©
 !(
fûëy≥
 & (
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_SUBMASK
)))

275 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

276 
	`exô
 (1) ;

279 i‡(
sföfo
.
‰ames
 !
BUFFER_SIZE
)

280 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûê(%d => %ld).\n\n", 
__LINE__
, 
BUFFER_SIZE
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

281 
	`exô
 (1) ;

284 i‡(
sföfo
.
ch™√ls
 != 1)

285 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n\n", 
__LINE__
) ;

286 
	`exô
 (1) ;

289 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

291 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a_ö
, 
HALF_BUFFER_SIZE
, 
__LINE__
) ;

292 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

293 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a_ö
 + 
HALF_BUFFER_SIZE
, HALF_BUFFER_SIZE, 
__LINE__
) ;

294 
	`sf_˛o£
 (
fûe
) ;

297 
˛ù_max_diff
 = 0.0 ;

298 
k
 = 0 ; k < 
HALF_BUFFER_SIZE
 ; k++)

299 { i‡(
	`Ábs
 (
d©a_ö
 [
k
]) > 1.0)

300 { 
	`¥ötf
 ("\n\nLöê%d: I≈uàßm∂ê%d/%d (%fËha†nŸ bì¿˛ù≥d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
, 
d©a_ö
 [k]) ;

301 
	`exô
 (1) ;

304 i‡(
d©a_out
 [
k
] * 
d©a_ö
 [k] < 0.0)

305 { 
	`¥ötf
 ("\n\nLöê%d: D©®wø∞¨oundáàödex %d/%d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
) ;

306 
	`exô
 (1) ;

309 i‡(
	`Ábs
 (
d©a_out
 [
k
]) > 1.0)

312 
diff
 = 
	`Ábs
 (
d©a_out
 [
k
] - 
d©a_ö
 [k]) ;

313 i‡(
diff
 > 
˛ù_max_diff
)

314 
˛ù_max_diff
 = 
diff
 ;

317 i‡(
˛ù_max_diff
 < 1e-20)

318 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿsmÆ»“‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

319 
	`exô
 (1) ;

322 i‡(
˛ù_max_diff
 > 1.0 / 0x800000)

323 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿœrgê“‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

324 
	`exô
 (1) ;

328 
˛ù_max_diff
 = 0.0 ;

329 
k
 = 
HALF_BUFFER_SIZE
 ; k < 
BUFFER_SIZE
 ; k++)

330 { i‡(
	`Ábs
 (
d©a_ö
 [
k
]Ë> 
maxvÆ
)

331 { 
	`¥ötf
 ("\n\nLöê%d: I≈uàßm∂ê%d/%d (%fËha†nŸ bì¿˛ù≥d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
, 
d©a_ö
 [k]) ;

332 
	`exô
 (1) ;

335 i‡(
d©a_out
 [
k
] * 
d©a_ö
 [k] < 0.0)

336 { 
	`¥ötf
 ("\n\nLöê%d: D©®wø∞¨oundáàödex %d/%d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
) ;

337 
	`exô
 (1) ;

340 i‡(
	`Ábs
 (
d©a_out
 [
k
]Ë> 
maxvÆ
)

343 
diff
 = 
	`Ábs
 (
d©a_out
 [
k
] - 
d©a_ö
 [k]) ;

344 i‡(
diff
 > 
˛ù_max_diff
)

345 
˛ù_max_diff
 = 
diff
 ;

348 i‡(
˛ù_max_diff
 < 1e-20)

349 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿsmÆ»(un-n‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

350 
	`exô
 (1) ;

353 i‡(
˛ù_max_diff
 > 1.0)

354 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿœrgê(un-n‹mÆi£d).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

355 
	`exô
 (1) ;

358 
	`¥ötf
 ("ok\n") ;

359 
	`u∆ök
 (
fûíame
) ;

360 
	}
}

363 
	$Êt_sˇÀ_˛ù_ã°_32
 (c⁄° *
fûíame
, 
fûëy≥
, 
maxvÆ
)

364 { 
SNDFILE
 *
fûe
 ;

365 
SF_INFO
 
sföfo
 ;

366 
k
 ;

367 *
d©a_out
, *
d©a_ö
 ;

368 
diff
, 
˛ù_max_diff
 ;

370 
	`¥öt_ã°_«me
 ("Êt_sˇÀ_˛ù_ã°_32", 
fûíame
) ;

372 
d©a_out
 = 
buf„r_out
.
Êt
 ;

373 
d©a_ö
 = 
buf„r_ö
.
Êt
 ;

375 
k
 = 0 ; k < 
HALF_BUFFER_SIZE
 ; k++)

376 { 
d©a_out
 [
k
] = 
SINE_AMP
 * 
	`sö
 (2 * 
M_PI
 * k / 
HALF_BUFFER_SIZE
) ;

377 
d©a_out
 [
k
 + 
HALF_BUFFER_SIZE
] = d©a_ouà[k] * 
maxvÆ
 ;

380 
sföfo
.
ßm∂î©e
 = 44100 ;

381 
sföfo
.
‰ames
 = 123456789 ;

382 
sföfo
.
ch™√ls
 = 1 ;

383 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

391 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

392 
	`sf_comm™d
 (
fûe
, 
SFC_SET_CLIPPING
, 
NULL
, 
SF_TRUE
) ;

393 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a_out
, 
HALF_BUFFER_SIZE
, 
__LINE__
) ;

394 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

395 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a_out
 + 
HALF_BUFFER_SIZE
, HALF_BUFFER_SIZE, 
__LINE__
) ;

396 
	`sf_˛o£
 (
fûe
) ;

398 
	`mem£t
 (&
buf„r_ö
, 0,  (buffer_in)) ;

400 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

402 
sföfo
.
f‹m©
 &(
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_SUBMASK
) ;

404 i‡(
sföfo
.
f‹m©
 !(
fûëy≥
 & (
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_SUBMASK
)))

405 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

406 
	`exô
 (1) ;

409 i‡(
sföfo
.
‰ames
 !
BUFFER_SIZE
)

410 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûê(%d => %ld).\n\n", 
__LINE__
, 
BUFFER_SIZE
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

411 
	`exô
 (1) ;

414 i‡(
sföfo
.
ch™√ls
 != 1)

415 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n\n", 
__LINE__
) ;

416 
	`exô
 (1) ;

419 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

421 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a_ö
, 
HALF_BUFFER_SIZE
, 
__LINE__
) ;

422 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

423 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a_ö
 + 
HALF_BUFFER_SIZE
, HALF_BUFFER_SIZE, 
__LINE__
) ;

424 
	`sf_˛o£
 (
fûe
) ;

427 
˛ù_max_diff
 = 0.0 ;

428 
k
 = 0 ; k < 
HALF_BUFFER_SIZE
 ; k++)

429 { i‡(
	`Ábs
 (
d©a_ö
 [
k
]) > 1.0)

430 { 
	`¥ötf
 ("\n\nLöê%d: I≈uàßm∂ê%d/%d (%fËha†nŸ bì¿˛ù≥d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
, 
d©a_ö
 [k]) ;

431 
	`exô
 (1) ;

434 i‡(
d©a_out
 [
k
] * 
d©a_ö
 [k] < 0.0)

435 { 
	`¥ötf
 ("\n\nLöê%d: D©®wø∞¨oundáàödex %d/%d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
) ;

436 
	`exô
 (1) ;

439 i‡(
	`Ábs
 (
d©a_out
 [
k
]) > 1.0)

442 
diff
 = 
	`Ábs
 (
d©a_out
 [
k
] - 
d©a_ö
 [k]) ;

443 i‡(
diff
 > 
˛ù_max_diff
)

444 
˛ù_max_diff
 = 
diff
 ;

447 i‡(
˛ù_max_diff
 < 1e-20)

448 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿsmÆ»“‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

449 
	`exô
 (1) ;

452 i‡(
˛ù_max_diff
 > 1.0 / 0x80000000)

453 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿœrgê“‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

454 
	`exô
 (1) ;

458 
˛ù_max_diff
 = 0.0 ;

459 
k
 = 
HALF_BUFFER_SIZE
 ; k < 
BUFFER_SIZE
 ; k++)

460 { i‡(
	`Ábs
 (
d©a_ö
 [
k
]Ë> 
maxvÆ
)

461 { 
	`¥ötf
 ("\n\nLöê%d: I≈uàßm∂ê%d/%d (%fËha†nŸ bì¿˛ù≥d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
, 
d©a_ö
 [k]) ;

462 
	`exô
 (1) ;

465 i‡(
d©a_out
 [
k
] * 
d©a_ö
 [k] < 0.0)

466 { 
	`¥ötf
 ("\n\nLöê%d: D©®wø∞¨oundáàödex %d/%d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
) ;

467 
	`exô
 (1) ;

470 i‡(
	`Ábs
 (
d©a_out
 [
k
]Ë> 
maxvÆ
)

473 
diff
 = 
	`Ábs
 (
d©a_out
 [
k
] - 
d©a_ö
 [k]) ;

474 i‡(
diff
 > 
˛ù_max_diff
)

475 
˛ù_max_diff
 = 
diff
 ;

478 i‡(
˛ù_max_diff
 < 1e-20)

479 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿsmÆ»(un-n‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

480 
	`exô
 (1) ;

483 i‡(
˛ù_max_diff
 > 1.0)

484 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿœrgê(un-n‹mÆi£d).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

485 
	`exô
 (1) ;

488 
	`¥ötf
 ("ok\n") ;

489 
	`u∆ök
 (
fûíame
) ;

490 
	}
}

493 
	$Êt_sˇÀ_˛ù_ã°_08
 (c⁄° *
fûíame
, 
fûëy≥
, 
maxvÆ
)

494 { 
SNDFILE
 *
fûe
 ;

495 
SF_INFO
 
sföfo
 ;

496 
k
 ;

497 *
d©a_out
, *
d©a_ö
 ;

498 
diff
, 
˛ù_max_diff
 ;

500 
	`¥öt_ã°_«me
 ("Êt_sˇÀ_˛ù_ã°_08", 
fûíame
) ;

502 
d©a_out
 = 
buf„r_out
.
Êt
 ;

503 
d©a_ö
 = 
buf„r_ö
.
Êt
 ;

505 
k
 = 0 ; k < 
HALF_BUFFER_SIZE
 ; k++)

506 { 
d©a_out
 [
k
] = 
SINE_AMP
 * 
	`sö
 (2 * 
M_PI
 * k / 
HALF_BUFFER_SIZE
) ;

507 
d©a_out
 [
k
 + 
HALF_BUFFER_SIZE
] = d©a_ouà[k] * 
maxvÆ
 ;

510 
sföfo
.
ßm∂î©e
 = 44100 ;

511 
sföfo
.
‰ames
 = 123456789 ;

512 
sföfo
.
ch™√ls
 = 1 ;

513 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

521 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

522 
	`sf_comm™d
 (
fûe
, 
SFC_SET_CLIPPING
, 
NULL
, 
SF_TRUE
) ;

523 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a_out
, 
HALF_BUFFER_SIZE
, 
__LINE__
) ;

524 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

525 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a_out
 + 
HALF_BUFFER_SIZE
, HALF_BUFFER_SIZE, 
__LINE__
) ;

526 
	`sf_˛o£
 (
fûe
) ;

528 
	`mem£t
 (&
buf„r_ö
, 0,  (buffer_in)) ;

530 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

532 
sföfo
.
f‹m©
 &(
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_SUBMASK
) ;

534 i‡(
sföfo
.
f‹m©
 !(
fûëy≥
 & (
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_SUBMASK
)))

535 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

536 
	`exô
 (1) ;

539 i‡(
sföfo
.
‰ames
 !
BUFFER_SIZE
)

540 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûê(%d => %ld).\n\n", 
__LINE__
, 
BUFFER_SIZE
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

541 
	`exô
 (1) ;

544 i‡(
sföfo
.
ch™√ls
 != 1)

545 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n\n", 
__LINE__
) ;

546 
	`exô
 (1) ;

549 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

551 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a_ö
, 
HALF_BUFFER_SIZE
, 
__LINE__
) ;

552 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_FLOAT
, 
NULL
, 
SF_FALSE
) ;

553 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
d©a_ö
 + 
HALF_BUFFER_SIZE
, HALF_BUFFER_SIZE, 
__LINE__
) ;

554 
	`sf_˛o£
 (
fûe
) ;

557 
˛ù_max_diff
 = 0.0 ;

558 
k
 = 0 ; k < 
HALF_BUFFER_SIZE
 ; k++)

559 { i‡(
	`Ábs
 (
d©a_ö
 [
k
]) > 1.0)

560 { 
	`¥ötf
 ("\n\nLöê%d: I≈uàßm∂ê%d/%d (%fËha†nŸ bì¿˛ù≥d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
, 
d©a_ö
 [k]) ;

561 
	`exô
 (1) ;

564 i‡(
d©a_out
 [
k
] * 
d©a_ö
 [k] < 0.0)

565 { 
	`¥ötf
 ("\n\nLöê%d: D©®wø∞¨oundáàödex %d/%d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
) ;

566 
	`exô
 (1) ;

569 i‡(
	`Ábs
 (
d©a_out
 [
k
]) > 1.0)

572 
diff
 = 
	`Ábs
 (
d©a_out
 [
k
] - 
d©a_ö
 [k]) ;

573 i‡(
diff
 > 
˛ù_max_diff
)

574 
˛ù_max_diff
 = 
diff
 ;

577 i‡(
˛ù_max_diff
 < 1e-20)

578 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿsmÆ»“‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

579 
	`exô
 (1) ;

582 i‡(
˛ù_max_diff
 > 1.0 / 0x80)

583 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿœrgê“‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

584 
	`exô
 (1) ;

588 
˛ù_max_diff
 = 0.0 ;

589 
k
 = 
HALF_BUFFER_SIZE
 ; k < 
BUFFER_SIZE
 ; k++)

590 { i‡(
	`Ábs
 (
d©a_ö
 [
k
]Ë> 
maxvÆ
)

591 { 
	`¥ötf
 ("\n\nLöê%d: I≈uàßm∂ê%d/%d (%fËha†nŸ bì¿˛ù≥d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
, 
d©a_ö
 [k]) ;

592 
	`exô
 (1) ;

595 i‡(
d©a_out
 [
k
] * 
d©a_ö
 [k] < 0.0)

596 { 
	`¥ötf
 ("\n\nLöê%d: D©®wø∞¨oundáàödex %d/%d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
) ;

597 
	`exô
 (1) ;

600 i‡(
	`Ábs
 (
d©a_out
 [
k
]Ë> 
maxvÆ
)

603 
diff
 = 
	`Ábs
 (
d©a_out
 [
k
] - 
d©a_ö
 [k]) ;

604 i‡(
diff
 > 
˛ù_max_diff
)

605 
˛ù_max_diff
 = 
diff
 ;

608 i‡(
˛ù_max_diff
 < 1e-20)

609 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿsmÆ»(un-n‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

610 
	`exô
 (1) ;

613 i‡(
˛ù_max_diff
 > 1.0)

614 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿœrgê(un-n‹mÆi£d).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

615 
	`exô
 (1) ;

618 
	`¥ötf
 ("ok\n") ;

619 
	`u∆ök
 (
fûíame
) ;

620 
	}
}

625 
	$dbl_sˇÀ_˛ù_ã°_16
 (c⁄° *
fûíame
, 
fûëy≥
, 
maxvÆ
)

626 { 
SNDFILE
 *
fûe
 ;

627 
SF_INFO
 
sföfo
 ;

628 
k
 ;

629 *
d©a_out
, *
d©a_ö
 ;

630 
diff
, 
˛ù_max_diff
 ;

632 
	`¥öt_ã°_«me
 ("dbl_sˇÀ_˛ù_ã°_16", 
fûíame
) ;

634 
d©a_out
 = 
buf„r_out
.
dbl
 ;

635 
d©a_ö
 = 
buf„r_ö
.
dbl
 ;

637 
k
 = 0 ; k < 
HALF_BUFFER_SIZE
 ; k++)

638 { 
d©a_out
 [
k
] = 
SINE_AMP
 * 
	`sö
 (2 * 
M_PI
 * k / 
HALF_BUFFER_SIZE
) ;

639 
d©a_out
 [
k
 + 
HALF_BUFFER_SIZE
] = d©a_ouà[k] * 
maxvÆ
 ;

642 
sföfo
.
ßm∂î©e
 = 44100 ;

643 
sföfo
.
‰ames
 = 123456789 ;

644 
sföfo
.
ch™√ls
 = 1 ;

645 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

653 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

654 
	`sf_comm™d
 (
fûe
, 
SFC_SET_CLIPPING
, 
NULL
, 
SF_TRUE
) ;

655 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a_out
, 
HALF_BUFFER_SIZE
, 
__LINE__
) ;

656 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

657 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a_out
 + 
HALF_BUFFER_SIZE
, HALF_BUFFER_SIZE, 
__LINE__
) ;

658 
	`sf_˛o£
 (
fûe
) ;

660 
	`mem£t
 (&
buf„r_ö
, 0,  (buffer_in)) ;

662 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

664 
sföfo
.
f‹m©
 &(
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_SUBMASK
) ;

666 i‡(
sföfo
.
f‹m©
 !(
fûëy≥
 & (
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_SUBMASK
)))

667 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

668 
	`exô
 (1) ;

671 i‡(
sföfo
.
‰ames
 !
BUFFER_SIZE
)

672 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûê(%d => %ld).\n\n", 
__LINE__
, 
BUFFER_SIZE
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

673 
	`exô
 (1) ;

676 i‡(
sföfo
.
ch™√ls
 != 1)

677 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n\n", 
__LINE__
) ;

678 
	`exô
 (1) ;

681 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

683 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a_ö
, 
HALF_BUFFER_SIZE
, 
__LINE__
) ;

684 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

685 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a_ö
 + 
HALF_BUFFER_SIZE
, HALF_BUFFER_SIZE, 
__LINE__
) ;

686 
	`sf_˛o£
 (
fûe
) ;

689 
˛ù_max_diff
 = 0.0 ;

690 
k
 = 0 ; k < 
HALF_BUFFER_SIZE
 ; k++)

691 { i‡(
	`Ábs
 (
d©a_ö
 [
k
]) > 1.0)

692 { 
	`¥ötf
 ("\n\nLöê%d: I≈uàßm∂ê%d/%d (%fËha†nŸ bì¿˛ù≥d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
, 
d©a_ö
 [k]) ;

693 
	`exô
 (1) ;

696 i‡(
d©a_out
 [
k
] * 
d©a_ö
 [k] < 0.0)

697 { 
	`¥ötf
 ("\n\nLöê%d: D©®wø∞¨oundáàödex %d/%d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
) ;

698 
	`exô
 (1) ;

701 i‡(
	`Ábs
 (
d©a_out
 [
k
]) > 1.0)

704 
diff
 = 
	`Ábs
 (
d©a_out
 [
k
] - 
d©a_ö
 [k]) ;

705 i‡(
diff
 > 
˛ù_max_diff
)

706 
˛ù_max_diff
 = 
diff
 ;

709 i‡(
˛ù_max_diff
 < 1e-20)

710 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿsmÆ»“‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

711 
	`exô
 (1) ;

714 i‡(
˛ù_max_diff
 > 1.0 / 0x8000)

715 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿœrgê“‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

716 
	`exô
 (1) ;

720 
˛ù_max_diff
 = 0.0 ;

721 
k
 = 
HALF_BUFFER_SIZE
 ; k < 
BUFFER_SIZE
 ; k++)

722 { i‡(
	`Ábs
 (
d©a_ö
 [
k
]Ë> 
maxvÆ
)

723 { 
	`¥ötf
 ("\n\nLöê%d: I≈uàßm∂ê%d/%d (%fËha†nŸ bì¿˛ù≥d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
, 
d©a_ö
 [k]) ;

724 
	`exô
 (1) ;

727 i‡(
d©a_out
 [
k
] * 
d©a_ö
 [k] < 0.0)

728 { 
	`¥ötf
 ("\n\nLöê%d: D©®wø∞¨oundáàödex %d/%d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
) ;

729 
	`exô
 (1) ;

732 i‡(
	`Ábs
 (
d©a_out
 [
k
]Ë> 
maxvÆ
)

735 
diff
 = 
	`Ábs
 (
d©a_out
 [
k
] - 
d©a_ö
 [k]) ;

736 i‡(
diff
 > 
˛ù_max_diff
)

737 
˛ù_max_diff
 = 
diff
 ;

740 i‡(
˛ù_max_diff
 < 1e-20)

741 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿsmÆ»(un-n‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

742 
	`exô
 (1) ;

745 i‡(
˛ù_max_diff
 > 1.0)

746 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿœrgê(un-n‹mÆi£d).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

747 
	`exô
 (1) ;

750 
	`¥ötf
 ("ok\n") ;

751 
	`u∆ök
 (
fûíame
) ;

752 
	}
}

755 
	$dbl_sˇÀ_˛ù_ã°_24
 (c⁄° *
fûíame
, 
fûëy≥
, 
maxvÆ
)

756 { 
SNDFILE
 *
fûe
 ;

757 
SF_INFO
 
sföfo
 ;

758 
k
 ;

759 *
d©a_out
, *
d©a_ö
 ;

760 
diff
, 
˛ù_max_diff
 ;

762 
	`¥öt_ã°_«me
 ("dbl_sˇÀ_˛ù_ã°_24", 
fûíame
) ;

764 
d©a_out
 = 
buf„r_out
.
dbl
 ;

765 
d©a_ö
 = 
buf„r_ö
.
dbl
 ;

767 
k
 = 0 ; k < 
HALF_BUFFER_SIZE
 ; k++)

768 { 
d©a_out
 [
k
] = 
SINE_AMP
 * 
	`sö
 (2 * 
M_PI
 * k / 
HALF_BUFFER_SIZE
) ;

769 
d©a_out
 [
k
 + 
HALF_BUFFER_SIZE
] = d©a_ouà[k] * 
maxvÆ
 ;

772 
sföfo
.
ßm∂î©e
 = 44100 ;

773 
sföfo
.
‰ames
 = 123456789 ;

774 
sföfo
.
ch™√ls
 = 1 ;

775 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

783 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

784 
	`sf_comm™d
 (
fûe
, 
SFC_SET_CLIPPING
, 
NULL
, 
SF_TRUE
) ;

785 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a_out
, 
HALF_BUFFER_SIZE
, 
__LINE__
) ;

786 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

787 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a_out
 + 
HALF_BUFFER_SIZE
, HALF_BUFFER_SIZE, 
__LINE__
) ;

788 
	`sf_˛o£
 (
fûe
) ;

790 
	`mem£t
 (&
buf„r_ö
, 0,  (buffer_in)) ;

792 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

794 
sföfo
.
f‹m©
 &(
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_SUBMASK
) ;

796 i‡(
sföfo
.
f‹m©
 !(
fûëy≥
 & (
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_SUBMASK
)))

797 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

798 
	`exô
 (1) ;

801 i‡(
sföfo
.
‰ames
 !
BUFFER_SIZE
)

802 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûê(%d => %ld).\n\n", 
__LINE__
, 
BUFFER_SIZE
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

803 
	`exô
 (1) ;

806 i‡(
sföfo
.
ch™√ls
 != 1)

807 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n\n", 
__LINE__
) ;

808 
	`exô
 (1) ;

811 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

813 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a_ö
, 
HALF_BUFFER_SIZE
, 
__LINE__
) ;

814 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

815 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a_ö
 + 
HALF_BUFFER_SIZE
, HALF_BUFFER_SIZE, 
__LINE__
) ;

816 
	`sf_˛o£
 (
fûe
) ;

819 
˛ù_max_diff
 = 0.0 ;

820 
k
 = 0 ; k < 
HALF_BUFFER_SIZE
 ; k++)

821 { i‡(
	`Ábs
 (
d©a_ö
 [
k
]) > 1.0)

822 { 
	`¥ötf
 ("\n\nLöê%d: I≈uàßm∂ê%d/%d (%fËha†nŸ bì¿˛ù≥d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
, 
d©a_ö
 [k]) ;

823 
	`exô
 (1) ;

826 i‡(
d©a_out
 [
k
] * 
d©a_ö
 [k] < 0.0)

827 { 
	`¥ötf
 ("\n\nLöê%d: D©®wø∞¨oundáàödex %d/%d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
) ;

828 
	`exô
 (1) ;

831 i‡(
	`Ábs
 (
d©a_out
 [
k
]) > 1.0)

834 
diff
 = 
	`Ábs
 (
d©a_out
 [
k
] - 
d©a_ö
 [k]) ;

835 i‡(
diff
 > 
˛ù_max_diff
)

836 
˛ù_max_diff
 = 
diff
 ;

839 i‡(
˛ù_max_diff
 < 1e-20)

840 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿsmÆ»“‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

841 
	`exô
 (1) ;

844 i‡(
˛ù_max_diff
 > 1.0 / 0x800000)

845 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿœrgê“‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

846 
	`exô
 (1) ;

850 
˛ù_max_diff
 = 0.0 ;

851 
k
 = 
HALF_BUFFER_SIZE
 ; k < 
BUFFER_SIZE
 ; k++)

852 { i‡(
	`Ábs
 (
d©a_ö
 [
k
]Ë> 
maxvÆ
)

853 { 
	`¥ötf
 ("\n\nLöê%d: I≈uàßm∂ê%d/%d (%fËha†nŸ bì¿˛ù≥d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
, 
d©a_ö
 [k]) ;

854 
	`exô
 (1) ;

857 i‡(
d©a_out
 [
k
] * 
d©a_ö
 [k] < 0.0)

858 { 
	`¥ötf
 ("\n\nLöê%d: D©®wø∞¨oundáàödex %d/%d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
) ;

859 
	`exô
 (1) ;

862 i‡(
	`Ábs
 (
d©a_out
 [
k
]Ë> 
maxvÆ
)

865 
diff
 = 
	`Ábs
 (
d©a_out
 [
k
] - 
d©a_ö
 [k]) ;

866 i‡(
diff
 > 
˛ù_max_diff
)

867 
˛ù_max_diff
 = 
diff
 ;

870 i‡(
˛ù_max_diff
 < 1e-20)

871 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿsmÆ»(un-n‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

872 
	`exô
 (1) ;

875 i‡(
˛ù_max_diff
 > 1.0)

876 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿœrgê(un-n‹mÆi£d).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

877 
	`exô
 (1) ;

880 
	`¥ötf
 ("ok\n") ;

881 
	`u∆ök
 (
fûíame
) ;

882 
	}
}

885 
	$dbl_sˇÀ_˛ù_ã°_32
 (c⁄° *
fûíame
, 
fûëy≥
, 
maxvÆ
)

886 { 
SNDFILE
 *
fûe
 ;

887 
SF_INFO
 
sföfo
 ;

888 
k
 ;

889 *
d©a_out
, *
d©a_ö
 ;

890 
diff
, 
˛ù_max_diff
 ;

892 
	`¥öt_ã°_«me
 ("dbl_sˇÀ_˛ù_ã°_32", 
fûíame
) ;

894 
d©a_out
 = 
buf„r_out
.
dbl
 ;

895 
d©a_ö
 = 
buf„r_ö
.
dbl
 ;

897 
k
 = 0 ; k < 
HALF_BUFFER_SIZE
 ; k++)

898 { 
d©a_out
 [
k
] = 
SINE_AMP
 * 
	`sö
 (2 * 
M_PI
 * k / 
HALF_BUFFER_SIZE
) ;

899 
d©a_out
 [
k
 + 
HALF_BUFFER_SIZE
] = d©a_ouà[k] * 
maxvÆ
 ;

902 
sföfo
.
ßm∂î©e
 = 44100 ;

903 
sföfo
.
‰ames
 = 123456789 ;

904 
sföfo
.
ch™√ls
 = 1 ;

905 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

913 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

914 
	`sf_comm™d
 (
fûe
, 
SFC_SET_CLIPPING
, 
NULL
, 
SF_TRUE
) ;

915 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a_out
, 
HALF_BUFFER_SIZE
, 
__LINE__
) ;

916 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

917 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a_out
 + 
HALF_BUFFER_SIZE
, HALF_BUFFER_SIZE, 
__LINE__
) ;

918 
	`sf_˛o£
 (
fûe
) ;

920 
	`mem£t
 (&
buf„r_ö
, 0,  (buffer_in)) ;

922 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

924 
sföfo
.
f‹m©
 &(
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_SUBMASK
) ;

926 i‡(
sföfo
.
f‹m©
 !(
fûëy≥
 & (
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_SUBMASK
)))

927 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

928 
	`exô
 (1) ;

931 i‡(
sföfo
.
‰ames
 !
BUFFER_SIZE
)

932 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûê(%d => %ld).\n\n", 
__LINE__
, 
BUFFER_SIZE
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

933 
	`exô
 (1) ;

936 i‡(
sföfo
.
ch™√ls
 != 1)

937 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n\n", 
__LINE__
) ;

938 
	`exô
 (1) ;

941 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

943 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a_ö
, 
HALF_BUFFER_SIZE
, 
__LINE__
) ;

944 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

945 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a_ö
 + 
HALF_BUFFER_SIZE
, HALF_BUFFER_SIZE, 
__LINE__
) ;

946 
	`sf_˛o£
 (
fûe
) ;

949 
˛ù_max_diff
 = 0.0 ;

950 
k
 = 0 ; k < 
HALF_BUFFER_SIZE
 ; k++)

951 { i‡(
	`Ábs
 (
d©a_ö
 [
k
]) > 1.0)

952 { 
	`¥ötf
 ("\n\nLöê%d: I≈uàßm∂ê%d/%d (%fËha†nŸ bì¿˛ù≥d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
, 
d©a_ö
 [k]) ;

953 
	`exô
 (1) ;

956 i‡(
d©a_out
 [
k
] * 
d©a_ö
 [k] < 0.0)

957 { 
	`¥ötf
 ("\n\nLöê%d: D©®wø∞¨oundáàödex %d/%d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
) ;

958 
	`exô
 (1) ;

961 i‡(
	`Ábs
 (
d©a_out
 [
k
]) > 1.0)

964 
diff
 = 
	`Ábs
 (
d©a_out
 [
k
] - 
d©a_ö
 [k]) ;

965 i‡(
diff
 > 
˛ù_max_diff
)

966 
˛ù_max_diff
 = 
diff
 ;

969 i‡(
˛ù_max_diff
 < 1e-20)

970 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿsmÆ»“‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

971 
	`exô
 (1) ;

974 i‡(
˛ù_max_diff
 > 1.0 / 0x80000000)

975 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿœrgê“‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

976 
	`exô
 (1) ;

980 
˛ù_max_diff
 = 0.0 ;

981 
k
 = 
HALF_BUFFER_SIZE
 ; k < 
BUFFER_SIZE
 ; k++)

982 { i‡(
	`Ábs
 (
d©a_ö
 [
k
]Ë> 
maxvÆ
)

983 { 
	`¥ötf
 ("\n\nLöê%d: I≈uàßm∂ê%d/%d (%fËha†nŸ bì¿˛ù≥d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
, 
d©a_ö
 [k]) ;

984 
	`exô
 (1) ;

987 i‡(
d©a_out
 [
k
] * 
d©a_ö
 [k] < 0.0)

988 { 
	`¥ötf
 ("\n\nLöê%d: D©®wø∞¨oundáàödex %d/%d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
) ;

989 
	`exô
 (1) ;

992 i‡(
	`Ábs
 (
d©a_out
 [
k
]Ë> 
maxvÆ
)

995 
diff
 = 
	`Ábs
 (
d©a_out
 [
k
] - 
d©a_ö
 [k]) ;

996 i‡(
diff
 > 
˛ù_max_diff
)

997 
˛ù_max_diff
 = 
diff
 ;

1000 i‡(
˛ù_max_diff
 < 1e-20)

1001 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿsmÆ»(un-n‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

1002 
	`exô
 (1) ;

1005 i‡(
˛ù_max_diff
 > 1.0)

1006 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿœrgê(un-n‹mÆi£d).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

1007 
	`exô
 (1) ;

1010 
	`¥ötf
 ("ok\n") ;

1011 
	`u∆ök
 (
fûíame
) ;

1012 
	}
}

1015 
	$dbl_sˇÀ_˛ù_ã°_08
 (c⁄° *
fûíame
, 
fûëy≥
, 
maxvÆ
)

1016 { 
SNDFILE
 *
fûe
 ;

1017 
SF_INFO
 
sföfo
 ;

1018 
k
 ;

1019 *
d©a_out
, *
d©a_ö
 ;

1020 
diff
, 
˛ù_max_diff
 ;

1022 
	`¥öt_ã°_«me
 ("dbl_sˇÀ_˛ù_ã°_08", 
fûíame
) ;

1024 
d©a_out
 = 
buf„r_out
.
dbl
 ;

1025 
d©a_ö
 = 
buf„r_ö
.
dbl
 ;

1027 
k
 = 0 ; k < 
HALF_BUFFER_SIZE
 ; k++)

1028 { 
d©a_out
 [
k
] = 
SINE_AMP
 * 
	`sö
 (2 * 
M_PI
 * k / 
HALF_BUFFER_SIZE
) ;

1029 
d©a_out
 [
k
 + 
HALF_BUFFER_SIZE
] = d©a_ouà[k] * 
maxvÆ
 ;

1032 
sföfo
.
ßm∂î©e
 = 44100 ;

1033 
sföfo
.
‰ames
 = 123456789 ;

1034 
sföfo
.
ch™√ls
 = 1 ;

1035 
sföfo
.
f‹m©
 = 
fûëy≥
 ;

1043 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

1044 
	`sf_comm™d
 (
fûe
, 
SFC_SET_CLIPPING
, 
NULL
, 
SF_TRUE
) ;

1045 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a_out
, 
HALF_BUFFER_SIZE
, 
__LINE__
) ;

1046 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

1047 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a_out
 + 
HALF_BUFFER_SIZE
, HALF_BUFFER_SIZE, 
__LINE__
) ;

1048 
	`sf_˛o£
 (
fûe
) ;

1050 
	`mem£t
 (&
buf„r_ö
, 0,  (buffer_in)) ;

1052 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

1054 
sföfo
.
f‹m©
 &(
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_SUBMASK
) ;

1056 i‡(
sföfo
.
f‹m©
 !(
fûëy≥
 & (
SF_FORMAT_TYPEMASK
 | 
SF_FORMAT_SUBMASK
)))

1057 { 
	`¥ötf
 ("\n\nLöê%d: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n\n", 
__LINE__
, 
fûëy≥
, 
sföfo
.
f‹m©
) ;

1058 
	`exô
 (1) ;

1061 i‡(
sföfo
.
‰ames
 !
BUFFER_SIZE
)

1062 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡‰ame†ö fûê(%d => %ld).\n\n", 
__LINE__
, 
BUFFER_SIZE
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
)) ;

1063 
	`exô
 (1) ;

1066 i‡(
sföfo
.
ch™√ls
 != 1)

1067 { 
	`¥ötf
 ("\n\nLöê%d: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n\n", 
__LINE__
) ;

1068 
	`exô
 (1) ;

1071 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

1073 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a_ö
, 
HALF_BUFFER_SIZE
, 
__LINE__
) ;

1074 
	`sf_comm™d
 (
fûe
, 
SFC_SET_NORM_DOUBLE
, 
NULL
, 
SF_FALSE
) ;

1075 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
d©a_ö
 + 
HALF_BUFFER_SIZE
, HALF_BUFFER_SIZE, 
__LINE__
) ;

1076 
	`sf_˛o£
 (
fûe
) ;

1079 
˛ù_max_diff
 = 0.0 ;

1080 
k
 = 0 ; k < 
HALF_BUFFER_SIZE
 ; k++)

1081 { i‡(
	`Ábs
 (
d©a_ö
 [
k
]) > 1.0)

1082 { 
	`¥ötf
 ("\n\nLöê%d: I≈uàßm∂ê%d/%d (%fËha†nŸ bì¿˛ù≥d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
, 
d©a_ö
 [k]) ;

1083 
	`exô
 (1) ;

1086 i‡(
d©a_out
 [
k
] * 
d©a_ö
 [k] < 0.0)

1087 { 
	`¥ötf
 ("\n\nLöê%d: D©®wø∞¨oundáàödex %d/%d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
) ;

1088 
	`exô
 (1) ;

1091 i‡(
	`Ábs
 (
d©a_out
 [
k
]) > 1.0)

1094 
diff
 = 
	`Ábs
 (
d©a_out
 [
k
] - 
d©a_ö
 [k]) ;

1095 i‡(
diff
 > 
˛ù_max_diff
)

1096 
˛ù_max_diff
 = 
diff
 ;

1099 i‡(
˛ù_max_diff
 < 1e-20)

1100 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿsmÆ»“‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

1101 
	`exô
 (1) ;

1104 i‡(
˛ù_max_diff
 > 1.0 / 0x80)

1105 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿœrgê“‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

1106 
	`exô
 (1) ;

1110 
˛ù_max_diff
 = 0.0 ;

1111 
k
 = 
HALF_BUFFER_SIZE
 ; k < 
BUFFER_SIZE
 ; k++)

1112 { i‡(
	`Ábs
 (
d©a_ö
 [
k
]Ë> 
maxvÆ
)

1113 { 
	`¥ötf
 ("\n\nLöê%d: I≈uàßm∂ê%d/%d (%fËha†nŸ bì¿˛ù≥d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
, 
d©a_ö
 [k]) ;

1114 
	`exô
 (1) ;

1117 i‡(
d©a_out
 [
k
] * 
d©a_ö
 [k] < 0.0)

1118 { 
	`¥ötf
 ("\n\nLöê%d: D©®wø∞¨oundáàödex %d/%d.\n\n", 
__LINE__
, 
k
, 
BUFFER_SIZE
) ;

1119 
	`exô
 (1) ;

1122 i‡(
	`Ábs
 (
d©a_out
 [
k
]Ë> 
maxvÆ
)

1125 
diff
 = 
	`Ábs
 (
d©a_out
 [
k
] - 
d©a_ö
 [k]) ;

1126 i‡(
diff
 > 
˛ù_max_diff
)

1127 
˛ù_max_diff
 = 
diff
 ;

1130 i‡(
˛ù_max_diff
 < 1e-20)

1131 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿsmÆ»(un-n‹mÆized).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

1132 
	`exô
 (1) ;

1135 i‡(
˛ù_max_diff
 > 1.0)

1136 { 
	`¥ötf
 ("\n\nLöê%d: Clùpög dif„ªn˚ (%eËtoÿœrgê(un-n‹mÆi£d).\n\n", 
__LINE__
, 
˛ù_max_diff
) ;

1137 
	`exô
 (1) ;

1140 
	`¥ötf
 ("ok\n") ;

1141 
	`u∆ök
 (
fûíame
) ;

1142 
	}
}

	@libsndfile-1.0.17/tests/sfversion.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°rög.h
>

24 #i‡
HAVE_UNISTD_H


25 
	~<uni°d.h
>

28 
	~<¢dfûe.h
>

30 
	#BUFFER_SIZE
 (256)

	)

32 
	g°rbuf„r
 [
BUFFER_SIZE
] ;

35 
	$maö
 ()

36 { 
	`sf_comm™d
 (
NULL
, 
SFC_GET_LIB_VERSION
, 
°rbuf„r
,  (strbuffer)) ;

38 
	`¥ötf
 ("%s", 
°rbuf„r
) ;

41 
	}
}

	@libsndfile-1.0.17/tests/stdin_test.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

24 
	~<m©h.h
>

26 #i‡
HAVE_UNISTD_H


27 
	~<uni°d.h
>

30 
	~<¢dfûe.h
>

32 
	~"utûs.h
"

34 
	#BUFFER_LEN
 (1<<16)

	)

36 
°dö_ã°
 (
ty≥maj‹
, 
cou¡
) ;

39 
	$maö
 (
¨gc
, *
¨gv
 [])

40 { 
do_Æl
 = 0, 
ã°_cou¡
 = 0 ;

42 i‡(
BUFFER_LEN
 < 
PIPE_TEST_LEN
)

43 { 
	`Ârötf
 (
°dîr
, "Error : BUFFER_LEN < PIPE_TEST_LEN.\n\n") ;

44 
	`exô
 (1) ;

47 i‡(
¨gc
 != 2)

48 { 
	`Ârötf
 (
°dîr
, "ThisÖrogram cannot beÑun by itself. ItÇeeds\n") ;

49 
	`Ârötf
 (
°dîr
, "to beÑun fromÅhe stdio_testÖrogram.\n") ;

50 
	`exô
 (1) ;

53 
do_Æl
 = ! 
	`°rcmp
 (
¨gv
 [1], "all") ;

55 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "raw"))

56 { 
	`°dö_ã°
 (
SF_FORMAT_RAW
, 
PIPE_TEST_LEN
) ;

57 
ã°_cou¡
++ ;

60 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "wav"))

61 { 
	`°dö_ã°
 (
SF_FORMAT_WAV
, 
PIPE_TEST_LEN
) ;

62 
ã°_cou¡
++ ;

65 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "aiff"))

66 { 
	`°dö_ã°
 (
SF_FORMAT_AIFF
, 
PIPE_TEST_LEN
) ;

67 
ã°_cou¡
++ ;

70 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "au"))

71 { 
	`°dö_ã°
 (
SF_FORMAT_AU
, 
PIPE_TEST_LEN
) ;

72 
ã°_cou¡
++ ;

75 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "paf"))

76 { 
	`°dö_ã°
 (
SF_FORMAT_PAF
, 
PIPE_TEST_LEN
) ;

77 
ã°_cou¡
++ ;

80 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "svx"))

81 { 
	`°dö_ã°
 (
SF_FORMAT_SVX
, 
PIPE_TEST_LEN
) ;

82 
ã°_cou¡
++ ;

85 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "nist"))

86 { 
	`°dö_ã°
 (
SF_FORMAT_NIST
, 
PIPE_TEST_LEN
) ;

87 
ã°_cou¡
++ ;

90 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "ircam"))

91 { 
	`°dö_ã°
 (
SF_FORMAT_IRCAM
, 
PIPE_TEST_LEN
) ;

92 
ã°_cou¡
++ ;

95 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "voc"))

96 { 
	`°dö_ã°
 (
SF_FORMAT_VOC
, 
PIPE_TEST_LEN
) ;

97 
ã°_cou¡
++ ;

100 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "w64"))

101 { 
	`°dö_ã°
 (
SF_FORMAT_W64
, 
PIPE_TEST_LEN
) ;

102 
ã°_cou¡
++ ;

105 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "mat4"))

106 { 
	`°dö_ã°
 (
SF_FORMAT_MAT4
, 
PIPE_TEST_LEN
) ;

107 
ã°_cou¡
++ ;

110 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "mat5"))

111 { 
	`°dö_ã°
 (
SF_FORMAT_MAT5
, 
PIPE_TEST_LEN
) ;

112 
ã°_cou¡
++ ;

115 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "pvf"))

116 { 
	`°dö_ã°
 (
SF_FORMAT_PVF
, 
PIPE_TEST_LEN
) ;

117 
ã°_cou¡
++ ;

120 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "htk"))

121 { 
	`°dö_ã°
 (
SF_FORMAT_HTK
, 
PIPE_TEST_LEN
) ;

122 
ã°_cou¡
++ ;

125 i‡(
ã°_cou¡
 == 0)

126 { 
	`Ârötf
 (
°dîr
, "************************************\n") ;

127 
	`Ârötf
 (
°dîr
, "* Nÿ'%s'Åe° deföed.\n", 
¨gv
 [1]) ;

128 
	`Ârötf
 (
°dîr
, "************************************\n") ;

133 
	}
}

136 
	$°dö_ã°
 (
ty≥maj‹
, 
cou¡
)

137 { 
d©a
 [
BUFFER_LEN
] ;

139 
SNDFILE
 *
fûe
 ;

140 
SF_INFO
 
sföfo
 ;

141 
k
, 
tŸÆ
 ;

143 i‡(
ty≥maj‹
 =
SF_FORMAT_RAW
)

144 { 
sföfo
.
ßm∂î©e
 = 44100 ;

145 
sföfo
.
f‹m©
 = 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_16
 ;

146 
sföfo
.
ch™√ls
 = 1 ;

147 
sföfo
.
‰ames
 = 0 ;

150 
sföfo
.
f‹m©
 = 0 ;

152 i‡(! (
fûe
 = 
	`sf_›í
 ("-", 
SFM_READ
, &
sföfo
)))

153 { 
	`Ârötf
 (
°dîr
, "sf_open_read failed withÉrror : ") ;

154 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

155 
	`dump_log_buf„r
 (
NULL
) ;

156 
	`exô
 (1) ;

159 i‡((
sföfo
.
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
ty≥maj‹
)

160 { 
	`Ârötf
 (
°dîr
, "\n\nError : FileÅype doesn't match.\n") ;

161 
	`exô
 (1) ;

164 i‡(
sföfo
.
ßm∂î©e
 != 44100)

165 { 
	`Ârötf
 (
°dîr
, "\n\nEº‹ : Sam∂êøã (%dËshould bê44100\n", 
sföfo
.
ßm∂î©e
) ;

166 
	`exô
 (1) ;

169 i‡(
sföfo
.
ch™√ls
 != 1)

170 { 
	`Ârötf
 (
°dîr
, "\n\nEº‹ : Ch™√l†(%dËshould bê1\n", 
sföfo
.
ch™√ls
) ;

171 
	`exô
 (1) ;

174 i‡(
sföfo
.
‰ames
 < 
cou¡
)

175 { 
	`Ârötf
 (
°dîr
, "\n\nEº‹ : Sam∂êcou¡ (%ldËshould bê%d\n", (Ë
sföfo
.
‰ames
, 
cou¡
) ;

176 
	`exô
 (1) ;

179 
tŸÆ
 = 0 ;

180 (
k
 = 
	`sf_ªad_sh‹t
 (
fûe
, 
d©a
 + 
tŸÆ
, 
BUFFER_LEN
 -Åotal)) > 0)

181 
tŸÆ
 +
k
 ;

183 i‡(
tŸÆ
 !
cou¡
)

184 { 
	`Ârötf
 (
°dîr
, "\n\nEº‹ : Ex≥˘ed %d fømes,Ñód %d.\n", 
cou¡
, 
tŸÆ
) ;

185 
	`exô
 (1) ;

188 
k
 = 0 ; k < 
tŸÆ
 ; k++)

189 i‡(
d©a
 [
k
] !
	`PIPE_INDEX
 (k))

190 { 
	`¥ötf
 ("\n\nEº‹ : d©®[%d] =%d, should havêbì¿%d.\n\n", 
k
, 
d©a
 [k], k) ;

191 
	`exô
 (1) ;

194 
	`sf_˛o£
 (
fûe
) ;

197 
	}
}

	@libsndfile-1.0.17/tests/stdio_test.c

24 
	~"sfc⁄fig.h
"

26 
	~<°dio.h
>

27 
	~<°dlib.h
>

28 
	~<°rög.h
>

30 #i‡
HAVE_UNISTD_H


31 
	~<uni°d.h
>

34 
	~<sys/ty≥s.h
>

35 
	~<sys/°©.h
>

37 #i‡
HAVE_SYS_WAIT_H


38 
	~<sys/waô.h
>

41 
	~"utûs.h
"

43 #i‡(
OS_IS_WIN32
)

46 
	$maö
 ()

48 
	`puts
 (" stdio_test :ÅhisÅest doesn't work on win32.") ;

50 
	}
}

54 #i‚de‡
WIFEXITED


55 
	#WIFEXITED
(
s
Ë(((sË& 0xffË=0)

	)

57 #i‚de‡
WEXITSTATUS


58 
	#WEXITSTATUS
(
s
Ë(((sË& 0xff00Ë>> 8)

	)

62 
size_t
 
fûe_Àngth
 (c⁄° *
fûíame
) ;

63 
fûe_exi°s
 (c⁄° *
fûíame
) ;

64 
°dio_ã°
 (c⁄° *
fûëy≥
) ;

66 c⁄° *
	gfûëy≥s
 [] =

69 
NULL


73 
	$maö
 ()

74 { 
k
 ;

76 i‡(
	`fûe_exi°s
 ("libsndfile.spec.in"))

77 
	`chdú
 ("tests") ;

79 
k
 = 0 ; 
fûëy≥s
 [k] ; k++)

80 
	`°dio_ã°
 (
fûëy≥s
 [
k
]) ;

83 
	}
}

87 
	$°dio_ã°
 (c⁄° *
fûëy≥
)

88 { 
buf„r
 [256] ;

90 
fûe_size
, 
ªtvÆ
 ;

92 
	`¥öt_ã°_«me
 ("°dio_ã°", 
fûëy≥
) ;

94 
	`¢¥ötf
 (
buf„r
,  (buf„r), "./°dout_ã° %†> stdio.%s", 
fûëy≥
, filetype) ;

95 i‡((
ªtvÆ
 = 
	`sy°em
 (
buf„r
)))

96 { 
ªtvÆ
 = 
	`WIFEXITED
 (ªtvÆË? 
	`WEXITSTATUS
 (retval) : 1 ;

97 
	`¥ötf
 ("%†: %s", 
buf„r
, (
	`°ªº‹
 (
ªtvÆ
))) ;

98 
	`exô
 (1) ;

101 
	`¢¥ötf
 (
buf„r
,  (buf„r), "°dio.%s", 
fûëy≥
) ;

102 i‡((
fûe_size
 = 
	`fûe_Àngth
 (
buf„r
)Ë< 
PIPE_TEST_LEN
)

103 { 
	`¥ötf
 ("\¿ Eº‹ :Åe° fûê'%s'ÅoÿsmÆ»(%d).\n\n", 
buf„r
, 
fûe_size
) ;

104 
	`exô
 (1) ;

107 
	`¢¥ötf
 (
buf„r
,  (buf„r), "./°dö_ã° %†< stdio.%s", 
fûëy≥
, filetype) ;

108 i‡((
ªtvÆ
 = 
	`sy°em
 (
buf„r
)))

109 { 
ªtvÆ
 = 
	`WIFEXITED
 (ªtvÆË? 
	`WEXITSTATUS
 (retval) : 1 ;

110 
	`¥ötf
 ("%†: %s", 
buf„r
, (
	`°ªº‹
 (
ªtvÆ
))) ;

111 
	`exô
 (1) ;

114 
	`¢¥ötf
 (
buf„r
,  (buf„r), "rm stdio.%s", 
fûëy≥
) ;

115 i‡((
ªtvÆ
 = 
	`sy°em
 (
buf„r
)))

116 { 
ªtvÆ
 = 
	`WIFEXITED
 (ªtvÆË? 
	`WEXITSTATUS
 (retval) : 1 ;

117 
	`¥ötf
 ("%†: %s", 
buf„r
, (
	`°ªº‹
 (
ªtvÆ
))) ;

118 
	`exô
 (1) ;

121 
	`puts
 ("ok") ;

124 
	}
}

129 
size_t


130 
	$fûe_Àngth
 (c⁄° *
fûíame
)

131 { 
°©
 
buf
 ;

133 i‡(
	`°©
 (
fûíame
, &
buf
))

134 { 
	`≥º‹
 (
fûíame
) ;

135 
	`exô
 (1) ;

138  
buf
.
°_size
 ;

139 
	}
}

142 
	$fûe_exi°s
 (c⁄° *
fûíame
)

143 { 
°©
 
buf
 ;

145 i‡(
	`°©
 (
fûíame
, &
buf
))

149 
	}
}

	@libsndfile-1.0.17/tests/stdout_test.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

24 
	~<m©h.h
>

26 #i‡
HAVE_UNISTD_H


27 
	~<uni°d.h
>

30 
	~<¢dfûe.h
>

32 
	~"utûs.h
"

34 
°dout_ã°
 (
ty≥maj‹
, 
cou¡
) ;

37 
	$maö
 (
¨gc
, *
¨gv
 [])

38 { 
do_Æl
, 
ã°_cou¡
 = 0 ;

40 i‡(
¨gc
 != 2)

41 { 
	`Ârötf
 (
°dîr
, "ThisÖrogram cannot beÑun by itself. ItÇeeds\n") ;

42 
	`Ârötf
 (
°dîr
, "to beÑun fromÅhe stdio_testÖrogram.\n") ;

43 
	`exô
 (1) ;

46 
do_Æl
 =! 
	`°rcmp
 (
¨gv
 [1], "all") ;

48 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "raw"))

49 { 
	`°dout_ã°
 (
SF_FORMAT_RAW
, 
PIPE_TEST_LEN
) ;

50 
ã°_cou¡
 ++ ;

53 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "wav"))

54 { 
	`°dout_ã°
 (
SF_FORMAT_WAV
, 
PIPE_TEST_LEN
) ;

55 
ã°_cou¡
 ++ ;

58 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "aiff"))

59 { 
	`°dout_ã°
 (
SF_FORMAT_AIFF
, 
PIPE_TEST_LEN
) ;

60 
ã°_cou¡
 ++ ;

63 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "au"))

64 { 
	`°dout_ã°
 (
SF_FORMAT_AU
, 
PIPE_TEST_LEN
) ;

65 
ã°_cou¡
 ++ ;

68 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "paf"))

69 { 
	`°dout_ã°
 (
SF_FORMAT_PAF
, 
PIPE_TEST_LEN
) ;

70 
ã°_cou¡
 ++ ;

73 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "svx"))

74 { 
	`°dout_ã°
 (
SF_FORMAT_SVX
, 
PIPE_TEST_LEN
) ;

75 
ã°_cou¡
 ++ ;

78 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "nist"))

79 { 
	`°dout_ã°
 (
SF_FORMAT_NIST
, 
PIPE_TEST_LEN
) ;

80 
ã°_cou¡
 ++ ;

83 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "ircam"))

84 { 
	`°dout_ã°
 (
SF_FORMAT_IRCAM
, 
PIPE_TEST_LEN
) ;

85 
ã°_cou¡
 ++ ;

88 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "voc"))

89 { 
	`°dout_ã°
 (
SF_FORMAT_VOC
, 
PIPE_TEST_LEN
) ;

90 
ã°_cou¡
 ++ ;

93 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "w64"))

94 { 
	`°dout_ã°
 (
SF_FORMAT_W64
, 
PIPE_TEST_LEN
) ;

95 
ã°_cou¡
 ++ ;

98 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "mat4"))

99 { 
	`°dout_ã°
 (
SF_FORMAT_MAT4
, 
PIPE_TEST_LEN
) ;

100 
ã°_cou¡
 ++ ;

103 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "mat5"))

104 { 
	`°dout_ã°
 (
SF_FORMAT_MAT5
, 
PIPE_TEST_LEN
) ;

105 
ã°_cou¡
 ++ ;

108 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "pvf"))

109 { 
	`°dout_ã°
 (
SF_FORMAT_PVF
, 
PIPE_TEST_LEN
) ;

110 
ã°_cou¡
 ++ ;

113 i‡(
ã°_cou¡
 == 0)

114 { 
	`Ârötf
 (
°dîr
, "************************************\n") ;

115 
	`Ârötf
 (
°dîr
, "* Nÿ'%s'Åe° deföed.\n", 
¨gv
 [1]) ;

116 
	`Ârötf
 (
°dîr
, "************************************\n") ;

121 
	}
}

124 
	$°dout_ã°
 (
ty≥maj‹
, 
cou¡
)

125 { 
d©a
 [
PIPE_TEST_LEN
] ;

127 
SNDFILE
 *
fûe
 ;

128 
SF_INFO
 
sföfo
 ;

129 
k
, 
tŸÆ
, 
this_wrôe
 ;

131 
sföfo
.
ßm∂î©e
 = 44100 ;

132 
sföfo
.
f‹m©
 = (
ty≥maj‹
 | 
SF_FORMAT_PCM_16
) ;

133 
sföfo
.
ch™√ls
 = 1 ;

134 
sföfo
.
‰ames
 = 0 ;

137 
k
 = 0 ; k < 
PIPE_TEST_LEN
 ; k++)

138 
d©a
 [
k
] = 
	`PIPE_INDEX
 (k) ;

140 i‡((
fûe
 = 
	`sf_›í
 ("-", 
SFM_WRITE
, &
sföfo
)Ë=
NULL
)

141 { 
	`Ârötf
 (
°dîr
, "sf_open_write failed withÉrror : ") ;

142 
	`Ârötf
 (
°dîr
, "%s\n", 
	`sf_°ªº‹
 (
NULL
)) ;

143 
	`exô
 (1) ;

146 
tŸÆ
 = 0 ;

148 
tŸÆ
 < 
cou¡
)

149 { 
this_wrôe
 = (
cou¡
 - 
tŸÆ
 > 1024) ? 1024 : count -Åotal ;

150 i‡((
k
 = 
	`sf_wrôe_sh‹t
 (
fûe
, 
d©a
 + 
tŸÆ
, 
this_wrôe
)) !=Åhis_write)

151 { 
	`Ârötf
 (
°dîr
, "sf_wrôe_sh‹à# %d faûed wôh sh‹àwrôê(%d -> %d)\n", 
cou¡
, 
this_wrôe
, 
k
) ;

152 
	`exô
 (1) ;

154 
tŸÆ
 +
k
 ;

157 
	`sf_˛o£
 (
fûe
) ;

160 
	}
}

	@libsndfile-1.0.17/tests/string_test.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

24 
	~<m©h.h
>

26 #i‡
HAVE_UNISTD_H


27 
	~<uni°d.h
>

30 
	~<¢dfûe.h
>

32 
	~"utûs.h
"

34 
	#BUFFER_LEN
 (1 << 10)

	)

35 
	#LOG_BUFFER_SIZE
 1024

	)

37 
°rög_ã°
 (c⁄° *
fûíame
, 
ty≥maj‹
) ;

39 
lib¢dfûe_°r_cou¡
 (c⁄° * 
˝å
) ;

42 
	$maö
 (
¨gc
, *
¨gv
 [])

43 { 
do_Æl
 = 0 ;

44 
ã°_cou¡
 = 0 ;

46 i‡(
¨gc
 != 2)

47 { 
	`¥ötf
 ("Ußgê: %†<ã°>\n", 
¨gv
 [0]) ;

48 
	`¥ötf
 (" Where <test> is one ofÅhe following:\n") ;

49 
	`¥ötf
 (" wav -Åestádding stringsÅo WAV files\n") ;

50 
	`¥ötf
 ("áiff -Åestádding stringsÅo AIFF files\n") ;

51 
	`¥ötf
 ("áll -ÖerformállÅests\n") ;

52 
	`exô
 (1) ;

55 
do_Æl
 =! 
	`°rcmp
 (
¨gv
 [1], "all") ;

57 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "wav"))

58 { 
	`°rög_ã°
 ("°rögs.wav", 
SF_FORMAT_WAV
) ;

59 
ã°_cou¡
++ ;

62 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "aiff"))

63 { 
	`°rög_ã°
 ("°rögs.aiff", 
SF_FORMAT_AIFF
) ;

64 
ã°_cou¡
++ ;

67 i‡(
ã°_cou¡
 == 0)

68 { 
	`¥ötf
 ("Mono : ************************************\n") ;

69 
	`¥ötf
 ("M⁄ÿ: * Nÿ'%s'Åe° deföed.\n", 
¨gv
 [1]) ;

70 
	`¥ötf
 ("Mono : ************************************\n") ;

75 
	}
}

83 
	gso·w¨e
 [] = "software (libsndfile-X.Y.Z)",

84 
	g¨ti°
 [] = "The Artist",

85 
	gc›yright
 [] = "Copyright (c) 2001 The Artist",

86 
	gcommít
 [] = "Comment goes here!!!",

87 
	gd©e
 [] = "2001/01/27" ;

89 
	gd©a_out
 [
BUFFER_LEN
] ;

92 
	$°rög_ã°
 (c⁄° *
fûíame
, 
ty≥maj‹
)

93 { c⁄° *
˝å
 ;

94 
SNDFILE
 *
fûe
 ;

95 
SF_INFO
 
sföfo
 ;

96 
‰ames
, 
îr‹s
 = 0 ;

98 
ty≥maj‹
 =Åypemajor ;

100 
	`¥öt_ã°_«me
 ("°rög_ã°", 
fûíame
) ;

102 
sföfo
.
ßm∂î©e
 = 44100 ;

103 
sföfo
.
ch™√ls
 = 1 ;

104 
sföfo
.
‰ames
 = 0 ;

106 
ty≥maj‹
)

107 { 
SF_FORMAT_WAV
 :

108 
sföfo
.
f‹m©
 = (
ty≥maj‹
 | 
SF_FORMAT_PCM_U8
) ;

112 
sföfo
.
f‹m©
 = (
ty≥maj‹
 | 
SF_FORMAT_PCM_S8
) ;

116 
‰ames
 = 
BUFFER_LEN
 / 
sföfo
.
ch™√ls
 ;

118 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

121 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_TITLE
, 
fûíame
) ;

122 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_SOFTWARE
, 
so·w¨e
) ;

123 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_ARTIST
, 
¨ti°
) ;

126 
	`ã°_wrôe_sh‹t_‹_dõ
 (
fûe
, 0, 
d©a_out
, 
BUFFER_LEN
, 
__LINE__
) ;

127 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

130 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_COPYRIGHT
, 
c›yright
) ;

131 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_COMMENT
, 
commít
) ;

132 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_DATE
, 
d©e
) ;

134 
	`sf_˛o£
 (
fûe
) ;

136 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
SF_TRUE
, 
__LINE__
) ;

138 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

140 i‡(
sföfo
.
‰ames
 !
BUFFER_LEN
)

141 { 
	`¥ötf
 ("***** Bad fømêcou¡ %d (should bê%d)\n\n", (Ë
sföfo
.
‰ames
, 
BUFFER_LEN
) ;

142 
îr‹s
 ++ ;

145 
˝å
 = 
	`sf_gë_°rög
 (
fûe
, 
SF_STR_TITLE
) ;

146 i‡(
˝å
 =
NULL
 || 
	`°rcmp
 (
fûíame
, cptr) != 0)

147 { i‡(
îr‹s
++ == 0)

148 
	`puts
 ("\n") ;

149 
	`¥ötf
 (" Bad fûíamê : %s\n", 
˝å
) ;

152 
˝å
 = 
	`sf_gë_°rög
 (
fûe
, 
SF_STR_COPYRIGHT
) ;

153 i‡(
˝å
 =
NULL
 || 
	`°rcmp
 (
c›yright
, cptr) != 0)

154 { i‡(
îr‹s
++ == 0)

155 
	`puts
 ("\n") ;

156 
	`¥ötf
 (" Bad c›yrighà: %s\n", 
˝å
) ;

159 
˝å
 = 
	`sf_gë_°rög
 (
fûe
, 
SF_STR_SOFTWARE
) ;

160 i‡(
˝å
 =
NULL
 || 
	`°r°r
 (˝å, 
so·w¨e
) != cptr)

161 { i‡(
îr‹s
++ == 0)

162 
	`puts
 ("\n") ;

163 
	`¥ötf
 (" Bad so·w¨ê : %s\n", 
˝å
) ;

166 i‡(
	`lib¢dfûe_°r_cou¡
 (
˝å
) != 1)

167 { i‡(
îr‹s
++ == 0)

168 
	`puts
 ("\n") ;

169 
	`¥ötf
 (" Bad so·w¨ê : %s\n", 
˝å
) ;

172 
˝å
 = 
	`sf_gë_°rög
 (
fûe
, 
SF_STR_ARTIST
) ;

173 i‡(
˝å
 =
NULL
 || 
	`°rcmp
 (
¨ti°
, cptr) != 0)

174 { i‡(
îr‹s
++ == 0)

175 
	`puts
 ("\n") ;

176 
	`¥ötf
 (" Badáπi° : %s\n", 
˝å
) ;

179 
˝å
 = 
	`sf_gë_°rög
 (
fûe
, 
SF_STR_COMMENT
) ;

180 i‡(
˝å
 =
NULL
 || 
	`°rcmp
 (
commít
, cptr) != 0)

181 { i‡(
îr‹s
++ == 0)

182 
	`puts
 ("\n") ;

183 
	`¥ötf
 (" Bad commíà : %s\n", 
˝å
) ;

186 i‡(
ty≥maj‹
 !
SF_FORMAT_AIFF
)

187 { 
˝å
 = 
	`sf_gë_°rög
 (
fûe
, 
SF_STR_DATE
) ;

188 i‡(
˝å
 =
NULL
 || 
	`°rcmp
 (
d©e
, cptr) != 0)

189 { i‡(
îr‹s
++ == 0)

190 
	`puts
 ("\n") ;

191 
	`¥ötf
 (" Bad d©ê : %s\n", 
˝å
) ;

195 i‡(
îr‹s
 > 0)

196 { 
	`¥ötf
 ("\n*** Eº‹ cou¡ : %d ***\n\n", 
îr‹s
) ;

197 
	`dump_log_buf„r
 (
fûe
) ;

198 
	`exô
 (1) ;

201 
	`sf_˛o£
 (
fûe
) ;

202 
	`u∆ök
 (
fûíame
) ;

204 
	`puts
 ("ok") ;

205 
	}
}

208 
	$lib¢dfûe_°r_cou¡
 (c⁄° * 
°r
)

209 { c⁄° * 
˝å
 ;

211 i‡((
˝å
 = 
	`°r°r
 (
°r
, "lib¢dfûe")Ë=
NULL
)

214 i‡((
˝å
 = 
	`°r°r
 (˝å + 1, "lib¢dfûe")Ë=
NULL
)

218 
	}
}

	@libsndfile-1.0.17/tests/ulaw_test.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

24 #i‡
HAVE_UNISTD_H


25 
	~<uni°d.h
>

28 
	~<¢dfûe.h
>

30 
	~"utûs.h
"

32 
	#BUFFER_SIZE
 (65536)

	)

34 
uœw_ícode
 (
ßm∂e
) ;

35 
uœw_decode
 (
uœwbyã
) ;

37 
	gsh‹t_buf„r
 [
BUFFER_SIZE
] ;

38 
	guœw_buf„r
 [
BUFFER_SIZE
] ;

41 
	$maö
 ()

42 { 
SNDFILE
 *
fûe
 ;

43 
SF_INFO
 
sföfo
 ;

44 c⁄° *
fûíame
 ;

45 
k
 ;

47 
fûíame
 = "test.raw" ;

49 
sföfo
.
f‹m©
 = 
SF_FORMAT_RAW
 | 
SF_FORMAT_ULAW
 ;

50 
sföfo
.
ßm∂î©e
 = 44100 ;

51 
sföfo
.
‰ames
 = 123456789 ;

52 
sföfo
.
ch™√ls
 = 1 ;

54 i‡((
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_WRITE
, &
sföfo
)Ë=
NULL
)

55 { 
	`¥ötf
 ("sf_open_write failed withÉrror : ") ;

56 
	`fÊush
 (
°dout
) ;

57 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

58 
	`exô
 (1) ;

65 
k
 = 0 ; k < 0x10000 ; k++)

66 
sh‹t_buf„r
 [
k
] = k & 0xFFFF ;

68 
	`sf_wrôe_sh‹t
 (
fûe
, 
sh‹t_buf„r
, 
BUFFER_SIZE
) ;

69 
	`sf_˛o£
 (
fûe
) ;

75 i‡((
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_READ
, &
sföfo
)Ë=
NULL
)

76 { 
	`¥ötf
 ("sf_open_write failed withÉrror : ") ;

77 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

78 
	`exô
 (1) ;

81 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

83 i‡(
	`sf_ªad_øw
 (
fûe
, 
uœw_buf„r
, 
BUFFER_SIZE
) != BUFFER_SIZE)

84 { 
	`¥ötf
 ("sf_read_raw : ") ;

85 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

86 
	`exô
 (1) ;

89 
k
 = 0 ; k < 0x10000 ; k++)

90 i‡(
	`uœw_ícode
 (
sh‹t_buf„r
 [
k
]Ë!
uœw_buf„r
 [k])

91 { 
	`¥ötf
 ("EncodîÉº‹ : sam∂ê#%d (0x%02X should bê0x%02X)\n", 
k
, 
uœw_buf„r
 [k], 
	`uœw_ícode
 (
sh‹t_buf„r
 [k])) ;

92 
	`exô
 (1) ;

95 
	`sf_˛o£
 (
fûe
) ;

97 
	`¥ötf
 (" ulaw_test :Éncoder ... ok\n") ;

103 i‡(! (
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_WRITE
, &
sföfo
)))

104 { 
	`¥ötf
 ("sf_open_write failed withÉrror : ") ;

105 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

106 
	`exô
 (1) ;

109 
k
 = 0 ; k < 256 ; k++)

110 
uœw_buf„r
 [
k
] = k & 0xFF ;

112 
	`sf_wrôe_øw
 (
fûe
, 
uœw_buf„r
, 256) ;

113 
	`sf_˛o£
 (
fûe
) ;

119 i‡(! (
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_READ
, &
sföfo
)))

120 { 
	`¥ötf
 ("sf_open_write failed withÉrror : ") ;

121 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

122 
	`exô
 (1) ;

125 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

127 i‡(
	`sf_ªad_sh‹t
 (
fûe
, 
sh‹t_buf„r
, 256) != 256)

128 { 
	`¥ötf
 ("sf_read_short : ") ;

129 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

130 
	`exô
 (1) ;

134 
k
 = 0 ; k < 256 ; k++)

135 i‡(
sh‹t_buf„r
 [
k
] !
	`uœw_decode
 (
uœw_buf„r
 [k]))

136 { 
	`¥ötf
 ("DecodîÉº‹ : sam∂ê#%d (0x%04X should bê0x%04X)\n", 
k
, 
sh‹t_buf„r
 [k], 
	`uœw_decode
 (
uœw_buf„r
 [k])) ;

137 
	`exô
 (1) ;

140 
	`sf_˛o£
 (
fûe
) ;

142 
	`¥ötf
 (" ulaw_test : decoder ... ok\n") ;

144 
	`u∆ök
 (
fûíame
) ;

147 
	}
}

180 
	#uBIAS
 0x84

	)

181 
	#uCLIP
 32635

	)

184 
	$uœw_ícode
 (
ßm∂e
)

185 { 
exp_lut
 [256] =

204 
sign
, 
exp⁄ít
, 
m™tisß
 ;

205 
uœwbyã
 ;

208 
sign
 = (
ßm∂e
 >> 8) & 0x80 ;

209 i‡–
sign
 != 0 )

210 
ßm∂e
 = -sample ;

211 i‡–
ßm∂e
 > 
uCLIP
 )

212 
ßm∂e
 = 
uCLIP
 ;

215 
ßm∂e
 = sam∂ê+ 
uBIAS
 ;

216 
exp⁄ít
 = 
exp_lut
 [–
ßm∂e
 >> 7 ) & 0xFF] ;

217 
m™tisß
 = (
ßm∂e
 >> ( 
exp⁄ít
 + 3 ) ) & 0x0F ;

218 
uœwbyã
 = ~ (
sign
 | ( 
exp⁄ít
 << 4 ) | 
m™tisß
) ;

220  
uœwbyã
 ;

221 
	}
}

241 
	$uœw_decode
 (
uœwbyã
)

242 { 
exp_lut
 [8] = { 0, 132, 396, 924, 1980, 4092, 8316, 16764 } ;

243 
sign
, 
exp⁄ít
, 
m™tisß
, 
ßm∂e
 ;

245 
uœwbyã
 = ~ ulawbyte ;

246 
sign
 = (
uœwbyã
 & 0x80) ;

247 
exp⁄ít
 = (
uœwbyã
 >> 4) & 0x07 ;

248 
m™tisß
 = 
uœwbyã
 & 0x0F ;

249 
ßm∂e
 = 
exp_lut
 [
exp⁄ít
] + (
m™tisß
 << (exponent + 3)) ;

250 i‡(
sign
 != 0)

251 
ßm∂e
 = -sample ;

253  
ßm∂e
 ;

254 
	}
}

	@libsndfile-1.0.17/tests/utils.c

28 
	~"sfc⁄fig.h
"

30 
	~<°dio.h
>

31 
	~<°dlib.h
>

33 #i‡
HAVE_UNISTD_H


34 
	~<uni°d.h
>

37 #i‡(
HAVE_DECL_S_IRGRP
 == 0)

38 
	~<sf_uni°d.h
>

41 
	~<î∫o.h
>

42 
	~<°rög.h
>

43 
	~<˘y≥.h
>

44 
	~<m©h.h
>

45 
	~<f˙é.h
>

46 
	~<sys/°©.h
>

48 
	~<¢dfûe.h
>

50 
	~"utûs.h
"

52 #i‚def 
M_PI


53 
	#M_PI
 3.14159265358979323846264338

	)

56 
	#LOG_BUFFER_SIZE
 2048

	)

60 
	$gí_wödowed_söe_Êﬂt
 (*
d©a
, 
Àn
, 
maximum
)

61 { 
k
 ;

63 
	`mem£t
 (
d©a
, 0, 
Àn
 *  ()) ;

70 
Àn
 /= 2 ;

72 
k
 = 0 ; k < 
Àn
 ; k++)

73 { 
d©a
 [
k
] = 
	`sö
 (2.0 * k * 
M_PI
 * 1.0 / 32.0 + 0.4) ;

76 
d©a
 [
k
] *
maximum
 * (0.5 - 0.5 * 
	`cos
 (2.0 * 
M_PI
 * k / ((
Àn
) - 1))) ;

80 
	}
}

83 
	$gí_wödowed_söe_doubÀ
 (*
d©a
, 
Àn
, 
maximum
)

84 { 
k
 ;

86 
	`mem£t
 (
d©a
, 0, 
Àn
 *  ()) ;

93 
Àn
 /= 2 ;

95 
k
 = 0 ; k < 
Àn
 ; k++)

96 { 
d©a
 [
k
] = 
	`sö
 (2.0 * k * 
M_PI
 * 1.0 / 32.0 + 0.4) ;

99 
d©a
 [
k
] *
maximum
 * (0.5 - 0.5 * 
	`cos
 (2.0 * 
M_PI
 * k / ((
Àn
) - 1))) ;

103 
	}
}

107 
	$check_fûe_hash_‹_dõ
 (c⁄° *
fûíame
, 
èrgë_hash
, 
löe_num
)

108 { 
buf„r
 [2048] ;

109 
hash1
, 
hash2
 ;

110 
FILE
 *
fûe
 ;

111 
k
, 
ªad_cou¡
 ;

113 
	`mem£t
 (
buf„r
, 0xEE,  (buffer)) ;

116 i‡(! (
fûe
 = 
	`f›í
 (
fûíame
, "rb")))

117 { 
	`¥ötf
 ("\n\nLöê%d: couldÇŸ o≥¿fûê'%s'\n\n", 
löe_num
, 
fûíame
) ;

118 
	`exô
 (1) ;

121 
hash1
 = 
hash2
 = 0 ;

123 (
ªad_cou¡
 = 
	`‰ód
 (
buf„r
, 1,  (buf„r), 
fûe
)))

124 { 
k
 = 0 ; k < 
ªad_cou¡
 ; k++)

125 { 
hash1
 = hash1 + 
buf„r
 [
k
] ;

126 
hash2
 = hash2 ^ (
buf„r
 [
k
] << (k % 25)) ;

130 
	`f˛o£
 (
fûe
) ;

132 
hash1
 +
hash2
 ;

134 i‡(
èrgë_hash
 == 0)

135 { 
	`¥ötf
 (" 0x%08x ", 
hash1
) ;

139 i‡(
hash1
 !
èrgë_hash
)

140 { 
	`¥ötf
 ("\n\nLöê%d: inc‹ª˘ hash vÆuê0x%08x should bê0x%08x\n\n", 
löe_num
, 
hash1
, 
èrgë_hash
) ;

141 
	`exô
 (1) ;

145 
	}
}

148 
	$¥öt_ã°_«me
 (c⁄° *
ã°
, c⁄° *
fûíame
)

149 { 
cou¡
 ;

151 i‡(
ã°
 =
NULL
 || 
fûíame
 == NULL)

152 { 
	`¥ötf
 (
__FILE__
 ": badÅest of filenameÖarameter.\n") ;

153 
	`exô
 (1) ;

156 
	`¥ötf
 (" %-25†: %†", 
ã°
, 
fûíame
) ;

158 
cou¡
 = 24 - 
	`°æí
 (
fûíame
) ;

159 
cou¡
 -- > 0)

160 
	`putch¨
 ('.') ;

161 
	`putch¨
 (' ') ;

163 
	`fÊush
 (
°dout
) ;

164 
	}
}

167 
	$dump_d©a_to_fûe
 (c⁄° *
fûíame
, *
d©a
, 
d©Æí
)

168 { 
FILE
 *
fûe
 ;

170 i‡((
fûe
 = 
	`f›í
 (
fûíame
, "wb")Ë=
NULL
)

171 { 
	`¥ötf
 ("\n\nLöê%d : couldÇŸ o≥¿fûê: %s\n\n", 
__LINE__
, 
fûíame
) ;

172 
	`exô
 (1) ;

175 i‡(
	`fwrôe
 (
d©a
, 1, 
d©Æí
, 
fûe
) != datalen)

176 { 
	`¥ötf
 ("\n\nLöê%d : fwrôêÁûed.\n\n", 
__LINE__
) ;

177 
	`exô
 (1) ;

180 
	`f˛o£
 (
fûe
) ;

182 
	}
}

187 
	go˘fûíame
 [] = "error.dat" ;

190 
	$o˘_ßve_sh‹t
 (*
a
, *
b
, 
Àn
)

191 { 
FILE
 *
fûe
 ;

192 
k
 ;

194 i‡(! (
fûe
 = 
	`f›í
 (
o˘fûíame
, "w")))

197 
	`Ârötf
 (
fûe
, "# Not created by Octave\n") ;

199 
	`Ârötf
 (
fûe
, "#Çame:á\n") ;

200 
	`Ârötf
 (
fûe
, "#Åype: matrix\n") ;

201 
	`Ârötf
 (
fûe
, "#Ñows: %d\n", 
Àn
) ;

202 
	`Ârötf
 (
fûe
, "# columns: 1\n") ;

204 
k
 = 0 ; k < 
Àn
 ; k++)

205 
	`Ârötf
 (
fûe
, "% d\n", 
a
 [
k
]) ;

207 
	`Ârötf
 (
fûe
, "#Çame: b\n") ;

208 
	`Ârötf
 (
fûe
, "#Åype: matrix\n") ;

209 
	`Ârötf
 (
fûe
, "#Ñows: %d\n", 
Àn
) ;

210 
	`Ârötf
 (
fûe
, "# columns: 1\n") ;

212 
k
 = 0 ; k < 
Àn
 ; k++)

213 
	`Ârötf
 (
fûe
, "% d\n", 
b
 [
k
]) ;

215 
	`f˛o£
 (
fûe
) ;

217 
	}
}

219 
	$o˘_ßve_öt
 (*
a
, *
b
, 
Àn
)

220 { 
FILE
 *
fûe
 ;

221 
k
 ;

223 i‡(! (
fûe
 = 
	`f›í
 (
o˘fûíame
, "w")))

226 
	`Ârötf
 (
fûe
, "# Not created by Octave\n") ;

228 
	`Ârötf
 (
fûe
, "#Çame:á\n") ;

229 
	`Ârötf
 (
fûe
, "#Åype: matrix\n") ;

230 
	`Ârötf
 (
fûe
, "#Ñows: %d\n", 
Àn
) ;

231 
	`Ârötf
 (
fûe
, "# columns: 1\n") ;

233 
k
 = 0 ; k < 
Àn
 ; k++)

234 
	`Ârötf
 (
fûe
, "% d\n", 
a
 [
k
]) ;

236 
	`Ârötf
 (
fûe
, "#Çame: b\n") ;

237 
	`Ârötf
 (
fûe
, "#Åype: matrix\n") ;

238 
	`Ârötf
 (
fûe
, "#Ñows: %d\n", 
Àn
) ;

239 
	`Ârötf
 (
fûe
, "# columns: 1\n") ;

241 
k
 = 0 ; k < 
Àn
 ; k++)

242 
	`Ârötf
 (
fûe
, "% d\n", 
b
 [
k
]) ;

244 
	`f˛o£
 (
fûe
) ;

246 
	}
}

248 
	$o˘_ßve_Êﬂt
 (*
a
, *
b
, 
Àn
)

249 { 
FILE
 *
fûe
 ;

250 
k
 ;

252 i‡(! (
fûe
 = 
	`f›í
 (
o˘fûíame
, "w")))

255 
	`Ârötf
 (
fûe
, "# Not created by Octave\n") ;

257 
	`Ârötf
 (
fûe
, "#Çame:á\n") ;

258 
	`Ârötf
 (
fûe
, "#Åype: matrix\n") ;

259 
	`Ârötf
 (
fûe
, "#Ñows: %d\n", 
Àn
) ;

260 
	`Ârötf
 (
fûe
, "# columns: 1\n") ;

262 
k
 = 0 ; k < 
Àn
 ; k++)

263 
	`Ârötf
 (
fûe
, "% g\n", 
a
 [
k
]) ;

265 
	`Ârötf
 (
fûe
, "#Çame: b\n") ;

266 
	`Ârötf
 (
fûe
, "#Åype: matrix\n") ;

267 
	`Ârötf
 (
fûe
, "#Ñows: %d\n", 
Àn
) ;

268 
	`Ârötf
 (
fûe
, "# columns: 1\n") ;

270 
k
 = 0 ; k < 
Àn
 ; k++)

271 
	`Ârötf
 (
fûe
, "% g\n", 
b
 [
k
]) ;

273 
	`f˛o£
 (
fûe
) ;

275 
	}
}

277 
	$o˘_ßve_doubÀ
 (*
a
, *
b
, 
Àn
)

278 { 
FILE
 *
fûe
 ;

279 
k
 ;

281 i‡(! (
fûe
 = 
	`f›í
 (
o˘fûíame
, "w")))

284 
	`Ârötf
 (
fûe
, "# Not created by Octave\n") ;

286 
	`Ârötf
 (
fûe
, "#Çame:á\n") ;

287 
	`Ârötf
 (
fûe
, "#Åype: matrix\n") ;

288 
	`Ârötf
 (
fûe
, "#Ñows: %d\n", 
Àn
) ;

289 
	`Ârötf
 (
fûe
, "# columns: 1\n") ;

291 
k
 = 0 ; k < 
Àn
 ; k++)

292 
	`Ârötf
 (
fûe
, "% g\n", 
a
 [
k
]) ;

294 
	`Ârötf
 (
fûe
, "#Çame: b\n") ;

295 
	`Ârötf
 (
fûe
, "#Åype: matrix\n") ;

296 
	`Ârötf
 (
fûe
, "#Ñows: %d\n", 
Àn
) ;

297 
	`Ârötf
 (
fûe
, "# columns: 1\n") ;

299 
k
 = 0 ; k < 
Àn
 ; k++)

300 
	`Ârötf
 (
fûe
, "% g\n", 
b
 [
k
]) ;

302 
	`f˛o£
 (
fûe
) ;

304 
	}
}

308 
	$check_log_buf„r_‹_dõ
 (
SNDFILE
 *
fûe
, 
löe_num
)

309 { 
buf„r
 [
LOG_BUFFER_SIZE
] ;

310 
cou¡
 ;

312 
	`mem£t
 (
buf„r
, 0, 
LOG_BUFFER_SIZE
) ;

315 
cou¡
 = 
	`sf_comm™d
 (
fûe
, 
SFC_GET_LOG_INFO
, 
buf„r
, 
LOG_BUFFER_SIZE
) ;

317 i‡(
LOG_BUFFER_SIZE
 - 
cou¡
 < 2)

318 { 
	`¥ötf
 ("\n\nLöê%d : PossibÀÜ⁄gÜog buf„r.\n", 
löe_num
) ;

319 
	`exô
 (1) ;

323 i‡(
	`°r°r
 (
buf„r
, "ould"))

324 { 
	`¥ötf
 ("\n\nLöê%d : Log buf„∏c⁄èö†`ould'. Dumpög.\n", 
löe_num
) ;

325 
	`puts
 (
buf„r
) ;

326 
	`exô
 (1) ;

330 i‡(
	`°r°r
 (
buf„r
, "*"))

331 { 
	`¥ötf
 ("\n\nLöê%d : Log buf„∏c⁄èö†`*'. Dumpög.\n", 
löe_num
) ;

332 
	`puts
 (
buf„r
) ;

333 
	`exô
 (1) ;

337 i‡(
	`°r°r
 (
buf„r
, "nknown marker"))

338 { 
	`¥ötf
 ("\n\nLöê%d : Log buf„∏c⁄èö†`nknow¿m¨kî'. Dumpög.\n", 
löe_num
) ;

339 
	`puts
 (
buf„r
) ;

340 
	`exô
 (1) ;

344 
	}
}

347 
	$°rög_ö_log_buf„r
 (
SNDFILE
 *
fûe
, c⁄° *
s
)

348 { 
buf„r
 [
LOG_BUFFER_SIZE
] ;

349 
cou¡
 ;

351 
	`mem£t
 (
buf„r
, 0, 
LOG_BUFFER_SIZE
) ;

354 
cou¡
 = 
	`sf_comm™d
 (
fûe
, 
SFC_GET_LOG_INFO
, 
buf„r
, 
LOG_BUFFER_SIZE
) ;

356 i‡(
LOG_BUFFER_SIZE
 - 
cou¡
 < 2)

357 { 
	`¥ötf
 ("PossibleÜongÜog buffer.\n") ;

358 
	`exô
 (1) ;

362  
	`°r°r
 (
buf„r
, 
s
Ë? 
SF_TRUE
 : 
SF_FALSE
 ;

363 
	}
}

366 
	$hexdump_fûe
 (c⁄° * 
fûíame
, 
sf_cou¡_t
 
off£t
, sf_cou¡_à
Àngth
)

368 
FILE
 * 
fûe
 ;

369 
buf„r
 [16] ;

370 
k
, 
m
, 
ch
, 
ªadcou¡
 ;

372 i‡(
Àngth
 > 1000000)

373 { 
	`¥ötf
 ("\n\nEº‹ :Üígth (%ldËtoÿl⁄g.\n\n", 
	`SF_COUNT_TO_LONG
 (
off£t
)) ;

374 
	`exô
 (1) ;

377 i‡((
fûe
 = 
	`f›í
 (
fûíame
, "r")Ë=
NULL
)

378 { 
	`¥ötf
 ("\n\nEº‹ : hexdump_fûê(%sËcouldÇŸ o≥¿fûêf‹Ñód.\n\n", 
fûíame
) ;

379 
	`exô
 (1) ;

382 i‡(
	`f£ek
 (
fûe
, 
off£t
, 
SEEK_SET
) != 0)

383 { 
	`¥ötf
 ("\n\nEº‹ : f£ek(fûe, %ld, SEEK_SETËÁûed : %s\n\n", 
	`SF_COUNT_TO_LONG
 (
off£t
), 
	`°ªº‹
 (
î∫o
)) ;

384 
	`exô
 (1) ;

387 
	`puts
 ("\n\n") ;

389 
k
 = 0 ; k < 
Àngth
 ; k+ (
buf„r
))

390 { 
ªadcou¡
 = 
	`‰ód
 (
buf„r
, 1,  (buf„r), 
fûe
) ;

392 
	`¥ötf
 ("%08lx : ", 
	`SF_COUNT_TO_LONG
 (
off£t
 + 
k
)) ;

394 
m
 = 0 ; m < 
ªadcou¡
 ; m++)

395 
	`¥ötf
 ("%02x ", 
buf„r
 [
m
] & 0xFF) ;

397 
m
 = 
ªadcou¡
 ; m < 
	`SIGNED_SIZEOF
 (
buf„r
) ; m++)

398 
	`¥ötf
 (" ") ;

400 
	`¥ötf
 (" ") ;

401 
m
 = 0 ; m < 
ªadcou¡
 ; m++)

402 { 
ch
 = 
	`i•röt
 (
buf„r
 [
m
]) ? buffer [m] : '.' ;

403 
	`putch¨
 (
ch
) ;

406 i‡(
ªadcou¡
 < 
	`SIGNED_SIZEOF
 (
buf„r
))

409 
	`putch¨
 ('\n') ;

412 
	`puts
 ("\n") ;

414 
	`f˛o£
 (
fûe
) ;

415 
	}
}

418 
	$dump_log_buf„r
 (
SNDFILE
 *
fûe
)

419 { 
buf„r
 [
LOG_BUFFER_SIZE
] ;

420 
cou¡
 ;

422 
	`mem£t
 (
buf„r
, 0, 
LOG_BUFFER_SIZE
) ;

425 
cou¡
 = 
	`sf_comm™d
 (
fûe
, 
SFC_GET_LOG_INFO
, 
buf„r
, 
LOG_BUFFER_SIZE
) ;

427 i‡(
	`°æí
 (
buf„r
) < 1)

428 
	`puts
 ("Log bufferÉmpty.\n") ;

430 
	`puts
 (
buf„r
) ;

433 
	}
}

435 
SNDFILE
 *

436 
	$ã°_›í_fûe_‹_dõ
 (c⁄° *
fûíame
, 
mode
, 
SF_INFO
 *
sföfo
, 
Ælow_fd
, 
löe_num
)

437 { 
cou¡
 = 0 ;

439 
SNDFILE
 *
fûe
 ;

440 c⁄° *
mode°r
, *
func_«me
 ;

441 
oÊags
 = 0, 
omode
 = 0 ;

447 
mode
)

448 { 
SFM_READ
 :

449 
mode°r
 = "SFM_READ" ;

450 
oÊags
 = 
O_RDONLY
 ;

451 
omode
 = 0 ;

454 
SFM_WRITE
 :

455 
mode°r
 = "SFM_WRITE" ;

456 
oÊags
 = 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 ;

457 
omode
 = 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 ;

460 
SFM_RDWR
 :

461 
mode°r
 = "SFM_RDWR" ;

462 
oÊags
 = 
O_RDWR
 | 
O_CREAT
 ;

463 
omode
 = 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 ;

466 
	`¥ötf
 ("\n\nLöê%d: Bad mode.\n", 
löe_num
) ;

467 
	`fÊush
 (
°dout
) ;

468 
	`exô
 (1) ;

471 #i‡(
	`deföed
 (
WIN32
Ë|| deföed (
_WIN32
))

473 
oÊags
 |
O_BINARY
 ;

476 i‡(
Ælow_fd
 && ((++
cou¡
) & 1) == 1)

477 { 
fd
 ;

479 i‡(
omode
 == 0)

480 
fd
 = 
	`›í
 (
fûíame
, 
oÊags
) ;

482 
fd
 = 
	`›í
 (
fûíame
, 
oÊags
, 
omode
) ;

484 i‡(
fd
 < 0)

485 { 
	`≥º‹
 ("open") ;

486 
	`exô
 (1) ;

489 
func_«me
 = "sf_open_fd" ;

490 
fûe
 = 
	`sf_›í_fd
 (
fd
, 
mode
, 
sföfo
, 
SF_TRUE
) ;

493 { 
func_«me
 = "sf_open" ;

494 
fûe
 = 
	`sf_›í
 (
fûíame
, 
mode
, 
sföfo
) ;

497 i‡(
fûe
 =
NULL
)

498 { 
	`¥ötf
 ("\n\nLöê%d: %†(%sËÁûed : %s\n\n", 
löe_num
, 
func_«me
, 
mode°r
, 
	`sf_°ªº‹
 (
NULL
)) ;

499 
	`dump_log_buf„r
 (
fûe
) ;

500 
	`exô
 (1) ;

503  
fûe
 ;

504 
	}
}

507 
	$ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
SNDFILE
 *
fûe
, 
löe_num
, 
∑ss
, 
sf_cou¡_t
 
ªad_pos
, sf_cou¡_à
wrôe_pos
)

508 { 
sf_cou¡_t
 
pos
 ;

511 i‡(
ªad_pos
 >0 && (
pos
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
 | 
SFM_READ
)) !=Ñead_pos)

512 { 
	`¥ötf
 ("\n\nLöê%d ", 
löe_num
) ;

513 i‡(
∑ss
 > 0)

514 
	`¥ötf
 ("’as†%d): ", 
∑ss
) ;

515 
	`¥ötf
 ("RódÖosôi⁄ (%ldËshould bê%ld.\n", 
	`SF_COUNT_TO_LONG
 (
pos
), SF_COUNT_TO_LONG (
ªad_pos
)) ;

516 
	`exô
 (1) ;

520 i‡(
wrôe_pos
 >0 && (
pos
 = 
	`sf_£ek
 (
fûe
, 0, 
SEEK_CUR
 | 
SFM_WRITE
)) != write_pos)

521 { 
	`¥ötf
 ("\n\nLöê%d", 
löe_num
) ;

522 i‡(
∑ss
 > 0)

523 
	`¥ötf
 (" (∑s†%d)", 
∑ss
) ;

524 
	`¥ötf
 (" : WriteÖosition (%ld) should be %ld.\n",

525 
	`SF_COUNT_TO_LONG
 (
pos
), SF_COUNT_TO_LONG (
wrôe_pos
)) ;

526 
	`exô
 (1) ;

530 
	}
}

533 
	$ã°_£ek_‹_dõ
 (
SNDFILE
 *
fûe
, 
sf_cou¡_t
 
off£t
, 
whí˚
, sf_cou¡_à
√w_pos
, 
ch™√ls
, 
löe_num
)

534 { 
sf_cou¡_t
 
posôi⁄
 ;

535 c⁄° *
ch™√l_«me
, *
whí˚_«me
 ;

537 
whí˚
)

538 { 
SEEK_SET
 :

539 
whí˚_«me
 = "SEEK_SET" ;

541 
SEEK_CUR
 :

542 
whí˚_«me
 = "SEEK_CUR" ;

544 
SEEK_END
 :

545 
whí˚_«me
 = "SEEK_END" ;

549 
SEEK_SET
 | 
SFM_READ
 :

550 
whí˚_«me
 = "SFM_READ | SEEK_SET" ;

552 
SEEK_CUR
 | 
SFM_READ
 :

553 
whí˚_«me
 = "SFM_READ | SEEK_CUR" ;

555 
SEEK_END
 | 
SFM_READ
 :

556 
whí˚_«me
 = "SFM_READ | SEEK_END" ;

560 
SEEK_SET
 | 
SFM_WRITE
 :

561 
whí˚_«me
 = "SFM_WRITE | SEEK_SET" ;

563 
SEEK_CUR
 | 
SFM_WRITE
 :

564 
whí˚_«me
 = "SFM_WRITE | SEEK_CUR" ;

566 
SEEK_END
 | 
SFM_WRITE
 :

567 
whí˚_«me
 = "SFM_WRITE | SEEK_END" ;

571 
	`¥ötf
 ("\n\nLöê%d: bad whí˚Ö¨amëî.\n", 
löe_num
) ;

572 
	`exô
 (1) ;

575 
ch™√l_«me
 = (
ch™√ls
 == 1) ? "Mono" : "Stereo" ;

577 i‡((
posôi⁄
 = 
	`sf_£ek
 (
fûe
, 
off£t
, 
whí˚
)Ë!
√w_pos
)

578 { 
	`¥ötf
 ("\n\nLine %d : %s : sf_seek (file, %ld, %s)Ñeturned %ld (should be %ld).\n\n",

579 
löe_num
, 
ch™√l_«me
, 
	`SF_COUNT_TO_LONG
 (
off£t
), 
whí˚_«me
,

580 
	`SF_COUNT_TO_LONG
 (
posôi⁄
), SF_COUNT_TO_LONG (
√w_pos
)) ;

581 
	`exô
 (1) ;

584 
	}
}

589 
	$ã°_ªad_sh‹t_‹_dõ
 (
SNDFILE
 *
fûe
, 
∑ss
, *
ã°
, 
sf_cou¡_t
 
ôems
, 
löe_num
)

590 { 
sf_cou¡_t
 
cou¡
 ;

592 i‡((
cou¡
 = 
	`sf_ªad_sh‹t
 (
fûe
, 
ã°
, 
ôems
)) != items)

593 { 
	`¥ötf
 ("\n\nLöê%d", 
löe_num
) ;

594 i‡(
∑ss
 > 0)

595 
	`¥ötf
 (" (∑s†%d)", 
∑ss
) ;

596 
	`¥ötf
 (" : sf_read_short failed with shortÑead (%ld => %ld).\n",

597 
	`SF_COUNT_TO_LONG
 (
ôems
), SF_COUNT_TO_LONG (
cou¡
)) ;

598 
	`fÊush
 (
°dout
) ;

599 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

600 
	`exô
 (1) ;

604 
	}
}

607 
	$ã°_ªad_öt_‹_dõ
 (
SNDFILE
 *
fûe
, 
∑ss
, *
ã°
, 
sf_cou¡_t
 
ôems
, 
löe_num
)

608 { 
sf_cou¡_t
 
cou¡
 ;

610 i‡((
cou¡
 = 
	`sf_ªad_öt
 (
fûe
, 
ã°
, 
ôems
)) != items)

611 { 
	`¥ötf
 ("\n\nLöê%d", 
löe_num
) ;

612 i‡(
∑ss
 > 0)

613 
	`¥ötf
 (" (∑s†%d)", 
∑ss
) ;

614 
	`¥ötf
 (" : sf_read_int failed with shortÑead (%ld => %ld).\n",

615 
	`SF_COUNT_TO_LONG
 (
ôems
), SF_COUNT_TO_LONG (
cou¡
)) ;

616 
	`fÊush
 (
°dout
) ;

617 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

618 
	`exô
 (1) ;

622 
	}
}

625 
	$ã°_ªad_Êﬂt_‹_dõ
 (
SNDFILE
 *
fûe
, 
∑ss
, *
ã°
, 
sf_cou¡_t
 
ôems
, 
löe_num
)

626 { 
sf_cou¡_t
 
cou¡
 ;

628 i‡((
cou¡
 = 
	`sf_ªad_Êﬂt
 (
fûe
, 
ã°
, 
ôems
)) != items)

629 { 
	`¥ötf
 ("\n\nLöê%d", 
löe_num
) ;

630 i‡(
∑ss
 > 0)

631 
	`¥ötf
 (" (∑s†%d)", 
∑ss
) ;

632 
	`¥ötf
 (" : sf_read_float failed with shortÑead (%ld => %ld).\n",

633 
	`SF_COUNT_TO_LONG
 (
ôems
), SF_COUNT_TO_LONG (
cou¡
)) ;

634 
	`fÊush
 (
°dout
) ;

635 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

636 
	`exô
 (1) ;

640 
	}
}

643 
	$ã°_ªad_doubÀ_‹_dõ
 (
SNDFILE
 *
fûe
, 
∑ss
, *
ã°
, 
sf_cou¡_t
 
ôems
, 
löe_num
)

644 { 
sf_cou¡_t
 
cou¡
 ;

646 i‡((
cou¡
 = 
	`sf_ªad_doubÀ
 (
fûe
, 
ã°
, 
ôems
)) != items)

647 { 
	`¥ötf
 ("\n\nLöê%d", 
löe_num
) ;

648 i‡(
∑ss
 > 0)

649 
	`¥ötf
 (" (∑s†%d)", 
∑ss
) ;

650 
	`¥ötf
 (" : sf_read_double failed with shortÑead (%ld => %ld).\n",

651 
	`SF_COUNT_TO_LONG
 (
ôems
), SF_COUNT_TO_LONG (
cou¡
)) ;

652 
	`fÊush
 (
°dout
) ;

653 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

654 
	`exô
 (1) ;

658 
	}
}

662 
	$ã°_ªadf_sh‹t_‹_dõ
 (
SNDFILE
 *
fûe
, 
∑ss
, *
ã°
, 
sf_cou¡_t
 
‰ames
, 
löe_num
)

663 { 
sf_cou¡_t
 
cou¡
 ;

665 i‡((
cou¡
 = 
	`sf_ªadf_sh‹t
 (
fûe
, 
ã°
, 
‰ames
)) != frames)

666 { 
	`¥ötf
 ("\n\nLöê%d", 
löe_num
) ;

667 i‡(
∑ss
 > 0)

668 
	`¥ötf
 (" (∑s†%d)", 
∑ss
) ;

669 
	`¥ötf
 (" : sf_readf_short failed with shortÑeadf (%ld => %ld).\n",

670 
	`SF_COUNT_TO_LONG
 (
‰ames
), SF_COUNT_TO_LONG (
cou¡
)) ;

671 
	`fÊush
 (
°dout
) ;

672 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

673 
	`exô
 (1) ;

677 
	}
}

680 
	$ã°_ªadf_öt_‹_dõ
 (
SNDFILE
 *
fûe
, 
∑ss
, *
ã°
, 
sf_cou¡_t
 
‰ames
, 
löe_num
)

681 { 
sf_cou¡_t
 
cou¡
 ;

683 i‡((
cou¡
 = 
	`sf_ªadf_öt
 (
fûe
, 
ã°
, 
‰ames
)) != frames)

684 { 
	`¥ötf
 ("\n\nLöê%d", 
löe_num
) ;

685 i‡(
∑ss
 > 0)

686 
	`¥ötf
 (" (∑s†%d)", 
∑ss
) ;

687 
	`¥ötf
 (" : sf_readf_int failed with shortÑeadf (%ld => %ld).\n",

688 
	`SF_COUNT_TO_LONG
 (
‰ames
), SF_COUNT_TO_LONG (
cou¡
)) ;

689 
	`fÊush
 (
°dout
) ;

690 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

691 
	`exô
 (1) ;

695 
	}
}

698 
	$ã°_ªadf_Êﬂt_‹_dõ
 (
SNDFILE
 *
fûe
, 
∑ss
, *
ã°
, 
sf_cou¡_t
 
‰ames
, 
löe_num
)

699 { 
sf_cou¡_t
 
cou¡
 ;

701 i‡((
cou¡
 = 
	`sf_ªadf_Êﬂt
 (
fûe
, 
ã°
, 
‰ames
)) != frames)

702 { 
	`¥ötf
 ("\n\nLöê%d", 
löe_num
) ;

703 i‡(
∑ss
 > 0)

704 
	`¥ötf
 (" (∑s†%d)", 
∑ss
) ;

705 
	`¥ötf
 (" : sf_readf_float failed with shortÑeadf (%ld => %ld).\n",

706 
	`SF_COUNT_TO_LONG
 (
‰ames
), SF_COUNT_TO_LONG (
cou¡
)) ;

707 
	`fÊush
 (
°dout
) ;

708 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

709 
	`exô
 (1) ;

713 
	}
}

716 
	$ã°_ªadf_doubÀ_‹_dõ
 (
SNDFILE
 *
fûe
, 
∑ss
, *
ã°
, 
sf_cou¡_t
 
‰ames
, 
löe_num
)

717 { 
sf_cou¡_t
 
cou¡
 ;

719 i‡((
cou¡
 = 
	`sf_ªadf_doubÀ
 (
fûe
, 
ã°
, 
‰ames
)) != frames)

720 { 
	`¥ötf
 ("\n\nLöê%d", 
löe_num
) ;

721 i‡(
∑ss
 > 0)

722 
	`¥ötf
 (" (∑s†%d)", 
∑ss
) ;

723 
	`¥ötf
 (" : sf_readf_double failed with shortÑeadf (%ld => %ld).\n",

724 
	`SF_COUNT_TO_LONG
 (
‰ames
), SF_COUNT_TO_LONG (
cou¡
)) ;

725 
	`fÊush
 (
°dout
) ;

726 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

727 
	`exô
 (1) ;

731 
	}
}

737 
	$ã°_wrôe_sh‹t_‹_dõ
 (
SNDFILE
 *
fûe
, 
∑ss
, c⁄° *
ã°
, 
sf_cou¡_t
 
ôems
, 
löe_num
)

738 { 
sf_cou¡_t
 
cou¡
 ;

740 i‡((
cou¡
 = 
	`sf_wrôe_sh‹t
 (
fûe
, 
ã°
, 
ôems
)) != items)

741 { 
	`¥ötf
 ("\n\nLöê%d", 
löe_num
) ;

742 i‡(
∑ss
 > 0)

743 
	`¥ötf
 (" (∑s†%d)", 
∑ss
) ;

744 
	`¥ötf
 (" : sf_write_short failed with short write (%ld => %ld).\n",

745 
	`SF_COUNT_TO_LONG
 (
ôems
), SF_COUNT_TO_LONG (
cou¡
)) ;

746 
	`fÊush
 (
°dout
) ;

747 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

748 
	`exô
 (1) ;

752 
	}
}

755 
	$ã°_wrôe_öt_‹_dõ
 (
SNDFILE
 *
fûe
, 
∑ss
, c⁄° *
ã°
, 
sf_cou¡_t
 
ôems
, 
löe_num
)

756 { 
sf_cou¡_t
 
cou¡
 ;

758 i‡((
cou¡
 = 
	`sf_wrôe_öt
 (
fûe
, 
ã°
, 
ôems
)) != items)

759 { 
	`¥ötf
 ("\n\nLöê%d", 
löe_num
) ;

760 i‡(
∑ss
 > 0)

761 
	`¥ötf
 (" (∑s†%d)", 
∑ss
) ;

762 
	`¥ötf
 (" : sf_write_int failed with short write (%ld => %ld).\n",

763 
	`SF_COUNT_TO_LONG
 (
ôems
), SF_COUNT_TO_LONG (
cou¡
)) ;

764 
	`fÊush
 (
°dout
) ;

765 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

766 
	`exô
 (1) ;

770 
	}
}

773 
	$ã°_wrôe_Êﬂt_‹_dõ
 (
SNDFILE
 *
fûe
, 
∑ss
, c⁄° *
ã°
, 
sf_cou¡_t
 
ôems
, 
löe_num
)

774 { 
sf_cou¡_t
 
cou¡
 ;

776 i‡((
cou¡
 = 
	`sf_wrôe_Êﬂt
 (
fûe
, 
ã°
, 
ôems
)) != items)

777 { 
	`¥ötf
 ("\n\nLöê%d", 
löe_num
) ;

778 i‡(
∑ss
 > 0)

779 
	`¥ötf
 (" (∑s†%d)", 
∑ss
) ;

780 
	`¥ötf
 (" : sf_write_float failed with short write (%ld => %ld).\n",

781 
	`SF_COUNT_TO_LONG
 (
ôems
), SF_COUNT_TO_LONG (
cou¡
)) ;

782 
	`fÊush
 (
°dout
) ;

783 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

784 
	`exô
 (1) ;

788 
	}
}

791 
	$ã°_wrôe_doubÀ_‹_dõ
 (
SNDFILE
 *
fûe
, 
∑ss
, c⁄° *
ã°
, 
sf_cou¡_t
 
ôems
, 
löe_num
)

792 { 
sf_cou¡_t
 
cou¡
 ;

794 i‡((
cou¡
 = 
	`sf_wrôe_doubÀ
 (
fûe
, 
ã°
, 
ôems
)) != items)

795 { 
	`¥ötf
 ("\n\nLöê%d", 
löe_num
) ;

796 i‡(
∑ss
 > 0)

797 
	`¥ötf
 (" (∑s†%d)", 
∑ss
) ;

798 
	`¥ötf
 (" : sf_write_double failed with short write (%ld => %ld).\n",

799 
	`SF_COUNT_TO_LONG
 (
ôems
), SF_COUNT_TO_LONG (
cou¡
)) ;

800 
	`fÊush
 (
°dout
) ;

801 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

802 
	`exô
 (1) ;

806 
	}
}

810 
	$ã°_wrôef_sh‹t_‹_dõ
 (
SNDFILE
 *
fûe
, 
∑ss
, c⁄° *
ã°
, 
sf_cou¡_t
 
‰ames
, 
löe_num
)

811 { 
sf_cou¡_t
 
cou¡
 ;

813 i‡((
cou¡
 = 
	`sf_wrôef_sh‹t
 (
fûe
, 
ã°
, 
‰ames
)) != frames)

814 { 
	`¥ötf
 ("\n\nLöê%d", 
löe_num
) ;

815 i‡(
∑ss
 > 0)

816 
	`¥ötf
 (" (∑s†%d)", 
∑ss
) ;

817 
	`¥ötf
 (" : sf_writef_short failed with short writef (%ld => %ld).\n",

818 
	`SF_COUNT_TO_LONG
 (
‰ames
), SF_COUNT_TO_LONG (
cou¡
)) ;

819 
	`fÊush
 (
°dout
) ;

820 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

821 
	`exô
 (1) ;

825 
	}
}

828 
	$ã°_wrôef_öt_‹_dõ
 (
SNDFILE
 *
fûe
, 
∑ss
, c⁄° *
ã°
, 
sf_cou¡_t
 
‰ames
, 
löe_num
)

829 { 
sf_cou¡_t
 
cou¡
 ;

831 i‡((
cou¡
 = 
	`sf_wrôef_öt
 (
fûe
, 
ã°
, 
‰ames
)) != frames)

832 { 
	`¥ötf
 ("\n\nLöê%d", 
löe_num
) ;

833 i‡(
∑ss
 > 0)

834 
	`¥ötf
 (" (∑s†%d)", 
∑ss
) ;

835 
	`¥ötf
 (" : sf_writef_int failed with short writef (%ld => %ld).\n",

836 
	`SF_COUNT_TO_LONG
 (
‰ames
), SF_COUNT_TO_LONG (
cou¡
)) ;

837 
	`fÊush
 (
°dout
) ;

838 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

839 
	`exô
 (1) ;

843 
	}
}

846 
	$ã°_wrôef_Êﬂt_‹_dõ
 (
SNDFILE
 *
fûe
, 
∑ss
, c⁄° *
ã°
, 
sf_cou¡_t
 
‰ames
, 
löe_num
)

847 { 
sf_cou¡_t
 
cou¡
 ;

849 i‡((
cou¡
 = 
	`sf_wrôef_Êﬂt
 (
fûe
, 
ã°
, 
‰ames
)) != frames)

850 { 
	`¥ötf
 ("\n\nLöê%d", 
löe_num
) ;

851 i‡(
∑ss
 > 0)

852 
	`¥ötf
 (" (∑s†%d)", 
∑ss
) ;

853 
	`¥ötf
 (" : sf_writef_float failed with short writef (%ld => %ld).\n",

854 
	`SF_COUNT_TO_LONG
 (
‰ames
), SF_COUNT_TO_LONG (
cou¡
)) ;

855 
	`fÊush
 (
°dout
) ;

856 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

857 
	`exô
 (1) ;

861 
	}
}

864 
	$ã°_wrôef_doubÀ_‹_dõ
 (
SNDFILE
 *
fûe
, 
∑ss
, c⁄° *
ã°
, 
sf_cou¡_t
 
‰ames
, 
löe_num
)

865 { 
sf_cou¡_t
 
cou¡
 ;

867 i‡((
cou¡
 = 
	`sf_wrôef_doubÀ
 (
fûe
, 
ã°
, 
‰ames
)) != frames)

868 { 
	`¥ötf
 ("\n\nLöê%d", 
löe_num
) ;

869 i‡(
∑ss
 > 0)

870 
	`¥ötf
 (" (∑s†%d)", 
∑ss
) ;

871 
	`¥ötf
 (" : sf_writef_double failed with short writef (%ld => %ld).\n",

872 
	`SF_COUNT_TO_LONG
 (
‰ames
), SF_COUNT_TO_LONG (
cou¡
)) ;

873 
	`fÊush
 (
°dout
) ;

874 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

875 
	`exô
 (1) ;

879 
	}
}

883 
	$dñëe_fûe
 (
f‹m©
, c⁄° *
fûíame
)

884 { 
r§c_«me
 [512], *
‚ame
 ;

886 
	`u∆ök
 (
fûíame
) ;

888 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_SD2
)

895 
	`¢¥ötf
 (
r§c_«me
,  (r§c_«me), "%s", 
fûíame
) ;

897 i‡((
‚ame
 = 
	`°ºchr
 (
r§c_«me
, '/')Ë!
NULL
)

898 
‚ame
 ++ ;

899 i‡((
‚ame
 = 
	`°ºchr
 (
r§c_«me
, '\\')Ë!
NULL
)

900 
‚ame
 ++ ;

902 
‚ame
 = 
r§c_«me
 ;

904 
	`memmove
 (
‚ame
 + 2, f«me, 
	`°æí
 (fname) + 1) ;

905 
‚ame
 [0] = '.' ;

906 
‚ame
 [1] = '_' ;

908 
	`u∆ök
 (
r§c_«me
) ;

909 
	}
}

911 
	gÆlowed_›í_fûes
 = -1 ;

914 
	$cou¡_›í_fûes
 ()

916 #i‡(
	`deföed
 (
WIN32
Ë|| deföed (
_WIN32
))

919 
k
, 
cou¡
 = 0 ;

920 
°©
 
°©buf
 ;

922 i‡(
Ælowed_›í_fûes
 > 0)

925 
k
 = 0 ; k < 1024 ; k++)

926 i‡(
	`f°©
 (
k
, &
°©buf
) == 0)

927 
cou¡
 ++ ;

929 
Ælowed_›í_fûes
 = 
cou¡
 ;

931 
	}
}

934 
	$ö¸emít_›í_fûe_cou¡
 ()

935 { 
Ælowed_›í_fûes
 ++ ;

936 
	}
}

939 
	$check_›í_fûe_cou¡_‹_dõ
 (
löío
)

941 #i‡(
	`deföed
 (
WIN32
Ë|| deföed (
_WIN32
))

942 
löío
 = 0 ;

945 
k
, 
cou¡
 = 0 ;

946 
°©
 
°©buf
 ;

948 i‡(
Ælowed_›í_fûes
 < 0)

949 
	`cou¡_›í_fûes
 () ;

951 
k
 = 0 ; k < 1024 ; k++)

952 i‡(
	`f°©
 (
k
, &
°©buf
) == 0)

953 
cou¡
 ++ ;

955 i‡(
cou¡
 > 
Ælowed_›í_fûes
)

956 { 
	`¥ötf
 ("\nLöê%d :Çumbî o‡›í fûe†(%dË>áŒowed (%d).\n\n", 
löío
, 
cou¡
, 
Ælowed_›í_fûes
) ;

957 
	`exô
 (1) ;

960 
	}
}

	@libsndfile-1.0.17/tests/utils.h

28 #ifde‡
__˝lu•lus


32 
	~<°d¨g.h
>

34 
	#SF_COUNT_TO_LONG
(
x
Ë((Ë(x))

	)

35 
	#ARRAY_LEN
(
x
Ë((Ë( (x)Ë/ ( ((xË[0])))

	)

36 
	#SIGNED_SIZEOF
(
x
Ë((
öt64_t
Ë( (x)))

	)

38 
	#PIPE_INDEX
(
x
Ë((xË+ 500)

	)

39 
	#PIPE_TEST_LEN
 12345

	)

41 #i‡(
deföed
 (
WIN32
Ë|| deföed (
_WIN32
))

42 
	#¢¥ötf
 
_¢¥ötf


	)

45 
gí_wödowed_söe_Êﬂt
 (*
d©a
, 
Àn
, 
maximum
) ;

46 
gí_wödowed_söe_doubÀ
 (*
d©a
, 
Àn
, 
maximum
) ;

49 
check_fûe_hash_‹_dõ
 (c⁄° *
fûíame
, 
èrgë_hash
, 
löe_num
) ;

51 
¥öt_ã°_«me
 (c⁄° *
ã°
, c⁄° *
fûíame
) ;

53 
dump_d©a_to_fûe
 (c⁄° *
fûíame
, *
d©a
, 
d©Æí
) ;

55 
ölöe
 

56 
exô_if_åue
 (
ã°
, c⁄° *
f‹m©
, ...)

57 { i‡(
ã°
)

58 { 
va_li°
 
¨g±r
 ;

59 
va_°¨t
 (
¨g±r
, 
f‹m©
) ;

60 
v¥ötf
 (
f‹m©
, 
¨g±r
) ;

61 
va_íd
 (
¨g±r
) ;

62 
exô
 (1) ;

71 
o˘_ßve_sh‹t
 (*
a
, *
b
, 
Àn
) ;

72 
o˘_ßve_öt
 (*
a
, *
b
, 
Àn
) ;

73 
o˘_ßve_Êﬂt
 (*
a
, *
b
, 
Àn
) ;

74 
o˘_ßve_doubÀ
 (*
a
, *
b
, 
Àn
) ;

77 
dñëe_fûe
 (
f‹m©
, c⁄° *
fûíame
) ;

79 
cou¡_›í_fûes
 () ;

80 
ö¸emít_›í_fûe_cou¡
 () ;

81 
check_›í_fûe_cou¡_‹_dõ
 (
löío
) ;

83 #ifde‡
SNDFILE_H


85 
dump_log_buf„r
 (
SNDFILE
 *
fûe
) ;

86 
check_log_buf„r_‹_dõ
 (
SNDFILE
 *
fûe
, 
löe_num
) ;

87 
°rög_ö_log_buf„r
 (
SNDFILE
 *
fûe
, c⁄° *
s
) ;

88 
hexdump_fûe
 (c⁄° * 
fûíame
, 
sf_cou¡_t
 
off£t
, sf_cou¡_à
Àngth
) ;

91 
SNDFILE
 *
ã°_›í_fûe_‹_dõ


92 (c⁄° *
fûíame
, 
mode
, 
SF_INFO
 *
sföfo
, 
Ælow_fd
, 
löe_num
) ;

94 
ã°_ªad_wrôe_posôi⁄_‹_dõ


95 (
SNDFILE
 *
fûe
, 
löe_num
, 
∑ss
, 
sf_cou¡_t
 
ªad_pos
, sf_cou¡_à
wrôe_pos
) ;

97 
ã°_£ek_‹_dõ


98 (
SNDFILE
 *
fûe
, 
sf_cou¡_t
 
off£t
, 
whí˚
, sf_cou¡_à
√w_pos
, 
ch™√ls
, 
löe_num
) ;

101 
ã°_ªad_sh‹t_‹_dõ


102 (
SNDFILE
 *
fûe
, 
∑ss
, *
ã°
, 
sf_cou¡_t
 
ôems
, 
löe_num
) ;

103 
ã°_ªad_öt_‹_dõ


104 (
SNDFILE
 *
fûe
, 
∑ss
, *
ã°
, 
sf_cou¡_t
 
ôems
, 
löe_num
) ;

105 
ã°_ªad_Êﬂt_‹_dõ


106 (
SNDFILE
 *
fûe
, 
∑ss
, *
ã°
, 
sf_cou¡_t
 
ôems
, 
löe_num
) ;

107 
ã°_ªad_doubÀ_‹_dõ


108 (
SNDFILE
 *
fûe
, 
∑ss
, *
ã°
, 
sf_cou¡_t
 
ôems
, 
löe_num
) ;

110 
ã°_ªadf_sh‹t_‹_dõ


111 (
SNDFILE
 *
fûe
, 
∑ss
, *
ã°
, 
sf_cou¡_t
 
‰ames
, 
löe_num
) ;

112 
ã°_ªadf_öt_‹_dõ


113 (
SNDFILE
 *
fûe
, 
∑ss
, *
ã°
, 
sf_cou¡_t
 
‰ames
, 
löe_num
) ;

114 
ã°_ªadf_Êﬂt_‹_dõ


115 (
SNDFILE
 *
fûe
, 
∑ss
, *
ã°
, 
sf_cou¡_t
 
‰ames
, 
löe_num
) ;

116 
ã°_ªadf_doubÀ_‹_dõ


117 (
SNDFILE
 *
fûe
, 
∑ss
, *
ã°
, 
sf_cou¡_t
 
‰ames
, 
löe_num
) ;

121 
ã°_wrôe_sh‹t_‹_dõ


122 (
SNDFILE
 *
fûe
, 
∑ss
, c⁄° *
ã°
, 
sf_cou¡_t
 
ôems
, 
löe_num
) ;

123 
ã°_wrôe_öt_‹_dõ


124 (
SNDFILE
 *
fûe
, 
∑ss
, c⁄° *
ã°
, 
sf_cou¡_t
 
ôems
, 
löe_num
) ;

125 
ã°_wrôe_Êﬂt_‹_dõ


126 (
SNDFILE
 *
fûe
, 
∑ss
, c⁄° *
ã°
, 
sf_cou¡_t
 
ôems
, 
löe_num
) ;

127 
ã°_wrôe_doubÀ_‹_dõ


128 (
SNDFILE
 *
fûe
, 
∑ss
, c⁄° *
ã°
, 
sf_cou¡_t
 
ôems
, 
löe_num
) ;

130 
ã°_wrôef_sh‹t_‹_dõ


131 (
SNDFILE
 *
fûe
, 
∑ss
, c⁄° *
ã°
, 
sf_cou¡_t
 
‰ames
, 
löe_num
) ;

132 
ã°_wrôef_öt_‹_dõ


133 (
SNDFILE
 *
fûe
, 
∑ss
, c⁄° *
ã°
, 
sf_cou¡_t
 
‰ames
, 
löe_num
) ;

134 
ã°_wrôef_Êﬂt_‹_dõ


135 (
SNDFILE
 *
fûe
, 
∑ss
, c⁄° *
ã°
, 
sf_cou¡_t
 
‰ames
, 
löe_num
) ;

136 
ã°_wrôef_doubÀ_‹_dõ


137 (
SNDFILE
 *
fûe
, 
∑ss
, c⁄° *
ã°
, 
sf_cou¡_t
 
‰ames
, 
löe_num
) ;

142 #ifde‡
__˝lu•lus


	@libsndfile-1.0.17/tests/virtual_io_test.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

24 
	~<f˙é.h
>

25 
	~<m©h.h
>

26 
	~<°rög.h
>

27 
	~<î∫o.h
>

28 
	~<sys/°©.h
>

30 
	~<¢dfûe.h
>

32 
	~"utûs.h
"

34 
vio_ã°
 (c⁄° *
‚ame
, 
f‹m©
) ;

37 
	$maö
 ()

39 
	`vio_ã°
 ("vio_pcm16.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_16
) ;

40 
	`vio_ã°
 ("vio_pcm24.aiff", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_PCM_24
) ;

41 
	`vio_ã°
 ("vio_Êﬂt.au", 
SF_FORMAT_AU
 | 
SF_FORMAT_FLOAT
) ;

44 
	}
}

50 { 
sf_cou¡_t
 
	moff£t
, 
	mÀngth
 ;

51 
	md©a
 [16 * 1024] ;

52 } 
	tVIO_DATA
 ;

54 
sf_cou¡_t


55 
	$vfgë_fûñí
 (*
u£r_d©a
)

56 { 
VIO_DATA
 *
vf
 = (VIO_DATA *Ë
u£r_d©a
 ;

58  
vf
->
Àngth
 ;

59 
	}
}

61 
sf_cou¡_t


62 
	$vf£ek
 (
sf_cou¡_t
 
off£t
, 
whí˚
, *
u£r_d©a
)

63 { 
VIO_DATA
 *
vf
 = (VIO_DATA *Ë
u£r_d©a
 ;

65 
whí˚
)

66 { 
SEEK_SET
 :

67 
vf
->
off£t
 = offset ;

70 
SEEK_CUR
 :

71 
vf
->
off£t
 = vf->offset + offset ;

74 
SEEK_END
 :

75 
vf
->
off£t
 = vf->
Àngth
 + offset ;

81  
vf
->
off£t
 ;

82 
	}
}

84 
sf_cou¡_t


85 
	$v‰ód
 (*
±r
, 
sf_cou¡_t
 
cou¡
, *
u£r_d©a
)

86 { 
VIO_DATA
 *
vf
 = (VIO_DATA *Ë
u£r_d©a
 ;

92 i‡(
vf
->
off£t
 + 
cou¡
 > vf->
Àngth
)

93 
cou¡
 = 
vf
->
Àngth
 - vf->
off£t
 ;

95 
	`mem˝y
 (
±r
, 
vf
->
d©a
 + vf->
off£t
, 
cou¡
) ;

96 
vf
->
off£t
 +
cou¡
 ;

98  
cou¡
 ;

99 
	}
}

101 
sf_cou¡_t


102 
	$vfwrôe
 (c⁄° *
±r
, 
sf_cou¡_t
 
cou¡
, *
u£r_d©a
)

103 { 
VIO_DATA
 *
vf
 = (VIO_DATA *Ë
u£r_d©a
 ;

109 i‡(
vf
->
off£t
 >
	`SIGNED_SIZEOF
 (vf->
d©a
))

112 i‡(
vf
->
off£t
 + 
cou¡
 > 
	`SIGNED_SIZEOF
 (vf->
d©a
))

113 
cou¡
 =  (
vf
->
d©a
Ë- vf->
off£t
 ;

115 
	`mem˝y
 (
vf
->
d©a
 + vf->
off£t
, 
±r
, (
size_t
Ë
cou¡
) ;

116 
vf
->
off£t
 +
cou¡
 ;

118 i‡(
vf
->
off£t
 > vf->
Àngth
)

119 
vf
->
Àngth
 = vf->
off£t
 ;

121  
cou¡
 ;

122 
	}
}

124 
sf_cou¡_t


125 
	$v·ñl
 (*
u£r_d©a
)

126 { 
VIO_DATA
 *
vf
 = (VIO_DATA *Ë
u£r_d©a
 ;

128  
vf
->
off£t
 ;

129 
	}
}

136 
	$gí_sh‹t_d©a
 (* 
d©a
, 
Àn
, 
°¨t
)

137 { 
k
 ;

139 
k
 = 0 ; k < 
Àn
 ; k++)

140 
d©a
 [
k
] = 
°¨t
 + k ;

141 
	}
}

145 
	$check_sh‹t_d©a
 (* 
d©a
, 
Àn
, 
°¨t
, 
löe
)

146 { 
k
 ;

148 
k
 = 0 ; k < 
Àn
 ; k++)

149 i‡(
d©a
 [
k
] !
°¨t
 + k)

150 { 
	`¥ötf
 ("\n\nLöê%d : d©®[%d] = %d (should bê%d).\n\n", 
löe
, 
k
, 
d©a
 [k], 
°¨t
 + k) ;

151 
	`exô
 (1) ;

153 
	}
}

159 
	$vio_ã°
 (c⁄° *
‚ame
, 
f‹m©
)

160 { 
VIO_DATA
 
vio_d©a
 ;

161 
d©a
 [256] ;

163 
SF_VIRTUAL_IO
 
vio
 ;

164 
SNDFILE
 * 
fûe
 ;

165 
SF_INFO
 
sföfo
 ;

167 
	`¥öt_ã°_«me
 ("vútuÆ i/ÿã°", 
‚ame
) ;

170 
vio
.
gë_fûñí
 = 
vfgë_fûñí
 ;

171 
vio
.
£ek
 = 
vf£ek
 ;

172 
vio
.
ªad
 = 
v‰ód
 ;

173 
vio
.
wrôe
 = 
vfwrôe
 ;

174 
vio
.
ãŒ
 = 
v·ñl
 ;

177 
vio_d©a
.
off£t
 = 0 ;

178 
vio_d©a
.
Àngth
 = 0 ;

180 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

181 
sföfo
.
f‹m©
 = format ;

182 
sföfo
.
ch™√ls
 = 2 ;

183 
sföfo
.
ßm∂î©e
 = 44100 ;

185 i‡((
fûe
 = 
	`sf_›í_vútuÆ
 (&
vio
, 
SFM_WRITE
, &
sföfo
, &
vio_d©a
)Ë=
NULL
)

186 { 
	`¥ötf
 ("\n\nLöê%d : sf_›í_wrôêÁûed wôhÉº‹ : ", 
__LINE__
) ;

187 
	`fÊush
 (
°dout
) ;

188 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

189 
	`exô
 (1) ;

192 
	`gí_sh‹t_d©a
 (
d©a
, 
	`ARRAY_LEN
 (data), 0) ;

193 
	`sf_wrôe_sh‹t
 (
fûe
, 
d©a
, 
	`ARRAY_LEN
 (data)) ;

195 
	`gí_sh‹t_d©a
 (
d©a
, 
	`ARRAY_LEN
 (data), 1) ;

196 
	`sf_wrôe_sh‹t
 (
fûe
, 
d©a
, 
	`ARRAY_LEN
 (data)) ;

198 
	`gí_sh‹t_d©a
 (
d©a
, 
	`ARRAY_LEN
 (data), 2) ;

199 
	`sf_wrôe_sh‹t
 (
fûe
, 
d©a
, 
	`ARRAY_LEN
 (data)) ;

201 
	`sf_˛o£
 (
fûe
) ;

204 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

206 
vio_d©a
.
off£t
 = 0 ;

208 i‡((
fûe
 = 
	`sf_›í_vútuÆ
 (&
vio
, 
SFM_READ
, &
sföfo
, &
vio_d©a
)Ë=
NULL
)

209 { 
	`¥ötf
 ("\n\nLöê%d : sf_›í_wrôêÁûed wôhÉº‹ : ", 
__LINE__
) ;

210 
	`fÊush
 (
°dout
) ;

211 
	`puts
 (
	`sf_°ªº‹
 (
NULL
)) ;

213 
	`dump_d©a_to_fûe
 (
‚ame
, 
vio_d©a
.
d©a
, vio_d©a.
Àngth
) ;

214 
	`exô
 (1) ;

218 
	`sf_ªad_sh‹t
 (
fûe
, 
d©a
, 
	`ARRAY_LEN
 (data)) ;

219 
	`check_sh‹t_d©a
 (
d©a
, 
	`ARRAY_LEN
 (d©a), 0, 
__LINE__
) ;

221 
	`sf_ªad_sh‹t
 (
fûe
, 
d©a
, 
	`ARRAY_LEN
 (data)) ;

222 
	`check_sh‹t_d©a
 (
d©a
, 
	`ARRAY_LEN
 (d©a), 1, 
__LINE__
) ;

224 
	`sf_ªad_sh‹t
 (
fûe
, 
d©a
, 
	`ARRAY_LEN
 (data)) ;

225 
	`check_sh‹t_d©a
 (
d©a
, 
	`ARRAY_LEN
 (d©a), 2, 
__LINE__
) ;

227 
	`sf_˛o£
 (
fûe
) ;

229 
	`puts
 ("ok") ;

230 
	}
}

	@libsndfile-1.0.17/tests/win32_ordinal_test.c

19 
	~"sfc⁄fig.h
"

20 
	~"¢dfûe.h
"

22 
	~<°dio.h
>

23 
	~<°dlib.h
>

25 #i‡
HAVE_UNISTD_H


26 
	~<uni°d.h
>

29 #i‡(
HAVE_DECL_S_IRGRP
 == 0)

30 
	~<sf_uni°d.h
>

33 
	~<°rög.h
>

34 
	~<f˙é.h
>

35 
	~<î∫o.h
>

36 
	~<sys/ty≥s.h
>

38 
	~"utûs.h
"

40 #i‡(
deföed
 (
WIN32
Ë|| deföed (
_WIN32
Ë|| deföed (
__CYGWIN__
))

41 
	#TEST_WIN32
 1

	)

43 
	#TEST_WIN32
 0

	)

46 #i‡
TEST_WIN32


47 
	~<wödows.h
>

49 #ifde‡
__CYGWIN__


50 
	#DLL_NAME
 "cyg¢dfûe"

	)

52 
	#DLL_NAME
 "lib¢dfûe"

	)

55 c⁄° * 
	gloˇti⁄s
 [] =

57 
NULL


61 
	$ã°_‹döÆ
 (
HMODULE
 
hmod
, c⁄° * 
func_«me
, 
‹döÆ
)

62 { *
Õmsg
 ;

63 *
«me
, *
‹d
 ;

65 
	`¥öt_ã°_«me
 ("wö32_‹döÆ_ã°", 
func_«me
) ;

67 
‹d
 = 
	`GëProcAddªss
 (
hmod
, (
LPSTR
Ë
‹döÆ
) ;

68 i‡((
«me
 = 
	`GëProcAddªss
 (
hmod
, 
func_«me
)Ë=
NULL
)

69 { 
	`F‹m©Mesßge
 (
FORMAT_MESSAGE_ALLOCATE_BUFFER
 | 
FORMAT_MESSAGE_FROM_SYSTEM
, 
NULL
, 
	`GëLa°Eº‹
 (),

70 
	`MAKELANGID
 (
LANG_NEUTRAL
, 
SUBLANG_DEFAULT
), (
LPTSTR
Ë&
Õmsg
, 0, 
NULL
) ;

74 i‡(
«me
 !
NULL
 && 
‹d
 != NULL &&Çame == ord)

75 { 
	`puts
 ("ok") ;

79 
	`puts
 ("fail") ;

81 
	}
}

84 
	$wö32_‹döÆ_ã°
 ()

85 { 
buf„r
 [1024] ;

86 
func_«me
 [1024] ;

87 
HMODULE
 
hmod
 = 
NULL
 ;

88 
FILE
 * 
fûe
 = 
NULL
 ;

89 
k
, 
‹döÆ
, 
îr‹s
 = 0 ;

91 
k
 = 0 ; 
loˇti⁄s
 [k] !
NULL
 ; k++)

92 { 
	`¢¥ötf
 (
buf„r
,  (buf„r), "%s/%s.def", 
loˇti⁄s
 [
k
], 
DLL_NAME
) ;

93 i‡((
fûe
 = 
	`f›í
 (
buf„r
, "r")Ë!
NULL
)

97 i‡(
fûe
 =
NULL
)

98 { 
	`puts
 ("\n\nError : cannot open DEF file.\n") ;

99 
	`exô
 (1) ;

102 
k
 = 0 ; 
loˇti⁄s
 [k] !
NULL
 ; k++)

103 { 
	`¢¥ötf
 (
buf„r
,  (buf„r), "%s/%s-1.dŒ", 
loˇti⁄s
 [
k
], 
DLL_NAME
) ;

104 i‡((
hmod
 = (
HMODULE
Ë
	`LﬂdLibøry
 (
buf„r
)Ë!
NULL
)

108 i‡(
hmod
 =
NULL
)

109 { 
	`puts
 ("\n\nError : cannotÜoad DLL.\n") ;

110 
	`exô
 (1) ;

113 
	`fgës
 (
buf„r
,  (buf„r), 
fûe
Ë!
NULL
)

114 { 
func_«me
 [0] = 0 ;

115 
‹döÆ
 = 0 ;

117 i‡(
	`ssˇnf
 (
buf„r
, "%†@%d", 
func_«me
, &
‹döÆ
) != 2)

120 
îr‹s
 +
	`ã°_‹döÆ
 (
hmod
, 
func_«me
, 
‹döÆ
) ;

123 
	`FªeLibøry
 (
hmod
) ;

125 
	`f˛o£
 (
fûe
) ;

127 i‡(
îr‹s
 > 0)

128 { 
	`¥ötf
 ("\n\nEº‹†: %d\n\n", 
îr‹s
) ;

129 
	`exô
 (1) ;

133 
	}
}

138 
	$maö
 ()

140 #i‡
TEST_WIN32


141 
	`wö32_‹döÆ_ã°
 () ;

145 
	}
}

	@libsndfile-1.0.17/tests/win32_test.c

19 
	~"sfc⁄fig.h
"

20 
	~"¢dfûe.h
"

22 
	~<°dio.h
>

23 
	~<°dlib.h
>

25 #i‡
HAVE_UNISTD_H


26 
	~<uni°d.h
>

29 #i‡(
HAVE_DECL_S_IRGRP
 == 0)

30 
	~<sf_uni°d.h
>

33 
	~<°rög.h
>

34 
	~<f˙é.h
>

35 
	~<î∫o.h
>

36 
	~<sys/ty≥s.h
>

37 
	~<sys/°©.h
>

39 
	#SIGNED_SIZEOF
(
x
Ë((Ë (x))

	)

41 #i‡
deföed
 (
__CYGWIN__
)

43 
	#LSEEK
 
l£ek


	)

44 
	#FSTAT
 
f°©


	)

46 
°©
 
	tSTATBUF
 ;

47 
off_t
 
	tINT64
 ;

49 
	gdú_cmd
 [] = "ls -l" ;

51 
	#COMPILE_FULL_TEST
 1

	)

52 #ñi‡(
deföed
 (
WIN32
Ë|| deföed (
_WIN32
))

54 
	#LSEEK
 
_l£eki64


	)

55 
	#FSTAT
 
_f°©i64


	)

57 
_°©i64
 
	tSTATBUF
 ;

58 
__öt64
 
	tINT64
 ;

60 
	gdú_cmd
 [] = "dir" ;

62 
	#COMPILE_FULL_TEST
 1

	)

63 #ñi‡
deföed
 (
löux
)

65 
	#LSEEK
 
l£ek


	)

66 
	#FSTAT
 
f°©


	)

68 
°©
 
	tSTATBUF
 ;

69 
sf_cou¡_t
 
	tINT64
 ;

71 
	#O_BINARY
 0

	)

72 
	gdú_cmd
 [] = "ls -l" ;

74 
	#COMPILE_FULL_TEST
 1

	)

76 
	#COMPILE_FULL_TEST
 0

	)

79 #i‡
COMPILE_FULL_TEST


80 
show_f°©_îr‹
 () ;

81 
show_l£ek_îr‹
 () ;

84 
	$maö
 ()

85 { 
	`puts
 ("\n\n\n\n"

91 
	`show_f°©_îr‹
 () ;

92 
	`show_l£ek_îr‹
 () ;

94 
	`puts
 ("\n\n") ;

97 
	}
}

100 
	$show_f°©_îr‹
 ()

101 { c⁄° *
fûíame
 = "fstat.dat" ;

102 
d©a
 [256] ;

104 
STATBUF
 
°©buf
 ;

105 
fd
, 
mode
, 
Êags
 ;

107 i‡( (
°©buf
.
°_size
Ë! (
INT64
))

108 { 
	`¥ötf
 ("\n\nLöê%d: Eº‹, sizeo‡(°©buf.°_sizeË!8.\n\n", 
__LINE__
) ;

112 
	`puts
 ("\n64 bit fstat()Åest.\n--------------------") ;

114 
	`¥ötf
 ("0ËCª©ê®fûe, wrôê%d byã†™d clo£ it.\n", 
	`SIGNED_SIZEOF
 (
d©a
)) ;

115 
mode
 = 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 | 
O_BINARY
 ;

116 
Êags
 = 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IROTH
 ;

117 i‡((
fd
 = 
	`›í
 (
fûíame
, 
mode
, 
Êags
)) < 0)

118 { 
	`¥ötf
 ("\n\nLöê%d: o≥n(ËÁûed : %s\n\n", 
__LINE__
, 
	`°ªº‹
 (
î∫o
)) ;

121 
	`wrôe
 (
fd
, 
d©a
,  (data)) ;

122 
	`˛o£
 (
fd
) ;

124 
	`¥ötf
 ("1ËRe-›í fûêöÑód/wrôêmodê™d wrôê™Ÿhî %d byã†©Åhêíd.\n", 
	`SIGNED_SIZEOF
 (
d©a
)) ;

125 
mode
 = 
O_RDWR
 | 
O_BINARY
 ;

126 
Êags
 = 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IROTH
 ;

127 i‡((
fd
 = 
	`›í
 (
fûíame
, 
mode
, 
Êags
)) < 0)

128 { 
	`¥ötf
 ("\n\nLöê%d: o≥n(ËÁûed : %s\n\n", 
__LINE__
, 
	`°ªº‹
 (
î∫o
)) ;

131 
	`LSEEK
 (
fd
, 0, 
SEEK_END
) ;

132 
	`wrôe
 (
fd
, 
d©a
,  (data)) ;

134 
	`¥ötf
 ("2ËNow u£ sy°em (\"%†%s\"ËtÿshowÅhêfûêÀngth.\n\n", 
dú_cmd
, 
fûíame
) ;

135 
	`•rötf
 (
d©a
, "%†%s", 
dú_cmd
, 
fûíame
) ;

136 
	`sy°em
 (
d©a
) ;

137 
	`puts
 ("") ;

139 
	`¥ötf
 ("3) Now use fstat()Åo getÅhe fileÜength.\n") ;

140 i‡(
	`FSTAT
 (
fd
, &
°©buf
) != 0)

141 { 
	`¥ötf
 ("\n\nLöê%d: f°©(Ëªtu∫edÉº‹ : %s\n", 
__LINE__
, 
	`°ªº‹
 (
î∫o
)) ;

145 
	`¥ötf
 ("4ËAcc‹dögÅÿf°©(),ÅhêfûêÀngth i†%ld, ", (Ë
°©buf
.
°_size
) ;

147 
	`˛o£
 (
fd
) ;

149 i‡(
°©buf
.
°_size
 !2 *  (
d©a
))

150 
	`¥ötf
 ("butÅhats justÖlain ***WRONG***.\n\n") ;

152 { 
	`¥ötf
 ("which is correct.\n\n") ;

153 
	`u∆ök
 (
fûíame
) ;

156 
	}
}

159 
	$show_l£ek_îr‹
 ()

160 { c⁄° *
fûíame
 = "fstat.dat" ;

161 
d©a
 [256] ;

163 
INT64
 
ªtvÆ
 ;

164 
fd
, 
mode
, 
Êags
 ;

166 
	`puts
 ("\n64 bitÜseek()Åest.\n--------------------") ;

168 
	`¥ötf
 ("0ËCª©ê®fûe, wrôê%d byã†™d clo£ it.\n", 
	`SIGNED_SIZEOF
 (
d©a
)) ;

169 
mode
 = 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 | 
O_BINARY
 ;

170 
Êags
 = 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IROTH
 ;

171 i‡((
fd
 = 
	`›í
 (
fûíame
, 
mode
, 
Êags
)) < 0)

172 { 
	`¥ötf
 ("\n\nLöê%d: o≥n(ËÁûed : %s\n\n", 
__LINE__
, 
	`°ªº‹
 (
î∫o
)) ;

175 
	`wrôe
 (
fd
, 
d©a
,  (data)) ;

176 
	`˛o£
 (
fd
) ;

178 
	`¥ötf
 ("1ËRe-›í fûêöÑód/wrôêmodê™d wrôê™Ÿhî %d byã†©Åhêíd.\n", 
	`SIGNED_SIZEOF
 (
d©a
)) ;

179 
mode
 = 
O_RDWR
 | 
O_BINARY
 ;

180 
Êags
 = 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IROTH
 ;

181 i‡((
fd
 = 
	`›í
 (
fûíame
, 
mode
, 
Êags
)) < 0)

182 { 
	`¥ötf
 ("\n\nLöê%d: o≥n(ËÁûed : %s\n\n", 
__LINE__
, 
	`°ªº‹
 (
î∫o
)) ;

186 
	`LSEEK
 (
fd
, 0, 
SEEK_END
) ;

187 
	`wrôe
 (
fd
, 
d©a
,  (data)) ;

189 
	`¥ötf
 ("2ËNow u£ sy°em (\"%†%s\"ËtÿshowÅhêfûêÀngth.\n\n", 
dú_cmd
, 
fûíame
) ;

190 
	`•rötf
 (
d©a
, "%†%s", 
dú_cmd
, 
fûíame
) ;

191 
	`sy°em
 (
d©a
) ;

192 
	`puts
 ("") ;

194 
	`¥ötf
 ("3) Now useÜseek()Åo goÅoÅheÉnd ofÅhe file.\n") ;

195 
ªtvÆ
 = 
	`LSEEK
 (
fd
, 0, 
SEEK_END
) ;

197 
	`¥ötf
 ("4ËWê¨ênowáàposôi⁄ %ld, ", (Ë
ªtvÆ
) ;

199 
	`˛o£
 (
fd
) ;

201 i‡(
ªtvÆ
 !2 *  (
d©a
))

202 
	`¥ötf
 ("butÅhats justÖlain ***WRONG***.\n\n") ;

204 { 
	`¥ötf
 ("which is correct.\n\n") ;

205 
	`u∆ök
 (
fûíame
) ;

208 
	}
}

213 
	$maö
 ()

214 { 
	`puts
 ("\n"

223 
	}
}

	@libsndfile-1.0.17/tests/write_read_test.c

19 
	~"sfc⁄fig.h
"

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

25 #i‡
HAVE_UNISTD_H


26 
	~<uni°d.h
>

29 
	~<m©h.h
>

31 #i‡(
deföed
 (
WIN32
Ë|| deföed (
_WIN32
))

32 
	~<f˙é.h
>

33 
åunˇã
 (c⁄° *
fûíame
, 
ign‹ed
) ;

36 
	~<¢dfûe.h
>

38 
	~"utûs.h
"

40 
	#SAMPLE_RATE
 11025

	)

41 
	#DATA_LENGTH
 (1<<12)

	)

43 
	#SILLY_WRITE_COUNT
 (234)

	)

45 
pcm_ã°_ch¨
 (c⁄° *
°r
, 
f‹m©
, 
l⁄g_fûe_okz
) ;

46 
pcm_ã°_sh‹t
 (c⁄° *
°r
, 
f‹m©
, 
l⁄g_fûe_okz
) ;

47 
pcm_ã°_24bô
 (c⁄° *
°r
, 
f‹m©
, 
l⁄g_fûe_okz
) ;

48 
pcm_ã°_öt
 (c⁄° *
°r
, 
f‹m©
, 
l⁄g_fûe_okz
) ;

49 
pcm_ã°_Êﬂt
 (c⁄° *
°r
, 
f‹m©
, 
l⁄g_fûe_okz
) ;

50 
pcm_ã°_doubÀ
 (c⁄° *
°r
, 
f‹m©
, 
l⁄g_fûe_okz
) ;

52 
em±y_fûe_ã°
 (c⁄° *
fûíame
, 
f‹m©
) ;

55 { 
	md
 [
DATA_LENGTH
] ;

56 
	mf
 [
DATA_LENGTH
] ;

57 
	mi
 [
DATA_LENGTH
] ;

58 
	ms
 [
DATA_LENGTH
] ;

59 
	mc
 [
DATA_LENGTH
] ;

60 } 
	tBUFFER
 ;

62 
BUFFER
 
	g‹ig_d©a
 ;

63 
BUFFER
 
	gã°_d©a
 ;

66 
	$maö
 (
¨gc
, **
¨gv
)

67 { 
do_Æl
 = 0 ;

68 
ã°_cou¡
 = 0 ;

70 
	`cou¡_›í_fûes
 () ;

72 i‡(
¨gc
 != 2)

73 { 
	`¥ötf
 ("Ußgê: %†<ã°>\n", 
¨gv
 [0]) ;

74 
	`¥ötf
 (" Where <test> is one ofÅhe following:\n") ;

75 
	`¥ötf
 (" wav -Åest WAV file functions (littleÉndian)\n") ;

76 
	`¥ötf
 ("áiff -Åest AIFF file functions (bigÉndian)\n") ;

77 
	`¥ötf
 ("áu -Åest AU file functions\n") ;

78 
	`¥ötf
 ("ávr -Åest AVR file functions\n") ;

79 
	`¥ötf
 (" caf -Åest CAF file functions\n") ;

80 
	`¥ötf
 ("Ñaw -Åest RAW header-less PCM file functions\n") ;

81 
	`¥ötf
 ("Öaf -Åest PAF file functions\n") ;

82 
	`¥ötf
 (" svx -Åest 8SVX/16SV file functions\n") ;

83 
	`¥ötf
 ("Çist -Åest NIST Sphere file functions\n") ;

84 
	`¥ötf
 (" ircam -Åest IRCAM file functions\n") ;

85 
	`¥ötf
 (" voc - Create Voice file functions\n") ;

86 
	`¥ötf
 (" w64 - Sonic Foundry's W64 file functions\n") ;

87 
	`¥ötf
 (" flac -Åest FLAC file functions\n") ;

88 
	`¥ötf
 ("áll -ÖerformállÅests\n") ;

89 
	`exô
 (1) ;

92 
do_Æl
 = !
	`°rcmp
 (
¨gv
 [1], "all") ;

94 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "wav"))

95 { 
	`pcm_ã°_ch¨
 ("ch¨.wav" , 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_U8
, 
SF_FALSE
) ;

96 
	`pcm_ã°_sh‹t
 ("sh‹t.wav" , 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

97 
	`pcm_ã°_24bô
 ("24bô.wav" , 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_24
, 
SF_FALSE
) ;

98 
	`pcm_ã°_öt
 ("öt.wav" , 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_32
, 
SF_FALSE
) ;

100 
	`pcm_ã°_ch¨
 ("ch¨.rifx" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_U8
, 
SF_FALSE
) ;

101 
	`pcm_ã°_sh‹t
 ("sh‹t.rifx" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

102 
	`pcm_ã°_24bô
 ("24bô.rifx" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_24
, 
SF_FALSE
) ;

103 
	`pcm_ã°_öt
 ("öt.rifx" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_32
, 
SF_FALSE
) ;

105 
	`pcm_ã°_24bô
 ("24bô.wavex" , 
SF_FORMAT_WAVEX
 | 
SF_FORMAT_PCM_24
, 
SF_FALSE
) ;

106 
	`pcm_ã°_öt
 ("öt.wavex" , 
SF_FORMAT_WAVEX
 | 
SF_FORMAT_PCM_32
, 
SF_FALSE
) ;

109 
	`pcm_ã°_Êﬂt
 ("Êﬂt.wav" , 
SF_FORMAT_WAV
 | 
SF_FORMAT_FLOAT
 , 
SF_FALSE
) ;

110 
	`pcm_ã°_doubÀ
 ("doubÀ.wav" , 
SF_FORMAT_WAV
 | 
SF_FORMAT_DOUBLE
, 
SF_FALSE
) ;

112 
	`pcm_ã°_Êﬂt
 ("Êﬂt.rifx" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_FLOAT
 , 
SF_FALSE
) ;

113 
	`pcm_ã°_doubÀ
 ("doubÀ.rifx" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_WAV
 | 
SF_FORMAT_DOUBLE
, 
SF_FALSE
) ;

115 
	`pcm_ã°_Êﬂt
 ("Êﬂt.wavex" , 
SF_FORMAT_WAVEX
 | 
SF_FORMAT_FLOAT
 , 
SF_FALSE
) ;

116 
	`pcm_ã°_doubÀ
 ("doubÀ.wavex" , 
SF_FORMAT_WAVEX
 | 
SF_FORMAT_DOUBLE
, 
SF_FALSE
) ;

119 
	`em±y_fûe_ã°
 ("em±y_ch¨.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_U8
) ;

120 
	`em±y_fûe_ã°
 ("em±y_sh‹t.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_PCM_16
) ;

121 
	`em±y_fûe_ã°
 ("em±y_Êﬂt.wav", 
SF_FORMAT_WAV
 | 
SF_FORMAT_FLOAT
) ;

123 
ã°_cou¡
++ ;

126 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "aiff"))

127 { 
	`pcm_ã°_ch¨
 ("ch¨_u8.aiff" , 
SF_FORMAT_AIFF
 | 
SF_FORMAT_PCM_U8
, 
SF_FALSE
) ;

128 
	`pcm_ã°_ch¨
 ("ch¨_s8.aiff" , 
SF_FORMAT_AIFF
 | 
SF_FORMAT_PCM_S8
, 
SF_FALSE
) ;

129 
	`pcm_ã°_sh‹t
 ("sh‹t.aiff" , 
SF_FORMAT_AIFF
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

130 
	`pcm_ã°_24bô
 ("24bô.aiff" , 
SF_FORMAT_AIFF
 | 
SF_FORMAT_PCM_24
, 
SF_FALSE
) ;

131 
	`pcm_ã°_öt
 ("öt.aiff" , 
SF_FORMAT_AIFF
 | 
SF_FORMAT_PCM_32
, 
SF_FALSE
) ;

133 
	`pcm_ã°_sh‹t
 ("sh‹t_sowt.aifc" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AIFF
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

134 
	`pcm_ã°_24bô
 ("24bô_sowt.aifc" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AIFF
 | 
SF_FORMAT_PCM_24
, 
SF_FALSE
) ;

135 
	`pcm_ã°_öt
 ("öt_sowt.aifc" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AIFF
 | 
SF_FORMAT_PCM_32
, 
SF_FALSE
) ;

137 
	`pcm_ã°_sh‹t
 ("sh‹t_twos.aifc" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AIFF
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

138 
	`pcm_ã°_24bô
 ("24bô_twos.aifc" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AIFF
 | 
SF_FORMAT_PCM_24
, 
SF_FALSE
) ;

139 
	`pcm_ã°_öt
 ("öt_twos.aifc" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_AIFF
 | 
SF_FORMAT_PCM_32
, 
SF_FALSE
) ;

142 
	`pcm_ã°_sh‹t
 ("dwvw16.aifc", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_DWVW_16
, 
SF_TRUE
) ;

143 
	`pcm_ã°_24bô
 ("dwvw24.aifc", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_DWVW_24
, 
SF_TRUE
) ;

145 
	`pcm_ã°_Êﬂt
 ("Êﬂt.aifc" , 
SF_FORMAT_AIFF
 | 
SF_FORMAT_FLOAT
 , 
SF_FALSE
) ;

146 
	`pcm_ã°_doubÀ
 ("doubÀ.aifc" , 
SF_FORMAT_AIFF
 | 
SF_FORMAT_DOUBLE
, 
SF_FALSE
) ;

149 
	`em±y_fûe_ã°
 ("em±y_ch¨.aiff", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_PCM_U8
) ;

150 
	`em±y_fûe_ã°
 ("em±y_sh‹t.aiff", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_PCM_16
) ;

151 
	`em±y_fûe_ã°
 ("em±y_Êﬂt.aiff", 
SF_FORMAT_AIFF
 | 
SF_FORMAT_FLOAT
) ;

153 
ã°_cou¡
++ ;

156 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "au"))

157 { 
	`pcm_ã°_ch¨
 ("ch¨.au" , 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_S8
, 
SF_FALSE
) ;

158 
	`pcm_ã°_sh‹t
 ("sh‹t.au" , 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

159 
	`pcm_ã°_24bô
 ("24bô.au" , 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_24
, 
SF_FALSE
) ;

160 
	`pcm_ã°_öt
 ("öt.au" , 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_32
, 
SF_FALSE
) ;

162 
	`pcm_ã°_Êﬂt
 ("Êﬂt.au" , 
SF_FORMAT_AU
 | 
SF_FORMAT_FLOAT
 , 
SF_FALSE
) ;

163 
	`pcm_ã°_doubÀ
 ("doubÀ.au", 
SF_FORMAT_AU
 | 
SF_FORMAT_DOUBLE
, 
SF_FALSE
) ;

166 
	`pcm_ã°_ch¨
 ("ch¨_À.au" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_S8
, 
SF_FALSE
) ;

167 
	`pcm_ã°_sh‹t
 ("sh‹t_À.au" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

168 
	`pcm_ã°_24bô
 ("24bô_À.au" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_24
, 
SF_FALSE
) ;

169 
	`pcm_ã°_öt
 ("öt_À.au" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_PCM_32
, 
SF_FALSE
) ;

171 
	`pcm_ã°_Êﬂt
 ("Êﬂt_À.au" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_FLOAT
 , 
SF_FALSE
) ;

172 
	`pcm_ã°_doubÀ
 ("doubÀ_À.au" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_AU
 | 
SF_FORMAT_DOUBLE
, 
SF_FALSE
) ;

174 
ã°_cou¡
++ ;

177 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "caf"))

178 { 
	`pcm_ã°_ch¨
 ("ch¨.ˇf" , 
SF_FORMAT_CAF
 | 
SF_FORMAT_PCM_S8
, 
SF_FALSE
) ;

179 
	`pcm_ã°_sh‹t
 ("sh‹t.ˇf" , 
SF_FORMAT_CAF
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

180 
	`pcm_ã°_24bô
 ("24bô.ˇf" , 
SF_FORMAT_CAF
 | 
SF_FORMAT_PCM_24
, 
SF_FALSE
) ;

181 
	`pcm_ã°_öt
 ("öt.ˇf" , 
SF_FORMAT_CAF
 | 
SF_FORMAT_PCM_32
, 
SF_FALSE
) ;

183 
	`pcm_ã°_Êﬂt
 ("Êﬂt.ˇf" , 
SF_FORMAT_CAF
 | 
SF_FORMAT_FLOAT
 , 
SF_FALSE
) ;

184 
	`pcm_ã°_doubÀ
 ("doubÀ.ˇf" , 
SF_FORMAT_CAF
 | 
SF_FORMAT_DOUBLE
, 
SF_FALSE
) ;

187 
	`pcm_ã°_sh‹t
 ("sh‹t_À.ˇf" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_CAF
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

188 
	`pcm_ã°_24bô
 ("24bô_À.ˇf" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_CAF
 | 
SF_FORMAT_PCM_24
, 
SF_FALSE
) ;

189 
	`pcm_ã°_öt
 ("öt_À.ˇf" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_CAF
 | 
SF_FORMAT_PCM_32
, 
SF_FALSE
) ;

191 
	`pcm_ã°_Êﬂt
 ("Êﬂt_À.ˇf" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_CAF
 | 
SF_FORMAT_FLOAT
 , 
SF_FALSE
) ;

192 
	`pcm_ã°_doubÀ
 ("doubÀ_À.ˇf", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_CAF
 | 
SF_FORMAT_DOUBLE
, 
SF_FALSE
) ;

194 
ã°_cou¡
++ ;

197 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "raw"))

198 { 
	`pcm_ã°_ch¨
 ("ch¨_s8.øw" , 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_S8
, 
SF_FALSE
) ;

199 
	`pcm_ã°_ch¨
 ("ch¨_u8.øw" , 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_U8
, 
SF_FALSE
) ;

201 
	`pcm_ã°_sh‹t
 ("sh‹t_À.øw" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

202 
	`pcm_ã°_sh‹t
 ("sh‹t_be.øw" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

203 
	`pcm_ã°_24bô
 ("24bô_À.øw" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_24
, 
SF_FALSE
) ;

204 
	`pcm_ã°_24bô
 ("24bô_be.øw" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_24
, 
SF_FALSE
) ;

205 
	`pcm_ã°_öt
 ("öt_À.øw" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_32
, 
SF_FALSE
) ;

206 
	`pcm_ã°_öt
 ("öt_be.øw" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_PCM_32
, 
SF_FALSE
) ;

209 
	`pcm_ã°_Êﬂt
 ("Êﬂt_À.øw" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_FLOAT
 , 
SF_FALSE
) ;

210 
	`pcm_ã°_Êﬂt
 ("Êﬂt_be.øw" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_FLOAT
 , 
SF_FALSE
) ;

212 
	`pcm_ã°_doubÀ
 ("doubÀ_À.øw", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_DOUBLE
, 
SF_FALSE
) ;

213 
	`pcm_ã°_doubÀ
 ("doubÀ_be.øw", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_RAW
 | 
SF_FORMAT_DOUBLE
, 
SF_FALSE
) ;

215 
ã°_cou¡
++ ;

219 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "paf"))

220 { 
	`pcm_ã°_ch¨
 ("ch¨_À.∑f", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_PAF
 | 
SF_FORMAT_PCM_S8
, 
SF_FALSE
) ;

221 
	`pcm_ã°_ch¨
 ("ch¨_be.∑f", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_PAF
 | 
SF_FORMAT_PCM_S8
, 
SF_FALSE
) ;

222 
	`pcm_ã°_sh‹t
 ("sh‹t_À.∑f", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_PAF
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

223 
	`pcm_ã°_sh‹t
 ("sh‹t_be.∑f", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_PAF
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

224 
	`pcm_ã°_24bô
 ("24bô_À.∑f", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_PAF
 | 
SF_FORMAT_PCM_24
, 
SF_TRUE
) ;

225 
	`pcm_ã°_24bô
 ("24bô_be.∑f", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_PAF
 | 
SF_FORMAT_PCM_24
, 
SF_TRUE
) ;

226 
ã°_cou¡
++ ;

229 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "svx"))

230 { 
	`pcm_ã°_ch¨
 ("ch¨.svx" , 
SF_FORMAT_SVX
 | 
SF_FORMAT_PCM_S8
, 
SF_FALSE
) ;

231 
	`pcm_ã°_sh‹t
 ("sh‹t.svx", 
SF_FORMAT_SVX
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

233 
	`em±y_fûe_ã°
 ("em±y_ch¨.svx", 
SF_FORMAT_SVX
 | 
SF_FORMAT_PCM_S8
) ;

234 
	`em±y_fûe_ã°
 ("em±y_sh‹t.svx", 
SF_FORMAT_SVX
 | 
SF_FORMAT_PCM_16
) ;

236 
ã°_cou¡
++ ;

239 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "nist"))

240 { 
	`pcm_ã°_sh‹t
 ("sh‹t_À.ni°", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_NIST
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

241 
	`pcm_ã°_sh‹t
 ("sh‹t_be.ni°", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_NIST
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

242 
	`pcm_ã°_24bô
 ("24bô_À.ni°", 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_NIST
 | 
SF_FORMAT_PCM_24
, 
SF_FALSE
) ;

243 
	`pcm_ã°_24bô
 ("24bô_be.ni°", 
SF_ENDIAN_BIG
 | 
SF_FORMAT_NIST
 | 
SF_FORMAT_PCM_24
, 
SF_FALSE
) ;

244 
	`pcm_ã°_öt
 ("öt_À.ni°" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_NIST
 | 
SF_FORMAT_PCM_32
, 
SF_FALSE
) ;

245 
	`pcm_ã°_öt
 ("öt_be.ni°" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_NIST
 | 
SF_FORMAT_PCM_32
, 
SF_FALSE
) ;

247 
ã°_cou¡
++ ;

250 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "ircam"))

251 { 
	`pcm_ã°_sh‹t
 ("sh‹t_be.úˇm" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_IRCAM
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

252 
	`pcm_ã°_sh‹t
 ("sh‹t_À.úˇm" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_IRCAM
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

253 
	`pcm_ã°_öt
 ("öt_be.úˇm" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_IRCAM
 | 
SF_FORMAT_PCM_32
, 
SF_FALSE
) ;

254 
	`pcm_ã°_öt
 ("öt_À.úˇm" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_IRCAM
 | 
SF_FORMAT_PCM_32
, 
SF_FALSE
) ;

255 
	`pcm_ã°_Êﬂt
 ("Êﬂt_be.úˇm" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_IRCAM
 | 
SF_FORMAT_FLOAT
 , 
SF_FALSE
) ;

256 
	`pcm_ã°_Êﬂt
 ("Êﬂt_À.úˇm" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_IRCAM
 | 
SF_FORMAT_FLOAT
 , 
SF_FALSE
) ;

258 
ã°_cou¡
++ ;

261 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "voc"))

262 { 
	`pcm_ã°_ch¨
 ("ch¨.voc" , 
SF_FORMAT_VOC
 | 
SF_FORMAT_PCM_U8
, 
SF_FALSE
) ;

263 
	`pcm_ã°_sh‹t
 ("sh‹t.voc", 
SF_FORMAT_VOC
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

265 
ã°_cou¡
++ ;

268 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "mat4"))

269 { 
	`pcm_ã°_sh‹t
 ("sh‹t_be.m©4" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_MAT4
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

270 
	`pcm_ã°_sh‹t
 ("sh‹t_À.m©4" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_MAT4
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

271 
	`pcm_ã°_öt
 ("öt_be.m©4" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_MAT4
 | 
SF_FORMAT_PCM_32
, 
SF_FALSE
) ;

272 
	`pcm_ã°_öt
 ("öt_À.m©4" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_MAT4
 | 
SF_FORMAT_PCM_32
, 
SF_FALSE
) ;

273 
	`pcm_ã°_Êﬂt
 ("Êﬂt_be.m©4" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_MAT4
 | 
SF_FORMAT_FLOAT
 , 
SF_FALSE
) ;

274 
	`pcm_ã°_Êﬂt
 ("Êﬂt_À.m©4" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_MAT4
 | 
SF_FORMAT_FLOAT
 , 
SF_FALSE
) ;

275 
	`pcm_ã°_doubÀ
 ("doubÀ_be.m©4" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_MAT4
 | 
SF_FORMAT_DOUBLE
, 
SF_FALSE
) ;

276 
	`pcm_ã°_doubÀ
 ("doubÀ_À.m©4" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_MAT4
 | 
SF_FORMAT_DOUBLE
, 
SF_FALSE
) ;

278 
	`em±y_fûe_ã°
 ("em±y_sh‹t.m©4", 
SF_FORMAT_MAT4
 | 
SF_FORMAT_PCM_16
) ;

279 
	`em±y_fûe_ã°
 ("em±y_Êﬂt.m©4", 
SF_FORMAT_MAT4
 | 
SF_FORMAT_FLOAT
) ;

280 
ã°_cou¡
++ ;

283 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "mat5"))

284 { 
	`pcm_ã°_ch¨
 ("ch¨_be.m©5" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_MAT5
 | 
SF_FORMAT_PCM_U8
, 
SF_FALSE
) ;

285 
	`pcm_ã°_ch¨
 ("ch¨_À.m©5" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_MAT5
 | 
SF_FORMAT_PCM_U8
, 
SF_FALSE
) ;

286 
	`pcm_ã°_sh‹t
 ("sh‹t_be.m©5" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_MAT5
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

287 
	`pcm_ã°_sh‹t
 ("sh‹t_À.m©5" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_MAT5
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

288 
	`pcm_ã°_öt
 ("öt_be.m©5" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_MAT5
 | 
SF_FORMAT_PCM_32
, 
SF_FALSE
) ;

289 
	`pcm_ã°_öt
 ("öt_À.m©5" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_MAT5
 | 
SF_FORMAT_PCM_32
, 
SF_FALSE
) ;

290 
	`pcm_ã°_Êﬂt
 ("Êﬂt_be.m©5" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_MAT5
 | 
SF_FORMAT_FLOAT
 , 
SF_FALSE
) ;

291 
	`pcm_ã°_Êﬂt
 ("Êﬂt_À.m©5" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_MAT5
 | 
SF_FORMAT_FLOAT
 , 
SF_FALSE
) ;

292 
	`pcm_ã°_doubÀ
 ("doubÀ_be.m©5" , 
SF_ENDIAN_BIG
 | 
SF_FORMAT_MAT5
 | 
SF_FORMAT_DOUBLE
, 
SF_FALSE
) ;

293 
	`pcm_ã°_doubÀ
 ("doubÀ_À.m©5" , 
SF_ENDIAN_LITTLE
 | 
SF_FORMAT_MAT5
 | 
SF_FORMAT_DOUBLE
, 
SF_FALSE
) ;

295 
	`ö¸emít_›í_fûe_cou¡
 () ;

297 
	`em±y_fûe_ã°
 ("em±y_ch¨.m©5", 
SF_FORMAT_MAT5
 | 
SF_FORMAT_PCM_U8
) ;

298 
	`em±y_fûe_ã°
 ("em±y_sh‹t.m©5", 
SF_FORMAT_MAT5
 | 
SF_FORMAT_PCM_16
) ;

299 
	`em±y_fûe_ã°
 ("em±y_Êﬂt.m©5", 
SF_FORMAT_MAT5
 | 
SF_FORMAT_FLOAT
) ;

301 
ã°_cou¡
++ ;

304 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "pvf"))

305 { 
	`pcm_ã°_ch¨
 ("ch¨.pvf" , 
SF_FORMAT_PVF
 | 
SF_FORMAT_PCM_S8
, 
SF_FALSE
) ;

306 
	`pcm_ã°_sh‹t
 ("sh‹t.pvf", 
SF_FORMAT_PVF
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

307 
	`pcm_ã°_öt
 ("öt.pvf" , 
SF_FORMAT_PVF
 | 
SF_FORMAT_PCM_32
, 
SF_FALSE
) ;

308 
ã°_cou¡
++ ;

311 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "htk"))

312 { 
	`pcm_ã°_sh‹t
 ("sh‹t.htk", 
SF_FORMAT_HTK
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

313 
ã°_cou¡
++ ;

316 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "avr"))

317 { 
	`pcm_ã°_ch¨
 ("ch¨_u8.avr" , 
SF_FORMAT_AVR
 | 
SF_FORMAT_PCM_U8
, 
SF_FALSE
) ;

318 
	`pcm_ã°_ch¨
 ("ch¨_s8.avr" , 
SF_FORMAT_AVR
 | 
SF_FORMAT_PCM_S8
, 
SF_FALSE
) ;

319 
	`pcm_ã°_sh‹t
 ("sh‹t.avr" , 
SF_FORMAT_AVR
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

320 
ã°_cou¡
++ ;

324 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "w64"))

325 { 
	`pcm_ã°_ch¨
 ("ch¨.w64" , 
SF_FORMAT_W64
 | 
SF_FORMAT_PCM_U8
, 
SF_FALSE
) ;

326 
	`pcm_ã°_sh‹t
 ("sh‹t.w64" , 
SF_FORMAT_W64
 | 
SF_FORMAT_PCM_16
, 
SF_FALSE
) ;

327 
	`pcm_ã°_24bô
 ("24bô.w64" , 
SF_FORMAT_W64
 | 
SF_FORMAT_PCM_24
, 
SF_FALSE
) ;

328 
	`pcm_ã°_öt
 ("öt.w64" , 
SF_FORMAT_W64
 | 
SF_FORMAT_PCM_32
, 
SF_FALSE
) ;

330 
	`pcm_ã°_Êﬂt
 ("Êﬂt.w64" , 
SF_FORMAT_W64
 | 
SF_FORMAT_FLOAT
 , 
SF_FALSE
) ;

331 
	`pcm_ã°_doubÀ
 ("doubÀ.w64" , 
SF_FORMAT_W64
 | 
SF_FORMAT_DOUBLE
, 
SF_FALSE
) ;

334 
	`em±y_fûe_ã°
 ("em±y_ch¨.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_PCM_U8
) ;

335 
	`em±y_fûe_ã°
 ("em±y_sh‹t.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_PCM_16
) ;

336 
	`em±y_fûe_ã°
 ("em±y_Êﬂt.w64", 
SF_FORMAT_W64
 | 
SF_FORMAT_FLOAT
) ;

338 
ã°_cou¡
++ ;

341 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "sds"))

342 { 
	`pcm_ã°_ch¨
 ("ch¨.sds" , 
SF_FORMAT_SDS
 | 
SF_FORMAT_PCM_S8
, 
SF_TRUE
) ;

343 
	`pcm_ã°_sh‹t
 ("sh‹t.sds" , 
SF_FORMAT_SDS
 | 
SF_FORMAT_PCM_16
, 
SF_TRUE
) ;

344 
	`pcm_ã°_24bô
 ("24bô.sds" , 
SF_FORMAT_SDS
 | 
SF_FORMAT_PCM_24
, 
SF_TRUE
) ;

345 
ã°_cou¡
++ ;

348 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "sd2"))

349 { 
	`pcm_ã°_ch¨
 ("ch¨.sd2" , 
SF_FORMAT_SD2
 | 
SF_FORMAT_PCM_S8
, 
SF_TRUE
) ;

350 
	`pcm_ã°_sh‹t
 ("sh‹t.sd2" , 
SF_FORMAT_SD2
 | 
SF_FORMAT_PCM_16
, 
SF_TRUE
) ;

351 
	`pcm_ã°_24bô
 ("24bô.sd2" , 
SF_FORMAT_SD2
 | 
SF_FORMAT_PCM_24
, 
SF_TRUE
) ;

352 
ã°_cou¡
++ ;

355 i‡(
do_Æl
 || ! 
	`°rcmp
 (
¨gv
 [1], "flac"))

357 #ifde‡
HAVE_FLAC_ALL_H


358 
	`pcm_ã°_ch¨
 ("ch¨.Êac" , 
SF_FORMAT_FLAC
 | 
SF_FORMAT_PCM_S8
, 
SF_TRUE
) ;

359 
	`pcm_ã°_sh‹t
 ("sh‹t.Êac" , 
SF_FORMAT_FLAC
 | 
SF_FORMAT_PCM_16
, 
SF_TRUE
) ;

360 
	`pcm_ã°_24bô
 ("24bô.Êac" , 
SF_FORMAT_FLAC
 | 
SF_FORMAT_PCM_24
, 
SF_TRUE
) ;

362 
	`¥ötf
 (" **** flacÇot supported inÅhis binary. ****\n") ;

364 
ã°_cou¡
++ ;

367 i‡(
ã°_cou¡
 == 0)

368 { 
	`¥ötf
 ("Mono : ************************************\n") ;

369 
	`¥ötf
 ("M⁄ÿ: * Nÿ'%s'Åe° deföed.\n", 
¨gv
 [1]) ;

370 
	`¥ötf
 ("Mono : ************************************\n") ;

375 
	`check_›í_fûe_cou¡_‹_dõ
 (
__LINE__
) ;

378 
	}
}

384 
¸óã_sh‹t_fûe
 (c⁄° *
fûíame
) ;

386 
	#CHAR_ERROR
(
x
,
y
Ë(
	`abs
 ((xË- (y)Ë> 255)

	)

387 
	#INT_ERROR
(
x
,
y
Ë(((xË- (y)Ë!0)

	)

388 
	#TRIBYTE_ERROR
(
x
,
y
Ë(
	`abs
 ((xË- (y)Ë> 255)

	)

389 
	#FLOAT_ERROR
(
x
,
y
Ë(
	`Ábs
 ((xË- (y)Ë> 1e-5)

	)

391 
	#CONVERT_DATA
(
k
,
Àn
,
√w
,
‹ig
) \

392 { (
k
Ë0 ; (kË< (
Àn
) ; (k) ++) \

393 (
√w
Ë[
k
] = (
‹ig
) [k] ; \

394 }

	)

400 
m⁄o_ch¨_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

401 
°îeo_ch¨_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

402 
m⁄o_rdwr_ch¨_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

403 
√w_rdwr_ch¨_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
Ælow_fd
) ;

406 
	$pcm_ã°_ch¨
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
)

407 { 
SF_INFO
 
sföfo
 ;

408 *
‹ig
, *
ã°
 ;

409 
k
, 
ôems
, 
Ælow_fd
 ;

412 
Ælow_fd
 = ((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_SD2
Ë? 
SF_FALSE
 : 
SF_TRUE
 ;

414 
	`¥öt_ã°_«me
 ("pcm_ã°_ch¨", 
fûíame
) ;

416 
sföfo
.
ßm∂î©e
 = 44100 ;

417 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

418 
sföfo
.
ch™√ls
 = 1 ;

419 
sföfo
.
f‹m©
 = format ;

421 
	`gí_wödowed_söe_doubÀ
 (
‹ig_d©a
.
d
, 
DATA_LENGTH
, 32000.0) ;

423 
‹ig
 = 
‹ig_d©a
.
s
 ;

424 
ã°
 = 
ã°_d©a
.
s
 ;

427 
	`CONVERT_DATA
 (
k
, 
DATA_LENGTH
, 
‹ig
, 
‹ig_d©a
.
d
) ;

429 
ôems
 = 
DATA_LENGTH
 ;

433 
	`m⁄o_ch¨_ã°
 (
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

436 i‡((
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_16
 ||

437 (
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_24
)

438 { 
	`u∆ök
 (
fûíame
) ;

439 
	`¥ötf
 ("no seek : ok\n") ;

443 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_FLAC
)

444 
	`m⁄o_rdwr_ch¨_ã°
 (
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

447 
sföfo
.
ch™√ls
 = 2 ;

448 i‡(
	`sf_f‹m©_check
 (&
sföfo
) == 0)

449 { 
	`u∆ök
 (
fûíame
) ;

450 
	`puts
 ("no stereo : ok") ;

454 
	`°îeo_ch¨_ã°
 (
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

458 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_PAF
 &&

459 (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_VOC
 &&

460 (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_FLAC
)

461 
	`√w_rdwr_ch¨_ã°
 (
fûíame
, 
f‹m©
, 
Ælow_fd
) ;

463 
	`dñëe_fûe
 (
f‹m©
, 
fûíame
) ;

465 
	`puts
 ("ok") ;

467 
	}
}

470 
	$m⁄o_ch¨_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
)

471 { 
SNDFILE
 *
fûe
 ;

472 
SF_INFO
 
sföfo
 ;

473 *
‹ig
, *
ã°
 ;

474 
sf_cou¡_t
 
cou¡
 ;

475 
k
, 
ôems
 ;

477 
sföfo
.
ßm∂î©e
 = 44100 ;

478 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

479 
sföfo
.
ch™√ls
 = 1 ;

480 
sföfo
.
f‹m©
 = format ;

482 
‹ig
 = 
‹ig_d©a
.
s
 ;

483 
ã°
 = 
ã°_d©a
.
s
 ;

485 
ôems
 = 
DATA_LENGTH
 ;

487 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

489 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_ARTIST
, "YourÇame here") ;

491 
	`ã°_wrôe_sh‹t_‹_dõ
 (
fûe
, 0, 
‹ig
, 
ôems
, 
__LINE__
) ;

492 
	`sf_wrôe_sync
 (
fûe
) ;

493 
	`ã°_wrôe_sh‹t_‹_dõ
 (
fûe
, 0, 
‹ig
, 
ôems
, 
__LINE__
) ;

494 
	`sf_wrôe_sync
 (
fûe
) ;

497 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_COPYRIGHT
, "Copyright (c) 2003") ;

499 
	`sf_˛o£
 (
fûe
) ;

501 
	`mem£t
 (
ã°
, 0, 
ôems
 *  ()) ;

503 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

504 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

506 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

508 i‡(
sföfo
.
f‹m©
 != format)

509 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
f‹m©
, 
sföfo
.format) ;

510 
	`exô
 (1) ;

513 i‡(
sföfo
.
‰ames
 < 2 * 
ôems
)

514 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘Çumbî o‡‰ame†ö fûê—oÿsh‹t). (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
ôems
) ;

515 
	`exô
 (1) ;

518 i‡(! 
l⁄g_fûe_ok
 && 
sföfo
.
‰ames
 > 2 * 
ôems
)

519 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘Çumbî o‡‰ame†ö fûê—oÿl⁄g). (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
ôems
) ;

520 
	`exô
 (1) ;

523 i‡(
sföfo
.
ch™√ls
 != 1)

524 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

525 
	`exô
 (1) ;

528 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

530 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 0, 
ã°
, 
ôems
, 
__LINE__
) ;

531 
k
 = 0 ; k < 
ôems
 ; k++)

532 i‡(
	`CHAR_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

533 { 
	`¥ötf
 ("\n\nLöê%d: M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

534 
	`exô
 (1) ;

538 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

540 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 0, 
ã°
, 4, 
__LINE__
) ;

541 
k
 = 0 ; k < 4 ; k++)

542 i‡(
	`CHAR_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

543 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

544 
	`exô
 (1) ;

547 i‡((
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_16
 ||

548 (
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_24
)

549 { 
	`sf_˛o£
 (
fûe
) ;

550 
	`u∆ök
 (
fûíame
) ;

551 
	`¥ötf
 ("no seek : ") ;

556 
	`ã°_£ek_‹_dõ
 (
fûe
, 
ôems
 + 10, 
SEEK_SET
, iãm†+ 10, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

558 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 0, 
ã°
 + 10, 4, 
__LINE__
) ;

559 
k
 = 10 ; k < 14 ; k++)

560 i‡(
	`CHAR_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

561 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
ã°
 [k], 
‹ig
 [k]) ;

562 
	`exô
 (1) ;

566 
	`ã°_£ek_‹_dõ
 (
fûe
, 6, 
SEEK_CUR
, 
ôems
 + 20, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

568 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 0, 
ã°
 + 20, 4, 
__LINE__
) ;

569 
k
 = 20 ; k < 24 ; k++)

570 i‡(
	`CHAR_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

571 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
ã°
 [k], 
‹ig
 [k]) ;

572 
	`exô
 (1) ;

576 
	`ã°_£ek_‹_dõ
 (
fûe
, -1 * (
sföfo
.
‰ames
 - 10), 
SEEK_END
, 10, sföfo.
ch™√ls
, 
__LINE__
) ;

578 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 0, 
ã°
 + 10, 4, 
__LINE__
) ;

579 
k
 = 10 ; k < 14 ; k++)

580 i‡(
	`CHAR_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

581 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êD (#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
ã°
 [k], 
‹ig
 [k]) ;

582 
	`exô
 (1) ;

586 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

588 
cou¡
 = 0 ;

589 
cou¡
 < 
sföfo
.
‰ames
)

590 
cou¡
 +
	`sf_ªad_sh‹t
 (
fûe
, 
ã°
, 311) ;

593 i‡(
	`sf_îr‹
 (
fûe
))

594 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ:Éº‹ whîêthîêshouldn'àhavêbì¿⁄e.\n", 
__LINE__
) ;

595 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

596 
	`exô
 (1) ;

600 i‡(
cou¡
 > 
sföfo
.
‰ames
)

601 { 
	`¥ötf
 ("\n\nLöe†%d :ÑódÖa°Énd o‡fûê(%ld should bê%ld)\n", 
__LINE__
, (Ë
cou¡
, (Ë
sföfo
.
‰ames
) ;

602 
	`exô
 (1) ;

605 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_CUR
, 
sföfo
.
‰ames
, sföfo.
ch™√ls
, 
__LINE__
) ;

607 
	`sf_˛o£
 (
fûe
) ;

609 
	}
}

612 
	$°îeo_ch¨_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
)

613 { 
SNDFILE
 *
fûe
 ;

614 
SF_INFO
 
sföfo
 ;

615 *
‹ig
, *
ã°
 ;

616 
k
, 
ôems
, 
‰ames
 ;

618 
sföfo
.
ßm∂î©e
 = 44100 ;

619 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

620 
sföfo
.
ch™√ls
 = 2 ;

621 
sföfo
.
f‹m©
 = format ;

623 
	`gí_wödowed_söe_doubÀ
 (
‹ig_d©a
.
d
, 
DATA_LENGTH
, 32000.0) ;

625 
‹ig
 = 
‹ig_d©a
.
s
 ;

626 
ã°
 = 
ã°_d©a
.
s
 ;

629 
	`CONVERT_DATA
 (
k
, 
DATA_LENGTH
, 
‹ig
, 
‹ig_d©a
.
d
) ;

631 
ôems
 = 
DATA_LENGTH
 ;

632 
‰ames
 = 
ôems
 / 
sföfo
.
ch™√ls
 ;

634 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

636 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_ARTIST
, "YourÇame here") ;

638 
	`ã°_wrôef_sh‹t_‹_dõ
 (
fûe
, 0, 
‹ig
, 
‰ames
, 
__LINE__
) ;

640 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_COPYRIGHT
, "Copyright (c) 2003") ;

642 
	`sf_˛o£
 (
fûe
) ;

644 
	`mem£t
 (
ã°
, 0, 
ôems
 *  ()) ;

646 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

647 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

649 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

651 i‡(
sföfo
.
f‹m©
 != format)

652 { 
	`¥ötf
 ("\n\nLine %d : Stereo : Returned format incorrect (0x%08X => 0x%08X).\n",

653 
__LINE__
, 
f‹m©
, 
sföfo
.format) ;

654 
	`exô
 (1) ;

657 i‡(
sföfo
.
‰ames
 < frames)

658 { 
	`¥ötf
 ("\n\nLine %d : Stereo : IncorrectÇumber of frames in file (too short). (%ld should be %d)\n",

659 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), frames) ;

660 
	`exô
 (1) ;

663 i‡(! 
l⁄g_fûe_ok
 && 
sföfo
.
‰ames
 > frames)

664 { 
	`¥ötf
 ("\n\nLine %d : Stereo : IncorrectÇumber of frames in file (tooÜong). (%ld should be %d)\n",

665 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), frames) ;

666 
	`exô
 (1) ;

669 i‡(
sföfo
.
ch™√ls
 != 2)

670 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

671 
	`exô
 (1) ;

674 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

676 
	`ã°_ªadf_sh‹t_‹_dõ
 (
fûe
, 0, 
ã°
, 
‰ames
, 
__LINE__
) ;

677 
k
 = 0 ; k < 
ôems
 ; k++)

678 i‡(
	`CHAR_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

679 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

680 
	`exô
 (1) ;

684 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

686 
	`ã°_ªadf_sh‹t_‹_dõ
 (
fûe
, 0, 
ã°
, 2, 
__LINE__
) ;

687 
k
 = 0 ; k < 4 ; k++)

688 i‡(
	`CHAR_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

689 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

690 
	`exô
 (1) ;

694 
	`ã°_£ek_‹_dõ
 (
fûe
, 10, 
SEEK_SET
, 10, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

697 i‡(
	`sf_îr‹
 (
fûe
))

698 { 
	`¥ötf
 ("Löê%d: Should NOTÑëu∫á¿îr‹.\n", 
__LINE__
) ;

699 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

700 
	`exô
 (1) ;

703 i‡(
	`sf_ªad_sh‹t
 (
fûe
, 
ã°
, 1) > 0)

704 { 
	`¥ötf
 ("Löê%d: ShouldÑëu∫ 0.\n", 
__LINE__
) ;

705 
	`exô
 (1) ;

708 i‡(! 
	`sf_îr‹
 (
fûe
))

709 { 
	`¥ötf
 ("Löê%d: ShouldÑëu∫á¿îr‹.\n", 
__LINE__
) ;

710 
	`exô
 (1) ;

714 
	`ã°_ªadf_sh‹t_‹_dõ
 (
fûe
, 0, 
ã°
 + 10, 2, 
__LINE__
) ;

715 
k
 = 20 ; k < 24 ; k++)

716 i‡(
	`CHAR_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

717 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

718 
	`exô
 (1) ;

722 
	`ã°_£ek_‹_dõ
 (
fûe
, 8, 
SEEK_CUR
, 20, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

724 
	`ã°_ªadf_sh‹t_‹_dõ
 (
fûe
, 0, 
ã°
 + 20, 2, 
__LINE__
) ;

725 
k
 = 40 ; k < 44 ; k++)

726 i‡(
	`CHAR_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

727 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

728 
	`exô
 (1) ;

732 
	`ã°_£ek_‹_dõ
 (
fûe
, -1 * (
sföfo
.
‰ames
 - 10), 
SEEK_END
, 10, sföfo.
ch™√ls
, 
__LINE__
) ;

734 
	`ã°_ªadf_sh‹t_‹_dõ
 (
fûe
, 0, 
ã°
 + 20, 2, 
__LINE__
) ;

735 
k
 = 20 ; k < 24 ; k++)

736 i‡(
	`CHAR_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

737 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

738 
	`exô
 (1) ;

741 
	`sf_˛o£
 (
fûe
) ;

742 
	}
}

745 
	$m⁄o_rdwr_ch¨_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
)

746 { 
SNDFILE
 *
fûe
 ;

747 
SF_INFO
 
sföfo
 ;

748 *
‹ig
, *
ã°
 ;

749 
k
, 
∑ss
 ;

751 
‹ig
 = 
‹ig_d©a
.
s
 ;

752 
ã°
 = 
ã°_d©a
.
s
 ;

754 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

755 
sföfo
.
‰ames
 = 
DATA_LENGTH
 ;

756 
sföfo
.
ch™√ls
 = 1 ;

757 
sföfo
.
f‹m©
 = format ;

759 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_RAW


760 || (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_AU


761 || (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_SD2
)

762 
	`u∆ök
 (
fûíame
) ;

765 
	`¸óã_sh‹t_fûe
 (
fûíame
) ;

770 i‡((
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_RDWR
, &
sföfo
)))

771 { 
	`¥ötf
 ("\n\nLöê%d: sf_›í should (SFM_RDWRËhavêÁûed buàdidn't.\n", 
__LINE__
) ;

772 
	`exô
 (1) ;

776 i‡(
	`åunˇã
 (
fûíame
, 0) < 0)

777 { 
	`¥ötf
 ("\n\nLöê%d:Årunˇã (%sËÁûed", 
__LINE__
, 
fûíame
) ;

778 
	`≥º‹
 (
NULL
) ;

779 
	`exô
 (1) ;

786 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

787 
sföfo
.
‰ames
 = 
DATA_LENGTH
 ;

788 
sföfo
.
ch™√ls
 = 1 ;

789 
sföfo
.
f‹m©
 = format ;

791 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

796 
∑ss
 = 1 ;Öass <= 3 ;Öass ++)

797 { 
‹ig
 [20] = 
∑ss
 * 2 ;

800 
	`ã°_wrôe_sh‹t_‹_dõ
 (
fûe
, 
∑ss
, 
‹ig
, 
DATA_LENGTH
, 
__LINE__
) ;

802 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 
∑ss
, (∑s†- 1Ë* 
DATA_LENGTH
,Öass * DATA_LENGTH) ;

805 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 0, 
ã°
, 
DATA_LENGTH
, 
__LINE__
) ;

808 
k
 = 0 ; k < 
DATA_LENGTH
 ; k++)

809 i‡(
	`CHAR_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

810 { 
	`¥ötf
 ("\n\nLöê%d (∑s†%d): Eº‹áàßm∂ê%d (0x%X => 0x%X).\n", 
__LINE__
, 
∑ss
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

811 
	`o˘_ßve_sh‹t
 (
‹ig
, 
ã°
, 
DATA_LENGTH
) ;

812 
	`exô
 (1) ;

815 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 
∑ss
,Öas†* 
DATA_LENGTH
,Öass * DATA_LENGTH) ;

818 
	`sf_˛o£
 (
fûe
) ;

821 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

823 i‡(
sföfo
.
f‹m©
 != format)

824 { 
	`¥ötf
 ("\n\nLöê%d : Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
f‹m©
, 
sföfo
.format) ;

825 
	`exô
 (1) ;

828 i‡(
sföfo
.
‰ames
 < 3 * 
DATA_LENGTH
)

829 { 
	`¥ötf
 ("\n\nLöê%d : NŸÉnough føme†ö fûe. (%ld < %d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 3 * 
DATA_LENGTH
 ) ;

830 
	`exô
 (1) ;

833 i‡(! 
l⁄g_fûe_ok
 && 
sföfo
.
‰ames
 !3 * 
DATA_LENGTH
)

834 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 3 * 
DATA_LENGTH
 ) ;

835 
	`exô
 (1) ;

838 i‡(
sföfo
.
ch™√ls
 != 1)

839 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

840 
	`exô
 (1) ;

843 i‡(! 
l⁄g_fûe_ok
)

844 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 0, 0, 3 * 
DATA_LENGTH
) ;

846 
	`ã°_£ek_‹_dõ
 (
fûe
, 3 * 
DATA_LENGTH
, 
SFM_WRITE
 | 
SEEK_SET
, 3 * DATA_LENGTH, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

848 
∑ss
 = 1 ;Öass <= 3 ;Öass ++)

849 { 
‹ig
 [20] = 
∑ss
 * 2 ;

851 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 
∑ss
, (∑s†- 1Ë* 
DATA_LENGTH
, 3 * DATA_LENGTH) ;

854 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 
∑ss
, 
ã°
, 
DATA_LENGTH
, 
__LINE__
) ;

857 
k
 = 0 ; k < 
DATA_LENGTH
 ; k++)

858 i‡(
	`CHAR_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

859 { 
	`¥ötf
 ("\n\nLöê%d (∑s†%d): Eº‹áàßm∂ê%d (0x%X => 0x%X).\n", 
__LINE__
, 
∑ss
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

860 
	`o˘_ßve_sh‹t
 (
‹ig
, 
ã°
, 
DATA_LENGTH
) ;

861 
	`exô
 (1) ;

866 
	`sf_˛o£
 (
fûe
) ;

867 
	}
}

870 
	$√w_rdwr_ch¨_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
Ælow_fd
)

871 { 
SNDFILE
 *
wfûe
, *
rwfûe
 ;

872 
SF_INFO
 
sföfo
 ;

873 *
‹ig
, *
ã°
 ;

874 
ôems
, 
‰ames
 ;

876 
‹ig
 = 
‹ig_d©a
.
s
 ;

877 
ã°
 = 
ã°_d©a
.
s
 ;

879 
sföfo
.
ßm∂î©e
 = 44100 ;

880 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

881 
sföfo
.
ch™√ls
 = 2 ;

882 
sföfo
.
f‹m©
 = format ;

884 
ôems
 = 
DATA_LENGTH
 ;

885 
‰ames
 = 
ôems
 / 
sföfo
.
ch™√ls
 ;

887 
wfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

888 
	`sf_comm™d
 (
wfûe
, 
SFC_SET_UPDATE_HEADER_AUTO
, 
NULL
, 
SF_TRUE
) ;

889 
	`ã°_wrôef_sh‹t_‹_dõ
 (
wfûe
, 1, 
‹ig
, 
‰ames
, 
__LINE__
) ;

890 
	`sf_wrôe_sync
 (
wfûe
) ;

891 
	`ã°_wrôef_sh‹t_‹_dõ
 (
wfûe
, 2, 
‹ig
, 
‰ames
, 
__LINE__
) ;

892 
	`sf_wrôe_sync
 (
wfûe
) ;

894 
rwfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

895 i‡(
sföfo
.
‰ames
 != 2 * frames)

896 { 
	`¥ötf
 ("\n\nLöê%d : inc‹ª˘Çumbî o‡‰ame†ö fûê(%ld shﬁd bê%d)\n\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), frames) ;

897 
	`exô
 (1) ;

900 
	`ã°_wrôef_sh‹t_‹_dõ
 (
wfûe
, 3, 
‹ig
, 
‰ames
, 
__LINE__
) ;

902 
	`ã°_ªadf_sh‹t_‹_dõ
 (
rwfûe
, 1, 
ã°
, 
‰ames
, 
__LINE__
) ;

903 
	`ã°_ªadf_sh‹t_‹_dõ
 (
rwfûe
, 2, 
ã°
, 
‰ames
, 
__LINE__
) ;

905 
	`sf_˛o£
 (
wfûe
) ;

906 
	`sf_˛o£
 (
rwfûe
) ;

907 
	}
}

913 
m⁄o_sh‹t_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

914 
°îeo_sh‹t_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

915 
m⁄o_rdwr_sh‹t_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

916 
√w_rdwr_sh‹t_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
Ælow_fd
) ;

919 
	$pcm_ã°_sh‹t
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
)

920 { 
SF_INFO
 
sföfo
 ;

921 *
‹ig
, *
ã°
 ;

922 
k
, 
ôems
, 
Ælow_fd
 ;

925 
Ælow_fd
 = ((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_SD2
Ë? 
SF_FALSE
 : 
SF_TRUE
 ;

927 
	`¥öt_ã°_«me
 ("pcm_ã°_sh‹t", 
fûíame
) ;

929 
sföfo
.
ßm∂î©e
 = 44100 ;

930 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

931 
sföfo
.
ch™√ls
 = 1 ;

932 
sföfo
.
f‹m©
 = format ;

934 
	`gí_wödowed_söe_doubÀ
 (
‹ig_d©a
.
d
, 
DATA_LENGTH
, 32000.0) ;

936 
‹ig
 = 
‹ig_d©a
.
s
 ;

937 
ã°
 = 
ã°_d©a
.
s
 ;

940 
	`CONVERT_DATA
 (
k
, 
DATA_LENGTH
, 
‹ig
, 
‹ig_d©a
.
d
) ;

942 
ôems
 = 
DATA_LENGTH
 ;

946 
	`m⁄o_sh‹t_ã°
 (
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

949 i‡((
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_16
 ||

950 (
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_24
)

951 { 
	`u∆ök
 (
fûíame
) ;

952 
	`¥ötf
 ("no seek : ok\n") ;

956 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_FLAC
)

957 
	`m⁄o_rdwr_sh‹t_ã°
 (
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

960 
sföfo
.
ch™√ls
 = 2 ;

961 i‡(
	`sf_f‹m©_check
 (&
sföfo
) == 0)

962 { 
	`u∆ök
 (
fûíame
) ;

963 
	`puts
 ("no stereo : ok") ;

967 
	`°îeo_sh‹t_ã°
 (
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

971 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_PAF
 &&

972 (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_VOC
 &&

973 (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_FLAC
)

974 
	`√w_rdwr_sh‹t_ã°
 (
fûíame
, 
f‹m©
, 
Ælow_fd
) ;

976 
	`dñëe_fûe
 (
f‹m©
, 
fûíame
) ;

978 
	`puts
 ("ok") ;

980 
	}
}

983 
	$m⁄o_sh‹t_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
)

984 { 
SNDFILE
 *
fûe
 ;

985 
SF_INFO
 
sföfo
 ;

986 *
‹ig
, *
ã°
 ;

987 
sf_cou¡_t
 
cou¡
 ;

988 
k
, 
ôems
 ;

990 
sföfo
.
ßm∂î©e
 = 44100 ;

991 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

992 
sföfo
.
ch™√ls
 = 1 ;

993 
sföfo
.
f‹m©
 = format ;

995 
‹ig
 = 
‹ig_d©a
.
s
 ;

996 
ã°
 = 
ã°_d©a
.
s
 ;

998 
ôems
 = 
DATA_LENGTH
 ;

1000 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

1002 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_ARTIST
, "YourÇame here") ;

1004 
	`ã°_wrôe_sh‹t_‹_dõ
 (
fûe
, 0, 
‹ig
, 
ôems
, 
__LINE__
) ;

1005 
	`sf_wrôe_sync
 (
fûe
) ;

1006 
	`ã°_wrôe_sh‹t_‹_dõ
 (
fûe
, 0, 
‹ig
, 
ôems
, 
__LINE__
) ;

1007 
	`sf_wrôe_sync
 (
fûe
) ;

1010 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_COPYRIGHT
, "Copyright (c) 2003") ;

1012 
	`sf_˛o£
 (
fûe
) ;

1014 
	`mem£t
 (
ã°
, 0, 
ôems
 *  ()) ;

1016 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

1017 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

1019 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

1021 i‡(
sföfo
.
f‹m©
 != format)

1022 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
f‹m©
, 
sföfo
.format) ;

1023 
	`exô
 (1) ;

1026 i‡(
sföfo
.
‰ames
 < 2 * 
ôems
)

1027 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘Çumbî o‡‰ame†ö fûê—oÿsh‹t). (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
ôems
) ;

1028 
	`exô
 (1) ;

1031 i‡(! 
l⁄g_fûe_ok
 && 
sföfo
.
‰ames
 > 2 * 
ôems
)

1032 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘Çumbî o‡‰ame†ö fûê—oÿl⁄g). (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
ôems
) ;

1033 
	`exô
 (1) ;

1036 i‡(
sföfo
.
ch™√ls
 != 1)

1037 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

1038 
	`exô
 (1) ;

1041 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

1043 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 0, 
ã°
, 
ôems
, 
__LINE__
) ;

1044 
k
 = 0 ; k < 
ôems
 ; k++)

1045 i‡(
	`INT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

1046 { 
	`¥ötf
 ("\n\nLöê%d: M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

1047 
	`exô
 (1) ;

1051 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1053 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 0, 
ã°
, 4, 
__LINE__
) ;

1054 
k
 = 0 ; k < 4 ; k++)

1055 i‡(
	`INT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

1056 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

1057 
	`exô
 (1) ;

1060 i‡((
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_16
 ||

1061 (
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_24
)

1062 { 
	`sf_˛o£
 (
fûe
) ;

1063 
	`u∆ök
 (
fûíame
) ;

1064 
	`¥ötf
 ("no seek : ") ;

1069 
	`ã°_£ek_‹_dõ
 (
fûe
, 
ôems
 + 10, 
SEEK_SET
, iãm†+ 10, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1071 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 0, 
ã°
 + 10, 4, 
__LINE__
) ;

1072 
k
 = 10 ; k < 14 ; k++)

1073 i‡(
	`INT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

1074 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
ã°
 [k], 
‹ig
 [k]) ;

1075 
	`exô
 (1) ;

1079 
	`ã°_£ek_‹_dõ
 (
fûe
, 6, 
SEEK_CUR
, 
ôems
 + 20, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1081 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 0, 
ã°
 + 20, 4, 
__LINE__
) ;

1082 
k
 = 20 ; k < 24 ; k++)

1083 i‡(
	`INT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

1084 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
ã°
 [k], 
‹ig
 [k]) ;

1085 
	`exô
 (1) ;

1089 
	`ã°_£ek_‹_dõ
 (
fûe
, -1 * (
sföfo
.
‰ames
 - 10), 
SEEK_END
, 10, sföfo.
ch™√ls
, 
__LINE__
) ;

1091 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 0, 
ã°
 + 10, 4, 
__LINE__
) ;

1092 
k
 = 10 ; k < 14 ; k++)

1093 i‡(
	`INT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

1094 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êD (#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
ã°
 [k], 
‹ig
 [k]) ;

1095 
	`exô
 (1) ;

1099 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1101 
cou¡
 = 0 ;

1102 
cou¡
 < 
sföfo
.
‰ames
)

1103 
cou¡
 +
	`sf_ªad_sh‹t
 (
fûe
, 
ã°
, 311) ;

1106 i‡(
	`sf_îr‹
 (
fûe
))

1107 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ:Éº‹ whîêthîêshouldn'àhavêbì¿⁄e.\n", 
__LINE__
) ;

1108 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

1109 
	`exô
 (1) ;

1113 i‡(
cou¡
 > 
sföfo
.
‰ames
)

1114 { 
	`¥ötf
 ("\n\nLöe†%d :ÑódÖa°Énd o‡fûê(%ld should bê%ld)\n", 
__LINE__
, (Ë
cou¡
, (Ë
sföfo
.
‰ames
) ;

1115 
	`exô
 (1) ;

1118 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_CUR
, 
sföfo
.
‰ames
, sföfo.
ch™√ls
, 
__LINE__
) ;

1120 
	`sf_˛o£
 (
fûe
) ;

1122 
	}
}

1125 
	$°îeo_sh‹t_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
)

1126 { 
SNDFILE
 *
fûe
 ;

1127 
SF_INFO
 
sföfo
 ;

1128 *
‹ig
, *
ã°
 ;

1129 
k
, 
ôems
, 
‰ames
 ;

1131 
sföfo
.
ßm∂î©e
 = 44100 ;

1132 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

1133 
sföfo
.
ch™√ls
 = 2 ;

1134 
sföfo
.
f‹m©
 = format ;

1136 
	`gí_wödowed_söe_doubÀ
 (
‹ig_d©a
.
d
, 
DATA_LENGTH
, 32000.0) ;

1138 
‹ig
 = 
‹ig_d©a
.
s
 ;

1139 
ã°
 = 
ã°_d©a
.
s
 ;

1142 
	`CONVERT_DATA
 (
k
, 
DATA_LENGTH
, 
‹ig
, 
‹ig_d©a
.
d
) ;

1144 
ôems
 = 
DATA_LENGTH
 ;

1145 
‰ames
 = 
ôems
 / 
sföfo
.
ch™√ls
 ;

1147 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

1149 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_ARTIST
, "YourÇame here") ;

1151 
	`ã°_wrôef_sh‹t_‹_dõ
 (
fûe
, 0, 
‹ig
, 
‰ames
, 
__LINE__
) ;

1153 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_COPYRIGHT
, "Copyright (c) 2003") ;

1155 
	`sf_˛o£
 (
fûe
) ;

1157 
	`mem£t
 (
ã°
, 0, 
ôems
 *  ()) ;

1159 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

1160 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

1162 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

1164 i‡(
sföfo
.
f‹m©
 != format)

1165 { 
	`¥ötf
 ("\n\nLine %d : Stereo : Returned format incorrect (0x%08X => 0x%08X).\n",

1166 
__LINE__
, 
f‹m©
, 
sföfo
.format) ;

1167 
	`exô
 (1) ;

1170 i‡(
sföfo
.
‰ames
 < frames)

1171 { 
	`¥ötf
 ("\n\nLine %d : Stereo : IncorrectÇumber of frames in file (too short). (%ld should be %d)\n",

1172 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), frames) ;

1173 
	`exô
 (1) ;

1176 i‡(! 
l⁄g_fûe_ok
 && 
sföfo
.
‰ames
 > frames)

1177 { 
	`¥ötf
 ("\n\nLine %d : Stereo : IncorrectÇumber of frames in file (tooÜong). (%ld should be %d)\n",

1178 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), frames) ;

1179 
	`exô
 (1) ;

1182 i‡(
sföfo
.
ch™√ls
 != 2)

1183 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

1184 
	`exô
 (1) ;

1187 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

1189 
	`ã°_ªadf_sh‹t_‹_dõ
 (
fûe
, 0, 
ã°
, 
‰ames
, 
__LINE__
) ;

1190 
k
 = 0 ; k < 
ôems
 ; k++)

1191 i‡(
	`INT_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

1192 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

1193 
	`exô
 (1) ;

1197 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1199 
	`ã°_ªadf_sh‹t_‹_dõ
 (
fûe
, 0, 
ã°
, 2, 
__LINE__
) ;

1200 
k
 = 0 ; k < 4 ; k++)

1201 i‡(
	`INT_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

1202 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

1203 
	`exô
 (1) ;

1207 
	`ã°_£ek_‹_dõ
 (
fûe
, 10, 
SEEK_SET
, 10, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1210 i‡(
	`sf_îr‹
 (
fûe
))

1211 { 
	`¥ötf
 ("Löê%d: Should NOTÑëu∫á¿îr‹.\n", 
__LINE__
) ;

1212 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

1213 
	`exô
 (1) ;

1216 i‡(
	`sf_ªad_sh‹t
 (
fûe
, 
ã°
, 1) > 0)

1217 { 
	`¥ötf
 ("Löê%d: ShouldÑëu∫ 0.\n", 
__LINE__
) ;

1218 
	`exô
 (1) ;

1221 i‡(! 
	`sf_îr‹
 (
fûe
))

1222 { 
	`¥ötf
 ("Löê%d: ShouldÑëu∫á¿îr‹.\n", 
__LINE__
) ;

1223 
	`exô
 (1) ;

1227 
	`ã°_ªadf_sh‹t_‹_dõ
 (
fûe
, 0, 
ã°
 + 10, 2, 
__LINE__
) ;

1228 
k
 = 20 ; k < 24 ; k++)

1229 i‡(
	`INT_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

1230 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

1231 
	`exô
 (1) ;

1235 
	`ã°_£ek_‹_dõ
 (
fûe
, 8, 
SEEK_CUR
, 20, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1237 
	`ã°_ªadf_sh‹t_‹_dõ
 (
fûe
, 0, 
ã°
 + 20, 2, 
__LINE__
) ;

1238 
k
 = 40 ; k < 44 ; k++)

1239 i‡(
	`INT_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

1240 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

1241 
	`exô
 (1) ;

1245 
	`ã°_£ek_‹_dõ
 (
fûe
, -1 * (
sföfo
.
‰ames
 - 10), 
SEEK_END
, 10, sföfo.
ch™√ls
, 
__LINE__
) ;

1247 
	`ã°_ªadf_sh‹t_‹_dõ
 (
fûe
, 0, 
ã°
 + 20, 2, 
__LINE__
) ;

1248 
k
 = 20 ; k < 24 ; k++)

1249 i‡(
	`INT_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

1250 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

1251 
	`exô
 (1) ;

1254 
	`sf_˛o£
 (
fûe
) ;

1255 
	}
}

1258 
	$m⁄o_rdwr_sh‹t_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
)

1259 { 
SNDFILE
 *
fûe
 ;

1260 
SF_INFO
 
sföfo
 ;

1261 *
‹ig
, *
ã°
 ;

1262 
k
, 
∑ss
 ;

1264 
‹ig
 = 
‹ig_d©a
.
s
 ;

1265 
ã°
 = 
ã°_d©a
.
s
 ;

1267 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

1268 
sföfo
.
‰ames
 = 
DATA_LENGTH
 ;

1269 
sföfo
.
ch™√ls
 = 1 ;

1270 
sföfo
.
f‹m©
 = format ;

1272 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_RAW


1273 || (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_AU


1274 || (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_SD2
)

1275 
	`u∆ök
 (
fûíame
) ;

1278 
	`¸óã_sh‹t_fûe
 (
fûíame
) ;

1283 i‡((
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_RDWR
, &
sföfo
)))

1284 { 
	`¥ötf
 ("\n\nLöê%d: sf_›í should (SFM_RDWRËhavêÁûed buàdidn't.\n", 
__LINE__
) ;

1285 
	`exô
 (1) ;

1289 i‡(
	`åunˇã
 (
fûíame
, 0) < 0)

1290 { 
	`¥ötf
 ("\n\nLöê%d:Årunˇã (%sËÁûed", 
__LINE__
, 
fûíame
) ;

1291 
	`≥º‹
 (
NULL
) ;

1292 
	`exô
 (1) ;

1299 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

1300 
sföfo
.
‰ames
 = 
DATA_LENGTH
 ;

1301 
sföfo
.
ch™√ls
 = 1 ;

1302 
sföfo
.
f‹m©
 = format ;

1304 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

1309 
∑ss
 = 1 ;Öass <= 3 ;Öass ++)

1310 { 
‹ig
 [20] = 
∑ss
 * 2 ;

1313 
	`ã°_wrôe_sh‹t_‹_dõ
 (
fûe
, 
∑ss
, 
‹ig
, 
DATA_LENGTH
, 
__LINE__
) ;

1315 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 
∑ss
, (∑s†- 1Ë* 
DATA_LENGTH
,Öass * DATA_LENGTH) ;

1318 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 0, 
ã°
, 
DATA_LENGTH
, 
__LINE__
) ;

1321 
k
 = 0 ; k < 
DATA_LENGTH
 ; k++)

1322 i‡(
	`INT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

1323 { 
	`¥ötf
 ("\n\nLöê%d (∑s†%d): Eº‹áàßm∂ê%d (0x%X => 0x%X).\n", 
__LINE__
, 
∑ss
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

1324 
	`o˘_ßve_sh‹t
 (
‹ig
, 
ã°
, 
DATA_LENGTH
) ;

1325 
	`exô
 (1) ;

1328 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 
∑ss
,Öas†* 
DATA_LENGTH
,Öass * DATA_LENGTH) ;

1331 
	`sf_˛o£
 (
fûe
) ;

1334 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

1336 i‡(
sföfo
.
f‹m©
 != format)

1337 { 
	`¥ötf
 ("\n\nLöê%d : Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
f‹m©
, 
sföfo
.format) ;

1338 
	`exô
 (1) ;

1341 i‡(
sföfo
.
‰ames
 < 3 * 
DATA_LENGTH
)

1342 { 
	`¥ötf
 ("\n\nLöê%d : NŸÉnough føme†ö fûe. (%ld < %d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 3 * 
DATA_LENGTH
 ) ;

1343 
	`exô
 (1) ;

1346 i‡(! 
l⁄g_fûe_ok
 && 
sföfo
.
‰ames
 !3 * 
DATA_LENGTH
)

1347 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 3 * 
DATA_LENGTH
 ) ;

1348 
	`exô
 (1) ;

1351 i‡(
sföfo
.
ch™√ls
 != 1)

1352 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

1353 
	`exô
 (1) ;

1356 i‡(! 
l⁄g_fûe_ok
)

1357 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 0, 0, 3 * 
DATA_LENGTH
) ;

1359 
	`ã°_£ek_‹_dõ
 (
fûe
, 3 * 
DATA_LENGTH
, 
SFM_WRITE
 | 
SEEK_SET
, 3 * DATA_LENGTH, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1361 
∑ss
 = 1 ;Öass <= 3 ;Öass ++)

1362 { 
‹ig
 [20] = 
∑ss
 * 2 ;

1364 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 
∑ss
, (∑s†- 1Ë* 
DATA_LENGTH
, 3 * DATA_LENGTH) ;

1367 
	`ã°_ªad_sh‹t_‹_dõ
 (
fûe
, 
∑ss
, 
ã°
, 
DATA_LENGTH
, 
__LINE__
) ;

1370 
k
 = 0 ; k < 
DATA_LENGTH
 ; k++)

1371 i‡(
	`INT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

1372 { 
	`¥ötf
 ("\n\nLöê%d (∑s†%d): Eº‹áàßm∂ê%d (0x%X => 0x%X).\n", 
__LINE__
, 
∑ss
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

1373 
	`o˘_ßve_sh‹t
 (
‹ig
, 
ã°
, 
DATA_LENGTH
) ;

1374 
	`exô
 (1) ;

1379 
	`sf_˛o£
 (
fûe
) ;

1380 
	}
}

1383 
	$√w_rdwr_sh‹t_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
Ælow_fd
)

1384 { 
SNDFILE
 *
wfûe
, *
rwfûe
 ;

1385 
SF_INFO
 
sföfo
 ;

1386 *
‹ig
, *
ã°
 ;

1387 
ôems
, 
‰ames
 ;

1389 
‹ig
 = 
‹ig_d©a
.
s
 ;

1390 
ã°
 = 
ã°_d©a
.
s
 ;

1392 
sföfo
.
ßm∂î©e
 = 44100 ;

1393 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

1394 
sföfo
.
ch™√ls
 = 2 ;

1395 
sföfo
.
f‹m©
 = format ;

1397 
ôems
 = 
DATA_LENGTH
 ;

1398 
‰ames
 = 
ôems
 / 
sföfo
.
ch™√ls
 ;

1400 
wfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

1401 
	`sf_comm™d
 (
wfûe
, 
SFC_SET_UPDATE_HEADER_AUTO
, 
NULL
, 
SF_TRUE
) ;

1402 
	`ã°_wrôef_sh‹t_‹_dõ
 (
wfûe
, 1, 
‹ig
, 
‰ames
, 
__LINE__
) ;

1403 
	`sf_wrôe_sync
 (
wfûe
) ;

1404 
	`ã°_wrôef_sh‹t_‹_dõ
 (
wfûe
, 2, 
‹ig
, 
‰ames
, 
__LINE__
) ;

1405 
	`sf_wrôe_sync
 (
wfûe
) ;

1407 
rwfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

1408 i‡(
sföfo
.
‰ames
 != 2 * frames)

1409 { 
	`¥ötf
 ("\n\nLöê%d : inc‹ª˘Çumbî o‡‰ame†ö fûê(%ld shﬁd bê%d)\n\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), frames) ;

1410 
	`exô
 (1) ;

1413 
	`ã°_wrôef_sh‹t_‹_dõ
 (
wfûe
, 3, 
‹ig
, 
‰ames
, 
__LINE__
) ;

1415 
	`ã°_ªadf_sh‹t_‹_dõ
 (
rwfûe
, 1, 
ã°
, 
‰ames
, 
__LINE__
) ;

1416 
	`ã°_ªadf_sh‹t_‹_dõ
 (
rwfûe
, 2, 
ã°
, 
‰ames
, 
__LINE__
) ;

1418 
	`sf_˛o£
 (
wfûe
) ;

1419 
	`sf_˛o£
 (
rwfûe
) ;

1420 
	}
}

1426 
m⁄o_24bô_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

1427 
°îeo_24bô_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

1428 
m⁄o_rdwr_24bô_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

1429 
√w_rdwr_24bô_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
Ælow_fd
) ;

1432 
	$pcm_ã°_24bô
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
)

1433 { 
SF_INFO
 
sföfo
 ;

1434 *
‹ig
, *
ã°
 ;

1435 
k
, 
ôems
, 
Ælow_fd
 ;

1438 
Ælow_fd
 = ((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_SD2
Ë? 
SF_FALSE
 : 
SF_TRUE
 ;

1440 
	`¥öt_ã°_«me
 ("pcm_ã°_24bô", 
fûíame
) ;

1442 
sföfo
.
ßm∂î©e
 = 44100 ;

1443 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

1444 
sföfo
.
ch™√ls
 = 1 ;

1445 
sföfo
.
f‹m©
 = format ;

1447 
	`gí_wödowed_söe_doubÀ
 (
‹ig_d©a
.
d
, 
DATA_LENGTH
, (1.0 * 0x7F000000)) ;

1449 
‹ig
 = 
‹ig_d©a
.
i
 ;

1450 
ã°
 = 
ã°_d©a
.
i
 ;

1453 
	`CONVERT_DATA
 (
k
, 
DATA_LENGTH
, 
‹ig
, 
‹ig_d©a
.
d
) ;

1455 
ôems
 = 
DATA_LENGTH
 ;

1459 
	`m⁄o_24bô_ã°
 (
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

1462 i‡((
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_16
 ||

1463 (
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_24
)

1464 { 
	`u∆ök
 (
fûíame
) ;

1465 
	`¥ötf
 ("no seek : ok\n") ;

1469 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_FLAC
)

1470 
	`m⁄o_rdwr_24bô_ã°
 (
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

1473 
sföfo
.
ch™√ls
 = 2 ;

1474 i‡(
	`sf_f‹m©_check
 (&
sföfo
) == 0)

1475 { 
	`u∆ök
 (
fûíame
) ;

1476 
	`puts
 ("no stereo : ok") ;

1480 
	`°îeo_24bô_ã°
 (
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

1484 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_PAF
 &&

1485 (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_VOC
 &&

1486 (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_FLAC
)

1487 
	`√w_rdwr_24bô_ã°
 (
fûíame
, 
f‹m©
, 
Ælow_fd
) ;

1489 
	`dñëe_fûe
 (
f‹m©
, 
fûíame
) ;

1491 
	`puts
 ("ok") ;

1493 
	}
}

1496 
	$m⁄o_24bô_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
)

1497 { 
SNDFILE
 *
fûe
 ;

1498 
SF_INFO
 
sföfo
 ;

1499 *
‹ig
, *
ã°
 ;

1500 
sf_cou¡_t
 
cou¡
 ;

1501 
k
, 
ôems
 ;

1503 
sföfo
.
ßm∂î©e
 = 44100 ;

1504 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

1505 
sföfo
.
ch™√ls
 = 1 ;

1506 
sföfo
.
f‹m©
 = format ;

1508 
‹ig
 = 
‹ig_d©a
.
i
 ;

1509 
ã°
 = 
ã°_d©a
.
i
 ;

1511 
ôems
 = 
DATA_LENGTH
 ;

1513 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

1515 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_ARTIST
, "YourÇame here") ;

1517 
	`ã°_wrôe_öt_‹_dõ
 (
fûe
, 0, 
‹ig
, 
ôems
, 
__LINE__
) ;

1518 
	`sf_wrôe_sync
 (
fûe
) ;

1519 
	`ã°_wrôe_öt_‹_dõ
 (
fûe
, 0, 
‹ig
, 
ôems
, 
__LINE__
) ;

1520 
	`sf_wrôe_sync
 (
fûe
) ;

1523 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_COPYRIGHT
, "Copyright (c) 2003") ;

1525 
	`sf_˛o£
 (
fûe
) ;

1527 
	`mem£t
 (
ã°
, 0, 
ôems
 *  ()) ;

1529 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

1530 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

1532 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

1534 i‡(
sföfo
.
f‹m©
 != format)

1535 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
f‹m©
, 
sföfo
.format) ;

1536 
	`exô
 (1) ;

1539 i‡(
sföfo
.
‰ames
 < 2 * 
ôems
)

1540 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘Çumbî o‡‰ame†ö fûê—oÿsh‹t). (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
ôems
) ;

1541 
	`exô
 (1) ;

1544 i‡(! 
l⁄g_fûe_ok
 && 
sföfo
.
‰ames
 > 2 * 
ôems
)

1545 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘Çumbî o‡‰ame†ö fûê—oÿl⁄g). (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
ôems
) ;

1546 
	`exô
 (1) ;

1549 i‡(
sföfo
.
ch™√ls
 != 1)

1550 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

1551 
	`exô
 (1) ;

1554 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

1556 
	`ã°_ªad_öt_‹_dõ
 (
fûe
, 0, 
ã°
, 
ôems
, 
__LINE__
) ;

1557 
k
 = 0 ; k < 
ôems
 ; k++)

1558 i‡(
	`TRIBYTE_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

1559 { 
	`¥ötf
 ("\n\nLöê%d: M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

1560 
	`exô
 (1) ;

1564 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1566 
	`ã°_ªad_öt_‹_dõ
 (
fûe
, 0, 
ã°
, 4, 
__LINE__
) ;

1567 
k
 = 0 ; k < 4 ; k++)

1568 i‡(
	`TRIBYTE_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

1569 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

1570 
	`exô
 (1) ;

1573 i‡((
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_16
 ||

1574 (
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_24
)

1575 { 
	`sf_˛o£
 (
fûe
) ;

1576 
	`u∆ök
 (
fûíame
) ;

1577 
	`¥ötf
 ("no seek : ") ;

1582 
	`ã°_£ek_‹_dõ
 (
fûe
, 
ôems
 + 10, 
SEEK_SET
, iãm†+ 10, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1584 
	`ã°_ªad_öt_‹_dõ
 (
fûe
, 0, 
ã°
 + 10, 4, 
__LINE__
) ;

1585 
k
 = 10 ; k < 14 ; k++)

1586 i‡(
	`TRIBYTE_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

1587 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
ã°
 [k], 
‹ig
 [k]) ;

1588 
	`exô
 (1) ;

1592 
	`ã°_£ek_‹_dõ
 (
fûe
, 6, 
SEEK_CUR
, 
ôems
 + 20, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1594 
	`ã°_ªad_öt_‹_dõ
 (
fûe
, 0, 
ã°
 + 20, 4, 
__LINE__
) ;

1595 
k
 = 20 ; k < 24 ; k++)

1596 i‡(
	`TRIBYTE_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

1597 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
ã°
 [k], 
‹ig
 [k]) ;

1598 
	`exô
 (1) ;

1602 
	`ã°_£ek_‹_dõ
 (
fûe
, -1 * (
sföfo
.
‰ames
 - 10), 
SEEK_END
, 10, sföfo.
ch™√ls
, 
__LINE__
) ;

1604 
	`ã°_ªad_öt_‹_dõ
 (
fûe
, 0, 
ã°
 + 10, 4, 
__LINE__
) ;

1605 
k
 = 10 ; k < 14 ; k++)

1606 i‡(
	`TRIBYTE_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

1607 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êD (#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
ã°
 [k], 
‹ig
 [k]) ;

1608 
	`exô
 (1) ;

1612 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1614 
cou¡
 = 0 ;

1615 
cou¡
 < 
sföfo
.
‰ames
)

1616 
cou¡
 +
	`sf_ªad_öt
 (
fûe
, 
ã°
, 311) ;

1619 i‡(
	`sf_îr‹
 (
fûe
))

1620 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ:Éº‹ whîêthîêshouldn'àhavêbì¿⁄e.\n", 
__LINE__
) ;

1621 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

1622 
	`exô
 (1) ;

1626 i‡(
cou¡
 > 
sföfo
.
‰ames
)

1627 { 
	`¥ötf
 ("\n\nLöe†%d :ÑódÖa°Énd o‡fûê(%ld should bê%ld)\n", 
__LINE__
, (Ë
cou¡
, (Ë
sföfo
.
‰ames
) ;

1628 
	`exô
 (1) ;

1631 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_CUR
, 
sföfo
.
‰ames
, sföfo.
ch™√ls
, 
__LINE__
) ;

1633 
	`sf_˛o£
 (
fûe
) ;

1635 
	}
}

1638 
	$°îeo_24bô_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
)

1639 { 
SNDFILE
 *
fûe
 ;

1640 
SF_INFO
 
sföfo
 ;

1641 *
‹ig
, *
ã°
 ;

1642 
k
, 
ôems
, 
‰ames
 ;

1644 
sföfo
.
ßm∂î©e
 = 44100 ;

1645 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

1646 
sföfo
.
ch™√ls
 = 2 ;

1647 
sföfo
.
f‹m©
 = format ;

1649 
	`gí_wödowed_söe_doubÀ
 (
‹ig_d©a
.
d
, 
DATA_LENGTH
, (1.0 * 0x7F000000)) ;

1651 
‹ig
 = 
‹ig_d©a
.
i
 ;

1652 
ã°
 = 
ã°_d©a
.
i
 ;

1655 
	`CONVERT_DATA
 (
k
, 
DATA_LENGTH
, 
‹ig
, 
‹ig_d©a
.
d
) ;

1657 
ôems
 = 
DATA_LENGTH
 ;

1658 
‰ames
 = 
ôems
 / 
sföfo
.
ch™√ls
 ;

1660 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

1662 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_ARTIST
, "YourÇame here") ;

1664 
	`ã°_wrôef_öt_‹_dõ
 (
fûe
, 0, 
‹ig
, 
‰ames
, 
__LINE__
) ;

1666 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_COPYRIGHT
, "Copyright (c) 2003") ;

1668 
	`sf_˛o£
 (
fûe
) ;

1670 
	`mem£t
 (
ã°
, 0, 
ôems
 *  ()) ;

1672 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

1673 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

1675 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

1677 i‡(
sföfo
.
f‹m©
 != format)

1678 { 
	`¥ötf
 ("\n\nLine %d : Stereo : Returned format incorrect (0x%08X => 0x%08X).\n",

1679 
__LINE__
, 
f‹m©
, 
sföfo
.format) ;

1680 
	`exô
 (1) ;

1683 i‡(
sföfo
.
‰ames
 < frames)

1684 { 
	`¥ötf
 ("\n\nLine %d : Stereo : IncorrectÇumber of frames in file (too short). (%ld should be %d)\n",

1685 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), frames) ;

1686 
	`exô
 (1) ;

1689 i‡(! 
l⁄g_fûe_ok
 && 
sföfo
.
‰ames
 > frames)

1690 { 
	`¥ötf
 ("\n\nLine %d : Stereo : IncorrectÇumber of frames in file (tooÜong). (%ld should be %d)\n",

1691 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), frames) ;

1692 
	`exô
 (1) ;

1695 i‡(
sföfo
.
ch™√ls
 != 2)

1696 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

1697 
	`exô
 (1) ;

1700 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

1702 
	`ã°_ªadf_öt_‹_dõ
 (
fûe
, 0, 
ã°
, 
‰ames
, 
__LINE__
) ;

1703 
k
 = 0 ; k < 
ôems
 ; k++)

1704 i‡(
	`TRIBYTE_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

1705 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

1706 
	`exô
 (1) ;

1710 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1712 
	`ã°_ªadf_öt_‹_dõ
 (
fûe
, 0, 
ã°
, 2, 
__LINE__
) ;

1713 
k
 = 0 ; k < 4 ; k++)

1714 i‡(
	`TRIBYTE_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

1715 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

1716 
	`exô
 (1) ;

1720 
	`ã°_£ek_‹_dõ
 (
fûe
, 10, 
SEEK_SET
, 10, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1723 i‡(
	`sf_îr‹
 (
fûe
))

1724 { 
	`¥ötf
 ("Löê%d: Should NOTÑëu∫á¿îr‹.\n", 
__LINE__
) ;

1725 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

1726 
	`exô
 (1) ;

1729 i‡(
	`sf_ªad_öt
 (
fûe
, 
ã°
, 1) > 0)

1730 { 
	`¥ötf
 ("Löê%d: ShouldÑëu∫ 0.\n", 
__LINE__
) ;

1731 
	`exô
 (1) ;

1734 i‡(! 
	`sf_îr‹
 (
fûe
))

1735 { 
	`¥ötf
 ("Löê%d: ShouldÑëu∫á¿îr‹.\n", 
__LINE__
) ;

1736 
	`exô
 (1) ;

1740 
	`ã°_ªadf_öt_‹_dõ
 (
fûe
, 0, 
ã°
 + 10, 2, 
__LINE__
) ;

1741 
k
 = 20 ; k < 24 ; k++)

1742 i‡(
	`TRIBYTE_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

1743 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

1744 
	`exô
 (1) ;

1748 
	`ã°_£ek_‹_dõ
 (
fûe
, 8, 
SEEK_CUR
, 20, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1750 
	`ã°_ªadf_öt_‹_dõ
 (
fûe
, 0, 
ã°
 + 20, 2, 
__LINE__
) ;

1751 
k
 = 40 ; k < 44 ; k++)

1752 i‡(
	`TRIBYTE_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

1753 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

1754 
	`exô
 (1) ;

1758 
	`ã°_£ek_‹_dõ
 (
fûe
, -1 * (
sföfo
.
‰ames
 - 10), 
SEEK_END
, 10, sföfo.
ch™√ls
, 
__LINE__
) ;

1760 
	`ã°_ªadf_öt_‹_dõ
 (
fûe
, 0, 
ã°
 + 20, 2, 
__LINE__
) ;

1761 
k
 = 20 ; k < 24 ; k++)

1762 i‡(
	`TRIBYTE_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

1763 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

1764 
	`exô
 (1) ;

1767 
	`sf_˛o£
 (
fûe
) ;

1768 
	}
}

1771 
	$m⁄o_rdwr_24bô_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
)

1772 { 
SNDFILE
 *
fûe
 ;

1773 
SF_INFO
 
sföfo
 ;

1774 *
‹ig
, *
ã°
 ;

1775 
k
, 
∑ss
 ;

1777 
‹ig
 = 
‹ig_d©a
.
i
 ;

1778 
ã°
 = 
ã°_d©a
.
i
 ;

1780 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

1781 
sföfo
.
‰ames
 = 
DATA_LENGTH
 ;

1782 
sföfo
.
ch™√ls
 = 1 ;

1783 
sföfo
.
f‹m©
 = format ;

1785 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_RAW


1786 || (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_AU


1787 || (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_SD2
)

1788 
	`u∆ök
 (
fûíame
) ;

1791 
	`¸óã_sh‹t_fûe
 (
fûíame
) ;

1796 i‡((
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_RDWR
, &
sföfo
)))

1797 { 
	`¥ötf
 ("\n\nLöê%d: sf_›í should (SFM_RDWRËhavêÁûed buàdidn't.\n", 
__LINE__
) ;

1798 
	`exô
 (1) ;

1802 i‡(
	`åunˇã
 (
fûíame
, 0) < 0)

1803 { 
	`¥ötf
 ("\n\nLöê%d:Årunˇã (%sËÁûed", 
__LINE__
, 
fûíame
) ;

1804 
	`≥º‹
 (
NULL
) ;

1805 
	`exô
 (1) ;

1812 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

1813 
sföfo
.
‰ames
 = 
DATA_LENGTH
 ;

1814 
sföfo
.
ch™√ls
 = 1 ;

1815 
sföfo
.
f‹m©
 = format ;

1817 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

1822 
∑ss
 = 1 ;Öass <= 3 ;Öass ++)

1823 { 
‹ig
 [20] = 
∑ss
 * 2 ;

1826 
	`ã°_wrôe_öt_‹_dõ
 (
fûe
, 
∑ss
, 
‹ig
, 
DATA_LENGTH
, 
__LINE__
) ;

1828 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 
∑ss
, (∑s†- 1Ë* 
DATA_LENGTH
,Öass * DATA_LENGTH) ;

1831 
	`ã°_ªad_öt_‹_dõ
 (
fûe
, 0, 
ã°
, 
DATA_LENGTH
, 
__LINE__
) ;

1834 
k
 = 0 ; k < 
DATA_LENGTH
 ; k++)

1835 i‡(
	`TRIBYTE_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

1836 { 
	`¥ötf
 ("\n\nLöê%d (∑s†%d): Eº‹áàßm∂ê%d (0x%X => 0x%X).\n", 
__LINE__
, 
∑ss
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

1837 
	`o˘_ßve_öt
 (
‹ig
, 
ã°
, 
DATA_LENGTH
) ;

1838 
	`exô
 (1) ;

1841 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 
∑ss
,Öas†* 
DATA_LENGTH
,Öass * DATA_LENGTH) ;

1844 
	`sf_˛o£
 (
fûe
) ;

1847 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

1849 i‡(
sföfo
.
f‹m©
 != format)

1850 { 
	`¥ötf
 ("\n\nLöê%d : Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
f‹m©
, 
sföfo
.format) ;

1851 
	`exô
 (1) ;

1854 i‡(
sföfo
.
‰ames
 < 3 * 
DATA_LENGTH
)

1855 { 
	`¥ötf
 ("\n\nLöê%d : NŸÉnough føme†ö fûe. (%ld < %d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 3 * 
DATA_LENGTH
 ) ;

1856 
	`exô
 (1) ;

1859 i‡(! 
l⁄g_fûe_ok
 && 
sföfo
.
‰ames
 !3 * 
DATA_LENGTH
)

1860 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 3 * 
DATA_LENGTH
 ) ;

1861 
	`exô
 (1) ;

1864 i‡(
sföfo
.
ch™√ls
 != 1)

1865 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

1866 
	`exô
 (1) ;

1869 i‡(! 
l⁄g_fûe_ok
)

1870 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 0, 0, 3 * 
DATA_LENGTH
) ;

1872 
	`ã°_£ek_‹_dõ
 (
fûe
, 3 * 
DATA_LENGTH
, 
SFM_WRITE
 | 
SEEK_SET
, 3 * DATA_LENGTH, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

1874 
∑ss
 = 1 ;Öass <= 3 ;Öass ++)

1875 { 
‹ig
 [20] = 
∑ss
 * 2 ;

1877 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 
∑ss
, (∑s†- 1Ë* 
DATA_LENGTH
, 3 * DATA_LENGTH) ;

1880 
	`ã°_ªad_öt_‹_dõ
 (
fûe
, 
∑ss
, 
ã°
, 
DATA_LENGTH
, 
__LINE__
) ;

1883 
k
 = 0 ; k < 
DATA_LENGTH
 ; k++)

1884 i‡(
	`TRIBYTE_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

1885 { 
	`¥ötf
 ("\n\nLöê%d (∑s†%d): Eº‹áàßm∂ê%d (0x%X => 0x%X).\n", 
__LINE__
, 
∑ss
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

1886 
	`o˘_ßve_öt
 (
‹ig
, 
ã°
, 
DATA_LENGTH
) ;

1887 
	`exô
 (1) ;

1892 
	`sf_˛o£
 (
fûe
) ;

1893 
	}
}

1896 
	$√w_rdwr_24bô_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
Ælow_fd
)

1897 { 
SNDFILE
 *
wfûe
, *
rwfûe
 ;

1898 
SF_INFO
 
sföfo
 ;

1899 *
‹ig
, *
ã°
 ;

1900 
ôems
, 
‰ames
 ;

1902 
‹ig
 = 
‹ig_d©a
.
i
 ;

1903 
ã°
 = 
ã°_d©a
.
i
 ;

1905 
sföfo
.
ßm∂î©e
 = 44100 ;

1906 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

1907 
sföfo
.
ch™√ls
 = 2 ;

1908 
sföfo
.
f‹m©
 = format ;

1910 
ôems
 = 
DATA_LENGTH
 ;

1911 
‰ames
 = 
ôems
 / 
sföfo
.
ch™√ls
 ;

1913 
wfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

1914 
	`sf_comm™d
 (
wfûe
, 
SFC_SET_UPDATE_HEADER_AUTO
, 
NULL
, 
SF_TRUE
) ;

1915 
	`ã°_wrôef_öt_‹_dõ
 (
wfûe
, 1, 
‹ig
, 
‰ames
, 
__LINE__
) ;

1916 
	`sf_wrôe_sync
 (
wfûe
) ;

1917 
	`ã°_wrôef_öt_‹_dõ
 (
wfûe
, 2, 
‹ig
, 
‰ames
, 
__LINE__
) ;

1918 
	`sf_wrôe_sync
 (
wfûe
) ;

1920 
rwfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

1921 i‡(
sföfo
.
‰ames
 != 2 * frames)

1922 { 
	`¥ötf
 ("\n\nLöê%d : inc‹ª˘Çumbî o‡‰ame†ö fûê(%ld shﬁd bê%d)\n\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), frames) ;

1923 
	`exô
 (1) ;

1926 
	`ã°_wrôef_öt_‹_dõ
 (
wfûe
, 3, 
‹ig
, 
‰ames
, 
__LINE__
) ;

1928 
	`ã°_ªadf_öt_‹_dõ
 (
rwfûe
, 1, 
ã°
, 
‰ames
, 
__LINE__
) ;

1929 
	`ã°_ªadf_öt_‹_dõ
 (
rwfûe
, 2, 
ã°
, 
‰ames
, 
__LINE__
) ;

1931 
	`sf_˛o£
 (
wfûe
) ;

1932 
	`sf_˛o£
 (
rwfûe
) ;

1933 
	}
}

1939 
m⁄o_öt_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

1940 
°îeo_öt_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

1941 
m⁄o_rdwr_öt_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

1942 
√w_rdwr_öt_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
Ælow_fd
) ;

1945 
	$pcm_ã°_öt
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
)

1946 { 
SF_INFO
 
sföfo
 ;

1947 *
‹ig
, *
ã°
 ;

1948 
k
, 
ôems
, 
Ælow_fd
 ;

1951 
Ælow_fd
 = ((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_SD2
Ë? 
SF_FALSE
 : 
SF_TRUE
 ;

1953 
	`¥öt_ã°_«me
 ("pcm_ã°_öt", 
fûíame
) ;

1955 
sföfo
.
ßm∂î©e
 = 44100 ;

1956 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

1957 
sföfo
.
ch™√ls
 = 1 ;

1958 
sföfo
.
f‹m©
 = format ;

1960 
	`gí_wödowed_söe_doubÀ
 (
‹ig_d©a
.
d
, 
DATA_LENGTH
, (1.0 * 0x7F000000)) ;

1962 
‹ig
 = 
‹ig_d©a
.
i
 ;

1963 
ã°
 = 
ã°_d©a
.
i
 ;

1966 
	`CONVERT_DATA
 (
k
, 
DATA_LENGTH
, 
‹ig
, 
‹ig_d©a
.
d
) ;

1968 
ôems
 = 
DATA_LENGTH
 ;

1972 
	`m⁄o_öt_ã°
 (
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

1975 i‡((
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_16
 ||

1976 (
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_24
)

1977 { 
	`u∆ök
 (
fûíame
) ;

1978 
	`¥ötf
 ("no seek : ok\n") ;

1982 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_FLAC
)

1983 
	`m⁄o_rdwr_öt_ã°
 (
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

1986 
sföfo
.
ch™√ls
 = 2 ;

1987 i‡(
	`sf_f‹m©_check
 (&
sföfo
) == 0)

1988 { 
	`u∆ök
 (
fûíame
) ;

1989 
	`puts
 ("no stereo : ok") ;

1993 
	`°îeo_öt_ã°
 (
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

1997 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_PAF
 &&

1998 (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_VOC
 &&

1999 (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_FLAC
)

2000 
	`√w_rdwr_öt_ã°
 (
fûíame
, 
f‹m©
, 
Ælow_fd
) ;

2002 
	`dñëe_fûe
 (
f‹m©
, 
fûíame
) ;

2004 
	`puts
 ("ok") ;

2006 
	}
}

2009 
	$m⁄o_öt_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
)

2010 { 
SNDFILE
 *
fûe
 ;

2011 
SF_INFO
 
sföfo
 ;

2012 *
‹ig
, *
ã°
 ;

2013 
sf_cou¡_t
 
cou¡
 ;

2014 
k
, 
ôems
 ;

2016 
sföfo
.
ßm∂î©e
 = 44100 ;

2017 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

2018 
sföfo
.
ch™√ls
 = 1 ;

2019 
sföfo
.
f‹m©
 = format ;

2021 
‹ig
 = 
‹ig_d©a
.
i
 ;

2022 
ã°
 = 
ã°_d©a
.
i
 ;

2024 
ôems
 = 
DATA_LENGTH
 ;

2026 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

2028 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_ARTIST
, "YourÇame here") ;

2030 
	`ã°_wrôe_öt_‹_dõ
 (
fûe
, 0, 
‹ig
, 
ôems
, 
__LINE__
) ;

2031 
	`sf_wrôe_sync
 (
fûe
) ;

2032 
	`ã°_wrôe_öt_‹_dõ
 (
fûe
, 0, 
‹ig
, 
ôems
, 
__LINE__
) ;

2033 
	`sf_wrôe_sync
 (
fûe
) ;

2036 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_COPYRIGHT
, "Copyright (c) 2003") ;

2038 
	`sf_˛o£
 (
fûe
) ;

2040 
	`mem£t
 (
ã°
, 0, 
ôems
 *  ()) ;

2042 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

2043 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

2045 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

2047 i‡(
sföfo
.
f‹m©
 != format)

2048 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
f‹m©
, 
sföfo
.format) ;

2049 
	`exô
 (1) ;

2052 i‡(
sföfo
.
‰ames
 < 2 * 
ôems
)

2053 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘Çumbî o‡‰ame†ö fûê—oÿsh‹t). (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
ôems
) ;

2054 
	`exô
 (1) ;

2057 i‡(! 
l⁄g_fûe_ok
 && 
sföfo
.
‰ames
 > 2 * 
ôems
)

2058 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘Çumbî o‡‰ame†ö fûê—oÿl⁄g). (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
ôems
) ;

2059 
	`exô
 (1) ;

2062 i‡(
sföfo
.
ch™√ls
 != 1)

2063 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

2064 
	`exô
 (1) ;

2067 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

2069 
	`ã°_ªad_öt_‹_dõ
 (
fûe
, 0, 
ã°
, 
ôems
, 
__LINE__
) ;

2070 
k
 = 0 ; k < 
ôems
 ; k++)

2071 i‡(
	`INT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

2072 { 
	`¥ötf
 ("\n\nLöê%d: M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

2073 
	`exô
 (1) ;

2077 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

2079 
	`ã°_ªad_öt_‹_dõ
 (
fûe
, 0, 
ã°
, 4, 
__LINE__
) ;

2080 
k
 = 0 ; k < 4 ; k++)

2081 i‡(
	`INT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

2082 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

2083 
	`exô
 (1) ;

2086 i‡((
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_16
 ||

2087 (
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_24
)

2088 { 
	`sf_˛o£
 (
fûe
) ;

2089 
	`u∆ök
 (
fûíame
) ;

2090 
	`¥ötf
 ("no seek : ") ;

2095 
	`ã°_£ek_‹_dõ
 (
fûe
, 
ôems
 + 10, 
SEEK_SET
, iãm†+ 10, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

2097 
	`ã°_ªad_öt_‹_dõ
 (
fûe
, 0, 
ã°
 + 10, 4, 
__LINE__
) ;

2098 
k
 = 10 ; k < 14 ; k++)

2099 i‡(
	`INT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

2100 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
ã°
 [k], 
‹ig
 [k]) ;

2101 
	`exô
 (1) ;

2105 
	`ã°_£ek_‹_dõ
 (
fûe
, 6, 
SEEK_CUR
, 
ôems
 + 20, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

2107 
	`ã°_ªad_öt_‹_dõ
 (
fûe
, 0, 
ã°
 + 20, 4, 
__LINE__
) ;

2108 
k
 = 20 ; k < 24 ; k++)

2109 i‡(
	`INT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

2110 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
ã°
 [k], 
‹ig
 [k]) ;

2111 
	`exô
 (1) ;

2115 
	`ã°_£ek_‹_dõ
 (
fûe
, -1 * (
sföfo
.
‰ames
 - 10), 
SEEK_END
, 10, sföfo.
ch™√ls
, 
__LINE__
) ;

2117 
	`ã°_ªad_öt_‹_dõ
 (
fûe
, 0, 
ã°
 + 10, 4, 
__LINE__
) ;

2118 
k
 = 10 ; k < 14 ; k++)

2119 i‡(
	`INT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

2120 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êD (#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
ã°
 [k], 
‹ig
 [k]) ;

2121 
	`exô
 (1) ;

2125 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

2127 
cou¡
 = 0 ;

2128 
cou¡
 < 
sföfo
.
‰ames
)

2129 
cou¡
 +
	`sf_ªad_öt
 (
fûe
, 
ã°
, 311) ;

2132 i‡(
	`sf_îr‹
 (
fûe
))

2133 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ:Éº‹ whîêthîêshouldn'àhavêbì¿⁄e.\n", 
__LINE__
) ;

2134 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

2135 
	`exô
 (1) ;

2139 i‡(
cou¡
 > 
sföfo
.
‰ames
)

2140 { 
	`¥ötf
 ("\n\nLöe†%d :ÑódÖa°Énd o‡fûê(%ld should bê%ld)\n", 
__LINE__
, (Ë
cou¡
, (Ë
sföfo
.
‰ames
) ;

2141 
	`exô
 (1) ;

2144 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_CUR
, 
sföfo
.
‰ames
, sföfo.
ch™√ls
, 
__LINE__
) ;

2146 
	`sf_˛o£
 (
fûe
) ;

2148 
	}
}

2151 
	$°îeo_öt_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
)

2152 { 
SNDFILE
 *
fûe
 ;

2153 
SF_INFO
 
sföfo
 ;

2154 *
‹ig
, *
ã°
 ;

2155 
k
, 
ôems
, 
‰ames
 ;

2157 
sföfo
.
ßm∂î©e
 = 44100 ;

2158 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

2159 
sföfo
.
ch™√ls
 = 2 ;

2160 
sföfo
.
f‹m©
 = format ;

2162 
	`gí_wödowed_söe_doubÀ
 (
‹ig_d©a
.
d
, 
DATA_LENGTH
, (1.0 * 0x7F000000)) ;

2164 
‹ig
 = 
‹ig_d©a
.
i
 ;

2165 
ã°
 = 
ã°_d©a
.
i
 ;

2168 
	`CONVERT_DATA
 (
k
, 
DATA_LENGTH
, 
‹ig
, 
‹ig_d©a
.
d
) ;

2170 
ôems
 = 
DATA_LENGTH
 ;

2171 
‰ames
 = 
ôems
 / 
sföfo
.
ch™√ls
 ;

2173 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

2175 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_ARTIST
, "YourÇame here") ;

2177 
	`ã°_wrôef_öt_‹_dõ
 (
fûe
, 0, 
‹ig
, 
‰ames
, 
__LINE__
) ;

2179 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_COPYRIGHT
, "Copyright (c) 2003") ;

2181 
	`sf_˛o£
 (
fûe
) ;

2183 
	`mem£t
 (
ã°
, 0, 
ôems
 *  ()) ;

2185 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

2186 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

2188 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

2190 i‡(
sföfo
.
f‹m©
 != format)

2191 { 
	`¥ötf
 ("\n\nLine %d : Stereo : Returned format incorrect (0x%08X => 0x%08X).\n",

2192 
__LINE__
, 
f‹m©
, 
sföfo
.format) ;

2193 
	`exô
 (1) ;

2196 i‡(
sföfo
.
‰ames
 < frames)

2197 { 
	`¥ötf
 ("\n\nLine %d : Stereo : IncorrectÇumber of frames in file (too short). (%ld should be %d)\n",

2198 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), frames) ;

2199 
	`exô
 (1) ;

2202 i‡(! 
l⁄g_fûe_ok
 && 
sföfo
.
‰ames
 > frames)

2203 { 
	`¥ötf
 ("\n\nLine %d : Stereo : IncorrectÇumber of frames in file (tooÜong). (%ld should be %d)\n",

2204 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), frames) ;

2205 
	`exô
 (1) ;

2208 i‡(
sföfo
.
ch™√ls
 != 2)

2209 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

2210 
	`exô
 (1) ;

2213 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

2215 
	`ã°_ªadf_öt_‹_dõ
 (
fûe
, 0, 
ã°
, 
‰ames
, 
__LINE__
) ;

2216 
k
 = 0 ; k < 
ôems
 ; k++)

2217 i‡(
	`INT_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

2218 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

2219 
	`exô
 (1) ;

2223 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

2225 
	`ã°_ªadf_öt_‹_dõ
 (
fûe
, 0, 
ã°
, 2, 
__LINE__
) ;

2226 
k
 = 0 ; k < 4 ; k++)

2227 i‡(
	`INT_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

2228 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

2229 
	`exô
 (1) ;

2233 
	`ã°_£ek_‹_dõ
 (
fûe
, 10, 
SEEK_SET
, 10, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

2236 i‡(
	`sf_îr‹
 (
fûe
))

2237 { 
	`¥ötf
 ("Löê%d: Should NOTÑëu∫á¿îr‹.\n", 
__LINE__
) ;

2238 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

2239 
	`exô
 (1) ;

2242 i‡(
	`sf_ªad_öt
 (
fûe
, 
ã°
, 1) > 0)

2243 { 
	`¥ötf
 ("Löê%d: ShouldÑëu∫ 0.\n", 
__LINE__
) ;

2244 
	`exô
 (1) ;

2247 i‡(! 
	`sf_îr‹
 (
fûe
))

2248 { 
	`¥ötf
 ("Löê%d: ShouldÑëu∫á¿îr‹.\n", 
__LINE__
) ;

2249 
	`exô
 (1) ;

2253 
	`ã°_ªadf_öt_‹_dõ
 (
fûe
, 0, 
ã°
 + 10, 2, 
__LINE__
) ;

2254 
k
 = 20 ; k < 24 ; k++)

2255 i‡(
	`INT_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

2256 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

2257 
	`exô
 (1) ;

2261 
	`ã°_£ek_‹_dõ
 (
fûe
, 8, 
SEEK_CUR
, 20, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

2263 
	`ã°_ªadf_öt_‹_dõ
 (
fûe
, 0, 
ã°
 + 20, 2, 
__LINE__
) ;

2264 
k
 = 40 ; k < 44 ; k++)

2265 i‡(
	`INT_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

2266 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

2267 
	`exô
 (1) ;

2271 
	`ã°_£ek_‹_dõ
 (
fûe
, -1 * (
sföfo
.
‰ames
 - 10), 
SEEK_END
, 10, sföfo.
ch™√ls
, 
__LINE__
) ;

2273 
	`ã°_ªadf_öt_‹_dõ
 (
fûe
, 0, 
ã°
 + 20, 2, 
__LINE__
) ;

2274 
k
 = 20 ; k < 24 ; k++)

2275 i‡(
	`INT_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

2276 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : 0x%X => 0x%X).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

2277 
	`exô
 (1) ;

2280 
	`sf_˛o£
 (
fûe
) ;

2281 
	}
}

2284 
	$m⁄o_rdwr_öt_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
)

2285 { 
SNDFILE
 *
fûe
 ;

2286 
SF_INFO
 
sföfo
 ;

2287 *
‹ig
, *
ã°
 ;

2288 
k
, 
∑ss
 ;

2290 
‹ig
 = 
‹ig_d©a
.
i
 ;

2291 
ã°
 = 
ã°_d©a
.
i
 ;

2293 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

2294 
sföfo
.
‰ames
 = 
DATA_LENGTH
 ;

2295 
sföfo
.
ch™√ls
 = 1 ;

2296 
sföfo
.
f‹m©
 = format ;

2298 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_RAW


2299 || (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_AU


2300 || (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_SD2
)

2301 
	`u∆ök
 (
fûíame
) ;

2304 
	`¸óã_sh‹t_fûe
 (
fûíame
) ;

2309 i‡((
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_RDWR
, &
sföfo
)))

2310 { 
	`¥ötf
 ("\n\nLöê%d: sf_›í should (SFM_RDWRËhavêÁûed buàdidn't.\n", 
__LINE__
) ;

2311 
	`exô
 (1) ;

2315 i‡(
	`åunˇã
 (
fûíame
, 0) < 0)

2316 { 
	`¥ötf
 ("\n\nLöê%d:Årunˇã (%sËÁûed", 
__LINE__
, 
fûíame
) ;

2317 
	`≥º‹
 (
NULL
) ;

2318 
	`exô
 (1) ;

2325 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

2326 
sföfo
.
‰ames
 = 
DATA_LENGTH
 ;

2327 
sföfo
.
ch™√ls
 = 1 ;

2328 
sföfo
.
f‹m©
 = format ;

2330 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

2335 
∑ss
 = 1 ;Öass <= 3 ;Öass ++)

2336 { 
‹ig
 [20] = 
∑ss
 * 2 ;

2339 
	`ã°_wrôe_öt_‹_dõ
 (
fûe
, 
∑ss
, 
‹ig
, 
DATA_LENGTH
, 
__LINE__
) ;

2341 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 
∑ss
, (∑s†- 1Ë* 
DATA_LENGTH
,Öass * DATA_LENGTH) ;

2344 
	`ã°_ªad_öt_‹_dõ
 (
fûe
, 0, 
ã°
, 
DATA_LENGTH
, 
__LINE__
) ;

2347 
k
 = 0 ; k < 
DATA_LENGTH
 ; k++)

2348 i‡(
	`INT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

2349 { 
	`¥ötf
 ("\n\nLöê%d (∑s†%d): Eº‹áàßm∂ê%d (0x%X => 0x%X).\n", 
__LINE__
, 
∑ss
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

2350 
	`o˘_ßve_öt
 (
‹ig
, 
ã°
, 
DATA_LENGTH
) ;

2351 
	`exô
 (1) ;

2354 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 
∑ss
,Öas†* 
DATA_LENGTH
,Öass * DATA_LENGTH) ;

2357 
	`sf_˛o£
 (
fûe
) ;

2360 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

2362 i‡(
sföfo
.
f‹m©
 != format)

2363 { 
	`¥ötf
 ("\n\nLöê%d : Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
f‹m©
, 
sföfo
.format) ;

2364 
	`exô
 (1) ;

2367 i‡(
sföfo
.
‰ames
 < 3 * 
DATA_LENGTH
)

2368 { 
	`¥ötf
 ("\n\nLöê%d : NŸÉnough føme†ö fûe. (%ld < %d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 3 * 
DATA_LENGTH
 ) ;

2369 
	`exô
 (1) ;

2372 i‡(! 
l⁄g_fûe_ok
 && 
sföfo
.
‰ames
 !3 * 
DATA_LENGTH
)

2373 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 3 * 
DATA_LENGTH
 ) ;

2374 
	`exô
 (1) ;

2377 i‡(
sföfo
.
ch™√ls
 != 1)

2378 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

2379 
	`exô
 (1) ;

2382 i‡(! 
l⁄g_fûe_ok
)

2383 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 0, 0, 3 * 
DATA_LENGTH
) ;

2385 
	`ã°_£ek_‹_dõ
 (
fûe
, 3 * 
DATA_LENGTH
, 
SFM_WRITE
 | 
SEEK_SET
, 3 * DATA_LENGTH, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

2387 
∑ss
 = 1 ;Öass <= 3 ;Öass ++)

2388 { 
‹ig
 [20] = 
∑ss
 * 2 ;

2390 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 
∑ss
, (∑s†- 1Ë* 
DATA_LENGTH
, 3 * DATA_LENGTH) ;

2393 
	`ã°_ªad_öt_‹_dõ
 (
fûe
, 
∑ss
, 
ã°
, 
DATA_LENGTH
, 
__LINE__
) ;

2396 
k
 = 0 ; k < 
DATA_LENGTH
 ; k++)

2397 i‡(
	`INT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

2398 { 
	`¥ötf
 ("\n\nLöê%d (∑s†%d): Eº‹áàßm∂ê%d (0x%X => 0x%X).\n", 
__LINE__
, 
∑ss
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

2399 
	`o˘_ßve_öt
 (
‹ig
, 
ã°
, 
DATA_LENGTH
) ;

2400 
	`exô
 (1) ;

2405 
	`sf_˛o£
 (
fûe
) ;

2406 
	}
}

2409 
	$√w_rdwr_öt_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
Ælow_fd
)

2410 { 
SNDFILE
 *
wfûe
, *
rwfûe
 ;

2411 
SF_INFO
 
sföfo
 ;

2412 *
‹ig
, *
ã°
 ;

2413 
ôems
, 
‰ames
 ;

2415 
‹ig
 = 
‹ig_d©a
.
i
 ;

2416 
ã°
 = 
ã°_d©a
.
i
 ;

2418 
sföfo
.
ßm∂î©e
 = 44100 ;

2419 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

2420 
sföfo
.
ch™√ls
 = 2 ;

2421 
sföfo
.
f‹m©
 = format ;

2423 
ôems
 = 
DATA_LENGTH
 ;

2424 
‰ames
 = 
ôems
 / 
sföfo
.
ch™√ls
 ;

2426 
wfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

2427 
	`sf_comm™d
 (
wfûe
, 
SFC_SET_UPDATE_HEADER_AUTO
, 
NULL
, 
SF_TRUE
) ;

2428 
	`ã°_wrôef_öt_‹_dõ
 (
wfûe
, 1, 
‹ig
, 
‰ames
, 
__LINE__
) ;

2429 
	`sf_wrôe_sync
 (
wfûe
) ;

2430 
	`ã°_wrôef_öt_‹_dõ
 (
wfûe
, 2, 
‹ig
, 
‰ames
, 
__LINE__
) ;

2431 
	`sf_wrôe_sync
 (
wfûe
) ;

2433 
rwfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

2434 i‡(
sföfo
.
‰ames
 != 2 * frames)

2435 { 
	`¥ötf
 ("\n\nLöê%d : inc‹ª˘Çumbî o‡‰ame†ö fûê(%ld shﬁd bê%d)\n\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), frames) ;

2436 
	`exô
 (1) ;

2439 
	`ã°_wrôef_öt_‹_dõ
 (
wfûe
, 3, 
‹ig
, 
‰ames
, 
__LINE__
) ;

2441 
	`ã°_ªadf_öt_‹_dõ
 (
rwfûe
, 1, 
ã°
, 
‰ames
, 
__LINE__
) ;

2442 
	`ã°_ªadf_öt_‹_dõ
 (
rwfûe
, 2, 
ã°
, 
‰ames
, 
__LINE__
) ;

2444 
	`sf_˛o£
 (
wfûe
) ;

2445 
	`sf_˛o£
 (
rwfûe
) ;

2446 
	}
}

2452 
m⁄o_Êﬂt_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

2453 
°îeo_Êﬂt_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

2454 
m⁄o_rdwr_Êﬂt_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

2455 
√w_rdwr_Êﬂt_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
Ælow_fd
) ;

2458 
	$pcm_ã°_Êﬂt
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
)

2459 { 
SF_INFO
 
sföfo
 ;

2460 *
‹ig
, *
ã°
 ;

2461 
k
, 
ôems
, 
Ælow_fd
 ;

2464 
Ælow_fd
 = ((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_SD2
Ë? 
SF_FALSE
 : 
SF_TRUE
 ;

2466 
	`¥öt_ã°_«me
 ("pcm_ã°_Êﬂt", 
fûíame
) ;

2468 
sföfo
.
ßm∂î©e
 = 44100 ;

2469 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

2470 
sföfo
.
ch™√ls
 = 1 ;

2471 
sföfo
.
f‹m©
 = format ;

2473 
	`gí_wödowed_söe_doubÀ
 (
‹ig_d©a
.
d
, 
DATA_LENGTH
, 1.0) ;

2475 
‹ig
 = 
‹ig_d©a
.
f
 ;

2476 
ã°
 = 
ã°_d©a
.
f
 ;

2479 
	`CONVERT_DATA
 (
k
, 
DATA_LENGTH
, 
‹ig
, 
‹ig_d©a
.
d
) ;

2481 
ôems
 = 
DATA_LENGTH
 ;

2485 
	`m⁄o_Êﬂt_ã°
 (
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

2488 i‡((
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_16
 ||

2489 (
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_24
)

2490 { 
	`u∆ök
 (
fûíame
) ;

2491 
	`¥ötf
 ("no seek : ok\n") ;

2495 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_FLAC
)

2496 
	`m⁄o_rdwr_Êﬂt_ã°
 (
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

2499 
sföfo
.
ch™√ls
 = 2 ;

2500 i‡(
	`sf_f‹m©_check
 (&
sföfo
) == 0)

2501 { 
	`u∆ök
 (
fûíame
) ;

2502 
	`puts
 ("no stereo : ok") ;

2506 
	`°îeo_Êﬂt_ã°
 (
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

2510 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_PAF
 &&

2511 (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_VOC
 &&

2512 (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_FLAC
)

2513 
	`√w_rdwr_Êﬂt_ã°
 (
fûíame
, 
f‹m©
, 
Ælow_fd
) ;

2515 
	`dñëe_fûe
 (
f‹m©
, 
fûíame
) ;

2517 
	`puts
 ("ok") ;

2519 
	}
}

2522 
	$m⁄o_Êﬂt_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
)

2523 { 
SNDFILE
 *
fûe
 ;

2524 
SF_INFO
 
sföfo
 ;

2525 *
‹ig
, *
ã°
 ;

2526 
sf_cou¡_t
 
cou¡
 ;

2527 
k
, 
ôems
 ;

2529 
sföfo
.
ßm∂î©e
 = 44100 ;

2530 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

2531 
sföfo
.
ch™√ls
 = 1 ;

2532 
sföfo
.
f‹m©
 = format ;

2534 
‹ig
 = 
‹ig_d©a
.
f
 ;

2535 
ã°
 = 
ã°_d©a
.
f
 ;

2537 
ôems
 = 
DATA_LENGTH
 ;

2539 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

2541 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_ARTIST
, "YourÇame here") ;

2543 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
fûe
, 0, 
‹ig
, 
ôems
, 
__LINE__
) ;

2544 
	`sf_wrôe_sync
 (
fûe
) ;

2545 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
fûe
, 0, 
‹ig
, 
ôems
, 
__LINE__
) ;

2546 
	`sf_wrôe_sync
 (
fûe
) ;

2549 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_COPYRIGHT
, "Copyright (c) 2003") ;

2551 
	`sf_˛o£
 (
fûe
) ;

2553 
	`mem£t
 (
ã°
, 0, 
ôems
 *  ()) ;

2555 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

2556 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

2558 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

2560 i‡(
sföfo
.
f‹m©
 != format)

2561 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
f‹m©
, 
sföfo
.format) ;

2562 
	`exô
 (1) ;

2565 i‡(
sföfo
.
‰ames
 < 2 * 
ôems
)

2566 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘Çumbî o‡‰ame†ö fûê—oÿsh‹t). (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
ôems
) ;

2567 
	`exô
 (1) ;

2570 i‡(! 
l⁄g_fûe_ok
 && 
sföfo
.
‰ames
 > 2 * 
ôems
)

2571 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘Çumbî o‡‰ame†ö fûê—oÿl⁄g). (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
ôems
) ;

2572 
	`exô
 (1) ;

2575 i‡(
sföfo
.
ch™√ls
 != 1)

2576 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

2577 
	`exô
 (1) ;

2580 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

2582 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
ã°
, 
ôems
, 
__LINE__
) ;

2583 
k
 = 0 ; k < 
ôems
 ; k++)

2584 i‡(
	`FLOAT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

2585 { 
	`¥ötf
 ("\n\nLöê%d: M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : %g => %g).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

2586 
	`exô
 (1) ;

2590 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

2592 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
ã°
, 4, 
__LINE__
) ;

2593 
k
 = 0 ; k < 4 ; k++)

2594 i‡(
	`FLOAT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

2595 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : %g => %g).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

2596 
	`exô
 (1) ;

2599 i‡((
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_16
 ||

2600 (
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_24
)

2601 { 
	`sf_˛o£
 (
fûe
) ;

2602 
	`u∆ök
 (
fûíame
) ;

2603 
	`¥ötf
 ("no seek : ") ;

2608 
	`ã°_£ek_‹_dõ
 (
fûe
, 
ôems
 + 10, 
SEEK_SET
, iãm†+ 10, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

2610 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
ã°
 + 10, 4, 
__LINE__
) ;

2611 
k
 = 10 ; k < 14 ; k++)

2612 i‡(
	`FLOAT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

2613 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : %g => %g).\n", 
__LINE__
, 
k
, 
ã°
 [k], 
‹ig
 [k]) ;

2614 
	`exô
 (1) ;

2618 
	`ã°_£ek_‹_dõ
 (
fûe
, 6, 
SEEK_CUR
, 
ôems
 + 20, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

2620 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
ã°
 + 20, 4, 
__LINE__
) ;

2621 
k
 = 20 ; k < 24 ; k++)

2622 i‡(
	`FLOAT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

2623 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : %g => %g).\n", 
__LINE__
, 
k
, 
ã°
 [k], 
‹ig
 [k]) ;

2624 
	`exô
 (1) ;

2628 
	`ã°_£ek_‹_dõ
 (
fûe
, -1 * (
sföfo
.
‰ames
 - 10), 
SEEK_END
, 10, sföfo.
ch™√ls
, 
__LINE__
) ;

2630 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
ã°
 + 10, 4, 
__LINE__
) ;

2631 
k
 = 10 ; k < 14 ; k++)

2632 i‡(
	`FLOAT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

2633 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êD (#%d : %g => %g).\n", 
__LINE__
, 
k
, 
ã°
 [k], 
‹ig
 [k]) ;

2634 
	`exô
 (1) ;

2638 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

2640 
cou¡
 = 0 ;

2641 
cou¡
 < 
sföfo
.
‰ames
)

2642 
cou¡
 +
	`sf_ªad_Êﬂt
 (
fûe
, 
ã°
, 311) ;

2645 i‡(
	`sf_îr‹
 (
fûe
))

2646 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ:Éº‹ whîêthîêshouldn'àhavêbì¿⁄e.\n", 
__LINE__
) ;

2647 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

2648 
	`exô
 (1) ;

2652 i‡(
cou¡
 > 
sföfo
.
‰ames
)

2653 { 
	`¥ötf
 ("\n\nLöe†%d :ÑódÖa°Énd o‡fûê(%ld should bê%ld)\n", 
__LINE__
, (Ë
cou¡
, (Ë
sföfo
.
‰ames
) ;

2654 
	`exô
 (1) ;

2657 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_CUR
, 
sföfo
.
‰ames
, sföfo.
ch™√ls
, 
__LINE__
) ;

2659 
	`sf_˛o£
 (
fûe
) ;

2661 
	}
}

2664 
	$°îeo_Êﬂt_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
)

2665 { 
SNDFILE
 *
fûe
 ;

2666 
SF_INFO
 
sföfo
 ;

2667 *
‹ig
, *
ã°
 ;

2668 
k
, 
ôems
, 
‰ames
 ;

2670 
sföfo
.
ßm∂î©e
 = 44100 ;

2671 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

2672 
sföfo
.
ch™√ls
 = 2 ;

2673 
sföfo
.
f‹m©
 = format ;

2675 
	`gí_wödowed_söe_doubÀ
 (
‹ig_d©a
.
d
, 
DATA_LENGTH
, 1.0) ;

2677 
‹ig
 = 
‹ig_d©a
.
f
 ;

2678 
ã°
 = 
ã°_d©a
.
f
 ;

2681 
	`CONVERT_DATA
 (
k
, 
DATA_LENGTH
, 
‹ig
, 
‹ig_d©a
.
d
) ;

2683 
ôems
 = 
DATA_LENGTH
 ;

2684 
‰ames
 = 
ôems
 / 
sföfo
.
ch™√ls
 ;

2686 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

2688 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_ARTIST
, "YourÇame here") ;

2690 
	`ã°_wrôef_Êﬂt_‹_dõ
 (
fûe
, 0, 
‹ig
, 
‰ames
, 
__LINE__
) ;

2692 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_COPYRIGHT
, "Copyright (c) 2003") ;

2694 
	`sf_˛o£
 (
fûe
) ;

2696 
	`mem£t
 (
ã°
, 0, 
ôems
 *  ()) ;

2698 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

2699 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

2701 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

2703 i‡(
sföfo
.
f‹m©
 != format)

2704 { 
	`¥ötf
 ("\n\nLine %d : Stereo : Returned format incorrect (0x%08X => 0x%08X).\n",

2705 
__LINE__
, 
f‹m©
, 
sföfo
.format) ;

2706 
	`exô
 (1) ;

2709 i‡(
sföfo
.
‰ames
 < frames)

2710 { 
	`¥ötf
 ("\n\nLine %d : Stereo : IncorrectÇumber of frames in file (too short). (%ld should be %d)\n",

2711 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), frames) ;

2712 
	`exô
 (1) ;

2715 i‡(! 
l⁄g_fûe_ok
 && 
sföfo
.
‰ames
 > frames)

2716 { 
	`¥ötf
 ("\n\nLine %d : Stereo : IncorrectÇumber of frames in file (tooÜong). (%ld should be %d)\n",

2717 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), frames) ;

2718 
	`exô
 (1) ;

2721 i‡(
sföfo
.
ch™√ls
 != 2)

2722 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

2723 
	`exô
 (1) ;

2726 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

2728 
	`ã°_ªadf_Êﬂt_‹_dõ
 (
fûe
, 0, 
ã°
, 
‰ames
, 
__LINE__
) ;

2729 
k
 = 0 ; k < 
ôems
 ; k++)

2730 i‡(
	`FLOAT_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

2731 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : %g => %g).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

2732 
	`exô
 (1) ;

2736 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

2738 
	`ã°_ªadf_Êﬂt_‹_dõ
 (
fûe
, 0, 
ã°
, 2, 
__LINE__
) ;

2739 
k
 = 0 ; k < 4 ; k++)

2740 i‡(
	`FLOAT_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

2741 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : %g => %g).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

2742 
	`exô
 (1) ;

2746 
	`ã°_£ek_‹_dõ
 (
fûe
, 10, 
SEEK_SET
, 10, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

2749 i‡(
	`sf_îr‹
 (
fûe
))

2750 { 
	`¥ötf
 ("Löê%d: Should NOTÑëu∫á¿îr‹.\n", 
__LINE__
) ;

2751 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

2752 
	`exô
 (1) ;

2755 i‡(
	`sf_ªad_Êﬂt
 (
fûe
, 
ã°
, 1) > 0)

2756 { 
	`¥ötf
 ("Löê%d: ShouldÑëu∫ 0.\n", 
__LINE__
) ;

2757 
	`exô
 (1) ;

2760 i‡(! 
	`sf_îr‹
 (
fûe
))

2761 { 
	`¥ötf
 ("Löê%d: ShouldÑëu∫á¿îr‹.\n", 
__LINE__
) ;

2762 
	`exô
 (1) ;

2766 
	`ã°_ªadf_Êﬂt_‹_dõ
 (
fûe
, 0, 
ã°
 + 10, 2, 
__LINE__
) ;

2767 
k
 = 20 ; k < 24 ; k++)

2768 i‡(
	`FLOAT_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

2769 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : %g => %g).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

2770 
	`exô
 (1) ;

2774 
	`ã°_£ek_‹_dõ
 (
fûe
, 8, 
SEEK_CUR
, 20, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

2776 
	`ã°_ªadf_Êﬂt_‹_dõ
 (
fûe
, 0, 
ã°
 + 20, 2, 
__LINE__
) ;

2777 
k
 = 40 ; k < 44 ; k++)

2778 i‡(
	`FLOAT_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

2779 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : %g => %g).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

2780 
	`exô
 (1) ;

2784 
	`ã°_£ek_‹_dõ
 (
fûe
, -1 * (
sföfo
.
‰ames
 - 10), 
SEEK_END
, 10, sföfo.
ch™√ls
, 
__LINE__
) ;

2786 
	`ã°_ªadf_Êﬂt_‹_dõ
 (
fûe
, 0, 
ã°
 + 20, 2, 
__LINE__
) ;

2787 
k
 = 20 ; k < 24 ; k++)

2788 i‡(
	`FLOAT_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

2789 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : %g => %g).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

2790 
	`exô
 (1) ;

2793 
	`sf_˛o£
 (
fûe
) ;

2794 
	}
}

2797 
	$m⁄o_rdwr_Êﬂt_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
)

2798 { 
SNDFILE
 *
fûe
 ;

2799 
SF_INFO
 
sföfo
 ;

2800 *
‹ig
, *
ã°
 ;

2801 
k
, 
∑ss
 ;

2803 
‹ig
 = 
‹ig_d©a
.
f
 ;

2804 
ã°
 = 
ã°_d©a
.
f
 ;

2806 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

2807 
sföfo
.
‰ames
 = 
DATA_LENGTH
 ;

2808 
sföfo
.
ch™√ls
 = 1 ;

2809 
sföfo
.
f‹m©
 = format ;

2811 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_RAW


2812 || (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_AU


2813 || (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_SD2
)

2814 
	`u∆ök
 (
fûíame
) ;

2817 
	`¸óã_sh‹t_fûe
 (
fûíame
) ;

2822 i‡((
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_RDWR
, &
sföfo
)))

2823 { 
	`¥ötf
 ("\n\nLöê%d: sf_›í should (SFM_RDWRËhavêÁûed buàdidn't.\n", 
__LINE__
) ;

2824 
	`exô
 (1) ;

2828 i‡(
	`åunˇã
 (
fûíame
, 0) < 0)

2829 { 
	`¥ötf
 ("\n\nLöê%d:Årunˇã (%sËÁûed", 
__LINE__
, 
fûíame
) ;

2830 
	`≥º‹
 (
NULL
) ;

2831 
	`exô
 (1) ;

2838 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

2839 
sföfo
.
‰ames
 = 
DATA_LENGTH
 ;

2840 
sföfo
.
ch™√ls
 = 1 ;

2841 
sföfo
.
f‹m©
 = format ;

2843 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

2848 
∑ss
 = 1 ;Öass <= 3 ;Öass ++)

2849 { 
‹ig
 [20] = 
∑ss
 * 2 ;

2852 
	`ã°_wrôe_Êﬂt_‹_dõ
 (
fûe
, 
∑ss
, 
‹ig
, 
DATA_LENGTH
, 
__LINE__
) ;

2854 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 
∑ss
, (∑s†- 1Ë* 
DATA_LENGTH
,Öass * DATA_LENGTH) ;

2857 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 0, 
ã°
, 
DATA_LENGTH
, 
__LINE__
) ;

2860 
k
 = 0 ; k < 
DATA_LENGTH
 ; k++)

2861 i‡(
	`FLOAT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

2862 { 
	`¥ötf
 ("\n\nLöê%d (∑s†%d): Eº‹áàßm∂ê%d (%g => %g).\n", 
__LINE__
, 
∑ss
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

2863 
	`o˘_ßve_Êﬂt
 (
‹ig
, 
ã°
, 
DATA_LENGTH
) ;

2864 
	`exô
 (1) ;

2867 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 
∑ss
,Öas†* 
DATA_LENGTH
,Öass * DATA_LENGTH) ;

2870 
	`sf_˛o£
 (
fûe
) ;

2873 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

2875 i‡(
sföfo
.
f‹m©
 != format)

2876 { 
	`¥ötf
 ("\n\nLöê%d : Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
f‹m©
, 
sföfo
.format) ;

2877 
	`exô
 (1) ;

2880 i‡(
sföfo
.
‰ames
 < 3 * 
DATA_LENGTH
)

2881 { 
	`¥ötf
 ("\n\nLöê%d : NŸÉnough føme†ö fûe. (%ld < %d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 3 * 
DATA_LENGTH
 ) ;

2882 
	`exô
 (1) ;

2885 i‡(! 
l⁄g_fûe_ok
 && 
sföfo
.
‰ames
 !3 * 
DATA_LENGTH
)

2886 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 3 * 
DATA_LENGTH
 ) ;

2887 
	`exô
 (1) ;

2890 i‡(
sföfo
.
ch™√ls
 != 1)

2891 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

2892 
	`exô
 (1) ;

2895 i‡(! 
l⁄g_fûe_ok
)

2896 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 0, 0, 3 * 
DATA_LENGTH
) ;

2898 
	`ã°_£ek_‹_dõ
 (
fûe
, 3 * 
DATA_LENGTH
, 
SFM_WRITE
 | 
SEEK_SET
, 3 * DATA_LENGTH, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

2900 
∑ss
 = 1 ;Öass <= 3 ;Öass ++)

2901 { 
‹ig
 [20] = 
∑ss
 * 2 ;

2903 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 
∑ss
, (∑s†- 1Ë* 
DATA_LENGTH
, 3 * DATA_LENGTH) ;

2906 
	`ã°_ªad_Êﬂt_‹_dõ
 (
fûe
, 
∑ss
, 
ã°
, 
DATA_LENGTH
, 
__LINE__
) ;

2909 
k
 = 0 ; k < 
DATA_LENGTH
 ; k++)

2910 i‡(
	`FLOAT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

2911 { 
	`¥ötf
 ("\n\nLöê%d (∑s†%d): Eº‹áàßm∂ê%d (%g => %g).\n", 
__LINE__
, 
∑ss
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

2912 
	`o˘_ßve_Êﬂt
 (
‹ig
, 
ã°
, 
DATA_LENGTH
) ;

2913 
	`exô
 (1) ;

2918 
	`sf_˛o£
 (
fûe
) ;

2919 
	}
}

2922 
	$√w_rdwr_Êﬂt_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
Ælow_fd
)

2923 { 
SNDFILE
 *
wfûe
, *
rwfûe
 ;

2924 
SF_INFO
 
sföfo
 ;

2925 *
‹ig
, *
ã°
 ;

2926 
ôems
, 
‰ames
 ;

2928 
‹ig
 = 
‹ig_d©a
.
f
 ;

2929 
ã°
 = 
ã°_d©a
.
f
 ;

2931 
sföfo
.
ßm∂î©e
 = 44100 ;

2932 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

2933 
sföfo
.
ch™√ls
 = 2 ;

2934 
sföfo
.
f‹m©
 = format ;

2936 
ôems
 = 
DATA_LENGTH
 ;

2937 
‰ames
 = 
ôems
 / 
sföfo
.
ch™√ls
 ;

2939 
wfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

2940 
	`sf_comm™d
 (
wfûe
, 
SFC_SET_UPDATE_HEADER_AUTO
, 
NULL
, 
SF_TRUE
) ;

2941 
	`ã°_wrôef_Êﬂt_‹_dõ
 (
wfûe
, 1, 
‹ig
, 
‰ames
, 
__LINE__
) ;

2942 
	`sf_wrôe_sync
 (
wfûe
) ;

2943 
	`ã°_wrôef_Êﬂt_‹_dõ
 (
wfûe
, 2, 
‹ig
, 
‰ames
, 
__LINE__
) ;

2944 
	`sf_wrôe_sync
 (
wfûe
) ;

2946 
rwfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

2947 i‡(
sföfo
.
‰ames
 != 2 * frames)

2948 { 
	`¥ötf
 ("\n\nLöê%d : inc‹ª˘Çumbî o‡‰ame†ö fûê(%ld shﬁd bê%d)\n\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), frames) ;

2949 
	`exô
 (1) ;

2952 
	`ã°_wrôef_Êﬂt_‹_dõ
 (
wfûe
, 3, 
‹ig
, 
‰ames
, 
__LINE__
) ;

2954 
	`ã°_ªadf_Êﬂt_‹_dõ
 (
rwfûe
, 1, 
ã°
, 
‰ames
, 
__LINE__
) ;

2955 
	`ã°_ªadf_Êﬂt_‹_dõ
 (
rwfûe
, 2, 
ã°
, 
‰ames
, 
__LINE__
) ;

2957 
	`sf_˛o£
 (
wfûe
) ;

2958 
	`sf_˛o£
 (
rwfûe
) ;

2959 
	}
}

2965 
m⁄o_doubÀ_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

2966 
°îeo_doubÀ_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

2967 
m⁄o_rdwr_doubÀ_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

2968 
√w_rdwr_doubÀ_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
Ælow_fd
) ;

2971 
	$pcm_ã°_doubÀ
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
)

2972 { 
SF_INFO
 
sföfo
 ;

2973 *
‹ig
, *
ã°
 ;

2974 
k
, 
ôems
, 
Ælow_fd
 ;

2977 
Ælow_fd
 = ((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_SD2
Ë? 
SF_FALSE
 : 
SF_TRUE
 ;

2979 
	`¥öt_ã°_«me
 ("pcm_ã°_doubÀ", 
fûíame
) ;

2981 
sföfo
.
ßm∂î©e
 = 44100 ;

2982 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

2983 
sföfo
.
ch™√ls
 = 1 ;

2984 
sföfo
.
f‹m©
 = format ;

2986 
	`gí_wödowed_söe_doubÀ
 (
‹ig_d©a
.
d
, 
DATA_LENGTH
, 1.0) ;

2988 
‹ig
 = 
‹ig_d©a
.
d
 ;

2989 
ã°
 = 
ã°_d©a
.
d
 ;

2992 
	`CONVERT_DATA
 (
k
, 
DATA_LENGTH
, 
‹ig
, 
‹ig_d©a
.
d
) ;

2994 
ôems
 = 
DATA_LENGTH
 ;

2998 
	`m⁄o_doubÀ_ã°
 (
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

3001 i‡((
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_16
 ||

3002 (
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_24
)

3003 { 
	`u∆ök
 (
fûíame
) ;

3004 
	`¥ötf
 ("no seek : ok\n") ;

3008 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_FLAC
)

3009 
	`m⁄o_rdwr_doubÀ_ã°
 (
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

3012 
sföfo
.
ch™√ls
 = 2 ;

3013 i‡(
	`sf_f‹m©_check
 (&
sföfo
) == 0)

3014 { 
	`u∆ök
 (
fûíame
) ;

3015 
	`puts
 ("no stereo : ok") ;

3019 
	`°îeo_doubÀ_ã°
 (
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
) ;

3023 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_PAF
 &&

3024 (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_VOC
 &&

3025 (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_FLAC
)

3026 
	`√w_rdwr_doubÀ_ã°
 (
fûíame
, 
f‹m©
, 
Ælow_fd
) ;

3028 
	`dñëe_fûe
 (
f‹m©
, 
fûíame
) ;

3030 
	`puts
 ("ok") ;

3032 
	}
}

3035 
	$m⁄o_doubÀ_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
)

3036 { 
SNDFILE
 *
fûe
 ;

3037 
SF_INFO
 
sföfo
 ;

3038 *
‹ig
, *
ã°
 ;

3039 
sf_cou¡_t
 
cou¡
 ;

3040 
k
, 
ôems
 ;

3042 
sföfo
.
ßm∂î©e
 = 44100 ;

3043 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

3044 
sföfo
.
ch™√ls
 = 1 ;

3045 
sföfo
.
f‹m©
 = format ;

3047 
‹ig
 = 
‹ig_d©a
.
d
 ;

3048 
ã°
 = 
ã°_d©a
.
d
 ;

3050 
ôems
 = 
DATA_LENGTH
 ;

3052 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

3054 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_ARTIST
, "YourÇame here") ;

3056 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
‹ig
, 
ôems
, 
__LINE__
) ;

3057 
	`sf_wrôe_sync
 (
fûe
) ;

3058 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 0, 
‹ig
, 
ôems
, 
__LINE__
) ;

3059 
	`sf_wrôe_sync
 (
fûe
) ;

3062 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_COPYRIGHT
, "Copyright (c) 2003") ;

3064 
	`sf_˛o£
 (
fûe
) ;

3066 
	`mem£t
 (
ã°
, 0, 
ôems
 *  ()) ;

3068 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

3069 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

3071 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

3073 i‡(
sföfo
.
f‹m©
 != format)

3074 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
f‹m©
, 
sföfo
.format) ;

3075 
	`exô
 (1) ;

3078 i‡(
sföfo
.
‰ames
 < 2 * 
ôems
)

3079 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘Çumbî o‡‰ame†ö fûê—oÿsh‹t). (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
ôems
) ;

3080 
	`exô
 (1) ;

3083 i‡(! 
l⁄g_fûe_ok
 && 
sföfo
.
‰ames
 > 2 * 
ôems
)

3084 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘Çumbî o‡‰ame†ö fûê—oÿl⁄g). (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 
ôems
) ;

3085 
	`exô
 (1) ;

3088 i‡(
sföfo
.
ch™√ls
 != 1)

3089 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

3090 
	`exô
 (1) ;

3093 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

3095 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
ã°
, 
ôems
, 
__LINE__
) ;

3096 
k
 = 0 ; k < 
ôems
 ; k++)

3097 i‡(
	`FLOAT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

3098 { 
	`¥ötf
 ("\n\nLöê%d: M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : %g => %g).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

3099 
	`exô
 (1) ;

3103 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

3105 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
ã°
, 4, 
__LINE__
) ;

3106 
k
 = 0 ; k < 4 ; k++)

3107 i‡(
	`FLOAT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

3108 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : %g => %g).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

3109 
	`exô
 (1) ;

3112 i‡((
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_16
 ||

3113 (
f‹m©
 & 
SF_FORMAT_SUBMASK
Ë=
SF_FORMAT_DWVW_24
)

3114 { 
	`sf_˛o£
 (
fûe
) ;

3115 
	`u∆ök
 (
fûíame
) ;

3116 
	`¥ötf
 ("no seek : ") ;

3121 
	`ã°_£ek_‹_dõ
 (
fûe
, 
ôems
 + 10, 
SEEK_SET
, iãm†+ 10, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

3123 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
ã°
 + 10, 4, 
__LINE__
) ;

3124 
k
 = 10 ; k < 14 ; k++)

3125 i‡(
	`FLOAT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

3126 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : %g => %g).\n", 
__LINE__
, 
k
, 
ã°
 [k], 
‹ig
 [k]) ;

3127 
	`exô
 (1) ;

3131 
	`ã°_£ek_‹_dõ
 (
fûe
, 6, 
SEEK_CUR
, 
ôems
 + 20, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

3133 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
ã°
 + 20, 4, 
__LINE__
) ;

3134 
k
 = 20 ; k < 24 ; k++)

3135 i‡(
	`FLOAT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

3136 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êA (#%d : %g => %g).\n", 
__LINE__
, 
k
, 
ã°
 [k], 
‹ig
 [k]) ;

3137 
	`exô
 (1) ;

3141 
	`ã°_£ek_‹_dõ
 (
fûe
, -1 * (
sföfo
.
‰ames
 - 10), 
SEEK_END
, 10, sföfo.
ch™√ls
, 
__LINE__
) ;

3143 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
ã°
 + 10, 4, 
__LINE__
) ;

3144 
k
 = 10 ; k < 14 ; k++)

3145 i‡(
	`FLOAT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

3146 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ: Inc‹ª˘ sam∂êD (#%d : %g => %g).\n", 
__LINE__
, 
k
, 
ã°
 [k], 
‹ig
 [k]) ;

3147 
	`exô
 (1) ;

3151 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

3153 
cou¡
 = 0 ;

3154 
cou¡
 < 
sföfo
.
‰ames
)

3155 
cou¡
 +
	`sf_ªad_doubÀ
 (
fûe
, 
ã°
, 311) ;

3158 i‡(
	`sf_îr‹
 (
fûe
))

3159 { 
	`¥ötf
 ("\n\nLöê%d : M⁄ÿ:Éº‹ whîêthîêshouldn'àhavêbì¿⁄e.\n", 
__LINE__
) ;

3160 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

3161 
	`exô
 (1) ;

3165 i‡(
cou¡
 > 
sföfo
.
‰ames
)

3166 { 
	`¥ötf
 ("\n\nLöe†%d :ÑódÖa°Énd o‡fûê(%ld should bê%ld)\n", 
__LINE__
, (Ë
cou¡
, (Ë
sföfo
.
‰ames
) ;

3167 
	`exô
 (1) ;

3170 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_CUR
, 
sföfo
.
‰ames
, sföfo.
ch™√ls
, 
__LINE__
) ;

3172 
	`sf_˛o£
 (
fûe
) ;

3174 
	}
}

3177 
	$°îeo_doubÀ_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
)

3178 { 
SNDFILE
 *
fûe
 ;

3179 
SF_INFO
 
sföfo
 ;

3180 *
‹ig
, *
ã°
 ;

3181 
k
, 
ôems
, 
‰ames
 ;

3183 
sföfo
.
ßm∂î©e
 = 44100 ;

3184 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

3185 
sföfo
.
ch™√ls
 = 2 ;

3186 
sföfo
.
f‹m©
 = format ;

3188 
	`gí_wödowed_söe_doubÀ
 (
‹ig_d©a
.
d
, 
DATA_LENGTH
, 1.0) ;

3190 
‹ig
 = 
‹ig_d©a
.
d
 ;

3191 
ã°
 = 
ã°_d©a
.
d
 ;

3194 
	`CONVERT_DATA
 (
k
, 
DATA_LENGTH
, 
‹ig
, 
‹ig_d©a
.
d
) ;

3196 
ôems
 = 
DATA_LENGTH
 ;

3197 
‰ames
 = 
ôems
 / 
sföfo
.
ch™√ls
 ;

3199 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

3201 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_ARTIST
, "YourÇame here") ;

3203 
	`ã°_wrôef_doubÀ_‹_dõ
 (
fûe
, 0, 
‹ig
, 
‰ames
, 
__LINE__
) ;

3205 
	`sf_£t_°rög
 (
fûe
, 
SF_STR_COPYRIGHT
, "Copyright (c) 2003") ;

3207 
	`sf_˛o£
 (
fûe
) ;

3209 
	`mem£t
 (
ã°
, 0, 
ôems
 *  ()) ;

3211 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë!
SF_FORMAT_RAW
)

3212 
	`mem£t
 (&
sföfo
, 0,  (sfinfo)) ;

3214 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

3216 i‡(
sföfo
.
f‹m©
 != format)

3217 { 
	`¥ötf
 ("\n\nLine %d : Stereo : Returned format incorrect (0x%08X => 0x%08X).\n",

3218 
__LINE__
, 
f‹m©
, 
sföfo
.format) ;

3219 
	`exô
 (1) ;

3222 i‡(
sföfo
.
‰ames
 < frames)

3223 { 
	`¥ötf
 ("\n\nLine %d : Stereo : IncorrectÇumber of frames in file (too short). (%ld should be %d)\n",

3224 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), frames) ;

3225 
	`exô
 (1) ;

3228 i‡(! 
l⁄g_fûe_ok
 && 
sföfo
.
‰ames
 > frames)

3229 { 
	`¥ötf
 ("\n\nLine %d : Stereo : IncorrectÇumber of frames in file (tooÜong). (%ld should be %d)\n",

3230 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), frames) ;

3231 
	`exô
 (1) ;

3234 i‡(
sföfo
.
ch™√ls
 != 2)

3235 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

3236 
	`exô
 (1) ;

3239 
	`check_log_buf„r_‹_dõ
 (
fûe
, 
__LINE__
) ;

3241 
	`ã°_ªadf_doubÀ_‹_dõ
 (
fûe
, 0, 
ã°
, 
‰ames
, 
__LINE__
) ;

3242 
k
 = 0 ; k < 
ôems
 ; k++)

3243 i‡(
	`FLOAT_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

3244 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : %g => %g).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

3245 
	`exô
 (1) ;

3249 
	`ã°_£ek_‹_dõ
 (
fûe
, 0, 
SEEK_SET
, 0, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

3251 
	`ã°_ªadf_doubÀ_‹_dõ
 (
fûe
, 0, 
ã°
, 2, 
__LINE__
) ;

3252 
k
 = 0 ; k < 4 ; k++)

3253 i‡(
	`FLOAT_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

3254 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : %g => %g).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

3255 
	`exô
 (1) ;

3259 
	`ã°_£ek_‹_dõ
 (
fûe
, 10, 
SEEK_SET
, 10, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

3262 i‡(
	`sf_îr‹
 (
fûe
))

3263 { 
	`¥ötf
 ("Löê%d: Should NOTÑëu∫á¿îr‹.\n", 
__LINE__
) ;

3264 
	`puts
 (
	`sf_°ªº‹
 (
fûe
)) ;

3265 
	`exô
 (1) ;

3268 i‡(
	`sf_ªad_doubÀ
 (
fûe
, 
ã°
, 1) > 0)

3269 { 
	`¥ötf
 ("Löê%d: ShouldÑëu∫ 0.\n", 
__LINE__
) ;

3270 
	`exô
 (1) ;

3273 i‡(! 
	`sf_îr‹
 (
fûe
))

3274 { 
	`¥ötf
 ("Löê%d: ShouldÑëu∫á¿îr‹.\n", 
__LINE__
) ;

3275 
	`exô
 (1) ;

3279 
	`ã°_ªadf_doubÀ_‹_dõ
 (
fûe
, 0, 
ã°
 + 10, 2, 
__LINE__
) ;

3280 
k
 = 20 ; k < 24 ; k++)

3281 i‡(
	`FLOAT_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

3282 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : %g => %g).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

3283 
	`exô
 (1) ;

3287 
	`ã°_£ek_‹_dõ
 (
fûe
, 8, 
SEEK_CUR
, 20, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

3289 
	`ã°_ªadf_doubÀ_‹_dõ
 (
fûe
, 0, 
ã°
 + 20, 2, 
__LINE__
) ;

3290 
k
 = 40 ; k < 44 ; k++)

3291 i‡(
	`FLOAT_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

3292 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : %g => %g).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

3293 
	`exô
 (1) ;

3297 
	`ã°_£ek_‹_dõ
 (
fûe
, -1 * (
sföfo
.
‰ames
 - 10), 
SEEK_END
, 10, sföfo.
ch™√ls
, 
__LINE__
) ;

3299 
	`ã°_ªadf_doubÀ_‹_dõ
 (
fûe
, 0, 
ã°
 + 20, 2, 
__LINE__
) ;

3300 
k
 = 20 ; k < 24 ; k++)

3301 i‡(
	`FLOAT_ERROR
 (
ã°
 [
k
], 
‹ig
 [k]))

3302 { 
	`¥ötf
 ("\n\nLöê%d : Sãªÿ: Inc‹ª˘ sam∂ê(#%d : %g => %g).\n", 
__LINE__
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

3303 
	`exô
 (1) ;

3306 
	`sf_˛o£
 (
fûe
) ;

3307 
	}
}

3310 
	$m⁄o_rdwr_doubÀ_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
l⁄g_fûe_ok
, 
Ælow_fd
)

3311 { 
SNDFILE
 *
fûe
 ;

3312 
SF_INFO
 
sföfo
 ;

3313 *
‹ig
, *
ã°
 ;

3314 
k
, 
∑ss
 ;

3316 
‹ig
 = 
‹ig_d©a
.
d
 ;

3317 
ã°
 = 
ã°_d©a
.
d
 ;

3319 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

3320 
sföfo
.
‰ames
 = 
DATA_LENGTH
 ;

3321 
sföfo
.
ch™√ls
 = 1 ;

3322 
sföfo
.
f‹m©
 = format ;

3324 i‡((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_RAW


3325 || (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_AU


3326 || (
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_SD2
)

3327 
	`u∆ök
 (
fûíame
) ;

3330 
	`¸óã_sh‹t_fûe
 (
fûíame
) ;

3335 i‡((
fûe
 = 
	`sf_›í
 (
fûíame
, 
SFM_RDWR
, &
sföfo
)))

3336 { 
	`¥ötf
 ("\n\nLöê%d: sf_›í should (SFM_RDWRËhavêÁûed buàdidn't.\n", 
__LINE__
) ;

3337 
	`exô
 (1) ;

3341 i‡(
	`åunˇã
 (
fûíame
, 0) < 0)

3342 { 
	`¥ötf
 ("\n\nLöê%d:Årunˇã (%sËÁûed", 
__LINE__
, 
fûíame
) ;

3343 
	`≥º‹
 (
NULL
) ;

3344 
	`exô
 (1) ;

3351 
sföfo
.
ßm∂î©e
 = 
SAMPLE_RATE
 ;

3352 
sföfo
.
‰ames
 = 
DATA_LENGTH
 ;

3353 
sföfo
.
ch™√ls
 = 1 ;

3354 
sföfo
.
f‹m©
 = format ;

3356 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

3361 
∑ss
 = 1 ;Öass <= 3 ;Öass ++)

3362 { 
‹ig
 [20] = 
∑ss
 * 2 ;

3365 
	`ã°_wrôe_doubÀ_‹_dõ
 (
fûe
, 
∑ss
, 
‹ig
, 
DATA_LENGTH
, 
__LINE__
) ;

3367 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 
∑ss
, (∑s†- 1Ë* 
DATA_LENGTH
,Öass * DATA_LENGTH) ;

3370 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 0, 
ã°
, 
DATA_LENGTH
, 
__LINE__
) ;

3373 
k
 = 0 ; k < 
DATA_LENGTH
 ; k++)

3374 i‡(
	`FLOAT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

3375 { 
	`¥ötf
 ("\n\nLöê%d (∑s†%d): Eº‹áàßm∂ê%d (%g => %g).\n", 
__LINE__
, 
∑ss
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

3376 
	`o˘_ßve_doubÀ
 (
‹ig
, 
ã°
, 
DATA_LENGTH
) ;

3377 
	`exô
 (1) ;

3380 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 
∑ss
,Öas†* 
DATA_LENGTH
,Öass * DATA_LENGTH) ;

3383 
	`sf_˛o£
 (
fûe
) ;

3386 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

3388 i‡(
sföfo
.
f‹m©
 != format)

3389 { 
	`¥ötf
 ("\n\nLöê%d : Rëu∫ed f‹m© inc‹ª˘ (0x%08X => 0x%08X).\n", 
__LINE__
, 
f‹m©
, 
sföfo
.format) ;

3390 
	`exô
 (1) ;

3393 i‡(
sföfo
.
‰ames
 < 3 * 
DATA_LENGTH
)

3394 { 
	`¥ötf
 ("\n\nLöê%d : NŸÉnough føme†ö fûe. (%ld < %d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 3 * 
DATA_LENGTH
 ) ;

3395 
	`exô
 (1) ;

3398 i‡(! 
l⁄g_fûe_ok
 && 
sföfo
.
‰ames
 !3 * 
DATA_LENGTH
)

3399 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘Çumbî o‡‰ame†ö fûe. (%ld should bê%d)\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), 3 * 
DATA_LENGTH
 ) ;

3400 
	`exô
 (1) ;

3403 i‡(
sföfo
.
ch™√ls
 != 1)

3404 { 
	`¥ötf
 ("\n\nLöê%d : Inc‹ª˘Çumbî o‡ch™√l†ö fûe.\n", 
__LINE__
) ;

3405 
	`exô
 (1) ;

3408 i‡(! 
l⁄g_fûe_ok
)

3409 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 0, 0, 3 * 
DATA_LENGTH
) ;

3411 
	`ã°_£ek_‹_dõ
 (
fûe
, 3 * 
DATA_LENGTH
, 
SFM_WRITE
 | 
SEEK_SET
, 3 * DATA_LENGTH, 
sföfo
.
ch™√ls
, 
__LINE__
) ;

3413 
∑ss
 = 1 ;Öass <= 3 ;Öass ++)

3414 { 
‹ig
 [20] = 
∑ss
 * 2 ;

3416 
	`ã°_ªad_wrôe_posôi⁄_‹_dõ
 (
fûe
, 
__LINE__
, 
∑ss
, (∑s†- 1Ë* 
DATA_LENGTH
, 3 * DATA_LENGTH) ;

3419 
	`ã°_ªad_doubÀ_‹_dõ
 (
fûe
, 
∑ss
, 
ã°
, 
DATA_LENGTH
, 
__LINE__
) ;

3422 
k
 = 0 ; k < 
DATA_LENGTH
 ; k++)

3423 i‡(
	`FLOAT_ERROR
 (
‹ig
 [
k
], 
ã°
 [k]))

3424 { 
	`¥ötf
 ("\n\nLöê%d (∑s†%d): Eº‹áàßm∂ê%d (%g => %g).\n", 
__LINE__
, 
∑ss
, 
k
, 
‹ig
 [k], 
ã°
 [k]) ;

3425 
	`o˘_ßve_doubÀ
 (
‹ig
, 
ã°
, 
DATA_LENGTH
) ;

3426 
	`exô
 (1) ;

3431 
	`sf_˛o£
 (
fûe
) ;

3432 
	}
}

3435 
	$√w_rdwr_doubÀ_ã°
 (c⁄° *
fûíame
, 
f‹m©
, 
Ælow_fd
)

3436 { 
SNDFILE
 *
wfûe
, *
rwfûe
 ;

3437 
SF_INFO
 
sföfo
 ;

3438 *
‹ig
, *
ã°
 ;

3439 
ôems
, 
‰ames
 ;

3441 
‹ig
 = 
‹ig_d©a
.
d
 ;

3442 
ã°
 = 
ã°_d©a
.
d
 ;

3444 
sföfo
.
ßm∂î©e
 = 44100 ;

3445 
sföfo
.
‰ames
 = 
SILLY_WRITE_COUNT
 ;

3446 
sföfo
.
ch™√ls
 = 2 ;

3447 
sföfo
.
f‹m©
 = format ;

3449 
ôems
 = 
DATA_LENGTH
 ;

3450 
‰ames
 = 
ôems
 / 
sföfo
.
ch™√ls
 ;

3452 
wfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

3453 
	`sf_comm™d
 (
wfûe
, 
SFC_SET_UPDATE_HEADER_AUTO
, 
NULL
, 
SF_TRUE
) ;

3454 
	`ã°_wrôef_doubÀ_‹_dõ
 (
wfûe
, 1, 
‹ig
, 
‰ames
, 
__LINE__
) ;

3455 
	`sf_wrôe_sync
 (
wfûe
) ;

3456 
	`ã°_wrôef_doubÀ_‹_dõ
 (
wfûe
, 2, 
‹ig
, 
‰ames
, 
__LINE__
) ;

3457 
	`sf_wrôe_sync
 (
wfûe
) ;

3459 
rwfûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
sföfo
, 
Ælow_fd
, 
__LINE__
) ;

3460 i‡(
sföfo
.
‰ames
 != 2 * frames)

3461 { 
	`¥ötf
 ("\n\nLöê%d : inc‹ª˘Çumbî o‡‰ame†ö fûê(%ld shﬁd bê%d)\n\n", 
__LINE__
, 
	`SF_COUNT_TO_LONG
 (
sföfo
.
‰ames
), frames) ;

3462 
	`exô
 (1) ;

3465 
	`ã°_wrôef_doubÀ_‹_dõ
 (
wfûe
, 3, 
‹ig
, 
‰ames
, 
__LINE__
) ;

3467 
	`ã°_ªadf_doubÀ_‹_dõ
 (
rwfûe
, 1, 
ã°
, 
‰ames
, 
__LINE__
) ;

3468 
	`ã°_ªadf_doubÀ_‹_dõ
 (
rwfûe
, 2, 
ã°
, 
‰ames
, 
__LINE__
) ;

3470 
	`sf_˛o£
 (
wfûe
) ;

3471 
	`sf_˛o£
 (
rwfûe
) ;

3472 
	}
}

3480 
	$em±y_fûe_ã°
 (c⁄° *
fûíame
, 
f‹m©
)

3481 { 
SNDFILE
 *
fûe
 ;

3482 
SF_INFO
 
öfo
 ;

3483 
Ælow_fd
 ;

3486 
Ælow_fd
 = ((
f‹m©
 & 
SF_FORMAT_TYPEMASK
Ë=
SF_FORMAT_SD2
Ë? 
SF_FALSE
 : 
SF_TRUE
 ;

3488 
	`¥öt_ã°_«me
 ("em±y_fûe_ã°", 
fûíame
) ;

3490 
	`u∆ök
 (
fûíame
) ;

3492 
öfo
.
ßm∂î©e
 = 48000 ;

3493 
öfo
.
ch™√ls
 = 2 ;

3494 
öfo
.
f‹m©
 = format ;

3496 i‡(
	`sf_f‹m©_check
 (&
öfo
Ë=
SF_FALSE
)

3497 { 
öfo
.
ch™√ls
 = 1 ;

3498 i‡(
	`sf_f‹m©_check
 (&
öfo
Ë=
SF_FALSE
)

3499 { 
	`puts
 ("invalid file format") ;

3505 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_WRITE
, &
öfo
, 
Ælow_fd
, 
__LINE__
) ;

3506 
	`sf_˛o£
 (
fûe
) ;

3509 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
öfo
, 
Ælow_fd
, 
__LINE__
) ;

3511 i‡(
	`SF_COUNT_TO_LONG
 (
öfo
.
‰ames
) != 0)

3512 { 
	`¥ötf
 ("\n\nEº‹ : fømêcou¡ (%ldËshould bêzîo.\n", 
	`SF_COUNT_TO_LONG
 (
öfo
.
‰ames
)) ;

3513 
	`exô
 (1) ;

3516 
	`sf_˛o£
 (
fûe
) ;

3519 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_RDWR
, &
öfo
, 
Ælow_fd
, 
__LINE__
) ;

3521 i‡(
	`SF_COUNT_TO_LONG
 (
öfo
.
‰ames
) != 0)

3522 { 
	`¥ötf
 ("\n\nEº‹ : fømêcou¡ (%ldËshould bêzîo.\n", 
	`SF_COUNT_TO_LONG
 (
öfo
.
‰ames
)) ;

3523 
	`exô
 (1) ;

3526 
	`sf_˛o£
 (
fûe
) ;

3529 
fûe
 = 
	`ã°_›í_fûe_‹_dõ
 (
fûíame
, 
SFM_READ
, &
öfo
, 
Ælow_fd
, 
__LINE__
) ;

3531 i‡(
	`SF_COUNT_TO_LONG
 (
öfo
.
‰ames
) != 0)

3532 { 
	`¥ötf
 ("\n\nEº‹ : fømêcou¡ (%ldËshould bêzîo.\n", 
	`SF_COUNT_TO_LONG
 (
öfo
.
‰ames
)) ;

3533 
	`exô
 (1) ;

3536 
	`sf_˛o£
 (
fûe
) ;

3538 
	`check_›í_fûe_cou¡_‹_dõ
 (
__LINE__
) ;

3540 
	`u∆ök
 (
fûíame
) ;

3541 
	`puts
 ("ok") ;

3544 
	}
}

3551 
	$¸óã_sh‹t_fûe
 (c⁄° *
fûíame
)

3552 { 
FILE
 *
fûe
 ;

3554 i‡(! (
fûe
 = 
	`f›í
 (
fûíame
, "w")))

3555 { 
	`¥ötf
 ("¸óã_sh‹t_fûê: f›í (%s, \"w\"ËÁûed.", 
fûíame
) ;

3556 
	`fÊush
 (
°dout
) ;

3557 
	`≥º‹
 (
NULL
) ;

3558 
	`exô
 (1) ;

3561 
	`Ârötf
 (
fûe
, "This isÅhe file data.\n") ;

3563 
	`f˛o£
 (
fûe
) ;

3564 
	}
}

3566 #i‡(
deföed
 (
WIN32
Ë|| deföed (
__WIN32
))

3574 
	$åunˇã
 (c⁄° *
fûíame
, 
ign‹ed
)

3575 { 
fd
 ;

3577 
ign‹ed
 = 0 ;

3579 i‡((
fd
 = 
	`›í
 (
fûíame
, 
O_RDWR
 | 
O_TRUNC
 | 
O_BINARY
)) < 0)

3582 
	`˛o£
 (
fd
) ;

3585 
	}
}

	@sndfile.h

26 #i‚de‡
SNDFILE_H


27 
	#SNDFILE_H


	)

30 
	#SNDFILE_1


	)

32 
	~<°dio.h
>

36 #if (
deföed
 (
__MWERKS__
))

37 
	~<unix.h
>

39 
	~<sys/ty≥s.h
>

42 #ifde‡
__˝lu•lus


55 
SF_FORMAT_WAV
 = 0x010000,

56 
SF_FORMAT_AIFF
 = 0x020000,

57 
SF_FORMAT_AU
 = 0x030000,

58 
SF_FORMAT_RAW
 = 0x040000,

59 
SF_FORMAT_PAF
 = 0x050000,

60 
SF_FORMAT_SVX
 = 0x060000,

61 
SF_FORMAT_NIST
 = 0x070000,

62 
SF_FORMAT_VOC
 = 0x080000,

63 
SF_FORMAT_IRCAM
 = 0x0A0000,

64 
SF_FORMAT_W64
 = 0x0B0000,

65 
SF_FORMAT_MAT4
 = 0x0C0000,

66 
SF_FORMAT_MAT5
 = 0x0D0000,

67 
SF_FORMAT_PVF
 = 0x0E0000,

68 
SF_FORMAT_XI
 = 0x0F0000,

69 
SF_FORMAT_HTK
 = 0x100000,

70 
SF_FORMAT_SDS
 = 0x110000,

71 
SF_FORMAT_AVR
 = 0x120000,

72 
SF_FORMAT_WAVEX
 = 0x130000,

73 
SF_FORMAT_SD2
 = 0x160000,

74 
SF_FORMAT_FLAC
 = 0x170000,

75 
SF_FORMAT_CAF
 = 0x180000,

79 
SF_FORMAT_PCM_S8
 = 0x0001,

80 
SF_FORMAT_PCM_16
 = 0x0002,

81 
SF_FORMAT_PCM_24
 = 0x0003,

82 
SF_FORMAT_PCM_32
 = 0x0004,

84 
SF_FORMAT_PCM_U8
 = 0x0005,

86 
SF_FORMAT_FLOAT
 = 0x0006,

87 
SF_FORMAT_DOUBLE
 = 0x0007,

89 
SF_FORMAT_ULAW
 = 0x0010,

90 
SF_FORMAT_ALAW
 = 0x0011,

91 
SF_FORMAT_IMA_ADPCM
 = 0x0012,

92 
SF_FORMAT_MS_ADPCM
 = 0x0013,

94 
SF_FORMAT_GSM610
 = 0x0020,

95 
SF_FORMAT_VOX_ADPCM
 = 0x0021,

97 
SF_FORMAT_G721_32
 = 0x0030,

98 
SF_FORMAT_G723_24
 = 0x0031,

99 
SF_FORMAT_G723_40
 = 0x0032,

101 
SF_FORMAT_DWVW_12
 = 0x0040,

102 
SF_FORMAT_DWVW_16
 = 0x0041,

103 
SF_FORMAT_DWVW_24
 = 0x0042,

104 
SF_FORMAT_DWVW_N
 = 0x0043,

106 
SF_FORMAT_DPCM_8
 = 0x0050,

107 
SF_FORMAT_DPCM_16
 = 0x0051,

111 
SF_ENDIAN_FILE
 = 0x00000000,

112 
SF_ENDIAN_LITTLE
 = 0x10000000,

113 
SF_ENDIAN_BIG
 = 0x20000000,

114 
SF_ENDIAN_CPU
 = 0x30000000,

116 
SF_FORMAT_SUBMASK
 = 0x0000FFFF,

117 
SF_FORMAT_TYPEMASK
 = 0x0FFF0000,

118 
SF_FORMAT_ENDMASK
 = 0x30000000

128 { 
SFC_GET_LIB_VERSION
 = 0x1000,

129 
SFC_GET_LOG_INFO
 = 0x1001,

131 
SFC_GET_NORM_DOUBLE
 = 0x1010,

132 
SFC_GET_NORM_FLOAT
 = 0x1011,

133 
SFC_SET_NORM_DOUBLE
 = 0x1012,

134 
SFC_SET_NORM_FLOAT
 = 0x1013,

135 
SFC_SET_SCALE_FLOAT_INT_READ
 = 0x1014,

137 
SFC_GET_SIMPLE_FORMAT_COUNT
 = 0x1020,

138 
SFC_GET_SIMPLE_FORMAT
 = 0x1021,

140 
SFC_GET_FORMAT_INFO
 = 0x1028,

142 
SFC_GET_FORMAT_MAJOR_COUNT
 = 0x1030,

143 
SFC_GET_FORMAT_MAJOR
 = 0x1031,

144 
SFC_GET_FORMAT_SUBTYPE_COUNT
 = 0x1032,

145 
SFC_GET_FORMAT_SUBTYPE
 = 0x1033,

147 
SFC_CALC_SIGNAL_MAX
 = 0x1040,

148 
SFC_CALC_NORM_SIGNAL_MAX
 = 0x1041,

149 
SFC_CALC_MAX_ALL_CHANNELS
 = 0x1042,

150 
SFC_CALC_NORM_MAX_ALL_CHANNELS
 = 0x1043,

151 
SFC_GET_SIGNAL_MAX
 = 0x1044,

152 
SFC_GET_MAX_ALL_CHANNELS
 = 0x1045,

154 
SFC_SET_ADD_PEAK_CHUNK
 = 0x1050,

156 
SFC_UPDATE_HEADER_NOW
 = 0x1060,

157 
SFC_SET_UPDATE_HEADER_AUTO
 = 0x1061,

159 
SFC_FILE_TRUNCATE
 = 0x1080,

161 
SFC_SET_RAW_START_OFFSET
 = 0x1090,

163 
SFC_SET_DITHER_ON_WRITE
 = 0x10A0,

164 
SFC_SET_DITHER_ON_READ
 = 0x10A1,

166 
SFC_GET_DITHER_INFO_COUNT
 = 0x10A2,

167 
SFC_GET_DITHER_INFO
 = 0x10A3,

169 
SFC_GET_EMBED_FILE_INFO
 = 0x10B0,

171 
SFC_SET_CLIPPING
 = 0x10C0,

172 
SFC_GET_CLIPPING
 = 0x10C1,

174 
SFC_GET_INSTRUMENT
 = 0x10D0,

175 
SFC_SET_INSTRUMENT
 = 0x10D1,

177 
SFC_GET_LOOP_INFO
 = 0x10E0,

179 
SFC_GET_BROADCAST_INFO
 = 0x10F0,

180 
SFC_SET_BROADCAST_INFO
 = 0x10F1,

183 
SFC_TEST_IEEE_FLOAT_REPLACE
 = 0x6001,

191 
SFC_SET_ADD_DITHER_ON_WRITE
 = 0x1070,

192 
SFC_SET_ADD_DITHER_ON_READ
 = 0x1071

203 { 
SF_STR_TITLE
 = 0x01,

204 
SF_STR_COPYRIGHT
 = 0x02,

205 
SF_STR_SOFTWARE
 = 0x03,

206 
SF_STR_ARTIST
 = 0x04,

207 
SF_STR_COMMENT
 = 0x05,

208 
SF_STR_DATE
 = 0x06

216 
	#SF_STR_FIRST
 
SF_STR_TITLE


	)

217 
	#SF_STR_LAST
 
SF_STR_DATE


	)

221 
SF_FALSE
 = 0,

222 
SF_TRUE
 = 1,

225 
SFM_READ
 = 0x10,

226 
SFM_WRITE
 = 0x20,

227 
SFM_RDWR
 = 0x30

237 { 
SF_ERR_NO_ERROR
 = 0,

238 
SF_ERR_UNRECOGNISED_FORMAT
 = 1,

239 
SF_ERR_SYSTEM
 = 2,

240 
SF_ERR_MALFORMED_FILE
 = 3,

241 
SF_ERR_UNSUPPORTED_ENCODING
 = 4

246 
SNDFILE_èg
 
	tSNDFILE
 ;

253 
__öt64
 
	tsf_cou¡_t
 ;

255 
	#SF_COUNT_MAX
 0x7FFFFFFFFFFFFFFFLL

	)

262 
	sSF_INFO


263 { 
sf_cou¡_t
 
‰ames
 ;

264 
ßm∂î©e
 ;

265 
ch™√ls
 ;

266 
f‹m©
 ;

267 
£˘i⁄s
 ;

268 
£ekabÀ
 ;

271 
SF_INFO
 
	tSF_INFO
 ;

285 { 
f‹m©
 ;

286 c⁄° *
«me
 ;

287 c⁄° *
exãnsi⁄
 ;

288 } 
	tSF_FORMAT_INFO
 ;

297 { 
SFD_DEFAULT_LEVEL
 = 0,

298 
SFD_CUSTOM_LEVEL
 = 0x40000000,

300 
SFD_NO_DITHER
 = 500,

301 
SFD_WHITE
 = 501,

302 
SFD_TRIANGULAR_PDF
 = 502

306 { 
ty≥
 ;

307 
Àvñ
 ;

308 c⁄° *
«me
 ;

309 } 
	tSF_DITHER_INFO
 ;

316 { 
sf_cou¡_t
 
off£t
 ;

317 
sf_cou¡_t
 
Àngth
 ;

318 } 
	tSF_EMBED_FILE_INFO
 ;

328 
SF_LOOP_NONE
 = 800,

329 
SF_LOOP_FORWARD
,

330 
SF_LOOP_BACKWARD
,

331 
SF_LOOP_ALTERNATING


335 { 
gaö
 ;

336 
ba£nŸe
, 
dëu√
 ;

337 
vñocôy_lo
, 
vñocôy_hi
 ;

338 
key_lo
, 
key_hi
 ;

339 
lo›_cou¡
 ;

342 { 
mode
 ;

343 
°¨t
 ;

344 
íd
 ;

345 
cou¡
 ;

346 } 
lo›s
 [16] ;

347 } 
	tSF_INSTRUMENT
 ;

354 
time_sig_num
 ;

355 
time_sig_dí
 ;

356 
lo›_mode
 ;

358 
num_bóts
 ;

362 
bpm
 ;

366 
roŸ_key
 ;

367 
futuª
 [6] ;

368 } 
	tSF_LOOP_INFO
 ;

375 { 
des¸ùti⁄
 [256] ;

376 
‹igö©‹
 [32] ;

377 
‹igö©‹_ª„ªn˚
 [32] ;

378 
‹igö©i⁄_d©e
 [10] ;

379 
‹igö©i⁄_time
 [8] ;

380 
time_ª„ªn˚_low
 ;

381 
time_ª„ªn˚_high
 ;

382 
vîsi⁄
 ;

383 
umid
 [64] ;

384 
ª£rved
 [190] ;

385 
codög_hi°‹y_size
 ;

386 
codög_hi°‹y
 [256] ;

387 } 
	tSF_BROADCAST_INFO
 ;

389 
sf_cou¡_t
 (*
	tsf_vio_gë_fûñí
Ë(*
	tu£r_d©a
) ;

390 
sf_cou¡_t
 (*
	tsf_vio_£ek
Ë(
	tsf_cou¡_t
 
	toff£t
, 
	twhí˚
, *
	tu£r_d©a
) ;

391 
sf_cou¡_t
 (*
	tsf_vio_ªad
Ë(*
	t±r
, 
	tsf_cou¡_t
 
	tcou¡
, *
	tu£r_d©a
) ;

392 
sf_cou¡_t
 (*
	tsf_vio_wrôe
Ë(c⁄° *
	t±r
, 
	tsf_cou¡_t
 
	tcou¡
, *
	tu£r_d©a
) ;

393 
sf_cou¡_t
 (*
	tsf_vio_ãŒ
Ë(*
	tu£r_d©a
) ;

395 
	sSF_VIRTUAL_IO


396 { 
sf_vio_gë_fûñí
 
gë_fûñí
 ;

397 
sf_vio_£ek
 
£ek
 ;

398 
sf_vio_ªad
 
ªad
 ;

399 
sf_vio_wrôe
 
wrôe
 ;

400 
sf_vio_ãŒ
 
ãŒ
 ;

403 
SF_VIRTUAL_IO
 
	tSF_VIRTUAL_IO
 ;

411 
SNDFILE
* 
sf_›í
 (c⁄° *
∑th
, 
mode
, 
SF_INFO
 *
sföfo
) ;

425 
SNDFILE
* 
sf_›í_fd
 (
fd
, 
mode
, 
SF_INFO
 *
sföfo
, 
˛o£_desc
) ;

427 
SNDFILE
* 
sf_›í_vútuÆ
 (
SF_VIRTUAL_IO
 *
sfvútuÆ
, 
mode
, 
SF_INFO
 *
sföfo
, *
u£r_d©a
) ;

433 
sf_îr‹
 (
SNDFILE
 *
¢dfûe
) ;

439 c⁄° * 
sf_°ªº‹
 (
SNDFILE
 *
¢dfûe
) ;

446 c⁄° * 
sf_îr‹_numbî
 (
î∫um
) ;

453 
sf_≥º‹
 (
SNDFILE
 *
¢dfûe
) ;

454 
sf_îr‹_°r
 (
SNDFILE
 *
¢dfûe
, * 
°r
, 
size_t
 
Àn
) ;

459 
sf_comm™d
 (
SNDFILE
 *
¢dfûe
, 
comm™d
, *
d©a
, 
d©asize
) ;

463 
sf_f‹m©_check
 (c⁄° 
SF_INFO
 *
öfo
) ;

477 
sf_cou¡_t
 
sf_£ek
 (
SNDFILE
 *
¢dfûe
, sf_cou¡_à
‰ames
, 
whí˚
) ;

487 
sf_£t_°rög
 (
SNDFILE
 *
¢dfûe
, 
°r_ty≥
, c⁄° * 
°r
) ;

489 c⁄° * 
sf_gë_°rög
 (
SNDFILE
 *
¢dfûe
, 
°r_ty≥
) ;

494 
sf_cou¡_t
 
sf_ªad_øw
 (
SNDFILE
 *
¢dfûe
, *
±r
, sf_cou¡_à
byãs
) ;

495 
sf_cou¡_t
 
sf_wrôe_øw
 (
SNDFILE
 *
¢dfûe
, c⁄° *
±r
, sf_cou¡_à
byãs
) ;

507 
sf_cou¡_t
 
sf_ªadf_sh‹t
 (
SNDFILE
 *
¢dfûe
, *
±r
, sf_cou¡_à
‰ames
) ;

508 
sf_cou¡_t
 
sf_wrôef_sh‹t
 (
SNDFILE
 *
¢dfûe
, c⁄° *
±r
, sf_cou¡_à
‰ames
) ;

510 
sf_cou¡_t
 
sf_ªadf_öt
 (
SNDFILE
 *
¢dfûe
, *
±r
, sf_cou¡_à
‰ames
) ;

511 
sf_cou¡_t
 
sf_wrôef_öt
 (
SNDFILE
 *
¢dfûe
, c⁄° *
±r
, sf_cou¡_à
‰ames
) ;

513 
sf_cou¡_t
 
sf_ªadf_Êﬂt
 (
SNDFILE
 *
¢dfûe
, *
±r
, sf_cou¡_à
‰ames
) ;

514 
sf_cou¡_t
 
sf_wrôef_Êﬂt
 (
SNDFILE
 *
¢dfûe
, c⁄° *
±r
, sf_cou¡_à
‰ames
) ;

516 
sf_cou¡_t
 
sf_ªadf_doubÀ
 (
SNDFILE
 *
¢dfûe
, *
±r
, sf_cou¡_à
‰ames
) ;

517 
sf_cou¡_t
 
sf_wrôef_doubÀ
 (
SNDFILE
 *
¢dfûe
, c⁄° *
±r
, sf_cou¡_à
‰ames
) ;

524 
sf_cou¡_t
 
sf_ªad_sh‹t
 (
SNDFILE
 *
¢dfûe
, *
±r
, sf_cou¡_à
ôems
) ;

525 
sf_cou¡_t
 
sf_wrôe_sh‹t
 (
SNDFILE
 *
¢dfûe
, c⁄° *
±r
, sf_cou¡_à
ôems
) ;

527 
sf_cou¡_t
 
sf_ªad_öt
 (
SNDFILE
 *
¢dfûe
, *
±r
, sf_cou¡_à
ôems
) ;

528 
sf_cou¡_t
 
sf_wrôe_öt
 (
SNDFILE
 *
¢dfûe
, c⁄° *
±r
, sf_cou¡_à
ôems
) ;

530 
sf_cou¡_t
 
sf_ªad_Êﬂt
 (
SNDFILE
 *
¢dfûe
, *
±r
, sf_cou¡_à
ôems
) ;

531 
sf_cou¡_t
 
sf_wrôe_Êﬂt
 (
SNDFILE
 *
¢dfûe
, c⁄° *
±r
, sf_cou¡_à
ôems
) ;

533 
sf_cou¡_t
 
sf_ªad_doubÀ
 (
SNDFILE
 *
¢dfûe
, *
±r
, sf_cou¡_à
ôems
) ;

534 
sf_cou¡_t
 
sf_wrôe_doubÀ
 (
SNDFILE
 *
¢dfûe
, c⁄° *
±r
, sf_cou¡_à
ôems
) ;

541 
sf_˛o£
 (
SNDFILE
 *
¢dfûe
) ;

548 
sf_wrôe_sync
 (
SNDFILE
 *
¢dfûe
) ;

550 #ifde‡
__˝lu•lus


	@testprog.c

5 
	~<°dio.h
>

7 
	~"¢dfûe.h
"

10 
	$maö
 ()

11 { 
°rbuf„r
 [256] ;

12 
	`sf_comm™d
 (
NULL
, 
SFC_GET_LIB_VERSION
, 
°rbuf„r
,  (strbuffer)) ;

13 
	`puts
 (
°rbuf„r
) ;

15 
	}
}

	@
1
.
0
133
4635
libsndfile-1.0.17/Win32/testprog.c
libsndfile-1.0.17/examples/cooledit-fixer.c
libsndfile-1.0.17/examples/generate.c
libsndfile-1.0.17/examples/list_formats.c
libsndfile-1.0.17/examples/make_sine.c
libsndfile-1.0.17/examples/sfprocess.c
libsndfile-1.0.17/examples/sndfile-convert.c
libsndfile-1.0.17/examples/sndfile-info.c
libsndfile-1.0.17/examples/sndfile-play-beos.cpp
libsndfile-1.0.17/examples/sndfile-play.c
libsndfile-1.0.17/regtest/checksum.c
libsndfile-1.0.17/regtest/database.c
libsndfile-1.0.17/regtest/regtest.h
libsndfile-1.0.17/regtest/sndfile-regtest.c
libsndfile-1.0.17/src/G72x/g721.c
libsndfile-1.0.17/src/G72x/g723_16.c
libsndfile-1.0.17/src/G72x/g723_24.c
libsndfile-1.0.17/src/G72x/g723_40.c
libsndfile-1.0.17/src/G72x/g72x.c
libsndfile-1.0.17/src/G72x/g72x.h
libsndfile-1.0.17/src/G72x/g72x_priv.h
libsndfile-1.0.17/src/G72x/g72x_test.c
libsndfile-1.0.17/src/GSM610/add.c
libsndfile-1.0.17/src/GSM610/code.c
libsndfile-1.0.17/src/GSM610/config.h
libsndfile-1.0.17/src/GSM610/decode.c
libsndfile-1.0.17/src/GSM610/gsm.h
libsndfile-1.0.17/src/GSM610/gsm610_priv.h
libsndfile-1.0.17/src/GSM610/gsm_create.c
libsndfile-1.0.17/src/GSM610/gsm_decode.c
libsndfile-1.0.17/src/GSM610/gsm_destroy.c
libsndfile-1.0.17/src/GSM610/gsm_encode.c
libsndfile-1.0.17/src/GSM610/gsm_option.c
libsndfile-1.0.17/src/GSM610/long_term.c
libsndfile-1.0.17/src/GSM610/lpc.c
libsndfile-1.0.17/src/GSM610/preprocess.c
libsndfile-1.0.17/src/GSM610/rpe.c
libsndfile-1.0.17/src/GSM610/short_term.c
libsndfile-1.0.17/src/GSM610/table.c
libsndfile-1.0.17/src/aiff.c
libsndfile-1.0.17/src/alaw.c
libsndfile-1.0.17/src/au.c
libsndfile-1.0.17/src/avr.c
libsndfile-1.0.17/src/broadcast.c
libsndfile-1.0.17/src/caf.c
libsndfile-1.0.17/src/command.c
libsndfile-1.0.17/src/common.c
libsndfile-1.0.17/src/common.h
libsndfile-1.0.17/src/dither.c
libsndfile-1.0.17/src/double64.c
libsndfile-1.0.17/src/dwd.c
libsndfile-1.0.17/src/dwvw.c
libsndfile-1.0.17/src/file_io.c
libsndfile-1.0.17/src/flac.c
libsndfile-1.0.17/src/float32.c
libsndfile-1.0.17/src/float_cast.h
libsndfile-1.0.17/src/g72x.c
libsndfile-1.0.17/src/gsm610.c
libsndfile-1.0.17/src/htk.c
libsndfile-1.0.17/src/ima_adpcm.c
libsndfile-1.0.17/src/interleave.c
libsndfile-1.0.17/src/ircam.c
libsndfile-1.0.17/src/macbinary3.c
libsndfile-1.0.17/src/macos.c
libsndfile-1.0.17/src/mat4.c
libsndfile-1.0.17/src/mat5.c
libsndfile-1.0.17/src/ms_adpcm.c
libsndfile-1.0.17/src/nist.c
libsndfile-1.0.17/src/ogg.c
libsndfile-1.0.17/src/paf.c
libsndfile-1.0.17/src/pcm.c
libsndfile-1.0.17/src/pvf.c
libsndfile-1.0.17/src/raw.c
libsndfile-1.0.17/src/rx2.c
libsndfile-1.0.17/src/sd2.c
libsndfile-1.0.17/src/sds.c
libsndfile-1.0.17/src/sf_unistd.h
libsndfile-1.0.17/src/sfconfig.h
libsndfile-1.0.17/src/sfendian.h
libsndfile-1.0.17/src/sndfile.c
libsndfile-1.0.17/src/strings.c
libsndfile-1.0.17/src/svx.c
libsndfile-1.0.17/src/test_endswap.c
libsndfile-1.0.17/src/test_file_io.c
libsndfile-1.0.17/src/test_log_printf.c
libsndfile-1.0.17/src/txw.c
libsndfile-1.0.17/src/ulaw.c
libsndfile-1.0.17/src/voc.c
libsndfile-1.0.17/src/vox_adpcm.c
libsndfile-1.0.17/src/w64.c
libsndfile-1.0.17/src/wav.c
libsndfile-1.0.17/src/wav_w64.c
libsndfile-1.0.17/src/wav_w64.h
libsndfile-1.0.17/src/wve.c
libsndfile-1.0.17/src/xi.c
libsndfile-1.0.17/tests/aiff_rw_test.c
libsndfile-1.0.17/tests/alaw_test.c
libsndfile-1.0.17/tests/benchmark.c
libsndfile-1.0.17/tests/command_test.c
libsndfile-1.0.17/tests/dft_cmp.c
libsndfile-1.0.17/tests/dft_cmp.h
libsndfile-1.0.17/tests/dither_test.c
libsndfile-1.0.17/tests/dwvw_test.c
libsndfile-1.0.17/tests/error_test.c
libsndfile-1.0.17/tests/fix_this.c
libsndfile-1.0.17/tests/floating_point_test.c
libsndfile-1.0.17/tests/header_test.c
libsndfile-1.0.17/tests/headerless_test.c
libsndfile-1.0.17/tests/largefile_test.c
libsndfile-1.0.17/tests/locale_test.c
libsndfile-1.0.17/tests/lossy_comp_test.c
libsndfile-1.0.17/tests/misc_test.c
libsndfile-1.0.17/tests/multi_file_test.c
libsndfile-1.0.17/tests/open_fail_test.c
libsndfile-1.0.17/tests/pcm_test.c
libsndfile-1.0.17/tests/peak_chunk_test.c
libsndfile-1.0.17/tests/pipe_test.c
libsndfile-1.0.17/tests/raw_test.c
libsndfile-1.0.17/tests/scale_clip_test.c
libsndfile-1.0.17/tests/sfversion.c
libsndfile-1.0.17/tests/stdin_test.c
libsndfile-1.0.17/tests/stdio_test.c
libsndfile-1.0.17/tests/stdout_test.c
libsndfile-1.0.17/tests/string_test.c
libsndfile-1.0.17/tests/ulaw_test.c
libsndfile-1.0.17/tests/utils.c
libsndfile-1.0.17/tests/utils.h
libsndfile-1.0.17/tests/virtual_io_test.c
libsndfile-1.0.17/tests/win32_ordinal_test.c
libsndfile-1.0.17/tests/win32_test.c
libsndfile-1.0.17/tests/write_read_test.c
sndfile.h
testprog.c
